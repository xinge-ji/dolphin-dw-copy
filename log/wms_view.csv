"VIEW_NAME","VIEW_DDL"
"API_50TMS_ADDRESS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_50TMS_ADDRESS_V"" (""addressId"", ""transportId"", ""addressName"", ""customerType"", ""personName"", ""personPhone"", ""deliveryName"", ""provinceName"", ""cityName"", ""areaName"", ""address"", ""remark"") AS 
  select t.transid as ""addressId"",
       t.warehid as ""transportId"",
       nvl(t.sendpos, '未维护') as ""addressName"",
       2 as ""customerType"",
       nvl(t.connector, t.companyname) as ""personName"",
       substr(nvl(replace(replace(replace(replace(t.connphone, '\', '\\'),
                                          chr(9),
                                          ''),
                                  chr(10),
                                  ''),
                          chr(13),
                          ''),
                  '123'),
              0,
              32) as ""personPhone"",
       t.companyname as ""deliveryName"",
       t.province as ""provinceName"",
       t.city as ""cityName"",
       t.district as ""areaName"",
       nvl(replace(t.inceptaddr, '\', '\\'), '未维护') as ""address"",
       t.memo as ""remark""
  from api_50tms_address t
 where t.execflag = 0
"
"API_50TMS_HEADER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_50TMS_HEADER_V"" (""configid"", ""apiname"", ""apiurl"", ""appId"", ""requestId"", ""timestamp"", ""signature"", ""domain"", ""signstr"") AS 
  select t.configid ""configid"",
       t.apiname ""apiname"",
       t.apiurl||t.requestpath ""apiurl"",
       'appId' as ""appId"",
       (sysdate - to_date(' 1970 - 01 - 01 08 :00 :00 ',
                          ' yyyy - mm - dd hh24 :mi :ss ')) * 86400000 +
       to_number(to_char(systimestamp(3), 'ff')) as ""requestId"",
       (sysdate - to_date(' 1970 - 01 - 01 08 :00 :00 ',
                          ' yyyy - mm - dd hh24 :mi :ss ')) * 86400000 +
       to_number(to_char(systimestamp(3), 'ff')) as ""timestamp"",
       lower(zx_md5('appId=appId' || chr(38) || 'appSecret=appSecret' ||
                    chr(38) || 'timestamp=' ||
                    ((sysdate -
                    to_date(' 1970 - 01 - 01 08 :00 :00 ',
                              ' yyyy - mm - dd hh24 :mi :ss ')) * 86400000 +
                    to_number(to_char(systimestamp(3), 'ff'))) || chr(38) ||
                    'requestId=' ||((sysdate - to_date(' 1970 - 01 - 01 08 :00 :00 ',
                           ' yyyy - mm - dd hh24 :mi :ss ')) * 86400000 +
       to_number(to_char(systimestamp(3), 'ff')))|| chr(38) ||
                    'requestPath=' || t.requestpath)) as ""signature"",
       t.domain as ""domain"",
       'appId=appId' || chr(38) || 'appSecret=appSecret' || chr(38) ||
       'timestamp=' ||
       ((sysdate - to_date(' 1970 - 01 - 01 08 :00 :00 ',
                           ' yyyy - mm - dd hh24 :mi :ss ')) * 86400000 +
       to_number(to_char(systimestamp(3), 'ff')))
       || chr(38) || 'requestId=' ||((sysdate - to_date(' 1970 - 01 - 01 08 :00 :00 ',
                           ' yyyy - mm - dd hh24 :mi :ss ')) * 86400000 +
       to_number(to_char(systimestamp(3), 'ff')))|| chr(38) ||
       'requestPath=' || t.requestpath as ""signstr""
  from API_50TMS_CONFIG t
"
"API_50TMS_ORDER_CHAINFLAG_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_50TMS_ORDER_CHAINFLAG_V"" (""OUTID"", ""CHAINFLAG"") AS 
  select distinct t1.outid, nvl(t3.chainflag, 0) chainflag
  from wms_out_order_dtl t1,
       wms_goods_feature t2,
       (select x.ddlid goodsclass, nvl(x.chainflag, 0) chainflag
          from pub_ddl_dtl x
         where x.sysid = 9) t3
 where t1.warehid = t2.warehid(+)
   and t1.goodsid = t2.goodsid(+)
   and t2.goodsclass = t3.goodsclass(+)
"
"API_50TMS_OUT_ORDER_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_50TMS_OUT_ORDER_DTL_V"" (""tr_outdtl_id"", ""tr_out_id"", ""outdtlid"", ""outid"", ""productCode"", ""productName"", ""brandName"", ""productCategory"", ""varietyAttribute"", ""manufacturer"", ""placeOfOrigin"", ""storageConditions"", ""lotNumber"", ""validityPeriod"", ""productionDate"", ""approvalNumber"", ""isEntrance"", ""oneCategory"", ""twoCategory"", ""threeCategory"", ""mainUint"", ""uint"", ""orderNums"", ""weight"", ""volume"", ""perPrice"", ""perWeight"", ""perVolume"", ""productValue"", ""memo"") AS 
  SELECT c.tr_outdtl_id ""tr_outdtl_id"",
       c.tr_out_id ""tr_out_id"",
       a.outdtlid ""outdtlid"",
       a.outid ""outid"",
       b.ownergoodsid AS ""productCode"", --商品编码
       b.goodsname AS ""productName"", --商品名称
       b.goodsengname AS ""brandName"", --商品名
       0 AS ""productCategory"", --商品种类（商品种类（0:抛货、1:重货））
       decode(c.chainflag, 1, '冷链', '常温') AS ""varietyAttribute"", --品种属性：常温、冷链
       b.factname AS ""manufacturer"", --生产厂家
       b.prodarea AS ""placeOfOrigin"", --产地
       (SELECT x.ddlname
          FROM pub_ddl_dtl x
         WHERE x.sysid = 207
           AND x.ddlid = b.storagecondition) AS ""storageConditions"", --存储条件
       d.lotno AS ""lotNumber"", --批号
       to_char(d.validdate, 'yyyy-mm-dd') AS ""validityPeriod"", --有效期(yyyy-MM-dd)
       to_char(d.proddate, 'yyyy-mm-dd') AS ""productionDate"", --生产日期(yyyy-MM-dd)
       d.approvedocno AS ""approvalNumber"", --批准文号
       'false' AS ""isEntrance"", --是否进口
       NULL AS ""oneCategory"", --一级分类
       NULL AS ""twoCategory"", --二级分类
       NULL AS ""threeCategory"", --三级分类
       b.tradepackname AS ""mainUint"", --主单位
       b.tradepackname AS ""uint"", --最小单位
       a.goodsqty AS ""orderNums"", --商品数量
       0 AS ""weight"", --重量(kg)
       0 AS ""volume"", --体积(cm3)
       nvl(a.price, 0) AS ""perPrice"", --单价
       (SELECT decode(t.goodsweight,
                       0,
                       0,
                       NULL,
                       0,
                       t.goodsweight / t.packsize)
         --nvl(t.goodsweight / t.packsize, 0)
           FROM tpl_goods_packs t
          WHERE --t.baseunitflag = 2
          t.goodspackid = a.goodspackid
       AND t.ownergoodsid = a.ownergoodsid) AS ""perWeight"", --单个重量
       (SELECT decode(t.goodscubage,
                       0,
                       0.000125,
                       NULL,
                       0.000125,
                       t.goodscubage / t.packsize)
         --nvl(t.goodscubage / t.packsize, 0)
           FROM tpl_goods_packs t
          WHERE --t.baseunitflag = 2
          t.goodspackid = a.goodspackid
       AND t.ownergoodsid = a.ownergoodsid) AS ""perVolume"", --单个体积
       a.amt AS ""productValue"", --货值 总价
       a.dtlmemo AS ""memo"" --备注
  FROM wms_out_order_dtl       a,
       tpl_goods               b,
       api_50tms_out_order_dtl c,
       wms_goods_lot           d
 WHERE a.ownergoodsid = b.ownergoodsid(+)
   AND a.outid = c.outid
   AND a.outdtlid = c.outdtlid
   AND a.lotid = d.lotid(+)
"
"API_50TMS_OUT_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_50TMS_OUT_ORDER_V"" (""tr_out_id"", ""outid"", ""orderNo"", ""transportId"", ""orderSource"", ""erpOrderType"", ""transportType"", ""sendCompany"", ""sendName"", ""sendPhone"", ""sendCompanyID"", ""varietyAttribute"", ""requirePeer"", ""pickName"", ""pickUpAddress"", ""picUpLinkPerson"", ""pickUpLinkPhone"", ""deliveryName"", ""recevieName"", ""receviePhone"", ""recevieCompany"", ""recevieAddress"", ""appointSendTime"", ""appointSendTimeEnd"", ""pickUpTime"", ""pickUpTimeEnd"", ""logisticsNo"", ""distributionTimeStart"", ""distributionTimeEnd"", ""createOrderTime"", ""memo"", ""createdTime"", ""pickAddressId"", ""recevieId"") AS 
  select b.tr_out_id ""tr_out_id"",
       a.outid ""outid"",
       a.outid as ""orderNo"", --订单号
       a.warehid as ""transportId"", --物流中心ID
       5 as ""orderSource"", --订单来源(WMS:5 ERP:6 三方ERP 7)
       100 as ""erpOrderType"", --ERP订单类型（100:直送、200:退货提货、300:采购提货、400:自提、500:中转）
       1 as ""transportType"", --运输方式（1:""汽运""、2:""空运""、3:""船运""、4:""铁运""）
       c.goodsownername as ""sendCompany"", --货主
       d.warehname as ""sendName"", --货主联系人
       nvl(d.telephone, '123') as ""sendPhone"", --货主联系电话
       a.goodsownerid as ""sendCompanyID"", --货主ID
       decode(b.chainflag, 1, '冷链', '常温') as ""varietyAttribute"", --品种属性(常温、冷链)
       decode(b.tgflag, 1, 'true', 'false') as ""requirePeer"",
       d.warehname as ""pickName"", --取货地名称
       d.warehaddress as ""pickUpAddress"", --取货地地址
       nvl(d.connector, '未维护') as ""picUpLinkPerson"", --取货联系人
       nvl(d.telephone, '123') as ""pickUpLinkPhone"", --取货联系人电话
       e.companyname || (select '[' || x.ddlname || ']'
                           from pub_ddl_dtl x
                          where x.sysid = 1230
                            and x.ddlid = f.ybps) as ""deliveryName"", --收货客户
       nvl(f.connector, e.companyname) as ""recevieName"", --收货人
       substr(nvl(f.connphone, '123'),0,32) as ""receviePhone"", --收货方电话
       nvl(f.sendpos, '未维护') as ""recevieCompany"", --配送地名称
       nvl(f.inceptaddr, '未维护') as ""recevieAddress"", --收货方地址
       null as ""appointSendTime"", --要求到货时间起(yyyy-MM-dd HH:mm:ss)
       null as ""appointSendTimeEnd"", --要求到货时间止(yyyy-MM-dd HH:mm:ss)
       null as ""pickUpTime"", --要求提货时间起(yyyy-MM-dd HH:mm:ss)
       null as ""pickUpTimeEnd"", --要求提货时间止(yyyy-MM-dd HH:mm:ss)
       null as ""logisticsNo"", --运单号
       null as ""distributionTimeStart"", --配送时段起(yyyy-MM-dd HH:mm:ss)
       null as ""distributionTimeEnd"", --配送时段止(yyyy-MM-dd HH:mm:ss)
       to_char(a.credate, 'yyyy-mm-dd hh24:mm:ss') as ""createOrderTime"", --建单时间(yyyy-MM-dd HH:mm:ss)
       a.exportmemo as ""memo"",
       to_char(sysdate, 'yyyy-mm-dd hh24:mm:ss') as ""createdTime"", --请求时间(yyyy-MM-dd HH:mm:ss)
       1000000000 + a.warehid as ""pickAddressId"", --取货地址ID
       a.transid as ""recevieId"" --送货地址ID
  from wms_out_order         a,
       api_50tms_out_order   b,
       tpl_goodsowner        c,
       tpl_warehouse         d,
       tpl_go_company        e,
       wms_transport_address f
 where a.outid = b.outid
   and a.goodsownerid = c.goodsownerid(+)
   and a.warehid = d.warehid(+)
   and a.reccompanyid = e.companyid(+)
   and a.transid = f.transid(+)
"
"API_50TMS_ROUTEPOS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_50TMS_ROUTEPOS_V"" (""classesId"", ""addressId"") AS 
  select t1.classesid as ""classesId"", t.transid as ""addressId""
  from api_50tms_address t, wms_tr_route t1
 where t.routeid = t1.routeid
   and t.execflag = 1
   --and t.transid=3686726
   and t.routeposflag = 0
"
"API_50TMS_WAVEDTL_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_50TMS_WAVEDTL_DTL_V"" (""wavedtlid"", ""orderNo"", ""varietyAttribute"") AS 
  select a.wavedtlid as ""wavedtlid"",
        b.outid as ""orderNo"",
        decode(b.chainflag, 1, '冷链', '常温') as ""varietyAttribute""
   from api_50tms_wavedtl a, api_50tms_out_order b
  where a.wavedtlid = b.wavedtlid
    and b.usestatus = 1
    and b.execflag = 1
"
"API_50TMS_WAVEDTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_50TMS_WAVEDTL_V"" (""goodsPeerNo"", ""time"", ""number"", ""boxNumber"", ""freezeNumber"") AS 
  select t.wavedtlid as ""goodsPeerNo"",
       to_char(sysdate, 'yyyy-mm-dd hh24:mi:ss') as ""time"",
       t.wholepacks as ""number"",
       t.scatterpacks as ""boxNumber"",
       t.chainpacks as ""freezeNumber""
  from api_50tms_wavedtl t
"
"API_ECODE_QUERY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_ECODE_QUERY_V"" (""WAREHID"", ""GOODSOWNERID"", ""INOUTFLAG"", ""ORDERID"", ""ORDERDTLID"", ""RECORDID"", ""CREDATE"", ""CREATE_CHAR"", ""ECODE"", ""SOURCEID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""MANUFACTURER"", ""TRADEPACK"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""OPERATIONTYPE"", ""COMPANYNAME"") AS 
  select a.warehid,
       a.goodsownerid,
       decode(a.inoutflag, 0, '入库', '出库') as inoutflag, --0:入库 1:出库
       zx_get_code_orderid(a.inoutflag, 0, a.sourceid) as orderid,
       zx_get_code_orderdtlid(a.inoutflag, 0, a.sourceid) as orderdtlid,
       a.recordid,
       a.credate, --采集时间
       to_char(a.credate, 'yyyy-mm-dd') as create_char, --采集时间字符型
       a.ecode,
       a.sourceid,
       a.ownergoodsid,
       b.goodsownid as goodsid,
       b.goodsname,
       b.goodstype,
       b.factname as manufacturer,
       b.tradepackname as tradepack,
       c.lotno,
       to_char(c.proddate, 'yyyy-mm-dd') as proddate,
       to_char(c.validdate, 'yyyy-mm-dd') as validdate,
       (select x.ddlname
          from sys_ddl_dtl x
         where x.sysid = 389
           and x.ddlid = a.operationtype) as operationtype,
       d.companyname
  from wms_ecode_record a, tpl_goods b, wms_goods_lot c, tpl_go_company d
 where a.ownergoodsid = b.ownergoodsid
   and a.lotid = c.lotid(+)
   and a.companyid = d.companyid
"
"API_IMP_CUSTOMER_RTN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_IMP_CUSTOMER_RTN_V"" (""UUID"", ""EXECFLAG"", ""GCOMPANYID"", ""RTNMSG"") AS 
  select t.uuid,t.execflag,t.gcompanyid ,nvl(t.rtnmsg,'未处理') as rtnmsg from api_imp_customer t
"
"API_INORDERDTL_FINISH_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_INORDERDTL_FINISH_V"" (""RECEIVEID"", ""ORDERDTLID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""TRADEPACK"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""MAH"", ""GOODSTATUS"", ""QUANSTATUS"", ""PRODAREA"", ""MANUFACTURER"", ""SUPPLYNAME"", ""REMARK"", ""SHR"", ""SHDATE"", ""CHECKMAN"", ""CHECKDATE"", ""KEEPMAN"", ""KEEPDATE"", ""WAREHID"", ""GOODSOWNERID"", ""OPERATIONTYPE"", ""ZXCOLUMN4"", ""ARRIVALTEMPERATURE"", ""INVOICECODE"", ""INVOICENO"", ""INVOICEDATE"") AS 
  select a.receiveid,
       b.srcdtlno orderdtlid,
       d.goodsownid goodsid,
       d.goodsname,
       d.goodstype,
       d.tradepackname tradepack,
       e.packname,
       e.packsize,
       a.goodsqty,
       a.lotid,
       g.lotno,
       g.validdate,
       g.proddate,
       g.approvedocno,
       g.mah,
       a.goodsstatusid goodstatus,
       a.goodsstatusid quanstatus,
       d.prodarea,
       d.factname manufacturer,
       f.companyname supplyname,
       b.memo remark,
       h.employeename shr,
       b.shdate shdate,
       i.employeename checkman,
       a.checkdate checkdate,
       (select min(t2.employeename)
          from wms_st_io_doc t1, pub_employee t2
         where t1.comefrom = 1
           and t1.sourceid = a.receiveid
           and t1.keepmanid = t2.employeeid(+)) keepman,
       (select max(t1.keepdate)
          from wms_st_io_doc t1
         where t1.comefrom = 1
           and t1.sourceid = a.receiveid) keepdate,
       c.warehid,
       c.goodsownerid,
       c.operationtype,
       --decode(c.goodsownerid,9139,1,c.operationtype) operationtype,
       c.zxcolumn4,
       b.dhwd as arrivaltemperature,--到货温度
       a.invoicecode,--发票代码
       a.invoiceno，--发票号码
       to_char(a.invoicedate,'yyyy-mm-dd') as invoicedate --发票时间
  from wms_receive_dtl     a,
       wms_in_order_dtl    b,
       wms_in_order        c,
       tpl_goods           d,
       tpl_pub_goods_packs e,
       tpl_go_company      f,
       wms_goods_lot       g,
       pub_employee        h,
       pub_employee        i
 where a.indtlid = b.indtlid
   and b.inid = c.inid
   and a.ownergoodsid = d.ownergoodsid
   and a.goodspackid = e.goodspackid(+)
   and c.goodsownerid = f.goodsownerid(+)
   and c.sourcecompanyid = f.companyid(+)
   and a.lotid = g.lotid(+)
   and a.usestatus = 4
   and b.shrid = h.employeeid(+)
   and a.checkmanid1 = i.employeeid(+)
"
"API_INORDER_FINISH_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_INORDER_FINISH_V"" (""ORDERDTLID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""TRADEPACK"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""MAH"", ""GOODSTATUS"", ""QUANSTATUS"", ""PRODAREA"", ""MANUFACTURER"", ""SUPPLYNAME"", ""REMARK"", ""SHR"", ""SHDATE"", ""CHECKMAN"", ""CHECKDATE"", ""KEEPMAN"", ""KEEPDATE"", ""WAREHID"", ""GOODSOWNERID"", ""OPERATIONTYPE"", ""ZXCOLUMN4"") AS 
  select b.srcdtlno orderdtlid,
       d.goodsownid goodsid,
       d.goodsname,
       d.goodstype,
       d.tradepacksize tradepack,
       e.packname,
       e.packsize,
       sum(j.goodsqty) goodsqty,
       a.lotid,
       g.lotno,
       g.validdate,
       g.proddate,
       g.approvedocno,
       g.mah,
       a.goodsstatusid goodstatus,
       a.goodsstatusid quanstatus,
       d.prodarea,
       d.factname manufacturer,
       f.companyname supplyname,
       min(b.memo) remark,
       min(h.employeename) shr,
       max(b.shdate) shdate,
       min(i.employeename) checkman,
       max(a.checkdate) checkdate,
       min(k.employeename) keepman,
       max(j.keepdate) keepdate,
       c.warehid,
       c.goodsownerid,
       c.operationtype,
       --decode(c.goodsownerid,9139,1,c.operationtype) operationtype,
       c.zxcolumn4
  from wms_receive_dtl     a,
       wms_in_order_dtl    b,
       wms_in_order        c,
       tpl_goods           d,
       tpl_pub_goods_packs e,
       tpl_go_company      f,
       wms_goods_lot       g,
       pub_employee        h,
       pub_employee        i,
       wms_st_io_doc       j,
       pub_employee        k
 where a.indtlid = b.indtlid
   and b.inid = c.inid
   and a.ownergoodsid = d.ownergoodsid
   and a.goodspackid = e.goodspackid(+)
   and c.goodsownerid = f.goodsownerid(+)
   and c.sourcecompanyid = f.companyid(+)
   and a.lotid = g.lotid(+)
   and a.usestatus = 4
   and b.shrid = h.employeeid(+)
   and a.checkmanid1 = i.employeeid(+)
   and j.comefrom = 1
   and a.receiveid = j.sourceid
   and j.keepmanid = k.employeeid(+)
 group by b.srcdtlno,
          d.goodsownid,
          d.goodsname,
          d.goodstype,
          d.tradepacksize,
          e.packname,
          e.packsize,
          a.lotid,
          g.lotno,
          g.validdate,
          g.proddate,
          g.approvedocno,
          g.mah,
          a.goodsstatusid,
          d.prodarea,
          d.factname,
          f.companyname,
          c.warehid,
          c.goodsownerid,
          c.operationtype,
          c.zxcolumn4
"
"API_OUTORDER_FINISH_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_OUTORDER_FINISH_V"" (""ORDERDTLID"", ""GOODSID"", ""TRADEPACK"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSTATUS"", ""REMARK"", ""PICKMAN"", ""PICKDATE"", ""CHECKMAN"", ""CHECKDATE"", ""WAREHID"", ""GOODSOWNERID"", ""OPERATIONTYPE"", ""ZXCOLUMN4"") AS 
  select b.srcexpdtlno orderdtlid,
       d.goodsownid goodsid,
       d.tradepackname tradepack,
       e.packname,
       e.packsize,
       b.goodsqty,
       b.lotno,
       b.validdate,
       b.proddate,
       b.goodsstatusid goodstatus,
       b.dtlmemo remark,
       (select min(t3.employeename)
          from wms_out_order_lot_dtl t1, wms_st_io_doc t2, pub_employee t3
         where t1.wavegoodsdtlid = t2.sourceid
           and t2.comefrom in (2, 3)
           and t2.rfmanid = t3.employeeid(+)
           and t1.outdtlid = b.outdtlid) pickman,
       (select max(t2.rffindate)
          from wms_out_order_lot_dtl t1, wms_st_io_doc t2
         where t1.wavegoodsdtlid = t2.sourceid
           and t2.comefrom in (2, 3)
           and t1.outdtlid = b.outdtlid) pickdate,
       (select min(t3.employeename)
          from wms_out_order_lot_dtl t1, wms_st_io_doc t2, pub_employee t3
         where t1.wavegoodsdtlid = t2.sourceid
           and t2.comefrom in (2, 3)
           and t1.outdtlid = b.outdtlid
           and t2.keepmanid = t3.employeeid(+)) checkman,
       (select max(t2.keepdate)
          from wms_out_order_lot_dtl t1, wms_st_io_doc t2
         where t1.wavegoodsdtlid = t2.sourceid
           and t2.comefrom in (2, 3)
           and t1.outdtlid = b.outdtlid) checkdate,
       c.warehid,
       c.goodsownerid,
       c.operationtype,
       c.zxcolumn4
  from wms_out_order_dtl   b,
       wms_out_order       c,
       tpl_goods           d,
       tpl_pub_goods_packs e
 where b.outid = c.outid
   and b.ownergoodsid = d.ownergoodsid
   and b.goodspackid = e.goodspackid(+)
   and c.usestatus in (4, 5)
   and nvl(b.goodsqty,0)<>0
"
"API_OUTPUT_WMS_QTY_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_OUTPUT_WMS_QTY_LST_V"" (""WAREHID"", ""GOODSOWNERID"", ""AREA"", ""AREANAME"", ""GOODSID"", ""LOTNO"", ""GOODSQTY"", ""INTRANSQTY"", ""POSWAITQTY"", ""OUTWAITQTY"") AS 
  select t.warehid,
       t.goodsownerid,
       t.status area,
       decode(t.status,1,'合格区','待处理区') areaname,
       t.goodsownid goodsid,
       t.lotno,
       sum(t.goodsqty) goodsqty,
       sum(t.intransqty) intransqty,
       sum(t.poswaitqty) poswaitqty,
       sum(t.outwaitqty) outwaitqty
  from api_wms_qty_lst_v t
 group by t.warehid, t.goodsownerid, t.status, t.goodsownid, t.lotno
"
"API_TMP_RXMSG_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_TMP_RXMSG_DOC_V"" (""UUID"", ""CREDATE"", ""RXNO"", ""PATIENTNAME"", ""SEX"", ""NATION"", ""BIRTHDAY"", ""IDCODE"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""ADDRESS"", ""TELEPHONE"", ""DOCTOR"", ""SECTION"", ""HOSPITAL"", ""DIAGNOSIS"", ""MEMO"", ""RECEIVEDATE"", ""USESTATUS"", ""DISPATCHER"", ""DISPATCHPHONE"", ""TRNO"", ""MEMO1"", ""DISPATCHDATE"", ""SIGNDATE"", ""INPUTMANID"", ""INPUTMAN"", ""MZHM"", ""TRANSCONDITION"") AS 
  select t.uuid,
       t.credate,
       t.rxno,
       t.patientname,
       t.sex,
       t.nation,
       t.birthday,
       t.idcode,
       t.province,
       t.city,
       t.district,
       t.address,
       t.telephone,
       t.doctor,
       t.section,
       t.hospital,
       t.diagnosis,
       t.memo,
       t.receivedate,
       nvl(t.usestatus,0) usestatus,
       t.dispatcher,
       t.dispatchphone,
       t.trno,
       t.memo1,
       t.dispatchdate,
       t.signdate,
       t.inputmanid,
       a.employeename inputman,
       t.mzhm,
       t.transcondition
  from api_tmp_Rxmsg_doc t,pub_employee a where t.inputmanid=a.inputmanid(+)
"
"API_TMP_RXMSG_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_TMP_RXMSG_DTL_V"" (""UUID"", ""GOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""GOODSUNIT"", ""DRUGFORM"", ""FACTNAME"", ""PRODAREA"", ""MAH"", ""USAGEANDDOSAGE"", ""GOODSQTY"") AS 
  select t.uuid,
       t.goodsid,
       t.goodsname,
       t.goodsengname,
       t.goodstype,
       t.goodsunit,
       t.drugform,
       t.factname,
       t.prodarea,
       t.mah,
       t.usageanddosage,
       t.goodsqty
  from api_tmp_Rxmsg_dtl t
"
"API_TMS_TR_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_TMS_TR_DOC_V"" (""orderNo"", ""orderSource"", ""erpOrderType"", ""transportType"", ""sendCompany"", ""sendName"", ""sendPhone"", ""sendCompanyID"", ""varietyAttribute"", ""pickName"", ""pickUpAddress"", ""picUpLinkPerson"", ""pickUpLinkPhone"", ""recevieName"", ""receviePhone"", ""recevieAddress"", ""appointSendTime"", ""appointSendTimeEnd"", ""pickUpTime"", ""pickUpTimeEnd"", ""logisticsNo"", ""distributionTimeStart"", ""distributionTimeEnd"", ""createOrderTime"", ""createdTime"", ""outboundStatus"", ""products"", ""productCode"", ""productName"", ""brandName"", ""productCategory"", ""dtlvarietyAttribute"", ""manufacturer"", ""placeOfOrigin"", ""storageConditions"", ""lotNumber"", ""validityPeriod"", ""productionDate"", ""approvalNumber"", ""isEntrance"", ""oneCategory"", ""twoCategory"", ""threeCategory"", ""mainUint"", ""uint"", ""orderNums"", ""weight"", ""volume"", ""perPrice"", ""perWeight"", ""perVolume"", ""productValue"", ""memo"") AS 
  select a.outid as ""orderNo"", --订单号
       5 as ""orderSource"", --订单来源(WMS:5 ERP:6 三方ERP 7)3
       100 as ""erpOrderType"", --ERP订单类型（100:直送、200:退货提货、300:采购提货、400:自提、500:中转）
       1 as ""transportType"", --运输方式（1:""汽运""、2:""空运""、3:""船运""、4:""铁运""）
       c.goodsownername as ""sendCompany"", --货主
       d.warehname as ""sendName"", --货主联系人
       nvl(d.telephone,'123') as ""sendPhone"", --货主联系电话
       a.goodsownerid as ""sendCompanyID"", --货主ID
       '常温' as ""varietyAttribute"", --品种属性(常温、冷链、麻醉、麻精一)
       d.warehname as ""pickName"", --取货地名称
       d.warehaddress as ""pickUpAddress"", --取货地地址
       d.warehname as ""picUpLinkPerson"", --取货联系人
       nvl(d.telephone,'123') as ""pickUpLinkPhone"", --取货联系人电话
       e.companyname as ""recevieName"", --收货人
       nvl(f.connphone,'123') as ""receviePhone"", --收货方电话
       nvl(f.address,'123') as ""recevieAddress"", --收货方地址
       null as ""appointSendTime"", --要求到货时间起(yyyy-MM-dd HH:mm:ss)
       null as ""appointSendTimeEnd"", --要求到货时间止(yyyy-MM-dd HH:mm:ss)
       null as ""pickUpTime"", --要求提货时间起(yyyy-MM-dd HH:mm:ss)
       null as ""pickUpTimeEnd"", --要求提货时间止(yyyy-MM-dd HH:mm:ss)
       null as ""logisticsNo"", --运单号
       null as ""distributionTimeStart"", --配送时段起(yyyy-MM-dd HH:mm:ss)
       null as ""distributionTimeEnd"", --配送时段止(yyyy-MM-dd HH:mm:ss)
       to_char(a.credate, 'yyyy-mm-dd hh:mm:ss') as ""createOrderTime"", --建单时间(yyyy-MM-dd HH:mm:ss)
       to_char(sysdate, 'yyyy-mm-dd hh:mm:ss') as ""createdTime"", --请求时间(yyyy-MM-dd HH:mm:ss)
       a.usestatus as ""outboundStatus"", --出库状态
       null as ""products"", --商品数组
       g.ownergoodsid as ""productCode"", --商品编码
       g.goodsname as ""productName"", --商品名称
       g.goodsengname as ""brandName"", --商品名
       0 as ""productCategory"", --商品种类（商品种类（0:抛货、1:重货））
       '冷藏' as ""dtlvarietyAttribute"", --品种属性：常温、冷链、麻醉、麻精一
       g.factname as ""manufacturer"", --生产厂家
       g.prodarea as ""placeOfOrigin"", --产地
       g.storagecondition as ""storageConditions"", --存储条件
       h.lotno as ""lotNumber"", --批号
       to_char(h.validdate, 'yyyy-mm-dd') as ""validityPeriod"", --有效期(yyyy-MM-dd)
       to_char(h.proddate, 'yyyy-mm-dd') as ""productionDate"", --生产日期(yyyy-MM-dd)
       h.approvedocno as ""approvalNumber"", --批准文号
       'false' as ""isEntrance"", --是否进口
       null as ""oneCategory"", --一级分类
       null as ""twoCategory"", --二级分类
       null as ""threeCategory"", --三级分类
       g.tradepackname as ""mainUint"", --主单位
       null as ""uint"", --最小单位
       b.goodsqty as ""orderNums"", --商品数量
       0 as ""weight"", --重量(kg)
       0 as ""volume"", --体积(cm3)
       b.price as ""perPrice"", --单价
       0 as ""perWeight"", --单个重量
       0 as ""perVolume"", --单个体积
       b.amt as ""productValue"", --货值 总价
       b.dtlmemo as ""memo"" --备注
  from wms_out_order         a,
       wms_out_order_dtl     b,
       tpl_goodsowner        c,
       tpl_warehouse         d,
       tpl_go_company        e,
       wms_transport_address f,
       tpl_goods             g,
       wms_goods_lot         h
 where a.outid = b.outid
   and a.goodsownerid = c.goodsownerid(+)
   and a.warehid = d.warehid(+)
   and a.reccompanyid = e.companyid(+)
   and a.transid = f.transid(+)
   and b.ownergoodsid = g.ownergoodsid(+)
   and b.lotid = h.lotid(+)
   and a.outid in (7820006,7820033, 7820053,7843191)
"
"API_TR_QUERY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_TR_QUERY_V"" (""TRID"", ""WAREHID"", ""GOODSOWNERID"", ""DISPATCHID"", ""INCEPTADDR"", ""SCATTERPACKS"", ""WHOLEPACKS"", ""WEIGHT"", ""VOLUME"", ""FIXQTY"", ""USESTATUS"", ""CHAINFLAG"", ""SELFTRANSTYPE"", ""COMPANYID"", ""COMPANYNAME"", ""CONNECTOR"", ""CONNPHONE"", ""ORDERID"", ""CREDATE"", ""DISPATCHDATE"", ""DRIVERID"", ""DRIVERNAME"", ""VEHICLEID"", ""VEHICLENO"", ""INPUTMANID"", ""INPUTMAN"", ""BACKTIME"", ""DTLBACKDESCR"", ""YDNO"", ""EXCARRIER"", ""CNEXCARRIE"") AS 
  select a.trid,
       a.warehid,
       a.goodsownerid,
       a.dispatchid,
       c.inceptaddr,
       (case
         when a.warehid in (1, 17) and a.comefrom = 1 then
          zx_get_boxno(a.sourceid)
         else
          a.scatterpacks
       end) scatterpacks,
       (case
         when a.warehid in (1, 17) and a.comefrom = 1 then
          zx_get_wholeqty(a.sourceid)
         else
          a.wholepacks
       end) wholepacks,
       a.weight,
       a.volume,
       a.fixqty,
       a.usestatus,
       a.chainflag,
       a.selftranstype,
       d.companyid,
       d.companyname,
       c.connector,
       c.connphone,
       b.zxcolumn4 orderid,
       e.credate,
       nvl((select to_char(t.loadtime,'yyyy-mm-dd hh24:mi:ss')
          from track_out_order_dispatchmsg t
         where t.dispatchid = a.dispatchid
           and t.outid =  b.outid
           and rownum = 1
           and t.usestatus <> 0),e.dispatchdate) dispatchdate,
       e.driverid,
       nvl((select t.drivername
          from track_out_order_dispatchmsg t
         where t.dispatchid = a.dispatchid
           and t.outid =  b.outid
           and rownum = 1
           and t.usestatus <> 0),e.drivername) as drivername,
       e.vehicleid,
       e.vehicleno,
       e.inputmanid,
       e.inputman,
       (select to_char(t.signtime,'yyyy-mm-dd hh24:mi:ss')
          from track_out_order_dispatchmsg t
         where t.dispatchid = a.dispatchid
           and t.outid =  b.outid
           and rownum = 1
           and t.usestatus <> 0) backtime,
       null dtlbackdescr,
       a.ydno, --运单号码
       a.excarrier,
       (case when a.excarrier is null and a.warehid=1
         then (select t1.goodsownername from tpl_goodsowner t1 where t1.goodsownerid=1)
           when a.excarrier is null and a.warehid=2
         then (select t1.goodsownername from tpl_goodsowner t1 where t1.goodsownerid=3)
           when a.excarrier is null and a.warehid=17
         then (select t1.goodsownername from tpl_goodsowner t1 where t1.goodsownerid=706)
           else
       (select t.ddlname
          from pub_ddl_dtl t
         where t.sysid = 810
           and t.ddlid = a.excarrier) end) cnexcarrie --外部承运商
  from tms_tr_doc a,
       wms_out_order b,
       wms_transport_address c,
       tpl_go_company d,
       (select x.dispatchid,
               to_char(x.dispatchdate, 'yyyy-mm-dd hh24:mi:ss') dispatchdate,
               x.vehicleid,
               x1.vehicleno,
               x2.driverid,
               x2.drivername,
               x.inputmanid,
               x3.employeename inputman,
               x.credate
          from tms_dispatch_doc x,
               tms_vehicle      x1,
               tms_driver       x2,
               pub_employee     x3
         where x.vehicleid = x1.vehicleid(+)
           and x.driverid = x2.driverid(+)
           and x.inputmanid = x3.employeeid(+)
        union all
        select y.dispatchid,
               to_char(y.credate, 'yyyy-mm-dd hh24:mi:ss') dispatchdate,
               y.vehicleid,
               nvl(y1.vehicleno,y.vehicleno) as vehicleno,
               y2.driverid,
               nvl(y2.drivername,y.drivername) as drivername,
               y.inputmanid,
               y3.employeename inputman,
               y.credate
          from tms_luyan_dispatch_doc y,
               tms_vehicle            y1,
               tms_driver             y2,
               pub_employee           y3
         where y.vehicleid = y1.vehicleid(+)
           and y.driverid = y2.driverid(+)
           and y.inputmanid = y3.employeeid(+)) e
 where a.dispatchid is not null
   and a.transid = c.transid(+)
   and a.gcompanyid = d.companyid(+)
   and a.comefrom = 1
   and a.sourcetable = 1
   and a.sourceid = b.wavedtlid
   and a.dispatchid = e.dispatchid
"
"API_UDICODE_QUERY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_UDICODE_QUERY_V"" (""WAREHID"", ""GOODSOWNERID"", ""INOUTFLAG"", ""ORDERID"", ""ORDERDTLID"", ""RECORDID"", ""CREDATE"", ""CREATE_CHAR"", ""UDICODE"", ""SOURCEID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""MANUFACTURER"", ""TRADEPACK"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""OPERATIONTYPE"", ""COMPANYNAME"") AS 
  select a.warehid,
       a.goodsownerid,
       decode(a.inoutflag, 0, '入库', '出库') as inoutflag, --0:入库 1:出库
       zx_get_code_orderid(a.inoutflag, 0, a.sourceid) as orderid,
       zx_get_code_orderdtlid(a.inoutflag, 0, a.sourceid) as orderdtlid,
       a.recordid,
       a.credate, --采集时间
       to_char(a.credate, 'yyyy-mm-dd') as create_char, --采集时间字符型
       a.udicode,
       a.sourceid,
       a.ownergoodsid,
       b.goodsownid as goodsid,
       b.goodsname,
       b.goodstype,
       b.factname as manufacturer,
       b.tradepackname as tradepack,
       c.lotno,
       to_char(c.proddate, 'yyyy-mm-dd') as proddate,
       to_char(c.validdate, 'yyyy-mm-dd') as validdate,
       (select x.ddlname
          from sys_ddl_dtl x
         where x.sysid = 389
           and x.ddlid = a.operationtype) as operationtype,
       d.companyname
  from wms_udi_code_record a,
       tpl_goods           b,
       wms_goods_lot       c,
       tpl_go_company      d
 where a.ownergoodsid = b.ownergoodsid
   and a.lotid = c.lotid(+)
   and a.companyid = d.companyid
/* order by a.warehid,
          a.goodsownerid,
          a.inoutflag,
          zx_get_code_orderid(a.inoutflag, 0, a.sourceid),
          zx_get_code_orderdtlid(a.inoutflag, 0, a.sourceid),
          a.credate*/
"
"API_WMS_QTY_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""API_WMS_QTY_LST_V"" (""WAREHID"", ""GOODSOWNERID"", ""STATUS"", ""GOODSOWNID"", ""LOTNO"", ""GOODSQTY"", ""INTRANSQTY"", ""POSWAITQTY"", ""OUTWAITQTY"") AS 
  select a.warehid,--wms系统库存
       a.goodsownerid,
       decode(a.goodsstatusid, 1, 1, 2) status,
       b.goodsownid,
       c.lotno,
       a.goodsqty,
       0 intransqty,
       0 poswaitqty,
       0 outwaitqty
  from wms_st_qty_lst a, tpl_goods b, wms_goods_lot c
 where a.warehid = 1
   and a.goodsownerid = 9113
   and a.ownergoodsid = b.ownergoodsid(+)
   and a.lotid = c.lotid(+)

union all
--待出库数量

--状态是 临时 的出入库单据 [出库] comefrom=3
select a.warehid,
       a.goodsownerid,
       decode(a.goodsstatusid, 1, 1, 2) status,
       b.goodsownid,
       c.lotno,
       0 goodsqty,
       0 intransqty,
       0 poswaitqty,
       a.goodsqty outwaitqty
  from wms_st_io_doc a, tpl_goods b, wms_goods_lot c
 where a.warehid = 1
   and a.goodsownerid = 9113
   and a.comefrom = 3
   and nvl(a.usestatus, 0) = 0
   and a.ownergoodsid = b.ownergoodsid(+)
   and a.lotid = c.lotid(+)

union all
--出库订单是下单状态的 所有下单状态
select a.warehid,
       a.goodsownerid,
       decode(b.goodsstatusid, 1, 1, 2) status,
       c.goodsownid,
       d.lotno,
       0 goodsqty,
       0 intransqty,
       0 poswaitqty,
       b.goodsqty outwaitqty
  from wms_out_order a, wms_out_order_dtl b, tpl_goods c, wms_goods_lot d
 where a.outid = b.outid
   and a.warehid = 1
   and a.goodsownerid = 9113
   and a.usestatus = 1
   and b.ownergoodsid = c.ownergoodsid(+)
   and b.lotid = d.lotid(+)

union all
--出库订单是非下单状态的 但是波次未释放
select a.warehid,
       a.goodsownerid,
       decode(b.goodsstatusid, 1, 1, 2) status,
       c.goodsownid,
       d.lotno,
       0 goodsqty,
       0 intransqty,
       0 poswaitqty,
       b.goodsqty outwaitqty
  from wms_out_order     a,
       wms_out_order_dtl b,
       tpl_goods         c,
       wms_goods_lot     d,
       wms_wave_dtl      e
 where a.outid = b.outid
   and a.warehid = 1
   and a.goodsownerid = 9113
   and a.usestatus = 2 --待拣货
   and b.ownergoodsid = c.ownergoodsid(+)
   and b.lotid = d.lotid(+)
   and a.wavedtlid = e.wavedtlid
   and e.usestatus = 1 --波次分配初始状态

union all
--待上架数量
--状态是 临时 的出入库单据 [入库] comefrom=1
select a.warehid,
       a.goodsownerid,
       decode(a.goodsstatusid, 1, 1, 2) status,
       b.goodsownid,
       c.lotno,
       0 goodsqty,
       0 intransqty,
       a.goodsqty poswaitqty,
       0 outwaitqty
  from wms_st_io_doc a, tpl_goods b, wms_goods_lot c
 where a.warehid = 1
   and a.goodsownerid = 9113
   and a.comefrom = 1
   and nvl(a.usestatus, 0) = 0
   and a.ownergoodsid = b.ownergoodsid(+)
   and a.lotid = c.lotid(+)
--收货完成 入库细单是下单状态（这个再考虑下）

union all
--在途
--下单状态 未收货完成的 入库订单
select a.warehid,
       a.goodsownerid,
       decode(b.goodsstatusid, 1, 1, 2) status,
       c.goodsownid,
       b.lotno,
       0 goodsqty,
       b.goodsqty intransqty,
       0 poswaitqty,
       0 outwaitqty
  from wms_in_order a, wms_in_order_dtl b, tpl_goods c
 where a.inid = b.inid
   and a.warehid = 1
   and a.goodsownerid = 9113
   and a.usestatus = 1
   and b.porderstatus = 1
   and nvl(b.clflag, 0) = 0
   and b.ownergoodsid = c.ownergoodsid(+)
"
"AUTO_BACKBILL_WAVEDTLID_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""AUTO_BACKBILL_WAVEDTLID_V"" (""WAVEDTLID"") AS 
  select distinct a.wavedtlid
  from wms_wave_dtl a, wms_out_order b
 where a.usestatus in (2, 3, 4)
   and a.goodsownerid = 682
   and a.customid = 1791345 --客户：厦门鹭燕大药房有限公司
   and a.wavedtlid = b.wavedtlid
   and b.goodsownerid = 682
   and b.reccompanyid = 1791345
   and b.operationtype = 11 --销售
   and nvl(b.autoflag, 0) <> 0
   and nvl(a.bkflag, 0) <> 2
"
"AUTO_TASK_INIT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""AUTO_TASK_INIT_V"" (""WAVEID"", ""WAVEDTLID"", ""WAREHID"", ""TOGOODSOWNERID"", ""OPERATIONTYPE"", ""TO_GCOMPANYID"", ""GTRANSID"") AS 
  select distinct a.waveid,
                a.wavedtlid,
                d.warehid,
                c.togoodsownerid,
                c.operationtype,
                nvl(b.autoflag, 0) to_gcompanyid,
                nvl(b.to_transid, 0) gtransid
  from wms_wave_dtl a, wms_out_order b, auto_task_config c, wms_wave_doc d
 where a.usestatus in (2, 3, 4) --处理中、完成、补货中
   and a.waveid = d.wavedocid
   and d.warehid = c.warehid
   and a.wavedtlid = b.wavedtlid
   and b.goodsownerid = c.goodsownerid
   and b.reccompanyid = c.reccompanyid
   and b.operationtype = 11 --销售
   and b.usestatus in (2, 3, 4) --物流出库订单待拣货、待复核、已出货
   and nvl(b.passingflag, 0) = 1
   and c.processmode = 2 --转单处理模式按目标货主记录流程走
   and nvl(a.initflag, 0) = 0
"
"AUTO_TASK_TRADE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""AUTO_TASK_TRADE_V"" (""TRADEID"") AS 
  select distinct a.tradeid
  from wms_trade_order  a,
       wms_trade_dtl    b,
       wms_in_order_dtl c,
       wms_receive_dtl  d,
       wms_st_io_doc    e
 where a.tradeid = b.tradeid
   and a.operationtype = 24
   and a.billfrom = 3
   and a.subtype = 4
   and a.usestatus = 4
   and c.indtlid = d.indtlid
   and a.sourceinid = c.inid
   and a.sourceinoutid = e.inoutid
   and d.receiveid = e.sourceid
   and e.comefrom = 1
   and b.sourcereceiveid = d.receiveid
   and d.usestatus = 4 --验收细单状态:上架完成
   and e.goodsstatusid in  (1,9) --出入库的货品状态是合格
   and e.rfflag = 3 --出入库任务状态:执行完毕
   and nvl(a.iwcs_status, 0) = 0
   and nvl(e.tradeflag,0) = 1
"
"AUTO_TASK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""AUTO_TASK_V"" (""WAVEDTLID"", ""TOGOODSOWNERID"", ""COMPANYID"", ""OPERATIONTYPE"", ""PROCESSMODE"") AS 
  select distinct a.wavedtlid,c.togoodsownerid,c.companyid,c.operationtype,c.processmode
  from wms_wave_dtl a,wms_out_order b,auto_task_config c
 where a.usestatus = 3 --完成
   and nvl(a.autofinishflag,0)=0
   and a.wavedtlid=b.wavedtlid
   and b.goodsownerid=c.goodsownerid
   and b.reccompanyid=c.reccompanyid
   and b.operationtype=11 --销售
   and b.usestatus=4 --物流出库订单已出货
   and nvl(b.autoflag,0)<>0
   and nvl(b.to_usestatus,0)=0
   --and nvl(b.passingflag, 0) = 1  --药业自动生成配送单的修改后这条件要加上 现在注释掉
"
"AUTO_TASK_V_20220921","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""AUTO_TASK_V_20220921"" (""WAVEDTLID"") AS 
  select distinct a.wavedtlid
  from wms_wave_dtl a,wms_out_order b
 where a.usestatus = 3 --完成
   and a.goodsownerid = 682
   and a.customid=1791345 --客户：厦门鹭燕大药房有限公司
   and nvl(a.autofinishflag,0)=0
   and a.wavedtlid=b.wavedtlid
   and b.goodsownerid=682
   and b.reccompanyid=1791345
   and b.operationtype=11 --销售
   and b.usestatus=4 --物流出库订单已出货
   and nvl(b.autoflag,0)<>0
   and nvl(b.to_usestatus,0)=0
"
"AUTO_TASK_V_BAK","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""AUTO_TASK_V_BAK"" (""WAVEDTLID"", ""TOGOODSOWNERID"", ""COMPANYID"", ""OPERATIONTYPE"", ""PROCESSMODE"") AS 
  select distinct a.wavedtlid,c.togoodsownerid,c.companyid,c.operationtype,c.processmode
  from wms_wave_dtl a,wms_out_order b,auto_task_config c
 where a.usestatus = 3 --完成
   and nvl(a.autofinishflag,0)=0
   and a.wavedtlid=b.wavedtlid
   and b.goodsownerid=c.goodsownerid
   and b.reccompanyid=c.reccompanyid
   and b.operationtype=11 --销售
   and b.usestatus=4 --物流出库订单已出货
   and nvl(b.autoflag,0)<>0
   and nvl(b.to_usestatus,0)=0
"
"BASE_GATHER_ROUTE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BASE_GATHER_ROUTE_V"" (""SEQID"", ""ROUTEID"", ""ROUTENAME"", ""USESTATUS"", ""MEMO"", ""WAREHID"", ""WAREHNAME"", ""GATHERZONEID"", ""GATHERPOSID"", ""GATHERZONENO"") AS 
  select a.seqid,
       a.routeid,
       b.routename,
       a.usestatus,
       a.memo,
       b.warehid,
       b.warehname,
       a.gatherzoneid,
       a.gatherposid,
       c.gatherzoneno
from base_gather_route a,
     WMS_TR_ROUTE_v  b,
     base_gather_zone  c
where a.gatherzoneid=c.gatherzoneid
  and a.routeid=b.routeid(+)
"
"BASE_GATHER_ZONE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BASE_GATHER_ZONE_V"" (""GATHERZONEID"", ""GATHERZONENO"", ""GATHERZONE"", ""ALLOCATEMETHOS"", ""AUTOALLOCATE"", ""SUBACKFLAG"", ""USESTATUS"", ""MEMO"", ""WAREHID"", ""WAREHNAME"", ""SETID"", ""SETOPCODE"", ""SETNAME"", ""EXCEPTIONFLAG"") AS 
  select a.gatherzoneid,
       a.gatherzoneno,
       a.gatherzone,
       a.allocatemethos,
       a.autoallocate,
       a.subackflag,
       a.usestatus,
       a.memo,
       a.warehid,
       b.warehname,
       a.setid,
       c.setopcode,
       c.setname,
       a.exceptionflag
  from base_gather_zone a,
       tpl_warehouse   b,
       pub_company_set c
 where a.warehid=b.warehid
   and a.setid=c.setid(+)
"
"BI_COMMONCOM_ROLE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_COMMONCOM_ROLE_V"" (""COMPONENTID"", ""COMPONENTNAME"", ""COMPONENTTYPE"", ""ROLEOPID"", ""ROLEID"", ""ROLENAME"") AS 
  SELECT t.componentid,t.componentname,t.componenttype,b.roleopid,b.roleid,
       c.rolename
FROM (select a.comid componentid,a.comname componentname,1 componenttype
from BI_COM_DOC a

union all

select a.opid componentid,a.opname componentname,2 componenttype
from np_op a where a.classname='bireport') t, np_role_op b, np_role c

where (t.componentid = b.componentid or t.componentid = b.opid)
and b.roleid = c.roleid
"
"BI_COMMONCOM_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_COMMONCOM_V"" (""COMPONENTNAME"", ""COMPONENTID"", ""TYPENAME"", ""COMPONENTTYPE"") AS 
  select distinct a.comname componentname,a.comid componentid,c.typename,1 componenttype
from BI_COM_DOC A,
     BI_COM_DTL_STRUCT B,
     BI_COM_CATEGORY C
WHERE A.comid = b.comid
and b.comtypeid = c.typeid

union all

select opname componentname, opid componentid,'npreport' typename,2 componenttype
from np_op where classname = 'bireport'
"
"BI_COMPONENT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_COMPONENT_V"" (""COMPONENTID"", ""COMPONENTNAME"", ""TITLE"") AS 
  SELECT
A.COMID COMPONENTID, A.COMNAME COMPONENTNAME, A.TITLE TITLE
FROM BI_COM_DOC A
"
"BI_COM_CATEGORY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_COM_CATEGORY_V"" (""TYPEID"", ""TYPENAME"", ""TYPECN"") AS 
  select a.typeid,a.typename,a.typecn from bi_com_category a
"
"BI_COM_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_COM_DOC_V"" (""COMNAME"", ""TITLE"", ""TABLENAME"", ""SQL"", ""COMID"", ""TYPENAME"", ""TYPEID"", ""REFRESHINTERVAL"", ""LINKTO"", ""AWARERELATION"") AS 
  select distinct a.comname,a.title,a.tablename,a.sql,a.comid,c.typecn typename,c.typeid,
a.refreshinterval,a.linkto,a.awarerelation
from BI_COM_DOC A,
     BI_COM_DTL_STRUCT B,
     BI_COM_CATEGORY C
WHERE A.comid = b.comid(+)
and b.comtypeid = c.typeid(+)
"
"BI_COM_DTL_PARAM_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_COM_DTL_PARAM_V"" (""DTLID"", ""PARAMKEY"", ""PARAMSTR"", ""COMID"") AS 
  select dtlid,ParamKey,ParamStr,comid from BI_COM_DTL_PARAM
"
"BI_COM_DTL_STRUCT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_COM_DTL_STRUCT_V"" (""DTLID"", ""COMTYPEID"", ""PROPERTYCN"", ""VALUE"", ""PROPERTY"", ""STRUCTID"", ""COMID"", ""PROTYPE"") AS 
  select a.dtlid, a.comtypeid,c.propertycn,A.value,c.property,c.Structid,a.comid,c.protype

from BI_COM_DTL_STRUCT A,
     BI_COM_CATEGORY B,
     BI_COM_STRUCT C
WHERE A.COMTYPEID = B.TYPEID
     and b.typeid = c.typeid
     and a.structid = c.structid
"
"BI_COM_STRUCT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_COM_STRUCT_V"" (""STRUCTID"", ""PROPERTY"", ""PROPERTYCN"", ""TYPEID"", ""DATATYPE"", ""PROTYPE"") AS 
  select a.structid,a.property,a.propertycn,a.typeid,a.datatype,a.protype from bi_com_struct a
"
"BI_DDL_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_DDL_DOC_V"" (""DOCID"", ""KEYWORD"") AS 
  SELECT DOCID,KEYWORD
FROM BI_DDL_DOC
"
"BI_DDL_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_DDL_DTL_V"" (""DOCID"", ""DTLID"", ""KEY"", ""VALUE"") AS 
  SELECT DOCID,DTLID,KEY,VALUE
FROM BI_DDL_DTL
"
"BI_DRIVER_WORKJOB_TOTAL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_DRIVER_WORKJOB_TOTAL_V"" (""DRIVERID"", ""DRIVERNAME"", ""CNT"", ""TOTALPACKS"", ""WAREHID"", ""WAREHNAME"", ""SDATE"") AS 
  select driverid,
       drivername,
       count(dispatchid) cnt,
       sum(totalpacks) totalpacks,
       warehid,
       warehname,
       trunc(credate) as sdate
  from tms_dispatch_doc_v
 where usestatus = 5
 group by driverid, warehid, drivername, warehname, trunc(credate)
"
"BI_DRUGS_NEAR_EXPIRATION_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_DRUGS_NEAR_EXPIRATION_V"" (""SDATE"", ""GOODSID"", ""WAREHID"", ""GOODSOWNERID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""POSID"", ""POSNO"", ""POSNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""AREATYPE"", ""AREAFLAG"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""OFFDAYS"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""TRADEPACKNAME"", ""SUPPLYERNAME"", ""GOODSOWNID"", ""DRUGFORM"", ""POSQTY"") AS 
  select sysdate as sdate,
       a.goodsid,
       a.warehid,
       a.goodsownerid,
       g.ownergoodsid,
       g.goodsname,
       g.goodstype,
       g.factname,
       a.posid,
       b.posno,
       b.posname,
       c.sectionid,
       c.sectionno,
       c.sectionname,
       d.areaid,
       d.areano,
       d.areaname,
       d.areatype,
       d.areaflag,
       a.lotid,
       e.lotno,
       e.proddate,
       e.validdate,
       trunc(e.validdate - sysdate) offdays,
       a.goodspackid,
       f.packname,
       f.packsize,
       g.tradepackname,
       g.supplyername,
       g.goodsownid,
       i.drugform,
       a.posqty
  from wms_st_qty_lst      a,
       wms_pos_def         b,
       wms_st_section_def  c,
       wms_st_area_def     d,
       wms_goods_lot       e,
       tpl_pub_goods_packs f,
       Tpl_Goods           g,
       Tpl_Pub_Goods       h,
       Tpl_Drugform        i
 where a.posid = b.posid
   and b.sectionid = c.sectionid
   and b.areaid = d.areaid
   and c.areaid = d.areaid
   and a.lotid = e.lotid
   and a.goodspackid = f.goodspackid
   and a.ownergoodsid = g.ownergoodsid
   and a.goodsid = h.goodsid
   and g.drugform = i.drugform(+)
"
"BI_GOODS_OUT_QTY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_GOODS_OUT_QTY_V"" (""SDATE"", ""TASKTYPE"", ""GOODSNAME"", ""WAREHID"", ""GOODSID"", ""PACKNAME"", ""PACKSIZE"", ""SECTIONID"", ""SECTIONNAME"", ""AREAID"", ""AREANAME"", ""GOODSPACKID"", ""PICKAREANAME"", ""OUTWHOLEQTY"", ""SCATTERQTY"", ""OUTCNT"") AS 
  select trunc(a.credate) sdate,
       '销售出库' tasktype,
       c.goodsname,
       a.warehid,
       b.goodsid,
       d.packname,
       d.packsize,
       f.sectionid,
       f.sectionname,
       g.areaid,
       g.areaname,
       d.goodspackid,
       i.pickareaname,
       nvl(b.wholeqty, 0) outwholeqty,
       nvl(b.scatterqty, 0) scatterqty,
       count(b.inoutid) outcnt
  from wms_task_doc            a,
       wms_st_io_doc           b,
       tpl_pub_goods           c,
       tpl_pub_goods_packs     d,
       wms_pos_def             e,
       wms_st_section_def      f,
       wms_st_area_def         g,
       wms_pickarea_pos_def    h,
       wms_pickarea            i
 where a.taskid = b.taskid
   and b.goodsid = c.goodsid
   and b.goodspackid = d.goodspackid
   and b.posid = e.posid
   and e.sectionid = f.sectionid
   and e.areaid = g.areaid
   and b.posid = h.posid
   and h.pickareaid = i.pickareaid
   and b.comefrom = 3
   group by trunc(a.credate),
       c.goodsname,
       b.goodsid,
       d.packname,
       d.packsize,
       f.sectionid,
       f.sectionname,
       g.areaid,
       g.areaname,
       b.wholeqty,
       b.scatterqty,
       a.warehid,
       i.pickareaname,
       d.goodspackid
  /* union all
select trunc(a.credate) sdate,
       '补货出库' tasktype,
       e.goodsname,
       a.warehid,
       b.goodsid,
       f.packname,
       f.packsize,
       h.sectionid,
       h.sectionname,
       i.areaid,
       i.areaname,
       nvl(b.wholeqty, 0) + nvl(b.scatterqty, 0) / f.packsize tradewholeqty,
       nvl(b.scatterqty, 0) scatterqty,
       count(b.inoutid) tradecnt
  from wms_task_doc            a,
       wms_st_io_doc           b,
       wms_trade_dtl           c,
       wms_trade_order         d,
       tpl_pub_goods           e,
       tpl_pub_goods_packs     f,
       wms_pos_def             g,
       wms_st_section_def      h,
       wms_st_area_def         i
 where a.taskid = b.taskid
   and b.goodsid = e.goodsid
   and b.sourceid = c.tradedtlid
   and c.tradeid = d.tradeid
   and b.goodspackid = f.goodspackid
   and b.posid = g.posid
   and g.sectionid = h.sectionid
   and g.areaid = i.areaid
   and b.comefrom = 4
   group by trunc(a.credate),
       e.goodsname,
       b.goodsid,
       f.packname,
       f.packsize,
       h.sectionid,
       h.sectionname,
       i.areaid,
       i.areaname,
       b.wholeqty,
       b.scatterqty,
       a.warehid;*/
"
"BI_GOODS_QTY_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_GOODS_QTY_LST_V"" (""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""GOODSID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""POSID"", ""POSNO"", ""POSNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""WHOLEQTY"", ""GOODSQTY"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"") AS 
  select a.warehid,
       j.warehopcode,
       j.warehname,
       a.goodsid,
       b.opcode goodsopcode,
       b.goodsname,
       b.goodstype,
       b.prodarea,
       d.companyname factname,
       a.goodspackid,
       e.packname,
       e.packsize,
       a.posid,
       f.posno,
       f.posname,
       g.sectionid,
       g.sectionno,
       g.sectionname,
       h.areaid,
       h.areano,
       h.areaname,
       a.lotid,
       c.lotno,
       c.validdate,
       floor(a.goodsqty / e.packsize) wholeqty,
       mod(a.goodsqty,e.packsize) goodsqty,
       a.goodsstatusid,
       i.goodsstatus,
       i.quantitystatus
  from wms_st_qty_lst      a,
       tpl_pub_goods       b,
       wms_goods_lot       c,
       tpl_pub_company     d,
       tpl_pub_goods_packs e,
       wms_pos_def         f,
       wms_st_section_def  g,
       wms_st_area_def     h,
       wms_goodsstatus     i,
       tpl_warehouse       j
 where a.goodsid = b.goodsid
   and b.factid = d.companyid
   and a.lotid = c.lotid
   and a.goodspackid = e.goodspackid
   and a.posid = f.posid
   and f.sectionid = g.sectionid
   and f.areaid = h.areaid
   and a.goodsstatusid = i.goodsstatusid
   and a.warehid = j.warehid
   and nvl(d.factflag,0) = 1
"
"BI_GOODS_TOTAL_QTY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_GOODS_TOTAL_QTY_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTNAME"", ""GOODSQTY"", ""BUSIQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"") AS 
  select a.warehid,
       b.warehname,
       a.goodsid,
       f.opcode goodsopcode,
       f.goodsname,
       f.goodstype,
       f.prodarea,
       f.factid,
       d.companyname factname,
       sum(a.goodsqty) goodsqty,
       sum(a.busiqty) busiqty,
       a.goodspackid,
       i.packname,
       i.packsize,
       a.goodsstatusid,
       m.goodsstatus,
       m.quantitystatus
  from wms_st_qty_lst      a,
       tpl_warehouse       b,
       tpl_pub_company     d,
       tpl_pub_goods       f,
       tpl_pub_goods_packs i,
       wms_goodsstatus     m
 where a.warehid = b.warehid
   and a.goodsid = f.goodsid
   and f.factid = d.companyid
   and a.goodspackid = i.goodspackid
   and a.goodsstatusid =m.goodsstatusid
   group by a.warehid,
       b.warehname,
       a.goodsid,
       f.opcode,
       f.goodsname,
       f.goodstype,
       f.prodarea,
       f.factid,
       d.companyname,
       a.goodspackid,
       i.packname,
       i.packsize,
       a.goodsstatusid,
       m.goodsstatus,
       m.quantitystatus
"
"BI_INSIDE_WORK_COUNT_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_INSIDE_WORK_COUNT_DTL_V"" (""SDATE"", ""WAREHNAME"", ""DDLNAME"", ""OPERANAME"", ""EMPLOYEENAME"", ""SECTIONID"", ""AREANAME"", ""PICKAREANAME"", ""SECTIONNAME"", ""WORKTYPE"", ""CNT"", ""PCS"", ""GROUPID"", ""WAREHID"") AS 
  select trunc(a.credate) as sdate,
       b.warehname,
       c.areaflag ddlname,
       a.operationtype operaname,
       e.employeename,
       a.sectionid,
       c.areaname,
       i.pickareaname,
       d.sectionname,
       decode(a.comefrom,
              1,
              '入库',
              3,
              '出库',
              4,
              decode(a.operationtype,
                     29,
                     decode(a.inoutflag, 1, '补货下架', 0, '补货上架')),
              '订单出') worktype,
       count(a.inoutid) cnt,
       decode(a.comefrom,
              1,
              decode(c.areaflag,
                     1,
                     sum(nvl(a.wholeqty, 0)),
                     0,
                     sum(nvl(a.wholeqty, 0)),
                     0),
              3,
              decode(c.areaflag,
                     1,
                     sum(nvl(a.wholeqty, 0)),
                     0,
                     sum(nvl(a.wholeqty, 0)),
                     2,
                     0),
              4,
              decode(a.operationtype,
                     29,
                     decode(a.inoutflag, 1, sum(nvl(a.wholeqty, 0)), 0),
                     0)) pcs,
       i.groupid,
       a.warehid
  from wms_st_io_doc        a,
       tpl_warehouse        b,
       wms_st_area_def      c,
       wms_st_section_def   d,
       pub_employee         e,
       tpl_pub_goods_packs  f,
       wms_task_doc         g,
       wms_pickarea_pos_def h,
       wms_pickarea         i
 where a.warehid = b.warehid(+)
   and a.areaid = c.areaid(+)
   and a.sectionid = d.sectionid(+)
   and a.goodspackid = f.goodspackid(+)
   and g.taskid(+) = a.taskid
   and a.posid = h.posid(+)
   and h.pickareaid = i.pickareaid(+)
   and a.rfmanid = e.employeeid(+)
   and a.rfflag = 3
   and a.operationtype not in (28, 24)
 group by a.sectionid,
          d.sectionname,
          a.comefrom,
          c.areaname,
          c.areaflag,
          a.inoutflag,
          e.employeename,
          i.pickareaname,
          a.operationtype,
          b.warehname,
          i.groupid,
          a.warehid,
          trunc(a.credate)
 order by b.warehname, i.pickareaname, e.employeename
"
"BI_INSIDE_WORK_COUNT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_INSIDE_WORK_COUNT_V"" (""GROUPID"", ""GROUPNO"", ""GROUPNAME"", ""MEMO"", ""WAREHID"", ""PACKSPERDAY"", ""WAREHNAME"") AS 
  select a.groupid,
       a.groupno,
       a.groupname,
       a.memo,
       a.warehid,
       a.packsperday,
       b.warehname
  from wms_group_def a, tpl_warehouse b
 where a.warehid = b.warehid
"
"BI_PAGE_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_PAGE_DOC_V"" (""PAGEID"", ""PAGENAME"", ""LAYOUT"") AS 
  select Pageid,pagename,layout from BI_PAGE_DOC
"
"BI_PAGE_DTL_COM_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_PAGE_DTL_COM_V"" (""PAGEID"", ""DTLID"", ""COMID"", ""COMNAME"", ""TYPEID"", ""TYPENAME"", ""SORTINDEX"") AS 
  select A.Pageid,A.dtlid,A.comid,B.COMNAME,B.typeid,B.typename,A.SORTINDEX
from BI_PAGE_DTL_COM A,
     BI_COM_DOC_V B
WHERE A.COMID = B.COMID(+)

order by a.sortindex
"
"BI_PAGE_DTL_CON_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_PAGE_DTL_CON_V"" (""PAGEID"", ""QUERYCONDID"", ""PARAMKEY"", ""LABEL"", ""TYPE"", ""RETURNCOLUMNS"", ""READONLY"", ""HOVCLASS"", ""LINEBREAK"", ""REQUIRED"", ""COLGROUP"", ""SORTINDEX"") AS 
  select Pageid,querycondid,paramKey,label,type,returnColumns,readOnly,hovClass,lineBreak,required,colgroup,sortindex
from  BI_PAGE_DTL_CON order by sortindex
"
"BI_RECEIVE_COUNT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_RECEIVE_COUNT_V"" (""SDATE"", ""WAREHID"", ""CHECKMANID1"", ""CHECKMAN1"", ""WAREHNAME"", ""OPERATIONTYPE"", ""DDLNAME"", ""CNT"", ""PCS"") AS 
  select trunc(a.credate) as sdate,
       c.warehid,
       a.checkmanid1,
       c1.employeename checkman1,
       c.warehname,
       a.operationtype,
       c2.ddlname,

       count(a.checkid) cnt,
       to_char(sum(decode(d.packsize,0,0,a.goodsqty / d.packsize)), 'fm9999999990.0') pcs
  from gsp_physic_quality_check a,
       tpl_warehouse            c,
       wms_receive_dtl          j,
       tpl_pub_goods_packs      d,
       pub_employee             c1,
       sys_ddl_all_v            c2
 where a.receiveid = j.receiveid(+)
   and j.goodspackid = d.goodspackid(+)
   and a.warehid = c.warehid(+)
   and a.checkmanid1 = c1.employeeid(+)
   and a.operationtype = c2.ddlid(+)
   and c2.keyword = 'TPL_OPERATIONTYPE'
 group by a.checkmanid1,c1.employeename, c.warehname, c.warehid,trunc(a.credate),c2.ddlname, a.operationtype
"
"BI_STOP_SALES_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_STOP_SALES_V"" (""WAREHID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""LOTNO"", ""VALIDDATE"", ""GOODSSTATUS"", ""LOTID"", ""GOODSPACKID"", ""OWNERGOODSID"", ""GOODSOWNID"", ""POSID"", ""POSNO"", ""POSNAME"", ""SECTIONID"", ""AREAID"", ""GOODSQTY"", ""KEEPDATE"", ""OFFDAYS"") AS 
  select a.warehid,
       a.goodsid,
       d.goodsname,
       d.goodstype,
       d.prodarea,
       g.lotno,
       g.validdate,
       h.goodsstatus,
       a.lotid,
       a.goodspackid,
       a.ownergoodsid,
       d.goodsownid,
       a.posid,
       b.posno,
       b.posname,
       b.sectionid,
       b.areaid,
       a.goodsqty,
       f.keepdate,
       nvl(trunc(sysdate - f.keepdate),9999) offdays
  from wms_st_qty_lst a,
       wms_pos_def b,
       tpl_goods d,
       wms_goods_lot g,
       wms_goodsstatus h,
       (select c.goodsid,
               c.lotid,
               c.goodspackid,
               c.warehid,
               c.ownergoodsid,
               max(e.keepdate) keepdate,
               c.comefrom
          from wms_st_io_doc c, gsp_st_io_record e
         where c.inoutid = e.inoutid
         group by c.goodsid,
                  c.lotid,
                  c.goodspackid,
                  c.warehid,
                  c.ownergoodsid,
                  c.comefrom) f
 where a.posid = b.posid
   and a.ownergoodsid = d.ownergoodsid
   and a.lotid = g.lotid
   and a.goodsstatusid = h.goodsstatusid
   and a.goodsid = f.goodsid(+)
   and a.lotid = f.lotid(+)
   and a.goodspackid = f.goodspackid(+)
   and a.warehid = f.warehid(+)
   and a.ownergoodsid = f.ownergoodsid(+)
   and a.goodsstatusid = 1
   and f.comefrom(+) = 3
"
"BI_USER_MODULE_USED_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_USER_MODULE_USED_V"" (""USERID"", ""ROLEID"", ""COMPONENTID"", ""COMPONENTTYPE"", ""LAYOUTTYPE"", ""COMPONENTNAME"", ""SORTINDEX"") AS 
  SELECT
A.USERID,A.ROLEID,A.COMPONENTID,A.COMPONENTTYPE,A.LAYOUTTYPE,B.componentname,A.SORTINDEX
FROM BI_USER_MODULES A,
     BI_COMMONCOM_V B
WHERE A.COMPONENTID = B.COMPONENTID
ORDER BY A.SORTINDEX
"
"BI_WORK_JOB_TOTAL_ANALYSIS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_WORK_JOB_TOTAL_ANALYSIS_V"" (""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""TASKCOUNT"", ""UPTASKCOUNT"", ""WHOLEQTY"", ""GOODSIDCOUNT"", ""INORDERCOUNT"", ""DOWNTASKCOUNT"", ""WAVETRADECOUNT"", ""TURNBOXCOUNT"", ""MOVECOUNT"", ""OUTORDERCOUNT"") AS 
  select a.credate,a.warehid,b.warehname,
       sum(decode(str, '拣货任务', cnt, 0)) taskcount,
       sum(decode(str, '上架任务', cnt, 0)) uptaskcount,
       sum(decode(str, '整件件数', cnt, 0)) wholeqty,
       sum(decode(str, '品项数', cnt, 0)) goodsidcount,
       sum(decode(str, '入库订单数', cnt, 0)) inordercount,
       sum(decode(str, '下架任务', cnt, 0)) downtaskcount,
       sum(decode(str, '波次补货', cnt, 0)) wavetradecount,
       sum(decode(str, '周转箱任务数', cnt, 0)) turnboxcount,
       sum(decode(str, '手工移位', cnt, 0)) movecount,
       sum(decode(str, '出库订单数', cnt, 0)) outordercount
  from bi_work_job_total_v a,tpl_warehouse b where a.warehid = b.warehid and a.credate is not null
 group by a.credate,a.warehid,b.warehname
"
"BI_WORK_JOB_TOTAL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BI_WORK_JOB_TOTAL_V"" (""WAREHID"", ""CNT"", ""CREDATE"", ""STR"") AS 
  select d.warehid,count(distinct a.inid) cnt, trunc(a.credate) credate, '入库订单数' str
  from wms_in_order     a,
       wms_in_order_dtl b,
       wms_receive_dtl  c,
       wms_st_io_doc    d
 where a.inid = b.inid
   and b.indtlid = c.indtlid
   and c.receiveid = d.sourceid
   and d.inoutflag = 0
   and d.comefrom = 1
 group by trunc(a.credate),d.warehid
union
  select c.warehid,count(distinct a.outid) cnt, trunc(a.credate) credate, '出库订单数' str
    from wms_out_order a, wms_out_order_dtl b, wms_st_io_doc c
   where a.outid = b.outid
     and b.wavegoodsdtlid = c.sourceid
     and c.inoutflag = 1
     and c.comefrom = 3
   group by trunc(a.credate),c.warehid
union
  select a.warehid,count(distinct a.goodsid) cnt,
         trunc(a.credate) credate, '品项数' str
    from wms_st_io_doc a
   group by trunc(a.credate),a.warehid
union
  select a.warehid,sum(a.wholeqty) cnt, trunc(a.credate) credate, '整件件数' str
    from wms_st_io_doc a
   group by trunc(a.credate),a.warehid
union
  select a.warehid,count(a.boxdocid) cnt, trunc(a.credate) credate, '周转箱任务数' str
    from wms_turnbox_doc a
   group by trunc(a.credate),a.warehid
--1拣货任务  2下架任务  3上架任务  4移位任务
union
  select a.warehid,count(a.inoutid) cnt, trunc(a.credate) credate, decode(b.tasktype,1,'拣货任务',2,'下架任务',3,'上架任务','移位任务') str
    from wms_st_io_doc a, wms_task_doc b
   where a.taskid = b.taskid
   group by trunc(a.credate), b.tasktype,a.warehid
union
--1,'波次补货',  2,'报警补货',  3,'闲时补货'  ,'手工移位'
  select a.warehid,count(a.inoutid) cnt, trunc(a.credate) credate,decode(c.subtype,1,'波次补货',  2,'报警补货',  3,'闲时补货'  ,'手工移位') str
    from wms_st_io_doc a, wms_trade_dtl b, wms_trade_order c
   where a.sourceid = b.tradedtlid
     and b.tradeid = c.tradeid
     and a.comefrom = 4
   group by trunc(a.credate), c.subtype,a.warehid
"
"BMS_WF_INSTANCE_QRY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BMS_WF_INSTANCE_QRY_V"" (""WFINSTANCEID"", ""WFNODEINSTANCEID"", ""WFNAME"", ""WFSTATUS"", ""CREDATE"", ""TABLENAME"", ""PKVALUE"", ""PKCOLNAME"", ""STAGE"", ""STARTDATE"", ""ENDDATE"", ""NODENAME"", ""EMPLOYEEID"", ""EMPLOYEENAME"", ""APPROVEMESSAGE"", ""ACTIONTYPE"") AS 
  select b.WFINSTANCEID,
       a.WFNODEINSTANCEID,
       b.WFNAME,
       decode(b.WFSTATUS, 'open', '???', 'close', '??', 'reject', '??','') WFSTATUS,
       b.credate,
       b.TABLENAME,
       b.PKVALUE,
       b.PKCOLNAME,
       a.STAGE,
       a.STARTDATE,
       a.ENDDATE,
       a.NODENAME,
       a.EMPLOYEEID,
       a.employeename,
       a.APPROVEMESSAGE,
       a.ACTIONTYPE
  from np_wf_node_instance_v a, np_wf_instance_v b
 WHERE a.WFINSTANCEID = b.WFINSTANCEID

 "
"BOND_WAREHOUSE_INORDERDTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BOND_WAREHOUSE_INORDERDTL_V"" (""SEQDTLID"", ""CUSTOMS_DECLARATION_CODE"", ""PRODUCT_SERIAL_NUMBER"", ""CUSTOMS_PRODUCT_SERIAL_NUMBER"", ""RECORD_NUMBER"", ""PRODUCT_PART_NUMBER"", ""PRODUCT_CODE"", ""PRODUCT_NAME"", ""SPECIFICATION_MODEL"", ""ORIGIN_COUNTRY"", ""FINAL_DESTINATION_COUNTRY"", ""DECLARED_MEASUREMENT_UNIT"", ""DECLARED_QUANTITY"", ""DECLARED_TOTAL_PRICE"", ""DECLARED_PRICE"", ""CURRENCY"", ""LEGAL_QUANTITY"", ""LEGAL_MEASUREMENT_UNIT"", ""SECOND_LEGAL_QUANTITY"", ""SECOND_LEGAL_MEASUREMENT_UNIT"", ""LEVY_EXEMPTION_METHOD"", ""UNIT_VERSION"", ""AUTOMATIC_RECORD_NUMBER"", ""HAZARDOUS_CHEMICALS_FLAG"", ""KEY_PRODUCT_FLAG"", ""SEQID"") AS 
  select
      a.SEQDTLID,--细单ID
      a.CUSTOMS_DECLARATION_CODE,--报关单统一编码
      a.PRODUCT_SERIAL_NUMBER,--商品序号
      a.CUSTOMS_PRODUCT_SERIAL_NUMBER,--报关单商品序号
      a.RECORD_NUMBER,--备案序号
      a.PRODUCT_PART_NUMBER,--商品料号
      a.PRODUCT_CODE,--商品编码
      a.PRODUCT_NAME,--商品名称
      a.SPECIFICATION_MODEL,--规格型号
      a.ORIGIN_COUNTRY,--原产国（地区）
      a.FINAL_DESTINATION_COUNTRY,--最终目的国（地区）
      a.DECLARED_MEASUREMENT_UNIT,--申报计量单位
      a.DECLARED_QUANTITY,--申报数量
      a.DECLARED_TOTAL_PRICE,--申报总价
      a.DECLARED_PRICE,--申报单价
      a.CURRENCY,--币制
      a.LEGAL_QUANTITY,--法定数量
      a.LEGAL_MEASUREMENT_UNIT,--法定计量单位
      a.SECOND_LEGAL_QUANTITY,--第二法定数量
      a.SECOND_LEGAL_MEASUREMENT_UNIT,--法定第二计量单位
      a.LEVY_EXEMPTION_METHOD,--征免方式
      a.UNIT_VERSION,--单耗版本号
      a.AUTOMATIC_RECORD_NUMBER,--自动备案序号
      a.HAZARDOUS_CHEMICALS_FLAG,--危化品标识
      a.KEY_PRODUCT_FLAG,--重点商品标志
      a.SEQID--总单ID
from  bond_warehouse_inorderdtl a,bond_warehouse_inorder b
      where a.SEQID = b.SEQID
"
"BOND_WAREHOUSE_INORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BOND_WAREHOUSE_INORDER_V"" (""SEQID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMAN"", ""CONFIRMMANID"", ""CONFIRMDATE"", ""REBACKMANID"", ""REBACKDATE"", ""USESTATUS"", ""PRE_ENTRY_UNIFIED_NO"", ""LIST_NO"", ""LIST_TYPE"", ""MANUAL_ACCOUNT_BOOK_NO"", ""OPERATING_UNIT_CODE"", ""JYDWSHXY_CODE"", ""OPERATING_UNIT_NAME"", ""PROCESSING_UNIT_CODE"", ""JGDWSHXY_CODE"", ""PROCESSING_UNIT_NAME"", ""DECLARING_UNIT_CODE"", ""SBDWSHXY_CODE"", ""SBDW_NAME"", ""ENTRY_UNIT_CODE"", ""LRDWSHXY_CODE"", ""ENTRY_UNIT_NAME"", ""ENTRY_DATE"", ""LIST_DECLARATION_DATE"", ""LIST_ENTRY_EXIT_GATE_STATUS"", ""DEDUCTION_FLAG"", ""ENTERPRISE_INTERNAL_NO"", ""ENTRY_CUSTOMS_TYPE"", ""COMPETENT_CUSTOMS"", ""SHIPMENT_COUNTRY_REGION"", ""MATERIALS_FINISHED_FLAG"", ""SUPERVISION_MODE"", ""TRANSPORTATION_MODE"", ""DECLARATION_FORM_NO"", ""CIRCULATION_TYPE"", ""CUSTOMS_DECLARATION_INDICATOR"", ""CUSTOMS_DECLARATION_TYPE"", ""CUSTOMS_DECLARATION_FORM_TYPE"", ""ASSOCIATED_LIST_ID"", ""GLSCBA_NO"", ""DYBGD_ID"", ""DYBGSBDW_CODE"", ""DYBGSBDWSHXY_CODE"", ""DYBGSBDW_NAME"", ""GLBGDSB_DATE"", ""GLBGDJNSFHR_CODE"", ""GLBGDJNSFHRSHXY_CODE"", ""GLBGDJNSFHR_NAME"", ""GLBGDSCXSDW_CODE"", ""GLBGDSCXSSHXY_CODE"", ""GLBGDSCXSDW_NAME"", ""GLBGDSBDW_CODE"", ""OPERATOR_CARD_NO"", ""MEMO"") AS 
  select
    a.SEQID,--总单ID
    a.CREDATE,--制单日期
    a.INPUTMANID,--录入人ID
    b.employeename inputman,--录入人
    a.CONFIRMMANID,--确认人ID
    a.CONFIRMDATE,--确定日期
    a.REBACKMANID,--回退人ID
    a.REBACKDATE,--回退日期
    nvl(a.usestatus,0) usestatus,--状态
    a.PRE_ENTRY_UNIFIED_NO,--预录入统一编号
    a.LIST_NO,--清单编号
    a.LIST_TYPE,--清单类型
    a.MANUAL_ACCOUNT_BOOK_NO,--手（账）册编号
    a.OPERATING_UNIT_CODE,--经营单位编码
    a.JYDWSHXY_CODE,--经营单位社会信用代码
    a.OPERATING_UNIT_NAME,--经营单位名称
    a.PROCESSING_UNIT_CODE,--加工单位编码
    a.JGDWSHXY_CODE,--加工单位社会信用代码
    a.PROCESSING_UNIT_NAME,--加工单位名称
    a.DECLARING_UNIT_CODE,--申报单位编码
    a.SBDWSHXY_CODE,--申报单位社会信用代码
    a.SBDW_NAME,--申报单位名称
    a.ENTRY_UNIT_CODE,--录入单位编码
    a.LRDWSHXY_CODE,--录入单位社会信用代码
    a.ENTRY_UNIT_NAME,--录入单位名称
    a.ENTRY_DATE,--录入日期
    a.LIST_DECLARATION_DATE,--清单申报日期
    a.LIST_ENTRY_EXIT_GATE_STATUS,--清单进出卡口状态
    a.DEDUCTION_FLAG,--核扣标志
    a.ENTERPRISE_INTERNAL_NO,--企业内部编号
    a.ENTRY_CUSTOMS_TYPE,--进境关别
    a.COMPETENT_CUSTOMS,--主管海关
    a.SHIPMENT_COUNTRY_REGION,--启运国（地区）
    a.MATERIALS_FINISHED_FLAG,--料件、成品标志
    a.SUPERVISION_MODE,--监管方式
    a.TRANSPORTATION_MODE,--运输方式
    a.DECLARATION_FORM_NO,--申报表编号
    a.CIRCULATION_TYPE,--流转类型
    a.CUSTOMS_DECLARATION_INDICATOR,--报关标志
    a.CUSTOMS_DECLARATION_TYPE,--报关类型
    a.CUSTOMS_DECLARATION_FORM_TYPE,--报关单类型
    a.ASSOCIATED_LIST_ID,--关联清单编号
    a.GLSCBA_NO,--关联手（账）册备案号
    a.DYBGD_ID,--对应报关单编号
    a.DYBGSBDW_CODE,--对应报关申报单位代码
    a.DYBGSBDWSHXY_CODE,--对应报关申报单位社会信用代码
    a.DYBGSBDW_NAME,--对应报关申报单位名称
    a.GLBGDSB_DATE,--关联报关单申报日期
    a.GLBGDJNSFHR_CODE,--关联报关单境内收发货人编码
    a.GLBGDJNSFHRSHXY_CODE,--关联报关单境内手法货人社会信用代码
    a.GLBGDJNSFHR_NAME,--关联报关单境内收发货人名称
    a.GLBGDSCXSDW_CODE,--关联报关单生产销售（消费使用）单位编码
    a.GLBGDSCXSSHXY_CODE,--关联报关单生产销售（消费使用）社会信用代码
    a.GLBGDSCXSDW_NAME,--关联报关单生产销售（消费使用）单位名称
    a.GLBGDSBDW_CODE,--关联报关单申报单位编码
    a.OPERATOR_CARD_NO,--操作员卡号
    a.memo --备注
from bond_warehouse_inorder a ,pub_employee b
     where a.inputmanid = b.employeeid(+)
"
"BOND_WAREHOUSE_INOUT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BOND_WAREHOUSE_INOUT_V"" (""OUTSEQID"", ""INOUTFLAG"", ""CREDATE"", ""INPUTMANID"", ""INPUTMAN"", ""CONFIRMMANID"", ""CONFIRMDATE"", ""REBACKMANID"", ""REBACKDATE"", ""USESTATUS"", ""PRE_ENTRY_UNIFIED_NO"", ""LIST_NO"", ""LIST_TYPE"", ""MANUAL_ACCOUNT_BOOK_NO"", ""OPERATING_UNIT_CODE"", ""JYDWSHXY_CODE"", ""OPERATING_UNIT_NAME"", ""PROCESSING_UNIT_CODE"", ""JGDWSHXY_CODE"", ""PROCESSING_UNIT_NAME"", ""DECLARING_UNIT_CODE"", ""SBDWSHXY_CODE"", ""SBDW_NAME"", ""ENTRY_UNIT_CODE"", ""LRDWSHXY_CODE"", ""ENTRY_UNIT_NAME"", ""ENTRY_DATE"", ""LIST_DECLARATION_DATE"", ""LIST_ENTRY_EXIT_GATE_STATUS"", ""DEDUCTION_FLAG"", ""ENTERPRISE_INTERNAL_NO"", ""ENTRY_CUSTOMS_TYPE"", ""COMPETENT_CUSTOMS"", ""SHIPMENT_COUNTRY_REGION"", ""MATERIALS_FINISHED_FLAG"", ""SUPERVISION_MODE"", ""TRANSPORTATION_MODE"", ""DECLARATION_FORM_NO"", ""CIRCULATION_TYPE"", ""CUSTOMS_DECLARATION_INDICATOR"", ""CUSTOMS_DECLARATION_TYPE"", ""CUSTOMS_DECLARATION_FORM_TYPE"", ""ASSOCIATED_LIST_ID"", ""GLSCBA_NO"", ""DYBGSBDW_CODE"", ""GLBGDSB_DATE"", ""GLBGD_ID"", ""GLBGDSBDWSHXY_CODE"", ""GLBGDSBDWMC"", ""GLBGDJNSFHR_CODE"", ""GLBGDJNSFHRSHXY_CODE"", ""GLBGDJNSFHR_NAME"", ""GLBGDSCXSDW_CODE"", ""GLBGDSCXSSHXY_CODE"", ""GLBGDSCXSDW_NAME"", ""GLBGDSBDW_CODE"", ""OPERATOR_CARD_NO"", ""MEMO"", ""OUTSEQDTLID"", ""SEQDTLID"", ""CUSTOMS_DECLARATION_CODE"", ""PRODUCT_SERIAL_NUMBER"", ""CUSTOMS_PRODUCT_SERIAL_NUMBER"", ""RECORD_NUMBER"", ""PRODUCT_PART_NUMBER"", ""PRODUCT_CODE"", ""PRODUCT_NAME"", ""SPECIFICATION_MODEL"", ""ORIGIN_COUNTRY"", ""FINAL_DESTINATION_COUNTRY"", ""DECLARED_MEASUREMENT_UNIT"", ""DECLARED_QUANTITY"", ""DECLARED_TOTAL_PRICE"", ""DECLARED_PRICE"", ""CURRENCY"", ""INGOODSQTY"", ""GOODSQTY"", ""LEGAL_MEASUREMENT_UNIT"", ""SECOND_LEGAL_QUANTITY"", ""SECOND_LEGAL_MEASUREMENT_UNIT"", ""LEVY_EXEMPTION_METHOD"", ""UNIT_VERSION"", ""AUTOMATIC_RECORD_NUMBER"", ""HAZARDOUS_CHEMICALS_FLAG"", ""KEY_PRODUCT_FLAG"") AS 
  select
       a.""OUTSEQID"",a.""INOUTFLAG"",a.""CREDATE"",a.""INPUTMANID"",a.""INPUTMAN"",a.""CONFIRMMANID"",a.""CONFIRMDATE"",a.""REBACKMANID"",a.""REBACKDATE"",a.""USESTATUS"",a.""PRE_ENTRY_UNIFIED_NO"",a.""LIST_NO"",a.""LIST_TYPE"",a.""MANUAL_ACCOUNT_BOOK_NO"",a.""OPERATING_UNIT_CODE"",a.""JYDWSHXY_CODE"",a.""OPERATING_UNIT_NAME"",a.""PROCESSING_UNIT_CODE"",a.""JGDWSHXY_CODE"",a.""PROCESSING_UNIT_NAME"",a.""DECLARING_UNIT_CODE"",a.""SBDWSHXY_CODE"",a.""SBDW_NAME"",a.""ENTRY_UNIT_CODE"",a.""LRDWSHXY_CODE"",a.""ENTRY_UNIT_NAME"",a.""ENTRY_DATE"",a.""LIST_DECLARATION_DATE"",a.""LIST_ENTRY_EXIT_GATE_STATUS"",a.""DEDUCTION_FLAG"",a.""ENTERPRISE_INTERNAL_NO"",a.""ENTRY_CUSTOMS_TYPE"",a.""COMPETENT_CUSTOMS"",a.""SHIPMENT_COUNTRY_REGION"",a.""MATERIALS_FINISHED_FLAG"",a.""SUPERVISION_MODE"",a.""TRANSPORTATION_MODE"",a.""DECLARATION_FORM_NO"",a.""CIRCULATION_TYPE"",a.""CUSTOMS_DECLARATION_INDICATOR"",a.""CUSTOMS_DECLARATION_TYPE"",a.""CUSTOMS_DECLARATION_FORM_TYPE"",a.""ASSOCIATED_LIST_ID"",a.""GLSCBA_NO"",a.""DYBGSBDW_CODE"",a.""GLBGDSB_DATE"",a.""GLBGD_ID"",a.""GLBGDSBDWSHXY_CODE"",a.""GLBGDSBDWMC"",a.""GLBGDJNSFHR_CODE"",a.""GLBGDJNSFHRSHXY_CODE"",a.""GLBGDJNSFHR_NAME"",a.""GLBGDSCXSDW_CODE"",a.""GLBGDSCXSSHXY_CODE"",a.""GLBGDSCXSDW_NAME"",a.""GLBGDSBDW_CODE"",a.""OPERATOR_CARD_NO"",a.""MEMO"",a.""OUTSEQDTLID"",a.""SEQDTLID"",a.""CUSTOMS_DECLARATION_CODE"",a.""PRODUCT_SERIAL_NUMBER"",a.""CUSTOMS_PRODUCT_SERIAL_NUMBER"",a.""RECORD_NUMBER"",a.""PRODUCT_PART_NUMBER"",a.""PRODUCT_CODE"",a.""PRODUCT_NAME"",a.""SPECIFICATION_MODEL"",a.""ORIGIN_COUNTRY"",a.""FINAL_DESTINATION_COUNTRY"",a.""DECLARED_MEASUREMENT_UNIT"",a.""DECLARED_QUANTITY"",a.""DECLARED_TOTAL_PRICE"",a.""DECLARED_PRICE"",a.""CURRENCY"",a.""INGOODSQTY"",a.""GOODSQTY"",a.""LEGAL_MEASUREMENT_UNIT"",a.""SECOND_LEGAL_QUANTITY"",a.""SECOND_LEGAL_MEASUREMENT_UNIT"",a.""LEVY_EXEMPTION_METHOD"",a.""UNIT_VERSION"",a.""AUTOMATIC_RECORD_NUMBER"",a.""HAZARDOUS_CHEMICALS_FLAG"",a.""KEY_PRODUCT_FLAG""
       from
(select
    a.outseqid,--总单ID
    1 inoutflag,--出库
    a.CREDATE,--制单日期
    a.INPUTMANID,--录入人ID
    b.employeename inputman,--录入人
    a.CONFIRMMANID,--确认人ID
    a.CONFIRMDATE,--确定日期
    a.REBACKMANID,--回退人ID
    a.REBACKDATE,--回退日期
    nvl(a.USESTATUS,0) USESTATUS,--状态
    a.PRE_ENTRY_UNIFIED_NO,--预录入统一编号
    a.LIST_NO,--清单编号
    a.LIST_TYPE,--清单类型
    a.MANUAL_ACCOUNT_BOOK_NO,--手（账）册编号
    a.OPERATING_UNIT_CODE,--经营单位编码
    a.JYDWSHXY_CODE,--经营单位社会信用代码
    a.OPERATING_UNIT_NAME,--经营单位名称
    a.PROCESSING_UNIT_CODE,--加工单位编码
    a.JGDWSHXY_CODE,--加工单位社会信用代码
    a.PROCESSING_UNIT_NAME,--加工单位名称
    a.DECLARING_UNIT_CODE,--申报单位编码
    a.SBDWSHXY_CODE,--申报单位社会信用代码
    a.SBDW_NAME,--申报单位名称
    a.ENTRY_UNIT_CODE,--录入单位编码
    a.LRDWSHXY_CODE,--录入单位社会信用代码
    a.ENTRY_UNIT_NAME,--录入单位名称
    a.ENTRY_DATE,--录入日期
    a.LIST_DECLARATION_DATE,--清单申报日期
    a.LIST_ENTRY_EXIT_GATE_STATUS,--清单进出卡口状态
    a.DEDUCTION_FLAG,--核扣标志
    a.ENTERPRISE_INTERNAL_NO,--企业内部编号
    a.ENTRY_CUSTOMS_TYPE,--进境关别
    a.COMPETENT_CUSTOMS,--主管海关
    a.SHIPMENT_COUNTRY_REGION,--启运国（地区）
    a.MATERIALS_FINISHED_FLAG,--料件、成品标志
    a.SUPERVISION_MODE,--监管方式
    a.TRANSPORTATION_MODE,--运输方式
    a.DECLARATION_FORM_NO,--申报表编号
    a.CIRCULATION_TYPE,--流转类型
    a.CUSTOMS_DECLARATION_INDICATOR,--报关标志
    a.CUSTOMS_DECLARATION_TYPE,--报关类型
    a.CUSTOMS_DECLARATION_FORM_TYPE,--报关单类型
    a.ASSOCIATED_LIST_ID,--关联清单编号
    a.GLSCBA_NO,--关联手（账）册备案号
    null as DYBGSBDW_CODE,
    a.glbgdsb_date,--关联报关单申报日期
    a.glbgd_id,--关联报关单编号
    a.glbgdsbdwshxy_code,--关联报关单申报单位社会信用代码
    a.glbgdsbdwmc,--关联报关单申报单位名称
    a.glbgdjnsfhr_code,--关联报关单境内收发货人编码
    a.glbgdjnsfhrshxy_code,--关联报关单境收发货人社会信用代码
    a.glbgdjnsfhr_name,--关联报关单境内收发货人名称
    a.GLBGDSCXSDW_CODE,--关联报关单生产销售（消费使用）单位编码
    a.GLBGDSCXSSHXY_CODE,--关联报关单生产销售（消费使用）社会信用代码
    a.GLBGDSCXSDW_NAME,--关联报关单生产销售（消费使用）单位名称
    a.GLBGDSBDW_CODE,--关联报关单申报单位编码
    a.OPERATOR_CARD_NO,--操作员卡号
    a.memo, --备注
    c.outseqdtlid,--出库细单ID
    c.seqdtlid,--库存来源ID
    d.CUSTOMS_DECLARATION_CODE,--报关单统一编码
    d.PRODUCT_SERIAL_NUMBER,--商品序号
    d.CUSTOMS_PRODUCT_SERIAL_NUMBER,--报关单商品序号
    d.RECORD_NUMBER,--备案序号
    d.PRODUCT_PART_NUMBER,--商品料号
    d.PRODUCT_CODE,--商品编码
    d.PRODUCT_NAME,--商品名称
    d.SPECIFICATION_MODEL,--规格型号
    d.ORIGIN_COUNTRY,--原产国（地区）
    d.FINAL_DESTINATION_COUNTRY,--最终目的国（地区）
    d.DECLARED_MEASUREMENT_UNIT,--申报计量单位
    c.goodsqty as DECLARED_QUANTITY,--申报数量
    d.DECLARED_TOTAL_PRICE,--申报总价
    d.DECLARED_PRICE,--申报单价
    d.CURRENCY,--币制
    null as ingoodsqty,--入库数量
    c.goodsqty,--出库数量
    d.LEGAL_MEASUREMENT_UNIT,--法定计量单位
    null as SECOND_LEGAL_QUANTITY,--第二法定数量
    d.SECOND_LEGAL_MEASUREMENT_UNIT,--法定第二计量单位
    d.LEVY_EXEMPTION_METHOD,--征免方式
    d.UNIT_VERSION,--单耗版本号
    d.AUTOMATIC_RECORD_NUMBER,--自动备案序号
    d.HAZARDOUS_CHEMICALS_FLAG,--危化品标识
    d.KEY_PRODUCT_FLAG--重点商品标志
from bond_warehouse_outorder a ,pub_employee b,bond_warehouse_outorderdtl c,bond_warehouse_inorderdtl d,bond_warehouse_inorder e
     where a.inputmanid = b.employeeid(+)
           and a.outseqid = c.outseqid
           and c.seqdtlid = d.seqdtlid
           and d.seqid = e.seqid
           and a.usestatus = 1
union all
select
    a.SEQID,--总单ID
    0 inoutflag,--入库
    a.CREDATE,--制单日期
    a.INPUTMANID,--录入人ID
    b.employeename inputman,--录入人
    a.CONFIRMMANID,--确认人ID
    a.CONFIRMDATE,--确定日期
    a.REBACKMANID,--回退人ID
    a.REBACKDATE,--回退日期
    a.USESTATUS,--状态
    a.PRE_ENTRY_UNIFIED_NO,--预录入统一编号
    a.LIST_NO,--清单编号
    a.LIST_TYPE,--清单类型
    a.MANUAL_ACCOUNT_BOOK_NO,--手（账）册编号
    a.OPERATING_UNIT_CODE,--经营单位编码
    a.JYDWSHXY_CODE,--经营单位社会信用代码
    a.OPERATING_UNIT_NAME,--经营单位名称
    a.PROCESSING_UNIT_CODE,--加工单位编码
    a.JGDWSHXY_CODE,--加工单位社会信用代码
    a.PROCESSING_UNIT_NAME,--加工单位名称
    a.DECLARING_UNIT_CODE,--申报单位编码
    a.SBDWSHXY_CODE,--申报单位社会信用代码
    a.SBDW_NAME,--申报单位名称
    a.ENTRY_UNIT_CODE,--录入单位编码
    a.LRDWSHXY_CODE,--录入单位社会信用代码
    a.ENTRY_UNIT_NAME,--录入单位名称
    a.ENTRY_DATE,--录入日期
    a.LIST_DECLARATION_DATE,--清单申报日期
    a.LIST_ENTRY_EXIT_GATE_STATUS,--清单进出卡口状态
    a.DEDUCTION_FLAG,--核扣标志
    a.ENTERPRISE_INTERNAL_NO,--企业内部编号
    a.ENTRY_CUSTOMS_TYPE,--进境关别
    a.COMPETENT_CUSTOMS,--主管海关
    a.SHIPMENT_COUNTRY_REGION,--启运国（地区）
    a.MATERIALS_FINISHED_FLAG,--料件、成品标志
    a.SUPERVISION_MODE,--监管方式
    a.TRANSPORTATION_MODE,--运输方式
    a.DECLARATION_FORM_NO,--申报表编号
    a.CIRCULATION_TYPE,--流转类型
    a.CUSTOMS_DECLARATION_INDICATOR,--报关标志
    a.CUSTOMS_DECLARATION_TYPE,--报关类型
    a.CUSTOMS_DECLARATION_FORM_TYPE,--报关单类型
    a.ASSOCIATED_LIST_ID,--关联清单编号
    a.GLSCBA_NO,--关联手（账）册备案号
    a.DYBGSBDW_CODE,--对应报关申报单位代码
    null as glbgdsb_date,
    a.DYBGD_ID,--对应报关单编号
    a.DYBGSBDWSHXY_CODE,--对应报关申报单位社会信用代码
    a.DYBGSBDW_NAME,--对应报关申报单位名称
    a.GLBGDJNSFHR_CODE,--关联报关单境内收发货人编码
    a.GLBGDJNSFHRSHXY_CODE,--关联报关单境内手法货人社会信用代码
    a.GLBGDJNSFHR_NAME,--关联报关单境内收发货人名称
    a.GLBGDSCXSDW_CODE,--关联报关单生产销售（消费使用）单位编码
    a.GLBGDSCXSSHXY_CODE,--关联报关单生产销售（消费使用）社会信用代码
    a.GLBGDSCXSDW_NAME,--关联报关单生产销售（消费使用）单位名称
    a.GLBGDSBDW_CODE,--关联报关单申报单位编码
    a.OPERATOR_CARD_NO,--操作员卡号
    a.memo, --备注
    c.SEQDTLID,--细单ID
    null as kc_seqdtlid,--库存来源ID
    c.CUSTOMS_DECLARATION_CODE,--报关单统一编码
    c.PRODUCT_SERIAL_NUMBER,--商品序号
    c.CUSTOMS_PRODUCT_SERIAL_NUMBER,--报关单商品序号
    c.RECORD_NUMBER,--备案序号
    c.PRODUCT_PART_NUMBER,--商品料号
    c.PRODUCT_CODE,--商品编码
    c.PRODUCT_NAME,--商品名称
    c.SPECIFICATION_MODEL,--规格型号
    c.ORIGIN_COUNTRY,--原产国（地区）
    c.FINAL_DESTINATION_COUNTRY,--最终目的国（地区）
    c.DECLARED_MEASUREMENT_UNIT,--申报计量单位
    c.DECLARED_QUANTITY,--申报数量
    c.DECLARED_TOTAL_PRICE,--申报总价
    c.DECLARED_PRICE,--申报单价
    c.CURRENCY,--币制
    c.LEGAL_QUANTITY,--入库数量/法定数量
    null as outgoodsqty,--出库数量
    c.LEGAL_MEASUREMENT_UNIT,--法定计量单位
    c.SECOND_LEGAL_QUANTITY,--第二法定数量
    c.SECOND_LEGAL_MEASUREMENT_UNIT,--法定第二计量单位
    c.LEVY_EXEMPTION_METHOD,--征免方式
    c.UNIT_VERSION,--单耗版本号
    c.AUTOMATIC_RECORD_NUMBER,--自动备案序号
    c.HAZARDOUS_CHEMICALS_FLAG,--危化品标识
    c.KEY_PRODUCT_FLAG--重点商品标志
from bond_warehouse_inorder a ,pub_employee b,bond_warehouse_inorderdtl c
     where  a.seqid = c.seqid
            and a.inputmanid = b.employeeid(+)
            and a.usestatus = 1) a
"
"BOND_WAREHOUSE_OUTORDERDTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BOND_WAREHOUSE_OUTORDERDTL_V"" (""OUTSEQDTLID"", ""OUTSEQID"", ""SEQDTLID"", ""GOODSQTY"", ""SEQID"", ""OPERATING_UNIT_CODE"", ""OPERATING_UNIT_NAME"", ""CUSTOMS_DECLARATION_CODE"", ""PRODUCT_SERIAL_NUMBER"", ""CUSTOMS_PRODUCT_SERIAL_NUMBER"", ""RECORD_NUMBER"", ""PRODUCT_PART_NUMBER"", ""PRODUCT_CODE"", ""PRODUCT_NAME"", ""SPECIFICATION_MODEL"", ""ORIGIN_COUNTRY"", ""FINAL_DESTINATION_COUNTRY"", ""DECLARED_MEASUREMENT_UNIT"", ""DECLARED_TOTAL_PRICE"", ""DECLARED_PRICE"", ""CURRENCY"", ""LEGAL_MEASUREMENT_UNIT"", ""SECOND_LEGAL_MEASUREMENT_UNIT"", ""LEVY_EXEMPTION_METHOD"", ""UNIT_VERSION"", ""AUTOMATIC_RECORD_NUMBER"", ""HAZARDOUS_CHEMICALS_FLAG"", ""KEY_PRODUCT_FLAG"") AS 
  select
        a.outseqdtlid,--出库细单ID
        a.outseqid,--出库总单ID
        a.seqdtlid,--库存来源ID
        a.goodsqty,--出库数量
        c.seqid,--总单ID
        c.OPERATING_UNIT_CODE,--经营单位编码
        c.OPERATING_UNIT_NAME,--经营单位名称
        d.CUSTOMS_DECLARATION_CODE,--报关单统一编码
        d.PRODUCT_SERIAL_NUMBER,--商品序号
        d.CUSTOMS_PRODUCT_SERIAL_NUMBER,--报关单商品序号
        d.RECORD_NUMBER,--备案序号
        d.PRODUCT_PART_NUMBER,--商品料号
        d.PRODUCT_CODE,--商品编码
        d.PRODUCT_NAME,--商品名称
        d.SPECIFICATION_MODEL,--规格型号
        d.ORIGIN_COUNTRY,--原产国（地区）
        d.FINAL_DESTINATION_COUNTRY,--最终目的国（地区）
        d.DECLARED_MEASUREMENT_UNIT,--申报计量单位
        d.DECLARED_TOTAL_PRICE,--申报总价
        d.DECLARED_PRICE,--申报单价
        d.CURRENCY,--币制
        d.LEGAL_MEASUREMENT_UNIT,--法定计量单位
        d.SECOND_LEGAL_MEASUREMENT_UNIT,--法定第二计量单位
        d.LEVY_EXEMPTION_METHOD,--征免方式
        d.UNIT_VERSION,--单耗版本号
        d.AUTOMATIC_RECORD_NUMBER,--自动备案序号
        d.HAZARDOUS_CHEMICALS_FLAG,--危化品标识
        d.KEY_PRODUCT_FLAG--重点商品标志
       from bond_warehouse_outorderdtl a,bond_warehouse_inorderdtl d,bond_warehouse_inorder c
            where a.seqdtlid = d.seqdtlid
                  and d.seqid = c.seqid
"
"BOND_WAREHOUSE_OUTORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BOND_WAREHOUSE_OUTORDER_V"" (""OUTSEQID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMAN"", ""CONFIRMMANID"", ""CONFIRMDATE"", ""REBACKMANID"", ""REBACKDATE"", ""USESTATUS"", ""PRE_ENTRY_UNIFIED_NO"", ""LIST_NO"", ""LIST_TYPE"", ""MANUAL_ACCOUNT_BOOK_NO"", ""OPERATING_UNIT_CODE"", ""JYDWSHXY_CODE"", ""OPERATING_UNIT_NAME"", ""PROCESSING_UNIT_CODE"", ""JGDWSHXY_CODE"", ""PROCESSING_UNIT_NAME"", ""DECLARING_UNIT_CODE"", ""SBDWSHXY_CODE"", ""SBDW_NAME"", ""ENTRY_UNIT_CODE"", ""LRDWSHXY_CODE"", ""ENTRY_UNIT_NAME"", ""ENTRY_DATE"", ""LIST_DECLARATION_DATE"", ""LIST_ENTRY_EXIT_GATE_STATUS"", ""DEDUCTION_FLAG"", ""ENTERPRISE_INTERNAL_NO"", ""ENTRY_CUSTOMS_TYPE"", ""COMPETENT_CUSTOMS"", ""SHIPMENT_COUNTRY_REGION"", ""MATERIALS_FINISHED_FLAG"", ""SUPERVISION_MODE"", ""TRANSPORTATION_MODE"", ""DECLARATION_FORM_NO"", ""CIRCULATION_TYPE"", ""CUSTOMS_DECLARATION_INDICATOR"", ""CUSTOMS_DECLARATION_TYPE"", ""CUSTOMS_DECLARATION_FORM_TYPE"", ""ASSOCIATED_LIST_ID"", ""GLSCBA_NO"", ""GLBGD_ID"", ""GLBGDSB_DATE"", ""GLBGDJNSFHR_CODE"", ""GLBGDJNSFHRSHXY_CODE"", ""GLBGDJNSFHR_NAME"", ""GLBGDSCXSDW_CODE"", ""GLBGDSCXSSHXY_CODE"", ""GLBGDSCXSDW_NAME"", ""GLBGDSBDW_CODE"", ""GLBGDSBDWSHXY_CODE"", ""GLBGDSBDWMC"", ""OPERATOR_CARD_NO"", ""MEMO"") AS 
  select
    a.outseqid,--总单ID
    a.CREDATE,--制单日期
    a.INPUTMANID,--录入人ID
    b.employeename inputman,--录入人
    a.CONFIRMMANID,--确认人ID
    a.CONFIRMDATE,--确定日期
    a.REBACKMANID,--回退人ID
    a.REBACKDATE,--回退日期
    nvl(a.USESTATUS,0) USESTATUS,--状态
    a.PRE_ENTRY_UNIFIED_NO,--预录入统一编号
    a.LIST_NO,--清单编号
    a.LIST_TYPE,--清单类型
    a.MANUAL_ACCOUNT_BOOK_NO,--手（账）册编号
    a.OPERATING_UNIT_CODE,--经营单位编码
    a.JYDWSHXY_CODE,--经营单位社会信用代码
    a.OPERATING_UNIT_NAME,--经营单位名称
    a.PROCESSING_UNIT_CODE,--加工单位编码
    a.JGDWSHXY_CODE,--加工单位社会信用代码
    a.PROCESSING_UNIT_NAME,--加工单位名称
    a.DECLARING_UNIT_CODE,--申报单位编码
    a.SBDWSHXY_CODE,--申报单位社会信用代码
    a.SBDW_NAME,--申报单位名称
    a.ENTRY_UNIT_CODE,--录入单位编码
    a.LRDWSHXY_CODE,--录入单位社会信用代码
    a.ENTRY_UNIT_NAME,--录入单位名称
    a.ENTRY_DATE,--录入日期
    a.LIST_DECLARATION_DATE,--清单申报日期
    a.LIST_ENTRY_EXIT_GATE_STATUS,--清单进出卡口状态
    a.DEDUCTION_FLAG,--核扣标志
    a.ENTERPRISE_INTERNAL_NO,--企业内部编号
    a.ENTRY_CUSTOMS_TYPE,--进境关别
    a.COMPETENT_CUSTOMS,--主管海关
    a.SHIPMENT_COUNTRY_REGION,--启运国（地区）
    a.MATERIALS_FINISHED_FLAG,--料件、成品标志
    a.SUPERVISION_MODE,--监管方式
    a.TRANSPORTATION_MODE,--运输方式
    a.DECLARATION_FORM_NO,--申报表编号
    a.CIRCULATION_TYPE,--流转类型
    a.CUSTOMS_DECLARATION_INDICATOR,--报关标志
    a.CUSTOMS_DECLARATION_TYPE,--报关类型
    a.CUSTOMS_DECLARATION_FORM_TYPE,--报关单类型
    a.ASSOCIATED_LIST_ID,--关联清单编号
    a.GLSCBA_NO,--关联手（账）册备案号
    a.glbgd_id,--关联报关单编号
    a.glbgdsb_date,--关联报关单申报日期
    a.glbgdjnsfhr_code,--关联报关单境内收发货人编码
    a.glbgdjnsfhrshxy_code,--关联报关单境收发货人社会信用―代码
    a.glbgdjnsfhr_name,--关联报关单境内收发货人名称
    a.GLBGDSCXSDW_CODE,--关联报关单生产销售（消费使用）单位编码
    a.GLBGDSCXSSHXY_CODE,--关联报关单生产销售（消费使用）社会信用代码
    a.GLBGDSCXSDW_NAME,--关联报关单生产销售（消费使用）单位名称
    a.GLBGDSBDW_CODE,--关联报关单申报单位编码
    a.glbgdsbdwshxy_code,--关联报关单申报单位社会信用代码
    a.glbgdsbdwmc,--关联报关单申报单位名称
    a.OPERATOR_CARD_NO,--操作员卡号
    a.memo --备注
from bond_warehouse_outorder a ,pub_employee b
     where a.inputmanid = b.employeeid(+)
"
"BOND_WAREHOUSE_QTY_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BOND_WAREHOUSE_QTY_LST_V"" (""SEQDTLID"", ""SEQID"", ""CREDATE"", ""GOODSQTY"", ""POSNO"", ""LIBRARYDURATION"", ""OPERATING_UNIT_CODE"", ""OPERATING_UNIT_NAME"", ""CUSTOMS_DECLARATION_CODE"", ""PRODUCT_SERIAL_NUMBER"", ""CUSTOMS_PRODUCT_SERIAL_NUMBER"", ""RECORD_NUMBER"", ""PRODUCT_PART_NUMBER"", ""PRODUCT_CODE"", ""PRODUCT_NAME"", ""SPECIFICATION_MODEL"", ""ORIGIN_COUNTRY"", ""FINAL_DESTINATION_COUNTRY"", ""DECLARED_MEASUREMENT_UNIT"", ""DECLARED_QUANTITY"", ""DECLARED_TOTAL_PRICE"", ""DECLARED_PRICE"", ""CURRENCY"", ""LEGAL_QUANTITY"", ""LEGAL_MEASUREMENT_UNIT"", ""SECOND_LEGAL_QUANTITY"", ""SECOND_LEGAL_MEASUREMENT_UNIT"", ""LEVY_EXEMPTION_METHOD"", ""UNIT_VERSION"", ""AUTOMATIC_RECORD_NUMBER"", ""HAZARDOUS_CHEMICALS_FLAG"", ""KEY_PRODUCT_FLAG"") AS 
  select
        a.seqdtlid,--细单ID
        a.seqid,--总单ID
        a.credate,--入库时间
        a.goodsqty,--库存数量
        a.posno,--仓位号
        ceil(nvl((sysdate - a.credate),0)) as libraryDuration ,--在库时长
        b.OPERATING_UNIT_CODE,--经营单位编码
        b.OPERATING_UNIT_NAME,--经营单位名称
        c.CUSTOMS_DECLARATION_CODE,--报关单统一编码
        c.PRODUCT_SERIAL_NUMBER,--商品序号
        c.CUSTOMS_PRODUCT_SERIAL_NUMBER,--报关单商品序号
        c.RECORD_NUMBER,--备案序号
        c.PRODUCT_PART_NUMBER,--商品料号
        c.PRODUCT_CODE,--商品编码
        c.PRODUCT_NAME,--商品名称
        c.SPECIFICATION_MODEL,--规格型号
        c.ORIGIN_COUNTRY,--原产国（地区）
        c.FINAL_DESTINATION_COUNTRY,--最终目的国（地区）
        c.DECLARED_MEASUREMENT_UNIT,--申报计量单位
        c.DECLARED_QUANTITY,--申报数量
        c.DECLARED_TOTAL_PRICE,--申报总价
        c.DECLARED_PRICE,--申报单价
        c.CURRENCY,--币制
        c.LEGAL_QUANTITY,--法定数量
        c.LEGAL_MEASUREMENT_UNIT,--法定计量单位
        c.SECOND_LEGAL_QUANTITY,--第二法定数量
        c.SECOND_LEGAL_MEASUREMENT_UNIT,--法定第二计量单位
        c.LEVY_EXEMPTION_METHOD,--征免方式
        c.UNIT_VERSION,--单耗版本号
        c.AUTOMATIC_RECORD_NUMBER,--自动备案序号
        c.HAZARDOUS_CHEMICALS_FLAG,--危化品标识
        c.KEY_PRODUCT_FLAG--重点商品标志
       from bond_warehouse_qty_lst a,bond_warehouse_inorder b,bond_warehouse_inorderdtl c
            where a.seqid = b.seqid
                  and a.seqdtlid = c.seqdtlid
                  and a.goodsqty > 0
"
"BOND_WAREHOUSE_QTY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BOND_WAREHOUSE_QTY_V"" (""SEQDTLID"", ""SEQID"", ""CREDATE"", ""GOODSQTY"", ""POSNO"", ""LIBRARYDURATION"", ""OPERATING_UNIT_CODE"", ""OPERATING_UNIT_NAME"", ""CUSTOMS_DECLARATION_CODE"", ""PRODUCT_SERIAL_NUMBER"", ""CUSTOMS_PRODUCT_SERIAL_NUMBER"", ""RECORD_NUMBER"", ""PRODUCT_PART_NUMBER"", ""PRODUCT_CODE"", ""PRODUCT_NAME"", ""SPECIFICATION_MODEL"", ""ORIGIN_COUNTRY"", ""FINAL_DESTINATION_COUNTRY"", ""DECLARED_MEASUREMENT_UNIT"", ""DECLARED_QUANTITY"", ""DECLARED_TOTAL_PRICE"", ""DECLARED_PRICE"", ""CURRENCY"", ""LEGAL_QUANTITY"", ""LEGAL_MEASUREMENT_UNIT"", ""SECOND_LEGAL_QUANTITY"", ""SECOND_LEGAL_MEASUREMENT_UNIT"", ""LEVY_EXEMPTION_METHOD"", ""UNIT_VERSION"", ""AUTOMATIC_RECORD_NUMBER"", ""HAZARDOUS_CHEMICALS_FLAG"", ""KEY_PRODUCT_FLAG"") AS 
  select
        a.seqdtlid,--细单ID
        a.seqid,--总单ID
        a.credate,--入库时间
        a.goodsqty,--库存数量
        a.posno,--仓位号
        ceil(nvl((sysdate - a.credate),0)) as libraryDuration ,--在库时长
        b.OPERATING_UNIT_CODE,--经营单位编码
        b.OPERATING_UNIT_NAME,--经营单位名称
        c.CUSTOMS_DECLARATION_CODE,--报关单统一编码
        c.PRODUCT_SERIAL_NUMBER,--商品序号
        c.CUSTOMS_PRODUCT_SERIAL_NUMBER,--报关单商品序号
        c.RECORD_NUMBER,--备案序号
        c.PRODUCT_PART_NUMBER,--商品料号
        c.PRODUCT_CODE,--商品编码
        c.PRODUCT_NAME,--商品名称
        c.SPECIFICATION_MODEL,--规格型号
        c.ORIGIN_COUNTRY,--原产国（地区）
        c.FINAL_DESTINATION_COUNTRY,--最终目的国（地区）
        c.DECLARED_MEASUREMENT_UNIT,--申报计量单位
        c.DECLARED_QUANTITY,--申报数量
        c.DECLARED_TOTAL_PRICE,--申报总价
        c.DECLARED_PRICE,--申报单价
        c.CURRENCY,--币制
        c.LEGAL_QUANTITY,--法定数量
        c.LEGAL_MEASUREMENT_UNIT,--法定计量单位
        c.SECOND_LEGAL_QUANTITY,--第二法定数量
        c.SECOND_LEGAL_MEASUREMENT_UNIT,--法定第二计量单位
        c.LEVY_EXEMPTION_METHOD,--征免方式
        c.UNIT_VERSION,--单耗版本号
        c.AUTOMATIC_RECORD_NUMBER,--自动备案序号
        c.HAZARDOUS_CHEMICALS_FLAG,--危化品标识
        c.KEY_PRODUCT_FLAG--重点商品标志
       from bond_warehouse_qty_lst a,bond_warehouse_inorder b,bond_warehouse_inorderdtl c
            where a.seqid = b.seqid
                  and a.seqdtlid = c.seqdtlid
                  and a.goodsqty > 0
                  order by libraryDuration desc
"
"BS_BUSCOPE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_BUSCOPE_V"" (""BUSCOPEID"", ""BUSCOPENAME"", ""BUSCOPEMNICODE"") AS 
  select buscopeid,buscopename,''buscopemnicode from bs_buscope a where a.buscopename is not null
"
"BS_CHECK_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_CHECK_ORDER_V"" (""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OPERATIONTYPE"", ""SQTY"", ""WQTY"") AS 
  select to_char(c.checkdate, 'yyyy-mm-dd') credate,
       a.warehid,
       e.warehname,
       (case
         when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
          a.goodsownerid

         when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
          999
         else
          a.goodsownerid
       end) goodsownerid,
       (case
         when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
          f.goodsownername || '[集采]'

         when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
          f.goodsownername || '[本部]'
         else
          f.goodsownername
       end) goodsownername,
       a.operationtype,
       sum((case
             when nvl(c.scatterqty, 0) <> 0 then
              1
             else
              0
           end)) sqty,
       sum(nvl(c.wholeqty, 0)) wqty
  from wms_in_order      a,
       wms_in_order_dtl  b,
       wms_receive_dtl   c,
       tpl_warehouse     e,
       tpl_goodsowner    f,
       xyue_zhbb_goodsid g
 where a.inid = b.inid
   and b.indtlid = c.indtlid
   and a.credate >= to_date('2019-01-01', 'yyyy-mm-dd') --这个日期要统一口径
   and a.warehid = e.warehid(+)
   and a.goodsownerid = f.goodsownerid(+)
   and b.porderstatus in (2, 5)
   and a.warehid in (1, 2)
   and c.ownergoodsid = g.ownergoodsid(+)
 group by to_char(c.checkdate, 'yyyy-mm-dd'),
          a.warehid,
          e.warehname,
          (case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             a.goodsownerid

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             999
            else
             a.goodsownerid
          end),
          (case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             f.goodsownername || '[集采]'

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             f.goodsownername || '[本部]'
            else
             f.goodsownername
          end),
          a.operationtype
 order by to_char(c.checkdate, 'yyyy-mm-dd'),
          a.warehid,
          (case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             a.goodsownerid

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             999
            else
             a.goodsownerid
          end),
          a.operationtype
"
"BS_FH_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_FH_ORDER_V"" (""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OPERATIONTYPE"", ""FHNUM"") AS 
  select to_char(a.keepdate, 'yyyy-mm-dd') credate,
       a.warehid,
       d.warehname,
       (case
         when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
          a.goodsownerid

         when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
          999
         else
          a.goodsownerid
       end) goodsownerid,
       (case
         when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
          e.goodsownername || '[集采]'

         when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
          e.goodsownername || '[本部]'
         else
          e.goodsownername
       end) goodsownername,
       a.operationtype,
       count(1) fhnum
  from gsp_st_io_record a,
       tpl_warehouse   d,
       tpl_goodsowner  e,
       xyue_zhbb_goodsid g
 where a.warehid = d.warehid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.keepdate >= to_date('2019-01-01', 'yyyy-mm-dd')
   and a.warehid in (1,2)
   and a.ownergoodsid=g.ownergoodsid(+)
 group by to_char(a.keepdate, 'yyyy-mm-dd'),
          a.warehid,
          d.warehname,
          (case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             a.goodsownerid

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             999
            else
             a.goodsownerid
          end),
          (case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             e.goodsownername || '[集采]'

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             e.goodsownername || '[本部]'
            else
             e.goodsownername
          end),
          a.operationtype
 order by to_char(a.keepdate, 'yyyy-mm-dd'),
          a.warehid,
          (case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             a.goodsownerid

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             999
            else
             a.goodsownerid
          end),
          a.operationtype
"
"BS_IN_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_IN_ORDER_V"" (""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OPERATIONTYPE"", ""SQTY"", ""WQTY"") AS 
  select to_char(d.keepdate, 'yyyy-mm-dd') credate,
       a.warehid,
       e.warehname,
       (case
         when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
          a.goodsownerid

         when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
          999
         else
          a.goodsownerid
       end) goodsownerid,
       (case
         when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
          f.goodsownername || '[集采]'

         when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
          f.goodsownername || '[本部]'
         else
          f.goodsownername
       end) goodsownername,
       a.operationtype,
       sum((case
             when nvl(d.scatterqty, 0) <> 0 then
              1
             else
              0
           end)) sqty,
       sum(nvl(d.wholeqty, 0)) wqty
  from wms_in_order     a,
       wms_in_order_dtl b,
       wms_receive_dtl  c,
       wms_st_io_doc    d,
       tpl_warehouse    e,
       tpl_goodsowner   f,
       xyue_zhbb_goodsid g
 where a.inid = b.inid
   and b.indtlid = c.indtlid
   and c.receiveid = d.sourceid
   and d.comefrom = 1
   and d.credate >= to_date('2019-01-01', 'yyyy-mm-dd') --这个日期要统一口径
   and a.warehid = e.warehid(+)
   and a.goodsownerid = f.goodsownerid(+)
   and d.rfflag=3
   and c.ownergoodsid = g.ownergoodsid(+)
 group by to_char(d.keepdate, 'yyyy-mm-dd'),
          a.warehid,
          e.warehname,
          (case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             a.goodsownerid

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             999
            else
             a.goodsownerid
          end),
          (case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             f.goodsownername || '[集采]'

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             f.goodsownername || '[本部]'
            else
             f.goodsownername
          end),
          a.operationtype
 order by to_char(d.keepdate, 'yyyy-mm-dd'),
          a.warehid,
          (case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             a.goodsownerid

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             999
            else
             a.goodsownerid
          end),
          a.operationtype
"
"BS_OUT_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_OUT_ORDER_V"" (""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OPERATIONTYPE"", ""SQTY"", ""WQTY"") AS 
  select to_char(d.keepdate,'yyyy-mm-dd') credate,
       a.warehid,
       e.warehname,
       (case
         when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
          a.goodsownerid

         when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
          999
         else
          a.goodsownerid
       end) goodsownerid,
       (case
         when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
          f.goodsownername || '[集采]'

         when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
          f.goodsownername || '[本部]'
         else
          f.goodsownername
       end) goodsownername,
       a.operationtype,
       sum((case when nvl(d.scatterqty,0)<>0 then 1 else 0 end)) sqty,
       sum(nvl(d.wholeqty,0)) wqty
  from wms_out_order       a,
       wms_out_order_dtl   b,
       wms_out_order_lot_dtl c,
       wms_St_io_doc         d,
       tpl_warehouse         e,
       tpl_goodsowner        f,
       xyue_zhbb_goodsid g
 where a.outid = b.outid
   and b.outdtlid = c.outdtlid
   and c.wavegoodsdtlid = d.sourceid
   and d.comefrom = 3
   and a.warehid in (1,2)
   and a.warehid=e.warehid(+)
   and a.goodsownerid=f.goodsownerid(+)
   and d.rfflag=3
   and b.ownergoodsid = g.ownergoodsid(+)
   and a.credate >= to_Date('2019-01-01', 'yyyy-mm-dd')
   group by to_char(d.keepdate,'yyyy-mm-dd'),
       a.warehid,
       e.warehname,
       (case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             a.goodsownerid

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             999
            else
             a.goodsownerid
          end),
          (case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             f.goodsownername || '[集采]'

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             f.goodsownername || '[本部]'
            else
             f.goodsownername
          end),
       a.operationtype
   order by to_char(d.keepdate,'yyyy-mm-dd'),a.warehid,(case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             a.goodsownerid

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             999
            else
             a.goodsownerid
          end),a.operationtype
"
"BS_STORAGE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_STORAGE_V"" (""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""POSNUM"", ""AREAFLAG"", ""IWCS_FLAG"") AS 
  select to_char(a.credate, 'yyyy-mm-dd') credate,
       a.warehid,
       f.warehname,
       (case
         when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
          a.goodsownerid

         when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
          999
         else
          a.goodsownerid
       end) goodsownerid,
       (case
         when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
          d.goodsownername || '[集采]'

         when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
          d.goodsownername || '[本部]'
         else
          d.goodsownername
       end) goodsownername,
       count(distinct a.posid) posnum,
       c.areaflag,
       nvl(e.iwcs_flag, 0) iwcs_flag --1.整件 2.散件
  from wms_st_qty_lst_his2 a,
       wms_pos_def         b,
       wms_st_area_def     c,
       tpl_goodsowner      d,
       wms_st_section_def  e,
       tpl_warehouse       f,
       xyue_zhbb_goodsid   g
 where a.posid = b.posid(+)
   and b.areaid = c.areaid(+)
   and b.sectionid = e.sectionid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.warehid = f.warehid(+)
   and a.warehid in (1, 2)
   and a.ownergoodsid=g.ownergoodsid(+)
 group by to_char(a.credate, 'yyyy-mm-dd'),
          a.warehid,
          f.warehname,
          (case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             a.goodsownerid

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             999
            else
             a.goodsownerid
          end),
          (case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             d.goodsownername || '[集采]'

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             d.goodsownername || '[本部]'
            else
             d.goodsownername
          end),
          c.areaflag,
          nvl(e.iwcs_flag, 0)
 order by to_char(a.credate, 'yyyy-mm-dd'),
          a.warehid,
          (case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             a.goodsownerid

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             999
            else
             a.goodsownerid
          end),
          c.areaflag
"
"BS_TRADE_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_TRADE_ORDER_V"" (""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OPERATIONTYPE"", ""WORKNUM"") AS 
  select to_char(a.tradedate, 'yyyy-mm-dd') credate,
       a.warehid,
       d.warehname,
       (case
         when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
          a.goodsownerid

         when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
          999
         else
          a.goodsownerid
       end) goodsownerid,
       (case
         when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
          e.goodsownername || '[集采]'

         when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
          e.goodsownername || '[本部]'
         else
          e.goodsownername
       end) goodsownername,
       a.operationtype,
       count(1) worknum
  from wms_trade_order a,
       wms_trade_dtl   b,
       tpl_warehouse   d,
       tpl_goodsowner  e,
       xyue_zhbb_goodsid g
 where a.tradeid=b.tradeid
   and a.operationtype in (29, 28)
   and a.warehid = d.warehid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and b.ownergoodsid=g.ownergoodsid(+)
   and a.warehid in (1,2)
   and a.tradedate >= to_date('2019-01-01', 'yyyy-mm-dd')
 group by to_char(a.tradedate, 'yyyy-mm-dd'),
          a.warehid,
          d.warehname,
          (case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             a.goodsownerid

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             999
            else
             a.goodsownerid
          end),
          (case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             e.goodsownername || '[集采]'

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             e.goodsownername || '[本部]'
            else
             e.goodsownername
          end),
          a.operationtype
 order by to_char(a.tradedate, 'yyyy-mm-dd'),
          a.warehid,
          (case
            when nvl(g.ownergoodsid, 0) <> 0 and a.goodsownerid = 3 then
             a.goodsownerid

            when nvl(g.ownergoodsid, 0) = 0 and a.goodsownerid = 3 then
             999
            else
             a.goodsownerid
          end),
          a.operationtype
"
"BS_TR_PACKNUM_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_TR_PACKNUM_V"" (""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OPERATIONTYPE"", ""PACKNUM"") AS 
  select to_char(a.credate, 'yyyy-mm-dd') credate,
       a.warehid,
       c.warehname,
       b.goodsownerid,
       f.goodsownername,
       b.operationtype,
       sum(nvl(decode(a.warehid,
                  1,
                  zx_get_boxno(b.wavedtlid),
                  b.scatterfinpacks),0) +
           nvl(decode(a.warehid,
                  1,
                  zx_get_wholeqty(b.wavedtlid),
                  b.wholefinpacks),0)) packnum

  from wms_wave_doc a, wms_wave_dtl b, tpl_warehouse c, tpl_goodsowner f
 where a.wavedocid = b.waveid
   and a.warehid in (1, 2)
   and a.credate >= to_date('2019-01-01', 'yyyy-mm-dd') --这个日期要统一口径
   and a.warehid = c.warehid(+)
   and b.goodsownerid = f.goodsownerid(+)
   and b.usestatus = 3
 group by to_char(a.credate, 'yyyy-mm-dd'),
          a.warehid,
          c.warehname,
          b.goodsownerid,
          f.goodsownername,
          b.operationtype
 order by to_char(a.credate, 'yyyy-mm-dd'),
          a.warehid,
          b.goodsownerid,
          b.operationtype
"
"BS_WMS_CHECK_TJ_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_CHECK_TJ_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"") AS 
  select to_char(b.credate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       c.warehname 物流中心,
       b.goodsownerid 货主ID,
       d.goodsownername 货主名称,
       '调剂库' 仓库名称,
       '调剂' 库区,
       sum((case
             when nvl(b.scatterqty, 0) <> 0 then
              1
             else
              0
           end)) 散件条数,
       sum(nvl(b.wholeqty, 0)) 整件件数
  from wms_receive_dtl a,
       wms_st_io_doc b,
       tpl_warehouse c,
       tpl_goodsowner d,
       (select x.sectionid, y.ddlname
          from Wms_St_Section_Def x, pub_ddl_dtl y
         where x.sectionclass = y.ddlid
           and y.sysid = 1050) e
 where a.receiveid = b.sourceid
   and b.comefrom = 1 --入库
   and a.usestatus in (3, 4) --准备上架和上架完成
   and b.credate >= to_date('2019-01-01', 'yyyy-mm-dd') --创建时间
   and a.warehid = c.warehid(+)
   and b.goodsownerid = d.goodsownerid(+)
   and b.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid in (1)
   and b.sectionid = e.sectionid(+)
   and nvl(b.autotaskflag,0)=0
   and b.goodsownerid = 2
   and b.goodsstatusid = 9
 group by to_char(b.credate, 'yyyy-mm-dd'),
          a.warehid,
          c.warehname,
          b.goodsownerid,
          d.goodsownername
 order by to_char(b.credate, 'yyyy-mm-dd'), a.warehid, b.goodsownerid
"
"BS_WMS_CHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_CHECK_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"") AS 
  select to_char(b.credate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       c.warehname 物流中心,
       b.goodsownerid 货主ID,
       d.goodsownername 货主名称,
       (case
         when b.sectionid in
              (select a1.sectionid
                 from wms_st_section_def a1
                where a1.areaid in
                      (2663, 2664, 2665, 2683, 2703, 2723, 2763, 2903, 2923)) then
          '6#仓库'
         else
          '4#仓库'
       end) 仓库名称,
       e.ddlname 库区,
       sum((case
             when nvl(b.scatterqty, 0) <> 0 then
              1
             else
              0
           end)) 散件条数,
       sum(nvl(b.wholeqty, 0)) 整件件数
  from wms_receive_dtl a,
       wms_st_io_doc b,
       tpl_warehouse c,
       tpl_goodsowner d,
       (select x.sectionid, y.ddlname
          from Wms_St_Section_Def x, pub_ddl_dtl y
         where x.sectionclass = y.ddlid
           and y.sysid = 1050) e
 where a.receiveid = b.sourceid
   and b.comefrom = 1 --入库
   and a.usestatus in (3, 4) --准备上架和上架完成
   and b.credate >= to_date('2019-01-01', 'yyyy-mm-dd') --创建时间
   and a.warehid = c.warehid(+)
   and b.goodsownerid = d.goodsownerid(+)
   and b.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid in (1)
   --and b.goodsownerid <> 550 从2022年5月份开始要取海峡
   and b.sectionid = e.sectionid(+)
   and nvl(b.autotaskflag,0)=0
 group by to_char(b.credate, 'yyyy-mm-dd'),
          a.warehid,
          c.warehname,
          b.goodsownerid,
          d.goodsownername,
          (case
            when b.sectionid in
                 (select a1.sectionid
                    from wms_st_section_def a1
                   where a1.areaid in
                         (2663, 2664, 2665, 2683, 2703, 2723, 2763, 2903, 2923)) then
             '6#仓库'
            else
             '4#仓库'
          end),
          e.ddlname
 order by to_char(b.credate, 'yyyy-mm-dd'), a.warehid, b.goodsownerid
"
"BS_WMS_CHECK_V2","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_CHECK_V2"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"") AS 
  select to_char(b.credate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       c.warehname 物流中心,
       b.goodsownerid 货主ID,
       d.goodsownername 货主名称,
       '福州中宏仓库' 仓库名称,
       '1-平库' 库区,
       sum((case
             when nvl(b.scatterqty, 0) <> 0 then
              1
             else
              0
           end)) 散件条数,
       sum(nvl(b.wholeqty, 0)) 整件件数
  from wms_receive_dtl a,
       wms_st_io_doc   b,
       tpl_warehouse   c,
       tpl_goodsowner  d
 where a.receiveid = b.sourceid
   and b.comefrom = 1 --入库
   and a.usestatus in (3, 4) --准备上架和上架完成
   and b.credate >= to_date('2019-01-01', 'yyyy-mm-dd') --创建时间
   and a.warehid = c.warehid(+)
   and b.goodsownerid = d.goodsownerid(+)
   and b.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid = 2
 group by to_char(b.credate, 'yyyy-mm-dd'),
          a.warehid,
          c.warehname,
          b.goodsownerid,
          d.goodsownername
 order by to_char(b.credate, 'yyyy-mm-dd'), a.warehid, b.goodsownerid
"
"BS_WMS_CHECK_V3","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_CHECK_V3"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"") AS 
  select to_char(b.credate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       c.warehname 物流中心,
       b.goodsownerid 货主ID,
       d.goodsownername 货主名称,
       c.warehname 仓库名称,
       e.ddlname 库区,
       sum((case
             when nvl(b.scatterqty, 0) <> 0 then
              1
             else
              0
           end)) 散件条数,
       sum(nvl(b.wholeqty, 0)) 整件件数
  from wms_receive_dtl a,
       wms_st_io_doc b,
       tpl_warehouse c,
       tpl_goodsowner d,
       (select x.sectionid, y.ddlname
          from Wms_St_Section_Def x, pub_ddl_dtl y
         where x.sectionclass = y.ddlid
           and y.sysid = 1050) e
 where a.receiveid = b.sourceid
   and b.comefrom = 1 --入库
   and a.usestatus in (3, 4) --准备上架和上架完成
   and b.credate between to_date('2022-01-01', 'yyyy-mm-dd') and to_date('2023-01-01', 'yyyy-mm-dd')--创建时间
   and a.warehid = c.warehid(+)
   and b.goodsownerid = d.goodsownerid(+)
   and b.sectionid = e.sectionid(+)
   and nvl(b.autotaskflag,0)=0
   and a.warehid=10
 group by to_char(b.credate, 'yyyy-mm-dd'),
          a.warehid,
          c.warehname,
          b.goodsownerid,
          d.goodsownername,
          e.ddlname
 order by to_char(b.credate, 'yyyy-mm-dd'), a.warehid, b.goodsownerid
"
"BS_WMS_FH_TJ_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_FH_TJ_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""复核条数"") AS 
  select to_char(a.keepdate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       c.warehname 物流中心,
       a.goodsownerid 货主ID,
       d.goodsownername 货主名称,
       '调剂库' 仓库名称,
       '调剂' 库区,
       count(1) 复核条数
  from gsp_st_io_record a,
       wms_st_io_doc b,
       tpl_warehouse c,
       tpl_goodsowner d,
       (select x.sectionid, y.ddlname
          from Wms_St_Section_Def x, pub_ddl_dtl y
         where x.sectionclass = y.ddlid
           and y.sysid = 1050) e
 where a.inoutid = b.inoutid
   and a.keepdate >= to_date('2019-01-01', 'yyyy-mm-dd') --复核时间
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and b.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid in (1, 2, 14)
   and b.sectionid = e.sectionid(+)
   and nvl(b.autotaskflag,0)=0
   and b.goodsownerid = 2
   and b.goodsstatusid = 9
 group by to_char(a.keepdate, 'yyyy-mm-dd'),
          a.warehid,
          c.warehname,
          a.goodsownerid,
          d.goodsownername
 order by to_char(a.keepdate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_FH_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_FH_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""复核条数"") AS 
  select to_char(a.keepdate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       c.warehname 物流中心,
       a.goodsownerid 货主ID,
       d.goodsownername 货主名称,
       (case
         when b.sectionid in
              (select a1.sectionid
                 from wms_st_section_def a1
                where a1.areaid in
                      (2663, 2664, 2665, 2683, 2703, 2723, 2763, 2903, 2923)) then
          '6#仓库'
         else
          '4#仓库'
       end) 仓库名称,
       e.ddlname 库区,
       count(1) 复核条数
  from gsp_st_io_record a,
       wms_st_io_doc b,
       tpl_warehouse c,
       tpl_goodsowner d,
       (select x.sectionid, y.ddlname
          from Wms_St_Section_Def x, pub_ddl_dtl y
         where x.sectionclass = y.ddlid
           and y.sysid = 1050) e
 where a.inoutid = b.inoutid
   and a.keepdate >= to_date('2019-01-01', 'yyyy-mm-dd') --复核时间
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and b.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid in (1, 2, 14)
   --and a.goodsownerid <> 550 从2022年5月份开始要取海峡
   and b.sectionid = e.sectionid(+)
   and nvl(b.autotaskflag,0)=0
 group by to_char(a.keepdate, 'yyyy-mm-dd'),
          a.warehid,
          c.warehname,
          a.goodsownerid,
          d.goodsownername,
          (case
            when b.sectionid in
                 (select a1.sectionid
                    from wms_st_section_def a1
                   where a1.areaid in
                         (2663, 2664, 2665, 2683, 2703, 2723, 2763, 2903, 2923)) then
             '6#仓库'
            else
             '4#仓库'
          end),
          e.ddlname
 order by to_char(a.keepdate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_FH_V2","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_FH_V2"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""复核条数"") AS 
  select to_char(a.keepdate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       c.warehname 物流中心,
       a.goodsownerid 货主ID,
       d.goodsownername 货主名称,
       '福州中宏仓库' 仓库名称,
       '1-平库' 库区,
       count(1) 复核条数
  from gsp_st_io_record a,
       wms_st_io_doc   b,
       tpl_warehouse   c,
       tpl_goodsowner  d
 where a.inoutid = b.inoutid
   and a.keepdate >= to_date('2019-01-01', 'yyyy-mm-dd') --复核时间
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and b.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid = 2
 group by to_char(a.keepdate, 'yyyy-mm-dd'),
          a.warehid,
          c.warehname,
          a.goodsownerid,
          d.goodsownername
 order by to_char(a.keepdate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_FH_V3","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_FH_V3"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""复核条数"") AS 
  select to_char(a.keepdate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       c.warehname 物流中心,
       a.goodsownerid 货主ID,
       d.goodsownername 货主名称,
       c.warehname 仓库名称,
       e.ddlname 库区,
       count(1) 复核条数
  from gsp_st_io_record a,
       wms_st_io_doc b,
       tpl_warehouse c,
       tpl_goodsowner d,
       (select x.sectionid, y.ddlname
          from Wms_St_Section_Def x, pub_ddl_dtl y
         where x.sectionclass = y.ddlid
           and y.sysid = 1050) e
 where a.inoutid = b.inoutid
   and a.keepdate between to_date('2022-01-01', 'yyyy-mm-dd') and to_date('2023-01-01', 'yyyy-mm-dd') --复核时间
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and b.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and b.sectionid = e.sectionid(+)
   and nvl(b.autotaskflag,0)=0
   and a.warehid=10
 group by to_char(a.keepdate, 'yyyy-mm-dd'),
          a.warehid,
          c.warehname,
          a.goodsownerid,
          d.goodsownername,
          e.ddlname
 order by to_char(a.keepdate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_IN_TJ_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_IN_TJ_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"") AS 
  select to_char(a.rffindate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       b.warehname 物流中心,
       a.goodsownerid 货主ID,
       c.goodsownername 货主名称,
       '调剂库' 仓库名称,
       '调剂' 库区,
       sum((case
             when nvl(a.scatterqty, 0) <> 0 then
              1
             else
              0
           end)) 散件条数,
       sum(nvl(a.wholeqty, 0)) 整件件数
  from wms_st_io_doc a,
       tpl_warehouse b,
       tpl_goodsowner c,
       (select x.sectionid, y.ddlname
          from Wms_St_Section_Def x, pub_ddl_dtl y
         where x.sectionclass = y.ddlid
           and y.sysid = 1050) d
 where a.comefrom = 1 --入库
   and a.rffindate >= to_date('2019-01-01', 'yyyy-mm-dd') --任务完成时间
   and a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid = 1
   and a.sectionid = d.sectionid(+)
   and nvl(a.autotaskflag,0)=0
   and a.goodsownerid = 2
   and a.goodsstatusid = 9
 group by to_char(a.rffindate, 'yyyy-mm-dd'),
          a.warehid,
          b.warehname,
          a.goodsownerid,
          c.goodsownername
 order by to_char(a.rffindate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_IN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_IN_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"") AS 
  select to_char(a.rffindate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       b.warehname 物流中心,
       a.goodsownerid 货主ID,
       c.goodsownername 货主名称,
       (case
         when a.sectionid in
              (select a1.sectionid
                 from wms_st_section_def a1
                where a1.areaid in
                      (2663, 2664, 2665, 2683, 2703, 2723, 2763, 2903, 2923)) then
          '6#仓库'
         else
          '4#仓库'
       end) 仓库名称,
       d.ddlname 库区,
       sum((case
             when nvl(a.scatterqty, 0) <> 0 then
              1
             else
              0
           end)) 散件条数,
       sum(nvl(a.wholeqty, 0)) 整件件数
  from wms_st_io_doc a,
       tpl_warehouse b,
       tpl_goodsowner c,
       (select x.sectionid, y.ddlname
          from Wms_St_Section_Def x, pub_ddl_dtl y
         where x.sectionclass = y.ddlid
           and y.sysid = 1050) d
 where a.comefrom = 1 --入库
   and a.rffindate >= to_date('2019-01-01', 'yyyy-mm-dd') --任务完成时间
   and a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid = 1
   --and a.goodsownerid <> 550 从2022年5月份开始要取海峡
   and a.sectionid = d.sectionid(+)
   and nvl(a.autotaskflag,0)=0
 group by to_char(a.rffindate, 'yyyy-mm-dd'),
          a.warehid,
          b.warehname,
          a.goodsownerid,
          c.goodsownername,
          (case
            when a.sectionid in
                 (select a1.sectionid
                    from wms_st_section_def a1
                   where a1.areaid in
                         (2663, 2664, 2665, 2683, 2703, 2723, 2763, 2903, 2923)) then
             '6#仓库'
            else
             '4#仓库'
          end),
          d.ddlname
 order by to_char(a.rffindate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_IN_V2","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_IN_V2"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"") AS 
  select to_char(a.rffindate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       b.warehname 物流中心,
       a.goodsownerid 货主ID,
       c.goodsownername 货主名称,
       '福州中宏仓库' 仓库名称,
       '1-平库' 库区,
       sum((case
             when nvl(a.scatterqty, 0) <> 0 then
              1
             else
              0
           end)) 散件条数,
       sum(nvl(a.wholeqty, 0)) 整件件数
  from wms_st_io_doc a,
       tpl_warehouse   b,
       tpl_goodsowner  c
 where a.comefrom = 1 --入库
   and a.rffindate >= to_date('2019-01-01', 'yyyy-mm-dd') --任务完成时间
   and a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid = 2
 group by to_char(a.rffindate, 'yyyy-mm-dd'),
          a.warehid,
          b.warehname,
          a.goodsownerid,
          c.goodsownername
 order by to_char(a.rffindate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_IN_V3","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_IN_V3"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"") AS 
  select to_char(a.rffindate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       b.warehname 物流中心,
       a.goodsownerid 货主ID,
       c.goodsownername 货主名称,
       b.warehname 仓库名称,
       d.ddlname 库区,
       sum((case
             when nvl(a.scatterqty, 0) <> 0 then
              1
             else
              0
           end)) 散件条数,
       sum(nvl(a.wholeqty, 0)) 整件件数
  from wms_st_io_doc a,
       tpl_warehouse b,
       tpl_goodsowner c,
       (select x.sectionid, y.ddlname
          from Wms_St_Section_Def x, pub_ddl_dtl y
         where x.sectionclass = y.ddlid
           and y.sysid = 1050) d
 where a.comefrom = 1 --入库
   and a.rffindate between to_date('2022-01-01', 'yyyy-mm-dd') and to_date('2023-01-01', 'yyyy-mm-dd') --任务完成时间
   and a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.sectionid = d.sectionid(+)
   and nvl(a.autotaskflag,0)=0
   and a.warehid=10
 group by to_char(a.rffindate, 'yyyy-mm-dd'),
          a.warehid,
          b.warehname,
          a.goodsownerid,
          c.goodsownername,
          d.ddlname
 order by to_char(a.rffindate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_OUT_TJ_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_OUT_TJ_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"") AS 
  select to_char(a.rffindate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       b.warehname 物流中心,
       a.goodsownerid 货主ID,
       c.goodsownername 货主名称,
       '调剂库' 仓库名称,
       '调剂' 库区,
       sum((case
             when nvl(a.scatterqty, 0) <> 0 then
              1
             else
              0
           end)) 散件条数,
       sum(nvl(a.wholeqty, 0)) 整件件数
  from wms_st_io_doc a,
       tpl_warehouse b,
       tpl_goodsowner c,
       (select x.sectionid, y.ddlname
          from Wms_St_Section_Def x, pub_ddl_dtl y
         where x.sectionclass = y.ddlid
           and y.sysid = 1050) d
 where a.comefrom in (2, 3) --订单出库、波次出库
   and a.rffindate >= to_date('2019-01-01', 'yyyy-mm-dd') --任务完成时间
   and a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid in (1, 2, 14)
   and a.sectionid = d.sectionid(+)
   and nvl(a.autotaskflag,0)=0
   and a.goodsownerid = 2
   and a.goodsstatusid = 9
 group by to_char(a.rffindate, 'yyyy-mm-dd'),
          a.warehid,
          b.warehname,
          a.goodsownerid,
          c.goodsownername
 order by to_char(a.rffindate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_OUT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_OUT_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"") AS 
  select to_char(a.rffindate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       b.warehname 物流中心,
       a.goodsownerid 货主ID,
       c.goodsownername 货主名称,
       (case
         when a.sectionid in
              (select a1.sectionid
                 from wms_st_section_def a1
                where a1.areaid in
                      (2663, 2664, 2665, 2683, 2703, 2723, 2763, 2903, 2923)) then
          '6#仓库'
         else
          '4#仓库'
       end) 仓库名称,
       d.ddlname 库区,
       sum((case
             when nvl(a.scatterqty, 0) <> 0 then
              1
             else
              0
           end)) 散件条数,
       sum(nvl(a.wholeqty, 0)) 整件件数
  from wms_st_io_doc a,
       tpl_warehouse b,
       tpl_goodsowner c,
       (select x.sectionid, y.ddlname
          from Wms_St_Section_Def x, pub_ddl_dtl y
         where x.sectionclass = y.ddlid
           and y.sysid = 1050) d
 where a.comefrom in (2, 3) --订单出库、波次出库
   and a.rffindate >= to_date('2019-01-01', 'yyyy-mm-dd') --任务完成时间
   and a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid in (1, 2, 14)
   --and a.goodsownerid <> 550 从2022年5月份开始要取海峡
   and a.sectionid = d.sectionid(+)
   and nvl(a.autotaskflag,0)=0
 group by to_char(a.rffindate, 'yyyy-mm-dd'),
          a.warehid,
          b.warehname,
          a.goodsownerid,
          c.goodsownername,
          (case
            when a.sectionid in
                 (select a1.sectionid
                    from wms_st_section_def a1
                   where a1.areaid in
                         (2663, 2664, 2665, 2683, 2703, 2723, 2763, 2903, 2923)) then
             '6#仓库'
            else
             '4#仓库'
          end),
          d.ddlname
 order by to_char(a.rffindate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_OUT_V2","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_OUT_V2"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"") AS 
  select to_char(a.rffindate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       b.warehname 物流中心,
       a.goodsownerid 货主ID,
       c.goodsownername 货主名称,
       '福州中宏仓库' 仓库名称,
       '1-平库' 库区,
       sum((case
             when nvl(a.scatterqty, 0) <> 0 then
              1
             else
              0
           end)) 散件条数,
       sum(nvl(a.wholeqty, 0)) 整件件数
  from wms_st_io_doc a,
       tpl_warehouse   b,
       tpl_goodsowner  c
 where a.comefrom in (2,3) --订单出库、波次出库
   and a.rffindate >= to_date('2019-01-01', 'yyyy-mm-dd') --任务完成时间
   and a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid = 2
 group by to_char(a.rffindate, 'yyyy-mm-dd'),
          a.warehid,
          b.warehname,
          a.goodsownerid,
          c.goodsownername
 order by to_char(a.rffindate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_OUT_V3","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_OUT_V3"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"") AS 
  select to_char(a.rffindate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       b.warehname 物流中心,
       a.goodsownerid 货主ID,
       c.goodsownername 货主名称,
       b.warehname 仓库名称,
       d.ddlname 库区,
       sum((case
             when nvl(a.scatterqty, 0) <> 0 then
              1
             else
              0
           end)) 散件条数,
       sum(nvl(a.wholeqty, 0)) 整件件数
  from wms_st_io_doc a,
       tpl_warehouse b,
       tpl_goodsowner c,
       (select x.sectionid, y.ddlname
          from Wms_St_Section_Def x, pub_ddl_dtl y
         where x.sectionclass = y.ddlid
           and y.sysid = 1050) d
 where a.comefrom in (2, 3) --订单出库、波次出库
   and a.rffindate between to_date('2022-01-01', 'yyyy-mm-dd') and to_date('2023-01-01', 'yyyy-mm-dd') --任务完成时间
   and a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.sectionid = d.sectionid(+)
   and nvl(a.autotaskflag,0)=0
   and a.warehid=10
 group by to_char(a.rffindate, 'yyyy-mm-dd'),
          a.warehid,
          b.warehname,
          a.goodsownerid,
          c.goodsownername,
          d.ddlname
 order by to_char(a.rffindate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_STORAGE_TJ_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_STORAGE_TJ_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"") AS 
  select to_char(a.kcrq, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       f.warehname 物流中心,
       a.goodsownerid 货主ID,
       d.goodsownername 货主名称,
       '调剂库' 仓库名称,
       '调剂' 库区,
       count(distinct (case when c.areaflag=2 then a.posid else null end)) 散件条数,--一定用null才不会被计数
       sum((case when c.areaflag=1 then (decode(g.packsize,0,0,round(a.goodsqty/g.packsize,0))) else 0 end)) 整件件数
       --count(distinct a.posid) 货位数

  from wms_st_qty_lst_bak  a,
       --wms_pos_def         b,
       wms_st_area_def     c,
       tpl_goodsowner      d,
       --wms_st_section_def  e,
       tpl_warehouse       f,
       tpl_pub_goods_packs g,
       (select x.sectionid, y.ddlname
          from Wms_St_Section_Def x, pub_ddl_dtl y
         where x.sectionclass = y.ddlid
           and y.sysid = 1050) h
 where a.areaid = c.areaid(+)
   --and a.sectionid = e.sectionid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.warehid = f.warehid(+)
   and a.goodspackid=g.goodspackid(+)
   and a.warehid in (1,2,14)
   and a.goodsqty>0
   and a.sectionid=h.sectionid(+)
   and a.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.goodsownerid = 2
   and a.goodsstatusid = 9
 group by to_char(a.kcrq, 'yyyy-mm-dd'),
          a.warehid,
          f.warehname,
          a.goodsownerid,
          d.goodsownername,
          c.areaflag
 order by to_char(a.kcrq, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_STORAGE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_STORAGE_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"") AS 
  select to_char(a.kcrq, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       f.warehname 物流中心,
       a.goodsownerid 货主ID,
       d.goodsownername 货主名称,
       (case
         when a.sectionid in
              (select a1.sectionid
                 from wms_st_section_def a1
                where a1.areaid in
                      (2663, 2664, 2665, 2683, 2703, 2723, 2763, 2903, 2923)) then
          '6#仓库'
         else
          '4#仓库'
       end) 仓库名称,
       h.ddlname 库区,
       count(distinct (case when c.areaflag=2 then a.posid else null end)) 散件条数,--一定用null才不会被计数
       sum((case when c.areaflag=1 then (decode(g.packsize,0,0,round(a.goodsqty/g.packsize,0))) else 0 end)) 整件件数
       --count(distinct a.posid) 货位数

  from wms_st_qty_lst_bak  a,
       --wms_pos_def         b,
       wms_st_area_def     c,
       tpl_goodsowner      d,
       --wms_st_section_def  e,
       tpl_warehouse       f,
       tpl_pub_goods_packs g,
       (select x.sectionid, y.ddlname
          from Wms_St_Section_Def x, pub_ddl_dtl y
         where x.sectionclass = y.ddlid
           and y.sysid = 1050) h
 where a.areaid = c.areaid(+)
   --and a.sectionid = e.sectionid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.warehid = f.warehid(+)
   and a.goodspackid=g.goodspackid(+)
   and a.warehid in (1,2,14)
   and a.goodsqty>0
   --and a.goodsownerid<>550 从2022年5月份开始要取海峡
   and a.sectionid=h.sectionid(+)
   and a.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
 group by to_char(a.kcrq, 'yyyy-mm-dd'),
          a.warehid,
          f.warehname,
          a.goodsownerid,
          d.goodsownername,
          (case
            when a.sectionid in
                 (select a1.sectionid
                    from wms_st_section_def a1
                   where a1.areaid in
                         (2663, 2664, 2665, 2683, 2703, 2723, 2763, 2903, 2923)) then
             '6#仓库'
            else
             '4#仓库'
          end),
          h.ddlname,c.areaflag
 order by to_char(a.kcrq, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_STORAGE_V2","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_STORAGE_V2"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"") AS 
  select to_char(a.credate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       f.warehname 物流中心,
       a.goodsownerid 货主ID,
       d.goodsownername 货主名称,
       '福州中宏仓库' 仓库名称,
       '1-平库' 库区,
       count(distinct (case when c.areaflag=2 then a.posid else 0 end)) 散件条数,
       sum((case when c.areaflag=1 then (decode(g.packsize,0,0,round(a.goodsqty/g.packsize,0))) else 0 end)) 整件件数
       --count(distinct a.posid) 货位数

  from wms_st_qty_lst_his2 a,
       wms_pos_def         b,
       wms_st_area_def     c,
       tpl_goodsowner      d,
       wms_st_section_def  e,
       tpl_warehouse       f,
       tpl_pub_goods_packs g
 where a.posid = b.posid(+)
   and b.areaid = c.areaid(+)
   and b.sectionid = e.sectionid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.warehid = f.warehid(+)
   and a.goodspackid=g.goodspackid(+)
   and a.warehid in (2)
   and a.goodsqty>0
   and b.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
 group by to_char(a.credate, 'yyyy-mm-dd'),
          a.warehid,
          f.warehname,
          a.goodsownerid,
          d.goodsownername,
          c.areaflag
 order by to_char(a.credate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_STORAGE_V3","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_STORAGE_V3"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"") AS 
  select to_char(a.kcrq, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       f.warehname 物流中心,
       a.goodsownerid 货主ID,
       d.goodsownername 货主名称,
       f.warehname 仓库名称,
       h.ddlname 库区,
       count(distinct (case when c.areaflag=2 then a.posid else null end)) 散件条数,--一定用null才不会被计数
       sum((case when c.areaflag=1 then (decode(g.packsize,0,0,round(a.goodsqty/g.packsize,0))) else 0 end)) 整件件数
       --count(distinct a.posid) 货位数

  from wms_st_qty_lst_bak  a,
       --wms_pos_def         b,
       wms_st_area_def     c,
       tpl_goodsowner      d,
       --wms_st_section_def  e,
       tpl_warehouse       f,
       tpl_pub_goods_packs g,
       (select x.sectionid, y.ddlname
          from Wms_St_Section_Def x, pub_ddl_dtl y
         where x.sectionclass = y.ddlid
           and y.sysid = 1050) h
 where a.areaid = c.areaid(+)
   --and a.sectionid = e.sectionid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.warehid = f.warehid(+)
   and a.goodspackid=g.goodspackid(+)
   and a.warehid in (10)
   and a.goodsqty>0
   and a.sectionid=h.sectionid(+)
   and a.kcrq between to_date('2022-01-01', 'yyyy-mm-dd') and to_date('2023-01-01', 'yyyy-mm-dd')
   and a.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
 group by to_char(a.kcrq, 'yyyy-mm-dd'),
          a.warehid,
          f.warehname,
          a.goodsownerid,
          d.goodsownername,
          h.ddlname,c.areaflag
 order by to_char(a.kcrq, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_TRADE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_TRADE_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""移库条数"") AS 
  select to_char(a.rffindate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       b.warehname 物流中心,
       a.goodsownerid 货主ID,
       c.goodsownername 货主名称,
       (case
         when a.sectionid in
              (select a1.sectionid
                 from wms_st_section_def a1
                where a1.areaid in
                      (2663, 2664, 2665, 2683, 2703, 2723, 2763, 2903, 2923)) then
          '6#仓库'
         else
          '4#仓库'
       end) 仓库名称,
       d.ddlname 库区,
       count(1) 移库条数
  from wms_st_io_doc a,
       tpl_warehouse b,
       tpl_goodsowner c,
       (select x.sectionid, y.ddlname
          from Wms_St_Section_Def x, pub_ddl_dtl y
         where x.sectionclass = y.ddlid
           and y.sysid = 1050) d
 where a.comefrom in (4) --库内变动
   and a.operationtype in (28, 29) --移位、补货
   and a.rffindate >= to_date('2019-01-01', 'yyyy-mm-dd') --任务完成时间
   and a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid in (1, 2, 14)
      --and a.goodsownerid <> 550 从2022年5月份开始要取海峡
   and a.sectionid = d.sectionid(+)
   and not exists
 (select 1
          from wms_trade_dtl tr
         where tr.tradedtlid = a.sourceid
           and tr.tradeid in (4000555, 3996928, 3996929))
 group by to_char(a.rffindate, 'yyyy-mm-dd'),
          a.warehid,
          b.warehname,
          a.goodsownerid,
          c.goodsownername,
          (case
            when a.sectionid in (select a1.sectionid
                                   from wms_st_section_def a1
                                  where a1.areaid in (2663,
                                                      2664,
                                                      2665,
                                                      2683,
                                                      2703,
                                                      2723,
                                                      2763,
                                                      2903,
                                                      2923)) then
             '6#仓库'
            else
             '4#仓库'
          end),
          d.ddlname
 order by to_char(a.rffindate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_TRADE_V2","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_TRADE_V2"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""移库条数"") AS 
  select to_char(a.rffindate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       b.warehname 物流中心,
       a.goodsownerid 货主ID,
       c.goodsownername 货主名称,
       '福州中宏仓库' 仓库名称,
       '1-平库' 库区,
       count(1) 移库条数
  from wms_st_io_doc a,
       tpl_warehouse   b,
       tpl_goodsowner  c
 where a.comefrom in (4) --库内变动
   and a.operationtype in (28,29)--移位、补货
   and a.rffindate >= to_date('2019-01-01', 'yyyy-mm-dd') --任务完成时间
   and a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid = 2
 group by to_char(a.rffindate, 'yyyy-mm-dd'),
          a.warehid,
          b.warehname,
          a.goodsownerid,
          c.goodsownername
 order by to_char(a.rffindate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_TRADE_V3","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_TRADE_V3"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""移库条数"") AS 
  select to_char(a.rffindate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       b.warehname 物流中心,
       a.goodsownerid 货主ID,
       c.goodsownername 货主名称,
       b.warehname 仓库名称,
       d.ddlname 库区,
       count(1) 移库条数
  from wms_st_io_doc a,
       tpl_warehouse b,
       tpl_goodsowner c,
       (select x.sectionid, y.ddlname
          from Wms_St_Section_Def x, pub_ddl_dtl y
         where x.sectionclass = y.ddlid
           and y.sysid = 1050) d
 where a.comefrom in (4) --库内变动
   and a.operationtype in (28, 29) --移位、补货
   and a.rffindate between to_date('2022-01-01', 'yyyy-mm-dd') and to_date('2023-01-01', 'yyyy-mm-dd') --任务完成时间
   and a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.sectionid = d.sectionid(+)
   and a.warehid=10
 group by to_char(a.rffindate, 'yyyy-mm-dd'),
          a.warehid,
          b.warehname,
          a.goodsownerid,
          c.goodsownername,
          d.ddlname
 order by to_char(a.rffindate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_TR_PACKNUM_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_TR_PACKNUM_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""运输件数"") AS 
  select to_char(a.executetime, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       c.warehname 物流中心,
       b.goodsownerid 货主ID,
       f.goodsownername 货主名称,
       sum(nvl(decode(a.warehid,
                      1,
                      zx_get_boxno(b.wavedtlid),
                      b.scatterfinpacks),
               0) + nvl(decode(a.warehid,
                               1,
                               zx_get_wholeqty(b.wavedtlid),
                               b.wholefinpacks),
                        0)) 运输件数

  from wms_wave_doc a,
       wms_wave_dtl b,
       tpl_warehouse c,
       tms_tr_doc d,
       (select aa.dispatchid, aa.vehicleid
          from tms_dispatch_doc aa
         where aa.vehicleid not in (21,5423,6303,5503,6043)
        union all
        select bb.dispatchid, bb.vehicleid from tms_luyan_dispatch_doc bb where bb.vehicleid not in (21,5423,6303,5503,6043)) e,
       tpl_goodsowner f
 where a.wavedocid = b.waveid
   and a.warehid in (1,2,14)
   and a.executetime >= to_date('2019-01-01', 'yyyy-mm-dd') --这个日期要统一口径
   and a.warehid = c.warehid(+)
   and b.goodsownerid = f.goodsownerid(+)
   and b.usestatus = 3
   and b.wavedtlid = d.sourceid
   and d.sourcetable = 1 --单据来源:波次释放
   and d.dispatchid = e.dispatchid
   and nvl(d.autotaskflag,0)=0
 group by to_char(a.executetime, 'yyyy-mm-dd'),
          a.warehid,
          c.warehname,
          b.goodsownerid,
          f.goodsownername
 order by to_char(a.executetime, 'yyyy-mm-dd'), a.warehid, b.goodsownerid
"
"BS_WMS_TR_PACKNUM_V2","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_TR_PACKNUM_V2"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""运输件数"") AS 
  select to_char(a.executetime, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       c.warehname 物流中心,
       b.goodsownerid 货主ID,
       f.goodsownername 货主名称,
       sum(nvl(b.scatterfinpacks,0) + nvl(b.wholefinpacks,0)) 运输件数

  from wms_wave_doc a, wms_wave_dtl b, tpl_warehouse c, tpl_goodsowner f
 where a.wavedocid = b.waveid
   and a.warehid in (2)
   and a.executetime >= to_date('2019-01-01', 'yyyy-mm-dd') --这个日期要统一口径
   and a.warehid = c.warehid(+)
   and b.goodsownerid = f.goodsownerid(+)
   and b.usestatus = 3
 group by to_char(a.executetime, 'yyyy-mm-dd'),
          a.warehid,
          c.warehname,
          b.goodsownerid,
          f.goodsownername
 order by to_char(a.executetime, 'yyyy-mm-dd'),
          a.warehid,
          b.goodsownerid
"
"BS_WMS_TR_PACKNUM_V3","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_TR_PACKNUM_V3"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""运输件数"") AS 
  select to_char(a.executetime, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       c.warehname 物流中心,
       b.goodsownerid 货主ID,
       f.goodsownername 货主名称,
       sum(nvl(decode(a.warehid,
                      1,
                      zx_get_boxno(b.wavedtlid),
                      b.scatterfinpacks),
               0) + nvl(decode(a.warehid,
                               1,
                               zx_get_wholeqty(b.wavedtlid),
                               b.wholefinpacks),
                        0)) 运输件数

  from wms_wave_doc a,
       wms_wave_dtl b,
       tpl_warehouse c,
       tms_tr_doc d,
       (select aa.dispatchid, aa.vehicleid
          from tms_dispatch_doc aa
         where aa.vehicleid<>21
        union all
        select bb.dispatchid, bb.vehicleid from tms_luyan_dispatch_doc bb where bb.vehicleid<>21) e,
       tpl_goodsowner f
 where a.wavedocid = b.waveid
   and a.executetime between to_date('2022-01-01', 'yyyy-mm-dd') and to_date('2023-01-01', 'yyyy-mm-dd') --这个日期要统一口径
   and a.warehid = c.warehid(+)
   and b.goodsownerid = f.goodsownerid(+)
   and b.usestatus = 3
   and b.wavedtlid = d.sourceid
   and d.sourcetable = 1 --单据来源:波次释放
   and d.dispatchid = e.dispatchid
   and nvl(d.autotaskflag,0)=0
   and a.warehid=10
 group by to_char(a.executetime, 'yyyy-mm-dd'),
          a.warehid,
          c.warehname,
          b.goodsownerid,
          f.goodsownername
 order by to_char(a.executetime, 'yyyy-mm-dd'), a.warehid, b.goodsownerid
"
"BS_WMS_TR_PACKNUM_V_BAK","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_TR_PACKNUM_V_BAK"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""运输件数"") AS 
  select to_char(a.executetime, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       c.warehname 物流中心,
       b.goodsownerid 货主ID,
       f.goodsownername 货主名称,
       sum(nvl(decode(a.warehid,
                  1,
                  zx_get_boxno(b.wavedtlid),
                  b.scatterfinpacks),0) +
           nvl(decode(a.warehid,
                  1,
                  zx_get_wholeqty(b.wavedtlid),
                  b.wholefinpacks),0)) 运输件数

  from wms_wave_doc a, wms_wave_dtl b, tpl_warehouse c, tpl_goodsowner f
 where a.wavedocid = b.waveid
   and a.warehid in (1)
   and a.executetime >= to_date('2019-01-01', 'yyyy-mm-dd') --这个日期要统一口径
   and a.warehid = c.warehid(+)
   and b.goodsownerid = f.goodsownerid(+)
   and b.usestatus = 3
 group by to_char(a.executetime, 'yyyy-mm-dd'),
          a.warehid,
          c.warehname,
          b.goodsownerid,
          f.goodsownername
 order by to_char(a.executetime, 'yyyy-mm-dd'),
          a.warehid,
          b.goodsownerid
"
"BS_WMS_TR_PACKNUM_YLF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_TR_PACKNUM_YLF_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""运输件数"") AS 
  select to_char(a.credate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       c.warehname 物流中心,
       a.goodsownerid 货主ID,
       f.goodsownername 货主名称,
       sum(nvl(a.scatterpacks, 0) + nvl(a.wholepacks, 0)) 运输件数
  from tms_luyan_tr_doc a,
       tpl_warehouse c,
       (select aa.dispatchid, aa.vehicleid
          from tms_dispatch_doc aa
        union all
        select bb.dispatchid, bb.vehicleid from tms_luyan_dispatch_doc bb) e,
       tpl_goodsowner f
 where a.goodsownerid = 64
   and a.credate >= to_date('2019-01-01', 'yyyy-mm-dd') --这个日期要统一口径
   and a.warehid = c.warehid(+)
   and a.goodsownerid = f.goodsownerid(+)
   and a.dispatchid is not null
   and a.dispatchid = e.dispatchid
   and e.vehicleid not in
       (21)
 group by to_char(a.credate, 'yyyy-mm-dd'),
          a.warehid,
          c.warehname,
          a.goodsownerid,
          f.goodsownername
 order by to_char(a.credate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"BS_WMS_WORK_TJ_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_WORK_TJ_V"" (""数据来源"", ""类型"", ""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"", ""总数"") AS 
  select 'WMS' as 数据来源,
       '收货' as 类型,--收货
       a.日期,
       a.物流中心ID,
       a.物流中心,
       a.货主ID,
       a.货主名称,
       a.仓库名称,
       a.库区,
       a.散件条数,
       a.整件件数,
       (a.散件条数 + a.整件件数) 总数
  from bs_wms_check_tj_v a

union all

select 'WMS' as 数据来源,
       '验收' as 类型,--验收
       a.日期,
       a.物流中心ID,
       a.物流中心,
       a.货主ID,
       a.货主名称,
       a.仓库名称,
       a.库区,
       a.散件条数,
       a.整件件数,
       (a.散件条数 + a.整件件数) 总数
  from bs_wms_check_tj_v a

union all

select 'WMS' as 数据来源,
       '上架' as 类型,--上架
       b.日期,
       b.物流中心ID,
       b.物流中心,
       b.货主ID,
       b.货主名称,
       b.仓库名称,
       b.库区,
       b.散件条数,
       b.整件件数,
       (b.散件条数 + b.整件件数) 总数
  from bs_wms_in_tj_v b

union all

select 'WMS' as 数据来源,
       '拣货' as 类型,--拣货
       c.日期,
       c.物流中心ID,
       c.物流中心,
       c.货主ID,
       c.货主名称,
       c.仓库名称,
       c.库区,
       c.散件条数,
       c.整件件数,
       (c.散件条数 + c.整件件数) 总数
  from bs_wms_out_tj_v c

union all

select 'WMS' as 数据来源,
       '复核' as 类型,--复核
       d.日期,
       d.物流中心ID,
       d.物流中心,
       d.货主ID,
       d.货主名称,
       d.仓库名称,
       d.库区,
       0 散件条数,
       0 整件件数,
       d.复核条数 总数
  from bs_wms_fh_tj_v d

union all

select 'WMS' as 数据来源,
       '存储' as 类型,--存储
       g.日期,
       g.物流中心ID,
       g.物流中心,
       g.货主ID,
       g.货主名称,
       g.仓库名称,
       g.库区,
       g.散件条数,
       g.整件件数,
       g.散件条数+g.整件件数 总数
  from bs_wms_storage_tj_v g
"
"BS_WMS_WORK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_WORK_V"" (""数据来源"", ""类型"", ""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"", ""总数"") AS 
  select 'WMS' as 数据来源,
       '收货' as 类型,--收货
       a.日期,
       a.物流中心ID,
       a.物流中心,
       a.货主ID,
       a.货主名称,
       a.仓库名称,
       a.库区,
       a.散件条数,
       a.整件件数,
       (a.散件条数 + a.整件件数) 总数
  from bs_wms_check_v a

union all

select 'WMS' as 数据来源,
       '验收' as 类型,--验收
       a.日期,
       a.物流中心ID,
       a.物流中心,
       a.货主ID,
       a.货主名称,
       a.仓库名称,
       a.库区,
       a.散件条数,
       a.整件件数,
       (a.散件条数 + a.整件件数) 总数
  from bs_wms_check_v a

union all

select 'WMS' as 数据来源,
       '上架' as 类型,--上架
       b.日期,
       b.物流中心ID,
       b.物流中心,
       b.货主ID,
       b.货主名称,
       b.仓库名称,
       b.库区,
       b.散件条数,
       b.整件件数,
       (b.散件条数 + b.整件件数) 总数
  from bs_wms_in_v b

union all

select 'WMS' as 数据来源,
       '拣货' as 类型,--拣货
       c.日期,
       c.物流中心ID,
       c.物流中心,
       c.货主ID,
       c.货主名称,
       c.仓库名称,
       c.库区,
       c.散件条数,
       c.整件件数,
       (c.散件条数 + c.整件件数) 总数
  from bs_wms_out_v c

union all

select 'WMS' as 数据来源,
       '复核' as 类型,--复核
       d.日期,
       d.物流中心ID,
       d.物流中心,
       d.货主ID,
       d.货主名称,
       d.仓库名称,
       d.库区,
       0 散件条数,
       0 整件件数,
       d.复核条数 总数
  from bs_wms_fh_v d

union all

select 'WMS' as 数据来源,
       '库内移动' as 类型,--库内移动
       e.日期,
       e.物流中心ID,
       e.物流中心,
       e.货主ID,
       e.货主名称,
       e.仓库名称,
       e.库区,
       0 散件条数,
       0 整件件数,
       e.移库条数 总数
  from bs_wms_trade_v e

union all

select 'WMS' as 数据来源,
       '运输' as 类型,--运输
       f.日期,
       f.物流中心ID,
       f.物流中心,
       f.货主ID,
       f.货主名称,
       null as 仓库名称,
       null as 库区,
       0 散件条数,
       0 整件件数,
       f.运输件数 总数
  from bs_wms_tr_packnum_v f

union all

select 'WMS' as 数据来源,
       '存储' as 类型,--存储
       g.日期,
       g.物流中心ID,
       g.物流中心,
       g.货主ID,
       g.货主名称,
       g.仓库名称,
       g.库区,
       g.散件条数,
       g.整件件数,
       g.散件条数+g.整件件数 总数
  from bs_wms_storage_v g

union all
--燕来福运输数据
select 'WMS' as 数据来源,
       '运输' as 类型,--运输
       h.日期,
       h.物流中心ID,
       h.物流中心,
       h.货主ID,
       h.货主名称,
       null as 仓库名称,
       null as 库区,
       0 散件条数,
       0 整件件数,
       h.运输件数 总数
  from bs_wms_tr_packnum_ylf_v h
"
"BS_WMS_WORK_V2","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_WORK_V2"" (""数据来源"", ""类型"", ""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"", ""总数"") AS 
  select 'WMS' as 数据来源,
       '收货' as 类型,--收货
       a.日期,
       a.物流中心ID,
       a.物流中心,
       a.货主ID,
       a.货主名称,
       a.仓库名称,
       a.库区,
       a.散件条数,
       a.整件件数,
       (a.散件条数 + a.整件件数) 总数
  from bs_wms_check_v2 a

union all

select 'WMS' as 数据来源,
       '验收' as 类型,--验收
       a.日期,
       a.物流中心ID,
       a.物流中心,
       a.货主ID,
       a.货主名称,
       a.仓库名称,
       a.库区,
       a.散件条数,
       a.整件件数,
       (a.散件条数 + a.整件件数) 总数
  from bs_wms_check_v2 a

union all

select 'WMS' as 数据来源,
       '上架' as 类型,--上架
       b.日期,
       b.物流中心ID,
       b.物流中心,
       b.货主ID,
       b.货主名称,
       b.仓库名称,
       b.库区,
       b.散件条数,
       b.整件件数,
       (b.散件条数 + b.整件件数) 总数
  from bs_wms_in_v2 b

union all

select 'WMS' as 数据来源,
       '拣货' as 类型,--拣货
       c.日期,
       c.物流中心ID,
       c.物流中心,
       c.货主ID,
       c.货主名称,
       c.仓库名称,
       c.库区,
       c.散件条数,
       c.整件件数,
       (c.散件条数 + c.整件件数) 总数
  from bs_wms_out_v2 c

union all

select 'WMS' as 数据来源,
       '复核' as 类型,--复核
       d.日期,
       d.物流中心ID,
       d.物流中心,
       d.货主ID,
       d.货主名称,
       d.仓库名称,
       d.库区,
       0 散件条数,
       0 整件件数,
       d.复核条数 总数
  from bs_wms_fh_v2 d

union all

select 'WMS' as 数据来源,
       '库内移动' as 类型,--库内移动
       e.日期,
       e.物流中心ID,
       e.物流中心,
       e.货主ID,
       e.货主名称,
       e.仓库名称,
       e.库区,
       0 散件条数,
       0 整件件数,
       e.移库条数 总数
  from bs_wms_trade_v2 e

union all

select 'WMS' as 数据来源,
       '运输' as 类型,--运输
       f.日期,
       f.物流中心ID,
       f.物流中心,
       f.货主ID,
       f.货主名称,
       null as 仓库名称,
       null as 库区,
       0 散件条数,
       0 整件件数,
       f.运输件数 总数
  from bs_wms_tr_packnum_v2 f

union all


select 'WMS' as 数据来源,
       '存储' as 类型,--存储
       g.日期,
       g.物流中心ID,
       g.物流中心,
       g.货主ID,
       g.货主名称,
       g.仓库名称,
       g.库区,
       g.散件条数,
       g.整件件数,
       g.散件条数+g.整件件数 总数
  from bs_wms_storage_v2 g
"
"BS_WMS_WORK_V3","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""BS_WMS_WORK_V3"" (""数据来源"", ""类型"", ""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""仓库名称"", ""库区"", ""散件条数"", ""整件件数"", ""总数"") AS 
  select 'WMS' as 数据来源,
       '收货' as 类型,--收货
       a.日期,
       a.物流中心ID,
       a.物流中心,
       a.货主ID,
       a.货主名称,
       a.仓库名称,
       a.库区,
       a.散件条数,
       a.整件件数,
       (a.散件条数 + a.整件件数) 总数
  from bs_wms_check_v3 a

union all

select 'WMS' as 数据来源,
       '验收' as 类型,--验收
       a.日期,
       a.物流中心ID,
       a.物流中心,
       a.货主ID,
       a.货主名称,
       a.仓库名称,
       a.库区,
       a.散件条数,
       a.整件件数,
       (a.散件条数 + a.整件件数) 总数
  from bs_wms_check_v3 a

union all

select 'WMS' as 数据来源,
       '上架' as 类型,--上架
       b.日期,
       b.物流中心ID,
       b.物流中心,
       b.货主ID,
       b.货主名称,
       b.仓库名称,
       b.库区,
       b.散件条数,
       b.整件件数,
       (b.散件条数 + b.整件件数) 总数
  from bs_wms_in_v3 b

union all

select 'WMS' as 数据来源,
       '拣货' as 类型,--拣货
       c.日期,
       c.物流中心ID,
       c.物流中心,
       c.货主ID,
       c.货主名称,
       c.仓库名称,
       c.库区,
       c.散件条数,
       c.整件件数,
       (c.散件条数 + c.整件件数) 总数
  from bs_wms_out_v3 c

union all

select 'WMS' as 数据来源,
       '复核' as 类型,--复核
       d.日期,
       d.物流中心ID,
       d.物流中心,
       d.货主ID,
       d.货主名称,
       d.仓库名称,
       d.库区,
       0 散件条数,
       0 整件件数,
       d.复核条数 总数
  from bs_wms_fh_v3 d

union all

select 'WMS' as 数据来源,
       '库内移动' as 类型,--库内移动
       e.日期,
       e.物流中心ID,
       e.物流中心,
       e.货主ID,
       e.货主名称,
       e.仓库名称,
       e.库区,
       0 散件条数,
       0 整件件数,
       e.移库条数 总数
  from bs_wms_trade_v3 e

union all

select 'WMS' as 数据来源,
       '运输' as 类型,--运输
       f.日期,
       f.物流中心ID,
       f.物流中心,
       f.货主ID,
       f.货主名称,
       null as 仓库名称,
       null as 库区,
       0 散件条数,
       0 整件件数,
       f.运输件数 总数
  from bs_wms_tr_packnum_v3 f

union all

select 'WMS' as 数据来源,
       '存储' as 类型,--存储
       g.日期,
       g.物流中心ID,
       g.物流中心,
       g.货主ID,
       g.货主名称,
       g.仓库名称,
       g.库区,
       g.散件条数,
       g.整件件数,
       g.散件条数+g.整件件数 总数
  from bs_wms_storage_v3 g
"
"CC_VEHICLE_POINT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""CC_VEHICLE_POINT_V"" (""VEHICLEID"", ""POINTID"", ""DESCR"", ""LONGADDRESS"") AS 
  select a.vehicleid,
       a.pointid,
       c.descr,
       c.longaddress
  from CC_VEHICLE_POINT a,
  wms_sampling_point c
  where  a.pointid = c.pointid(+)
"
"CC_WARN_PROC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""CC_WARN_PROC_V"" (""SEQID"", ""VEHICLEID"", ""POINTID"", ""CREDATE"", ""TEMPRETURE"", ""HUMIDITY"", ""PROCMETHOD"", ""VEHICLENO"", ""DESCR"", ""LONGADDRESS"") AS 
  Select t.SEQID,
       t.VEHICLEID,
       t.POINTID,
       t.CREDATE,
       t.TEMPRETURE,
       t.HUMIDITY,
       t.PROCMETHOD,
       b.vehicleno,
       c.descr,
       c.longaddress
  From Cc_Warn_Proc t, Tms_Vehicle b, Wms_Sampling_Point c
 Where t.Vehicleid = b.Vehicleid
   And t.Pointid = c.Pointid
"
"CDCS_UPLOADINOUTWHDA_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""CDCS_UPLOADINOUTWHDA_V"" (""DISTCODE"", ""DISTNAME"", ""CUSCODE"", ""CUSNAME"", ""PROXYORGNAME"", ""DOCTYPE"", ""DOCNO"", ""DOCDATE"", ""DOCREMARK"", ""SERIALNUMBER"", ""ITEMCODE"", ""QTY"", ""UOM"", ""LOTS"", ""CARTON_NO"", ""PRODUCTPRICE"", ""SHIPMENT_NO"", ""PKGCODE"", ""IDENTIFICATION"", ""WHCODE"", ""WHNAME"", ""SURDATE"", ""DEPNAME"", ""DRNAME"", ""REGNO"", ""SURTYPE"", ""SURNUM"", ""PACKAGETYPE"", ""PACKAGEUOM"", ""PACKAGENUM"", ""INOUTID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select 'MDMUD026480' distcode,
       c.goodsownername distname,
       d.gcompanyid cuscode, --客户id
       d.companyname cusname,
       '' proxyorgname,
       decode(a.operationtype,11,'销售出库',12,'退货出库',a.operationtype) doctype,
       a.outid docno,
       to_char(a.credate, 'yyyy-mm-dd') docdate,
       --a.exportmemo docremark,
       '' docremark,
       '' serialnumber, --产品唯一码
       e.goodsownid itemcode, --id
       j.goodsqty qty,
       --decode(b.tradegoodspack,'盒','BX','箱','CA','打','DZ','个','EA','件','PC','包','PK','套','ST',b.tradegoodspack) uom,
       nvl(h.qspackname, b.tradegoodspack) uom,
       f.lotno lots,
       '' Carton_no, --箱号
       b.lydtlzxcolumn3 ProductPrice,
       '' Shipment_no, --运单号
       '' PKGCode, --PKG码
       '' Identification, --校验位
       a.warehid whcode,
       g.warehname whname,
       '' SurDate, --手术日期
       '' DepName,
       '' DrName,
       '' RegNo,
       '' SurType,
       '' SurNum,
       '' PackageType,
       '' PackageUom,
       '' PackageNum,
       j.inoutid,
       c.goodsownerid,
       c.goodsownername
  from wms_out_order         a,
       wms_out_order_dtl     b,
       tpl_goodsowner        c,
       tpl_go_company        d,
       tpl_goods             e,
       wms_goods_lot         f,
       tpl_warehouse         g,
       tpl_pub_packname_def  h,
       wms_out_order_lot_dtl i,
       wms_st_io_doc         j
 where a.outid = b.outid
   and b.outdtlid=i.outdtlid
   and i.wavegoodsdtlid=j.sourceid
   and a.usestatus=4 --物流出库订单状态【已出货】
   and j.comefrom=3  --出入库单据来源 波次出库
   and j.usestatus=1 --出入库状态【正式】
   and a.goodsownerid = c.goodsownerid(+)
   and a.reccompanyid = d.companyid(+)
   and j.ownergoodsid = e.ownergoodsid(+)
   and j.lotid = f.lotid(+)
   and a.warehid = g.warehid(+)
   and b.tradegoodspack = h.packname(+)
   and a.warehid = 2
   and a.goodsownerid IN (264,224)
   and j.ownergoodsid in
       (select DISTINCT t.ownergoodsid from tpl_goods t WHERE t.goodsownid IN (select to_char(goodsid) from
lyerp.pub_entry_goods_v WHERE goodsintegration='美国强生' AND entryid=264))

union all

select 'MDMUD026480' distcode,
       c.goodsownername distname,
       d.gcompanyid cuscode, --客户id
       d.companyname cusname,
       '' proxyorgname,
       decode(a.operationtype,1,'进货入库',7,'退货入库',a.operationtype) doctype,
       a.inid docno,   --取入库订单ID
       to_char(i.checkdate, 'yyyy-mm-dd') docdate,  --取验收时间
       to_char(i.receiveid) docremark,
       '' serialnumber, --产品唯一码
       e.goodsownid itemcode, --id
       j.goodsqty qty,
       --decode(b.tradegoodspack,'盒','BX','箱','CA','打','DZ','个','EA','件','PC','包','PK','套','ST',b.tradegoodspack) uom,
       nvl(h.qspackname, b.tradegoodspack) uom,
       f.lotno lots,
       '' Carton_no, --箱号
       '' ProductPrice, --单价
       '' Shipment_no, --运单号
       '' PKGCode, --PKG码
       '' Identification, --校验位
       a.warehid whcode,
       g.warehname whname,
       '' SurDate, --手术日期
       '' DepName,
       '' DrName,
       '' RegNo,
       '' SurType,
       '' SurNum,
       '' PackageType,
       '' PackageUom,
       '' PackageNum,
       j.inoutid,
       c.goodsownerid,
       c.goodsownername
  from wms_in_order         a,
       wms_in_order_dtl     b,
       tpl_goodsowner       c,
       tpl_go_company       d,
       tpl_goods            e,
       wms_goods_lot        f,
       tpl_warehouse        g,
       tpl_pub_packname_def h,
       wms_receive_dtl      i,
       wms_st_io_doc        j
 where a.inid = b.inid
   and b.indtlid = i.indtlid
   and i.receiveid=j.sourceid
   and j.comefrom=1  --出入库单据来源 入库
   and j.usestatus=1 --出入库状态【正式】
   and a.goodsownerid = c.goodsownerid(+)
   and a.sourcecompanyid = d.companyid(+)
   and j.ownergoodsid = e.ownergoodsid(+)
   and j.lotid = f.lotid(+)
   and a.warehid = g.warehid(+)
   and b.tradegoodspack = h.packname(+)
   and a.warehid IN (2,13)
   and a.goodsownerid IN (264,224)
   AND d.gcompanyid NOT IN (16110) --忽略上海泰美医疗器械有限公司
   AND a.credate > TO_DATE('2019-01-01 00:00:00', 'yyyy-mm-dd hh24:mi:ss')
   and j.ownergoodsid in
       (select DISTINCT t.ownergoodsid from tpl_goods t WHERE t.goodsownid IN (select to_char(goodsid) from
lyerp.pub_entry_goods_v WHERE goodsintegration='美国强生' AND entryid IN (264,224)))
"
"CDCS_WAREHOUSEDATA_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""CDCS_WAREHOUSEDATA_V"" (""ERPGOODSID"", ""ERPCUSTOMERID"", ""DISTCODE"", ""DISTNAME"", ""CUSCODE"", ""CUSNAME"", ""PROXYORGNAME"", ""DELIVERYNUMBER"", ""DELIVERYDATE"", ""SERIALNUMBER"", ""ITEMCODE"", ""QTY"", ""UOM"", ""LOTS"", ""CARTONNO"", ""SHIPMENTNO"", ""REMARK"", ""PKGCODE"", ""ITEMNAME"", ""PRODUCTLINE"", ""CHINESELABLE"", ""MANUFACTUREDATE"", ""EXPIRATIONDATE"", ""REGISTRATIONNO"", ""REGISTRATIONURL"", ""PACKAGENUMBER"", ""PURCHASEORDER"", ""MD5"", ""USESATAUS"", ""ENTRYID"") AS 
  SELECT b.materialnumber erpgoodsid,t.custcode erpcustomerid,a.""DISTCODE"",a.""DISTNAME"",a.""CUSCODE"",a.""CUSNAME"",a.""PROXYORGNAME"",a.""DELIVERYNUMBER"",a.""DELIVERYDATE"",a.""SERIALNUMBER"",a.""ITEMCODE"",a.""QTY"",a.""UOM"",a.""LOTS"",a.""CARTONNO"",a.""SHIPMENTNO"",a.""REMARK"",a.""PKGCODE"",a.""ITEMNAME"",a.""PRODUCTLINE"",a.""CHINESELABLE"",a.""MANUFACTUREDATE"",a.""EXPIRATIONDATE"",a.""REGISTRATIONNO"",a.""REGISTRATIONURL"",a.""PACKAGENUMBER"",a.""PURCHASEORDER"",a.""MD5"",a.usesataus,a.entryid FROM
cdcs_warehousedata a LEFT JOIN cdcs_goodsinfo b
ON a.itemcode=b.materialstcode AND a.entryid=b.entryid
LEFT JOIN  cdcs_cust t
ON a.distname=t.standardname AND a.entryid=t.entryid
"
"CDIWCS_WMS_DIFFQTY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""CDIWCS_WMS_DIFFQTY_V"" (""GOODSOWNERID"", ""OWNERGOODSID"", ""LOTID"", ""GOODSPACKID"", ""GOODSSTATUSID"", ""WMSGOODSQTY"", ""ROBOQTY"", ""DIFFQTY"") AS 
  select total.goodsownerid,
       total.ownergoodsid,
       total.lotid,
       total.goodspackid,
       total.goodsstatusid,
       total.wmsgoodsqty,
       total.roboqty,
       (nvl(total.wmsgoodsqty,0) - nvl(total.roboqty,0)) diffqty
  from (select pk,
               max(goodsownerid) goodsownerid,
               max(ownergoodsid) ownergoodsid,
               max(lotid) lotid,
               max(goodspackid) goodspackid,
               max(goodsstatusid) goodsstatusid,
               sum(goodsqty) wmsgoodsqty,
               max(roboqty) roboqty
          from (select a.goodsownerid||'-'||a.ownergoodsid || '-' || a.lotid || '-' ||
                       a.goodspackid||'-'||a.goodsstatusid PK,
                       a.goodsownerid,
                       a.ownergoodsid,
                       a.lotid,
                       a.goodspackid,
                       a.goodsstatusid,
                       a.goodsqty,
                       null roboqty
                  from (select t.goodsownerid,
                               t.ownergoodsid,
                               t.lotid,
                               t.goodspackid,
                               t.goodsstatusid,
                               sum(t.goodsqty) goodsqty
                          from Wms_St_Qty_Lst t,wms_st_section_def tt,wms_pos_def ttt
                         where --t.goodsownerid in (1,6,2,682)
                           t.posid=ttt.posid
                           and t.warehid=17
                           and ttt.sectionid=tt.sectionid
                           and tt.iwcs_flag=1
                      group by t.goodsownerid,t.ownergoodsid,t.lotid,t.goodspackid,t.goodsstatusid) a
                union all
                select b.goodsownerid||'-'||b.ownergoodsid || '-' || b.lotid || '-' ||
                       b.goodspackid||'-'||goodsstatusid PK,
                       b.goodsownerid,
                       b.ownergoodsid,
                       b.lotid,
                       b.goodspackid,
                       b.goodsstatusid,
                       null goodsqty,
                       b.goodsqty roboqty
                  from (select t.party_owner_id goodsownerid,
                               t.com_goods_id ownergoodsid,
                               t.com_lot_id lotid,
                               tt.goodspackid goodspackid,
                               t.com_inventory_type_id goodsstatusid,
                               sum(t.onavailable) goodsqty
                          from com_inv_fact@cdiwcs t ,tpl_goods_packs tt
                         where t.onavailable<>0
                           and t.package_id=tt.ownerpackid(+)
                         group by t.party_owner_id,t.com_goods_id,t.com_lot_id,tt.goodspackid,t.com_inventory_type_id) b)
         group by pk) total
"
"CDIWCS_WMS_DIFFQTY_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""CDIWCS_WMS_DIFFQTY_V1"" (""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""LOTID"", ""LOTNO"", ""GOODSPACKID"", ""OWNERPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSSTATUSID"", ""WMSGOODSQTY"", ""ROBOQTY"", ""DIFFQTY"") AS 
  select a.goodsownerid,
       e.goodsownername,
       a.ownergoodsid,
       b.goodsname,
       b.goodsengname,
       b.goodstype,
       b.tradepackname,
       b.factname,
       a.lotid,
       c.lotno,
       a.goodspackid,
       d.ownerpackid,
       d.packname ,
       d.packsize ,
       a.goodsstatusid,
       a.wmsgoodsqty ,
       a.roboqty,
       a.diffqty
  from cdiwcs_wms_diffqty_v        a,
       tpl_goods                   b,
       wms_goods_lot               c,
       tpl_goods_packs             d,
       tpl_goodsowner              e
where  a.ownergoodsid=b.ownergoodsid(+)
and    a.ownergoodsid=d.ownergoodsid(+)
and    a.lotid=c.lotid(+)
and    a.goodspackid=d.goodspackid(+)
and    a.goodsownerid=e.goodsownerid(+)
"
"CNBG_CAR_UPLOADHISTORYDATA_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""CNBG_CAR_UPLOADHISTORYDATA_V"" (""REFID"", ""STARTUPID"", ""T1"", ""TVALUE1"", ""T2"", ""TVALUE2"", ""T3"", ""TVALUE3"", ""T4"", ""TVALUE4"", ""T5"", ""TVALUE5"", ""RH1"", ""RHVALUE1"", ""RH2"", ""RHVALUE2"", ""RH3"", ""RHVALUE3"", ""RH4"", ""RHVALUE4"", ""RH5"", ""RHVALUE5"", ""LATITUDE"", ""LATITUDE_DIR"", ""LONGITUDE"", ""LONGITUDE_DIR"", ""TIME"") AS 
  select a.refid,
       f.trid as startupid,
       decode(a.selftype, 1, a.ainumber, -300) as t1,
       decode(a.selftype, 1, c.devtempdata, -300) as tvalue1,
       -300 as t2,
       -300 as tvalue2,
       -300 as t3,
       -300 as tvalue3,
       -300 as t4,
       -300 as tvalue4,
       -300 as t5,
       -300 as tvalue5,
       decode(a.selftype, 2, a.ainumber, -300) as rh1,
       decode(a.selftype, 2, c.devtempdata, -300) as rhvalue1,
       -300 as rh2,
       -300 as rhvalue2,
       -300 as rh3,
       -300 as rhvalue3,
       -300 as rh4,
       -300 as rhvalue4,
       -300 as rh5,
       -300 as rhvalue5,
       -300 as latitude,
       1 as latitude_dir,
       -300 as longitude,
       1 as longitude_dir,
       to_char(c.devtempdatetime, 'yyyy-mm-dd hh24:mi:ss') as time
  from cnbg_aiinfo                a,
       tms_luyan_devgroupcode_dtl b,
       tms_luyan_humiture_record  c,
       tms_dispatch_doc           d,
       tms_vehicle                e,
       tms_tr_doc                 f,
       tms_dispatch_dtl           g
 where a.type = 2 --车载类型
   and a.devdltid = b.devdtlid
   and b.devnum = e.devnum
   and d.vehicleid = e.vehicleid
   and e.devnum = c.devnum
   and d.dispatchid = f.dispatchid
   and d.dispatchid = g.dispatchid
   and f.comefrom in ( 1,2)--1WMS转入2手工录入
   and f.sourcetable in ( 1,3)--1波次释放3外部订单
   and f.trid = g.trid
   and nvl(g.usestatus, 0) in (0, 2)
   and g.chainusestatus=2
   and c.devtempdatetime between g.startdate and g.enddate
   and exists (select 1
          from cnbg_aiinfo x, tms_luyan_devgroupcode_dtl y
         where x.devdltid = y.devdtlid
           and y.devnum = b.devnum) --冷链车探头设备有和中生系统的设备关联
   and f.goodsownerid in (8261,8257) --后续替换为中生货主ID;240730加8257
"
"CNBG_CAR_UPLOADREALDATA_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""CNBG_CAR_UPLOADREALDATA_V"" (""SEQID"", ""CREDATE"", ""REFID"", ""DEVNUM"", ""T1"", ""TVALUE1"", ""T2"", ""TVALUE2"", ""T3"", ""TVALUE3"", ""T4"", ""TVALUE4"", ""T5"", ""TVALUE5"", ""RH1"", ""RHVALUE1"", ""RH2"", ""RHVALUE2"", ""RH3"", ""RHVALUE3"", ""RH4"", ""RHVALUE4"", ""RH5"", ""RHVALUE5"", ""LATITUDE"", ""LATITUDE_DIR"", ""LONGITUDE"", ""LONGITUDE_DIR"", ""TIME"", ""CONNECTSTATUS"") AS 
  select a.seqid,
       c.devtempdatetime as credate,
       a.refid,
       b.devnum,
       decode(a.selftype, 1, a.ainumber, -300) as t1,
       decode(a.selftype, 1, c.devtempdata, -300) as tvalue1,
       -300 as t2,
       -300 as tvalue2,
       -300 as t3,
       -300 as tvalue3,
       -300 as t4,
       -300 as tvalue4,
       -300 as t5,
       -300 as tvalue5,
       decode(a.selftype, 2, a.ainumber, -300) as rh1,
       decode(a.selftype, 2, c.devtempdata, -300) as rhvalue1,
       -300 as rh2,
       -300 as rhvalue2,
       -300 as rh3,
       -300 as rhvalue3,
       -300 as rh4,
       -300 as rhvalue4,
       -300 as rh5,
       -300 as rhvalue5,
       -300 as latitude,
       1 as latitude_dir,
       -300 as longitude,
       1 as longitude_dir,
       to_char(c.devtempdatetime, 'yyyy-mm-dd hh24:mi:ss') as time,
       2 as connectstatus
  from cnbg_aiinfo                a,
       tms_luyan_devgroupcode_dtl b,
       tms_luyan_humiture_record  c
 where a.type = 2 --车载类型
   and a.devdltid = b.devdtlid
   and b.devnum = c.devnum
   and c.devtempdatetime > a.last_time
"
"CNBG_INCUBATOR_UPLOADRAWDATA_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""CNBG_INCUBATOR_UPLOADRAWDATA_V"" (""SEQID"", ""CREDATE"", ""REFID"", ""T1"", ""TIME"", ""VALUE"") AS 
  select a.seqid,
       c.devtempdatetime as credate,
       a.refid,
       a.ainumber as t1,
       to_char(c.devtempdatetime, 'yyyy-mm-dd hh24:mi:ss') as time,
       decode(a.selftype, 1, c.devtempdata, 2, c.rh, c.devtempdata) as value
  from cnbg_aiinfo                a,
       tms_luyan_devgroupcode_dtl b,
       tms_luyan_humiture_record  c
 where a.type = 3 --保温箱类型
   and a.devdltid = b.devdtlid
   and b.devnum = c.devnum
   and c.devtempdatetime > a.last_time
"
"CNBG_LUYAN_TRDOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""CNBG_LUYAN_TRDOC_V"" (""STARTUPID"") AS 
  select a.trid as startupid
  from tms_tr_doc a, tms_dispatch_doc b, tms_dispatch_dtl c, tms_vehicle d
 where a.dispatchid = b.dispatchid
   and b.dispatchid = c.dispatchid
   and a.trid = c.trid
   and nvl(c.usestatus, 0) in (0, 2) --派车细单去掉作废状态
   and a.comefrom in ( 1,2)--1WMS转入2手工录入
   and a.sourcetable in ( 1,3)--1波次释放3外部订单
   and a.warehid = 2
   and a.goodsownerid in (8261,8257) --后续替换为中生货主ID-240730加8257
   and a.credate > to_Date('2024-01-01', 'yyyy-mm-dd')
   and nvl(a.cnbgflag, 0) = 0
   and b.vehicleid = d.vehicleid
   and d.devnum is not null
   and c.startdate is not null --有启运时间
   and c.enddate is not null --有到达时间
   and exists (select 1
          from cnbg_aiinfo x, tms_luyan_devgroupcode_dtl y
         where x.devdltid = y.devdtlid
           and y.devnum = d.devnum) --冷链车探头设备有和中生系统的设备关联
"
"CNBG_TRANSPORT_NODE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""CNBG_TRANSPORT_NODE_V"" (""TRID"", ""REFID"", ""REFTYPE"", ""TRANSPORTNUMBER"", ""STARTTIMEAT"", ""ENDTIMEAT"", ""SHIPTYPE"", ""UPLOADTYPE"", ""CDCDELIVERYSTATUS"") AS 
  select a.trid,
       ((select max(x.refid)
           from cnbg_aiinfo x, tms_luyan_devgroupcode_dtl y
          where x.devdltid = y.devdtlid
            and y.devnum = d.devnum)) as refid,
       ((select max(x.type)
           from cnbg_aiinfo x, tms_luyan_devgroupcode_dtl y
          where x.devdltid = y.devdtlid
            and y.devnum = d.devnum)) as reftype,
       nvl((select max(a.zxcolumn4)
          from wms_out_order a
         where a.wavedtlid = a.sourceid),a.trno) as transportnumber,
       to_char(c.startdate, 'yyyy-mm-dd hh24:mi:ss') as starttimeat,
       to_char(c.enddate, 'yyyy-mm-dd hh24:mi:ss') as endtimeat,
       2 as shiptype, --配送类型 1 直供 2 转储 (默认都传递2）
       1 as uploadtype, --卸货类型 1 中转卸货 2 疾控卸货 3 折返卸货
       1 cdcdeliverystatus --是否疾控配送 0 疾控配送 1 非疾控配送（默认）
  from tms_tr_doc a, tms_dispatch_doc b, tms_dispatch_dtl c, tms_vehicle d
 where a.dispatchid = b.dispatchid
   and b.dispatchid = c.dispatchid
   and a.trid = c.trid
   and nvl(c.usestatus, 0) in (0, 2) --派车细单去掉作废状态
   and a.comefrom in ( 1,2)--1WMS转入2手工录入
   and a.sourcetable in ( 1,3)--1波次释放3外部订单
   and a.warehid = 2
   and a.goodsownerid in (8261,8257) --后续替换为中生货主ID-240730加8257
   and a.credate > to_Date('2024-01-01', 'yyyy-mm-dd')
   and nvl(a.cnbgflag, 0) = 1 --车载历史记录上传成功的记录
   and b.vehicleid = d.vehicleid
   and d.devnum is not null
   and c.startdate is not null --有启运时间
   and c.enddate is not null --有到达时间
   and c.chainusestatus=2
   and exists (select 1
          from cnbg_aiinfo x, tms_luyan_devgroupcode_dtl y
         where x.devdltid = y.devdtlid
           and y.devnum = d.devnum) --冷链车探头设备有和中生系统的设备关联
"
"CNBG_WAREHOUSE_UPLOADRAWDATA_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""CNBG_WAREHOUSE_UPLOADRAWDATA_V"" (""SEQID"", ""CREDATE"", ""UPLOADTYPE"", ""ID"", ""TIME"", ""VALUE"") AS 
  select a.seqid,
       c.credate,
       2 as uploadtype,
       a.ainumber as id,
       to_char(c.credate, 'yyyy-mm-dd hh24:mi:ss') as time,
       decode(a.selftype, 1, c.temperature, 2, c.humidity, c.temperature) as value
  from cnbg_aiinfo                a,
       wms_luyan_devgroupcode_dtl b,
       wms_luyan_humiture_record  c
 where a.type = 1 --仓库类型
   and a.devdltid = b.devdtlid
   and b.hostcode = c.hostcode
   and b.metercode = c.metercode
   and c.credate > a.last_time
"
"ESHOP_RESULT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ESHOP_RESULT_V"" (""timestamp"", ""SALESID"", ""INPUTCODE"", ""LOGISTICSSTAT"", ""CONNECTOR"", ""REMARK"", ""CURRENTMAN"", ""UPDATETIME"", ""LNG"", ""LAT"", ""DESTINATIONLNG"", ""DESTINATIONLAT"") AS 
  select sysdate ""timestamp"", --时间戳
       a.zxcolumn4 as salesid, --ERP总销售单标识号
       a.outid as inputCode, --ERP出库单编码
       (case
         when a.usestatus = 1 then
          '您的订单是下单状态'
         when a.usestatus = 2 then
          '您的订单是待拣货状态'
         when a.usestatus = 3 then
          '您的订单是待复核状态'
         when a.usestatus = 4 and c.dispatchid is null then
          '您的订单已拣货完成,等待配送'
         when a.usestatus = 4 and c.dispatchid is not null then
          '您的订单正在配送,运输车辆是:' || f.vehicleno || ',送货人是:' || g.drivername
         when a.usestatus = 4 and c.dispatchid is not null and
              (d.usestatus = 5 or c.signflag = 3) then
          '您的订单已签收'
         else
          '异常物流信息'
       end) logisticsStat, --物流信息
       b.connector, --收货人
       null remark, --描述
       g.drivername currentMan, --当前配送人
       sysdate updateTime, --物流状态更新时间
       h.longitude lng, --经度
       h.latitude lat, --纬度
       b.longitude destinationLng, --目标地经度
       b.latitude destinationlat --目标地纬度
  from wms_out_order a,
       wms_transport_address b,
       tms_tr_doc c,
       (select aa.dispatchid, aa.driverid, aa.vehicleid, aa.usestatus
          from tms_dispatch_doc aa
        union all
        select bb.dispatchid, bb.driverid, bb.vehicleid, 1 usestatus
          from tms_luyan_dispatch_doc bb) d,
       sys_ddl_dtl e,
       tms_vehicle f,
       tms_driver g,
       tpl_warehouse h
 where a.usestatus <> 0
   and a.operationtype = 11
   and a.transid = b.transid(+)
   and a.wavedtlid = c.sourceid(+)
   and c.dispatchid = d.dispatchid(+)
   and e.sysid = 431
   and a.usestatus = e.ddlid(+)
   and d.vehicleid = f.vehicleid(+)
   and d.driverid = g.driverid(+)
   and a.warehid = h.warehid(+)
   --and a.zxcolumn4 = '10475114'
"
"FZLYBS_INBACK_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_INBACK_DTL_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""INDTLID"", ""GOODSCLASS"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""PACKSIZE"", ""AREANAME"", ""POSNAME"", ""SCATTERQTY"", ""WHOLEQTY"", ""COMPANYNAME"", ""CREDATE"", ""SHDATE"", ""CHECKDATE"", ""RFFINDATE"", ""KEEPDATE"", ""WORKDATE"", ""GOODSSTATUS"") AS 
  select t.warehid,--物流中心ID
       t.warehname,--物流中心
       t.goodsownerid,--货主ID
       t.goodsownername,--货主
       t.deptname,--货主部门
       t.indtlid,--订单号
       t.goodsclass,--药品大类
       t.goodsid,--货品主档ID
       t.ownergoodsid,--货主货品ID
       t.goodsname,--货品名称
       t.goodsengname,--商品名
       t.goodstype,--规格
       t.tradepackname,--单位
       t.factname,--生产厂家
       t.prodarea,--产地
       t.lotid,--批号ID
       t.lotno,--批号
       t.packsize,--包装数
       t.areaname,--库区
       t.posname,--货位
       t.scatterqty,--零散数
       t.wholeqty,--整件数
       t.companyname,--供货商
       t.credate,--入库开单时间
       t.shdate,--收货时间
       t.checkdate,--验收时间
       t.rffindate,--上架时间
       t.keepdate,--入库完成时间
       t.workdate,--订单处理时长(小时)
       decode(t.goodsstatusid,9,'B','A') goodsstatus --货品状态
  from fzlybs_inback_dtl@lybs t
"
"FZLYBS_INBACK_DTL_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_INBACK_DTL_V1"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""INDTLID"", ""GOODSCLASS"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""PACKSIZE"", ""AREANAME"", ""POSNAME"", ""SCATTERQTY"", ""WHOLEQTY"", ""COMPANYNAME"", ""CREDATE"", ""SHDATE"", ""CHECKDATE"", ""RFFINDATE"", ""KEEPDATE"", ""GOODSSTATUSID"", ""WORKDATE"") AS 
  select a.warehid,--物流中心ID
       b.warehname,--物流中心
       a.goodsownerid,--货主ID
       c.goodsownername,--货主
       (case when nvl(l.zxcolumn2,'9999') in ('黄炎镐','林菲菲') and l.goodsownerid=3 then '本部'
            when nvl(l.zxcolumn2,'9999') not in ('黄炎镐','林菲菲') and l.goodsownerid=3 then '集采'
       else null end) deptname,--二级货主-货主部门
       m.indtlid,--订单号
       e.goodsclass,--药品大类
       a.goodsid,--货品主档ID
       a.ownergoodsid,--货主货品ID
       i.goodsname,--货品名称
       i.goodsengname,--商品名
       i.goodstype,--规格
       i.tradepackname,--单位
       i.factname,--生产厂家
       i.prodarea,--产地
       a.lotid,--批号ID
       j.lotno,--批号
       h.packsize,--包装数
       g.areaname,--库区
       f.posname,--货位
       nvl(a.scatterqty,0) scatterqty,--零散数
       nvl(a.wholeqty,0) wholeqty,--整件数
       n.companyname,--供货商
       l.credate,--入库开单时间
       m.shdate,--收货时间
       k.checkdate,--验收时间
       a.rffindate,--上架时间
       a.keepdate,--入库完成时间
       a.goodsstatusid,--货品状态
       round((a.rffindate-m.shdate)*24,2) workdate--订单处理时长(小时)
/*
取数规则：
1.福州物流中心的数据
2.药品大类维护在WMS货品分类的选项字典细单pub_ddl_dtl.goodsclass
3.一个WMS分类只有属于一种药品大类，例如：冷藏-器械，归为冷链，但不归为器械
4.以订单的收货时间为时间基准条件
5.合同时间为入库订单的生成时间
6.上架时间为实物上架系统形成库存时间
7.入库完成时间为一张入库订单下的所有上架任务都完成后时间
8.二级货主-货主部门：只针对中宏，采购员'黄炎镐','林菲菲'算本部，除了这两人都算集采
9.取业务类型为销退、收配退的入库订单
*/
  from wms_st_io_doc          a,
       tpl_warehouse          b,
       tpl_goodsowner         c,
       wms_goods_feature      d,
       pub_ddl_dtl            e,
       wms_pos_def            f,
       wms_st_area_def        g,
       tpl_pub_goods_packs    h,
       tpl_goods              i,
       wms_goods_lot          j,
       wms_receive_dtl        k,
       wms_in_order           l,
       wms_in_order_dtl       m,
       tpl_go_company         n
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.warehid in (2, 14)
   and a.warehid = d.warehid
   and a.goodsid = d.goodsid
   and e.sysid = 9
   and d.goodsclass = e.ddlid
   and a.posid=f.posid
   and f.areaid=g.areaid
   and a.goodspackid=h.goodspackid
   and a.ownergoodsid=i.ownergoodsid
   and a.lotid=j.lotid
   and a.comefrom=1 --入库上架
   and a.sourceid=k.receiveid
   and m.porderstatus=5 --上架完成
   and l.inid=m.inid
   and m.indtlid=k.indtlid
   and a.companyid=n.companyid(+)
   and l.operationtype in (7,42)
   and m.shdate>to_Date('2020-01-01','yyyy-mm-dd')
"
"FZLYBS_INBACK_DTL_YZJ_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_INBACK_DTL_YZJ_V1"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""INDTLID"", ""GOODSCLASS"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""PACKSIZE"", ""AREANAME"", ""POSNAME"", ""SCATTERQTY"", ""WHOLEQTY"", ""COMPANYNAME"", ""CREDATE"", ""SHDATE"", ""CHECKDATE"", ""RFFINDATE"", ""KEEPDATE"", ""WORKDATE"") AS 
  select a.warehid,--物流中心ID
       b.warehname,--物流中心
       a.goodsownerid,--货主ID
       c.goodsownername,--货主
       (case when nvl(l.zxcolumn2,'9999') in ('黄炎镐','林菲菲') and l.goodsownerid=3 then '本部'
            when nvl(l.zxcolumn2,'9999') not in ('黄炎镐','林菲菲') and l.goodsownerid=3 then '集采'
       else null end) deptname,--二级货主-货主部门
       m.indtlid,--订单号
       e.goodsclass,--药品大类
       a.goodsid,--货品主档ID
       a.ownergoodsid,--货主货品ID
       i.goodsname,--货品名称
       i.goodsengname,--商品名
       i.goodstype,--规格
       i.tradepackname,--单位
       i.factname,--生产厂家
       i.prodarea,--产地
       a.lotid,--批号ID
       j.lotno,--批号
       h.packsize,--包装数
       g.areaname,--库区
       f.posname,--货位
       nvl(a.scatterqty,0) scatterqty,--零散数
       nvl(a.wholeqty,0) wholeqty,--整件数
       n.companyname,--供货商
       l.credate,--入库开单时间
       m.shdate,--收货时间
       k.checkdate,--验收时间
       a.rffindate,--上架时间
       a.keepdate,--入库完成时间
       round((a.rffindate-m.shdate)*24,2) workdate--订单处理时长(小时)
/*
取数规则：
1.福州物流中心的数据
2.药品大类维护在WMS货品分类的选项字典细单pub_ddl_dtl.goodsclass
3.一个WMS分类只有属于一种药品大类，例如：冷藏-器械，归为冷链，但不归为器械
4.以订单的收货时间为时间基准条件
5.合同时间为入库订单的生成时间
6.上架时间为实物上架系统形成库存时间
7.入库完成时间为一张入库订单下的所有上架任务都完成后时间
8.二级货主-货主部门：只针对中宏，采购员'黄炎镐','林菲菲'算本部，除了这两人都算集采
9.取业务类型为销退、收配退的入库订单
*/
  from wms_st_io_doc          a,
       tpl_warehouse          b,
       tpl_goodsowner         c,
       wms_goods_feature      d,
       pub_ddl_dtl            e,
       wms_pos_def            f,
       wms_st_area_def        g,
       tpl_pub_goods_packs    h,
       tpl_goods              i,
       wms_goods_lot          j,
       wms_receive_dtl        k,
       wms_in_order           l,
       wms_in_order_dtl       m,
       tpl_go_company         n
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.warehid in (2, 14)
   and a.warehid = d.warehid
   and a.goodsid = d.goodsid
   and e.sysid = 9
   and d.goodsclass = e.ddlid
   and a.posid=f.posid
   and f.areaid=g.areaid
   and a.goodspackid=h.goodspackid
   and a.ownergoodsid=i.ownergoodsid
   and a.lotid=j.lotid
   and a.comefrom=1 --入库上架
   and a.sourceid=k.receiveid
   and m.porderstatus=5 --上架完成
   and l.inid=m.inid
   and m.indtlid=k.indtlid
   and a.companyid=n.companyid(+)
   and l.operationtype in (7,42)
   and (a.goodsownerid in
       (select t.goodsownerid
           from tpl_goodsowner t
          where t.goodsownername like '%扬子江药业%') or
       a.ownergoodsid in (select tt.ownergoodsid from zx_yzj_goods tt))
   and m.shdate>to_Date('2020-01-01','yyyy-mm-dd')
"
"FZLYBS_INBACK_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_INBACK_ORDER_V"" (""收货日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主"", ""货主部门"", ""药品大类"", ""货品状态"", ""订单数"", ""条目数"", ""整件条目数"", ""整件件数"", ""散件条目数"", ""散件零散数"", ""平均订单入库时长"") AS 
  select 收货日期,
       物流中心ID,
       物流中心,
       货主ID,
       货主,
       货主部门,
       药品大类,
       货品状态,
       订单数,
       条目数,
       整件条目数,
       整件件数,
       散件条目数,
       散件零散数,
       平均订单入库时长
  from fzlybs_inback_order@lybs t
"
"FZLYBS_INBACK_ORDER_YZJ_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_INBACK_ORDER_YZJ_V"" (""收货日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主"", ""货主部门"", ""药品大类"", ""订单数"", ""条目数"", ""整件条目数"", ""整件件数"", ""散件条目数"", ""散件零散数"", ""平均订单入库时长"") AS 
  select 收货日期,
       物流中心ID,
       物流中心,
       货主ID,
       货主,
       货主部门,
       药品大类,
       订单数,
       条目数,
       整件条目数,
       整件件数,
       散件条目数,
       散件零散数,
       平均订单入库时长
  from fzlybs_inback_order_yzj@lybs t
"
"FZLYBS_IN_ORDER_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_IN_ORDER_DTL_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""INDTLID"", ""GOODSCLASS"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""PACKSIZE"", ""AREANAME"", ""POSNAME"", ""SCATTERQTY"", ""WHOLEQTY"", ""COMPANYNAME"", ""CREDATE"", ""SHDATE"", ""CHECKDATE"", ""RFFINDATE"", ""KEEPDATE"", ""WORKDATE"", ""GOODSSTATUS"", ""INID"") AS 
  select t.warehid,--物流中心ID
       t.warehname,--物流中心
       t.goodsownerid,--货主ID
       t.goodsownername,--货主
       t.deptname,--货主部门
       t.indtlid,--订单号
       t.goodsclass,--药品大类
       t.goodsid,--货品主档ID
       t.ownergoodsid,--货主货品ID
       t.goodsname,--货品名称
       t.goodsengname,--商品名
       t.goodstype,--规格
       t.tradepackname,--单位
       t.factname,--生产厂家
       t.prodarea,--产地
       t.lotid,--批号ID
       t.lotno,--批号
       t.packsize,--包装数
       t.areaname,--库区
       t.posname,--货位
       t.scatterqty,--零散数
       t.wholeqty,--整件数
       t.companyname,--供货商
       t.credate,--入库开单时间
       t.shdate,--收货时间
       t.checkdate,--验收时间
       t.rffindate,--上架时间
       t.keepdate,--入库完成时间
       t.workdate ,--订单处理时长(小时)
       decode(t.goodsstatusid,9,'B','A') goodsstatus ,--货品状态
       t.inid --入库订单ID
  from fzlybs_in_order_dtl@lybs t
"
"FZLYBS_IN_ORDER_DTL_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_IN_ORDER_DTL_V1"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""INDTLID"", ""GOODSCLASS"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""PACKSIZE"", ""AREANAME"", ""POSNAME"", ""SCATTERQTY"", ""WHOLEQTY"", ""COMPANYNAME"", ""CREDATE"", ""SHDATE"", ""CHECKDATE"", ""RFFINDATE"", ""KEEPDATE"", ""GOODSSTATUSID"", ""WORKDATE"", ""INID"") AS 
  select a.warehid,--物流中心ID
       b.warehname,--物流中心
       a.goodsownerid,--货主ID
       c.goodsownername,--货主
       (case when nvl(l.zxcolumn2,'9999') in ('黄炎镐','林菲菲') and l.goodsownerid=3 then '本部'
            when nvl(l.zxcolumn2,'9999') not in ('黄炎镐','林菲菲') and l.goodsownerid=3 then '集采'
       else null end) deptname,--二级货主-货主部门
       m.indtlid,--订单号
       e.goodsclass,--药品大类
       a.goodsid,--货品主档ID
       a.ownergoodsid,--货主货品ID
       i.goodsname,--货品名称
       i.goodsengname,--商品名
       i.goodstype,--规格
       i.tradepackname,--单位
       i.factname,--生产厂家
       i.prodarea,--产地
       a.lotid,--批号ID
       j.lotno,--批号
       h.packsize,--包装数
       g.areaname,--库区
       f.posname,--货位
       nvl(a.scatterqty,0) scatterqty,--零散数
       nvl(a.wholeqty,0) wholeqty,--整件数
       n.companyname,--供货商
       l.credate,--入库开单时间
       m.shdate,--收货时间
       k.checkdate,--验收时间
       a.rffindate,--上架时间
       a.keepdate,--入库完成时间
       a.goodsstatusid,--货品状态
       round((a.rffindate-m.shdate)*24,2) workdate ,--订单处理时长(小时)
       l.inid --入库订单ID
/*
取数规则：
1.福州物流中心的数据
2.药品大类维护在WMS货品分类的选项字典细单pub_ddl_dtl.goodsclass
3.一个WMS分类只有属于一种药品大类，例如：冷藏-器械，归为冷链，但不归为器械
4.以订单的收货时间为时间基准条件
5.合同时间为入库订单的生成时间
6.上架时间为实物上架系统形成库存时间
7.入库完成时间为一张入库订单下的所有上架任务都完成后时间
8.二级货主-货主部门：只针对中宏，采购员'黄炎镐','林菲菲'算本部，除了这两人都算集采
*/
  from wms_st_io_doc          a,
       tpl_warehouse          b,
       tpl_goodsowner         c,
       wms_goods_feature      d,
       pub_ddl_dtl            e,
       wms_pos_def            f,
       wms_st_area_def        g,
       tpl_pub_goods_packs    h,
       tpl_goods              i,
       wms_goods_lot          j,
       wms_receive_dtl        k,
       wms_in_order           l,
       wms_in_order_dtl       m,
       tpl_go_company         n
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.warehid in (2, 14)
   and a.warehid = d.warehid
   and a.goodsid = d.goodsid
   and e.sysid = 9
   and d.goodsclass = e.ddlid
   and a.posid=f.posid
   and f.areaid=g.areaid
   and a.goodspackid=h.goodspackid
   and a.ownergoodsid=i.ownergoodsid
   and a.lotid=j.lotid
   and a.comefrom=1 --入库上架
   and a.sourceid=k.receiveid
   and m.porderstatus=5 --上架完成
   and l.inid=m.inid
   and m.indtlid=k.indtlid
   and a.companyid=n.companyid(+)
   and m.shdate>to_Date('2020-01-01','yyyy-mm-dd')
"
"FZLYBS_IN_ORDER_DTL_YZJ_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_IN_ORDER_DTL_YZJ_V1"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""INDTLID"", ""GOODSCLASS"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""PACKSIZE"", ""AREANAME"", ""POSNAME"", ""SCATTERQTY"", ""WHOLEQTY"", ""COMPANYNAME"", ""CREDATE"", ""SHDATE"", ""CHECKDATE"", ""RFFINDATE"", ""KEEPDATE"", ""GOODSSTATUSID"", ""WORKDATE"", ""INID"") AS 
  select a.warehid,--物流中心ID
       b.warehname,--物流中心
       a.goodsownerid,--货主ID
       c.goodsownername,--货主
       (case when nvl(l.zxcolumn2,'9999') in ('黄炎镐','林菲菲') and l.goodsownerid=3 then '本部'
            when nvl(l.zxcolumn2,'9999') not in ('黄炎镐','林菲菲') and l.goodsownerid=3 then '集采'
       else null end) deptname,--二级货主-货主部门
       m.indtlid,--订单号
       e.goodsclass,--药品大类
       a.goodsid,--货品主档ID
       a.ownergoodsid,--货主货品ID
       i.goodsname,--货品名称
       i.goodsengname,--商品名
       i.goodstype,--规格
       i.tradepackname,--单位
       i.factname,--生产厂家
       i.prodarea,--产地
       a.lotid,--批号ID
       j.lotno,--批号
       h.packsize,--包装数
       g.areaname,--库区
       f.posname,--货位
       nvl(a.scatterqty,0) scatterqty,--零散数
       nvl(a.wholeqty,0) wholeqty,--整件数
       n.companyname,--供货商
       l.credate,--入库开单时间
       m.shdate,--收货时间
       k.checkdate,--验收时间
       a.rffindate,--上架时间
       a.keepdate,--入库完成时间
       a.goodsstatusid,--货品状态
       round((a.rffindate-m.shdate)*24,2) workdate ,--订单处理时长(小时)
       l.inid --入库订单ID
/*
取数规则：
1.福州物流中心的数据
2.药品大类维护在WMS货品分类的选项字典细单pub_ddl_dtl.goodsclass
3.一个WMS分类只有属于一种药品大类，例如：冷藏-器械，归为冷链，但不归为器械
4.以订单的收货时间为时间基准条件
5.合同时间为入库订单的生成时间
6.上架时间为实物上架系统形成库存时间
7.入库完成时间为一张入库订单下的所有上架任务都完成后时间
8.二级货主-货主部门：只针对中宏，采购员'黄炎镐','林菲菲'算本部，除了这两人都算集采
*/
  from wms_st_io_doc          a,
       tpl_warehouse          b,
       tpl_goodsowner         c,
       wms_goods_feature      d,
       pub_ddl_dtl            e,
       wms_pos_def            f,
       wms_st_area_def        g,
       tpl_pub_goods_packs    h,
       tpl_goods              i,
       wms_goods_lot          j,
       wms_receive_dtl        k,
       wms_in_order           l,
       wms_in_order_dtl       m,
       tpl_go_company         n
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.warehid in (2, 14)
   and a.warehid = d.warehid
   and a.goodsid = d.goodsid
   and e.sysid = 9
   and d.goodsclass = e.ddlid
   and a.posid=f.posid
   and f.areaid=g.areaid
   and a.goodspackid=h.goodspackid
   and a.ownergoodsid=i.ownergoodsid
   and a.lotid=j.lotid
   and a.comefrom=1 --入库上架
   and a.sourceid=k.receiveid
   and m.porderstatus=5 --上架完成
   and l.inid=m.inid
   and m.indtlid=k.indtlid
   and a.companyid=n.companyid(+)
   and (a.goodsownerid in
       (select t.goodsownerid
           from tpl_goodsowner t
          where t.goodsownername like '%扬子江药业%') or
       a.ownergoodsid in (select tt.ownergoodsid from zx_yzj_goods tt))
   and m.shdate>to_Date('2020-01-01','yyyy-mm-dd')
"
"FZLYBS_IN_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_IN_ORDER_V"" (""收货日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主"", ""货主部门"", ""药品大类"", ""货品状态"", ""订单数"", ""条目数"", ""整件条目数"", ""整件件数"", ""散件条目数"", ""散件零散数"", ""平均订单入库时长"") AS 
  select 收货日期,
       物流中心ID,
       物流中心,
       货主ID,
       货主,
       货主部门,
       药品大类,
       货品状态,
       订单数,
       条目数,
       整件条目数,
       整件件数,
       散件条目数,
       散件零散数,
       平均订单入库时长
  from fzlybs_in_order@lybs t
"
"FZLYBS_IN_ORDER_YZJ_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_IN_ORDER_YZJ_V"" (""收货日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主"", ""货主部门"", ""药品大类"", ""货品状态"", ""订单数"", ""条目数"", ""整件条目数"", ""整件件数"", ""散件条目数"", ""散件零散数"", ""平均订单入库时长"") AS 
  select 收货日期,
       物流中心ID,
       物流中心,
       货主ID,
       货主,
       货主部门,
       药品大类,
       货品状态,
       订单数,
       条目数,
       整件条目数,
       整件件数,
       散件条目数,
       散件零散数,
       平均订单入库时长
  from fzlybs_in_order_yzj@lybs t
"
"FZLYBS_OUTBACK_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_OUTBACK_DTL_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""OUTDTLID"", ""OUTMODE"", ""GOODSCLASS"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""PACKSIZE"", ""AREANAME"", ""POSNAME"", ""SCATTERQTY"", ""WHOLEQTY"", ""COMPANYNAME"", ""CREDATE"", ""RFFINDATE"", ""KEEPDATE"", ""DISPATCHDATE"", ""REALDISPATCHDATE"", ""WORKDATE"", ""GOODSSTATUS"") AS 
  select t.warehid,--物流中心ID
       t.warehname,--物流中心
       t.goodsownerid,--货主ID
       t.goodsownername,--货主
       t.deptname,--货主部门
       t.outdtlid,--订单号
       t.outmode,--出货方式
       t.goodsclass,--药品大类
       t.goodsid,--货品主档ID
       t.ownergoodsid,--货主货品ID
       t.goodsname,--货品名称
       t.goodsengname,--商品名
       t.goodstype,--规格
       t.tradepackname,--单位
       t.factname,--生产厂家
       t.prodarea,--产地
       t.lotid,--批号ID
       t.lotno,--批号
       t.packsize,--包装数
       t.areaname,--库区
       t.posname,--货位
       t.scatterqty,--零散数
       t.wholeqty,--整件数
       t.companyname,--出库单位
       t.credate,--订单接收时间
       t.rffindate,--拣货完成时间
       t.keepdate,--复核装箱时间
       t.dispatchdate,--派车时间,
       t.realdispatchdate,--发车时间
       t.workdate ,--订单处理时长(小时)
       decode(t.goodsstatusid,9,'B','A') goodsstatus --货品状态
  from fzlybs_outback_dtl@lybs t
"
"FZLYBS_OUTBACK_DTL_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_OUTBACK_DTL_V1"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""OUTDTLID"", ""OUTMODE"", ""GOODSCLASS"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""PACKSIZE"", ""AREANAME"", ""POSNAME"", ""SCATTERQTY"", ""WHOLEQTY"", ""COMPANYNAME"", ""CREDATE"", ""RFFINDATE"", ""KEEPDATE"", ""DISPATCHDATE"", ""REALDISPATCHDATE"", ""GOODSSTATUSID"", ""WORKDATE"") AS 
  select a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主
       (case
         when nvl(l.salername, '9999') in ('黄炎镐', '林菲菲') and
              l.goodsownerid = 3 then
          '本部'
         when nvl(l.salername, '9999') not in ('黄炎镐', '林菲菲') and
              l.goodsownerid = 3 then
          '集采'
         else
          null
       end) deptname, --二级货主-货主部门
       m.outdtlid, --订单号
       decode(nvl(l.outmode, 0), 1, '送货', '自提') outmode,
       e.goodsclass, --药品大类
       a.goodsid, --货品主档ID
       a.ownergoodsid, --货主货品ID
       i.goodsname, --货品名称
       i.goodsengname, --商品名
       i.goodstype, --规格
       i.tradepackname, --单位
       i.factname, --生产厂家
       i.prodarea, --产地
       a.lotid, --批号ID
       j.lotno, --批号
       h.packsize, --包装数
       g.areaname, --库区
       f.posname, --货位
       nvl(a.scatterqty, 0) scatterqty, --零散数
       nvl(a.wholeqty, 0) wholeqty, --整件数
       n.companyname, --出库单位
       l.credate, --出库订单接收时间
       a.rffindate, --拣货完成时间
       a.keepdate, --复核完成时间
       o.credate dispatchdate,--派车时间
       o.realdispatchdate, --发车时间
       a.goodsstatusid,--货品状态
       round((a.keepdate-l.credate)*24,2) workdate--订单处理时长(小时)
/*
取数规则：
1.福州物流中心的数据
2.药品大类维护在WMS货品分类的选项字典细单pub_ddl_dtl.goodsclass
3.一个WMS分类只有属于一种药品大类，例如：冷藏-器械，归为冷链，但不归为器械
4.以出库订单的接收时间为时间基准条件
5.出入库上的任务完成时间为拣货完成时间
6.出入库上的记账时间为复核装箱完成时间
7.派车单上的制单时间为派车时间，自提或不派车则都为空
8.派车单上的发车时间为发车时间，自提或不派车则都为空
9.二级货主-货主部门：只针对中宏，采购员'黄炎镐','林菲菲'算本部，除了这两人都算集采
10.订单处理时长为从接收到订单时间到复核装箱完毕
11.业务类型为采购退货的出库订单
*/
  from wms_st_io_doc a,
       tpl_warehouse b,
       tpl_goodsowner c,
       wms_goods_feature d,
       pub_ddl_dtl e,
       wms_pos_def f,
       wms_st_area_def g,
       tpl_pub_goods_packs h,
       tpl_goods i,
       wms_goods_lot j,
       wms_out_order_lot_dtl k,
       wms_out_order l,
       wms_out_order_dtl m,
       tpl_go_company n,
       (select cc.sourceid, aa.credate, aa.realdispatchdate
          from tms_dispatch_doc aa, tms_dispatch_dtl bb, tms_tr_doc cc
         where aa.dispatchid = bb.dispatchid
           and bb.trid = cc.trid
           and aa.warehid in (2,14)
           and nvl(bb.usestatus,0)<>1 --细单不是作废状态
           and cc.comefrom=1 --运输任务单来源，WMS转入
           ) o
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.warehid in (2, 14)
   and a.warehid = d.warehid
   and a.goodsid = d.goodsid
   and e.sysid = 9
   and d.goodsclass = e.ddlid
   and a.posid = f.posid
   and f.areaid = g.areaid
   and a.goodspackid = h.goodspackid
   and a.ownergoodsid = i.ownergoodsid
   and a.lotid = j.lotid
   and a.comefrom = 3 --波次出库
   and a.sourceid = k.wavegoodsdtlid
   and l.usestatus = 4 --已出货
   and l.outid = m.outid
   and m.outdtlid = k.outdtlid
   and a.companyid = n.companyid(+)
   and l.wavedtlid=o.sourceid(+)
   and l.operationtype=12
   and l.credate > to_Date('2020-01-01', 'yyyy-mm-dd')
"
"FZLYBS_OUTBACK_DTL_YZJ_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_OUTBACK_DTL_YZJ_V1"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""OUTDTLID"", ""OUTMODE"", ""GOODSCLASS"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""PACKSIZE"", ""AREANAME"", ""POSNAME"", ""SCATTERQTY"", ""WHOLEQTY"", ""COMPANYNAME"", ""CREDATE"", ""RFFINDATE"", ""KEEPDATE"", ""DISPATCHDATE"", ""REALDISPATCHDATE"", ""WORKDATE"") AS 
  select a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主
       (case
         when nvl(l.salername, '9999') in ('黄炎镐', '林菲菲') and
              l.goodsownerid = 3 then
          '本部'
         when nvl(l.salername, '9999') not in ('黄炎镐', '林菲菲') and
              l.goodsownerid = 3 then
          '集采'
         else
          null
       end) deptname, --二级货主-货主部门
       m.outdtlid, --订单号
       decode(nvl(l.outmode, 0), 1, '送货', '自提') outmode,
       e.goodsclass, --药品大类
       a.goodsid, --货品主档ID
       a.ownergoodsid, --货主货品ID
       i.goodsname, --货品名称
       i.goodsengname, --商品名
       i.goodstype, --规格
       i.tradepackname, --单位
       i.factname, --生产厂家
       i.prodarea, --产地
       a.lotid, --批号ID
       j.lotno, --批号
       h.packsize, --包装数
       g.areaname, --库区
       f.posname, --货位
       nvl(a.scatterqty, 0) scatterqty, --零散数
       nvl(a.wholeqty, 0) wholeqty, --整件数
       n.companyname, --出库单位
       l.credate, --出库订单接收时间
       a.rffindate, --拣货完成时间
       a.keepdate, --复核完成时间
       o.credate dispatchdate,--派车时间
       o.realdispatchdate, --发车时间
       round((a.keepdate-l.credate)*24,2) workdate--订单处理时长(小时)
/*
取数规则：
1.福州物流中心的数据
2.药品大类维护在WMS货品分类的选项字典细单pub_ddl_dtl.goodsclass
3.一个WMS分类只有属于一种药品大类，例如：冷藏-器械，归为冷链，但不归为器械
4.以出库订单的接收时间为时间基准条件
5.出入库上的任务完成时间为拣货完成时间
6.出入库上的记账时间为复核装箱完成时间
7.派车单上的制单时间为派车时间，自提或不派车则都为空
8.派车单上的发车时间为发车时间，自提或不派车则都为空
9.二级货主-货主部门：只针对中宏，采购员'黄炎镐','林菲菲'算本部，除了这两人都算集采
10.订单处理时长为从接收到订单时间到复核装箱完毕
11.业务类型为采购退货的出库订单
*/
  from wms_st_io_doc a,
       tpl_warehouse b,
       tpl_goodsowner c,
       wms_goods_feature d,
       pub_ddl_dtl e,
       wms_pos_def f,
       wms_st_area_def g,
       tpl_pub_goods_packs h,
       tpl_goods i,
       wms_goods_lot j,
       wms_out_order_lot_dtl k,
       wms_out_order l,
       wms_out_order_dtl m,
       tpl_go_company n,
       (select cc.sourceid, aa.credate, aa.realdispatchdate
          from tms_dispatch_doc aa, tms_dispatch_dtl bb, tms_tr_doc cc
         where aa.dispatchid = bb.dispatchid
           and bb.trid = cc.trid
           and aa.warehid in (2,14)
           and nvl(bb.usestatus,0)<>1 --细单不是作废状态
           and cc.comefrom=1 --运输任务单来源，WMS转入
           ) o
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.warehid in (2, 14)
   and a.warehid = d.warehid
   and a.goodsid = d.goodsid
   and e.sysid = 9
   and d.goodsclass = e.ddlid
   and a.posid = f.posid
   and f.areaid = g.areaid
   and a.goodspackid = h.goodspackid
   and a.ownergoodsid = i.ownergoodsid
   and a.lotid = j.lotid
   and a.comefrom = 3 --波次出库
   and a.sourceid = k.wavegoodsdtlid
   and l.usestatus = 4 --已出货
   and l.outid = m.outid
   and m.outdtlid = k.outdtlid
   and a.companyid = n.companyid(+)
   and l.wavedtlid=o.sourceid(+)
   and l.operationtype=12
   and (a.goodsownerid in
       (select t.goodsownerid
           from tpl_goodsowner t
          where t.goodsownername like '%扬子江药业%') or
       a.ownergoodsid in (select tt.ownergoodsid from zx_yzj_goods tt))
   and l.credate > to_Date('2020-01-01', 'yyyy-mm-dd')
"
"FZLYBS_OUTBACK_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_OUTBACK_ORDER_V"" (""订单接收时间"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主"", ""货主部门"", ""药品大类"", ""出货方式"", ""货品状态"", ""订单数"", ""条目数"", ""整件条目数"", ""整件件数"", ""散件条目数"", ""散件零散数"", ""平均订单处理时长"") AS 
  select 订单接收时间,
       物流中心ID,
       物流中心,
       货主ID,
       货主,
       货主部门,
       药品大类,
       出货方式,
       货品状态,
       订单数,
       条目数,
       整件条目数,
       整件件数,
       散件条目数,
       散件零散数,
       平均订单处理时长
  from fzlybs_outback_order@lybs t
"
"FZLYBS_OUTBACK_ORDER_YZJ_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_OUTBACK_ORDER_YZJ_V"" (""订单接收时间"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主"", ""货主部门"", ""药品大类"", ""出货方式"", ""订单数"", ""条目数"", ""整件条目数"", ""整件件数"", ""散件条目数"", ""散件零散数"", ""平均订单处理时长"") AS 
  select 订单接收时间,
       物流中心ID,
       物流中心,
       货主ID,
       货主,
       货主部门,
       药品大类,
       出货方式,
       订单数,
       条目数,
       整件条目数,
       整件件数,
       散件条目数,
       散件零散数,
       平均订单处理时长
  from fzlybs_outback_order_yzj@lybs t
"
"FZLYBS_OUT_ORDER_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_OUT_ORDER_DTL_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""OUTDTLID"", ""OUTMODE"", ""GOODSCLASS"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""GOODSSTATUS"", ""PACKSIZE"", ""AREANAME"", ""POSNAME"", ""SCATTERQTY"", ""WHOLEQTY"", ""COMPANYNAME"", ""CREDATE"", ""RFFINDATE"", ""KEEPDATE"", ""DISPATCHDATE"", ""REALDISPATCHDATE"", ""WORKDATE"", ""OUTID"") AS 
  select t.warehid,--物流中心ID
       t.warehname,--物流中心
       t.goodsownerid,--货主ID
       t.goodsownername,--货主
       t.deptname,--货主部门
       t.outdtlid,--订单号
       t.outmode,--出货方式
       t.goodsclass,--药品大类
       t.goodsid,--货品主档ID
       t.ownergoodsid,--货主货品ID
       t.goodsname,--货品名称
       t.goodsengname,--商品名
       t.goodstype,--规格
       t.tradepackname,--单位
       t.factname,--生产厂家
       t.prodarea,--产地
       t.lotid,--批号ID
       t.lotno,--批号
       decode(t.goodsstatusid,9,'B','A') goodsstatus ,--货品状态
       t.packsize,--包装数
       t.areaname,--库区
       t.posname,--货位
       t.scatterqty,--零散数
       t.wholeqty,--整件数
       t.companyname,--出库单位
       t.credate,--订单接收时间
       t.rffindate,--拣货完成时间
       t.keepdate,--复核装箱时间
       t.dispatchdate,--派车时间,
       t.realdispatchdate,--发车时间
       t.workdate ,--订单处理时长(小时)
       t.outid --出库订单ID
  from fzlybs_out_order_dtl@lybs t
"
"FZLYBS_OUT_ORDER_DTL_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_OUT_ORDER_DTL_V1"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""OUTDTLID"", ""OUTMODE"", ""GOODSCLASS"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""GOODSSTATUSID"", ""PACKSIZE"", ""AREANAME"", ""POSNAME"", ""SCATTERQTY"", ""WHOLEQTY"", ""COMPANYNAME"", ""CREDATE"", ""RFFINDATE"", ""KEEPDATE"", ""DISPATCHDATE"", ""REALDISPATCHDATE"", ""WORKDATE"", ""OUTID"") AS 
  select a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主
       (case
         when nvl(l.salername, '9999') in ('黄炎镐', '林菲菲') and
              l.goodsownerid = 3 then
          '本部'
         when nvl(l.salername, '9999') not in ('黄炎镐', '林菲菲') and
              l.goodsownerid = 3 then
          '集采'
         else
          null
       end) deptname, --二级货主-货主部门
       m.outdtlid, --订单号
       decode(nvl(l.outmode, 0), 1, '送货', '自提') outmode,
       e.goodsclass, --药品大类
       a.goodsid, --货品主档ID
       a.ownergoodsid, --货主货品ID
       i.goodsname, --货品名称
       i.goodsengname, --商品名
       i.goodstype, --规格
       i.tradepackname, --单位
       i.factname, --生产厂家
       i.prodarea, --产地
       a.lotid, --批号ID
       j.lotno, --批号
       a.goodsstatusid,--货品状态
       h.packsize, --包装数
       g.areaname, --库区
       f.posname, --货位
       nvl(a.scatterqty, 0) scatterqty, --零散数
       nvl(a.wholeqty, 0) wholeqty, --整件数
       n.companyname, --出库单位
       l.credate, --出库订单接收时间
       a.rffindate, --拣货完成时间
       a.keepdate, --复核完成时间
       o.credate dispatchdate,--派车时间
       o.realdispatchdate, --发车时间
       round((a.keepdate-l.credate)*24,2) workdate ,--订单处理时长(小时)
       l.outid--订单总单号
/*
取数规则：
1.福州物流中心的数据
2.药品大类维护在WMS货品分类的选项字典细单pub_ddl_dtl.goodsclass
3.一个WMS分类只有属于一种药品大类，例如：冷藏-器械，归为冷链，但不归为器械
4.以出库订单的接收时间为时间基准条件
5.出入库上的任务完成时间为拣货完成时间
6.出入库上的记账时间为复核装箱完成时间
7.派车单上的制单时间为派车时间，自提或不派车则都为空
8.派车单上的发车时间为发车时间，自提或不派车则都为空
9.二级货主-货主部门：只针对中宏，采购员'黄炎镐','林菲菲'算本部，除了这两人都算集采
10.订单处理时长为从接收到订单时间到复核装箱完毕
*/
  from wms_st_io_doc a,
       tpl_warehouse b,
       tpl_goodsowner c,
       wms_goods_feature d,
       pub_ddl_dtl e,
       wms_pos_def f,
       wms_st_area_def g,
       tpl_pub_goods_packs h,
       tpl_goods i,
       wms_goods_lot j,
       wms_out_order_lot_dtl k,
       wms_out_order l,
       wms_out_order_dtl m,
       tpl_go_company n,
       (select cc.sourceid, aa.credate, aa.realdispatchdate
          from tms_dispatch_doc aa, tms_dispatch_dtl bb, tms_tr_doc cc
         where aa.dispatchid = bb.dispatchid
           and bb.trid = cc.trid
           and aa.warehid in (2,14)
           and nvl(bb.usestatus,0)<>1 --细单不是作废状态
           and cc.comefrom=1 --运输任务单来源，WMS转入
           ) o
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.warehid in (2, 14)
   and a.warehid = d.warehid
   and a.goodsid = d.goodsid
   and e.sysid = 9
   and d.goodsclass = e.ddlid
   and a.posid = f.posid
   and f.areaid = g.areaid
   and a.goodspackid = h.goodspackid
   and a.ownergoodsid = i.ownergoodsid
   and a.lotid = j.lotid
   and a.comefrom = 3 --波次出库
   and a.sourceid = k.wavegoodsdtlid
   and l.usestatus = 4 --已出货
   and l.outid = m.outid
   and m.outdtlid = k.outdtlid
   and a.companyid = n.companyid(+)
   and l.wavedtlid=o.sourceid(+)
   and l.credate > to_Date('2021-01-01', 'yyyy-mm-dd')
"
"FZLYBS_OUT_ORDER_DTL_YZJ_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_OUT_ORDER_DTL_YZJ_V1"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""OUTDTLID"", ""OUTMODE"", ""GOODSCLASS"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""GOODSSTATUSID"", ""PACKSIZE"", ""AREANAME"", ""POSNAME"", ""SCATTERQTY"", ""WHOLEQTY"", ""COMPANYNAME"", ""CREDATE"", ""RFFINDATE"", ""KEEPDATE"", ""DISPATCHDATE"", ""REALDISPATCHDATE"", ""WORKDATE"", ""OUTID"") AS 
  select a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主
       (case
         when nvl(l.salername, '9999') in ('黄炎镐', '林菲菲') and
              l.goodsownerid = 3 then
          '本部'
         when nvl(l.salername, '9999') not in ('黄炎镐', '林菲菲') and
              l.goodsownerid = 3 then
          '集采'
         else
          null
       end) deptname, --二级货主-货主部门
       m.outdtlid, --订单号
       decode(nvl(l.outmode, 0), 1, '送货', '自提') outmode,
       e.goodsclass, --药品大类
       a.goodsid, --货品主档ID
       a.ownergoodsid, --货主货品ID
       i.goodsname, --货品名称
       i.goodsengname, --商品名
       i.goodstype, --规格
       i.tradepackname, --单位
       i.factname, --生产厂家
       i.prodarea, --产地
       a.lotid, --批号ID
       j.lotno, --批号
       a.goodsstatusid,--货品状态
       h.packsize, --包装数
       g.areaname, --库区
       f.posname, --货位
       nvl(a.scatterqty, 0) scatterqty, --零散数
       nvl(a.wholeqty, 0) wholeqty, --整件数
       n.companyname, --出库单位
       l.credate, --出库订单接收时间
       a.rffindate, --拣货完成时间
       a.keepdate, --复核完成时间
       o.credate dispatchdate,--派车时间
       o.realdispatchdate, --发车时间
       round((a.keepdate-l.credate)*24,2) workdate ,--订单处理时长(小时)
       l.outid--订单总单号
/*
取数规则：
1.福州物流中心的数据
2.药品大类维护在WMS货品分类的选项字典细单pub_ddl_dtl.goodsclass
3.一个WMS分类只有属于一种药品大类，例如：冷藏-器械，归为冷链，但不归为器械
4.以出库订单的接收时间为时间基准条件
5.出入库上的任务完成时间为拣货完成时间
6.出入库上的记账时间为复核装箱完成时间
7.派车单上的制单时间为派车时间，自提或不派车则都为空
8.派车单上的发车时间为发车时间，自提或不派车则都为空
9.二级货主-货主部门：只针对中宏，采购员'黄炎镐','林菲菲'算本部，除了这两人都算集采
10.订单处理时长为从接收到订单时间到复核装箱完毕
*/
  from wms_st_io_doc a,
       tpl_warehouse b,
       tpl_goodsowner c,
       wms_goods_feature d,
       pub_ddl_dtl e,
       wms_pos_def f,
       wms_st_area_def g,
       tpl_pub_goods_packs h,
       tpl_goods i,
       wms_goods_lot j,
       wms_out_order_lot_dtl k,
       wms_out_order l,
       wms_out_order_dtl m,
       tpl_go_company n,
       (select cc.sourceid, aa.credate, aa.realdispatchdate
          from tms_dispatch_doc aa, tms_dispatch_dtl bb, tms_tr_doc cc
         where aa.dispatchid = bb.dispatchid
           and bb.trid = cc.trid
           and aa.warehid in (2,14)
           and nvl(bb.usestatus,0)<>1 --细单不是作废状态
           and cc.comefrom=1 --运输任务单来源，WMS转入
           ) o
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.warehid in (2, 14)
   and a.warehid = d.warehid
   and a.goodsid = d.goodsid
   and e.sysid = 9
   and d.goodsclass = e.ddlid
   and a.posid = f.posid
   and f.areaid = g.areaid
   and a.goodspackid = h.goodspackid
   and a.ownergoodsid = i.ownergoodsid
   and a.lotid = j.lotid
   and a.comefrom = 3 --波次出库
   and a.sourceid = k.wavegoodsdtlid
   and l.usestatus = 4 --已出货
   and l.outid = m.outid
   and m.outdtlid = k.outdtlid
   and a.companyid = n.companyid(+)
   and l.wavedtlid=o.sourceid(+)
   and (a.goodsownerid in
       (select t.goodsownerid
           from tpl_goodsowner t
          where t.goodsownername like '%扬子江药业%') or
       a.ownergoodsid in (select tt.ownergoodsid from zx_yzj_goods tt))
   and l.credate > to_Date('2020-01-01', 'yyyy-mm-dd')
"
"FZLYBS_OUT_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_OUT_ORDER_V"" (""订单接收时间"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主"", ""货主部门"", ""药品大类"", ""出货方式"", ""货品状态"", ""订单数"", ""条目数"", ""整件条目数"", ""整件件数"", ""散件条目数"", ""散件零散数"", ""平均订单处理时长"") AS 
  select 订单接收时间,
       物流中心ID,
       物流中心,
       货主ID,
       货主,
       货主部门,
       药品大类,
       出货方式,
       货品状态,
       订单数,
       条目数,
       整件条目数,
       整件件数,
       散件条目数,
       散件零散数,
       平均订单处理时长
  from fzlybs_out_order@lybs t
"
"FZLYBS_OUT_ORDER_YZJ_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_OUT_ORDER_YZJ_V"" (""订单接收时间"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主"", ""货主部门"", ""药品大类"", ""出货方式"", ""货品状态"", ""订单数"", ""条目数"", ""整件条目数"", ""整件件数"", ""散件条目数"", ""散件零散数"", ""平均订单处理时长"") AS 
  select 订单接收时间,
       物流中心ID,
       物流中心,
       货主ID,
       货主,
       货主部门,
       药品大类,
       出货方式,
       货品状态,
       订单数,
       条目数,
       整件条目数,
       整件件数,
       散件条目数,
       散件零散数,
       平均订单处理时长
  from fzlybs_out_order_yzj@lybs t
"
"FZLYBS_PSMXCX_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_PSMXCX_V"" (""物流中心ID"", ""物流中心"", ""货主ID"", ""货主"", ""货主部门"", ""日期"", ""调度员"", ""配送方式"", ""承运人"", ""司机"", ""配送员"", ""车牌号"", ""发车时间"", ""返回时间"", ""行驶公里数"", ""省"", ""市"", ""县"", ""客户大类"", ""总家数"", ""总订单数"", ""总品规数"", ""总件数"", ""药品品规数"", ""药品件数"", ""器械品规数"", ""器械件数"", ""中药品规数"", ""中药件数"", ""冷链品规数"", ""冷链件数"", ""配送时效"") AS 
  select t.物流中心id,
       t.物流中心,
       t.货主id,
       t.货主,
       t.货主部门,
       t.日期,
       t.调度员,
       t.配送方式,
       t.承运人,
       t.司机,
       t.配送员,
       t.车牌号,
       t.发车时间,
       t.返回时间,
       t.行驶公里数,
       t.省,
       t.市,
       t.县,
       t.客户大类,
       t.总家数,
       t.总订单数,
       t.总品规数,
       t.总件数,
       t.药品品规数,
       t.药品件数,
       t.器械品规数,
       t.器械件数,
       t.中药品规数,
       t.中药件数,
       t.冷链品规数,
       t.冷链件数,
       t.配送时效
  from fzlybs_psmxcx@lybs t
"
"FZLYBS_PSMXCX_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_PSMXCX_V1"" (""物流中心ID"", ""物流中心"", ""货主ID"", ""货主"", ""货主部门"", ""日期"", ""调度员"", ""配送方式"", ""承运人"", ""司机"", ""配送员"", ""车牌号"", ""发车时间"", ""返回时间"", ""行驶公里数"", ""省"", ""市"", ""县"", ""客户大类"", ""总家数"", ""总订单数"", ""总品规数"", ""总件数"", ""药品品规数"", ""药品件数"", ""器械品规数"", ""器械件数"", ""中药品规数"", ""中药件数"", ""冷链品规数"", ""冷链件数"", ""配送时效"") AS 
  select a.warehid 物流中心ID, --物流中心ID
       i.warehname 物流中心, --物流中心
       a.goodsownerid 货主ID, --货主ID
       j.goodsownername 货主, --货主
       (case
         when nvl(a.salername, '9999') in ('黄炎镐', '林菲菲') and
              a.goodsownerid = 3 then
          '本部'
         when nvl(a.salername, '9999') not in ('黄炎镐', '林菲菲') and
              a.goodsownerid = 3 then
          '集采'
         else
          null
       end) 货主部门,
       trunc(a.credate) 日期,
       'xxx' as 调度员,
       decode(a.outmode, 0, '自提', '送货') as 配送方式,
       decode(a.outmode, 0, null, '中宏') as 承运人,
       m.drivername as 司机,
       n.drivername as 配送员,
       l.vehicleno as 车牌号,
       trunc(g.realdispatchdate) as 发车时间,
       sysdate as 返回时间,
       1.111 as 行驶公里数,
       t.province as 省,
       t.city as 市,
       t.district as 县,
       decode(k.companystyle,2,'供应商',k.companyclass) as 客户大类,
       count(distinct a.reccompanyid) as 总家数,
       count(distinct a.outid) as 总订单数,
       count(distinct b.ownergoodsid) as 总品规数,
       sum(nvl(d.wholeqty, 0) + decode(d.scatterqty, null, 0, 1)) as 总件数,
       count(distinct(case
                        when r.goodsclass = '西药' then
                         b.ownergoodsid
                        else
                         null
                      end)) as 药品品规数,
       sum(nvl((case
                 when r.goodsclass = '西药' then
                  d.wholeqty
                 else
                  null
               end),
               0) + decode((case
                             when r.goodsclass = '西药' then
                              d.scatterqty
                             else
                              null
                           end),
                           null,
                           0,
                           1)) as 药品件数,
       count(distinct(case
                        when r.goodsclass = '器械' then
                         b.ownergoodsid
                        else
                         null
                      end)) as 器械品规数,
       sum(nvl((case
                 when r.goodsclass = '器械' then
                  d.wholeqty
                 else
                  null
               end),
               0) + decode((case
                             when r.goodsclass = '器械' then
                              d.scatterqty
                             else
                              null
                           end),
                           null,
                           0,
                           1)) as 器械件数,
       count(distinct(case
                        when r.goodsclass = '中药' then
                         b.ownergoodsid
                        else
                         null
                      end)) as 中药品规数,
       sum(nvl((case
                 when r.goodsclass = '中药' then
                  d.wholeqty
                 else
                  null
               end),
               0) + decode((case
                             when r.goodsclass = '中药' then
                              d.scatterqty
                             else
                              null
                           end),
                           null,
                           0,
                           1)) as 中药件数,
       count(distinct(case
                        when r.goodsclass = '冷链' then
                         b.ownergoodsid
                        else
                         null
                      end)) as 冷链品规数,
       sum(nvl((case
                 when r.goodsclass = '冷链' then
                  d.wholeqty
                 else
                  null
               end),
               0) + decode((case
                             when r.goodsclass = '冷链' then
                              d.scatterqty
                             else
                              null
                           end),
                           null,
                           0,
                           1)) as 冷链件数,
       sysdate as 配送时效

/*
取数规则：
1.福州物流中心的数据
2.药品大类维护在WMS货品分类的选项字典细单pub_ddl_dtl.goodsclass
3.一个WMS分类只有属于一种药品大类，例如：冷藏-器械，归为冷链，但不归为器械
4.以物流出库订单的接收时间为时间基准条件
5.二级货主-货主部门：只针对中宏，采购员'黄炎镐','林菲菲'算本部，除了这两人都算集采
*/
  from wms_out_order a,
       wms_out_order_dtl b,
       wms_out_order_lot_dtl c,
       wms_st_io_doc d,
       wms_wave_goods_dtl e,
       (select ff.trid, ff.dispatchid, ff.sourceid
          from tms_tr_doc ff
         where ff.comefrom = 1) f,
       tms_dispatch_doc g,
       --tms_dispatch_dtl h,
       tpl_warehouse i,
       tpl_goodsowner j,
       tpl_go_company k,
       tms_vehicle l,
       tms_driver m,
       tms_driver n,
       wms_goods_lot o,
       tpl_goods p,
       wms_goods_feature q,
       pub_ddl_dtl r,
       wms_tr_route s,
       wms_transport_address t
 where a.outid = b.outid
   and a.warehid in (2, 14)
   and a.usestatus = 4 --已出货
   and b.outdtlid = c.outdtlid
   and d.sourceid = c.wavegoodsdtlid
   and d.comefrom = 3
   and c.wavegoodsdtlid = e.wavegoodsdtlid
   and e.wavedtlid = f.sourceid(+)
   and f.dispatchid = g.dispatchid(+)
   --and g.dispatchid = h.dispatchid(+)
   and a.warehid = i.warehid
   and a.goodsownerid = j.goodsownerid
   and a.reccompanyid = k.companyid
   and g.vehicleid = l.vehicleid(+)
   and g.driverid = m.driverid(+)
   and g.driver2id = n.driverid(+)
   and b.lotid = o.lotid
   and b.ownergoodsid = p.ownergoodsid
   and a.warehid = q.warehid
   and b.goodsid = q.goodsid
   and r.sysid = 9
   and q.goodsclass = r.ddlid
   and g.routeid = s.routeid(+)
   and a.transid = t.transid(+)
   and a.credate > to_Date('2020-01-01', 'yyyy-mm-dd')
 group by a.warehid,
          i.warehname,
          a.goodsownerid,
          j.goodsownername,
          (case
            when nvl(a.salername, '9999') in ('黄炎镐', '林菲菲') and
                 a.goodsownerid = 3 then
             '本部'
            when nvl(a.salername, '9999') not in ('黄炎镐', '林菲菲') and
                 a.goodsownerid = 3 then
             '集采'
            else
             null
          end),
          trunc(a.credate),
          a.outmode,
          m.drivername,
          n.drivername,
          l.vehicleno,
          trunc(g.realdispatchdate),
          t.province,
          t.city,
          t.district,
          decode(k.companystyle,2,'供应商',k.companyclass)

 union all

 --TMS

 select
       a.warehid 物流中心ID, --物流中心ID
       i.warehname 物流中心, --物流中心
       a.goodsownerid 货主ID, --货主ID
       j.goodsownername 货主, --货主
       (case
         when nvl(a.salername, '9999') in ('黄炎镐', '林菲菲') and
              a.goodsownerid = 3 then
          '本部'
         when nvl(a.salername, '9999') not in ('黄炎镐', '林菲菲') and
              a.goodsownerid = 3 then
          '集采'
         else
          null
       end) 货主部门,
       trunc(a.credate) 日期,
       'xxx' as 调度员,
       decode(a.outmode, 0, '自提', '送货') as 配送方式,
       decode(a.outmode, 0, null, '中宏') as 承运人,
       g.drivername as 司机,--  m.drivername as 司机,
       g.driver2name as 配送员,-- n.drivername as 配送员,
       g.vehicleno as 车牌号,
       trunc(g.credate) as 发车时间,
       sysdate as 返回时间,
       1.111 as 行驶公里数,
       t.province as 省,
       t.city as 市,
       t.district as 县,
       decode(k.companystyle,2,'供应商',k.companyclass) as 客户大类,
       count(distinct a.reccompanyid) as 总家数,
       count(distinct a.outid) as 总订单数,
       count(distinct b.ownergoodsid) as 总品规数,
       sum(nvl(d.wholeqty, 0) + decode(d.scatterqty, null, 0, 1)) as 总件数,
       count(distinct(case
                        when r.goodsclass = '西药' then
                         b.ownergoodsid
                        else
                         null
                      end)) as 药品品规数,
       sum(nvl((case
                 when r.goodsclass = '西药' then
                  d.wholeqty
                 else
                  null
               end),
               0) + decode((case
                             when r.goodsclass = '西药' then
                              d.scatterqty
                             else
                              null
                           end),
                           null,
                           0,
                           1)) as 药品件数,
       count(distinct(case
                        when r.goodsclass = '器械' then
                         b.ownergoodsid
                        else
                         null
                      end)) as 器械品规数,
       sum(nvl((case
                 when r.goodsclass = '器械' then
                  d.wholeqty
                 else
                  null
               end),
               0) + decode((case
                             when r.goodsclass = '器械' then
                              d.scatterqty
                             else
                              null
                           end),
                           null,
                           0,
                           1)) as 器械件数,
       count(distinct(case
                        when r.goodsclass = '中药' then
                         b.ownergoodsid
                        else
                         null
                      end)) as 中药品规数,
       sum(nvl((case
                 when r.goodsclass = '中药' then
                  d.wholeqty
                 else
                  null
               end),
               0) + decode((case
                             when r.goodsclass = '中药' then
                              d.scatterqty
                             else
                              null
                           end),
                           null,
                           0,
                           1)) as 中药件数,
       count(distinct(case
                        when r.goodsclass = '冷链' then
                         b.ownergoodsid
                        else
                         null
                      end)) as 冷链品规数,
       sum(nvl((case
                 when r.goodsclass = '冷链' then
                  d.wholeqty
                 else
                  null
               end),
               0) + decode((case
                             when r.goodsclass = '冷链' then
                              d.scatterqty
                             else
                              null
                           end),
                           null,
                           0,
                           1)) as 冷链件数,
       sysdate as 配送时效

/*
取数规则：
1.福州物流中心的数据
2.药品大类维护在WMS货品分类的选项字典细单pub_ddl_dtl.goodsclass
3.一个WMS分类只有属于一种药品大类，例如：冷藏-器械，归为冷链，但不归为器械
4.以物流出库订单的接收时间为时间基准条件
5.二级货主-货主部门：只针对中宏，采购员'黄炎镐','林菲菲'算本部，除了这两人都算集采
*/
  from wms_out_order a,
       wms_out_order_dtl b,
       wms_out_order_lot_dtl c,
       wms_st_io_doc d,
       wms_wave_goods_dtl e,
       (select ff.trid, ff.dispatchid, ff.sourceid
          from tms_tr_doc ff
         where ff.comefrom = 1) f,
       tms_luyan_dispatch_doc  g,
       --tms_dispatch_doc g,
       --tms_dispatch_dtl h,
       tpl_warehouse i,
       tpl_goodsowner j,
       tpl_go_company k,
      -- tms_vehicle l,
      -- tms_driver m,
      -- tms_driver n,
       wms_goods_lot o,
       tpl_goods p,
       wms_goods_feature q,
       pub_ddl_dtl r,
    --   wms_tr_route s,
       wms_transport_address t
 where a.outid = b.outid
   and a.warehid in (2, 14)
   and a.usestatus = 4 --已出货
   and b.outdtlid = c.outdtlid
   and d.sourceid = c.wavegoodsdtlid
   and d.comefrom = 3
   and c.wavegoodsdtlid = e.wavegoodsdtlid
   and e.wavedtlid = f.sourceid(+)
   and f.dispatchid = g.dispatchid
   --and g.dispatchid = h.dispatchid(+)
   and a.warehid = i.warehid
   and a.goodsownerid = j.goodsownerid
   and a.reccompanyid = k.companyid
  -- and g.vehicleid = l.vehicleid(+)
  -- and g.driverid = m.driverid(+)
  -- and g.driver2id = n.driverid(+)
   and b.lotid = o.lotid
   and b.ownergoodsid = p.ownergoodsid
   and a.warehid = q.warehid
   and b.goodsid = q.goodsid
   and r.sysid = 9
   and q.goodsclass = r.ddlid
   --and g.routeid = s.routeid(+)
   and a.transid = t.transid(+)
   and a.credate > to_Date('2024-12-01', 'yyyy-mm-dd')
 group by a.warehid,
          i.warehname,
          a.goodsownerid,
          j.goodsownername,
          (case
            when nvl(a.salername, '9999') in ('黄炎镐', '林菲菲') and
                 a.goodsownerid = 3 then
             '本部'
            when nvl(a.salername, '9999') not in ('黄炎镐', '林菲菲') and
                 a.goodsownerid = 3 then
             '集采'
            else
             null
          end),
          trunc(a.credate),
          a.outmode,
          g.drivername,
          g.driver2name,
          g.vehicleno,
          trunc(g.credate),
          t.province,
          t.city,
          t.district,
          decode(k.companystyle,2,'供应商',k.companyclass)
"
"FZLYBS_STORAGE_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_STORAGE_DOC_V"" (""库存日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""货主部门"", ""药品大类"", ""库存总件数"", ""库存总条目数"", ""总品规数"", ""零散条目总数"", ""零散货位总数"", ""整件总数"", ""整件货位总数"", ""GOODSOWNERID"") AS 
  select t.kcrq 库存日期,
       t.warehid 物流中心ID,
       t.warehname 物流中心,
       t.goodsownerid 货主ID,
       t.goodsownername 货主名称,
       t.deptname 货主部门,
       t.goodsclass 药品大类,
       t.packnum 库存总件数,
       t.recordnum 库存总条目数,
       t.goodsnum 总品规数,
       t.s_num 零散条目总数,
       t.s_posnum 零散货位总数,
       t.w_num 整件总数,
       t.w_posnum 整件货位总数,
       t.goodsownerid
  from fzlybs_storage_doc@lybs t
"
"FZLYBS_STORAGE_DOC_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_STORAGE_DOC_V1"" (""KCRQ"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""GOODSCLASS"", ""PACKNUM"", ""RECORDNUM"", ""GOODSNUM"", ""S_NUM"", ""W_NUM"", ""S_POSNUM"", ""W_POSNUM"") AS 
  select a.kcrq,
       a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       (case when nvl(i.supplyername,'9999') in ('黄炎镐','林菲菲') and i.goodsownerid=3 then '本部'
            when nvl(i.supplyername,'9999') not in ('黄炎镐','林菲菲') and i.goodsownerid=3 then '集采'
       else null end) deptname,--二级货主-货主部门
       e.goodsclass,
       sum((case when g.areaflag=2 then 1
            when g.areaflag in (0,1) then decode(h.packsize,0,0,round(a.goodsqty/h.packsize,0))
            else 0 end)) packnum,
       count(1) recordnum,
       count(distinct lotid) goodsnum,
       sum((case when g.areaflag=2 then 1 --散件条目数
                 else 0 end)) s_num,
       sum((case when g.areaflag in (0,1) then decode(h.packsize,0,0,round(a.goodsqty/h.packsize,0)) --整件件数
                 else 0 end)) w_num,
       count(distinct (case when g.areaflag=2 then a.posid else null end)) s_posnum, --散件货位数
       count(distinct (case when g.areaflag in (0,1) then a.posid else null end)) w_posnum --整件货位数
/*
取数规则：
1.福州物流中心的数据
2.药品大类维护在WMS货品分类的选项字典细单pub_ddl_dtl.goodsclass
3.一个WMS分类只有属于一种药品大类，例如：冷藏-器械，归为冷链，但不归为器械
4.库存总件数=散件条目+整件件数，根据货位的归属库区类型来区分，散件货位记为1，整件货位则为库存数量/包装大小=整件件数
5.库存总条目数：库存表记录数
6.库存总品规数：理解为一个批号即为一个品规，按批号ID计数
*/
  from wms_st_qty_lst_bak    a,
       tpl_warehouse         b,
       tpl_goodsowner        c,
       wms_goods_feature     d,
       pub_ddl_dtl           e,
       wms_pos_def           f,
       wms_st_area_def       g,
       tpl_pub_goods_packs   h,
       tpl_goods             i
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.goodsqty > 0
   and a.warehid in (2, 14)
   and a.warehid = d.warehid
   and a.goodsid = d.goodsid
   and e.sysid = 9
   and d.goodsclass = e.ddlid
   and a.posid=f.posid
   and f.areaid=g.areaid
   and a.goodspackid=h.goodspackid
   and a.ownergoodsid = i.ownergoodsid
   and a.kcrq>to_Date('2020-01-01','yyyy-mm-dd')
 group by a.kcrq,
          a.warehid,
          b.warehname,
          a.goodsownerid,
          c.goodsownername,
          e.goodsclass,
           (case when nvl(i.supplyername,'9999') in ('黄炎镐','林菲菲') and i.goodsownerid=3 then '本部'
            when nvl(i.supplyername,'9999') not in ('黄炎镐','林菲菲') and i.goodsownerid=3 then '集采'
       else null end)
"
"FZLYBS_STORAGE_DOC_YZJ_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_STORAGE_DOC_YZJ_V"" (""库存日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""货主部门"", ""药品大类"", ""库存总件数"", ""库存总条目数"", ""总品规数"", ""零散条目总数"", ""零散货位总数"", ""整件总数"", ""整件货位总数"") AS 
  select t.kcrq 库存日期,
       t.warehid 物流中心ID,
       t.warehname 物流中心,
       t.goodsownerid 货主ID,
       t.goodsownername 货主名称,
       t.deptname 货主部门,
       t.goodsclass 药品大类,
       t.packnum 库存总件数,
       t.recordnum 库存总条目数,
       t.goodsnum 总品规数,
       t.s_num 零散条目总数,
       t.s_posnum 零散货位总数,
       t.w_num 整件总数,
       t.w_posnum 整件货位总数
  from fzlybs_storage_doc_yzj@lybs t
"
"FZLYBS_STORAGE_DOC_YZJ_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_STORAGE_DOC_YZJ_V1"" (""KCRQ"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""GOODSCLASS"", ""PACKNUM"", ""RECORDNUM"", ""GOODSNUM"", ""S_NUM"", ""W_NUM"", ""S_POSNUM"", ""W_POSNUM"") AS 
  select a.kcrq,
       a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       (case
         when nvl(i.supplyername, '9999') in ('黄炎镐', '林菲菲') and
              i.goodsownerid = 3 then
          '本部'
         when nvl(i.supplyername, '9999') not in ('黄炎镐', '林菲菲') and
              i.goodsownerid = 3 then
          '集采'
         else
          null
       end) deptname, --二级货主-货主部门
       e.goodsclass,
       sum((case
             when g.areaflag = 2 then
              1
             when g.areaflag in (0, 1) then
              decode(h.packsize, 0, 0, round(a.goodsqty / h.packsize, 0))
             else
              0
           end)) packnum,
       count(1) recordnum,
       count(distinct lotid) goodsnum,
       sum((case
             when g.areaflag = 2 then
              1 --散件条目数
             else
              0
           end)) s_num,
       sum((case
             when g.areaflag in (0, 1) then
              decode(h.packsize, 0, 0, round(a.goodsqty / h.packsize, 0)) --整件件数
             else
              0
           end)) w_num,
       count(distinct(case
                        when g.areaflag = 2 then
                         a.posid
                        else
                         null
                      end)) s_posnum, --散件货位数
       count(distinct(case
                        when g.areaflag in (0, 1) then
                         a.posid
                        else
                         null
                      end)) w_posnum --整件货位数
/*
取数规则：
1.福州物流中心的数据
2.药品大类维护在WMS货品分类的选项字典细单pub_ddl_dtl.goodsclass
3.一个WMS分类只有属于一种药品大类，例如：冷藏-器械，归为冷链，但不归为器械
4.库存总件数=散件条目+整件件数，根据货位的归属库区类型来区分，散件货位记为1，整件货位则为库存数量/包装大小=整件件数
5.库存总条目数：库存表记录数
6.库存总品规数：理解为一个批号即为一个品规，按批号ID计数
*/
  from wms_st_qty_lst_bak  a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       wms_goods_feature   d,
       pub_ddl_dtl         e,
       wms_pos_def         f,
       wms_st_area_def     g,
       tpl_pub_goods_packs h,
       tpl_goods           i
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.goodsqty > 0
   and a.warehid in (2, 14)
   and a.warehid = d.warehid
   and a.goodsid = d.goodsid
   and e.sysid = 9
   and d.goodsclass = e.ddlid
   and a.posid = f.posid
   and f.areaid = g.areaid
   and a.goodspackid = h.goodspackid
   and a.ownergoodsid = i.ownergoodsid
   and a.kcrq > to_Date('2020-01-01', 'yyyy-mm-dd')
   and (a.goodsownerid in
       (select t.goodsownerid
           from tpl_goodsowner t
          where t.goodsownername like '%扬子江药业%') or
       a.ownergoodsid in (select tt.ownergoodsid from zx_yzj_goods tt))
 group by a.kcrq,
          a.warehid,
          b.warehname,
          a.goodsownerid,
          c.goodsownername,
          e.goodsclass,
          (case
            when nvl(i.supplyername, '9999') in ('黄炎镐', '林菲菲') and
                 i.goodsownerid = 3 then
             '本部'
            when nvl(i.supplyername, '9999') not in ('黄炎镐', '林菲菲') and
                 i.goodsownerid = 3 then
             '集采'
            else
             null
          end)
"
"FZLYBS_STORAGE_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_STORAGE_DTL_V"" (""KCRQ"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""GOODSCLASS"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSQTY"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""PACKSIZE"", ""AREANAME"", ""POSNAME"", ""SCATTERQTY"", ""WHOLEQTY"") AS 
  select a.kcrq,
       a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       (case when nvl(i.supplyername,'9999') in ('黄炎镐','林菲菲') and i.goodsownerid=3 then '本部'
            when nvl(i.supplyername,'9999') not in ('黄炎镐','林菲菲') and i.goodsownerid=3 then '集采'
       else null end) deptname,--二级货主-货主部门
       e.goodsclass,
       a.goodsid,
       a.ownergoodsid,
       i.goodsname,
       i.goodsengname,
       a.goodsqty,
       i.goodstype,
       i.tradepackname,
       i.factname,
       i.prodarea,
       a.lotid,
       j.lotno,
       h.packsize,--包装数
       g.areaname,--库区
       f.posname,--货位
       (case when g.areaflag=2 then 1 else 0 end) scatterqty,--零散数
       (case when g.areaflag in (0,1) then decode(h.packsize,0,0,round(a.goodsqty/h.packsize,0)) else 0 end) wholeqty --整件数
  from wms_st_qty_lst_bak     a,
       tpl_warehouse          b,
       tpl_goodsowner         c,
       wms_goods_feature      d,
       pub_ddl_dtl            e,
       wms_pos_def            f,
       wms_st_area_def        g,
       tpl_pub_goods_packs    h,
       tpl_goods              i,
       wms_goods_lot          j
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.goodsqty > 0
   and a.warehid in (2, 14)
   and a.warehid = d.warehid
   and a.goodsid = d.goodsid
   and e.sysid = 9
   and d.goodsclass = e.ddlid
   and a.posid=f.posid
   and f.areaid=g.areaid
   and a.goodspackid=h.goodspackid
   and a.ownergoodsid=i.ownergoodsid
   and a.lotid=j.lotid
   and a.kcrq>to_Date('2020-01-01','yyyy-mm-dd')
"
"FZLYBS_TMS_TR_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_TMS_TR_DOC_V"" (""派车单制单时间"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主"", ""货主部门"", ""订单数"", ""条目数"", ""配送车次"", ""配送人次"", ""配送家次"") AS 
  select 派车单制单时间,
       物流中心ID,
       物流中心,
       货主ID,
       货主,
       货主部门,
       订单数,
       条目数,
       配送车次,
       配送人次,
       配送家次
  from fzlybs_tms_tr_doc@lybs
"
"FZLYBS_TMS_TR_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_TMS_TR_DTL_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""COMPANYNAME"", ""OUTDTLID"", ""GOODSCLASS"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""SCATTERQTY"", ""WHOLEQTY"", ""CREDATE"", ""DISPATCHID"", ""DISPATCHDTLID"", ""DISCREDATE"", ""REALDISPATCHDATE"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""UPDOWNMAN"", ""ROUTEID"", ""ROUTENAME"") AS 
  select t.warehid, --物流中心ID
       t.warehname, --物流中心
       t.goodsownerid, --货主ID
       t.goodsownername, --货主
       t.deptname, --二级货主-货主部门
       t.companyname,--出库单位
       t.outdtlid, --订单号
       t.goodsclass, --药品大类
       t.goodsid, --货品主档ID
       t.ownergoodsid, --货主货品ID
       t.goodsname, --货品名称
       t.goodsengname, --商品名
       t.goodstype, --规格
       t.tradepackname, --单位
       t.factname, --生产厂家
       t.prodarea, --产地
       t.lotid, --批号ID
       t.lotno, --批号
       t.scatterqty, --零散数
       t.wholeqty, --整件数
       t.credate, --出库订单接收时间
       t.dispatchid,--派车单ID
       t.dispatchdtlid,--派车细单ID
       t.discredate,--派车单制单时间
       t.realdispatchdate,--配送时间
       t.vehicleno,--车辆
       t.driverid,--主驾驶员ID
       t.drivername,--主驾驶员
       t.driver2id,--副驾驶员ID
       t.driver2name,--副驾驶员
       t.updownman, --装卸工
       t.routeid,--线路ID
       t.routename --线路
  from fzlybs_tms_tr_dtl@lybs t
"
"FZLYBS_TMS_TR_DTL_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""FZLYBS_TMS_TR_DTL_V1"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""COMPANYNAME"", ""OUTDTLID"", ""GOODSCLASS"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""SCATTERQTY"", ""WHOLEQTY"", ""CREDATE"", ""DISPATCHID"", ""DISPATCHDTLID"", ""DISCREDATE"", ""REALDISPATCHDATE"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""UPDOWNMAN"", ""ROUTEID"", ""ROUTENAME"") AS 
  select a.warehid, --物流中心ID
       i.warehname, --物流中心
       a.goodsownerid, --货主ID
       j.goodsownername, --货主
       (case
         when nvl(a.salername, '9999') in ('黄炎镐', '林菲菲') and
              a.goodsownerid = 3 then
          '本部'
         when nvl(a.salername, '9999') not in ('黄炎镐', '林菲菲') and
              a.goodsownerid = 3 then
          '集采'
         else
          null
       end) deptname, --二级货主-货主部门
       k.companyname,--出库单位
       b.outdtlid, --订单号
       r.goodsclass, --药品大类
       b.goodsid, --货品主档ID
       b.ownergoodsid, --货主货品ID
       p.goodsname, --货品名称
       p.goodsengname, --商品名
       p.goodstype, --规格
       p.tradepackname, --单位
       p.factname, --生产厂家
       p.prodarea, --产地
       b.lotid, --批号ID
       o.lotno, --批号
       nvl(d.scatterqty, 0) scatterqty, --零散数
       nvl(d.wholeqty, 0) wholeqty, --整件数
       a.credate, --出库订单接收时间
       g.dispatchid,--派车单ID
       h.dispatchdtlid,--派车细单ID
       g.credate discredate,--派车单制单时间
       g.realdispatchdate,--配送时间
       l.vehicleno,--车辆
       g.driverid,--主驾驶员ID
       m.drivername,--主驾驶员
       g.driver2id,--副驾驶员ID
       n.drivername driver2name,--副驾驶员
       g.updownman, --装卸工
       g.routeid,--线路ID
       s.routename --线路

/*
取数规则：
1.福州物流中心的数据
2.药品大类维护在WMS货品分类的选项字典细单pub_ddl_dtl.goodsclass
3.一个WMS分类只有属于一种药品大类，例如：冷藏-器械，归为冷链，但不归为器械
4.以派车单的创建时间为时间基准条件
5.二级货主-货主部门：只针对中宏，采购员'黄炎镐','林菲菲'算本部，除了这两人都算集采
*/
  from wms_out_order         a,
       wms_out_order_dtl     b,
       wms_out_order_lot_dtl c,
       wms_st_io_doc         d,
       wms_wave_goods_dtl    e,
       tms_tr_doc            f,
       tms_dispatch_doc      g,
       tms_dispatch_dtl      h,
       tpl_warehouse         i,
       tpl_goodsowner        j,
       tpl_go_company        k,
       tms_vehicle           l,
       tms_driver            m,
       tms_driver            n,
       wms_goods_lot         o,
       tpl_goods             p,
       wms_goods_feature     q,
       pub_ddl_dtl           r,
       wms_tr_route          s
 where a.outid = b.outid
   and a.outmode = 1 --出货方式为送货 才有运输任务单
   and a.warehid in (2, 14)
   and a.usestatus = 4 --已出货
   and b.outdtlid = c.outdtlid
   and d.sourceid = c.wavegoodsdtlid
   and d.comefrom=3
   and c.wavegoodsdtlid=e.wavegoodsdtlid
   and e.wavedtlid = f.sourceid
   and f.comefrom = 1 --运输任务单来源，WMS转入
   and f.dispatchid = g.dispatchid
   and g.dispatchid = h.dispatchid
   and f.trid = h.trid
   and a.warehid=i.warehid
   and a.goodsownerid=j.goodsownerid
   and a.reccompanyid=k.companyid
   and g.vehicleid=l.vehicleid
   and g.driverid=m.driverid(+)
   and g.driver2id=n.driverid(+)
   and b.lotid=o.lotid
   and b.ownergoodsid=p.ownergoodsid
   and a.warehid = q.warehid
   and b.goodsid = q.goodsid
   and r.sysid = 9
   and q.goodsclass = r.ddlid
   and g.routeid=s.routeid(+)
   and g.credate > to_Date('2020-01-01', 'yyyy-mm-dd')

 union all --TMS

 select
       a.warehid, --物流中心ID
       i.warehname, --物流中心
       a.goodsownerid, --货主ID
       j.goodsownername, --货主
       (case
         when nvl(a.salername, '9999') in ('黄炎镐', '林菲菲') and
              a.goodsownerid = 3 then
          '本部'
         when nvl(a.salername, '9999') not in ('黄炎镐', '林菲菲') and
              a.goodsownerid = 3 then
          '集采'
         else
          null
       end) deptname, --二级货主-货主部门
       k.companyname,--出库单位
       b.outdtlid, --订单号
       r.goodsclass, --药品大类
       b.goodsid, --货品主档ID
       b.ownergoodsid, --货主货品ID
       p.goodsname, --货品名称
       p.goodsengname, --商品名
       p.goodstype, --规格
       p.tradepackname, --单位
       p.factname, --生产厂家
       p.prodarea, --产地
       b.lotid, --批号ID
       o.lotno, --批号
       nvl(d.scatterqty, 0) scatterqty, --零散数
       nvl(d.wholeqty, 0) wholeqty, --整件数
       a.credate, --出库订单接收时间
       g.dispatchid,--派车单ID
       f.trid dispatchdtlid, -- h.dispatchdtlid,--派车细单ID
       g.credate discredate,--派车单制单时间
       g.credate realdispatchdate,--g.realdispatchdate,--配送时间 TMS派出后生成820001
       g.vehicleno,-- l.vehicleno,--车辆
       g.driverid,--  g.driverid,--主驾驶员ID
       g.drivername,--  m.drivername,--主驾驶员
       g.driver2id,-- g.driver2id,--副驾驶员ID
       g.driver2name,--n.drivername driver2name,--副驾驶员
       g.updownman, --装卸工
       null routeid,--g.routeid,--线路ID
       null routename-- s.routename --线路

/*
取数规则：
1.福州物流中心的数据
2.药品大类维护在WMS货品分类的选项字典细单pub_ddl_dtl.goodsclass
3.一个WMS分类只有属于一种药品大类，例如：冷藏-器械，归为冷链，但不归为器械
4.以派车单的创建时间为时间基准条件
5.二级货主-货主部门：只针对中宏，采购员'黄炎镐','林菲菲'算本部，除了这两人都算集采
*/
  from wms_out_order         a,
       wms_out_order_dtl     b,
       wms_out_order_lot_dtl c,
       wms_st_io_doc         d,
       wms_wave_goods_dtl    e,
       tms_tr_doc            f,
       tms_luyan_dispatch_doc g,


    --   tms_dispatch_doc      g,
    --   tms_dispatch_dtl      h,
       tpl_warehouse         i,
       tpl_goodsowner        j,
       tpl_go_company        k,
      -- tms_vehicle           l,
      -- tms_driver            m,
      -- tms_driver            n,
       wms_goods_lot         o,
       tpl_goods             p,
       wms_goods_feature     q,
       pub_ddl_dtl           r
     --  wms_tr_route          s
 where a.outid = b.outid
   and a.outmode = 1 --出货方式为送货 才有运输任务单
   and a.warehid in (2, 14)
   and a.usestatus = 4 --已出货
   and b.outdtlid = c.outdtlid
   and d.sourceid = c.wavegoodsdtlid
   and d.comefrom=3
   and c.wavegoodsdtlid=e.wavegoodsdtlid
   and e.wavedtlid = f.sourceid
   and f.comefrom = 1 --运输任务单来源，WMS转入
   and f.dispatchid = g.dispatchid
  -- and g.dispatchid = h.dispatchid
  -- and f.trid = h.trid
   and a.warehid=i.warehid
   and a.goodsownerid=j.goodsownerid
   and a.reccompanyid=k.companyid
  -- and g.vehicleid=l.vehicleid
  -- and g.driverid=m.driverid(+)
  -- and g.driver2id=n.driverid(+)
   and b.lotid=o.lotid
   and b.ownergoodsid=p.ownergoodsid
   and a.warehid = q.warehid
   and b.goodsid = q.goodsid
   and r.sysid = 9
   and q.goodsclass = r.ddlid
  -- and g.routeid=s.routeid(+)
   and g.usestatus = 1
   and g.credate > to_Date('2024-12-01', 'yyyy-mm-dd')
"
"GSPWEB_CONSERVE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSPWEB_CONSERVE_V"" (""WAREHNAME"", ""CONSERVEID"", ""CREDATE"", ""CREDATECHAR"", ""WAREHID"", ""WAREHOPCODE"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSFORMALNAME"", ""PRODAREA"", ""FACTID"", ""COMPANYNAME"", ""COMPANYOPCODE"", ""DRUGFORM"", ""DRUGFORMNO"", ""GOODSQTYPE"", ""LOTID"", ""LOTNO"", ""LOTVALIDDATE"", ""APPROVEDOCNO"", ""PRODDATE"", ""POSID"", ""AREAID"", ""AREANO"", ""AREANAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""POSNAME"", ""POSNO"", ""GOODSQTY"", ""GOODSUNIT"", ""MATTER"", ""CONTENTS"", ""LASTCONSERVEDATE"", ""USESTATUS"", ""VALIDDATE"", ""MEMO"", ""QUANSTANDARD"", ""QUANSTANDARDCHAR"", ""STORAGECONDITION"", ""PROPERTIES"", ""PACKAGE"", ""CHECKQTY"", ""CHECKRESULT"", ""RECHECKQTY"", ""RECHECKRESULT"", ""RESULT"", ""RESULTCHAR"", ""CHECKMANID"", ""QUILITYQTY"", ""UNQUILITYQTY"", ""CHECKMANOPCODE"", ""CHECKMAN"", ""CHECKMEMO"", ""EQUIPMENTID"", ""EQUIPMENTOPCODE"", ""EQUIPMENTNAME"", ""USEREASON"", ""CHECKGOODS"", ""USEMAN"", ""EQUIPMENTMEMO"", ""WHITESTOCKNUM"", ""WHITEPOINTNUM"", ""XIANWEINUM"", ""BOXIENUM"", ""JINSHUXIENUM"", ""OTHERNUM"", ""JKHZFLAG"", ""SOURCEID"", ""REWHITESTOCKNUM"", ""REWHITEPOINTNUM"", ""REXIANWEINUM"", ""REBOXIENUM"", ""REJINSHUXIENUM"", ""REOTHERNUM"", ""EMFLAG"", ""PRINTFLAG"", ""PRINTDATE"", ""PRINTMANID"", ""PRINTMAN"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSOWNID"") AS 
  select tpl_warehouse.warehname,
       gsp_conserve.conserveid,
       gsp_conserve.credate,
       to_char(gsp_conserve.credate, 'yyyy-mm-dd')credatechar,
       gsp_conserve.warehid,
       tpl_warehouse.warehopcode,
       gsp_conserve.goodsid,
       tpl_pub_goods.opcode,
       tpl_pub_goods.goodsname,
       tpl_pub_goods.goodsformalname,
       tpl_pub_goods.prodarea,
       tpl_pub_goods.factid,
       tpl_pub_company.companyname,
       tpl_pub_company.companyopcode,
       tpl_drugform.drugform,
       tpl_drugform.drugformno,
       tpl_pub_goods.goodstype GOODSQTYPE,
       --g.goodsownid, --add by xyue 货主原货品ID 2015-12-10
       gsp_conserve.lotid,
       wms_goods_lot.lotno,
        to_char(decode(to_char(wms_goods_lot.validdate, 'yyyy-mm-dd'),
        '2099-01-01',
        to_date(null, 'yyyy-mm-dd'),
        wms_goods_lot.validdate),'yyyy-mm-dd') lotvaliddate,
       wms_goods_lot.approvedocno,
       to_char(wms_goods_lot.proddate, 'yyyy-mm-dd')proddate,
       gsp_conserve.posid,
       wms_pos_def.areaid,
       wms_st_area_def.areano,
       wms_st_area_def.areaname,
       wms_pos_def.sectionid,
       wms_st_section_def.sectionno,
       wms_st_section_def.sectionname,
       wms_pos_def.posname,
       wms_pos_def.posno,
       gsp_conserve.goodsqty,
       gsp_conserve.goodsunit,
       gsp_conserve.matter,
       gsp_conserve.contents,
       gsp_conserve.lastconservedate,
       gsp_conserve.usestatus,
       gsp_conserve.validdate,
       gsp_conserve.memo,
       gsp_conserve.quanstandard,
       decode(gsp_conserve.quanstandard,0,'不合格',1,'合格') quanstandardchar,
       gsp_conserve.storagecondition,
       gsp_conserve.properties,
       gsp_conserve.package,
       gsp_conserve.checkqty,
       gsp_conserve.checkresult,
       gsp_conserve.recheckqty,
       gsp_conserve.recheckresult,
       gsp_conserve.result,
       decode(gsp_conserve.result,1,'继续销售',2,'不合格') resultchar,
       gsp_conserve.checkmanid,
       gsp_conserve.quilityqty,
       gsp_conserve.unquilityqty,
       a.opcode checkmanopcode,
       a.employeename checkman,
       gsp_conserve.checkmemo,
       gsp_conserve.equipmentid,
       b.equipmentopcode,
       b.equipmentname,
       gsp_conserve.usereason,
       gsp_conserve.checkgoods,
       gsp_conserve.useman,
       gsp_conserve.equipmentmemo,
       gsp_conserve.whitestocknum,
       gsp_conserve.whitepointnum,
       gsp_conserve.xianweinum,
       gsp_conserve.boxienum,
       gsp_conserve.jinshuxienum,
       gsp_conserve.othernum,
       tpl_pub_goods.jkhzflag,
       gsp_conserve.sourceid,
       gsp_conserve.rewhitestocknum,
       gsp_conserve.rewhitepointnum,
       gsp_conserve.rexianweinum,
       gsp_conserve.reboxienum,
       gsp_conserve.rejinshuxienum,
       gsp_conserve.reothernum,
       gsp_conserve.emflag,
       gsp_conserve.printflag,
       gsp_conserve.printdate,
       gsp_conserve.printmanid,
       c.employeename printman,
       gsp_conserve.goodsownerid,
       f.goodsownername,
       g.goodsownid --add by zyc 20161207 货主原货品ID
  from gsp_conserve,
       tpl_warehouse,
       tpl_pub_goods,
       tpl_pub_company,
       wms_goods_lot,
       wms_st_area_def,
       wms_st_section_def,
       wms_pos_def,
       tpl_drugform,
       pub_employee a,
       gsp_equipment b,
       pub_employee c,
       tpl_goodsowner f,
       Tpl_goods      g
 where gsp_conserve.warehid = tpl_warehouse.warehid(+)
   and gsp_conserve.goodsid = tpl_pub_goods.goodsid(+)
   and tpl_pub_goods.factid = tpl_pub_company.companyid(+)
   and gsp_conserve.lotid = wms_goods_lot.lotid(+)
   and gsp_conserve.ownergoodsid=g.ownergoodsid
   and gsp_conserve.posid = wms_pos_def.posid(+)
   and wms_pos_def.areaid = wms_st_area_def.areaid(+)
   and wms_pos_def.sectionid = wms_st_section_def.sectionid(+)
   and gsp_conserve.checkmanid = a.employeeid(+)
   and gsp_conserve.equipmentid = b.equipmentid(+)
   and tpl_drugform.drugformno(+) = tpl_pub_goods.drugform
   AND gsp_conserve.printmanid = c.employeeid(+)
   And gsp_conserve.goodsownerid = f.goodsownerid(+)
"
"GSPWEB_GOODS_ACCEPTION_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSPWEB_GOODS_ACCEPTION_V"" (""CHECKID"", ""CHECKDOCNO"", ""CREDATE"", ""CREDATECHAR"", ""INPUTMANID"", ""OPERATIONTYPE"", ""QUCHECKID"", ""DEPTNAME"", ""CHECKDATE"", ""WAREHID"", ""GOODSOWNERID"", ""ARRIVEDATE"", ""GOODSID"", ""GOODSQTY"", ""QUALIFIEDQTY"", ""GOODSUNIT"", ""COMPANYID"", ""LOTID"", ""GOODSSTATUSID"", ""QUANSTATUS"", ""FACEQUALITY"", ""PACKQUALITY"", ""TRANSTEMP"", ""IMPORTREPFLAG"", ""PASSGATEFLAG"", ""REGISTEFLAG"", ""MEDCHECKFLAG"", ""ELIGIBILITYFLAG"", ""RPTNO"", ""BACKWHYID"", ""CHECKMANID1"", ""CHECKMAN1"", ""CHECKMANID2"", ""CHECKMAN2"", ""CHECKCONCLUSION"", ""DECISIONFLAGCHAR"", ""DECISIONFLAG"", ""CONFIRMMANID"", ""CONFIRMDATE"", ""USESTATUS"", ""MEMO"", ""CHECKOPCODE"", ""CHECKNAME"", ""INPUTMANOPCODE"", ""INPUTMAN"", ""CONFIRMMANOPCODE"", ""CONFIRMMAN"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""GOODSOWNID"", ""GOODSOPCODE"", ""GOODSNAME"", ""DRUGFORM"", ""GOODSPINYIN"", ""POISON_DRUG"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""COMPANYNAME"", ""COMPANYOPCODE"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""KILLLOTNO"", ""APPROVEDOCNO"", ""REGISTNO"", ""EXPFLAG"", ""EXPDATE"", ""EXPFILENAME"", ""RECEIVEID"", ""LQCCHECK"", ""PASSGATENO"", ""PIJIANNO"", ""INID"", ""WAREHNAME"", ""OWNERGOODSID"", ""STORAGECONDITION"", ""TRADEPACKNAME"", ""SENDNO"", ""LPNCODE"", ""FACTNAME"", ""GOODSSTATUS"", ""JKHZFLAG"", ""VARIETYDESCID"", ""VARIETYNAME"", ""COPYRIGHT"", ""GCOMPANYNAME"", ""ZXCOLUMN4"", ""DTLZXCOLUMN4"", ""MAH"") AS 
  select a.checkid,
       a.checkdocno,
       a.credate,
       decode(a.goodsownerid,9102,to_char(a.credate, 'yyyy-mm-dd hh24:mi:ss'),to_char(a.credate, 'yyyy-mm-dd')) credatechar,
       a.inputmanid,
       a.operationtype,
       a.qucheckid,
       b.companyname deptname,
       j.checkdate, --取收货验收细单上的验收时间 xyue 2016-04-27
       a.warehid,
       a.goodsownerid,
       a.arrivedate,
       a.goodsid,
       a.goodsqty,
       a.goodsqty qualifiedqty,
       a.goodsunit,
       a.companyid,
       a.lotid,
       a.goodsstatusid,
       a.quanstatus,
       a.facequality,
       a.packquality,
       a.transtemp,
       a.importrepflag,
       a.passgateflag,
       a.registeflag,
       a.medcheckflag,
       a.eligibilityflag,
       a.rptno,
       a.backwhyid,
       a.checkmanid1,
       q.employeename checkman1,
       a.checkmanid2,
       p.employeename checkman2,
       a.checkconclusion,
       decode(decode(a.quanstatus, 1, 1, 2, 3, 3, 2, 4),
              1,
              '入合格区',
              2,
              '入不合格区',
              3,
              '入退货区',
              4,
              '入不限区') decisionflagchar,
       --nvl(a.decisionflag,1) decisionflag,
       /*验收结论逻辑：质量状态1=入合格区，质量状态3（不合格）=入不合格区，质量状态2=入退货区*/
       decode(a.quanstatus, 1, 1, 2, 3, 3, 2, 4) decisionflag,
       a.confirmmanid,
       a.confirmdate,
       a.usestatus,
       j.checkmemo memo, -- 修改货品质量验收记录备注为收货验收细单上的备注，xyue 2013年12月3日 17:58:33
       b.companyopcode checkopcode,
       b.companyname checkname,
       c.opcode inputmanopcode,
       c.employeename inputman,
       d.opcode confirmmanopcode,
       d.employeename confirmman,
       e.goopcode,
       e.goodsownername,
       k.goodsownid,
       k.opcode goodsopcode,
       k.goodsname,
       k.drugform,
       f.goodspinyin,
       k.poison_drug,
       k.goodstype,
       k.prodarea,
       f.factid,
       g.companyname,
       g.opcode companyopcode,
       h.lotno,
       to_char(decode(to_char(h.validdate, 'yyyy-mm-dd'),
                      '2099-01-01',
                      to_date(null, 'yyyy-mm-dd'),
                      h.validdate),
               'yyyy-mm-dd') validdate,
       to_char(h.proddate, 'yyyy-mm-dd') proddate,
       h.killlotno,
       a.approvedocno,
       a.registno,
       a.expflag,
       a.expdate,
       a.expfilename,
       a.receiveid,
       a.lqccheck,
       a.passgateno,
       a.pijianno,
       i.inid,
       o.warehname,
       a.ownergoodsid,
       k.storagecondition,
       k.tradepackname,
       a.sendno,
       a.lpncode,
       h.factname factname, -- 修改货品质量验收记录的生产厂家取批号信息上的生产厂家，xyue 2014年1月6日 17:22:54
       m.goodsstatus,
       f.jkhzflag,
       k.varietydescid,
       k.varietyname,
       1 copyright,
       a.gcompanyname, --add by weitangjing 20131104 货主原单位名称
       r.zxcolumn4, --ERP总单ID
       i.dtlzxcolumn4, --ERP细单ID
       nvl(h.mah,k.mah) as mah
  from gsp_physic_quality_check a,
       pub_company              b,
       pub_employee             c,
       pub_employee             d,
       tpl_goodsowner           e,
       tpl_pub_goods            f,
       tpl_go_company           g,
       wms_goods_lot            h,
       tpl_warehouse            o,
       wms_in_order_dtl         i,
       wms_receive_dtl          j,
       tpl_goods                k,
       --tpl_pub_company          l,
       wms_goodsstatus          m,
       pub_employee             q,
       pub_employee             p,
       wms_in_order             r --add by 20161207 zyc 提取ERP总单ID
 where a.qucheckid = b.companyid(+)
   and a.inputmanid = c.employeeid(+)
   and a.confirmmanid = d.employeeid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.goodsid = f.goodsid(+)
   and a.companyid = g.companyid(+)
   and a.lotid = h.lotid(+)
   and a.receiveid = j.receiveid(+)
   and i.indtlid(+) = j.indtlid
   and a.warehid = o.warehid
   and a.ownergoodsid = k.ownergoodsid(+)
   --and f.factid = l.companyid(+)
   and a.goodsstatusid = m.goodsstatusid(+)
   AND a.checkmanid1 = q.employeeid(+)
   AND a.checkmanid2 = p.employeeid(+)
   and i.inid = r.inid(+)
"
"GSPWEB_GOODS_UNQUALIFIED_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSPWEB_GOODS_UNQUALIFIED_V"" (""UNQUALIFYID"", ""GOODSID"", ""OWNERGOODSOPCODE"", ""OWNERGOODSNAME"", ""GOODSTYPE"", ""GOODSOWNID"", ""FACTNAME"", ""GOODSUNIT"", ""PRODAREA"", ""PACKNAME"", ""PACKSIZE"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""WAREHNAME"", ""WAREHOPCODE"", ""GOODSPACKID"", ""BATCHNO"", ""LOTID"", ""GOODSQTY"", ""REASON"", ""APPFLAG"", ""APPMEMO"", ""GOODSOWNERID"", ""CREDATE"", ""CREDATECHAR"", ""INPUTMANID"", ""MEMO"", ""DEALMETHOD"", ""COMEFROM"", ""APPMANID"", ""OWNERGOODSID"", ""WAREHID"", ""SRCID"", ""POSID"", ""DEALMETHODCHAR"", ""COMEFROMCHAR"") AS 
  select a.unqualifyid,
       a.goodsid,
       b.opcode ownergoodsopcode, --货主货品操作码
       b.goodsname ownergoodsname, --货主货品名称
       b.goodstype,
       b.goodsownid,
       b.factname, --生产厂家
       b.tradepackname goodsunit, --xyue 2014-06-12 增加基本单位，取包装明细上basefalg=1的包装名称
       b.prodarea,
       c.packname,
       c.packsize,
       d.lotno,
       to_char(d.proddate, 'yyyy-MM-dd') proddate,
       to_char(d.validdate, 'yyyy-MM-dd') validdate,
       f.goodsownername,
       f.goopcode, --货主操作码
       g.warehname,
       g.warehopcode, --物流中心操作码
       a.goodspackid,
       a.batchno,
       a.lotid,
       a.goodsqty,
       a.reason,
       a.appflag,
       a.appmemo,
       a.goodsownerid,
       a.credate,
       to_char(a.credate, 'yyyy-MM-dd') credatechar,
       a.inputmanid,
       a.memo,
       a.dealmethod,
       a.comefrom,
       a.appmanid,
       a.ownergoodsid,
       a.warehid,
       a.srcid,
       a.posid,
       ll.ddlname dealmethodchar,
       kk.ddlname comefromchar
  from GSP_goods_Unqualified a,
       tpl_goods             b,
       tpl_pub_goods_packs   c,
       wms_goods_lot         d,
       tpl_goodsowner f,
       tpl_warehouse g,
       (select bb.ddlid, bb.ddlname
          from pub_ddl aa, pub_ddl_dtl bb
         where aa.sysid = bb.sysid
           and aa.keyword = 'GSP_GOODS_UNQUALIFIED_APPFLAG') ll,
       (select bb.ddlid, bb.ddlname
          from pub_ddl aa, pub_ddl_dtl bb
         where aa.sysid = bb.sysid
           and aa.keyword = 'GSP_GOODS_UNQUALIFIED_RECORD_COMEFROM') kk
 where a.ownergoodsid = b.ownergoodsid(+)
   and a.goodspackid = c.goodspackid(+)
   and a.lotid = d.lotid(+)
      --and   a.posid = e.posid(+)
   and a.goodsownerid = f.goodsownerid(+)
   and a.warehid = g.warehid(+)
   and a.dealmethod = ll.ddlid(+)
"
"GSPWEB_QTY_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSPWEB_QTY_LST_V"" (""WAREHID"", ""GOODSOWNERID"", ""OWNERGOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""FACTNAME"", ""PRODAREA"", ""DRUGFORM"", ""APPROVEDOCNO"", ""MAH"", ""TRADEPACKNAME"", ""PACKSIZE"", ""PACKNAME"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""GOODSQTY"", ""BUSIQTY"") AS 
  select t.warehid,
       t.goodsownerid,
       t.ownergoodsid,
       a.goodsownid,
       a.goodsname,
       a.goodsengname,
       a.goodstype,
       a.factname,
       a.prodarea,
       a.drugform,
       a.approvedocno,
       a.mah,
       a.tradepackname,
       d.packsize,
       d.packname,
       t.lotid,
       b.lotno,
       to_char(b.proddate, 'yyyy-mm-dd') proddate,
       to_char(b.validdate, 'yyyy-mm-dd') validdate,
       t.goodsstatusid,
       c.goodsstatus,
       (select x.ddlname
          from pub_ddl_dtl x
         where x.sysid = 11
           and x.ddlid = c.quantitystatus) quantitystatus,
       sum(t.goodsqty) goodsqty,
       sum(t.busiqty) busiqty
  from wms_st_qty_lst      t,
       tpl_goods           a,
       wms_goods_lot       b,
       wms_goodsstatus     c,
       tpl_pub_goods_packs d
 where t.ownergoodsid = a.ownergoodsid(+)
   and t.lotid = b.lotid(+)
   and t.goodsstatusid = c.goodsstatusid(+)
   and t.goodspackid = d.goodspackid(+)
 group by t.warehid,
          t.goodsownerid,
          t.ownergoodsid,
          a.goodsownid,
          a.goodsname,
          a.goodsengname,
          a.goodstype,
          a.factname,
          a.prodarea,
          a.drugform,
          a.approvedocno,
          a.mah,
          a.tradepackname,
          d.packsize,
          d.packname,
          t.lotid,
          b.lotno,
          to_char(b.proddate, 'yyyy-mm-dd'),
          to_char(b.validdate, 'yyyy-mm-dd'),
          t.goodsstatusid,
          c.goodsstatus,
          c.quantitystatus
"
"GSPWEB_QUALITY_FEEDBACK_REV_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSPWEB_QUALITY_FEEDBACK_REV_V"" (""FEEDBACKID"", ""CREDATE"", ""CREDATECHAR"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""OWNERGOODSID"", ""WAREGOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""DRUGFORM"", ""TRADEPACKNAME"", ""FACTNAME"", ""GOODSQTY"", ""CHECKQTY"", ""REALQTY"", ""LOTNO"", ""APPROVEDOCNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSSITUTION"", ""INPUTMANID"", ""EMPLOYEENAME"", ""ZGYIDEA"", ""ZGJLIDEA"", ""WTFQUALITYDEPTIDEA"", ""WTFQUALITYDEPTMANID"", ""WTFQUALITYDEPTDATE"", ""WTFRELATEDEPTIDEA"", ""WTFRELATEDEPTMAIDID"", ""WTFRELATEDEPTDATE"", ""DEALRESULT"", ""USESTATUS"", ""WTFRELATEDEPTDATECHAR"", ""WTFRELATEDEPTMAN"", ""WTFQUALITYDEPTDATECHAR"", ""WTFQUALITYDEPTMAN"", ""MAH"") AS 
  select a.feedbackid,
       a.credate,
       to_char(a.credate, 'yyyy-mm-dd') credatechar,
       a.goodsownerid,
       d.goodsownername,
       a.companyid,
       c.companyname,
       a.ownergoodsid,
       b.waregoodsid,
       b.goodsownid,
       b.goodsname,
       b.goodsengname,
       b.goodstype,
       b.drugform,
       b.tradepackname,
       b.factname,
       a.goodsqty, --应来货数量
       a.checkqty, --待复查数量
       a.goodsqty - a.checkqty as realqty, --实际来货数量
       a.lotno,
       a.approvedocno,
       to_char(a.proddate, 'yyyy-mm-dd') proddate,
       to_char(a.validdate, 'yyyy-mm-dd') validdate,
       a.goodssitution,
       a.inputmanid,
       e.employeename,
       a.zgyidea,
       a.zgjlidea,
       a.wtfqualitydeptidea,
       a.wtfqualitydeptmanid,
       a.wtfqualitydeptdate,
       a.wtfrelatedeptidea,
       a.wtfrelatedeptmaidid,
       a.wtfrelatedeptdate,
       a.dealresult,
       decode(nvl(a.usestatus, 0), 0, '临时', '确认') usestatus,
       to_char(a.wtfrelatedeptdate,'yyyy-mm-dd') wtfrelatedeptdatechar,
       g.employeename wtfrelatedeptman,
       to_char(a.wtfqualitydeptdate,'yyyy-mm-dd') wtfqualitydeptdatechar,
       f.employeename wtfqualitydeptman,
       a.mah
  from zx_gsp_quality_feedback a,
       tpl_goods               b,
       tpl_go_company          c,
       tpl_goodsowner          d,
       pub_employee            e,
       zx_goodsowner_employee_v       f,
       zx_goodsowner_employee_v       g
 where a.ownergoodsid = b.ownergoodsid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.companyid = c.companyid(+)
   and a.inputmanid = e.employeeid(+)
   and a.wtfqualitydeptmanid=f.employeeid(+)
   and a.wtfrelatedeptmaidid=g.employeeid(+)
"
"GSPWEB_QUALITY_FEEDBACK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSPWEB_QUALITY_FEEDBACK_V"" (""FEEDBACKID"", ""WAREHID"", ""WAREHNAME"", ""WAREHOPCODE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSOWNID"", ""OWNERGOODSOPCODE"", ""OWNERGOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSQTY"", ""LOTID"", ""FROMCOMPANYID"", ""DEPTID"", ""INFOLEVEL"", ""GOODSSITUATION"", ""GROUPFEEDBACKMANID"", ""GROUPFEEDBACKDATE"", ""DEPTIDEA"", ""DEPTFEEDBACKMANID"", ""DEPTFEEDBACKDATE"", ""QUALITYDEPTIDEA"", ""RELATEDEPTIDEA"", ""RELATEDEPTMANID"", ""RELATEDEPTDATE"", ""DEALRESULT"", ""INPUTMANID"", ""CREDATE"", ""PRINTNO"", ""PRINTLINE"", ""FEEDBACKNO"", ""COMEFROM"", ""TRADEID"", ""INPUTMANNAME"") AS 
  select a.FEEDBACKID,
       a.warehid,--物流中心ID
       d.warehname,--物流中心名称
       d.warehopcode,--物流中心操作码
       a.goodsownerid,--货主ID
       e.goodsownername,--货主名称
       e.goopcode,--货主操作码
       b.waregoodsid goodsid,--xyue 2014-12-01 货品主档ID
       b.ownergoodsid,--货主货品ID
       b.goodsownid,
       b.opcode ownergoodsopcode,--货主货品操作码
       b.goodsname ownergoodsname,--货主货品名称
       b.goodstype,
       b.prodarea,
       c.lotno,
       c.proddate,
       c.validdate,
       a.GOODSQTY,
       a.LOTID,
       a.FROMCOMPANYID,
       a.DEPTID,
       a.INFOLEVEL,
       a.GOODSSITUATION,
       a.GROUPFEEDBACKMANID,
       a.GROUPFEEDBACKDATE,
       a.DEPTIDEA,
       a.DEPTFEEDBACKMANID,
       a.DEPTFEEDBACKDATE,
       a.QUALITYDEPTIDEA,
       a.RELATEDEPTIDEA,
       a.RELATEDEPTMANID,
       a.RELATEDEPTDATE,
       a.DEALRESULT,
       a.INPUTMANID,
       a.CREDATE,
       a.PRINTNO,
       a.PRINTLINE,
       a.FEEDBACKNO,
       a.comefrom,
       a.tradeid,
       f.employeename inputmanname
  from gsp_quality_feedback a,
       tpl_goods            b,
       wms_goods_lot        c,
       tpl_warehouse        d,
       tpl_goodsowner       e,
       pub_employee         f
 where a.ownergoodsid = b.ownergoodsid
   and a.lotid = c.lotid(+)
   and a.warehid = d.warehid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.inputmanid = f.employeeid(+)
"
"GSPWEB_SHGL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSPWEB_SHGL_V"" (""INID"", ""ZXCOLUMN4"", ""USESTATUS"", ""OPERATIONTYPE"", ""OPERATIONTYPECHAR"", ""CREDATE"", ""CREDATECHAR"", ""ARRIVEDATE"", ""ARRIVEDATECHAR"", ""SRCCOMPANYNAME"", ""SRCNO"", ""SOURCECOMPANYID"", ""WAREHNAME"", ""WAREHID"", ""ZXCOLUMN2"", ""GOODSOWNERNAME"", ""GOODSOWNERID"", ""INDTLID"", ""GOODSNAME"", ""GOODSENGNAME"", ""PORDERSTATUS"", ""GOODSOWNID"", ""GOODSID"", ""GOODSQTY"", ""APPROVEDOCNO"", ""GOODSTYPE"", ""FACTNAME"", ""PRODAREA"", ""DTLZXCOLUMN4"", ""QTY"", ""DHWD"", ""SHQK"", ""YCFLAG"", ""CLFLAG"", ""YSFS"", ""YSTJ"", ""TRANSNAME"", ""SHDATE"", ""SHDATECHAR"", ""SHR"", ""SHRID"", ""GCWDFLAG"", ""PHNAME"", ""PZXFFLAG"", ""QYWD"", ""WDCJDATE"", ""TZWDFLAG"", ""CJQNO"", ""QYDATE"", ""DHDATE"", ""TRANSNO"", ""TRANSTOOLS"", ""DHDATE1"", ""GOODSCLASSCHAR"", ""USESTATUSCHAR"", ""PACKSIZE"", ""PACKNAME"", ""MAH"") AS 
  select a.inid, --入库订单ID
       a.zxcolumn4, --ERP总单ID
       a.usestatus, --总单状态
       a.operationtype, --业务类型
       ll.ddlname operationtypechar,
       a.credate, --制单日期
       decode(a.goodsownerid,9102,to_char(a.credate, 'yyyy-mm-dd hh24:mi:ss'),to_char(a.credate, 'yyyy-mm-dd')) credatechar,
       a.arrivedate, --预定到货日
       decode(a.goodsownerid,9102,to_char(a.arrivedate, 'yyyy-mm-dd hh24:mi:ss'),to_char(a.arrivedate, 'yyyy-mm-dd')) arrivedatechar,
       d.companyname srccompanyname, --来货单位名称
       a.srcno, --来源细单ID
       a.sourcecompanyid, --来源单位ID
       c.warehname, --物流中心名称
       a.warehid, --物流中心ID
       a.zxcolumn2, --采购员
       f.goodsownername, --货主名称
       a.goodsownerid, --货主ID
       b.indtlid, --入库细单ID
       e.goodsname, --货品名称
       e.goodsengname, --商品名
       b.porderstatus, --细单状态
       e.goodsownid, --货主源货品ID
       e.waregoodsid goodsid, --货品主档ID
       b.goodsqty, --原单数量
       b.approvedocno, --批准文号
       e.goodstype, --规格
       e.factname, --生产厂商
       e.prodarea, --产地
       b.dtlzxcolumn4, --ERP细单ID
       b.qty, --收货数量
       b.dhwd, --到货温度
       b.shqk, --收货情况
       b.ycflag, --异常标志
       b.clflag, --处理标志
       B.YSFS, --运输方式
       B.YSTJ, --运输条件
       h.transname, --运输方式
       b.shdate, --收货日期
       decode(a.goodsownerid,9102,to_char(b.shdate, 'yyyy-mm-dd hh24:mi:ss'),to_char(b.shdate, 'yyyy-mm-dd')) shdatechar,
       l.employeename shr, --收货人
       l.employeeid shrid, --收货人ID
       b.gcwdflag,
       b.phname,
       b.pzxfflag,
       b.qywd,
       b.wdcjdate,
       b.tzwdflag,
       b.cjqno,
       b.qydate,
       b.dhdate,
       b.transno,
       b.transtools,
       b.dhdate1,
       (select bb.ddlname
          from wms_goods_feature t, pub_ddl aa, pub_ddl_dtl bb
         where t.warehid = a.warehid
           and t.goodsid = b.goodsid
           and aa.sysid = bb.sysid
           and aa.keyword = 'WMS_GOODS_CLASS'
           and t.goodsclass = bb.ddlid(+)) goodsclasschar, --存储分类
       kk.ddlname usestatuschar,
       k.packsize,
       k.packname,
       e.mah
  from wms_in_order a,
       wms_in_order_dtl b,
       tpl_warehouse c,
       tpl_go_company d,
       tpl_goods e,
       tpl_goodsowner f,
       wms_transport_mode h,
       tpl_pub_goods_packs k,
       pub_employee        l,
       (select aa.ddlname, aa.ddlid
          from sys_ddl_dtl aa, sys_ddl bb
         where bb.sysid = aa.sysid
           and bb.keyword = 'TPL_OPERATIONTYPE') ll,
       (select aa.ddlname, aa.ddlid
          from sys_ddl_dtl aa, sys_ddl bb
         where bb.sysid = aa.sysid
           and bb.keyword = 'WMS_PO_STATUS') kk
 where a.inid = b.inid
   and a.warehid = c.warehid(+)
   and b.ownergoodsid = e.ownergoodsid(+)
   and a.goodsownerid = f.goodsownerid(+)
   and b.ysfs = h.transmodeid(+)
   and b.shrid = l.employeeid(+)
   and a.sourcecompanyid = d.companyid(+)
   and b.goodspackid = k.goodspackid(+)
   and a.operationtype = ll.ddlid(+)
   and a.usestatus = kk.ddlid(+)
   and nvl(b.recheckflag, 0) = 0 -- add by tl 20180125  不显示由验收差异产生的入库订单
"
"GSPWEB_ST_IO_RECORD_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSPWEB_ST_IO_RECORD_V"" (""INOUTID"", ""CREDATE"", ""INPUTMANID"", ""INPUTCODE"", ""INPUTNAME"", ""CHECKMANID"", ""CHECKMANOPCODE"", ""CHECKMANNAME"", ""GOODSOWNERID"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""COMEFROM"", ""OPERATIONTYPE"", ""COMPANYID"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""GOODSID"", ""OPCODE"", ""GOODSTYPE"", ""GOODSNAME"", ""PRODAREA"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""POSID"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""GOODSQTY"", ""KEEPDATE"", ""KEEPDATECHAR"", ""KEEPMANID"", ""KEEPMANOPCODE"", ""KEEPMANNAME"", ""MEMO"", ""POSNO"", ""POSNAME"", ""AREANO"", ""AREANAME"", ""SECTIONNO"", ""SECTIONNAME"", ""AREAID"", ""SECTIONID"", ""CHECKMAN2ID"", ""CHECKMAN2OPCODE"", ""CHECKMAN2NAME"", ""FACTNAME"", ""OWNERGOODSID"", ""TRADEPACKNAME"", ""DRUGFORM"", ""STORAGECONDITION"", ""VARIETYDESCID"", ""NOWLFLAG"", ""WAREHID"", ""GOODSOWNID"", ""GCOMPANYNAME"", ""OPERATIONTYPECHAR"", ""QUANTITYSTATUSCHAR"", ""ORDERID"", ""ORDERDTLID"", ""MAH"") AS 
  select a.inoutid,
       a.credate,
       a.inputmanid,
       c.opcode inputcode,
       c.employeename inputname,
       a.checkmanid,
       d.opcode checkmanopcode,
       d.employeename checkmanname,
       a.goodsownerid,
       e.goopcode,
       e.goodsownername,
       a.comefrom,
       a.operationtype,
       a.companyid,
       f.opcode companyopcode,
       f.companyname,
       a.goodsid,
       h.opcode,
       h.goodstype,
       h.goodsname,
       h.prodarea,
       a.batchno,
       a.lotid,
       i.lotno,
       to_char(decode(to_char(i.validdate, 'yyyy-mm-dd'),
                      '2099-01-01',
                      to_date(null, 'yyyy-mm-dd'),
                      i.validdate),
               'yyyy-mm-dd') validdate,
       to_char(i.proddate, 'yyyy-mm-dd') proddate,
       i.approvedocno,
       a.goodspackid,
       j.packname,
       j.packsize,
       a.posid,
       a.goodsstatusid,
       g.goodsstatus,
       g.quantitystatus,
       a.goodsqty,
       a.keepdate,
       to_char(a.keepdate, 'yyyy-mm-dd') keepdatechar,
       a.keepmanid,
       k.opcode keepmanopcode,
       k.employeename keepmanname,
       a.memo,
       b.posno,
       b.posname,
       n.areano,
       n.areaname,
       m.sectionno,
       m.sectionname,
       b.areaid,
       b.sectionid,
       a.checkman2id,
       l.opcode checkman2opcode,
       l.employeename checkman2name,
       i.factname factname, --修改货品质量验收记录的生产厂家取批号信息上的生产厂家，xyue 2014年1月6日 17:22:54
       a.ownergoodsid,
       h.tradepackname,
       h.drugform,
       h.storagecondition,
       --h.jkhzflag,
       h.varietydescid,
       a.nowlflag,
       a.warehid,
       h.goodsownid, --货主原货品id
       a.gcompanyname, --add by weitangjing 20131104 原货主单位名称
       ll.ddlname operationtypechar,
       kk.ddlname quantitystatuschar,
       zx_get_orderid(a.inoutid) as orderid,
       zx_get_orderdtlid(a.inoutid) as orderdtlid,
       nvl(i.mah,h.mah) as mah
  from Gsp_st_io_record a,
       wms_pos_def b,
       pub_employee c,
       pub_employee d,
       tpl_goodsowner e,
       tpl_go_company f,
       wms_goodsstatus g,
       tpl_goods h,
       wms_goods_lot i,
       tpl_pub_goods_packs j,
       pub_employee k,
       pub_employee l,
       wms_st_section_def m,
       wms_st_area_def n,
       (select aa.ddlname, aa.ddlid
          from sys_ddl_dtl aa, sys_ddl bb
         where bb.sysid = aa.sysid
           and bb.keyword = 'TPL_OPERATIONTYPE') ll,
       (select bb.ddlname, bb.ddlid
          from pub_ddl aa, pub_ddl_dtl bb
         where aa.sysid = bb.sysid
           and aa.keyword = 'TPL_QUANTITYSTATUS') kk
 where a.posid = b.posid(+)
   and a.inputmanid = c.employeeid(+)
   and a.checkmanid = d.employeeid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.companyid = f.companyid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.lotid = i.lotid(+)
   and a.goodspackid = j.goodspackid(+)
   and a.keepmanid = k.employeeid(+)
   and a.checkman2id = l.employeeid(+)
   and a.ownergoodsid = h.ownergoodsid(+)
   and b.sectionid=m.sectionid(+)
   and b.areaid=n.areaid(+)
   and a.operationtype = ll.ddlid(+)
   and a.quanstatus = kk.ddlid(+)
"
"GSPWEB_WMS_DESTROY_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSPWEB_WMS_DESTROY_ORDER_V"" (""OUTID"", ""GOODSOWNERID"", ""WAREHNAME"", ""GOODSOWNERNAME"", ""DESTROYREASON"", ""DESTROYMETHOD"", ""DESTROYADDRESS"", ""DESTROYMAN"", ""DESTROYJDMAN"", ""DESTROYMEMO"", ""DESTROYDATE"", ""OUTDTLID"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""OWNERGOODSID"", ""LOTNO"", ""VALIDDATE"", ""GOODSQTY"", ""PACKNAME"", ""PACKSIZE"", ""TRADEGOODSPACK"") AS 
  select a.outid,
       a.goodsownerid,
       warehname,
       goodsownername,
       destroyreason,
       destroymethod,
       destroyaddress,
       destroyman,
       destroyjdman,
       destroymemo,
       destroydate,
       outdtlid,
       goodsname,
       goodstype,
       factname,
       ownergoodsid,
       lotno,
       validdate,
       goodsqty,
       packname,
       packsize,
       tradegoodspack
  from WMS_DESTROY_ORDER_V a, WMS_DESTROY_ORDER_dtl_V b
 where a.outid = b.outid
   and destroystatus = 1
"
"GSPWEB_WMS_TRADE_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSPWEB_WMS_TRADE_ORDER_V"" (""WAREHID"", ""WAREHNAME"", ""OPERATIONTYPE"", ""BILLFROM"", ""TRADEDATE"", ""INPUTMANNAME"", ""USESTATUS"", ""DTLLINES"", ""CONFIRMMANNAME"", ""CONFIRMDATE"", ""MEMO"", ""WAREHOPCODE"", ""SUBTYPE"", ""EXECUTETYPE"", ""CONFIRMMAN"", ""INPUTMANID"", ""TRADEID"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""PACKNAME"", ""PACKSIZE"", ""QTY"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""FROMLOTNO"", ""FROMPRODDATE"", ""FROMVALIDDATE"", ""TOLOTNO"", ""TOPRODDATE"", ""TOVALIDDATE"", ""FROMGOODSSTATUS"", ""FROMQUANSTATUS"", ""TOGOODSSTATUS"", ""TOQUANSTATUS"", ""FROMPOSNO"", ""TOPOSNO"", ""FROMPOSNAME"", ""TOPOSNAME"", ""FROMSECTIONNO"", ""TOSECTIONNO"", ""FROMSECTIONNAME"", ""TOSECTIONNAME"", ""SRCPROCDTLID"", ""PROCFLAG"", ""DTLUSESTATUS"", ""TRADEDTLID"", ""GOODSOWNID"", ""GOODSID"", ""FROMBATCHNO"", ""TOBATCHNO"", ""FROMSECTIONID"", ""TOSECTIONID"", ""OWNERGOODSID"", ""GOODSPACKID"", ""FROMLOTID"", ""TOLOTID"", ""FROMPOSID"", ""TOPOSID"", ""FROMGOODSSTATUSID"", ""TOGOODSSTATUSID"", ""FACTNAME"") AS 
  select
        b.warehid,
        b.warehname,
        b.operationtype,
        b.billfrom,
        b.tradedate,
        b.inputmanname,
        b.usestatus,
        b.dtllines,
        b.confirmmanname,
        b.confirmdate,
        b.memo,
        b.warehopcode,
        b.subtype,
        b.executetype,
        b.confirmman,
        b.inputmanid,
        b.tradeid,
        to_char(b.tradedate,'yyyy-mm-dd') credate,
        b.goodsownerid,
        a.goodsopcode,
        a.goodsname,
        a.goodstype,
        a.prodarea,
        a.packname,
        a.packsize,
        a.qty,
        a.tradegoodsqty,
        a.tradegoodspack,
        a.fromlotno,
        a.fromproddate,
        a.fromvaliddate,
        a.tolotno,
        to_char(a.toproddate,'yyyy-mm-dd') toproddate,
        to_char(a.tovaliddate,'yyyy-mm-dd') tovaliddate,
        a.fromgoodsstatus,
        a.fromquanstatus,
        a.togoodsstatus,
        a.toquanstatus,
        a.fromposno,
        a.toposno,
        a.fromposname,
        a.toposname,
        a.fromsectionno,
        a.tosectionno,
        a.fromsectionname,
        a.tosectionname,
        a.srcprocdtlid,
        a.procflag,
        a.dtlusestatus,
        a.tradedtlid,
        a.goodsownid,
        a.goodsid,
        a.frombatchno,
        a.tobatchno,
        a.fromsectionid,
        a.tosectionid,
        a.ownergoodsid,
        a.goodspackid,
        a.fromlotid,
        a.tolotid,
        a.fromposid,
        a.toposid,
        a.fromgoodsstatusid,
        a.togoodsstatusid,
        a.factname
 from wms_trade_dtl_v a ,
      wms_trade_order_v b
where a.tradeid = b.TRADEID
"
"GSPWEB_ZX_PCD_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSPWEB_ZX_PCD_V"" (""DISPATCHID"", ""CREDATE"", ""USESTATUS"", ""DISPATCHDATE"", ""DISPATCHDATECHAR"", ""INPUTMAN"", ""DISPATCHMAN"", ""SELFTRANSTYPE"", ""SELFTRANSTYPECHAR"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""DRIVERNAME"", ""DRIVERNAME2"", ""TRANSMODEL"", ""ROUTENAME"", ""INTOWNFLAG"", ""TERRACENO"", ""VEHICLENO"", ""VEHICLEMODEL"", ""TOTALPACKS"", ""TOTALCUBAGE"", ""TOTALWEIGHT"", ""TOTALPACKS2"", ""TOTALCUBAGE2"", ""TOTALWEIGHT2"", ""PREDISTANCE"", ""PREGAS"", ""TRANSCLASS"", ""UPDOWNMAN"", ""UPDOWNDATE"", ""ROUTEID"", ""TERRACEID"", ""VEHICLEID"", ""DRIVERID"", ""DRIVER2ID"", ""TRCOMPANYID"", ""MEMO"", ""INPUTMANID"", ""DISPATCHMANID"", ""WAREHNAME"", ""WAREHID"", ""FEEFLAG"", ""REALDISTANCE"", ""REALGAS"", ""RETURNDATE"", ""BACKDESCR"", ""TASKTYPE"", ""TRNO"", ""GOODSOWNERNAME"", ""DTLCOMPANYNAME"", ""CONNECTOR"", ""CONNPHONE"", ""INCEPTADDR"", ""WHOLEPACKS"", ""SCATTERPACKS"", ""OPERATIONTYPE"", ""WEIGHT"", ""CUBAGE"", ""FIXQTY"", ""DTKMEMO"", ""STEVEDORE"", ""DTLUSESTATUS"", ""DISPATCHDTLID"", ""GOODSOWNERID"", ""GCOMPANYID"", ""TRID"", ""DTLDISPATCHID"", ""BACKTIME"", ""BACKMAN"", ""DTLBACKDESCR"", ""DEPTNAME"", ""CHAINFLAG"", ""CHAINFLAGCHAR"", ""ZONENAME"", ""ZZXRWS"", ""ADDMEDCHECKFLAG"", ""ADDMEDCHECKFLAGCHAR"", ""USESTATUSCHAR"") AS 
  select a.dispatchid,
       a.credate,
       a.usestatus,
       a.dispatchdate,
       to_char(a.dispatchdate,'yyyy-mm-dd')dispatchdatechar,
       a.inputman,
       a.dispatchman,
       a.selftranstype,
       mm.ddlname selftranstypechar,
       a.companyopcode,
       decode(c.excarrier,null,a.companyname,(select t.ddlname from pub_ddl_dtl t where t.sysid=810 and t.ddlid=c.excarrier)||'('||c.ydno||')') companyname,
       a.drivername,
       a.drivername2,
       a.transmodel,
       a.routename,
       a.intownflag,
       a.terraceno,
       a.vehicleno,
       a.vehiclemodel,
       nvl(a.totalpacks,0) totalpacks,
       nvl(a.totalcubage,0) totalcubage,
       nvl(a.totalweight,0) totalweight,
       nvl(a.totalpacks2,0) totalpacks2,
       nvl(a.totalcubage2,0) totalcubage2,
       nvl(a.totalweight2,0) totalweight2,
       nvl(a.predistance,0) predistance,
       nvl(a.pregas,0) pregas,
       a.transclass,
       a.updownman,
       a.updowndate,
       a.routeid,
       a.terraceid,
       a.vehicleid,
       a.driverid,
       a.driver2id,
       a.trcompanyid,
       a.memo,
       a.inputmanid,
       a.dispatchmanid,
       a.warehname,
       a.warehid,
       a.feeflag,
       a.realdistance,
       nvl(a.realgas,0) realgas,
       a.returndate,
       a.backdescr,
       b.tasktype,
       b.trno,
       b.goodsownername,
       b.companyname dtlcompanyname,
       b.connector,
       b.connphone,
       b.inceptaddr,
       nvl(b.wholepacks,0) wholepacks,
       nvl(b.scatterpacks,0) scatterpacks,
       b.operationtype,
       nvl(b.weight,0) weight,
       nvl(b.cubage,0) cubage,
       nvl(b.fixqty,0) fixqty,
       b.memo dtkmemo,
       b.stevedore,
       b.usestatus dtlusestatus,
       b.dispatchdtlid,
       b.goodsownerid,
       b.gcompanyid,
       b.trid,
       b.dispatchid dtldispatchid,
       b.backtime,
       b.backman,
       b.backdescr dtlbackdescr,
       d.deptname,
       c.chainflag,
       decode(c.chainflag,'','否','0','否','1','是')chainflagchar,
       (case when d.prtclass like '%冷%' then '冷藏区' when d.prtclass like '%毒%' then '毒麻区' when d.prtclass like '%麻%' then '毒麻区' else c.zonename end ) zonename,
       --null zzxrws
       decode(b.goodsownerid,340,decode(nvl(b.scatterpacks,0),0,0,1,1,(select count(1) from zx_zyc_zzxrws_v t where t.waveid=d.waveid and t.goodsownerid=b.goodsownerid and t.companyid=d.customid)),null) zzxrws,
       e.addmedcheckflag, --add by zyc 20160901
       decode(e.addmedcheckflag,'','否','0','否','1','是')addmedcheckflagchar,
       ll.ddlname usestatuschar

       from Tms_dispatch_doc_v a,Tms_dispatch_dtl_v b,tms_tr_doc_v c,wms_wave_dtl_v d,Tpl_go_company e,
            (select aa.ddlname,aa.ddlid from sys_ddl_dtl aa ,sys_ddl bb where bb.sysid=aa.sysid and bb.keyword = 'WMS_DISPATCH_STATUS')ll,
             (select aa.ddlname,aa.ddlid from sys_ddl_dtl aa ,sys_ddl bb where bb.sysid=aa.sysid and bb.keyword = 'WMS_SELFTRANSTYPE')mm
       where a.DISPATCHID=b.DISPATCHID(+)
       and   b.TRID=c.TRID(+)
       and   c.SOURCEID=d.wavedtlid(+)
       and b.gcompanyid=e.companyid(+)
       and a.usestatus=ll.ddlid(+)
       and a.selftranstype = mm.ddlid(+)
       and a.usestatus<>0--过滤掉撤单状态的派车单 中宏@221115 by tl
"
"GSP_AC_GOODS_LICENSE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_AC_GOODS_LICENSE_V"" (""LICENSEID"", ""LICENSETYPEID"", ""OWNERGOODSID"", ""LICENSECODE"", ""SIGNCOMPANY"", ""SIGNDATE"", ""STARTDATE"", ""ENDVALIDATE"", ""CONTEXT"", ""JOBSTATUS"", ""STOPFLAG"", ""MEMO"", ""CREMANID"", ""GOODSFLAG"", ""CREDATE"", ""CREMANNAME"", ""LICENSETYPENAME"", ""GOODSSORT"", ""VALIDATEFLAG"", ""BEYONDDAYS"", ""FILECOUNT"") AS 
  select a.licenseid,
       a.licensetypeid,
       a.ownergoodsid,
       a.licensecode,
       a.signcompany,
       a.signdate,
       a.startdate,
       a.endvalidate,
       a.context,
       a.jobstatus,
       a.stopflag,
       a.memo,
       a.cremanid,
       b.goodsflag,
       a.credate,
       c.employeename as cremanname,
       b.licensetypename,
       b.goodssort,
       b.validateflag,
       a.beyonddays,
       a.filecount
  from gsp_ac_goods_license a,
       gsp_ware_license_type  b,
       pub_employee             c
 where a.licensetypeid = b.licensetypeid
   and a.cremanid=c.employeeid(+)
"
"GSP_AC_LICENSE_SCOPE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_AC_LICENSE_SCOPE_V"" (""GOODSOWNERID"", ""BUSCOPEID"", ""LICENSEID"", ""STATUS"", ""GOODSOWNERNAME"", ""BUSCOPENAME"", ""LICENSETYPENAME"") AS 
  select a.GOODSOWNERID,
       a.BUSCOPEID,
       a.LICENSEID,
       a.STATUS,
       b.goodsownername,
       c.buscopename,
       e.licensetypename
  from gsp_ac_license_scope     a,
       Tpl_goodsowner           b,
       bs_buscope               c,
       gsp_ware_company_license d,
       gsp_ware_license_type    e
 where a.goodsownerid = b.goodsownerid
   and a.buscopeid = c.buscopeid
   and a.licenseid = d.licenseid
   and d.licensetypeid = e.licensetypeid
"
"GSP_AC_WAREHOUSE_SCOPE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_AC_WAREHOUSE_SCOPE_V"" (""BUSCOPEID"", ""WAREHOUSEID"", ""WAREHNAME"", ""BUSCOPENAME"") AS 
  select a.BUSCOPEID, a.WAREHOUSEID, b.warehname, c.buscopename
  from gsp_ac_warehouse_scope a, tpl_warehouse b, bs_buscope c
 where a.warehouseid = b.warehid
   and a.buscopeid = c.buscopeid
"
"GSP_APPLIANCE_MANAGE_PERMIT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_APPLIANCE_MANAGE_PERMIT_V"" (""APPLIANCEID"", ""COMPANYID"", ""COMPANYNAME"", ""APPLIANCENO"", ""ADDRESS"", ""MANAGEADDRESS"", ""PRODUCTRAGE"", ""SIGNDATE"", ""VALIDONDATE"", ""VALIDENDDATE"", ""PRINCIPAL"", ""CORPORATION"", ""PICTURE"", ""FILEGROUPID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""USESTATUS"") AS 
  select a.applianceid,
         a.companyid,
         b.companyname,
         a.applianceno,
         a.address,
         a.manageaddress,
         a.productrage,
         a.signdate,
         a.validondate,
         a.validenddate,
         a.principal,
         a.corporation,
         a.picture,
         a.filegroupid,
         a.credate,
         a.inputmanid,
         c.employeename inputmanname,
         a.usestatus
    from gsp_appliance_manage_permit a, tpl_pub_company b, pub_employee c
   where a.companyid = b.companyid
     and a.inputmanid = c.employeeid
"
"GSP_APPLIANCE_PRODUCT_PERMIT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_APPLIANCE_PRODUCT_PERMIT_V"" (""APPMITID"", ""COMPANYID"", ""COMPANYNAME"", ""PERMITNO"", ""PRODUCTRAGE"", ""SIGNDATE"", ""VALIDONDATE"", ""VALIDENDDATE"", ""PRINCIPAL"", ""CORPORATION"", ""PICTURE"", ""FILEGROUPID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""USESTATUS"") AS 
  select a.appmitid,
         a.companyid,
         b.companyname,
         a.permitno,
         a.productrage,
         a.signdate,
         a.validondate,
         a.validenddate,
         a.principal,
         a.corporation,
         a.picture,
         a.filegroupid,
         a.credate,
         a.inputmanid,
         c.employeename inputmanname,
         a.usestatus
    from gsp_appliance_product_permit a, tpl_pub_company b, pub_employee c
   where a.companyid = b.companyid
     and a.inputmanid = c.employeeid
"
"GSP_CONSERVE_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_CONSERVE_DOC_V"" (""GROUPID"", ""GROUPNO"", ""GROUPNAME"", ""WAREHID"", ""WAREHNAME"", ""MEMO"") AS 
  (select a.""GROUPID"",a.""GROUPNO"",a.""GROUPNAME"",a.""WAREHID"",b.warehname,a.""MEMO""
from  gsp_conserve_doc a,
tpl_warehouse b
where
a.warehid = b.warehid(+)
)
"
"GSP_CONSERVE_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_CONSERVE_DTL_V"" (""DTLID"", ""GROUPID"", ""EMPLOYEEID"", ""OPCODE"", ""EMPLOYEENAME"", ""MEMO"") AS 
  (select a.""DTLID"",a.groupid,a.employeeid,b.opcode,b.employeename ,a.memo
 from  gsp_conserve_dtl a,
 pub_employee b

 where a.employeeid = b.employeeid(+)

)
"
"GSP_CONSERVE_PLAN_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_CONSERVE_PLAN_DOC_V"" (""CREDATE"", ""CREDATEMANID"", ""CREDATEMAN"", ""CREDATEMANOPCODE"", ""PLANNO"", ""CONSERVETYPE"", ""USESTATUS"", ""MEMO"", ""CONSERVEDOCID"", ""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""GROUPID"", ""GROUPNO"", ""GROUPNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.credate,
         a.credatemanid,
         b.employeename credateman,
         b.opcode credatemanopcode,
         a.planno,
         a.conservetype,
         a.usestatus,
         a.memo,
         a.conservedocid,
         a.warehid,
         c.warehopcode,
         c.warehname,
         a.groupid,
         d.groupno,
         d.groupname,
         a.goodsownerid,   --add by xyue 2017-12-11
         e.goodsownername  --add by xyue 2017-12-11
    from gsp_conserve_plan_doc a,
         pub_employee b,
         tpl_warehouse c,
         gsp_conserve_doc d,
         tpl_goodsowner e  --add by xyue 2017-12-11
   where a.credatemanid = b.employeeid(+)
   AND a.warehid = c.warehid(+)
   and a.groupid = d.groupid(+)
   and a.goodsownerid = e.goodsownerid(+) --add by xyue 2017-12-11
"
"GSP_CONSERVE_PLAN_DTL_BAK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_CONSERVE_PLAN_DTL_BAK_V"" (""WAREHNAME"", ""CONSERVEDOCID"", ""CONSERVEDTLID"", ""CREDATE"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSFORMALNAME"", ""PRODAREA"", ""FACTID"", ""COMPANYNAME"", ""COMPANYOPCODE"", ""GOODSQTYPE"", ""LOTID"", ""LOTNO"", ""LOTVALIDDATE"", ""APPROVEDOCNO"", ""PRODDATE"", ""POSID"", ""AREAID"", ""AREANO"", ""AREANAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""POSNAME"", ""POSNO"", ""GOODSQTY"", ""MEMO"", ""QUANSTANDARD"", ""STORAGECONDITION"", ""PACKAGE"", ""RESULT"", ""CHECKMANID"", ""CHECKMANOPCODE"", ""CHECKMAN"", ""POSMEMO"", ""WAREHID"", ""VALIDDATE"", ""DRUGFORMNO"", ""DRUGFORM"", ""USESTATUS"", ""GOODSUNIT"", ""LASTCONSERVEDATE"", ""EMFLAG"", ""GROUPID"", ""GROUPNO"", ""GROUPNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""OFFDAY"", ""MAH"") AS 
  SELECT b.warehname,
       a.conservedocid,
       a.conservedtlid,
       a.credate,
       a.goodsid,
       c.opcode,
       c.goodsname,
       c.goodsformalname,
       c.prodarea,
       c.factid,
       d.companyname,
       d.companyopcode,
       c.goodstype goodsqtype,
       a.lotid,
       i.lotno,
       decode(to_char(i.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              i.validdate) lotvaliddate,
       i.approvedocno,
       i.proddate,
       a.posid,
       h.areaid,
       f.areano,
       f.areaname,
       h.sectionid,
       g.sectionno,
       g.sectionname,
       h.posname,
       h.posno,
       a.goodsqty,
       a.memo,
       a.quanstandard,
       a.storagecondition,
       a.package,
       a.result,
       a.checkmanid,
       k.opcode checkmanopcode,
       k.employeename checkman,
       a.posmemo,
       a.warehid,
       i.validdate,
       j.drugformno,
       j.drugform,
       a.usestatus,
       l.packname goodsunit,
       a.lastconservedate,
       a.emflag,
       o.groupid,
       o.groupno,
       o.groupname,
       a.goodsownerid,
       p.goodsownername,
       a.ownergoodsid,-- add by xyue 2017-12-11
       '' offday, --change by xyue 2017-12-11 去掉离上次养护时间的关联
       i.mah --add by xyue 2019-12-05 上市许可持有人
       --a.goodspackid,
       --l.packname,
       --l.packsize
  from gsp_conserve_plan_dtl   a,
       tpl_pub_goods           c,
       tpl_pub_company         d,
       wms_goods_lot           i,
       wms_st_area_def         f,
       wms_st_section_def      g,
       wms_pos_def             h,
       tpl_drugform            j,
       pub_employee            k,
       tpl_warehouse           b,
       Tpl_pub_goods_packs     l,
       gsp_conserve_plan_doc   m,
       gsp_conserve_doc        o,
       tpl_goodsowner          p
 WHERE a.goodsid = c.goodsid(+)
   and c.factid = d.companyid(+)
   and a.posid = h.posid(+)
   and h.areaid = f.areaid(+)
   and h.sectionid = g.sectionid(+)
   and a.checkmanid = k.employeeid(+)
   and j.drugformno(+) = c.drugform
   AND a.lotid = i.lotid(+)
   AND a.warehid = b.warehid(+)
   AND a.goodsid = l.goodsid(+)
   --and a.goodspackid=l.goodspackid(+)
   AND l.baseunitflag = 1
   And a.conservedocid = m.conservedocid
   And m.groupid       = o.groupid(+)
   And a.goodsownerid = p.goodsownerid(+)
"
"GSP_CONSERVE_PLAN_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_CONSERVE_PLAN_DTL_V"" (""CONSERVEDOCID"", ""CONSERVEDTLID"", ""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSOWNID"", ""OPCODE"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""GOODSUNIT"", ""PRODAREA"", ""FACTNAME"", ""DRUGFORM"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""APPROVEDOCNO"", ""PRODDATE"", ""MAH"", ""GOODSQTY"", ""MEMO"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""USESTATUS"", ""LASTCONSERVEDATE"", ""GOODSCLASS"") AS 
  SELECT a.conservedocid,
       a.conservedtlid,
       a.credate,
       a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.goodsid,
       a.ownergoodsid,
       d.goodsownid,
       d.opcode,
       d.goodsname,
       d.goodsengname,
       d.goodstype,
       d.tradepackname goodsunit,
       d.prodarea,
       d.factname,
       d.drugform,
       a.lotid,
       e.lotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,
       e.approvedocno,
       e.proddate,
       e.mah,
       a.goodsqty,
       a.memo,
       a.goodspackid,
       f.packname,
       f.packsize,
       a.usestatus,
       a.lastconservedate,
       g.goodsclass
  from gsp_conserve_plan_dtl   a,
       tpl_warehouse           b,
       tpl_goodsowner          c,
       tpl_goods               d,
       wms_goods_lot           e,
       tpl_pub_goods_packs     f,
       wms_goods_feature       g
 WHERE a.warehid=b.warehid(+)
   and a.goodsownerid=c.goodsownerid(+)
   and a.ownergoodsid=d.ownergoodsid(+)
   and a.lotid=e.lotid(+)
   and nvl(a.goodspackid,0)=f.goodspackid(+)
   and a.goodsid=g.goodsid
   and a.warehid=g.warehid
"
"GSP_CONSERVE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_CONSERVE_V"" (""WAREHNAME"", ""CONSERVEID"", ""CREDATE"", ""WAREHID"", ""WAREHOPCODE"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSFORMALNAME"", ""PRODAREA"", ""FACTID"", ""COMPANYNAME"", ""COMPANYOPCODE"", ""DRUGFORM"", ""DRUGFORMNO"", ""GOODSQTYPE"", ""LOTID"", ""LOTNO"", ""LOTVALIDDATE"", ""APPROVEDOCNO"", ""PRODDATE"", ""POSID"", ""AREAID"", ""AREANO"", ""AREANAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""POSNAME"", ""POSNO"", ""GOODSQTY"", ""GOODSUNIT"", ""MATTER"", ""CONTENTS"", ""LASTCONSERVEDATE"", ""USESTATUS"", ""VALIDDATE"", ""MEMO"", ""QUANSTANDARD"", ""STORAGECONDITION"", ""PROPERTIES"", ""PACKAGE"", ""CHECKQTY"", ""CHECKRESULT"", ""RECHECKQTY"", ""RECHECKRESULT"", ""RESULT"", ""CHECKMANID"", ""QUILITYQTY"", ""UNQUILITYQTY"", ""CHECKMANOPCODE"", ""CHECKMAN"", ""CHECKMEMO"", ""EQUIPMENTID"", ""EQUIPMENTOPCODE"", ""EQUIPMENTNAME"", ""USEREASON"", ""CHECKGOODS"", ""USEMAN"", ""EQUIPMENTMEMO"", ""WHITESTOCKNUM"", ""WHITEPOINTNUM"", ""XIANWEINUM"", ""BOXIENUM"", ""JINSHUXIENUM"", ""OTHERNUM"", ""JKHZFLAG"", ""SOURCEID"", ""REWHITESTOCKNUM"", ""REWHITEPOINTNUM"", ""REXIANWEINUM"", ""REBOXIENUM"", ""REJINSHUXIENUM"", ""REOTHERNUM"", ""EMFLAG"", ""PRINTFLAG"", ""PRINTDATE"", ""PRINTMANID"", ""PRINTMAN"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSOWNID"", ""PLANGOODSQTY"", ""CONSERVEDATE"", ""MAH"", ""PRINTEXPIREFLAG"", ""PRINTMONTHFLAG"", ""OWNERGOODSID"", ""IWCS_FLAG"", ""IWCS_CHECKMAN"") AS 
  select tpl_warehouse.warehname,
       gsp_conserve.conserveid,
       gsp_conserve.credate,
       gsp_conserve.warehid,
       tpl_warehouse.warehopcode,
       gsp_conserve.goodsid,
       d.opcode,
       d.goodsname,
       d.goodsformalname,
       d.prodarea,
       tpl_pub_goods.factid,
       d.factname companyname,
       tpl_pub_company.companyopcode,
       tpl_drugform.drugform,
       tpl_drugform.drugformno,
       d.goodstype GOODSQTYPE,
       gsp_conserve.lotid,
       wms_goods_lot.lotno,
       decode(to_char(wms_goods_lot.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              wms_goods_lot.validdate) lotvaliddate,
       wms_goods_lot.approvedocno,
       wms_goods_lot.proddate,
       gsp_conserve.posid,
       wms_pos_def.areaid,
       wms_st_area_def.areano,
       wms_st_area_def.areaname,
       wms_pos_def.sectionid,
       wms_st_section_def.sectionno,
       wms_st_section_def.sectionname,
       wms_pos_def.posname,
       wms_pos_def.posno,
       gsp_conserve.goodsqty,
       gsp_conserve.goodsunit,
       gsp_conserve.matter,
       gsp_conserve.contents,
       gsp_conserve.lastconservedate,
       gsp_conserve.usestatus,
       gsp_conserve.validdate,
       gsp_conserve.memo,
       gsp_conserve.quanstandard,
       d.storagecondition, -- add by xyue 2017-12-11
       gsp_conserve.properties,
       gsp_conserve.package,
       gsp_conserve.checkqty,
       gsp_conserve.checkresult,
       gsp_conserve.recheckqty,
       gsp_conserve.recheckresult,
       gsp_conserve.result,
       gsp_conserve.checkmanid,
       gsp_conserve.quilityqty,
       gsp_conserve.unquilityqty,
       a.opcode checkmanopcode,
       a.employeename checkman,
       gsp_conserve.checkmemo,
       gsp_conserve.equipmentid,
       b.equipmentopcode,
       b.equipmentname,
       gsp_conserve.usereason,
       gsp_conserve.checkgoods,
       gsp_conserve.useman,
       gsp_conserve.equipmentmemo,
       gsp_conserve.whitestocknum,
       gsp_conserve.whitepointnum,
       gsp_conserve.xianweinum,
       gsp_conserve.boxienum,
       gsp_conserve.jinshuxienum,
       gsp_conserve.othernum,
       tpl_pub_goods.jkhzflag,
       gsp_conserve.sourceid,
       gsp_conserve.rewhitestocknum,
       gsp_conserve.rewhitepointnum,
       gsp_conserve.rexianweinum,
       gsp_conserve.reboxienum,
       gsp_conserve.rejinshuxienum,
       gsp_conserve.reothernum,
       gsp_conserve.emflag,
       gsp_conserve.printflag,
       gsp_conserve.printdate,
       gsp_conserve.printmanid,
       c.employeename printman,
       gsp_conserve.goodsownerid,
       f.goodsownername,
       d.goodsownid, -- add by xyue 2017-12-11
       e.goodsqty plangoodsqty, -- add by xyue 2017-12-11
       gsp_conserve.conservedate, -- add by xyue 2017-12-11
       wms_goods_lot.mah, --add by xyue 2019-12-05 上市许可持有人
       wms_goods_Lot.Printexpireflag, --add by llq 2020-12-31 打印失效期标志
       wms_goods_lot.printmonthflag, -- by tl@210820打印精确到月
       d.ownergoodsid, --tl@211231
       wms_st_section_def.iwcs_flag,
       (select max(y.employeecode)
          from ssc_gsp_maintain_goods@iwcs x, sys_userlist@iwcs y
         where x.maintainer = y.userid(+)
           and x.mntn_bill_no = gsp_conserve.conserveid) iwcs_checkman
  from gsp_conserve,
       tpl_warehouse,
       tpl_pub_goods,
       tpl_pub_company,
       wms_goods_lot,
       wms_st_area_def,
       wms_st_section_def,
       wms_pos_def,
       tpl_drugform,
       pub_employee          a,
       gsp_equipment         b,
       pub_employee          c,
       tpl_goodsowner        f,
       gsp_conserve_plan_dtl e, --add by xyue 2017-12-11
       tpl_goods             d --add by xyue 2017-12-11
 where gsp_conserve.warehid = tpl_warehouse.warehid(+)
   and gsp_conserve.goodsid = tpl_pub_goods.goodsid(+)
   and tpl_pub_goods.factid = tpl_pub_company.companyid(+)
   and gsp_conserve.lotid = wms_goods_lot.lotid(+)
   and gsp_conserve.posid = wms_pos_def.posid(+)
   and wms_pos_def.areaid = wms_st_area_def.areaid(+)
   and wms_pos_def.sectionid = wms_st_section_def.sectionid(+)
   and gsp_conserve.checkmanid = a.employeeid(+)
   and gsp_conserve.equipmentid = b.equipmentid(+)
   and tpl_drugform.drugformno(+) = tpl_pub_goods.drugform
   AND gsp_conserve.printmanid = c.employeeid(+)
   And gsp_conserve.goodsownerid = f.goodsownerid(+)
   and gsp_conserve.sourceid = e.conservedtlid(+) --add by xyue 2017-12-11
   and gsp_conserve.ownergoodsid = d.ownergoodsid(+) --add by xyue 2017-12-11
"
"GSP_CORPORATION_CONSIGN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_CORPORATION_CONSIGN_V"" (""CONSIGNID"", ""COMPANYID"", ""COMPANYNAME"", ""CONSIGNNAME"", ""CONSIGNADDR"", ""CONSIGNIDCARD"", ""VALIDONDATE"", ""VALIDENDDATE"", ""CONNECTMAN"", ""CONNECTPHONE"", ""PICTURE"", ""FILEGROUPID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""USESTATUS"", ""RANGE"", ""AREA"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTORYNAME"", ""AUTHORIZE"") AS 
  select a.consignid,
         a.companyid,
         b.companyname,
         a.consignname,
         a.consignaddr,
         a.consignidcard,
         a.validondate,
         a.validenddate,
         a.connectman,
         a.connectphone,
         a.picture,
         a.filegroupid,
         a.credate,
         a.inputmanid,
         c.employeename inputmanname,
         a.usestatus,
         a.range,
         a.area,
         a.goodsid,
         d.opcode,
         d.goodsname,
         d.goodstype,
         d.prodarea,
         e.companyname factoryname,
         a.authorize
    from gsp_corporation_consign a, tpl_pub_company b,
    pub_employee c,tpl_pub_goods d,tpl_pub_company e
   where a.companyid = b.companyid
     and a.inputmanid = c.employeeid
     and a.goodsid = d.goodsid(+)
     and d.factid=e.companyid(+)
"
"GSP_CORPORATION_SHOPCARD_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_CORPORATION_SHOPCARD_V"" (""CARDID"", ""COMPANYID"", ""COMPANYNAME"", ""CARDNO"", ""CARDORDERNO"", ""OLDNAME"", ""ADDRESS"", ""CORPORATION"", ""PRINCIPAL"", ""COMPANYTYPE"", ""VALIDONDATE"", ""VALIDENDDATE"", ""YEARCHECK"", ""PICTURE"", ""FILEGROUPID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""USESTATUS"") AS 
  select a.cardid,
         a.companyid,
         b.companyname,
         a.cardno,
         a.cardorderno,
         a.oldname,
         a.address,
         a.corporation,
         a.principal,
         a.companytype,
         a.validondate,
         a.validenddate,
         a.yearcheck,
         a.picture,
         a.filegroupid,
         a.credate,
         a.inputmanid,
         c.employeename inputmanname,
         a.usestatus
    from gsp_corporation_shopcard a, tpl_pub_company b, pub_employee c
   where a.companyid = b.companyid
     and a.inputmanid = c.employeeid
"
"GSP_DRUG_MANAGE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_DRUG_MANAGE_V"" (""DRUGID"", ""COMPANYID"", ""COMPANYNAME"", ""DRUGNO"", ""VALIDONDATE"", ""VALIDENDDATE"", ""PICTURE"", ""FILEGROUPID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""USESTATUS"") AS 
  select a.drugid,
         a.companyid,
         b.companyname,
         a.drugno,
         a.validondate,
         a.validenddate,
         a.picture,
         a.filegroupid,
         a.credate,
         a.inputmanid,
         c.employeename inputmanname,
         a.usestatus
    from gsp_drug_manage a, tpl_pub_company b, pub_employee c
   where a.companyid = b.companyid
     and a.inputmanid = c.employeeid
"
"GSP_EQUIPMENT_MAINTAIN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_EQUIPMENT_MAINTAIN_V"" (""MAINTAINID"", ""EQUIPMENTID"", ""CREDATE"", ""INPUTMANID"", ""MAINTAINDATE"", ""ENDDATE"", ""MAINTAININFO"", ""MAINTAINMANID"", ""MEMO"", ""INPUTMANOPCODE"", ""INPUTMAN"", ""MAINTAINMANOPCODE"", ""MAINTAINMAN"") AS 
  select a.maintainid,
       a.equipmentid,
       a.credate,
       a.inputmanid,
       a.maintaindate,
       a.enddate,
       a.maintaininfo,
       a.maintainmanid,
       a.memo,
       b.opcode inputmanopcode,
       b.employeename inputman,
       c.opcode maintainmanopcode,
       c.employeename maintainman
  from gsp_equipment_maintain a, pub_employee b, pub_employee c
 where a.inputmanid = b.employeeid(+)
   and a.maintainmanid = c.employeeid(+)

 "
"GSP_EQUIPMENT_USED_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_EQUIPMENT_USED_V"" (""USEID"", ""EQUIPMENTID"", ""CREDATE"", ""INPUTMANID"", ""USEDATE"", ""WORK"", ""USEMANID"", ""USEDEPTID"", ""COMEFROM"", ""SOURCEID"", ""MEMO"", ""INPUTMANOPCODE"", ""INPUTMAN"", ""USEMANOPCODE"", ""USEMAN"", ""USEDEPTNAME"", ""USEDEPTOPCODE"") AS 
  select a.useid,
       a.equipmentid,
       a.credate,
       a.inputmanid,
       a.usedate,
       a.work,
       a.usemanid,
       a.usedeptid,
       a.comefrom,
       a.sourceid,
       a.memo,
       b.opcode inputmanopcode,
       b.employeename inputman,
       c.opcode usemanopcode,
       c.employeename useman,
       d.companyname usedeptname,
       d.companyopcode usedeptopcode
  from gsp_equipment_used a,
  pub_employee b,
  pub_employee c,
  pub_company  d
 where a.inputmanid = b.employeeid(+)
   and a.usemanid = c.employeeid(+)
   and a.usedeptid = d.companyid(+)

 "
"GSP_EQUIPMENT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_EQUIPMENT_V"" (""EQUIPMENTID"", ""CREDATE"", ""INPUTMANID"", ""EQUIPMENTOPCODE"", ""EQUIPMENTNAME"", ""EQUIPMENTNO"", ""FACTORYNAME"", ""PRODDATE"", ""PURCHASEDATE"", ""PURCHASEMANID"", ""PHONE"", ""MANAGEMANID"", ""DEPTID"", ""USEDATE"", ""INFORMATION"", ""ACCESSORY"", ""USESTATUS"", ""MEMO"", ""INPUTMANOPCODE"", ""INPUTMAN"", ""PURCHASEMANOPCODE"", ""PURCHASEMAN"", ""MANAGEMANOPCODE"", ""MANAGEMAN"") AS 
  select a.equipmentid,
       a.credate,
       a.inputmanid,
       a.equipmentopcode,
       a.equipmentname,
       a.equipmentno,
       a.factoryname,
       a.proddate,
       a.purchasedate,
       a.purchasemanid,
       a.phone,
       a.managemanid,
       a.deptid,
       a.usedate,
       a.information,
       a.accessory,
       a.usestatus,
       a.memo,
       b.opcode inputmanopcode,
       b.employeename inputman,
       c.opcode purchasemanopcode,
       c.employeename purchaseman,
       d.opcode managemanopcode,
       d.employeename manageman
  from gsp_equipment a,
       pub_employee b,
       pub_employee c,
       pub_employee d
 where a.inputmanid = b.employeeid(+)
   and a.purchasemanid = c.employeeid(+)
   and a.managemanid = d.employeeid(+)

 "
"GSP_GOODSMAIN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_GOODSMAIN_V"" (""GOODSID"", ""GROUPID"", ""WAREHID"", ""MEMO"", ""MMRO"", ""GOODMAINID"", ""CONSERVEDAYS"", ""VALIDDAYS"", ""WAREHNAME"", ""OPCODE"", ""GOODSNAME"", ""PRODAREA"", ""GOODSTYPE"", ""FACTNAME"") AS 
  (select a.""GOODSID"",
        a.groupid,
        a.warehid,
        a.""MEMO"",
        a.""MMRO"",
        a.""GOODMAINID"",
        a.conservedays,
        a.validdays,
       d.warehname,
       b.opcode,
       b.goodsname,
       b.prodarea,
       b.goodstype,
       c.companyname factname
from gsp_goodsmain a,
       tpl_pub_goods     b,
       tpl_pub_company   c,
     tpl_warehouse d

 where a.warehid = d.warehid(+)
 and a.goodsid = b.goodsid(+)
 and b.factid = c.companyid(+)
)
"
"GSP_GOODS_UNQUALIFIED_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_GOODS_UNQUALIFIED_V"" (""UNQUALIFYID"", ""GOODSID"", ""GOODSOWNID"", ""OWNERGOODSOPCODE"", ""OWNERGOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""GOODSUNIT"", ""PRODAREA"", ""PACKNAME"", ""PACKSIZE"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""WAREHNAME"", ""WAREHOPCODE"", ""GOODSPACKID"", ""BATCHNO"", ""LOTID"", ""GOODSQTY"", ""REASON"", ""APPFLAG"", ""APPMEMO"", ""GOODSOWNERID"", ""CREDATE"", ""INPUTMANID"", ""MEMO"", ""DEALMETHOD"", ""COMEFROM"", ""APPMANID"", ""OWNERGOODSID"", ""WAREHID"", ""SRCID"", ""POSID"", ""OPERATIONTYPE"", ""INPUTMAN"", ""MAH"", ""USESTATUS"") AS 
  select a.unqualifyid,
       a.goodsid,
       b.goodsownid, --货主原货品ID
       b.opcode ownergoodsopcode, --货主货品操作码
       b.goodsname ownergoodsname, --货主货品名称
       b.goodstype,
       --b.factid,
       b.factname factname, --生产厂家
       baseunit.packname goodsunit, --xyue 2014-06-12 增加基本单位，取包装明细上basefalg=1的包装名称
       b.prodarea,
       c.packname,
       c.packsize,
       d.lotno,
       d.proddate,
       d.validdate,
       --e.posno,
       f.goodsownername,
       f.goopcode, --货主操作码
       g.warehname,
       g.warehopcode, --物流中心操作码
       a.goodspackid,
       a.batchno,
       a.lotid,
       a.goodsqty,
       --a.reason,
       decode(a.warehid,9,h.unqualifiedmemo,h.checkmemo) reason,--change by xyue 2019-04-26,2023-05-10莆田鹭燕需求
       a.appflag,
       a.appmemo,
       a.goodsownerid,
       a.credate,
       a.inputmanid,
       a.memo,
       a.dealmethod,
       a.comefrom,
       a.appmanid,
       a.ownergoodsid,
       -- h.opcode ownergoodsopcode,--货主货品操作码
       -- h.goodsname ownergoodsname,--货主货品名称
       -- h.factname,--生产厂家
       a.warehid,
       a.srcid,
       a.posid,
       h.operationtype, --取验收入库类型
       i.employeename inputman ,--add by xyue 2019-06-25
       d.mah, --by tl@191205
       nvl(a.usestatus,0) usestatus
  from GSP_goods_Unqualified a,
       --tpl_pub_goods_v         b,
       tpl_pub_goods_packs c,
       --xyue 2014-06-12 增加基本单位，取包装明细上basefalg=1的包装名称
       (select t.goodsid, t.packname
          from tpl_pub_goods_packs t
         where t.baseunitflag = 1) baseunit,
       tpl_goods b,
       --tpl_goods_packs       c,
       wms_goods_lot d,
       -- wms_pos_def           e,
       tpl_goodsowner f,
       tpl_warehouse g,
       (select t3.operationtype, t1.receiveid,t1.checkmemo,t1.unqualifiedmemo
          from wms_receive_dtl t1, wms_in_order_dtl t2, wms_in_order t3
         where t3.inid = t2.inid
           and t2.indtlid = t1.indtlid) h,
       pub_employee       i

 where a.ownergoodsid = b.ownergoodsid
   and a.goodspackid = c.goodspackid
   and a.lotid = d.lotid
      --and   a.posid = e.posid(+)
   and a.goodsownerid = f.goodsownerid
   and a.warehid = g.warehid(+)
   and a.goodsid = baseunit.goodsid
   and a.goodsownerid = b.goodsownerid(+)
   and a.goodsownerid = b.goodsownerid
   and a.srcid = h.receiveid(+)
   and a.comefrom = 1
   and h.operationtype is not null
   and a.inputmanid=i.employeeid(+)

union all

select a.unqualifyid,
       a.goodsid,
       b.goodsownid, --货主原货品ID
       b.opcode ownergoodsopcode, --货主货品操作码
       b.goodsname ownergoodsname, --货主货品名称
       b.goodstype,
       --b.factid,
       b.factname factname, --生产厂家
       baseunit.packname goodsunit, --xyue 2014-06-12 增加基本单位，取包装明细上basefalg=1的包装名称
       b.prodarea,
       c.packname,
       c.packsize,
       d.lotno,
       d.proddate,
       d.validdate,
       --e.posno,
       f.goodsownername,
       f.goopcode, --货主操作码
       g.warehname,
       g.warehopcode, --物流中心操作码
       a.goodspackid,
       a.batchno,
       a.lotid,
       a.goodsqty,
       a.reason,
       a.appflag,
       a.appmemo,
       a.goodsownerid,
       a.credate,
       a.inputmanid,
       a.memo,
       a.dealmethod,
       a.comefrom,
       a.appmanid,
       a.ownergoodsid,
       -- h.opcode ownergoodsopcode,--货主货品操作码
       -- h.goodsname ownergoodsname,--货主货品名称
       -- h.factname,--生产厂家
       a.warehid,
       a.srcid,
       a.posid,
       null operationtype, --取验收入库类型
       i.employeename inputman ,--add by xyue 2019-06-25
       d.mah, --by tl@191205
       nvl(a.usestatus,0) usestatus
  from GSP_goods_Unqualified a,
       --tpl_pub_goods_v         b,
       tpl_pub_goods_packs c,
       --xyue 2014-06-12 增加基本单位，取包装明细上basefalg=1的包装名称
       (select t.goodsid, t.packname
          from tpl_pub_goods_packs t
         where t.baseunitflag = 1) baseunit,
       tpl_goods b,
       --tpl_goods_packs       c,
       wms_goods_lot d,
       -- wms_pos_def           e,
       tpl_goodsowner f,
       tpl_warehouse g,
       (select t3.operationtype, t1.receiveid
          from wms_receive_dtl t1, wms_in_order_dtl t2, wms_in_order t3
         where t3.inid = t2.inid
           and t2.indtlid = t1.indtlid) h,
       pub_employee       i

 where a.ownergoodsid = b.ownergoodsid
   and a.goodspackid = c.goodspackid
   and a.lotid = d.lotid
   and a.goodsownerid = f.goodsownerid
   and a.warehid = g.warehid(+)
   and a.goodsid = baseunit.goodsid
   and a.goodsownerid = b.goodsownerid(+)
   and a.goodsownerid = b.goodsownerid
   and a.srcid = h.receiveid(+)
   and a.comefrom = 0
   and a.inputmanid=i.employeeid(+)
"
"GSP_GSMP_PERMIT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_GSMP_PERMIT_V"" (""GSMPID"", ""COMPANYID"", ""COMPANYNAME"", ""GSMPTYPE"", ""GSMPNO"", ""ATTESTATIONRAGE"", ""SIGNDATE"", ""SIGNORG"", ""VALIDONDATE"", ""VALIDENDDATE"", ""PICTURE"", ""FILEGROUPID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""USESTATUS"") AS 
  select a.gsmpid,
         a.companyid,
         b.companyname,
         a.gsmptype,
         a.gsmpno,
         a.attestationrage,
         a.signdate,
         a.signorg,
         a.validondate,
         a.validenddate,
         a.picture,
         a.filegroupid,
         a.credate,
         a.inputmanid,
         c.employeename inputmanname,
         a.usestatus
    from gsp_gsmp_permit a, tpl_pub_company b, pub_employee c
   where a.companyid = b.companyid
     and a.inputmanid = c.employeeid
"
"GSP_HEALTHY_PERMIT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_HEALTHY_PERMIT_V"" (""HEALTHYID"", ""COMPANYID"", ""COMPANYNAME"", ""HEALTHYNO"", ""PRINCIPAL"", ""PERMITRAGE"", ""SIGNDATE"", ""SIGNORG"", ""VALIDONDATE"", ""VALIDENDDATE"", ""PICTURE"", ""FILEGROUPID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""USESTATUS"") AS 
  select a.healthyid,
         a.companyid,
         b.companyname,
         a.healthyno,
         a.principal,
         a.permitrage,
         a.signdate,
         a.signorg,
         a.validondate,
         a.validenddate,
         a.picture,
         a.filegroupid,
         a.credate,
         a.inputmanid,
         c.employeename inputmanname,
         a.usestatus
    from gsp_healthy_permit a, tpl_pub_company b, pub_employee c
   where a.companyid = b.companyid
     and a.inputmanid = c.employeeid
"
"GSP_LIQUID_QUANLITY_CHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_LIQUID_QUANLITY_CHECK_V"" (""CHECKID"", ""CHECKDOCNO"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANOPCODE"", ""INPUTMAN"", ""QUCHECKID"", ""QUOPCODE"", ""QUNAME"", ""CHECKDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""ARRIVEDATE"", ""GOODSID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSFORMALNAME"", ""DRUGFORM"", ""GOODSTYPE"", ""GOODSQTY"", ""GOODSUNIT"", ""COMPANYID"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""APPROVEDOCNO"", ""PRODDATE"", ""POSID"", ""POSNO"", ""POSNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""LIGHTSOURCE"", ""BACKCOLOR"", ""TIMELIMIT"", ""GETQTY"", ""WHITEQTY"", ""BIGWHITE"", ""GLASSQTY"", ""FIBREQTY"", ""METALQTY"", ""OTHERQTY"", ""UNQUALQTY"", ""GETQTY2"", ""WHITEQTY2"", ""BIGWHITE2"", ""GLASSQTY2"", ""FIBREQTY2"", ""OTHERQTY2"", ""METALQTY2"", ""UNQUALQTY2"", ""UNQUALRATE"", ""INOUTFLAG"", ""ORDERDTLID"", ""CHECKRESULT"", ""DEALRESULT"", ""CHECKMANID"", ""CHECKMANOPCODE"", ""CHECKMAN"", ""RECHECKMANID"", ""RECHECKMANOPCODE"", ""RECHECKMAN"", ""MEMO"", ""JKHZFLAG"", ""FACTNAME"", ""PRODAREA"") AS 
  select a.checkid,
       a.checkdocno,
       a.credate,
       a.inputmanid,
       b.opcode inputmanopcode,
       b.employeename inputman,
       a.qucheckid,
       e.companyopcode quopcode,
       e.companyname quname,
       a.checkdate,
       a.goodsownerid,
       g.goodsownername,
       g.goopcode,
       a.arrivedate,
       a.goodsid,
       f.opcode goodsopcode,
       f.goodsname,
       f.goodsformalname,
       f.drugform,
       f.goodstype,
       a.goodsqty,
       a.goodsunit,
       a.companyid,
       l.opcode companyopcode,
       l.companyname,
       a.lotid,
       h.lotno,
       decode(to_char(h.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              h.validdate) validdate,
       h.approvedocno,
       h.proddate,
       a.posid,
       k.posno,
       k.posname,
       k.areaid,
       i.areano,
       i.areaname,
       k.sectionid,
       j.sectionno,
       j.sectionname,
       a.lightsource,
       a.backcolor,
       a.timelimit,
       a.getqty,
       a.whiteqty,
       a.bigwhite,
       a.glassqty,
       a.fibreqty,
       a.metalqty,
       a.otherqty,
       a.unqualqty,
       a.getqty2,
       a.whiteqty2,
       a.bigwhite2,
       a.glassqty2,
       a.fibreqty2,
       a.otherqty2,
       a.metalqty2,
       a.unqualqty2,
       a.unqualrate,
       a.inoutflag,
       a.orderdtlid,
       a.checkresult,
       a.dealresult,
       a.checkmanid,
       c.opcode checkmanopcode,
       c.employeename checkman,
       a.recheckmanid,
       d.opcode recheckmanopcode,
       d.employeename recheckman,
       a.memo,
       f.jkhzflag,
       m.companyname factname,
       f.prodarea
  from gsp_liquid_quality_check a,
       pub_employee              b,
       pub_employee              c,
       pub_employee              d,
       pub_company               e,
       tpl_pub_goods             f,
       tpl_goodsowner            g,
       wms_goods_lot             h,
       wms_st_area_def           i,
       wms_st_section_def        j,
       wms_pos_def               k,
       tpl_go_company            l,
       tpl_pub_company m
 where a.inputmanid = b.employeeid(+)
   and a.checkmanid = c.employeeid(+)
   and a.recheckmanid = d.employeeid(+)
   and a.lotid = h.lotid(+)
   and a.posid = k.posid(+)
   and k.areaid = i.areaid(+)
   and k.sectionid = j.sectionid(+)
   and a.goodsownerid = g.goodsownerid(+)
   and a.goodsid = f.goodsid(+)
   and f.factid = m.companyid(+)
   and a.qucheckid = e.companyid(+)
   and a.companyid = l.companyid(+)
"
"GSP_MEDORG_CERTIFY_PERMIT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_MEDORG_CERTIFY_PERMIT_V"" (""MEDORGID"", ""COMPANYID"", ""COMPANYNAME"", ""ORGNAME"", ""COMPANYTYPE"", ""MANAGETYPE"", ""MEDORGNO"", ""CORPORATION"", ""VALIDONDATE"", ""VALIDENDDATE"", ""PICTURE"", ""FILEGROUPID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""USESTATUS"", ""ADDRESS"", ""ISSUAUTHOR"") AS 
  select a.medorgid,
         a.companyid,
         b.companyname,
         a.orgname,
         a.companytype,
         a.managetype,
         a.medorgno,
         a.corporation,
         a.validondate,
         a.validenddate,
         a.picture,
         a.filegroupid,
         a.credate,
         a.inputmanid,
         c.employeename inputmanname,
         a.usestatus,
         --PM4201 增加地址和发证机关
         a.address,
         a.issuauthor

    from gsp_medorg_certify_permit a, tpl_pub_company b, pub_employee c
   where a.companyid = b.companyid
     and a.inputmanid = c.employeeid
"
"GSP_MED_MANAGE_PERMIT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_MED_MANAGE_PERMIT_V"" (""MEDID"", ""COMPANYID"", ""COMPANYNAME"", ""MEDPERMITNO"", ""MANAGERAGE"", ""VALIDONDATE"", ""VALIDENDDATE"", ""PRINCIPAL"", ""CORPORATION"", ""PICTURE"", ""FILEGROUPID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""USESTATUS"") AS 
  select a.medid,
         a.companyid,
         b.companyname,
         a.medpermitno,
         a.managerage,
         a.validondate,
         a.validenddate,
         a.principal,
         a.corporation,
         a.picture,
         a.filegroupid,
         a.credate,
         a.inputmanid,
         c.employeename inputmanname,
         a.usestatus
    from gsp_med_manage_permit a, tpl_pub_company b, pub_employee c
   where a.companyid = b.companyid
     and a.inputmanid = c.employeeid
"
"GSP_MED_PRODUCT_PERMIT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_MED_PRODUCT_PERMIT_V"" (""PERMITID"", ""COMPANYID"", ""COMPANYNAME"", ""PERMITNO"", ""PRODUCTRAGE"", ""SIGNDATE"", ""VALIDONDATE"", ""VALIDENDDATE"", ""PRINCIPAL"", ""CORPORATION"", ""PICTURE"", ""FILEGROUPID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""USESTATUS"") AS 
  select a.permitid,
         a.companyid,
         b.companyname,
         a.permitno,
         a.productrage,
         a.signdate,
         a.validondate,
         a.validenddate,
         a.principal,
         a.corporation,
         a.picture,
         a.filegroupid,
         a.credate,
         a.inputmanid,
         c.employeename inputmanname,
         a.usestatus
    from gsp_med_product_permit a, tpl_pub_company b, pub_employee c
   where a.companyid = b.companyid
     and a.inputmanid = c.employeeid
"
"GSP_ORGANISE_CODE_PERMIT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_ORGANISE_CODE_PERMIT_V"" (""CODEID"", ""COMPANYID"", ""COMPANYNAME"", ""ORGCODENO"", ""ORGANISENAME"", ""COMPANYTYPE"", ""SIGNNO"", ""SIGNORG"", ""VALIDONDATE"", ""VALIDENDDATE"", ""PICTURE"", ""FILEGROUPID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""USESTATUS"") AS 
  select a.codeid,
         a.companyid,
         b.companyname,
         a.orgcodeno,
         a.organisename,
         a.companytype,
         a.signno,
         a.signorg,
         a.validondate,
         a.validenddate,
         a.picture,
         a.filegroupid,
         a.credate,
         a.inputmanid,
         c.employeename inputmanname,
         a.usestatus
    from gsp_organise_code_permit a, tpl_pub_company b, pub_employee c
   where a.companyid = b.companyid
     and a.inputmanid = c.employeeid
"
"GSP_PERMIT_VALIDDATE_QUERY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_PERMIT_VALIDDATE_QUERY_V"" (""PERMITID"", ""COMPANYID"", ""VALIDONDATE"", ""VALIDENDDATE"", ""USESTATUS"", ""COMPANYNAME"", ""COMPANYOPCODE"", ""PERMITNAME"", ""DAYS"") AS 
  select gsp_corporation_shopcard.cardid permitid,
       gsp_corporation_shopcard.companyid,
       gsp_corporation_shopcard.validondate,
       gsp_corporation_shopcard.validenddate,
       gsp_corporation_shopcard.usestatus,
       tpl_pub_company.companyname,
       tpl_pub_company.companyopcode,
       '企业法人营业执照' permitname,
       round(validenddate-sysdate,0) days
  from gsp_corporation_shopcard, tpl_pub_company
 where gsp_corporation_shopcard.companyid = tpl_pub_company.companyid(+)

union all

--药品经营许可证
select gsp_med_manage_permit.medid permitid,
       gsp_med_manage_permit.companyid,
       gsp_med_manage_permit.validondate,
       gsp_med_manage_permit.validenddate,
       gsp_med_manage_permit.usestatus,
       tpl_pub_company.companyname,
       tpl_pub_company.companyopcode,
       '药品经营许可证' permitname,
        round(validenddate-sysdate,0) days
  from gsp_med_manage_permit, tpl_pub_company
 where gsp_med_manage_permit.companyid = tpl_pub_company.companyid(+)

union all

--医疗执业机构许可证
select gsp_medorg_certify_permit.medorgid permitid,
       gsp_medorg_certify_permit.companyid,
       gsp_medorg_certify_permit.validondate,
       gsp_medorg_certify_permit.validenddate,
       gsp_medorg_certify_permit.usestatus,
       tpl_pub_company.companyname,
       tpl_pub_company.companyopcode,
       '医疗执业机构许可证' permitname,
        round(validenddate-sysdate,0) days
  from gsp_medorg_certify_permit, tpl_pub_company
 where gsp_medorg_certify_permit.companyid = tpl_pub_company.companyid(+)

union all

--医疗器械经营企业许可证
select gsp_appliance_manage_permit.applianceid permitid,
       gsp_appliance_manage_permit.companyid,
       gsp_appliance_manage_permit.validondate,
       gsp_appliance_manage_permit.validenddate,
       gsp_appliance_manage_permit.usestatus,
       tpl_pub_company.companyname,
       tpl_pub_company.companyopcode,
       '医疗器械经营企业许可证' permitname,
        round(validenddate-sysdate,0) days
  from gsp_appliance_manage_permit, tpl_pub_company
 where gsp_appliance_manage_permit.companyid = tpl_pub_company.companyid(+)

union all

--GSP/GMP证书
select gsp_gsmp_permit.gsmpid permitid,
       gsp_gsmp_permit.companyid,
       gsp_gsmp_permit.validondate,
       gsp_gsmp_permit.validenddate,
       gsp_gsmp_permit.usestatus,
       tpl_pub_company.companyname,
       tpl_pub_company.companyopcode,
       'GSP/GMP证书' permitname,
        round(validenddate-sysdate,0) days
  from gsp_gsmp_permit, tpl_pub_company
 where gsp_gsmp_permit.companyid = tpl_pub_company.companyid(+)

union all

--质量保证协议书
select gsp_quality_protocol.protocolid permitid,
       gsp_quality_protocol.companyid,
       gsp_quality_protocol.validondate,
       gsp_quality_protocol.validenddate,
       gsp_quality_protocol.usestatus,
       tpl_pub_company.companyname,
       tpl_pub_company.companyopcode,
       '质量保证协议书' permitname,
        round(validenddate-sysdate,0) days
  from gsp_quality_protocol, tpl_pub_company
 where gsp_quality_protocol.companyid = tpl_pub_company.companyid(+)

union all

--法人委托书
select gsp_corporation_consign.consignid permitid,
       gsp_corporation_consign.companyid,
       gsp_corporation_consign.validondate,
       gsp_corporation_consign.validenddate,
       gsp_corporation_consign.usestatus,
       tpl_pub_company.companyname,
       tpl_pub_company.companyopcode,
       '法人委托书' permitname,
        round(validenddate-sysdate,0) days
  from gsp_corporation_consign, tpl_pub_company
 where gsp_corporation_consign.companyid = tpl_pub_company.companyid(+)

union all

--麻痹经营批件
select gsp_drug_manage.drugid permitid,
       gsp_drug_manage.companyid,
       gsp_drug_manage.validondate,
       gsp_drug_manage.validenddate,
       gsp_drug_manage.usestatus,
       tpl_pub_company.companyname,
       tpl_pub_company.companyopcode,
       '麻痹经营批件' permitname,
        round(validenddate-sysdate,0) days
  from gsp_drug_manage, tpl_pub_company
 where gsp_drug_manage.companyid = tpl_pub_company.companyid(+)

union all

--组织机构代码证
select gsp_organise_code_permit.codeid permitid,
       gsp_organise_code_permit.companyid,
       gsp_organise_code_permit.validondate,
       gsp_organise_code_permit.validenddate,
       gsp_organise_code_permit.usestatus,
       tpl_pub_company.companyname,
       tpl_pub_company.companyopcode,
       '组织机构代码证' permitname,
        round(validenddate-sysdate,0) days
  from gsp_organise_code_permit, tpl_pub_company
 where gsp_organise_code_permit.companyid = tpl_pub_company.companyid(+)

union all

--卫生许可证
select gsp_healthy_permit.healthyid permitid,
       gsp_healthy_permit.companyid,
       gsp_healthy_permit.validondate,
       gsp_healthy_permit.validenddate,
       gsp_healthy_permit.usestatus,
       tpl_pub_company.companyname,
       tpl_pub_company.companyopcode,
       '卫生许可证' permitname,
        round(validenddate-sysdate,0) days
  from gsp_healthy_permit, tpl_pub_company
 where gsp_healthy_permit.companyid = tpl_pub_company.companyid(+)

union all

--药品生产企业许可证
select gsp_med_product_permit.permitid permitid,
       gsp_med_product_permit.companyid,
       gsp_med_product_permit.validondate,
       gsp_med_product_permit.validenddate,
       gsp_med_product_permit.usestatus,
       tpl_pub_company.companyname,
       tpl_pub_company.companyopcode,
       '药品生产企业许可证' permitname,
        round(validenddate-sysdate,0) days
  from gsp_med_product_permit, tpl_pub_company
 where gsp_med_product_permit.companyid = tpl_pub_company.companyid(+)

union all

--医疗器械生产许可证
select gsp_appliance_product_permit.appmitid permitid,
       gsp_appliance_product_permit.companyid,
       gsp_appliance_product_permit.validondate,
       gsp_appliance_product_permit.validenddate,
       gsp_appliance_product_permit.usestatus,
       tpl_pub_company.companyname,
       tpl_pub_company.companyopcode,
       '医疗器械生产许可证' permitname,
        round(validenddate-sysdate,0) days
  from gsp_appliance_product_permit, tpl_pub_company
 where gsp_appliance_product_permit.companyid = tpl_pub_company.companyid(+)
"
"GSP_PHYSIC_QUALITY_CHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_PHYSIC_QUALITY_CHECK_V"" (""CHECKID"", ""CHECKDOCNO"", ""CREDATE"", ""INPUTMANID"", ""OPERATIONTYPE"", ""QUCHECKID"", ""DEPTNAME"", ""CHECKDATE"", ""WAREHID"", ""GOODSOWNERID"", ""ARRIVEDATE"", ""GOODSID"", ""GOODSQTY"", ""QUALIFIEDQTY"", ""GOODSUNIT"", ""COMPANYID"", ""LOTID"", ""GOODSSTATUSID"", ""QUANSTATUS"", ""FACEQUALITY"", ""PACKQUALITY"", ""TRANSTEMP"", ""IMPORTREPFLAG"", ""PASSGATEFLAG"", ""REGISTEFLAG"", ""MEDCHECKFLAG"", ""ELIGIBILITYFLAG"", ""RPTNO"", ""BACKWHYID"", ""CHECKMANID1"", ""CHECKMAN1"", ""CHECKMANID2"", ""CHECKMAN2"", ""CHECKCONCLUSION"", ""DECISIONFLAG"", ""CONFIRMMANID"", ""CONFIRMDATE"", ""USESTATUS"", ""MEMO"", ""CHECKOPCODE"", ""CHECKNAME"", ""INPUTMANOPCODE"", ""INPUTMAN"", ""CONFIRMMANOPCODE"", ""CONFIRMMAN"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""GOODSOWNID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSENGNAME"", ""DRUGFORM"", ""GOODSPINYIN"", ""POISON_DRUG"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""COMPANYNAME"", ""COMPANYOPCODE"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""KILLLOTNO"", ""APPROVEDOCNO"", ""REGISTENO"", ""REGISTENO1"", ""REGISTNO"", ""EXPFLAG"", ""EXPDATE"", ""EXPFILENAME"", ""RECEIVEID"", ""LQCCHECK"", ""PASSGATENO"", ""PIJIANNO"", ""INID"", ""WAREHNAME"", ""OWNERGOODSID"", ""STORAGECONDITION"", ""TRADEPACKNAME"", ""SENDNO"", ""LPNCODE"", ""FACTNAME"", ""GOODSSTATUS"", ""JKHZFLAG"", ""VARIETYDESCID"", ""VARIETYNAME"", ""COPYRIGHT"", ""GCOMPANYNAME"", ""ZXCOLUMN4"", ""DTLZXCOLUMN4"", ""SHDATE"", ""QTY"", ""GOODSCLASS"", ""MAH"", ""PRINTEXPIREFLAG"", ""ECODEFLAG"", ""YJDFLAG"", ""PRODMONTHFLAG"", ""PRINTMONTHFLAG"", ""CHECK2DATE"", ""PRODLICENSENO"", ""DHDATE"", ""BACKDATE"", ""BACKWHY"") AS 
  select a.checkid,
       a.checkdocno,
       a.credate,
       a.inputmanid,
       a.operationtype,
       a.qucheckid,
       b.companyname deptname,
       j.checkdate, --取收货验收细单上的验收时间 xyue 2016-04-27
       a.warehid,
       a.goodsownerid,
       a.arrivedate,
       a.goodsid,
       a.goodsqty,
       decode(a.goodsstatusid, 1, a.goodsqty, 9, a.goodsqty, 0) qualifiedqty,
       a.goodsunit,
       a.companyid,
       a.lotid,
       a.goodsstatusid,
       a.quanstatus,
       a.facequality,
       a.packquality,
       a.transtemp,
       a.importrepflag,
       a.passgateflag,
       a.registeflag,
       a.medcheckflag,
       a.eligibilityflag,
       a.rptno,
       a.backwhyid,
       a.checkmanid1,
       q.employeename checkman1,
       a.checkmanid2,
       p.employeename checkman2,
       a.checkconclusion,
       --nvl(a.decisionflag,1) decisionflag,
       /*验收结论逻辑：质量状态1=入合格区，质量状态3（不合格）=入不合格区，质量状态2=入退货区*/
       decode(a.quanstatus, 1, 1, 2, 3, 3, 2, 4) decisionflag,
       a.confirmmanid,
       a.confirmdate,
       a.usestatus,
       --a.memo,
       j.checkmemo memo, -- 修改货品质量验收记录备注为收货验收细单上的备注，xyue 2013年12月3日 17:58:33
       b.companyopcode checkopcode,
       b.companyname checkname,
       c.opcode inputmanopcode,
       c.employeename inputman,
       d.opcode confirmmanopcode,
       d.employeename confirmman,
       e.goopcode,
       e.goodsownername,
       k.goodsownid,
       k.opcode goodsopcode,
       k.goodsname,
       k.goodsengname, --add by xyue 2018-07-25增加商品名字段
       k.drugform,
       f.goodspinyin,
       k.poison_drug,
       k.goodstype,
       k.prodarea,
       f.factid,
       g.companyname,
       g.opcode companyopcode,
       h.lotno,
       decode(to_char(h.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              h.validdate) validdate,
       h.proddate,
       h.killlotno,
       h.approvedocno,
       h.approvedocno registeno, --add by xyue 2018-04-17 宁德检查整改需求
       h.approvedocno registeno1, --add by xyue 2018-04-17 宁德检查整改需求
       a.registno,
       a.expflag,
       a.expdate,
       a.expfilename,
       a.receiveid,
       a.lqccheck,
       a.passgateno,
       a.pijianno,
       i.inid,
       o.warehname,
       a.ownergoodsid,
       k.storagecondition,
       k.tradepackname,
       a.sendno,
       a.lpncode,
       --l.companyname factname,
       h.factname factname, -- 修改货品质量验收记录的生产厂家取批号信息上的生产厂家，xyue 2014年1月6日 17:22:54
       m.goodsstatus,
       f.jkhzflag,
       k.varietydescid,
       k.varietyname,
       1 copyright,
       nvl(a.gcompanyname, g.companyname) gcompanyname, --add by weitangjing 20131104 货主原单位名称
       r.zxcolumn4, --ERP总单ID
       i.dtlzxcolumn4, --ERP细单ID
       i.shdate, --取收货管理的收货日期  by tl@180205
       i.qty, --取收货管理的收货数量  by tl@180228
       s.goodsclass, --add by xyue 2018-11-12 WMS货品分类
       h.mah, --add by xyue 2019-12-05 上市许可持有人
       h.printexpireflag, --add by llq 2020-12-31 打印失效期标志
       nvl(k.ecodeflag, 0) ecodeflag,
       (select nvl(max(tt.yjdflag), 0)
          from wms_goods_lot_yjdflag tt
         where tt.goodsownerid = a.goodsownerid
           and tt.lotid = a.lotid) yjdflag, --add by xyue 2022-01-12 药检单上传情况标志
       h.prodmonthflag, --add by xyue 2023-09-20 生产精确到月
       h.printmonthflag,--打印是否精确到月
       (case
         when a.checkmanid2 is not null then
          j.checkdate
         else
          null
       end) as check2date,
       k.prodlicenseno ,--生产许可证号 add by xyue 2024-06-20
       i.dhdate, --取收货管理到货时间tl@240702
       decode(a.operationtype,7,r.credate,42,r.credate,null) as backdate,--退货日期 销退和收配退业务类型 取入库订单制单日期
       zx_get_inorder_backwhy(a.goodsownerid,a.checkid) as backwhy --退货原因 add by xyue 2024-07-09 具体看函数说明
  from gsp_physic_quality_check a,
       pub_company              b,
       pub_employee             c,
       pub_employee             d,
       tpl_goodsowner           e,
       tpl_pub_goods            f,
       tpl_go_company           g,
       wms_goods_lot            h,
       tpl_warehouse            o,
       wms_in_order_dtl         i,
       wms_receive_dtl          j,
       tpl_goods                k,
       tpl_pub_company          l,
       wms_goodsstatus          m,
       pub_employee             q,
       pub_employee             p,
       wms_in_order             r, --add by 20161207 zyc 提取ERP总单ID
       wms_goods_feature        s --add by xyue 2018-11-12 增加wms货品分类
 where a.qucheckid = b.companyid(+)
   and a.inputmanid = c.employeeid(+)
   and a.confirmmanid = d.employeeid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.goodsid = f.goodsid(+)
   and a.companyid = g.companyid(+)
   and a.lotid = h.lotid(+)
   and a.receiveid = j.receiveid(+)
   and i.indtlid(+) = j.indtlid
   and a.warehid = o.warehid
   and a.ownergoodsid = k.ownergoodsid(+)
   and f.factid = l.companyid(+)
   and a.goodsstatusid = m.goodsstatusid(+)
   AND a.checkmanid1 = q.employeeid(+)
   AND a.checkmanid2 = p.employeeid(+)
   and i.inid = r.inid(+)
   and a.goodsid = s.goodsid(+)
   and a.warehid = s.warehid(+)
"
"GSP_QUALITY_FEEDBACK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_QUALITY_FEEDBACK_V"" (""FEEDBACKID"", ""WAREHID"", ""WAREHNAME"", ""WAREHOPCODE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSOWNID"", ""OWNERGOODSOPCODE"", ""OWNERGOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSQTY"", ""LOTID"", ""FROMCOMPANYID"", ""DEPTID"", ""INFOLEVEL"", ""GOODSSITUATION"", ""GROUPFEEDBACKMANID"", ""GROUPFEEDBACKDATE"", ""DEPTIDEA"", ""DEPTFEEDBACKMANID"", ""DEPTFEEDBACKDATE"", ""QUALITYDEPTIDEA"", ""RELATEDEPTIDEA"", ""RELATEDEPTMANID"", ""RELATEDEPTDATE"", ""DEALRESULT"", ""INPUTMANID"", ""CREDATE"", ""PRINTNO"", ""PRINTLINE"", ""FEEDBACKNO"", ""COMEFROM"", ""TRADEID"", ""INPUTMANNAME"", ""GROUPIDEA"") AS 
  select a.FEEDBACKID,
       a.warehid,--物流中心ID
       d.warehname,--物流中心名称
       d.warehopcode,--物流中心操作码
       a.goodsownerid,--货主ID
       e.goodsownername,--货主名称
       e.goopcode,--货主操作码
       b.waregoodsid goodsid,--xyue 2014-12-01 货品主档ID
       b.ownergoodsid,--货主货品ID
       b.goodsownid,
       b.opcode ownergoodsopcode,--货主货品操作码
       b.goodsname ownergoodsname,--货主货品名称
       b.goodstype,
       b.prodarea,
       c.lotno,
       c.proddate,
       c.validdate,
       a.GOODSQTY,
       a.LOTID,
       a.FROMCOMPANYID,
       a.DEPTID,
       a.INFOLEVEL,
       a.GOODSSITUATION,
       a.GROUPFEEDBACKMANID,
       a.GROUPFEEDBACKDATE,
       a.DEPTIDEA,
       a.DEPTFEEDBACKMANID,
       a.DEPTFEEDBACKDATE,
       a.QUALITYDEPTIDEA,
       a.RELATEDEPTIDEA,
       a.RELATEDEPTMANID,
       a.RELATEDEPTDATE,
       a.DEALRESULT,
       a.INPUTMANID,
       a.CREDATE,
       a.PRINTNO,
       a.PRINTLINE,
       a.FEEDBACKNO,
       a.comefrom,
       a.tradeid,
       f.employeename inputmanname,
       a.groupidea
  from gsp_quality_feedback a,
       tpl_goods            b,
       wms_goods_lot        c,
       tpl_warehouse        d,
       tpl_goodsowner       e,
       pub_employee         f
 where a.ownergoodsid = b.ownergoodsid
   and a.lotid = c.lotid(+)
   and a.warehid = d.warehid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.inputmanid = f.employeeid(+)
"
"GSP_QUALITY_PROTOCOL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_QUALITY_PROTOCOL_V"" (""PROTOCOLID"", ""COMPANYID"", ""COMPANYNAME"", ""VALIDONDATE"", ""VALIDENDDATE"", ""PICTURE"", ""FILEGROUPID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""USESTATUS"") AS 
  select a.protocolid,
         a.companyid,
         b.companyname,
         a.validondate,
         a.validenddate,
         a.picture,
         a.filegroupid,
         a.credate,
         a.inputmanid,
         c.employeename inputmanname,
         a.usestatus
    from gsp_quality_protocol a, tpl_pub_company b, pub_employee c
   where a.companyid = b.companyid
     and a.inputmanid = c.employeeid
"
"GSP_SABACK_CHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_SABACK_CHECK_V"" (""CHECKID"", ""CHECKTIME"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""DRUGFORM"", ""FACTID"", ""FACTNAME"", ""OWNERGOODSID"", ""TRADEPACKNAME"", ""STORAGECONDITION"", ""RECEIVEID"", ""COMPANYID"", ""COMPANYNAME"", ""BMSIOID"", ""GOODSQTY"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""BACKWHYID"", ""DECISIONFLAG"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""INPUTMANID"", ""INPUTMAN"", ""MEMO"", ""JKHZFLAG"", ""VARIETYDESCID"", ""GOODSOWNERID"", ""WAREHID"", ""GOODSOWNID"") AS 
  select a.checkid,
       a.checktime,
       a.goodsid,
       b.goodsname,
       b.goodstype,
      -- b.drugform,
      b.prodarea,
      tpl_drugform.drugform,
       b.factid,
       g.companyname factname,
       a.ownergoodsid,
       c.tradepackname,
       c.storagecondition,
       a.receiveid,
       a.companyid,
       d.companyname,
       a.bmsioid,
       a.goodsqty,
       a.lotid,
       e.lotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,
       e.proddate,
       e.approvedocno,
       e.registno,
       a.goodsstatusid,
       i.goodsstatus,
       i.quantitystatus,
       a.backwhyid,
       a.decisionflag,
       a.goodspackid,
       h.packname,
       h.packsize,
       a.inputmanid,
       f.employeename inputman,
       a.memo,
       b.jkhzflag,
       c.varietydescid,
       d.goodsownerid,
       a.warehid,
       c.goodsownid --货主原货品ID   by tl@180614
  from gsp_saback_check a,
       tpl_pub_goods    b,
       tpl_goods        c,
       tpl_go_company   d,
       wms_goods_lot    e,
       pub_employee     f,
       tpl_pub_company  g,
       tpl_pub_goods_packs h,
       wms_goodsstatus i,
       tpl_drugform
   where a.goodsid = b.goodsid(+)
         and a.ownergoodsid = c.ownergoodsid(+)
         and a.companyid = d.companyid(+)
         and a.lotid = e.lotid(+)
         and a.inputmanid = f.employeeid(+)
         and b.factid = g.companyid(+)
         and a.goodspackid = h.goodspackid(+)
         and a.goodsstatusid = i.goodsstatusid(+)
         and b.drugform=tpl_drugform.drugformno(+)
"
"GSP_ST_CHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_ST_CHECK_V"" (""STCHECKID"", ""CREDATE"", ""INPUTMANID"", ""GOODSID"", ""LOTID"", ""FROMCOMPANYID"", ""REPRESENTQTY"", ""CHECKTARGET"", ""CHECKQTY"", ""CHECKREASON"", ""CHECKCOMPANYID"", ""CHECKMANID"", ""MEMO"", ""INPUTMAN"", ""INPUTMANOPCODE"", ""CHECKMANOPCODE"", ""CHECKMAN"", ""OPCODE"", ""GOODSNAME"", ""GOODSFORMALNAME"", ""PRODAREA"", ""FACTID"", ""DRUGFORM"", ""GOODSTYPE"", ""FROMCOMPANYOPCODE"", ""FROMCOMPANYNAME"", ""CHECKCOMPANYOPCODE"", ""CHECKCOMPANYNAME"", ""COMPANYNAME"", ""GOODSOWNERID"", ""COMPANYOPCODE"", ""LOTNO"", ""VALIDDATE"", ""APPROVEDOCNO"", ""PRODDATE"") AS 
  select a.stcheckid,
       a.credate,
       a.inputmanid,
       a.goodsid,
       a.lotid,
       a.fromcompanyid,
       a.representqty,
       a.checktarget,
       a.checkqty,
       a.checkreason,
       a.checkcompanyid,
       a.checkmanid,
       a.memo,
       b.employeename inputman,
       b.opcode inputmanopcode,
       c.opcode checkmanopcode,
       c.employeename checkman,
       d.opcode,
       d.goodsname,
       d.goodsformalname,
       d.prodarea,
       d.factid,
       d.drugform,
       d.goodstype,
       e.companyopcode fromcompanyopcode,
       e.companyname fromcompanyname,
       f.companyopcode checkcompanyopcode,
       f.companyname  checkcompanyname,
       h.companyname,
       a.fromcompanyid goodsownerid,
       h.companyopcode,
       g.lotno,
       decode(to_char(g.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              g.validdate) validdate,
       g.approvedocno,
       g.proddate
  from Gsp_st_check    a,
       pub_employee    b,
       pub_employee    c,
       tpl_pub_goods   d,
       tpl_pub_company e,
       tpl_pub_company f,
       wms_goods_lot   g,
       tpl_pub_company h
 where a.inputmanid = b.employeeid(+)
   and a.goodsid = d.goodsid(+)
   and a.lotid = g.lotid(+)
   and a.fromcompanyid = e.companyid(+)
   and a.checkcompanyid = f.companyid(+)
   and a.checkmanid = c.employeeid(+)
   and d.factid = h.companyid(+)
"
"GSP_ST_HUM_TEM_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_ST_HUM_TEM_V"" (""HUMTEMID"", ""AREAID"", ""AREANO"", ""AREANAME"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANOPCODE"", ""INPUTMAN"", ""AMNTEMP"", ""AMNHUM"", ""AMTEMP"", ""AMHUM"", ""PMNTEMP"", ""PMNHUM"", ""PMTEMP"", ""PMHUM"", ""AMMETHOD"", ""PMMETHOD"", ""AMTEMP1"", ""AMHUM1"", ""PMTEMP1"", ""PMHUM1"", ""MEMO"") AS 
  select a.humtemid,
       a.areaid,
       b.areano,
       b.areaname,
       a.credate,
       a.inputmanid,
       c.opcode inputmanopcode,
       c.employeename inputman,
       a.amntemp,
       a.amnhum,
       a.amtemp,
       a.amhum,
       a.pmntemp,
       a.pmnhum,
       a.pmtemp,
       a.pmhum,
       a.ammethod,
       a.pmmethod,
       a.amtemp1,
       a.amhum1,
       a.pmtemp1,
       a.pmhum1,
       a.memo
  from gsp_st_hum_tem a,
  wms_st_area_def           b,
  pub_employee              c
  where a.inputmanid = c.employeeid(+)
   and a.areaid = b.areaid(+)

 "
"GSP_ST_IO_RECORD_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_ST_IO_RECORD_V"" (""INOUTID"", ""CREDATE"", ""INPUTMANID"", ""INPUTCODE"", ""INPUTNAME"", ""CHECKMANID"", ""CHECKMANOPCODE"", ""CHECKMANNAME"", ""GOODSOWNERID"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""COMEFROM"", ""OPERATIONTYPE"", ""COMPANYID"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""GOODSID"", ""OPCODE"", ""GOODSTYPE"", ""GOODSNAME"", ""PRODAREA"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""POSID"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""GOODSQTY"", ""KEEPDATE"", ""KEEPMANID"", ""KEEPMANOPCODE"", ""KEEPMANNAME"", ""MEMO"", ""POSNO"", ""POSNAME"", ""AREANO"", ""AREANAME"", ""SECTIONNO"", ""SECTIONNAME"", ""AREAID"", ""SECTIONID"", ""CHECKMAN2ID"", ""CHECKMAN2OPCODE"", ""CHECKMAN2NAME"", ""FACTNAME"", ""OWNERGOODSID"", ""TRADEPACKNAME"", ""DRUGFORM"", ""STORAGECONDITION"", ""WAREHID"", ""GCOMPANYNAME"", ""GOODSOWNID"", ""GOODSCLASS"", ""MAH"", ""ECODEFLAG"", ""SOURCEID"", ""IWCS_FLAG"", ""CHECK2DATE"") AS 
  select a.inoutid,
       a.credate,
       a.inputmanid,
       c.opcode inputcode,
       c.employeename inputname,
       a.checkmanid,
       d.opcode checkmanopcode,
       d.employeename checkmanname,
       a.goodsownerid,
       e.goopcode,
       e.goodsownername,
       a.comefrom,
       a.operationtype,
       a.companyid,
       f.opcode companyopcode,
       f.companyname,
       a.goodsid,
       n.opcode,
       n.goodstype,
       n.goodsname,
       n.prodarea,
       a.batchno,
       a.lotid,
       i.lotno,
       decode(to_char(i.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              i.validdate) validdate,
       i.proddate,
       i.approvedocno,
       a.goodspackid,
       j.packname,
       j.packsize,
       a.posid,
       a.goodsstatusid,
       g.goodsstatus,
       g.quantitystatus,
       a.goodsqty,
       a.keepdate,
       a.keepmanid,
       k.opcode keepmanopcode,
       k.employeename keepmanname,
       a.memo,
       b.posno,
       b.posname,
       b.areano,
       b.areaname,
       b.sectionno,
       b.sectionname,
       b.areaid,
       b.sectionid,
       a.checkman2id,
       l.opcode checkman2opcode,
       l.employeename checkman2name,
       i.factname factname, --修改货品出库复核记录的生产厂家取批号信息上的生产厂家，xyue 2014年1月6日 17:22:54
       a.ownergoodsid,
       n.tradepackname,
       n.drugform,
       n.storagecondition,
       a.warehid,
       a.gcompanyname, --add by weitangjing 20131104 原货主单位名称
       n.goodsownid, -- add by tl  180206 货主原货品ID
       o.goodsclass,
       i.mah, --add by xyue 2019-08-22 上市许可持有人
       nvl(n.ecodeflag,0) ecodeflag, --add by xyue 2022-08-29 电子监管码标志
       (select t.sourceid from wms_st_io_doc t where t.inoutid=a.inoutid and t.comefrom in (2,3)) sourceid,
       nvl(b.iwcs_flag,0) iwcs_flag,
       a.check2date --第二复核时间
  from Gsp_st_io_record a,
       wms_pos_def_v b,
       pub_employee c,
       pub_employee d,
       tpl_goodsowner e,
       tpl_go_company f,
       wms_goodsstatus g,
       tpl_pub_goods h,
       tpl_pub_company m,
       wms_goods_lot i,
       tpl_pub_goods_packs j,
       pub_employee k,
       pub_employee l,
       tpl_goods n,
       tpl_drugform,
       wms_goods_feature o
 where a.posid = b.posid(+)
   and a.inputmanid = c.employeeid(+)
   and a.checkmanid = d.employeeid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.companyid = f.companyid(+)
   and a.goodsid = h.goodsid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.lotid = i.lotid(+)
   and a.goodspackid = j.goodspackid(+)
   and a.keepmanid = k.employeeid(+)
   and a.checkman2id = l.employeeid(+)
   and h.factid = m.companyid(+)
   and a.ownergoodsid = n.ownergoodsid(+)
   and h.drugform = tpl_drugform.drugformno(+)
   and a.warehid = o.warehid(+)
   and a.goodsid = o.goodsid(+)
"
"GSP_TAX_REGISTRATION_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_TAX_REGISTRATION_V"" (""SEQID"", ""COMPANYID"", ""TAXNO"", ""VALIDONDATE"", ""VALIDENDDATE"", ""INPUTMANID"", ""CREDATE"", ""COMPANYNAME"", ""EMPLOYEENAME"", ""USESTATUS"") AS 
  select
       a.seqid,
       a.companyid,
       a.taxno,
       a.validondate,
       a.validenddate,
       a.inputmanid,
       a.credate,
       b.companyname,
       c.employeename,
       a.usestatus
from
     gsp_tax_registration a,
     tpl_pub_company          b,
     pub_employee         c
where
     a.companyid = b.companyid(+)
 and a.inputmanid = c.employeeid(+)
"
"GSP_WARE_COMPANY_LICENSE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_WARE_COMPANY_LICENSE_V"" (""LICENSEID"", ""LICENSETYPEID"", ""LICENSECODE"", ""SIGNCOMPANY"", ""SIGNDATE"", ""STARTDATE"", ""ENDVALIDATE"", ""CONTEXT"", ""JOBSTATUS"", ""STOPFLAG"", ""MEMO"", ""LICENSETYPENAME"", ""BUSCOPEFLAG"", ""FORMULAFLAG"", ""VALIDATEFLAG"", ""GOODSCTRLFLAG"", ""CUSOTOMERFLAG"", ""SUPPLYERFLAG"", ""TREATCTRLFLAG"", ""VENDORFLAG"", ""CUSTOMERSORT"", ""SUPPLYERSORT"", ""VENDORSORT"", ""CREMANID"", ""CREDATE"", ""CREMANNAME"", ""ENTRUSTMANID"", ""ENTRUSTMANNAME"", ""COMPANYTYPE"", ""COMPANYID"", ""GOODSOWNERID"", ""QA_APPROVEMANID"", ""QA_APPROVEMAN"", ""QA_APPROVEMEMO"", ""QA_APPROVEDATE"", ""QA_APPROVEFLAG"", ""QD_APPROVEMANID"", ""QD_APPROVEMAN"", ""QD_APPROVEMEMO"", ""QD_APPROVEDATE"", ""QD_APPROVEFLAG"") AS 
  select a.licenseid,
       a.licensetypeid,
       a.licensecode,
       a.signcompany,
       a.signdate,
       a.startdate,
       a.endvalidate,
       a.context,
       a.jobstatus,
       a.stopflag,
       a.memo,
       b.licensetypename,
       b.buscopeflag,
       b.formulaflag,
       b.validateflag,
       b.goodsctrlflag,
       b.cusotomerflag,
       b.supplyerflag,
       b.treatctrlflag,
       b.vendorflag,
       b.customersort,
       b.supplyersort,
       b.vendorsort,
       a.cremanid,
       a.credate,
       c.employeename as cremanname,
       a.entrustmanid,
       e.employeename entrustmanname,
       a.companytype,
       a.companyid,
       a.goodsownerid,
       a.qa_approvemanid,
       f.employeename qa_approveman,
       a.qa_approvememo,
       a.qa_approvedate,
       a.qa_approveflag,
       a.qd_approvemanid,
       g.employeename qd_approveman,
       a.qd_approvememo,
       a.qd_approvedate,
       a.qd_approveflag
  from gsp_ware_company_license a,
       gsp_ware_license_type    b,
       pub_employee             c,
       pub_employee             e,
       pub_employee             f,
       pub_employee             g
  where a.licensetypeid=b.licensetypeid
    and a.cremanid=c.employeeid(+)
    and a.entrustmanid=e.employeeid(+)
    and a.qa_approvemanid = f.employeeid(+)
    and a.qd_approvemanid = g.employeeid(+)
"
"GSP_WARE_LICENSE_TYPE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GSP_WARE_LICENSE_TYPE_V"" (""LICENSETYPEID"", ""LICENSETYPENAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CUSOTOMERFLAG"", ""CUSTOMERSORT"", ""SUPPLYERFLAG"", ""SUPPLYERSORT"", ""VENDORFLAG"", ""VENDORSORT"", ""GOODSFLAG"", ""GOODSSORT"", ""BUSCOPEFLAG"", ""FORMULAFLAG"", ""VALIDATEFLAG"", ""CREDATE"", ""CREMANID"", ""CREMANAME"", ""GOODSCTRLFLAG"", ""PUBFLAG"", ""TREATCTRLFLAG"", ""WARNDAYS"") AS 
  select a.licensetypeid,
       a.licensetypename,
       '' goodsownerid,
       '' goodsownername,
       a.cusotomerflag,
       a.customersort,
       a.supplyerflag,
       a.supplyersort,
       a.vendorflag,
       a.vendorsort,
       a.goodsflag,
       a.goodssort,
       a.buscopeflag,
       a.formulaflag,
       a.validateflag,
       a.credate,
       a.cremanid,
       c.employeename cremaname,
       a.goodsctrlflag,
       a.pubflag,
       a.treatctrlflag,
       a.warndays
  from gsp_ware_license_type a,
       pub_employee          c
 where a.cremanid=c.employeeid(+)
"
"GS_EXPORT_FEEDBACK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GS_EXPORT_FEEDBACK_V"" (""OUTID"", ""OUTDTLID"", ""INOUTID"", ""PACKNAME"", ""PACKSIZE"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSQTY"", ""GOODSSTATUS"", ""GOODSNAME"", ""EXPDTLMEMO"", ""GOODSID"", ""GOODSPACKID"", ""LOTID"", ""MEMO"", ""USESTATUS"", ""EXPORDERID"") AS 
  SELECT a.outid,
         a.outdtlid,
         b.inoutid,
         e.packname,
         e.packsize,
         a.lotno,
         decode(to_char(a.validdate, 'yyyy-mm-dd'),
                '2099-01-01',
                to_date(null, 'yyyy-mm-dd'),
                a.validdate) validdate,
         a.proddate,
         a.goodsqty,
         d.goodsstatus,
         c.goodsname,
         a.expdtlmemo,
         a.goodsid,
         a.goodspackid,
         a.lotid,
         b.memo,
         b.usestatus,
         g.exporderid
    FROM tpl_out_order_dtl a,
         tpl_st_io_doc b,
         tpl_pub_goods c,
         wms_goodsstatus d,
         tpl_pub_goods_packs e,
         tpl_export_order_dtl g
    WHERE a.outid = b.orderid
    AND b.inoutflag = 1
    AND a.goodsstatusid = d.goodsstatusid
    AND a.goodsid = c.goodsid
    AND a.goodspackid = e.goodspackid
    AND a.olddtlid = g.exporderdtlid
"
"GS_PORDER_FEEDBACK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""GS_PORDER_FEEDBACK_V"" (""INID"", ""INDTLID"", ""INOUTID"", ""PACKNAME"", ""PACKSIZE"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSQTY"", ""GOODSSTATUS"", ""GOODSNAME"", ""EXPDTLMEMO"", ""GOODSID"", ""GOODSPACKID"", ""LOTID"", ""MEMO"", ""PORDERSTATUS"", ""PORDERDTLID"") AS 
  SELECT a.inid,
         a.indtlid,
         b.inoutid,
         e.packname,
         e.packsize,
         a.lotno,
         decode(to_char(a.validdate, 'yyyy-mm-dd'),
                '2099-01-01',
                to_date(null, 'yyyy-mm-dd'),
                a.validdate) validdate,
         a.proddate,
         a.goodsqty,
         d.goodsstatus,
         c.goodsname,
         a.expdtlmemo,
         a.goodsid,
         a.goodspackid,
         a.lotid,
         b.memo,
         a.porderstatus,
         g.porderdtlid
    FROM tpl_in_order_dtl a,
         tpl_st_io_doc b,
         tpl_pub_goods c,
         wms_goodsstatus d,
         tpl_pub_goods_packs e,
         tpl_purchase_order_dtl g
    WHERE a.inid = b.orderid
    AND a.indtlid = b.orderdtlid
    AND b.inoutflag = 0
    AND a.goodsstatusid = d.goodsstatusid
    AND a.goodsid = c.goodsid
    AND a.goodspackid = e.goodspackid
    AND a.olddtlid = g.porderdtlid
"
"HD_WMS_SECTION_TASK_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""HD_WMS_SECTION_TASK_LST_V"" (""AREAID"", ""AREANAME"", ""SECTIONID"", ""SECTIONNAME"", ""SORTTYPE"", ""TASKTYPE"", ""TASKSUM"", ""TASKDONESUM"", ""DOINGSUM"", ""DONEPACKS"", ""DOINGPACKS"", ""DONEQTY"", ""DOINGQTY"") AS 
  select a.areaid, --分区名称、业务类型、总上架任务数、已上架任务数、已上架件数、已上架散件数（即订单明细数）、
       a.areaname, --待上架任务数、待上架件数、待上架散件数、分区ID
       a.sectionid, --类型（进货、波次补货、安全补货、其他库内业务）
       a.sectionname,
       a.sorttype,
       '进货' tasktype, --类型
       (select count(distinct(b.taskid))
          from wms_st_io_doc b
         where b.sectionid = a.sectionid
           and b.comefrom = 1
           and b.inoutflag = 0) tasksum, --总上架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b
         where b.sectionid = a.sectionid
           and b.comefrom = 1
           and b.rfflag = 3
           and b.inoutflag = 0) taskdonesum, --已上架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b
         where b.sectionid = a.sectionid
           and b.comefrom = 1
           and b.rfflag = 2
           and b.inoutflag = 0) doingsum, --待上架任务数
       nvl((select count(distinct(b.taskid))--sum(nvl(b.wholeqty, 0))
             from wms_st_io_doc b
            where b.sectionid = a.sectionid
              and b.comefrom = 1
              and b.rfflag = 3
              and b.wholeqty > 0
              and b.inoutflag = 0),
           0) donepacks, --已上架件数
       nvl((select count(distinct(b.taskid))--sum(nvl(b.wholeqty, 0))
             from wms_st_io_doc b
            where b.sectionid = a.sectionid
              and b.comefrom = 1
              and b.rfflag = 2
              and b.wholeqty > 0
              and b.inoutflag = 0),
           0) doingpacks, --待上架件数
       nvl((select count(distinct(b.taskid))--sum(nvl(b.scatterqty, 0))
             from wms_st_io_doc b
            where b.sectionid = a.sectionid
              and b.comefrom = 1
              and b.rfflag = 3
              and b.scatterqty > 0
              and b.inoutflag = 0),
           0) doneqty, --已上架散件数
       nvl((select count(distinct(b.taskid))--sum(nvl(b.scatterqty, 0))
             from wms_st_io_doc b
            where b.sectionid = a.sectionid
              and b.comefrom = 1
              and b.rfflag = 2
              and b.scatterqty  > 0
              and b.inoutflag = 0),
           0) doingqty --待上架散件数
  from wms_st_section_def_v a
union
select a.areaid,
       a.areaname,
       a.sectionid,
       a.sectionname,
       a.sorttype,
       '波次补货' tasktype, --类型
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and c.operationtype = 29 --29补货 subtype = 1波次补货
           and c.subtype = 1
           and b.inoutflag = 0) tasksum, --总上架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.rfflag = 3
           and c.operationtype = 29 --补货
           and c.subtype = 1
           and b.inoutflag = 0) taskdonesum, --已上架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.rfflag = 2
           and c.operationtype = 29 --补货
           and c.subtype = 1
           and b.inoutflag = 0) doingnum, --待上架任务数
       nvl((select count(distinct(b.taskid))--sum(b.wholeqty)
             from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
            where b.sectionid = a.sectionid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.rfflag = 3
              and b.wholeqty> 0
              and c.operationtype = 29 --补货
              and c.subtype = 1
              and b.inoutflag = 0),
           0) donepacks, --已上架件数
       nvl((select count(distinct(b.taskid))--sum(b.wholeqty)
             from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
            where b.sectionid = a.sectionid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.rfflag = 2
              and b.wholeqty > 0
              and c.operationtype = 29 --补货
              and c.subtype = 1
              and b.inoutflag = 0),
           0) doingpacks, --待上架件数
       0 doneqty, --已上架散件数
       0 doingqty --待上架散件数
  from wms_st_section_def_v a
union
select a.areaid,
       a.areaname,
       a.sectionid,
       a.sectionname,
       a.sorttype,
       '闲时补货' tasktype, --类型
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and c.operationtype = 29 --29补货 subtype = 3安全补货
           and c.subtype = 3
           and b.inoutflag = 0) tasksum, --总上架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.rfflag = 3
           and c.operationtype = 29 --补货
           and c.subtype = 3
           and b.inoutflag = 0) taskdonesum, --已上架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.rfflag = 2
           and c.operationtype = 29 --补货
           and c.subtype = 3
           and b.inoutflag = 0) doingnum, --待上架任务数
       nvl((select count(distinct(b.taskid))--sum(b.wholeqty)
             from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
            where b.sectionid = a.sectionid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.rfflag = 3
              and b.wholeqty > 0
              and c.operationtype = 29 --补货
              and c.subtype = 3
              and b.inoutflag = 0),
           0) donepacks, --已上架件数
       nvl((select count(distinct(b.taskid))--sum(b.wholeqty)
             from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
            where b.sectionid = a.sectionid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.rfflag = 2
              and b.wholeqty > 0
              and c.operationtype = 29 --补货
              and c.subtype = 3
              and b.inoutflag = 0),
           0) doingpacks, --待上架件数
       0 doneqty, --已上架散件数
       0 doingqty --待上架散件数*/
  from wms_st_section_def_v a
union
select a.areaid,
       a.areaname,
       a.sectionid,
       a.sectionname,
       a.sorttype,
       '其他库内业务' tasktype, --类型
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.inoutflag = 0
           and ((c.operationtype = 29 --29补货
               and c.subtype not in (1, 3)) or c.operationtype <> 29)) tasksum, --总上架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.inoutflag = 0
           and b.rfflag = 3
           and ((c.operationtype = 29 --29补货
               and c.subtype not in (1, 3)) or c.operationtype <> 29)) taskdonesum, --已上架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.inoutflag = 0
           and b.rfflag = 2
           and ((c.operationtype = 29 --29补货
               and c.subtype not in (1, 3)) or c.operationtype <> 29)) doingnum, --待上架任务数
       nvl((select count(distinct(b.taskid))--sum(b.wholeqty)
             from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
            where b.sectionid = a.sectionid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.inoutflag = 0
              and b.wholeqty > 0
              and b.rfflag = 3
              and ((c.operationtype = 29 --29补货
                  and c.subtype not in (1, 3)) or c.operationtype <> 29)),
           0) donepacks, --已上架件数
       nvl((select count(distinct(b.taskid))--sum(b.wholeqty)
             from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
            where b.sectionid = a.sectionid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.inoutflag = 0
              and b.wholeqty > 0
              and b.rfflag = 2
              and ((c.operationtype = 29 --29补货
                  and c.subtype not in (1, 3)) or c.operationtype <> 29)),
           0) doingpacks, --待上架件数
       nvl((select count(distinct(b.taskid))--sum(b.scatterqty)
             from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
            where b.sectionid = a.sectionid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.inoutflag = 0
              and b.scatterqty > 0
              and b.rfflag = 3
              and ((c.operationtype = 29 --29补货
                  and c.subtype not in (1, 3)) or c.operationtype <> 29)),
           0) doneqty, --已上架散件数
       nvl((select count(distinct(b.taskid))--sum(b.scatterqty)
             from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
            where b.sectionid = a.sectionid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.inoutflag = 0
              and b.scatterqty > 0
              and b.rfflag = 2
              and ((c.operationtype = 29 --29补货
                  and c.subtype not in (1, 3)) or c.operationtype <> 29)),
           0) doingqty --待上架散件数*/
  from wms_st_section_def_v a
"
"HEFU_WMS2SAP_INORDERDTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""HEFU_WMS2SAP_INORDERDTL_V"" (""ORDERDATE"", ""ORDERID"", ""ORDERDTLID"", ""INID"", ""INDTLID"", ""USESTATUS"", ""PORDERSTATUS"", ""MEMO"", ""OWNERGOODSID"", ""WAREGOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""DRUGFORM"", ""FACTNAME"", ""MAH"", ""APPROVEDOCNO"", ""PRODLICENSENO"", ""GOODSQTY"", ""QTY"", ""CLFLAG"", ""SHDATE"", ""SHRID"", ""SHRMAN"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""UUID"") AS 
  select a.credate as orderdate,
       a.zxcolumn4 as orderid,
       b.dtlzxcolumn4 as orderdtlid,
       a.inid,
       b.indtlid,
       a.usestatus,
       b.porderstatus,
       a.memo,
       b.ownergoodsid,
       c.waregoodsid,
       c.goodsownid,
       c.goodsname,
       c.goodsengname,
       c.goodstype,
       c.tradepackname,
       c.drugform,
       nvl(b.factname,c.factname) as factname,
       nvl(b.mah,c.mah) as mah,
       nvl(b.approvedocno,c.approvedocno) as approvedocno,
       c.prodlicenseno,
       b.goodsqty,
       b.qty,
       b.clflag,
       b.shdate,
       b.shrid,
       d.employeename as shrman,
       b.lotno,
       b.proddate,
       b.validdate,
       t.uuid
  from hefu_wms2sap_inorder t,wms_in_order a, wms_in_order_dtl b,tpl_goods c,pub_employee d
 where t.orderid = a.zxcolumn4
   and t.warehid = a.warehid
   and t.goodsownerid = a.goodsownerid
   and t.operationtype = a.operationtype
   and a.inid = b.inid
   and a.usestatus <> 0
   and a.goodsownerid = 9126
   and b.ownergoodsid=c.ownergoodsid
   and b.shrid = d.employeeid(+)
"
"HEFU_WMS2SAP_INORDERDTL_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""HEFU_WMS2SAP_INORDERDTL_V1"" (""UUID"", ""POSNR"", ""MATNR"", ""LICHN"", ""VRKME"", ""LFIMG"", ""HSDAT"", ""VFDAT"") AS 
  select t.uuid,
       b.dtlzxcolumn4 as posnr,
       d.goodsownid as matnr,
       e.lotno as lichn,
       d.tradepackname as vrkme,
       c.goodsqty as lfimg,
       to_char(e.proddate, 'yyyy-mm-dd') as hsdat,
       to_char(e.validdate, 'yyyy-mm-dd') as vfdat
  from hefu_wms2sap_inorder t,
       wms_in_order         a,
       wms_in_order_dtl     b,
       wms_receive_dtl      c,
       tpl_goods            d,
       wms_goods_lot        e
 where t.orderid = a.zxcolumn4
   and t.warehid = a.warehid
   and t.goodsownerid = a.goodsownerid
   and t.operationtype = a.operationtype
   and a.inid = b.inid
   and b.indtlid = c.indtlid
   and a.usestatus <> 0
   and a.goodsownerid = 9126
   and c.ownergoodsid = d.ownergoodsid
   and c.lotid = e.lotid(+)
   and a.usestatus = 3
"
"HEFU_WMS2SAP_INORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""HEFU_WMS2SAP_INORDER_V"" (""UUID"", ""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""ORDERID"", ""OPERATIONTYPE"", ""SOURCECOMPANYID"", ""COMPANYID"", ""COMPANYNAME"", ""USESTATUS"", ""FINISHDATE"", ""EXECFLAG"", ""EXECDATE"", ""EXECMSG"") AS 
  select t.uuid,
       t.credate,
       t.warehid,
       t.warehname,
       t.goodsownerid,
       t.goodsownername,
       t.orderid,
       t.operationtype,
       t.sourcecompanyid,
       t.companyid,
       t.companyname,
       t.usestatus,
       t.finishdate,
       t.execflag,
       t.execdate,
       t.execmsg
  from hefu_wms2sap_inorder t
"
"HEFU_WMS2SAP_OUTORDERDTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""HEFU_WMS2SAP_OUTORDERDTL_V"" (""UUID"", ""OUTID"", ""OUTDTLID"", ""ORDERDTLID"", ""OWNERGOODSID"", ""WAREGOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""DRUGFORM"", ""FACTNAME"", ""MAH"", ""APPROVEDOCNO"", ""PRODLICENSENO"", ""GOODSQTY"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"") AS 
  select t.uuid,
       a.outid,
       b.outdtlid,
       b.dtlzxcolumn4 as orderdtlid,
       b.ownergoodsid,
       c.waregoodsid,
       c.goodsownid,
       c.goodsname,
       c.goodsengname,
       c.goodstype,
       c.tradepackname,
       c.drugform,
       nvl(d.factname, c.factname) as factname,
       nvl(d.mah, c.mah) as mah,
       nvl(d.approvedocno, c.approvedocno) as approvedocno,
       c.prodlicenseno,
       b.goodsqty,
       d.lotno,
       d.proddate,
       d.validdate
  from hefu_wms2sap_outorder t,
       wms_out_order         a,
       wms_out_order_dtl     b,
       tpl_goods             c,
       wms_goods_lot         d
 where t.outid = a.outid
   and a.outid = b.outid
   and b.ownergoodsid = c.ownergoodsid
   and b.lotid = d.lotid(+)
"
"HEFU_WMS2SAP_OUTORDERDTL_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""HEFU_WMS2SAP_OUTORDERDTL_V1"" (""UUID"", ""POSNR"", ""MATNR"", ""LICHN"", ""VRKME"", ""LFIMG"", ""HSDAT"", ""VFDAT"") AS 
  select t.uuid,
       b.dtlzxcolumn4 as posnr,
       c.goodsownid as matnr,
       d.lotno as lichn,
       c.tradepackname as vrkme,
       b.goodsqty as lfimg,
       to_char(d.proddate, 'yyyy-mm-dd') as hsdat,
       to_char(d.validdate, 'yyyy-mm-dd') as vfdat
  from hefu_wms2sap_outorder t,
       wms_out_order         a,
       wms_out_order_dtl     b,
       tpl_goods             c,
       wms_goods_lot         d
 where t.outid = a.outid
   and a.outid = b.outid
   and b.ownergoodsid = c.ownergoodsid
   and b.lotid = d.lotid(+)
"
"HEFU_WMS2SAP_OUTORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""HEFU_WMS2SAP_OUTORDER_V"" (""UUID"", ""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""ORDERID"", ""OPERATIONTYPE"", ""MEMO"", ""OUTID"", ""RECCOMPANYID"", ""COMPANYID"", ""COMPANYNAME"", ""EXECFLAG"", ""EXECDATE"", ""EXECMSG"", ""WAVEDTLID"") AS 
  select t.uuid,
       t.credate,
       t.warehid,
       t.warehname,
       t.goodsownerid,
       t.goodsownername,
       t.orderid,
       t.operationtype,
       t.memo,
       t.outid,
       t.reccompanyid,
       t.companyid,
       t.companyname,
       t.execflag,
       t.execdate,
       t.execmsg,
       t.wavedtlid
  from hefu_wms2sap_outorder t
"
"HIS_HOSPITAL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""HIS_HOSPITAL_V"" (""SEQID"", ""HOSPITALID"", ""COMPANYNAME"", ""COMPANYOPCODE"", ""COMPANYSHORTNAME"", ""SUPPLYER"", ""SUPPLYER_NAME"", ""SUPPLYER_LOOKUP"", ""GSTORAGEID"", ""GOSTOCKNAME"") AS 
  select a.seqid,
       a.HOSPITALID,
       b.companyname,
       b.companyopcode,
       b.companyshortname,
       a.SUPPLYER,
       a.SUPPLYER_NAME,
       a.SUPPLYER_LOOKUP,
       a.gstorageid,
       c.Gostockname
  from his_hospital a,
       tpl_pub_company b,
       TPL_OWNER_STORAGE_DEF c
  where a.hospitalid=b.companyid(+)
        and a.gstorageid = c.gstorageid(+)
"
"HIS_PDAOUT_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""HIS_PDAOUT_DOC_V"" (""COMPANYID"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""HEADFLAG"", ""FILETYPE"", ""FILEPATH"") AS 
  select a.companyid,
  b.companyopcode,
  b.companyname,
  a.headflag,
  a.filetype,
  a.filepath
  from his_pdaout_doc a, tpl_pub_company b
 where a.companyid = b.companyid
"
"HIS_PURCHASEPLAN_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""HIS_PURCHASEPLAN_DTL_V"" (""LSTID"", ""LSTDTLID"", ""GOODSQTY"", ""TOTALLINE"", ""GOODSPRICE"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""DOCNO"", ""DRUGNAME"", ""SPECIFICATION"", ""ABBR_NAME"", ""UNIT_NAME"", ""SERIAL"", ""MANUFACTORY"", ""MANUFACTURE"", ""IN_TYPE"", ""CHARGE_CODE"", ""GROUP_NO"", ""DEPT_NAME"", ""HOSRATE"", ""RATE"", ""MEMO"") AS 
  select a.lstid,
       a.lstdtlid,
       a.goodsqty,
       a.totalline,
       a.goodsprice,
       a.goodsid,
       b.goodsname,
       b.goodstype,
       b.prodarea,
       c.companyname factname,
       a.docno,
       a.drugname,
       a.specification,
       a.abbr_name,
       a.unit_name,
       a.serial,
       a.manufactory,
       a.manufacture,
       a.in_type,
       a.charge_code,
       a.group_no,
       a.dept_name,
       a.hosrate,
       a.rate,
       a.memo
  from his_purchaseplan_dtl a, tpl_pub_goods b, tpl_pub_company c
 where a.goodsid = b.goodsid(+)
   and b.factid = c.companyid(+)
"
"HIS_RECIEVE_TMP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""HIS_RECIEVE_TMP_V"" (""CHOOSEFLAG"", ""INOUTID"", ""BARCODE"", ""COMPANYID"", ""COMPANYNAME"", ""DIFREASON"", ""RECTIME"", ""RECMANID"", ""RECMANNAME"", ""RFNO"", ""GOODSID"", ""GOODSNAME"", ""PRODAREA"", ""GOODSTYPE"", ""GOODSQTY"", ""RECQTY"", ""TRADEGOODSPACK"", ""PACKSIZE"", ""VALIDDATE"", ""APPROVENO"", ""LOTNO"", ""GOODSBARCODE"", ""FLAG"", ""WAREHID"", ""WAREHNAME"") AS 
  select 1 chooseflag,
       a.inoutid,
       a.barcode,
       a.companyid,
       c.companyname,
       a.difreason,
       a.rectime,
       a.recmanid,
       d.employeename recmanname,
       a.rfno,
       a.goodsid,
       a.goodsname,
       a.prodarea,
       a.goodstype,
       a.goodsqty,
       a.recqty,
       a.tradegoodspack,
       a.packsize,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.approveno,
       a.lotno,
       a.goodsbarcode,
       a.flag,
       a.warehid,
       g.warehname
  from his_recieve_tmp  a,
       tpl_go_company      c,
       pub_employee        d,
       tpl_warehouse g
 where a.companyid = c.companyid(+)
   and a.recmanid = d.employeeid(+)
   and a.warehid = g.warehid(+)
"
"IMP_WMS_STQTY_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""IMP_WMS_STQTY_DOC_V"" (""DOCID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""USESTATUS"", ""MEMO"") AS 
  select a.DOCID,
       a.CREDATE,
       a.INPUTMANID,
       b.employeename inputmanname,
       a.WAREHID,
       c.warehname,
       a.GOODSOWNERID,
       d.goodsownername,
       d.goopcode,
       a.USESTATUS,
       a.MEMO
  from imp_wms_stqty_doc a,
       pub_employee      b,
       tpl_warehouse     c,
       tpl_goodsowner    d
 where a.inputmanid = b.employeeid(+)
   and a.warehid = c.warehid
   and a.goodsownerid = d.goodsownerid(+)
"
"INF_G_OUT_T400_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INF_G_OUT_T400_V"" (""GOODSOWNERID"", ""TRADEID"", ""TRADEDATE"", ""OPERATIONTYPE"", ""DTLLINES"", ""USESTATUS"", ""TRADEDTLID"", ""OWNERGOODSID"", ""FROMGOODSTATUS"", ""FROMQUANSTATUS"", ""FROMBATCHNO"", ""FROMLOTNO"", ""FROMPRODDATE"", ""FROMVALIDDATE"", ""FORMAPPROVENO"", ""TOGOODSTATUS"", ""TOQUANSTATUS"", ""TOBATCHNO"", ""TOLOTNO"", ""TOPRODDATE"", ""TOVALIDDATE"", ""TOAPPROVENO"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""GOODSPACKID"", ""QTY"", ""GSTORAGEID"", ""PACKNAME"", ""PACKSIZE"", ""SECTIONID"", ""FROMREGISTNO"", ""TOREGISTNO"") AS 
  select a.Goodsownerid, -- 1 :1:2ID
       a.tradeid, --  2 :3:4:5:6:7ID
       a.Tradedate, --  3 :8:9:10:11
       '00' Operationtype, -- 4 :12:13:14:15
       a.Dtllines, -- 5 :16:17:18:19:20:21:22:23:24
       a.Usestatus, --  6 :25:26:27:28
       b.Tradedtlid, -- 7 :29:30:31:32:33:34ID
       d.goodsownid ownerGoodsid, --  8 :35:36:37:38:39ID
       b.fromgoodsstatusid FromGoodstatus, -- 11  :40:41:42:43:44:45:46
       b.FROMQUANSTATUS Fromquanstatus,-- 12  :47:48:49:50:51:52:53
       '0' Frombatchno, --  13  :54:55:56:57:58
       b.Fromlotno, --  14  :59:60:61:62:63
       b.Fromproddate Fromproddate, --  15  :64:65:66:67:68:69:70
       b.FromValiddate FromValiddate, --  16  :71:72:73:74:75
       b.FROMAPPROVEDOCNO FormApproveno, -- 17  :76:77:78:79:80:81:82
       b.togoodsstatusid ToGoodstatus, -- 20  :83:84:85:86:87:88:89
       b.toquanstatus,
       '0' Tobatchno, --  22  :90:91:92:93:94
       b.Tolotno, --  23  :95:96:97:98:99
       b.Toproddate Toproddate, --  24  :100:101:102:103:104:105:106
       b.ToValiddate ToValiddate, --  25  :107:108:109:110:111
       b.TOAPPROVEDOCNO ToApproveno, -- 26  :112:113:114:115:116:117:118
       b.Tradegoodsqty, --  27  :119:120:121:122:123:124:125:126
       b.Tradegoodspack, -- 28  :127:128:129:130:131:132
       null Goodspackid, -- 29  :133:134
       b.Qty, --  30  :135:136
       null gstorageid,
       b.packname,
       b.packsize,
       b.sectionid,
       b.fromregistno,
       b.toregistno
  From Tpl_trade_order           a,
       Tpl_trade_dtl             b,
       tpl_goods                 d,
       tpl_pub_goods_packs       d1,
       tpl_edi_queue h
 Where a.tradeid = b.tradeid
   and b.ownergoodsid = d.ownergoodsid
   and b.goodspackid = d1.goodspackid
   and a.usestatus = 3
   and h.srcid = a.tradeid
   and nvl(h.expflag, 0) = 0
   and h.queuetype = 3
   and nvl(b.qty, 0) <> 0
 Order by a.tradeid

 "
"INTER_CHANGE_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_CHANGE_ORDER_V"" (""INPT_LOTCHANGE_ID"", ""WMS_ADJUST_ID"", ""WMS_ADJUST_DTL_ID"", ""ADJUST_TYPE"", ""PARTY_ID"", ""WAREHOUSE_ID"", ""WAREHOUSE_NAME"", ""COM_DEPOT_ID"", ""DEPOT_NAME"", ""OWNER_GOODS_ID"", ""GOODS_ID"", ""GOODS_CODE"", ""GOODS_NAME"", ""GOODS_DESC"", ""PRODUCT_LOCATION"", ""UNIT_NAME"", ""BEFORE_COM_LOT_ID"", ""BEFORE_LOT_NO"", ""BEFORE_PRODUCT_DATE"", ""BEFORE_EXPIRE_DATE"", ""BEFORE_LOTINV_QTY"", ""AFTER_COM_LOT_ID"", ""AFTER_LOT_NO"", ""AFTER_PRODUCT_DATE"", ""AFTER_EXPIRE_DATE"", ""LOTCHANGE_QTY"", ""IMP_DATE"", ""BEFORE_STATUS"", ""BEFORE_INVENTORY_TYPE_ID"", ""AFTER_STATUS"", ""AFTER_INVENTORY_TYPE_ID"", ""PACKAGE_ID"", ""EXEC_FLAG"", ""EXEC_DATE"", ""EXEC_MEMO"", ""AFTER_PRODUCT_LOCATION"", ""AFTER_REG_MARK_NO"", ""AFTER_GOODS_MAH"", ""MAKER"", ""INV_OWNER_ID"") AS 
  select a.tradeid INPT_LOTCHANGE_ID, --  INTEGER
       a.tradeid WMS_ADJUST_ID, --物流调整单ID
       b.tradedtlid WMS_ADJUST_DTL_ID, --物流调整细单ID
       decode(a.operationtype, 21, 'LOSS', 22, 'SPILL', 24, 'LOTCHANGE', 31, 'INVCHANGE') ADJUST_TYPE,
       a.goodsownerid PARTY_ID, --  NUMBER  货主ID
       a.warehid WAREHOUSE_ID, --  INTEGER  仓库
       a.warehname WAREHOUSE_NAME, --  VARCHAR2(30)  仓库名称
       b.tosectionid COM_DEPOT_ID, --  INTEGER  库区ID
       b.tosectionname DEPOT_NAME, --  VARCHAR2(30)  库区名称
       b.ownergoodsid OWNER_GOODS_ID, --  NUMBER  货主货品ID
       b.goodsid GOODS_ID, --  INTEGER  商品ID 货品主档ID 统一名称
       b.goodsownid GOODS_CODE, --  VARCHAR2(30)  商品编码 货主原货品ID 统一名称
       replace(b.goodsname,chr(9),'') GOODS_NAME, --  VARCHAR2(300)  商品名称
       replace(b.goodstype,chr(9),'') GOODS_DESC, --  VARCHAR2(300)  规格
       replace(b.factname,chr(9),'') PRODUCT_LOCATION, --  VARCHAR2(300)  生产厂家
       b.tradepackname UNIT_NAME, --  VARCHAR2(20)  单位
       b.fromlotid BEFORE_COM_LOT_ID, --  INTEGER  更正前批次ID
       b.fromlotno BEFORE_LOT_NO, --  VARCHAR2(30)  更正前批号
       --b.fromproddate BEFORE_PRODUCT_DATE, --  DATE  更正前生产日期
       TO_char(b.fromproddate,'yyyy-mm-dd') BEFORE_PRODUCT_DATE,
       --b.fromvaliddate BEFORE_EXPIRE_DATE, --  DATE  更正前有效期
       TO_char(b.fromvaliddate,'yyyy-mm-dd') BEFORE_EXPIRE_DATE,
       b.qty BEFORE_LOTINV_QTY, --  NUMBER  更正前库存数量
       b.tolotid AFTER_COM_LOT_ID, --  INTEGER  更正后批次ID
       b.tolotno AFTER_LOT_NO, --  VARCHAR2(30)  更正后批号
       --b.toproddate AFTER_PRODUCT_DATE, --  DATE  更正后生产日期
       TO_char(b.toproddate,'yyyy-mm-dd') AFTER_PRODUCT_DATE,
       --b.tovaliddate AFTER_EXPIRE_DATE, --  DATE  更正后有效期
       TO_char(b.tovaliddate,'yyyy-mm-dd') AFTER_EXPIRE_DATE,
       b.qty LOTCHANGE_QTY, --  NUMBER  更正数量
       --a.tradedate IMP_DATE, --  DATE  生成时间
       TO_char(decode(a.billfrom,3,sysdate,a.tradedate),'yyyy-mm-dd') IMP_DATE,--如果是系统生成的（拟合格调整）用下发时间，其他的用制单时间
       b.fromgoodsstatus BEFORE_STATUS, --  VARCHAR2(30)  调整前状态
       b.fromgoodsstatusid BEFORE_INVENTORY_TYPE_ID, --调整前状态ID
       b.togoodsstatus AFTER_STATUS, --  VARCHAR2(30)  调整后状态
       b.togoodsstatusid AFTER_INVENTORY_TYPE_ID, --调整后状态ID
       b.ownerpackid PACKAGE_ID,--货品包装ID add by xyue 2020-04-30
       'NEW' EXEC_FLAG, --  VARCHAR2(20)  执行状态  NEW
       null EXEC_DATE, --  DATE  执行时间  NULL
       b.dtlmemo EXEC_MEMO, --  VARCHAR2(300)  备注
       replace(b.tofactname,chr(9),'') AFTER_PRODUCT_LOCATION,--调整后生产厂家
       replace(b.toapprovedocno,chr(9),'') AFTER_REG_MARK_NO,--调整后批准文号
       replace(b.tomah,chr(9),'') AFTER_GOODS_MAH, --调整后上市许可持有人
       d.employeename MAKER, --库内移位单确定人
       nvl(b.sourcereceiveid,0) INV_OWNER_ID --拟合格调整用到的 add by xyue 2021-12-31
  from wms_trade_order_v a, inter_trade_dtl_v b,tpl_goodsowner c,pub_employee d
 where a.TRADEID = b.tradeid
   and a.operationtype in (24, 31, 21, 22)
   and a.inputmanid=d.employeeid(+)
   and a.GOODSOWNERID=c.goodsownerid(+)
   and c.iwcs_flag=1
"
"INTER_COUNT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_COUNT_V"" (""INPT_COUNT_ID"", ""COUNT_NO"", ""COUNT_TYPE"", ""COUNT_ID"", ""COUNT_LINES_ID"", ""COUNT_DATE"", ""PARTY_ID"", ""WAREHOUSE_ID"", ""WAREHOUSE_NAME"", ""OWNER_GOODS_ID"", ""GOODS_ID"", ""GOODS_CODE"", ""GOODS_NAME"", ""GOODS_DESC"", ""PRODUCT_LOCATION"", ""UNIT_NAME"", ""COM_LOT_ID"", ""LOT_NO"", ""PACKAGE_ID"", ""PACKAGE_NAME"", ""PACKAGE_NUM"", ""COM_INVENTORY_TYPE_ID"", ""PRODUCT_DATE"", ""EXPIRE_DATE"", ""COUNT_QTY"", ""COM_DEPOT_ID"", ""DEPOT_NAME"", ""IMP_DATE"", ""EXEC_FLAG"", ""EXEC_DATE"", ""EXEC_MEMO"") AS 
  select a.cutid INPT_COUNT_ID, --  INTEGER
       to_char(a.cutid) COUNT_NO, --  VARCHAR2(30)  盘点单号
       decode(a.cuttype, 1, '计划盘点', 2, '静态盘点', 3, '动态盘点') COUNT_TYPE, --  VARCHAR2(30)  盘点类型
       a.cutid COUNT_ID, --  INTEGER  盘点ID
       b.cutdtlid COUNT_LINES_ID, --  INTEGER  盘点明细ID
       a.cutdate COUNT_DATE, --  DATE  盘点时间
       b.goodsownerid PARTY_ID, --  NUMBER  货主ID 统一名称
       a.warehid WAREHOUSE_ID, --  INTEGER  仓库
       g.warehname WAREHOUSE_NAME, --  VARCHAR2(30)  仓库名称
       b.ownergoodsid OWNER_GOODS_ID, --  NUMBER  货主货品ID
       b.goodsid GOODS_ID, --  NUMBER  货品主档ID 统一名称
       c.goodsownid GOODS_CODE, --  VARCHAR2(30)  商品编码 货主原货品ID
       replace(c.goodsname,chr(9),'') GOODS_NAME, --  VARCHAR2(300)  商品名称
       replace(nvl(c.goodstype,'-'),chr(9),'') GOODS_DESC, --  VARCHAR2(300)  规格
       replace(c.factname,chr(9),'') PRODUCT_LOCATION, --  VARCHAR2(300)  生产厂家
       replace(nvl(c.tradepackname,'-'),chr(9),'') UNIT_NAME, --  VARCHAR2(20)  单位
       b.lotid COM_LOT_ID, --  INTEGER  批次ID
       replace(d.lotno,chr(9),'') LOT_NO, --  VARCHAR2(30)  批号
       f.ownerpackid PACKAGE_ID, --  NUMBER  包装ID 货品主档包装ID
       replace(f.packname,chr(9),'') PACKAGE_NAME, --  VARCHAR2(200)  包装单位
       f.packsize PACKAGE_NUM, --  NUMBER(31,8)  包装大小
       b.goodsstatusid COM_INVENTORY_TYPE_ID, --货品状态ID
       d.proddate PRODUCT_DATE, --  DATE  生产日期
       d.validdate EXPIRE_DATE, --  DATE  有效期
       b.stockqty COUNT_QTY, --  NUMBER  库存数量
       e.areaid COM_DEPOT_ID, --  INTEGER  库区ID
       e.areaname DEPOT_NAME, --  VARCHAR2(30)  库区名称
       a.cutdate IMP_DATE, --  DATE  生成时间
       'NEW' EXEC_FLAG, --  VARCHAR2(20)  执行状态  NEW
       NULL EXEC_DATE, --  DATE  执行时间  NULL
       replace(a.memo,chr(9),'') EXEC_MEMO --  VARCHAR2(300)  备注
  from wms_qty_cut         a,
       wms_qty_cut_dtl     b,
       tpl_goods           c,
       wms_goods_lot       d,
       wms_pos_def_v       e,
       tpl_goods_packs f,
       tpl_warehouse       g,
       tpl_goodsowner      h
 where a.cutid = b.cutid
   and b.ownergoodsid = c.ownergoodsid
   and b.lotid = d.lotid
   and b.posid = e.posid
   and (b.goodspackid = f.goodspackid and b.ownergoodsid = f.ownergoodsid)
   and a.warehid = g.warehid
   and nvl(e.iwcs_flag, 0) = 1
   and a.goodsownerid=h.goodsownerid(+)
   and a.usestatus=1
   and h.iwcs_flag=1
"
"INTER_CUSTOMER_ADDRESS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_CUSTOMER_ADDRESS_V"" (""PARTY_ID"", ""ADDRESS_ID"", ""OPER_CODE"", ""CLIENT_ID"", ""CLIENT_NAME"", ""IS_PRIMARY_ADDRESS"", ""ADDRESS_NAME"", ""ADDRESS"", ""REGION_ID"", ""REGION"", ""POSTALCODE"", ""PHONE"", ""LINKMAN"", ""FAX"", ""INPT_DATE"", ""EXEC_DATE"", ""EXEC_FLAG"") AS 
  select b.goodsownerid PARTY_ID, --货主ID
       a.transid ADDRESS_ID, --地址ID
       decode(a.modify_date,null,'00','10') OPER_CODE,
       a.gocompanyid CLIENT_ID, --客户id，货主客户单位ID
       b.companyname CLIENT_NAME, --客户名称
       'N' IS_PRIMARY_ADDRESS, --是否主地址 Y/N
       replace(a.sendpos,chr(9),'') ADDRESS_NAME, --地址名称
       replace(a.inceptaddr,chr(9),'') ADDRESS, --地址
       --to_number(nvl(a.gtransid,0)) REGION_ID, --地区ID
       0 as REGION_ID,
       a.district REGION, --地区
       a.postcode POSTALCODE, --邮政编码
       a.connphone PHONE, --  电话
       a.connector LINKMAN, --联系人
       a.telefax FAX, --传真
       sysdate INPT_DATE, --导入时间
       null EXEC_DATE, --处理时间
       'NEW' EXEC_FLAG --处理状态
  from wms_transport_address a, tpl_go_company b
 where a.gocompanyid = b.companyid
   --and a.inceptaddr is not null
   and nvl(a.modify_date, sysdate) > nvl(a.iwcs_date, sysdate - 1)
"
"INTER_CUSTOMER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_CUSTOMER_V"" (""PARTY_ID"", ""CLIENT_ID"", ""OPER_CODE"", ""CLIENT_CODE"", ""CLIENT_NAME"", ""CLIENT_ADDRESS"", ""LINK_MAN"", ""LINK_PHONE"", ""BANK_NAME"", ""BANK_NO"", ""TAX_NO"", ""INPT_DATE"", ""EXEC_DATE"", ""EXEC_FLAG"") AS 
  select a.goodsownerid PARTY_ID, --货主ID
       a.companyid CLIENT_ID, --货主客户单位ID，唯一主键
       decode(a.modify_date,null,'00','10') OPER_CODE, -- 操作代码，00新增，10更新 99作废
       a.gcompanyid CLIENT_CODE, -- 对方客户编码
       replace(a.companyname,chr(9),'') CLIENT_NAME, -- 客户名称
       nvl(a.deliveraddress, b.supplieraddress) CLIENT_ADDRESS, -- 客户地址
       nvl(a.connector, b.connector) LINK_MAN, -- 联系人
       nvl(a.connphone, b.telephone) LINK_PHONE, -- 电话
       nvl(a.bank, b.bank) BANK_NAME, -- 银行
       nvl(a.bankno, b.bankno) BANK_NO, -- 账号
       nvl(a.taxregistno, b.taxregistno) TAX_NO, -- 税号
       sysdate INPT_DATE, -- 导入时间
       null EXEC_DATE, --处理时间
       'NEW' EXEC_FLAG -- 处理状态
  from tpl_go_company a, tpl_pub_company b
 where a.warecid = b.companyid
   --and nvl(b.customflag, 0) = 1
   and nvl(a.companystyle,-1)=1 --add by xyue 2020-04-16 客户
   and nvl(a.modify_date, sysdate) > nvl(a.iwcs_date, sysdate - 1)
   and exists (select 1 from tpl_goodsowner_to_warehouse x where x.goodsownerid=a.goodsownerid and x.warehid=1)
   and exists (select c.goodsownerid
          from tpl_goodsowner c
         where c.goodsownerid = a.goodsownerid
           and nvl(c.iwcs_flag, 0) = 1)
"
"INTER_CUSTOMER_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_CUSTOMER_V1"" (""PARTY_ID"", ""CLIENT_ID"", ""OPER_CODE"", ""CLIENT_CODE"", ""CLIENT_NAME"", ""CLIENT_ADDRESS"", ""LINK_MAN"", ""LINK_PHONE"", ""BANK_NAME"", ""BANK_NO"", ""TAX_NO"", ""INPT_DATE"", ""EXEC_DATE"", ""EXEC_FLAG"") AS 
  select a.goodsownerid PARTY_ID, --货主ID
       a.companyid CLIENT_ID, --货主客户单位ID，唯一主键
       decode(a.modify_date,null,'00','10') OPER_CODE, -- 操作代码，00新增，10更新 99作废
       a.gcompanyid CLIENT_CODE, -- 对方客户编码
       replace(a.companyname,chr(9),'') CLIENT_NAME, -- 客户名称
       nvl(a.deliveraddress, b.supplieraddress) CLIENT_ADDRESS, -- 客户地址
       nvl(a.connector, b.connector) LINK_MAN, -- 联系人
       nvl(a.connphone, b.telephone) LINK_PHONE, -- 电话
       nvl(a.bank, b.bank) BANK_NAME, -- 银行
       nvl(a.bankno, b.bankno) BANK_NO, -- 账号
       nvl(a.taxregistno, b.taxregistno) TAX_NO, -- 税号
       sysdate INPT_DATE, -- 导入时间
       null EXEC_DATE, --处理时间
       'NEW' EXEC_FLAG -- 处理状态
  from tpl_go_company a, tpl_pub_company b
 where a.warecid = b.companyid
   --and nvl(b.customflag, 0) = 1
   and nvl(a.companystyle,-1)=1 --add by xyue 2020-04-16 客户
   and nvl(a.modify_date, sysdate) > nvl(a.iwcs_date, sysdate - 1)
   and exists (select 1 from tpl_goodsowner_to_warehouse x where x.goodsownerid=a.goodsownerid and x.GOODSOWNERID <> 9156 and x.warehid=17)
   and exists (select c.goodsownerid
          from tpl_goodsowner c
         where c.goodsownerid = a.goodsownerid
           and nvl(c.iwcs_flag, 0) = 1)
"
"INTER_GOODSOWNER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_GOODSOWNER_V"" (""PARTY_ID"", ""PARTY_NAME"", ""PARTY_OPCODE"", ""SHORT_NAME"", ""ENGLISH_NAME"", ""PRIMARY_ADDRESS"", ""POSTCODE"", ""INPT_DATE"", ""EXEC_DATE"", ""EXEC_FLAG"", ""MEMO"") AS 
  select a.goodsownerid PARTY_ID, --货主ID
       a.goodsownername PARTY_NAME, --货主名称
       a.goopcode PARTY_OPCODE, --货主操作码
       a.goodsownershort SHORT_NAME, -- 货主简称
       a.goopcode ENGLISH_NAME, --英文名称
       a.address PRIMARY_ADDRESS, --公司注册地址
       a.postcode POSTCODE, --邮政编码
       sysdate INPT_DATE, --导入时间
       null EXEC_DATE, --处理时间
       'NEW' EXEC_FLAG, --处理状态
       a.memo MEMO --备注
  from tpl_goodsowner a
 where nvl(a.iwcs_flag, 0) = 1
   and exists (select 1 from tpl_goodsowner_to_warehouse x where x.goodsownerid=a.goodsownerid and x.warehid=1)
   and nvl(a.modify_date, sysdate) > nvl(a.iwcs_date, sysdate - 1)
"
"INTER_GOODSOWNER_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_GOODSOWNER_V1"" (""PARTY_ID"", ""PARTY_NAME"", ""PARTY_OPCODE"", ""SHORT_NAME"", ""ENGLISH_NAME"", ""PRIMARY_ADDRESS"", ""POSTCODE"", ""INPT_DATE"", ""EXEC_DATE"", ""EXEC_FLAG"", ""MEMO"") AS 
  select a.goodsownerid PARTY_ID, --货主ID
       a.goodsownername PARTY_NAME, --货主名称
       a.goopcode PARTY_OPCODE, --货主操作码
       a.goodsownershort SHORT_NAME, -- 货主简称
       a.goopcode ENGLISH_NAME, --英文名称
       a.address PRIMARY_ADDRESS, --公司注册地址
       a.postcode POSTCODE, --邮政编码
       sysdate INPT_DATE, --导入时间
       null EXEC_DATE, --处理时间
       'NEW' EXEC_FLAG, --处理状态
       a.memo MEMO --备注
  from tpl_goodsowner a
 where nvl(a.iwcs_flag, 0) = 1
   and exists (select 1 from tpl_goodsowner_to_warehouse x where x.goodsownerid=a.goodsownerid and x.warehid=17)
   and nvl(a.modify_date, sysdate) > nvl(a.iwcs_date, sysdate - 1)
   and a.goodsownerid <> 9156
"
"INTER_GOODSPACK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_GOODSPACK_V"" (""PARTY_ID"", ""GOODS_ID"", ""OWNER_GOODS_ID"", ""OPER_CODE"", ""PACKAGE_ID"", ""UNIT_ID"", ""PACKAGE_NAME"", ""PACKAGE_NUM"", ""LENGTH"", ""WIDTH"", ""HEIGHT"", ""WEIGHT"", ""BULK"", ""PALLET_TIER"", ""PALLET_TIER_LIMIT"", ""PALLET_QTY"", ""PACKAGE_STATUS"", ""PACKAGE_TYPE"", ""INPT_DATE"", ""EXEC_DATE"", ""EXEC_FLAG"") AS 
  select b.goodsownerid PARTY_ID, --货主ID
       b.waregoodsid GOODS_ID, --货品主档ID
       a.ownergoodsid OWNER_GOODS_ID, --货主货品ID
       decode(a.modify_date, null, '00', '10') OPER_CODE,
       a.goodspackid PACKAGE_ID, --货品主档包装ID
       a.ownerpackid UNIT_ID, --货主货品包装ID
       a.packname PACKAGE_NAME, --货品包装单位
       a.packsize PACKAGE_NUM, --包装大小
       to_char(nvl(a.goodslength*10, 0), 'FM999999990.00000009') LENGTH, --长度(mm)
       to_char(nvl(a.goodswidth*10, 0), 'FM999999990.00000009') WIDTH, --宽度(mm)
       to_char(nvl(a.goodsheight*10, 0), 'FM999999990.00000009') HEIGHT, --高度(mm)
       to_char(nvl(a.goodsweight, 0), 'FM999999990.00000009') WEIGHT, --重量(g)
       to_char(nvl(a.goodscubage*1000, 0), 'FM999999990.00000009') BULK, --体积 立方分米
       1 PALLET_TIER, --托盘每层箱数
       1 PALLET_TIER_LIMIT, --托盘层数限制
       nvl((select case
              when max(d.goodsuseqty) > 9999 then
               9999
              else
               max(d.goodsuseqty)
            end
       from Wms_goods_to_postype d
      where d.goodspackid = a.goodspackid
        and d.postype = 41), 1) PALLET_QTY, --整托盘数量
decode(a.usestatus, 1, 'TRUE', 'FALSE') PACKAGE_STATUS, --使用状态   TRUE/FALSE
decode(a.baseunitflag, 1, 'UNIT', 'PACK') PACKAGE_TYPE, --包装类型 UNIT/PACK
sysdate INPT_DATE, --导入时间
null EXEC_DATE, --处理时间
 'NEW' EXEC_FLAG --处理状态
  from tpl_goods_packs a, tpl_goods b, tpl_pub_goods_packs c
 where a.ownergoodsid = b.ownergoodsid
   and a.goodspackid = c.goodspackid
   and nvl(a.packsize, 0) >= 1
   and nvl(a.modify_date, sysdate) > nvl(a.iwcs_date, sysdate - 1)
"
"INTER_GOODS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_GOODS_V"" (""OWNER_GOODS_ID"", ""GOODS_ID"", ""GOODS_CODE"", ""OPER_CODE"", ""PARTY_ID"", ""GOODS_NAME"", ""GOODS_ENGNAME"", ""GOODS_DESC"", ""GOODS_STATUS"", ""PRODUCT_LOCATION"", ""GOODS_FORM"", ""GOODS_UNIT"", ""GOODS_CATAGORY_ID"", ""GOODS_CATAGORY"", ""GOODS_STORAGEMODE"", ""WHOLESALE_PRICE"", ""RETAILSALE_PRICE"", ""TRADE_MARK"", ""REG_MARK_NO"", ""INPT_DATE"", ""EXEC_DATE"", ""EXEC_FLAG"", ""FACTORY_NAME"", ""DEFAULT_EXPIRE_DAYS"", ""BAR_CODE"", ""PACK_RATE"", ""GOODS_CONTROL_FLAG"", ""GOODS_MAH"") AS 
  select a.ownergoodsid OWNER_GOODS_ID, --货主货品ID，货品信息唯一主键
       a.waregoodsid GOODS_ID, --货品主档ID
       a.goodsownid GOODS_CODE, --货主原货品ID
       decode(a.modify_date, null, '00', '10') OPER_CODE, -- 操作代码，00新增，10更新 99作废
       a.goodsownerid PARTY_ID, --货主ID
       replace(a.goodsname, chr(9), '') GOODS_NAME, --货品名称，通用名
       replace(a.goodsengname, chr(9), '') GOODS_ENGNAME, --商品名 change by xyue 2020-04-16
       replace(nvl(a.goodstype, '-'), chr(9), '') GOODS_DESC, --货品规格
       decode(a.usestatus, 1, 'TRUE', 'FALSE') GOODS_STATUS, --使用状态  TRUE/FALSE
       replace(a.prodarea, chr(9), '') PRODUCT_LOCATION, --产地，
       substr(replace(a.drugform, chr(9), ''), 1, 10) GOODS_FORM, --剂型
       nvl(a.tradepackname, '-') GOODS_UNIT, --单位
       nvl(c.goodsclass, 0) GOODS_CATAGORY_ID, --类别ID
       null GOODS_CATAGORY, --货品类别
       (select x.ddlname
          from pub_ddl_dtl x
         where x.sysid = 207
           and x.ddlid = a.storagecondition) GOODS_STORAGEMODE, --存储类型
       nvl(a.wholesaleprice, 0) WHOLESALE_PRICE, --批发价
       nvl(a.resaleprice, 0) RETAILSALE_PRICE, --零售价
       replace(a.trademark, chr(9), '') TRADE_MARK, --商标
       --a.prodlicenseno REG_MARK_NO, --生产许可证号
       replace(a.approvedocno, chr(9), '') REG_MARK_NO, --批准文号 change by xyue 2020-04-16
       sysdate INPT_DATE, --导入时间
       null EXEC_DATE, --处理时间
       'NEW' EXEC_FLAG,
       replace(a.factname, chr(9), '') FACTORY_NAME, --生产厂商
       nvl(b.l_period, 36) DEFAULT_EXPIRE_DAYS, --有效期
       replace(nvl(b.barcode, a.barcode), chr(9), '') BAR_CODE, --EAN条形码
       0 PACK_RATE, --药品拆零系数
       'FALSE' GOODS_CONTROL_FLAG, --管制药品标志  TRUE/FALSE
       replace(a.mah, chr(9), '') GOODS_MAH
  from tpl_goods a,
       tpl_pub_goods b,
       (select t.goodsid, t.goodsclass
          from wms_goods_feature t
         where t.warehid = 1) c
 where a.Waregoodsid = b.goodsid
   and b.goodsid = c.goodsid(+)
   and nvl(a.modify_date, sysdate) > nvl(a.iwcs_date, sysdate - 1)
   and a.drugform is not null --剂型不能为空
   and exists (select 1
          from tpl_goodsowner_to_warehouse x
         where x.goodsownerid = a.goodsownerid
           and x.warehid = 1
           --and x.goodsownerid <> 6
           --and x.goodsownerid <> 9156
           )
   and exists (select c.goodsownerid
          from tpl_goodsowner c
         where c.goodsownerid = a.goodsownerid
           and nvl(c.iwcs_flag, 0) = 1)
"
"INTER_GOODS_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_GOODS_V1"" (""OWNER_GOODS_ID"", ""GOODS_ID"", ""GOODS_CODE"", ""OPER_CODE"", ""PARTY_ID"", ""GOODS_NAME"", ""GOODS_ENGNAME"", ""GOODS_DESC"", ""GOODS_STATUS"", ""PRODUCT_LOCATION"", ""GOODS_FORM"", ""GOODS_UNIT"", ""GOODS_CATAGORY_ID"", ""GOODS_CATAGORY"", ""GOODS_STORAGEMODE"", ""WHOLESALE_PRICE"", ""RETAILSALE_PRICE"", ""TRADE_MARK"", ""REG_MARK_NO"", ""INPT_DATE"", ""EXEC_DATE"", ""EXEC_FLAG"", ""FACTORY_NAME"", ""DEFAULT_EXPIRE_DAYS"", ""BAR_CODE"", ""PACK_RATE"", ""GOODS_CONTROL_FLAG"", ""GOODS_MAH"") AS 
  select a.ownergoodsid OWNER_GOODS_ID, --货主货品ID，货品信息唯一主键
       a.waregoodsid GOODS_ID, --货品主档ID
       a.goodsownid GOODS_CODE, --货主原货品ID
       decode(a.modify_date, null, '00', '10') OPER_CODE, -- 操作代码，00新增，10更新 99作废
       a.goodsownerid PARTY_ID, --货主ID
       replace(a.goodsname, chr(9), '') GOODS_NAME, --货品名称，通用名
       replace(a.goodsengname, chr(9), '') GOODS_ENGNAME, --商品名 change by xyue 2020-04-16
       replace(nvl(a.goodstype, '-'), chr(9), '') GOODS_DESC, --货品规格
       decode(a.usestatus, 1, 'TRUE', 'FALSE') GOODS_STATUS, --使用状态  TRUE/FALSE
       replace(a.prodarea, chr(9), '') PRODUCT_LOCATION, --产地，
       substr(replace(a.drugform, chr(9), ''), 1, 10) GOODS_FORM, --剂型
       nvl(a.tradepackname, '-') GOODS_UNIT, --单位
       nvl(c.goodsclass, 0) GOODS_CATAGORY_ID, --类别ID
       null GOODS_CATAGORY, --货品类别
       (select x.ddlname
          from pub_ddl_dtl x
         where x.sysid = 207
           and x.ddlid = a.storagecondition) GOODS_STORAGEMODE, --存储类型
       nvl(a.wholesaleprice, 0) WHOLESALE_PRICE, --批发价
       nvl(a.resaleprice, 0) RETAILSALE_PRICE, --零售价
       replace(a.trademark, chr(9), '') TRADE_MARK, --商标
       --a.prodlicenseno REG_MARK_NO, --生产许可证号
       replace(a.approvedocno, chr(9), '') REG_MARK_NO, --批准文号 change by xyue 2020-04-16
       sysdate INPT_DATE, --导入时间
       null EXEC_DATE, --处理时间
       'NEW' EXEC_FLAG,
       replace(a.factname, chr(9), '') FACTORY_NAME, --生产厂商
       nvl(b.l_period, 36) DEFAULT_EXPIRE_DAYS, --有效期
       replace(nvl(b.barcode, a.barcode), chr(9), '') BAR_CODE, --EAN条形码
       0 PACK_RATE, --药品拆零系数
       'FALSE' GOODS_CONTROL_FLAG, --管制药品标志  TRUE/FALSE
       replace(a.mah, chr(9), '') GOODS_MAH
  from tpl_goods a,
       tpl_pub_goods b,
       (select t.goodsid, t.goodsclass
          from wms_goods_feature t
         where t.warehid = 17) c
 where a.Waregoodsid = b.goodsid
   and b.goodsid = c.goodsid(+)
   and a.drugform is not null --剂型不能为空
   and nvl(a.modify_date, sysdate) > nvl(a.iwcs_date, sysdate - 1)
   and exists (select 1
          from tpl_goodsowner_to_warehouse x
         where x.goodsownerid = a.goodsownerid
           and x.warehid = 17
           and x.goodsownerid <> 9156
           )
   and exists (select c.goodsownerid
          from tpl_goodsowner c
         where c.goodsownerid = a.goodsownerid
           and nvl(c.iwcs_flag, 0) = 1)
"
"INTER_IN_ORDER_CANCEL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_IN_ORDER_CANCEL_V"" (""PO_TYPE"", ""PO_DATE"", ""OPER_CODE"", ""SOURCE_ID"", ""SOURCE_LINES_ID"", ""PARTY_ID"", ""PARTY_NAME"", ""VENDER_ID"", ""VENDER_NAME"", ""GOODS_ID"", ""GOODS_NAME"", ""OWNER_GOODS_ID"", ""GOODS_CODE"", ""LOT_ID"", ""LOT_NO"", ""PRODUCE_DATE"", ""EXPIRE_DATE"", ""REC_QTY"", ""REC_BAD_QTY"", ""QI_STOCK"", ""RECEIVE_DATE"", ""INPT_DATE"", ""EXEC_DATE"", ""EXEC_FLAG"", ""ERROR_MEMO"", ""CREATER"", ""TAX_PRICE"", ""TAX_AMOUNT"", ""PACKAGE_ID"", ""PACKAGE_NAME"", ""PACKAGE_NUM"", ""FACTORY_NAME"", ""GOODS_MAH"", ""REG_MARK_NO"", ""FIELD1"", ""FIELD2"", ""FIELD3"", ""WAREHID"") AS 
  select case
         when a.operationtype in (1,23) then
          'PURCHASE'
         when a.operationtype in (7,42) then
          'SALE_RTN'
         else
          'TRANSFER'
       end PO_TYPE,--业务类型
        a.credate PO_DATE, --订单时间
        '00' OPER_CODE, --操作代码，00新增，10更改，99作废
        to_number(b.indtlid) SOURCE_ID, --入库细单ID
        to_number(c.receiveid) SOURCE_LINES_ID, --收货细单ID
        to_number(a.goodsownerid) PARTY_ID, --货主ID
        d.goodsownername PARTY_NAME, --货主名称
        to_number(a.sourcecompanyid) VENDER_ID, --供应商ID
        e.companyname VENDER_NAME, --供应商名称
        to_number(c.goodsid) GOODS_ID, --货品主档ID
        f.goodsname GOODS_NAME, --货品名称
        to_number(c.ownergoodsid) OWNER_GOODS_ID, --货主货品ID
        f.goodsownid GOODS_CODE, --产品编码，货主原货品ID
        to_number(c.lotid) LOT_ID, --批号ID
        c.lotno LOT_NO, --批号
        c.proddate PRODUCE_DATE, --生产日期
        c.validdate EXPIRE_DATE, --有效期
        to_number(c.goodsqty) REC_QTY, --数量
        to_number(0) REC_BAD_QTY, --不合格数量
        to_number(0) QI_STOCK, --待验数量
        c.receivedate RECEIVE_DATE, --收货日期
        sysdate INPT_DATE, --导入时间
        null EXEC_DATE, --处理时间
        'NEW' EXEC_FLAG, --处理状态
        null ERROR_MEMO, --错误信息
        g.employeename CREATER, --收货人
        to_number(nvl(b.price,0)) TAX_PRICE, --单价
        to_number(nvl(c.goodsqty * b.price,0)) TAX_AMOUNT, --金额
        to_number(h.ownerpackid) PACKAGE_ID, --包装ID 货品主档包装ID
        h.packname PACKAGE_NAME, --包装名称
        to_number(h.packsize) PACKAGE_NUM, --包装大小
        i.factname FACTORY_NAME,
        i.mah      GOODS_MAH,
        replace(i.approvedocno,chr(9),'') REG_MARK_NO,
        j.containerno FIELD1, --虚拟容器编码
        null FIELD2,
        null FIELD3,
        a.warehid
   from wms_in_order        a,
        wms_in_order_dtl    b,
        wms_receive_dtl     c,
        tpl_goodsowner      d,
        tpl_go_company      e,
        tpl_goods           f,
        pub_employee        g,
        tpl_goods_packs     h,
        wms_goods_lot       i,
        wms_container_def   j
        --wms_st_io_doc       k
  where a.inid = b.inid
    and b.indtlid = c.indtlid
    and a.goodsownerid = d.goodsownerid(+)
    and a.sourcecompanyid = e.companyid(+)
    and c.ownergoodsid = f.ownergoodsid(+)
    and c.inputmanid = g.employeeid(+)
    and (c.goodspackid = h.goodspackid and c.ownergoodsid = h.ownergoodsid)
    and c.lotid=i.lotid(+)
    and nvl(d.iwcs_flag,0) = 1
    and c.containerid=j.containerid(+)
    --and c.receiveid=k.sourceid
    --and k.comefrom=1
    --and k.sectionid=8295
"
"INTER_IN_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_IN_ORDER_V"" (""PO_TYPE"", ""PO_DATE"", ""OPER_CODE"", ""SOURCE_ID"", ""SOURCE_LINES_ID"", ""PARTY_ID"", ""PARTY_NAME"", ""VENDER_ID"", ""VENDER_NAME"", ""GOODS_ID"", ""GOODS_NAME"", ""OWNER_GOODS_ID"", ""GOODS_CODE"", ""LOT_ID"", ""LOT_NO"", ""PRODUCE_DATE"", ""EXPIRE_DATE"", ""REC_QTY"", ""REC_BAD_QTY"", ""QI_STOCK"", ""RECEIVE_DATE"", ""INPT_DATE"", ""EXEC_DATE"", ""EXEC_FLAG"", ""ERROR_MEMO"", ""CREATER"", ""TAX_PRICE"", ""TAX_AMOUNT"", ""PACKAGE_ID"", ""PACKAGE_NAME"", ""PACKAGE_NUM"", ""FACTORY_NAME"", ""GOODS_MAH"", ""REG_MARK_NO"", ""FIELD1"", ""FIELD2"", ""FIELD3"", ""WAREHID"") AS 
  select case
         when a.operationtype in (1,23) then
          'PURCHASE'
         when a.operationtype in (7,42) then
          'SALE_RTN'
         else
          'TRANSFER'
       end PO_TYPE,--业务类型
        a.credate PO_DATE, --订单时间
        '00' OPER_CODE, --操作代码，00新增，10更改，99作废
        to_number(b.indtlid) SOURCE_ID, --入库细单ID
        to_number(c.receiveid) SOURCE_LINES_ID, --收货细单ID
        to_number(a.goodsownerid) PARTY_ID, --货主ID
        d.goodsownername PARTY_NAME, --货主名称
        to_number(a.sourcecompanyid) VENDER_ID, --供应商ID
        replace(e.companyname,chr(9),'') VENDER_NAME, --供应商名称
        to_number(c.goodsid) GOODS_ID, --货品主档ID
        replace(f.goodsname,chr(9),'') GOODS_NAME, --货品名称
        to_number(c.ownergoodsid) OWNER_GOODS_ID, --货主货品ID
        f.goodsownid GOODS_CODE, --产品编码，货主原货品ID
        to_number(c.lotid) LOT_ID, --批号ID
        c.lotno LOT_NO, --批号
        c.proddate PRODUCE_DATE, --生产日期
        decode(c.validdate2,null,c.validdate,c.validdate2) as  EXPIRE_DATE, --有效期
        to_number(c.goodsqty) REC_QTY, --数量
        to_number(0) REC_BAD_QTY, --不合格数量
        to_number(0) QI_STOCK, --待验数量
        c.receivedate RECEIVE_DATE, --收货日期
        sysdate INPT_DATE, --导入时间
        null EXEC_DATE, --处理时间
        'NEW' EXEC_FLAG, --处理状态
        null ERROR_MEMO, --错误信息
        g.employeename CREATER, --收货人
        to_number(nvl(b.price,0)) TAX_PRICE, --单价
        to_number(nvl(c.goodsqty * b.price,0)) TAX_AMOUNT, --金额
        to_number(h.ownerpackid) PACKAGE_ID, --包装ID 货品主档包装ID
        h.packname PACKAGE_NAME, --包装名称
        to_number(h.packsize) PACKAGE_NUM, --包装大小
        replace(i.factname,chr(9),'') FACTORY_NAME,
        replace(i.mah,chr(9),'') GOODS_MAH,
        replace(i.approvedocno,chr(9),'') REG_MARK_NO,
        j.containerno FIELD1, --虚拟容器编码
        c.goodsstatusid FIELD2,
        null FIELD3,
        a.warehid
   from wms_in_order        a,
        wms_in_order_dtl    b,
        wms_receive_dtl     c,
        tpl_goodsowner      d,
        tpl_go_company      e,
        tpl_goods           f,
        pub_employee        g,
        tpl_goods_packs     h,
        wms_goods_lot       i,
        wms_container_def   j,
        wms_st_io_doc       k
  where a.inid = b.inid
    and b.indtlid = c.indtlid
    and a.goodsownerid = d.goodsownerid(+)
    and a.sourcecompanyid = e.companyid(+)
    and c.ownergoodsid = f.ownergoodsid(+)
    and c.inputmanid = g.employeeid(+)
    and (c.goodspackid = h.goodspackid and c.ownergoodsid = h.ownergoodsid)
    and c.lotid=i.lotid(+)
    and nvl(d.iwcs_flag,0) = 1
    and c.containerid=j.containerid(+)
    and c.receiveid=k.sourceid
    and k.comefrom=1
    and k.sectionid in (8295,8515,8916,9235,11767)
    and c.goodsstatusid in (1,7,-1)
"
"INTER_MNTN_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_MNTN_ORDER_V"" (""MNTN_ID"", ""MNTN_BILL_NO"", ""MNTN_TYPE_ID"", ""MNTN_TYPE"", ""PARTY_ID"", ""OWNER_GOODS_ID"", ""GOODS_ID"", ""GOODS_CODE"", ""LOT_ID"", ""LOT_NO"", ""PACKAGE_ID"", ""PACKAGE_NAME"", ""PACKAGE_NUM"", ""COM_INVENTORY_TYPE_ID"", ""MAKE_DATE"", ""IMP_DATE"", ""EXEC_DATE"", ""EXEC_FLAG"", ""AREA_ID"", ""DEPOT_ID"", ""MEMO"", ""MNTN_ATTR1"", ""MNTN_ATTR2"", ""MNTN_ATTR3"", ""MNTN_ATTR4"", ""MNTN_ATTR5"", ""LINE_NO"", ""WAREHID"") AS 
  select a.conservedocid MNTN_ID, --INTEGER养护计划ID
       to_char(c.conserveid) MNTN_BILL_NO, --VARCHAR2(20)养护计划单
       a.conservetype MNTN_TYPE_ID, --INTEGER养护类型ID
       decode(a.conservetype, 1, '一般养护', 2, '重点养护', 3, '近效期养护') MNTN_TYPE, --VARCHAR2(255)养护类型
       c.goodsownerid PARTY_ID, --NUMBER货主ID统一名称
       c.ownergoodsid OWNER_GOODS_ID, --NUMBER货主货品ID
       d.waregoodsid GOODS_ID, --INTEGER商品ID货品主档ID
       d.goodsownid GOODS_CODE, --VARCHAR2(30)商品编码货主原货品ID
       c.lotid LOT_ID, --INTEGER批号ID
       e.lotno LOT_NO, --VARCHAR2(100)批号
       (select t.ownerpackid from tpl_goods_packs t where t.ownergoodsid=c.ownergoodsid and t.goodspackid=c.goodspackid) PACKAGE_ID, --NUMBER包装ID
       f.packname PACKAGE_NAME, --VARCHAR2(00)包装单位
       f.packsize PACKAGE_NUM, --VARCHAR2(200)包装数量
       c.goodsstatusid COM_INVENTORY_TYPE_ID,--NUMBER 货品状态ID
       c.credate MAKE_DATE, --DATE生成时间
       sysdate IMP_DATE, --DATE导入时间
       NULL EXEC_DATE, --DATE处理时间NULL
       'NEW' EXEC_FLAG, --VARCHAR2(10)状态NEW
       g.sectionid AREA_ID, --INTEGER分区ID
       g.areaid DEPOT_ID, --INTEGER库区ID
       b.memo MEMO, --VARCHAR2(255)备注
       NULL MNTN_ATTR1, --VARCHAR2(30)冗余字段1(Deliver否_ORDER_NO)
       NULL MNTN_ATTR2, --VARCHAR2(30)冗余字段2(CUSTOMERPO#)
       NULL MNTN_ATTR3, --VARCHAR2(30)冗余字段3
       NULL MNTN_ATTR4, --VARCHAR2(30)冗余字段4
       NULL MNTN_ATTR5, --VARCHAR2(30)冗余字段5
       rownum LINE_NO, -- VARCHAR2(20)行号
       a.warehid
  from gsp_conserve_plan_doc a,
       gsp_conserve_plan_dtl b,
       gsp_conserve          c,
       tpl_goods             d,
       wms_goods_lot         e,
       tpl_pub_goods_packs   f,
       wms_pos_def_v         g
 where a.conservedocid = b.conservedocid
   and b.conservedtlid=c.sourceid
   and c.ownergoodsid=d.ownergoodsid(+)
   and c.lotid = e.lotid(+)
   and c.goodspackid=f.goodspackid(+)
   and c.posid = g.posid
   and nvl(g.iwcs_flag,0) = 1
   and nvl(c.iwcs_status,0) = 0
"
"INTER_OUT_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_OUT_ORDER_V"" (""WMS_ORDER_ID"", ""WMS_INOUT_ID"", ""ERP_ORDER_ID"", ""WAVE_ID"", ""PKT_TYPE"", ""OPER_CODE"", ""MAKE_DATE"", ""CLIENT_ID"", ""CLIENT_NAME"", ""WMS_ORDER_LINES_ID"", ""ERP_ORDER_LINES_ID"", ""PARTY_ID"", ""PARTY_NAME"", ""GOODS_CODE"", ""OWNER_GOODS_ID"", ""GOODS_ID"", ""COM_INVENTORY_TYPE_ID"", ""COM_INVENTORY_TYPE_NAME"", ""IS_DEFINE_LOT"", ""LOT_ID"", ""LOT_NO"", ""DRUGCODE_CHECK"", ""PACKSEQFLAG"", ""PRODUCE_DATE"", ""EXPIRE_DATE"", ""QTY"", ""PACKAGE_ID"", ""PACKAGE_NAME"", ""PACKAGE_NUM"", ""TAX_PRICE"", ""TAX_AMOUNT"", ""SHIP_MODE"", ""SEND_ADDRESS_ID"", ""SEND_ADDRESS"", ""SEND_PRIOR"", ""FIELD_NO"", ""SORT_NO"", ""MEMO"", ""LOT_LIMIT"", ""DEPOT_ID"", ""DEPOT_NAME"", ""IMP_DATE"", ""EXEC_DATE"", ""EXEC_FLAG"", ""ERROR_MEMO"", ""REQ_SHIP_DATE"", ""LINK_MAN"", ""LINK_TELE"", ""BILL_NO"", ""FIELD1"", ""FIELD2"", ""FIELD3"", ""WAREHID"") AS 
  select a.outid WMS_ORDER_ID, --物流出库订单ID
       n.inoutid WMS_INOUT_ID, --物流出入库单ID
       a.zxcolumn4 ERP_ORDER_ID, --  ERP总单ID
       a.waveid WAVE_ID, --波次ID
       case
         when a.operationtype in (25,43,11,18) then
          'SALE'
         when a.operationtype in (12,21) then
          'PUR_RTN'
         else
          'LOSSES'
       end PKT_TYPE, --出库指令类型，SALE，PUR_RTN，TRANSFER，LOSSES（盘盈）
       '00' OPER_CODE, --操作代码，00新增，10更改，99作废
       a.credate MAKE_DATE, --订单接收时间
       a.reccompanyid CLIENT_ID, --出库单位ID 货主客户单位ID
       c.companyname CLIENT_NAME, --出库单位
       b.outdtlid WMS_ORDER_LINES_ID, --出库细单ID
       b.dtlzxcolumn4 ERP_ORDER_LINES_ID, --ERP细单ID
       a.GOODSOWNERID PARTY_ID, --货主ID 统一名称
       d.goodsownername PARTY_NAME, --货主名称 统一名称
       e.goodsownid GOODS_CODE, --货主原货品ID 统一名称
       b.ownergoodsid OWNER_GOODS_ID, --货主货品ID
       b.goodsid GOODS_ID, --货品主档ID
       b.goodsstatusid COM_INVENTORY_TYPE_ID, --货品状态ID
       o.goodsstatus COM_INVENTORY_TYPE_NAME,
       'TRUE' IS_DEFINE_LOT, --是否指定批号 Y/N
       b.lotid LOT_ID, --批号ID
       f.lotno LOT_NO, --批号
       decode(e.ecodeflag, 1, 'Y', 'N') DRUGCODE_CHECK, --是否采集药监码 Y/N
       decode(e.packseqflag, 1, 'Y', 'N') PACKSEQFLAG,
       f.proddate PRODUCE_DATE, --生产日期
       f.validdate EXPIRE_DATE, --有效期
       n.goodsqty QTY, --出货数量
       g.ownerpackid PACKAGE_ID, --包装ID 货品主档包装ID
       g.packname PACKAGE_NAME, --包装单位
       g.packsize PACKAGE_NUM, --包装大小*/
       to_number(nvl(b.lydtlzxcolumn3, 0)) TAX_PRICE, --单价
       nvl(b.lydtlzxcolumn3, 0) * nvl(n.goodsqty, 0) TAX_AMOUNT, --金额
       a.transmodeid SHIP_MODE, --运输方式
       a.transid SEND_ADDRESS_ID, --  运输地址ID
       replace(a.realrecaddr,chr(9),'') SEND_ADDRESS, --  实际收货地址
       nvl(a.urgenflag,0) SEND_PRIOR, --  急单
       l.routename FIELD_NO, --  线路编号
       nvl(l.sort_no,'12') SORT_NO,--add by xyue 2020-04-30 没有弹出口的默认到异常口12
       replace((case when a.goodsownerid=682 and a.reccompanyid=1791345 then p.sendpos else a.exportmemo end),chr(9),'') MEMO, --备注,去制表符                                                                                                                                                                                                                                                                                            备注
       '' LOT_LIMIT, -- 业务类型
       1 DEPOT_ID, --  上架库区
       '自动化库' DEPOT_NAME, --  库区名称
       sysdate IMP_DATE, --导入时间
       null EXEC_DATE, -- 处理时间
       'NEW' EXEC_FLAG, -- 状态 NEW
       null ERROR_MEMO, --  错误描述
       a.prearrivedate REQ_SHIP_DATE, -- 要求送达时间
       c.connector LINK_MAN, --  联系人
       c.connector LINK_TELE, -- 联系电话
       a.wavedtlid BILL_NO,--随货同行号 add by xyue 2020-04-30
       '' FIELD1, --  冗余字段1
       '' FIELD2, --  冗余字段2
       '' FIELD3, --  冗余字段3*/
       a.warehid
  from wms_out_order a,
       (select x.outdtlid,
               x.dtlzxcolumn4,
               x.ownergoodsid,
               x.goodsid,
               x.goodsstatusid,
               nvl(x.lotid, y.lotid) lotid,
               x.goodspackid,
               x.lydtlzxcolumn3,
               x.dtlmemo,
               y.wavegoodsdtlid,
               x.outid
          from wms_out_order_dtl x, wms_out_order_lot_dtl y
         where x.outdtlid = y.outdtlid) b,
       tpl_go_company c,
       tpl_goodsowner d,
       tpl_goods e,
       wms_goods_lot f,
       tpl_goods_packs g,
       tms_route_pos k,
       wms_tr_route l,
       (select x.goodsqty, x.sourceid, x.inoutid
          from wms_st_io_doc x, wms_st_section_def y
         where x.sectionid = y.sectionid
           and x.comefrom = 3
           and x.inoutflag = 1
           and nvl(y.iwcs_flag, 0) = 1) n,
       wms_goodsstatus o,
       wms_transport_address p
 where a.outid = b.outid
   and a.reccompanyid = c.companyid
   and a.goodsownerid = d.goodsownerid
   and b.ownergoodsid = e.ownergoodsid
   and b.lotid = f.lotid
   and (b.goodspackid = g.goodspackid and b.ownergoodsid = g.ownergoodsid)
   and (a.transid = k.transid(+) and a.warehid = k.warehid(+))
   and k.routeid = l.routeid(+)
   and b.wavegoodsdtlid = n.sourceid
   and b.goodsstatusid = o.goodsstatusid(+)
   and a.transid=p.transid(+)
   and d.iwcs_flag=1
"
"INTER_PICK_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_PICK_ORDER_V"" (""TRANSFER_BOX_NO"", ""WMS_INOUT_ID"", ""MAKE_DATE"", ""BOX_ROWS"", ""PICK_TYPE"", ""PICK_LINE"", ""PICK_STATUS"", ""PICKER"", ""LINE_NAME"", ""BIND_DATE"", ""CLIENT_ID"", ""CLIENT_NAME"", ""PARTY_ID"", ""PARTY_NAME"", ""OWNER_GOODS_ID"", ""GOODS_ID"", ""GOODS_NAME"", ""GOODS_CODE"", ""GOODS_DESC"", ""LOT_ID"", ""LOT_NO"", ""PACKAGE_ID"", ""PACKAGE_NAME"", ""PACKAGE_NUM"", ""CASE_QTY"", ""ODD_QTY"", ""SEND_ADDRESS_ID"", ""ADDRESS_NAME"", ""FIELD1"", ""FIELD2"", ""FIELD3"", ""WAREHID"") AS 
  select to_char(nvl(d.containerno, b.inoutid)) TRANSFER_BOX_NO, --容器编码
       b.inoutid WMS_INOUT_ID, --物流出入库单ID
       b.credate MAKE_DATE, --生成时间
       decode(b.boxdocid, null, 1, c.dtllines) BOX_ROWS, --箱内明细行数
       decode(b.boxdocid, null, 'C', 'A') PICK_TYPE, --业务类型
       q.pickflowname PICK_LINE, --拣货流水线
       'TRUE' PICK_STATUS, --拣配状态  TRUE/FALSE
       e.employeename PICKER, --拣货人
       p.routename LINE_NAME, --路线名称
       decode(b.boxdocid, null, b.credate, c.binddate) BIND_DATE, --绑定时间
       b.companyid CLIENT_ID, --出库单位ID
       g.companyname CLIENT_NAME, --客户名称
       b.goodsownerid PARTY_ID, --货主ID 统一名称
       k.goodsownername PARTY_NAME, --货主名称
       b.ownergoodsid OWNER_GOODS_ID, --货主货品ID
       b.goodsid GOODS_ID, --货品主档ID
       p.goodsname GOODS_NAME, --货品名称
       p.goodsownid GOODS_CODE, --货品编号 货主原货品ID 统一名称
       p.goodstype GOODS_DESC, --货品规格
       b.lotid LOT_ID, --批号ID
       m.lotno LOT_NO, --批号
       n.ownerpackid PACKAGE_ID, --包装ID
       n.packname PACKAGE_NAME, --包装单位
       n.packsize PACKAGE_NUM, --包装数量
       decode(b.boxdocid, null, nvl(b.goodsqty, 0), 0) CASE_QTY, --整件数量
       decode(b.boxdocid, null, 0, nvl(b.goodsqty, 0)) ODD_QTY, --散件数量
       f.transid SEND_ADDRESS_ID, --运输地址ID
       o.address ADDRESS_NAME, --实际收货地址
       to_char(b.inoutid) FIELD1, --冗余字段1
       '' FIELD2, --冗余字段2
       '' FIELD3, --冗余字段3
       b.warehid
  from wms_st_io_doc       b,
       wms_turnbox_doc     c,
       wms_container_def   d,
       pub_employee        e,
       wms_wave_dtl        f,
       tpl_go_company      g,
       tpl_goodsowner      k,
       tpl_goods           p,
       wms_goods_lot       m,
       tpl_goods_packs     n,
       wms_pickflow        q,
       wms_transport_address o,
       wms_tr_route          p
 where b.boxdocid = c.boxdocid(+)
   and c.containerid = d.containerid(+)
   and b.rfmanid = e.employeeid(+)
   and c.wavedtlid = f.wavedtlid(+)
   and b.companyid = g.companyid(+)
   and b.goodsownerid = k.goodsownerid(+)
   and b.ownergoodsid = p.ownergoodsid(+)
   and b.lotid = m.lotid
   and (b.goodspackid = n.goodspackid and b.ownergoodsid = n.ownergoodsid)
   and c.pickflowid = q.pickflowid(+)
   and b.comefrom = 3
   and b.inoutflag = 1
   and f.transid=o.transid(+)
   and f.routeid=p.routeid(+)
   and k.iwcs_flag=1
   and  exists (select x.sectionid
          from wms_st_section_def x
         where x.sectionid = b.sectionid
           and nvl(x.iwcs_flag, 0) = 1)
"
"INTER_SUPPLYER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_SUPPLYER_V"" (""PARTY_ID"", ""VENDER_ID"", ""OPER_CODE"", ""VENDER_CODE"", ""VENDER_NAME"", ""VENDER_ADDRESS"", ""LINK_MAN"", ""LINK_PHONE"", ""INPT_DATE"", ""EXEC_DATE"", ""EXEC_FLAG"", ""VENDER_STATUS"", ""VENDER_TYPE"") AS 
  select a.goodsownerid PARTY_ID, --货主ID
       a.companyid VENDER_ID, --货主供应商ID，唯一主键
       decode(a.modify_date,null,'00','10') OPER_CODE, -- 操作代码，00新增，10更新 99作废
       a.gcompanyid VENDER_CODE, -- 对方供应商编码，货主原供应商ID
       replace(a.companyname,chr(9),'') VENDER_NAME, -- 供应商名称
       replace(nvl(a.deliveraddress, b.supplieraddress),chr(9),'') VENDER_ADDRESS, -- 地址
       replace(nvl(a.connector, b.connector),chr(9),'') LINK_MAN, -- 联系人
       replace(nvl(a.connphone, b.telephone),chr(9),'') LINK_PHONE, -- 电话
       sysdate INPT_DATE, -- 导入时间
       null EXEC_DATE, --处理时间
       'NEW' EXEC_FLAG, -- 处理状态
       decode(a.usestatus, 1, 'TRUE', 'FALSE') VENDER_STATUS, --供应商状态 TRUE/FALSE
       'VENDOR' VENDER_TYPE --供应商类型 VENDOR
  from tpl_go_company a, tpl_pub_company b
 where a.warecid = b.companyid
   --and nvl(b.supplierflag, 0) = 1
   and nvl(a.companystyle,-1)=2 --add by xyue 2020-04-16 供应商
   and nvl(a.modify_date, sysdate) > nvl(a.iwcs_date, sysdate - 1)
   and exists (select 1 from tpl_goodsowner_to_warehouse x where x.goodsownerid=a.goodsownerid and x.warehid=1)
   and exists (select c.goodsownerid
          from tpl_goodsowner c
         where c.goodsownerid = a.goodsownerid
           and nvl(c.iwcs_flag, 0) = 1)
"
"INTER_SUPPLYER_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_SUPPLYER_V1"" (""PARTY_ID"", ""VENDER_ID"", ""OPER_CODE"", ""VENDER_CODE"", ""VENDER_NAME"", ""VENDER_ADDRESS"", ""LINK_MAN"", ""LINK_PHONE"", ""INPT_DATE"", ""EXEC_DATE"", ""EXEC_FLAG"", ""VENDER_STATUS"", ""VENDER_TYPE"") AS 
  select a.goodsownerid PARTY_ID, --货主ID
       a.companyid VENDER_ID, --货主供应商ID，唯一主键
       decode(a.modify_date,null,'00','10') OPER_CODE, -- 操作代码，00新增，10更新 99作废
       a.gcompanyid VENDER_CODE, -- 对方供应商编码，货主原供应商ID
       replace(a.companyname,chr(9),'') VENDER_NAME, -- 供应商名称
       replace(nvl(a.deliveraddress, b.supplieraddress),chr(9),'') VENDER_ADDRESS, -- 地址
       replace(nvl(a.connector, b.connector),chr(9),'') LINK_MAN, -- 联系人
       replace(nvl(a.connphone, b.telephone),chr(9),'') LINK_PHONE, -- 电话
       sysdate INPT_DATE, -- 导入时间
       null EXEC_DATE, --处理时间
       'NEW' EXEC_FLAG, -- 处理状态
       decode(a.usestatus, 1, 'TRUE', 'FALSE') VENDER_STATUS, --供应商状态 TRUE/FALSE
       'VENDOR' VENDER_TYPE --供应商类型 VENDOR
  from tpl_go_company a, tpl_pub_company b
 where a.warecid = b.companyid
   --and nvl(b.supplierflag, 0) = 1
   and nvl(a.companystyle,-1)=2 --add by xyue 2020-04-16 供应商
   and nvl(a.modify_date, sysdate) > nvl(a.iwcs_date, sysdate - 1)
   and exists (select 1 from tpl_goodsowner_to_warehouse x where x.goodsownerid=a.goodsownerid and x.goodsownerid <> 9156 and x.warehid=17)
   and exists (select c.goodsownerid
          from tpl_goodsowner c
         where c.goodsownerid = a.goodsownerid
           and nvl(c.iwcs_flag, 0) = 1)
"
"INTER_TRADE_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_TRADE_DTL_V"" (""TRADEID"", ""TRADEDTLID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""PRODAREA"", ""GOODSNO"", ""TRADEPACKNAME"", ""FROMLOTID"", ""FROMLOTNO"", ""FROMVALIDDATE"", ""FROMPRODDATE"", ""TOLOTID"", ""TOLOTNO"", ""TOVALIDDATE"", ""TOPRODDATE"", ""FROMBATCHNO"", ""TOBATCHNO"", ""FROMSECTIONID"", ""FROMSECTIONNO"", ""FROMSECTIONNAME"", ""TOSECTIONID"", ""TOSECTIONNO"", ""TOSECTIONNAME"", ""FROMPOSID"", ""FROMPOSNO"", ""FROMPOSNAME"", ""TOPOSID"", ""TOPOSNO"", ""TOPOSNAME"", ""FROMGOODSSTATUSID"", ""FROMGOODSSTATUS"", ""FROMQUANSTATUS"", ""TOGOODSSTATUSID"", ""TOGOODSSTATUS"", ""TOQUANSTATUS"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""PRINTLINE"", ""PRINTNO"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""QTY"", ""PRINTFLAG"", ""SRCPROCDTLID"", ""PROCFLAG"", ""USESTATUS"", ""DTLUSESTATUS"", ""DTLMEMO"", ""GOODSOWNID"", ""DTLMEMO1"", ""OWNERPACKID"", ""APPROVEDOCNO"", ""MAH"", ""TOFACTNAME"", ""TOAPPROVEDOCNO"", ""TOMAH"", ""CONTAINERNO"", ""SOURCERECEIVEID"") AS 
  select a.tradeid,
       a.tradedtlid,
       a.ownergoodsid,
       a.goodsid,
       b.opcode goodsopcode,
       b.goodsname,
       b.goodstype,
       nvl(d.factname,b.factname) factname,
       b.prodarea,
       b.goodsno,
       b.tradepackname,
       a.fromlotid,
       d.lotno fromlotno,
       e.validdate fromvaliddate,
       d.proddate fromproddate,
       a.tolotid,
       e.lotno tolotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) tovaliddate,
       e.proddate toproddate,
       a.frombatchno,
       a.tobatchno,
       a.fromsectionid,
       k.sectionno fromsectionno,
       k.sectionname fromsectionname,
       a.tosectionid,
       l.sectionno tosectionno,
       l.sectionname tosectionname,
       a.fromposid,
       f.posno fromposno,
       f.posname fromposname,
       a.toposid,
       g.posname toposno,
       g.posname toposname,
       a.fromgoodsstatusid,
       h.goodsstatus fromgoodsstatus,
       a.fromquanstatus,
       a.togoodsstatusid,
       i.goodsstatus togoodsstatus,
       a.toquanstatus,
       a.tradegoodsqty,
       a.tradegoodspack,
       a.printline,
       a.printno,
       a.goodspackid,
       j.packname,
       j.packsize,
       a.qty,
       decode(a.printflag, null, null, 1) printflag,
       a.srcprocdtlid,
       a.procflag,
       a.usestatus,
       a.usestatus dtlusestatus,
       a.dtlmemo,
       b.goodsownid,
       a.dtlmemo1, --add by xyue 2019-04-26 用于判断不合格时备注必填使用
       j.ownerpackid,
       d.approvedocno,
       d.mah,
       e.factname tofactname,
       e.approvedocno toapprovedocno,
       e.mah tomah,
       a.containerno,
       a.sourcereceiveid
  from wms_trade_dtl       a,
       tpl_pub_goods       c,
       wms_goods_lot       d,
       wms_goods_lot       e,
       wms_pos_def         f,
       wms_pos_def         g,
       wms_goodsstatus     h,
       wms_goodsstatus     i,
       tpl_goods_packs     j,
       wms_st_section_def  k,
       wms_st_section_def  l,
       tpl_goods           b
 where a.goodsid = c.goodsid
   and a.fromlotid = d.lotid(+)
   and a.tolotid = e.lotid(+)
   and a.fromposid = f.posid(+)
   and a.toposid = g.posid(+)
   and a.fromgoodsstatusid = h.goodsstatusid(+)
   and a.togoodsstatusid = i.goodsstatusid(+)
   and (a.goodspackid = j.goodspackid(+) and a.ownergoodsid = j.ownergoodsid)
   and a.fromsectionid = k.sectionid(+)
   and a.tosectionid = l.sectionid(+)
   and a.ownergoodsid = b.ownergoodsid(+)
   and (nvl(k.iwcs_flag,0) = 1 or nvl(l.iwcs_flag,0) = 1)
"
"INTER_TRADE_DTL_XYUE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_TRADE_DTL_XYUE_V"" (""TRADEID"", ""TRADEDTLID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""PRODAREA"", ""GOODSNO"", ""TRADEPACKNAME"", ""FROMLOTID"", ""FROMLOTNO"", ""FROMVALIDDATE"", ""FROMPRODDATE"", ""TOLOTID"", ""TOLOTNO"", ""TOVALIDDATE"", ""TOPRODDATE"", ""FROMBATCHNO"", ""TOBATCHNO"", ""FROMSECTIONID"", ""FROMSECTIONNO"", ""FROMSECTIONNAME"", ""TOSECTIONID"", ""TOSECTIONNO"", ""TOSECTIONNAME"", ""FROMPOSID"", ""FROMPOSNO"", ""FROMPOSNAME"", ""TOPOSID"", ""TOPOSNO"", ""TOPOSNAME"", ""FROMGOODSSTATUSID"", ""FROMGOODSSTATUS"", ""FROMQUANSTATUS"", ""TOGOODSSTATUSID"", ""TOGOODSSTATUS"", ""TOQUANSTATUS"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""PRINTLINE"", ""PRINTNO"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""QTY"", ""PRINTFLAG"", ""SRCPROCDTLID"", ""PROCFLAG"", ""USESTATUS"", ""DTLUSESTATUS"", ""DTLMEMO"", ""GOODSOWNID"", ""DTLMEMO1"", ""OWNERPACKID"", ""APPROVEDOCNO"", ""MAH"", ""TOFACTNAME"", ""TOAPPROVEDOCNO"", ""TOMAH"", ""CONTAINERNO"") AS 
  select a.tradeid,
       a.tradedtlid,
       a.ownergoodsid,
       a.goodsid,
       b.opcode goodsopcode,
       b.goodsname,
       b.goodstype,
       d.factname,
       b.prodarea,
       b.goodsno,
       b.tradepackname,
       a.fromlotid,
       d.lotno fromlotno,
       e.validdate fromvaliddate,
       d.proddate fromproddate,
       a.tolotid,
       e.lotno tolotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) tovaliddate,
       e.proddate toproddate,
       a.frombatchno,
       a.tobatchno,
       a.fromsectionid,
       k.sectionno fromsectionno,
       k.sectionname fromsectionname,
       a.tosectionid,
       l.sectionno tosectionno,
       l.sectionname tosectionname,
       a.fromposid,
       f.posno fromposno,
       f.posname fromposname,
       a.toposid,
       g.posname toposno,
       g.posname toposname,
       a.fromgoodsstatusid,
       h.goodsstatus fromgoodsstatus,
       a.fromquanstatus,
       a.togoodsstatusid,
       i.goodsstatus togoodsstatus,
       a.toquanstatus,
       a.tradegoodsqty,
       a.tradegoodspack,
       a.printline,
       a.printno,
       a.goodspackid,
       j.packname,
       j.packsize,
       a.qty,
       decode(a.printflag, null, null, 1) printflag,
       a.srcprocdtlid,
       a.procflag,
       a.usestatus,
       a.usestatus dtlusestatus,
       a.dtlmemo,
       b.goodsownid,
       a.dtlmemo1, --add by xyue 2019-04-26 用于判断不合格时备注必填使用
       j.ownerpackid,
       d.approvedocno,
       d.mah,
       e.factname tofactname,
       e.approvedocno toapprovedocno,
       e.mah tomah,
       a.containerno
  from wms_trade_dtl       a,
       tpl_pub_goods       c,
       wms_goods_lot       d,
       wms_goods_lot       e,
       wms_pos_def         f,
       wms_pos_def         g,
       wms_goodsstatus     h,
       wms_goodsstatus     i,
       tpl_goods_packs     j,
       wms_st_section_def  k,
       wms_st_section_def  l,
       tpl_goods           b
 where a.goodsid = c.goodsid
   and a.fromlotid = d.lotid(+)
   and a.tolotid = e.lotid(+)
   and a.fromposid = f.posid(+)
   and a.toposid = g.posid(+)
   and a.fromgoodsstatusid = h.goodsstatusid(+)
   and a.togoodsstatusid = i.goodsstatusid(+)
   and (a.goodspackid = j.goodspackid(+) and a.ownergoodsid = j.ownergoodsid)
   and a.fromsectionid = k.sectionid(+)
   and a.tosectionid = l.sectionid(+)
   and a.ownergoodsid = b.ownergoodsid(+)
   --and (nvl(k.iwcs_flag,0) = 1 or nvl(l.iwcs_flag,0) = 1)
"
"INTER_TRADE_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_TRADE_ORDER_V"" (""INPT_REPLENISH_ID"", ""WAVE_NBR"", ""BILL_ID"", ""BILL_LINES_ID"", ""BILL_TYPE"", ""CASE_NBR"", ""IS_CHANGE"", ""PARTY_ID"", ""PARTY_NAME"", ""OWNER_GOODS_ID"", ""COM_INVENTORY_TYPE_ID"", ""GOODS_ID"", ""GOODS_CODE"", ""GOODS_NAME"", ""GOODS_DESC"", ""PRODUCT_LOCATION"", ""UNIT_NAME"", ""REPLENISH_QTY"", ""REPLENISH_TYPE"", ""EXEC_QTY"", ""FROM_DEPOT_ID"", ""FROM_DEPOT_NAME"", ""FROM_STOCK_POS_ID"", ""FROM_STOCK_POS_NAME"", ""TO_DEPOT_ID"", ""TO_DEPOT_NAME"", ""TO_STOCK_POS_ID"", ""TO_STOCK_POS_NAME"", ""COM_LOT_ID"", ""LOT_NO"", ""PACKAGE_ID"", ""PACKAGE_NAME"", ""PACKAGE_NUM"", ""PRODUCT_DATE"", ""EXPIRE_DATE"", ""IMP_DATE"", ""EXEC_MEMO"", ""EXEC_FLAG"", ""EXEC_DATE"", ""GOODS_MAH"", ""REG_MARK_NO"", ""MAKER"", ""WAREHID"") AS 
  select b.tradedtlid INPT_REPLENISH_ID, --  NUMBER  补货任务ID
       nvl(to_char(a.sourceid), to_char(a.tradeid)) WAVE_NBR, --  VARCHAR2(30)  波次ID
       to_char(a.tradeid) BILL_ID, --  VARCHAR2(20)  补货单ID
       to_char(b.tradedtlid) BILL_LINES_ID, --  VARCHAR2(20)  补货明细ID
       --'2' BILL_TYPE, --  VARCHAR2(20)  补货类型 1 楼层库补多穿 2 自动库移出到平库（隔离）
       --decode(nvl(c.iwcs_flag,0),1,'1','2') BILL_TYPE,-- change by xyue 2020-04-20
       (case
         when c.iwcs_flag = 1 then
          1
         when e.iwcs_flag = 1 then
          2
         else
          0
       end) BILL_TYPE,
       --b.tradedtlid CASE_NBR, --  NUMBER  箱号  用于输送识别的箱条码
       nvl(b.containerno, to_char(b.tradedtlid)) CASE_NBR,
       decode(a.subtype, 1, 'Y', 'N') IS_CHANGE, --  VARCHAR2(10)  是否倒箱 Y/N 业务类型是补货的才是Y
       a.goodsownerid PARTY_ID, --  NUMBER  货主ID 统一名称
       a.goodsownername PARTY_NAME, --  VARCHAR2(200)  货主名称 统一名称
       b.ownergoodsid OWNER_GOODS_ID, --  NUMBER  货主货品ID
       b.fromgoodsstatusid COM_INVENTORY_TYPE_ID, --NUMBER 货品状态ID
       b.goodsid GOODS_ID, --  INTEGER  商品ID 货品主档ID
       b.goodsownid GOODS_CODE, --  VARCHAR2(30)  商品编码 货主原货品ID
       replace(b.goodsname,chr(9),'') GOODS_NAME, --  VARCHAR2(300)  商品名称
       replace(b.goodstype,chr(9),'') GOODS_DESC, --  VARCHAR2(300)  规格
       replace(b.factname,chr(9),'') PRODUCT_LOCATION, --  VARCHAR2(300)  生产厂家
       b.tradepackname UNIT_NAME, --  VARCHAR2(20)  单位
       b.qty REPLENISH_QTY, --  NUMBER  应补数量
       --'C' REPLENISH_TYPE, --  VARCHAR2(20)  补货类型A 散货 C整箱 P托盘(目前托盘前缀是1，料箱是2，测试是3)
       (case
         when substr(b.containerno, 0, 1) = '1' then
          'P'
         when substr(b.containerno, 0, 1) = '2' then
          'A'
         else
          'C'
       end) REPLENISH_TYPE,
       b.qty EXEC_QTY, --  NUMBER  实补数量
       b.fromsectionid FROM_DEPOT_ID, --  NUMBER  来源库区
       b.fromsectionname FROM_DEPOT_NAME, --  VARCHAR2(30)  来源库区名称
       b.fromposid FROM_STOCK_POS_ID, --  INTEGER  来源货位ID
       b.fromposname FROM_STOCK_POS_NAME, --  VARCHAR2(20)  来源货位名称
       b.tosectionid TO_DEPOT_ID, --  NUMBER  补货库区
       b.tosectionname TO_DEPOT_NAME, --  VARCHAR2(30)  补货库区名称
       b.toposid TO_STOCK_POS_ID, --  INTEGER  补货货位ID
       b.toposname TO_STOCK_POS_NAME, --  VARCHAR2(20)  补货货位名称
       b.fromlotid COM_LOT_ID, --  INTEGER  批次ID
       replace(b.fromlotno,chr(9),'') LOT_NO, --  VARCHAR2(30)  批号
       b.ownerpackid PACKAGE_ID, --  NUMBER  包装ID
       b.packname PACKAGE_NAME, --  VARCHAR2(00)  包装单位
       b.packsize PACKAGE_NUM, --  VARCHAR2(200)  包装数量
       b.fromproddate PRODUCT_DATE, --  DATE  生产日期
       b.fromvaliddate EXPIRE_DATE, --  DATE  有效期
       a.tradedate IMP_DATE, --  DATE  生成时间
       a.memo EXEC_MEMO, -- VARCHAR2(300) 备注
       'NEW' EXEC_FLAG, --  VARCHAR2(20)  执行状态   NEW
       NULL EXEC_DATE, --  DATE  执行时间   NULL
       replace(b.mah,chr(9),'') GOODS_MAH,
       replace(b.approvedocno,chr(9),'') REG_MARK_NO,
       f.employeename MAKER, --库内移位单的录入人
       a.warehid
  from wms_trade_order_v  a,
       inter_trade_dtl_v  b,
       wms_st_section_def c,
       tpl_goodsowner     d,
       wms_st_section_def e,
       pub_employee       f
 where a.TRADEID = b.tradeid
   and a.operationtype in (29, 28)
   and b.fromposid <> b.toposid
   and b.fromsectionid = e.sectionid(+)
   and b.fromsectionid <> b.tosectionid
   and b.tosectionid = c.sectionid(+)
   and a.GOODSOWNERID = d.goodsownerid(+)
   and a.inputmanid = f.employeeid(+)
   --and (a.executetype,a.billfrom) not in ((1,1))
   and d.iwcs_flag = 1
"
"INTER_TRADE_ORDER_XYUE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""INTER_TRADE_ORDER_XYUE_V"" (""INPT_REPLENISH_ID"", ""WAVE_NBR"", ""BILL_ID"", ""BILL_LINES_ID"", ""BILL_TYPE"", ""CASE_NBR"", ""IS_CHANGE"", ""PARTY_ID"", ""PARTY_NAME"", ""OWNER_GOODS_ID"", ""COM_INVENTORY_TYPE_ID"", ""GOODS_ID"", ""GOODS_CODE"", ""GOODS_NAME"", ""GOODS_DESC"", ""PRODUCT_LOCATION"", ""UNIT_NAME"", ""REPLENISH_QTY"", ""REPLENISH_TYPE"", ""EXEC_QTY"", ""FROM_DEPOT_ID"", ""FROM_DEPOT_NAME"", ""FROM_STOCK_POS_ID"", ""FROM_STOCK_POS_NAME"", ""TO_DEPOT_ID"", ""TO_DEPOT_NAME"", ""TO_STOCK_POS_ID"", ""TO_STOCK_POS_NAME"", ""COM_LOT_ID"", ""LOT_NO"", ""PACKAGE_ID"", ""PACKAGE_NAME"", ""PACKAGE_NUM"", ""PRODUCT_DATE"", ""EXPIRE_DATE"", ""IMP_DATE"", ""EXEC_MEMO"", ""EXEC_FLAG"", ""EXEC_DATE"", ""GOODS_MAH"", ""REG_MARK_NO"") AS 
  select b.tradedtlid INPT_REPLENISH_ID, --  NUMBER  补货任务ID
       nvl(to_char(a.sourceid),to_char(a.tradeid)) WAVE_NBR, --  VARCHAR2(30)  波次ID
       to_char(a.tradeid) BILL_ID, --  VARCHAR2(20)  补货单ID
       to_char(b.tradedtlid) BILL_LINES_ID, --  VARCHAR2(20)  补货明细ID
       --'2' BILL_TYPE, --  VARCHAR2(20)  补货类型 1 楼层库补多穿 2 自动库移出到平库（隔离）
       --decode(nvl(c.iwcs_flag,0),1,'1','2') BILL_TYPE,-- change by xyue 2020-04-20
       (case when c.iwcs_flag=1 then 1
        when e.iwcs_flag=1 then 2 else 0 end) BILL_TYPE,
       --b.tradedtlid CASE_NBR, --  NUMBER  箱号  用于输送识别的箱条码
       b.containerno CASE_NBR,
       'N' IS_CHANGE, --  VARCHAR2(10)  是否倒箱 Y/N
       a.goodsownerid PARTY_ID, --  NUMBER  货主ID 统一名称
       a.goodsownername PARTY_NAME, --  VARCHAR2(200)  货主名称 统一名称
       b.ownergoodsid OWNER_GOODS_ID, --  NUMBER  货主货品ID
       --b.fromgoodsstatusid COM_INVENTORY_TYPE_ID, --NUMBER 货品状态ID
       1 COM_INVENTORY_TYPE_ID, --NUMBER 货品状态ID
       b.goodsid GOODS_ID, --  INTEGER  商品ID 货品主档ID
       b.goodsownid GOODS_CODE, --  VARCHAR2(30)  商品编码 货主原货品ID
       b.goodsname GOODS_NAME, --  VARCHAR2(300)  商品名称
       b.goodstype GOODS_DESC, --  VARCHAR2(300)  规格
       b.factname PRODUCT_LOCATION, --  VARCHAR2(300)  生产厂家
       b.tradepackname UNIT_NAME, --  VARCHAR2(20)  单位
       b.qty REPLENISH_QTY, --  NUMBER  应补数量
       --'C' REPLENISH_TYPE, --  VARCHAR2(20)  补货类型A 散货 C整箱 P托盘(目前托盘前缀是1，料箱是2，测试是3)
       (case when substr(b.containerno, 0, 1)='1' then 'P'
             when  substr(b.containerno, 0, 1)='2' then 'A'
        else 'C' end) REPLENISH_TYPE,
       b.qty EXEC_QTY, --  NUMBER  实补数量
       b.fromsectionid FROM_DEPOT_ID, --  NUMBER  来源库区
       b.fromsectionname FROM_DEPOT_NAME, --  VARCHAR2(30)  来源库区名称
       b.fromposid FROM_STOCK_POS_ID, --  INTEGER  来源货位ID
       b.fromposname FROM_STOCK_POS_NAME, --  VARCHAR2(20)  来源货位名称
       b.tosectionid TO_DEPOT_ID, --  NUMBER  补货库区
       b.tosectionname TO_DEPOT_NAME, --  VARCHAR2(30)  补货库区名称
       b.toposid TO_STOCK_POS_ID, --  INTEGER  补货货位ID
       b.toposname TO_STOCK_POS_NAME, --  VARCHAR2(20)  补货货位名称
       b.fromlotid COM_LOT_ID, --  INTEGER  批次ID
       b.fromlotno LOT_NO, --  VARCHAR2(30)  批号
       b.ownerpackid PACKAGE_ID, --  NUMBER  包装ID
       b.packname PACKAGE_NAME, --  VARCHAR2(00)  包装单位
       b.packsize PACKAGE_NUM, --  VARCHAR2(200)  包装数量
       b.fromproddate PRODUCT_DATE, --  DATE  生产日期
       b.fromvaliddate EXPIRE_DATE, --  DATE  有效期
       a.tradedate IMP_DATE, --  DATE  生成时间
        a.memo EXEC_MEMO, -- VARCHAR2(300) 备注
       'NEW' EXEC_FLAG, --  VARCHAR2(20)  执行状态   NEW
       NULL EXEC_DATE, --  DATE  执行时间   NULL
        b.mah      GOODS_MAH,
        b.approvedocno REG_MARK_NO
  from wms_trade_order_v a, inter_trade_dtl_xyue_v b,wms_st_section_def c,tpl_goodsowner d,wms_st_section_def e
 where a.TRADEID = b.tradeid
   and a.operationtype in (29, 28)
   and b.fromposid <> b.toposid
   and b.fromsectionid=e.sectionid(+)
   and b.tosectionid=c.sectionid(+)
   and a.GOODSOWNERID=d.goodsownerid(+)
   --and d.iwcs_flag=1
"
"IWCS_GSP_ST_IO_RECORD_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""IWCS_GSP_ST_IO_RECORD_V"" (""SSC_PICKING_CARTON_ID"", ""INOUTID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""DRUGFORM"", ""MAH"", ""STORAGECONDITION"", ""PACKAGE_ID"", ""PACKNAME"", ""PACKSIZE"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""OPERATIONTYPE"", ""GOODSSTATUSID"", ""QUANTITYSTATUS"", ""GOODSSTATUS"", ""CARTON_TYPE"", ""AREANAME"", ""GOODSQTY"", ""CARTON_BOX"", ""CARTON_NUM"", ""PICKERID"", ""PICKERNAME"", ""PICKDATE"", ""PICK_STATUS"", ""CHECKERID"", ""CHECKERNAME"", ""CHECKDATE"", ""CHECK_STATUS"") AS 
  select t.ssc_picking_carton_id, --IWCS任务明细ID
       t.inoutid, --WMS出入库ID
       t.goodsownerid,
       a.goodsownername,
       t.companyid,
       b.companyname,
       t.ownergoodsid,
       c.waregoodsid goodsid,
       c.goodsownid,
       c.goodsname,
       c.goodsengname,
       c.goodstype,
       c.tradepackname,
       c.factname,
       c.prodarea,
       c.drugform,
       c.mah,
       c.storagecondition,
       t.package_id,
       e.packname,
       e.packsize,
       t.lotid,
       d.lotno,
       d.proddate,
       d.validdate,
       d.approvedocno,
       (select tt.operationtype
          from wms_st_io_doc tt
         where tt.inoutid = t.inoutid
           and tt.comefrom in (2, 3)) operationtype,
       (select x.goodsstatusid
          from wms_st_io_doc x
         where x.inoutid = t.inoutid
           and x.comefrom in (2, 3)) goodsstatusid,
       (select y.quantitystatus
          from wms_st_io_doc y
         where y.inoutid = t.inoutid
           and y.comefrom in (2, 3)) quantitystatus,
       (select zz.goodsstatus
          from wms_st_io_doc z, wms_goodsstatus zz
         where z.inoutid = t.inoutid
           and z.comefrom in (2, 3)
           and z.goodsstatusid = zz.goodsstatusid(+)) goodsstatus,
       t.carton_type, --IWCS任务类型
       t.areaname,
       t.goodsqty, --任务数量
       t.carton_box, --整件、整托件数
       t.carton_num, --散件复核箱号
       t.pickerid, --拣货人ID
       t.pickername,
       t.pickdate, --拣货时间
       t.pick_status, --拣货状态
       t.checkerid, --复核人ID
       t.checkername,
       t.checkdate, --复核时间
       t.check_status --复核状态
  from iwcs_outcheck_record_v@iwcs t,
       tpl_goodsowner              a,
       tpl_go_company              b,
       tpl_goods                   c,
       wms_goods_lot               d,
       tpl_goods_packs             e
 where t.goodsownerid = a.goodsownerid(+)
   and t.companyid = b.companyid(+)
   and t.ownergoodsid = c.ownergoodsid(+)
   and t.lotid = d.lotid(+)
   and t.package_id = e.ownerpackid(+)
"
"IWCS_IN_ORDER_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""IWCS_IN_ORDER_DTL_V"" (""RECEIVEID"", ""SCAN_TIME"", ""UPLOAD_TIME"", ""SSC_RECEIVE_GOODS_LINES_ID"", ""BIND_NUM"", ""REC_QTY"", ""TOOL_CODE"", ""CASE_LOCATION"") AS 
  select a.external_bill_lines_id receiveid,
       --b.com_inv_case_id,
       b.scan_time,
       b.upload_time,
       a.ssc_receive_goods_lines_id,
       a.bind_num,
       b.rec_qty,
       b.tool_code,
       b.case_location
  from ssc_receive_goods_lines@iwcs a,
       com_inv_case@iwcs b
 where a.receive_qty>0
 and a.ssc_receive_goods_lines_id=b.ssc_rec_goods_lines_id
"
"IWCS_IN_ORDER_TEST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""IWCS_IN_ORDER_TEST_V"" (""INID"", ""ZXCOLUMN4"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""SOURCECOMPANYID"", ""OPERATIONTYPE"", ""PORDERSTATUS"", ""COMPANYNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""MAH"", ""LOTFACTNAME"", ""RECEIVEID"", ""DTLUSESTATUS"", ""GOODSSTATUSID"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""CHECKDATE"", ""IWCS_STATUS"", ""IWCS_DATE"", ""IWCS_MSG"", ""INPUTMANID"", ""INPUTMAN"", ""CONTAINERNO"", ""INDTLID"", ""RECEIVE_DATE"", ""STATUS"") AS 
  select a.inid,
       a.zxcolumn4,
       a.credate,
       a.goodsownerid,
       j.goodsownername,
       a.sourcecompanyid,
       a.operationtype,
       b.porderstatus,
       d.companyname,
       b.ownergoodsid,
       b.goodsid,
       e.goodsownid,
       e.goodsname,
       e.goodsengname,
       e.goodstype,
       e.tradepackname,
       e.factname,
       c.lotid,
       f.lotno,
       decode(to_char(f.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              f.validdate) validdate,
       to_char(f.proddate, 'yyyy-mm-dd') proddate,
       f.approvedocno,
       f.mah,
       f.factname lotfactname,
       c.receiveid,
       c.usestatus dtlusestatus,
       c.goodsstatusid,
       c.goodspackid,
       g.packname,
       g.packsize,
       c.goodsqty,
       c.checkdate,
       decode(nvl(c.iwcs_status,0),0,0,1) iwcs_status,
       c.iwcs_date,
       c.iwcs_msg,
       c.inputmanid,
       h.employeename inputman,
       i.containerno,
       b.indtlid,
       (select aa.receive_date
          from ssc_receive_interface_lines@iwcstest1 aa
         where aa.external_bill_lines_id = c.receiveid
           and aa.receive_qty > 0) receive_date,
       (select aa.status
          from ssc_receive_interface_lines@iwcstest1 aa
         where aa.external_bill_lines_id = c.receiveid
           and aa.receive_qty > 0) status
  from wms_in_order        a,
       wms_in_order_dtl    b,
       wms_receive_dtl     c,
       tpl_go_company      d,
       tpl_goods           e,
       wms_goods_lot       f,
       tpl_pub_goods_packs g,
       pub_employee        h,
       wms_container_def   i,
       tpl_goodsowner      j
 where a.inid = b.inid
   and b.indtlid = c.indtlid
   and b.indtlid = c.indtlid
   and a.goodsownerid=j.goodsownerid(+)
   and a.sourcecompanyid = d.companyid(+)
   and b.ownergoodsid = e.ownergoodsid(+)
   and c.lotid = f.lotid(+)
   and c.goodspackid = g.goodspackid(+)
   and c.inputmanid = h.employeeid(+)
   and c.containerid = i.containerid(+)
   and c.sectionid in (8295,8515)
"
"IWCS_IN_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""IWCS_IN_ORDER_V"" (""INID"", ""ZXCOLUMN4"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""SOURCECOMPANYID"", ""OPERATIONTYPE"", ""PORDERSTATUS"", ""COMPANYNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""MAH"", ""LOTFACTNAME"", ""RECEIVEID"", ""DTLUSESTATUS"", ""GOODSSTATUSID"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""CHECKDATE"", ""IWCS_STATUS"", ""IWCS_DATE"", ""IWCS_MSG"", ""INPUTMANID"", ""INPUTMAN"", ""CONTAINERNO"", ""INDTLID"", ""RECEIVE_DATE"", ""STATUS"") AS 
  select a.inid,
       a.zxcolumn4,
       a.credate,
       a.goodsownerid,
       j.goodsownername,
       a.sourcecompanyid,
       a.operationtype,
       b.porderstatus,
       d.companyname,
       b.ownergoodsid,
       b.goodsid,
       e.goodsownid,
       e.goodsname,
       e.goodsengname,
       e.goodstype,
       e.tradepackname,
       e.factname,
       c.lotid,
       f.lotno,
       decode(to_char(f.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              f.validdate) validdate,
       to_char(f.proddate, 'yyyy-mm-dd') proddate,
       f.approvedocno,
       f.mah,
       f.factname lotfactname,
       c.receiveid,
       c.usestatus dtlusestatus,
       c.goodsstatusid,
       c.goodspackid,
       g.packname,
       g.packsize,
       c.goodsqty,
       c.checkdate,
       decode(nvl(c.iwcs_status,0),0,0,1) iwcs_status,
       c.iwcs_date,
       c.iwcs_msg,
       c.inputmanid,
       h.employeename inputman,
       i.containerno,
       b.indtlid,
       (select aa.receive_date
          from ssc_receive_interface_lines@iwcs aa
         where aa.external_bill_lines_id = c.receiveid
           and aa.receive_qty > 0) receive_date,
       (select aa.status
          from ssc_receive_interface_lines@iwcs aa
         where aa.external_bill_lines_id = c.receiveid
           and aa.receive_qty > 0) status
  from wms_in_order        a,
       wms_in_order_dtl    b,
       wms_receive_dtl     c,
       tpl_go_company      d,
       tpl_goods           e,
       wms_goods_lot       f,
       tpl_pub_goods_packs g,
       pub_employee        h,
       wms_container_def   i,
       tpl_goodsowner      j
 where a.inid = b.inid
   and b.indtlid = c.indtlid
   and b.indtlid = c.indtlid
   and a.goodsownerid=j.goodsownerid(+)
   and a.sourcecompanyid = d.companyid(+)
   and b.ownergoodsid = e.ownergoodsid(+)
   and c.lotid = f.lotid(+)
   and c.goodspackid = g.goodspackid(+)
   and c.inputmanid = h.employeeid(+)
   and c.containerid = i.containerid(+)
   and c.sectionid in (8295,8515,8916,9235)
"
"IWCS_OUT_ORDER_DTL_CARTON_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""IWCS_OUT_ORDER_DTL_CARTON_V"" (""SSC_SEND_INTERFACE_ID"", ""CARTON_TYPE"", ""CARTON_QTY"", ""CARTON_BOX"", ""CARTON_NUM"", ""PICKER"", ""PICKERNAME"", ""PICK_TIME"", ""PICK_STATUS"", ""CHECKER"", ""CHECKERNAME"", ""CHECK_TIME"", ""CHECK_STATUS"", ""ORDER_CARTON_NBR"", ""WMS_INOUT_ID"", ""USED_TOOL"", ""RTN_CODE"", ""RTN_DATE"", ""TOOL_CODE"", ""LABEL_BARCODE"", ""ODD_CHECK_TIME"") AS 
  select a.ssc_send_interface_id, --IWCS任务明细ID
       decode(a.carton_type,'A',1,'C',2,'P',3,0) carton_type,--IWCS任务类型
       a.carton_qty,--任务数量
       a.carton_box,--整件、整托件数
       a.carton_num,--散件复核箱号
       a.picker,--拣货人ID
       b.employeename pickername,
       a.pick_time,--拣货时间
       decode(a.pick_status,'TRUE',1,0) pick_status,--拣货状态
       a.checker,--复核人ID
       c.employeename checkername,
       a.check_time,--复核时间
       decode(a.check_status,'TRUE',1,0) check_status,--复核状态
       a.order_carton_nbr,--复核台IP地址
       a.wms_inout_id,--WMS出入库ID
       decode(a.carton_type,'A',a.used_tool,null) used_tool,--装箱标志
       decode(a.rtn_code,'000',1,0) rtn_code,--上报反馈标志，000是成功
       a.rtn_date,--上报时间
       a.tool_code,--散件周转箱箱号
       a.label_barcode,--标签条码
       a.odd_check_time --装箱时间
  from ssc_picking_carton@iwcs a,pub_employee b,pub_employee c
 where a.picker=b.employeeid(+)
   and a.checker=c.employeeid(+)
"
"IWCS_OUT_ORDER_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""IWCS_OUT_ORDER_DTL_V"" (""OUTID"", ""OUTDTLID"", ""DTLZXCOLUMN4"", ""INOUTID"", ""CREDATE"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""GOODSPACKID"", ""PACKSIZE"", ""PACKNAME"", ""GOODSQTY"", ""LOTID"", ""LOTNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""SECTIONID"", ""SECTIONNAME"", ""POSID"", ""POSNAME"", ""RFFLAG"", ""USESTATUS"", ""IWCS_FLAG"", ""IWCS_CASE_NBR"", ""IWCSDTLSTATUS"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""WAVEDTLID"") AS 
  select a.outid,
       a.outdtlid,
       a.dtlzxcolumn4,
       c.inoutid,
       c.credate,
       a.ownergoodsid,
       a.goodsid,
       f.goodsownid,
       f.goodsname,
       f.goodsengname,
       f.goodstype,
       f.tradepackname,
       f.factname,
       a.goodspackid,
       g.packsize,
       g.packname,
       c.goodsqty,
       a.lotid,
       a.lotno,
       a.goodsstatusid,
       h.goodsstatus,
       h.quantitystatus,
       c.sectionid,
       d.sectionname,
       c.posid,
       e.posname,
       c.rfflag,
       c.usestatus,
       d.iwcs_flag,
       c.iwcs_case_nbr,
       j.status iwcsdtlstatus,
       a.goodsownerid,
       k.goodsownername,
       l.wavedtlid
  from wms_out_order_dtl     a,
       wms_out_order_lot_dtl b,
       wms_st_io_doc         c,
       wms_st_section_def    d,
       wms_pos_def           e,
       tpl_goods             f,
       tpl_pub_goods_packs   g,
       wms_goodsstatus       h,
       wms_goods_lot         i,
       ssc_send_interface_lines@iwcs j,
       tpl_goodsowner        k,
       wms_wave_goods_dtl    l
 where a.outdtlid=b.outdtlid
 and   b.wavegoodsdtlid=c.sourceid
 and   c.comefrom=3
 and   c.sectionid=d.sectionid(+)
 and   c.posid=e.posid(+)
 and   a.ownergoodsid=f.ownergoodsid(+)
 and   a.goodspackid=g.goodspackid(+)
 and   a.goodsstatusid=h.goodsstatusid(+)
 and   a.lotid=i.lotid(+)
 and   c.inoutid=j.wms_inout_id(+)
 and   a.goodsownerid=k.goodsownerid(+)
 and   b.wavegoodsdtlid=l.wavegoodsdtlid
"
"IWCS_OUT_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""IWCS_OUT_ORDER_V"" (""OUTID"", ""ZXCOLUMN4"", ""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""RECCOMPANYID"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""USESTATUS"", ""URGENFLAG"", ""WAVEID"", ""WAVEDTLID"", ""SENDIWCSFLAG"", ""IWCSSTATUS"") AS 
  select a.outid,
       a.zxcolumn4,
       a.credate,
       a.warehid,
       d.warehname,
       a.goodsownerid,
       b.goodsownername,
       a.reccompanyid,
       c.companyname,
       a.operationtype,
       a.usestatus,
       a.urgenflag,
       a.waveid,
       a.wavedtlid,
       (select nvl(max(nvl(t3.iwcs_flag,0)),0)
          from wms_out_order_dtl     t,
               wms_out_order_lot_dtl t1,
               wms_st_io_doc         t2,
               wms_st_section_def    t3
         where t.outdtlid = t1.outdtlid
           and t1.wavegoodsdtlid = t2.sourceid
           and t2.comefrom=3
           and t2.sectionid=t3.sectionid(+)
           and t.outid=a.outid) sendiwcsflag,
       (case when e.send_status='NEW' then 1
             when e.send_status='RUN' then 2
             when e.send_status='DIST' then 3
             when e.send_status='CHECK' then 4
             when e.send_status='FINISH' then 5
             else null end) iwcsstatus
  from wms_out_order           a,
       tpl_goodsowner          b,
       tpl_go_company          c,
       tpl_warehouse           d,
       ssc_send_interface@iwcs e
 where a.goodsownerid = b.goodsownerid(+)
   and a.reccompanyid = c.companyid(+)
   and a.warehid = d.warehid(+)
   and b.iwcs_flag = 1 --启用自动库的货主
   and a.outid = e.wms_order_id(+)
"
"IWCS_WBOX_MSG_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""IWCS_WBOX_MSG_V"" (""TOOL_ID"", ""USED_ID"", ""USED_NAME"", ""CSTID"", ""TOOL_CODE"", ""MODIFYDATE"", ""SIGNDATE"", ""SENDPOS"") AS 
  select a.tool_id,
       a.used_id,
       a.used_name,
       a.cstid,
       a.tool_code,
       --a.modifyer,
       a.modifydate,
       b.signdate,
       c.sendpos
  from trans_tool@iwcs a,tms_tr_doc b,wms_transport_address c
 where a.kind = 22
   and nvl(a.isused, 0) = 1
   and a.cstid=b.sourceid(+)
   and b.sourcetable=1
   and b.warehid=1
   and b.transid=c.transid(+)
"
"IWCS_WBOX_TOTAL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""IWCS_WBOX_TOTAL_V"" (""USED_ID"", ""USED_NAME"", ""SENDPOS"", ""UNSIGN"", ""LESSMONTH"", ""MOREMONTH"", ""TOTAL"") AS 
  select a.used_id,
       a.used_name,
       c.sendpos,
       sum(case when b.signdate is null then 1 else 0 end) unsign,--未签收
       sum(case when b.signdate is not null and (sysdate-b.signdate)<=30 then 1 else 0 end) lessmonth,
       sum(case when b.signdate is not null and (sysdate-b.signdate)>30  then 1 else 0 end) moremonth,
       count(a.tool_id) total
  from trans_tool@iwcs a,tms_tr_doc b,wms_transport_address c
 where a.kind = 22
   and nvl(a.isused, 0) = 1
   and a.cstid=b.sourceid(+)
   and b.sourcetable=1
   and b.warehid=1
   and b.transid=c.transid(+)
 group by a.used_id, a.used_name,c.sendpos
"
"IWCS_WMS_DIFFQTY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""IWCS_WMS_DIFFQTY_V"" (""GOODSOWNERID"", ""OWNERGOODSID"", ""LOTID"", ""GOODSPACKID"", ""GOODSSTATUSID"", ""WMSGOODSQTY"", ""ROBOQTY"", ""DIFFQTY"") AS 
  select total.goodsownerid,
       total.ownergoodsid,
       total.lotid,
       total.goodspackid,
       total.goodsstatusid,
       total.wmsgoodsqty,
       total.roboqty,
       (nvl(total.wmsgoodsqty,0) - nvl(total.roboqty,0)) diffqty
  from (select pk,
               max(goodsownerid) goodsownerid,
               max(ownergoodsid) ownergoodsid,
               max(lotid) lotid,
               max(goodspackid) goodspackid,
               max(goodsstatusid) goodsstatusid,
               sum(goodsqty) wmsgoodsqty,
               max(roboqty) roboqty
          from (select a.goodsownerid||'-'||a.ownergoodsid || '-' || a.lotid || '-' ||
                       a.goodspackid||'-'||a.goodsstatusid PK,
                       a.goodsownerid,
                       a.ownergoodsid,
                       a.lotid,
                       a.goodspackid,
                       a.goodsstatusid,
                       a.goodsqty,
                       null roboqty
                  from (select t.goodsownerid,
                               t.ownergoodsid,
                               t.lotid,
                               t.goodspackid,
                               t.goodsstatusid,
                               sum(t.goodsqty) goodsqty
                          from Wms_St_Qty_Lst t,wms_st_section_def tt,wms_pos_def ttt
                         where --t.goodsownerid in (1,6,2,682)
                           t.posid=ttt.posid
                           and t.warehid=1
                           and ttt.sectionid=tt.sectionid
                           and tt.iwcs_flag=1
                      group by t.goodsownerid,t.ownergoodsid,t.lotid,t.goodspackid,t.goodsstatusid) a
                union all
                select b.goodsownerid||'-'||b.ownergoodsid || '-' || b.lotid || '-' ||
                       b.goodspackid||'-'||goodsstatusid PK,
                       b.goodsownerid,
                       b.ownergoodsid,
                       b.lotid,
                       b.goodspackid,
                       b.goodsstatusid,
                       null goodsqty,
                       b.goodsqty roboqty
                  from (select t.party_owner_id goodsownerid,
                               t.com_goods_id ownergoodsid,
                               t.com_lot_id lotid,
                               tt.goodspackid goodspackid,
                               t.com_inventory_type_id goodsstatusid,
                               sum(t.onavailable) goodsqty
                          from com_inv_fact@iwcs t ,tpl_goods_packs tt
                         where t.onavailable<>0
                           and t.package_id=tt.ownerpackid(+)
                         group by t.party_owner_id,t.com_goods_id,t.com_lot_id,tt.goodspackid,t.com_inventory_type_id) b)
         group by pk) total
"
"IWCS_WMS_DIFFQTY_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""IWCS_WMS_DIFFQTY_V1"" (""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""LOTID"", ""LOTNO"", ""GOODSPACKID"", ""OWNERPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSSTATUSID"", ""WMSGOODSQTY"", ""ROBOQTY"", ""DIFFQTY"") AS 
  select a.goodsownerid,
       e.goodsownername,
       a.ownergoodsid,
       b.goodsname,
       b.goodsengname,
       b.goodstype,
       b.tradepackname,
       b.factname,
       a.lotid,
       c.lotno,
       a.goodspackid,
       d.ownerpackid,
       d.packname ,
       d.packsize ,
       a.goodsstatusid,
       a.wmsgoodsqty ,
       a.roboqty,
       a.diffqty
  from iwcs_wms_diffqty_v          a,
       tpl_goods                   b,
       wms_goods_lot               c,
       tpl_goods_packs             d,
       tpl_goodsowner              e
where  a.ownergoodsid=b.ownergoodsid(+)
and    a.ownergoodsid=d.ownergoodsid(+)
and    a.lotid=c.lotid(+)
and    a.goodspackid=d.goodspackid(+)
and    a.goodsownerid=e.goodsownerid(+)
"
"LYWMS2TRACK_IN_ORDER_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LYWMS2TRACK_IN_ORDER_DTL_V"" (""PKID"", ""INDTLID"", ""STEPSEQ"", ""STEP"", ""STEPDATE"", ""RECEIVEID"", ""LOTID"", ""LOTNO"", ""DTLGOODQTY"", ""TRACKMSG"", ""WAREHID"", ""GOODSOWNERID"") AS 
  select t.pkid,
       t.indtlid,
       t.stepseq,
       t.step,
       t.stepdate,
       t.receiveid,
       t.lotid,
       t.lotno,
       t.dtlgoodqty,
       t.trackmsg,
       t.warehid,
       t.goodsownerid
  from track_in_order_dtl t
 where exists (select 1
          from track_in_order x
         where x.warehid = t.warehid
           and x.goodsownerid = t.goodsownerid
           and x.indtlid = t.indtlid
           and x.execflag=1)
   and t.syncflag=0
"
"LYWMS2TRACK_IN_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LYWMS2TRACK_IN_ORDER_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INID"", ""INDTLID"", ""ORDERNO"", ""ORDERDTLNO"", ""CREDATE"", ""USESTATUS"", ""OPERATIONTYPE"", ""SOURCECOMPANYNAME"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""DRUGFORM"", ""APPROVEDOCNO"", ""MAH"", ""GOODSQTY"", ""GOODSOWNID"") AS 
  select t.warehid,
       t.warehname,
       t.goodsownerid,
       t.goodsownername,
       t.inid,
       t.indtlid,
       t.orderno,
       t.orderdtlno,
       t.credate,
       t.usestatus,
       t.operationtype,
       --t.sourcecompanyid,
       t.sourcecompanyname,
       t.ownergoodsid,
       t.goodsname,
       t.goodsengname,
       t.goodstype,
       t.tradepackname,
       t.factname,
       t.prodarea,
       t.drugform,
       t.approvedocno,
       t.mah,
       t.goodsqty,
       t.goodsownid
  from track_in_order t
 where t.execflag = 0
-- AND ROWNUM <= 1000;--测试用
"
"LYWMS2TRACK_OUT_GOODSMSG_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LYWMS2TRACK_OUT_GOODSMSG_V"" (""OUTDTLID"", ""OUTID"", ""OWNERGOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""DRUGFORM"", ""APPROVEDOCNO"", ""MAH"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""WAREHID"", ""GOODSOWNERID"", ""PRODDATE"", ""VALIDDATE"") AS 
  select t.outdtlid,
       t.outid,
       t.ownergoodsid,
       t.goodsownid,
       t.goodsname,
       t.goodsengname,
       t.goodstype,
       t.tradepackname,
       t.factname,
       t.prodarea,
       t.drugform,
       t.approvedocno,
       t.mah,
       t.lotid,
       t.lotno,
       t.goodsqty,
       t.warehid,
       t.goodsownerid,
       t.proddate,
       t.validdate
  from track_out_order_goodsmsg t
 where exists (select 1
          from track_out_order x
         where x.execflag = 1
           and x.outid = t.outid
           and x.warehid = t.warehid
           and x.goodsownerid = t.goodsownerid)
  /* and not exists (select 1
          from track_out_order_goodsmsg y
         where y.outdtlid = t.outdtlid
           and y.warehid = t.warehid
           and y.goodsownerid = t.goodsownerid)*/
   and t.syncflag=0
"
"LYWMS2TRACK_OUT_ORDER_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LYWMS2TRACK_OUT_ORDER_DTL_V"" (""PKID"", ""OUTID"", ""STEPSEQ"", ""STEP"", ""STEPDATE"", ""VEHICLENO"", ""DRIVERNAME"", ""MOBILE"", ""TRACKMSG"", ""WAREHID"", ""GOODSOWNERID"", ""STEPDTLSEQ"", ""STEPDTL"") AS 
  select t.pkid,
       t.outid,
       t.stepseq,
       t.step,
       t.stepdate,
       t.vehicleno,
       t.drivername,
       t.mobile,
       t.trackmsg,
       t.warehid,
       t.goodsownerid,
       t.stepdtlseq,
       t.stepdtl
  from track_out_order_dtl t
 where exists (select 1
          from track_out_order x
         where x.warehid = t.warehid
           and x.goodsownerid = t.goodsownerid
           and x.outid = t.outid
           and x.execflag = 1)
   and t.syncflag=0
"
"LYWMS2TRACK_OUT_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LYWMS2TRACK_OUT_ORDER_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OUTID"", ""ORDERNO"", ""CREDATE"", ""USESTATUS"", ""OPERATIONTYPE"", ""RECCOMPANYID"", ""RECOMPANYNAME"", ""SALERID"", ""SALERNAME"", ""ADDRESS"") AS 
  select t.warehid,
       t.warehname,
       t.goodsownerid,
       t.goodsownername,
       t.outid,
       t.orderno,
       t.credate,
       t.usestatus,
       t.operationtype,
       t.reccompanyid,
       t.recompanyname,
       t.salerid,
       t.salername,
       t.address
  from track_out_order t
 where t.execflag = 0
"
"LYYYBS_WMS_WORK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LYYYBS_WMS_WORK_V"" (""数据来源"", ""类型"", ""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""ERP货品ID"", ""散件条数"", ""整件件数"", ""总数"") AS 
  select 'WMS' as 数据来源,
       '收货' as 类型,--收货
       a.日期,
       a.物流中心ID,
       a.物流中心,
       a.货主ID,
       a.货主名称,
       a.ERP货品ID,
       a.散件条数,
       a.整件件数,
       (a.散件条数 + a.整件件数) 总数
  from lyyy_wms_check_v a

union all

select 'WMS' as 数据来源,
       '验收' as 类型,--验收
       a.日期,
       a.物流中心ID,
       a.物流中心,
       a.货主ID,
       a.货主名称,
       a.ERP货品ID,
       a.散件条数,
       a.整件件数,
       (a.散件条数 + a.整件件数) 总数
  from lyyy_wms_check_v a

union all

select 'WMS' as 数据来源,
       '上架' as 类型,--上架
       b.日期,
       b.物流中心ID,
       b.物流中心,
       b.货主ID,
       b.货主名称,
       b.ERP货品ID,
       b.散件条数,
       b.整件件数,
       (b.散件条数 + b.整件件数) 总数
  from lyyy_wms_in_v b

union all

select 'WMS' as 数据来源,
       '拣货' as 类型,--拣货
       c.日期,
       c.物流中心ID,
       c.物流中心,
       c.货主ID,
       c.货主名称,
       c.ERP货品ID,
       c.散件条数,
       c.整件件数,
       (c.散件条数 + c.整件件数) 总数
  from lyyy_wms_out_v c

union all

select 'WMS' as 数据来源,
       '复核' as 类型,--复核
       d.日期,
       d.物流中心ID,
       d.物流中心,
       d.货主ID,
       d.货主名称,
       d.ERP货品ID,
       0 散件条数,
       d.复核整件件数 整件件数,
       d.复核条数 总数
  from lyyy_wms_fh_v d

union all

select 'WMS' as 数据来源,
       '库内移动' as 类型,--库内移动
       e.日期,
       e.物流中心ID,
       e.物流中心,
       e.货主ID,
       e.货主名称,
       e.ERP货品ID,
       0 散件条数,
       0 整件件数,
       e.移库条数 总数
  from lyyy_wms_trade_v e
"
"LYYY_WMS_CHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LYYY_WMS_CHECK_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""ERP货品ID"", ""散件条数"", ""整件件数"") AS 
  select to_char(b.credate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       c.warehname 物流中心,
       b.goodsownerid 货主ID,
       d.goodsownername 货主名称,
       e.goodsownid     ERP货品ID,
       sum((case
             when nvl(b.scatterqty, 0) <> 0 then
              1
             else
              0
           end)) 散件条数,
       sum(nvl(b.wholeqty, 0)) 整件件数
  from wms_receive_dtl a,
       wms_st_io_doc   b,
       tpl_warehouse   c,
       tpl_goodsowner  d,
       tpl_goods       e
 where a.receiveid = b.sourceid
   and b.comefrom = 1 --入库
   and a.usestatus in (3, 4) --准备上架和上架完成
   and b.credate >= to_date('2021-01-01', 'yyyy-mm-dd') --创建时间
   and a.warehid = c.warehid(+)
   and b.goodsownerid = d.goodsownerid(+)
   and b.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid = 1
   and b.goodsownerid=1
   and a.ownergoodsid=e.ownergoodsid
 group by to_char(b.credate, 'yyyy-mm-dd'),
          a.warehid,
          c.warehname,
          b.goodsownerid,
          d.goodsownername,
          e.goodsownid
 order by to_char(b.credate, 'yyyy-mm-dd'), a.warehid, b.goodsownerid
"
"LYYY_WMS_FH_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LYYY_WMS_FH_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""ERP货品ID"", ""复核整件件数"", ""复核条数"") AS 
  select to_char(a.keepdate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       c.warehname 物流中心,
       a.goodsownerid 货主ID,
       d.goodsownername 货主名称,
       e.goodsownid ERP货品ID,
       sum(nvl(b.wholeqty,0)) 复核整件件数,
       count(1) 复核条数
  from gsp_st_io_record a,
       wms_st_io_doc   b,
       tpl_warehouse   c,
       tpl_goodsowner  d,
       tpl_goods       e
 where a.inoutid = b.inoutid
   and a.keepdate >= to_date('2021-01-01', 'yyyy-mm-dd') --复核时间
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and b.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid = 1
   and a.goodsownerid=1
   and a.ownergoodsid=e.ownergoodsid
 group by to_char(a.keepdate, 'yyyy-mm-dd'),
          a.warehid,
          c.warehname,
          a.goodsownerid,
          d.goodsownername,
          e.goodsownid
 order by to_char(a.keepdate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"LYYY_WMS_IN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LYYY_WMS_IN_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""ERP货品ID"", ""散件条数"", ""整件件数"") AS 
  select to_char(a.rffindate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       b.warehname 物流中心,
       a.goodsownerid 货主ID,
       c.goodsownername 货主名称,
       d.goodsownid ERP货品ID,
       sum((case
             when nvl(a.scatterqty, 0) <> 0 then
              1
             else
              0
           end)) 散件条数,
       sum(nvl(a.wholeqty, 0)) 整件件数
  from wms_st_io_doc   a,
       tpl_warehouse   b,
       tpl_goodsowner  c,
       tpl_goods       d
 where a.comefrom = 1 --入库
   and a.rffindate >= to_date('2021-01-01', 'yyyy-mm-dd') --任务完成时间
   and a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid = 1
   and a.goodsownerid=1
   and a.ownergoodsid=d.ownergoodsid
 group by to_char(a.rffindate, 'yyyy-mm-dd'),
          a.warehid,
          b.warehname,
          a.goodsownerid,
          c.goodsownername,
          d.goodsownid
 order by to_char(a.rffindate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"LYYY_WMS_OUT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LYYY_WMS_OUT_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""ERP货品ID"", ""散件条数"", ""整件件数"") AS 
  select to_char(a.rffindate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       b.warehname 物流中心,
       a.goodsownerid 货主ID,
       c.goodsownername 货主名称,
       d.goodsownid ERP货品ID,
       sum((case
             when nvl(a.scatterqty, 0) <> 0 then
              1
             else
              0
           end)) 散件条数,
       sum(nvl(a.wholeqty, 0)) 整件件数
  from wms_st_io_doc a,
       tpl_warehouse   b,
       tpl_goodsowner  c,
       tpl_goods       d
 where a.comefrom in (2,3) --订单出库、波次出库
   and a.rffindate >= to_date('2021-01-01', 'yyyy-mm-dd') --任务完成时间
   and a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid = 1
   and a.goodsownerid=1
   and a.ownergoodsid=d.ownergoodsid
 group by to_char(a.rffindate, 'yyyy-mm-dd'),
          a.warehid,
          b.warehname,
          a.goodsownerid,
          c.goodsownername,
          d.goodsownid
 order by to_char(a.rffindate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"LYYY_WMS_STORAGE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LYYY_WMS_STORAGE_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""ERP货品ID"", ""散件条数"", ""整件件数"") AS 
  select to_char(a.kcrq, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       f.warehname 物流中心,
       a.goodsownerid 货主ID,
       d.goodsownername 货主名称,
       e.goodsownid ERP货品ID,
       count(distinct (case when c.areaflag=2 then a.posid else 0 end)) 散件条数,
       sum((case when c.areaflag=1 then (decode(g.packsize,0,0,round(a.goodsqty/g.packsize,0))) else 0 end)) 整件件数
  from wms_st_qty_lst_bak  a,
       wms_pos_def         b,
       wms_st_area_def     c,
       tpl_goodsowner      d,
       tpl_goods           e,
       tpl_warehouse       f,
       tpl_pub_goods_packs g
 where a.posid = b.posid(+)
   and b.areaid = c.areaid(+)
   and a.ownergoodsid = e.ownergoodsid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.warehid = f.warehid(+)
   and a.goodspackid=g.goodspackid(+)
   and a.warehid in (1)
   and a.goodsqty>0
   and b.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.kcrq>to_date('2021-01-01','yyyy-mm-dd')
   and a.goodsownerid=1
 group by to_char(a.kcrq, 'yyyy-mm-dd'),
          a.warehid,
          f.warehname,
          a.goodsownerid,
          d.goodsownername,
          e.goodsownid
 order by to_char(a.kcrq, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"LYYY_WMS_TRADE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LYYY_WMS_TRADE_V"" (""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""ERP货品ID"", ""移库条数"") AS 
  select to_char(a.rffindate, 'yyyy-mm-dd') 日期,
       a.warehid 物流中心ID,
       b.warehname 物流中心,
       a.goodsownerid 货主ID,
       c.goodsownername 货主名称,
       d.goodsownid ERP货品ID,
       count(1) 移库条数
  from wms_st_io_doc   a,
       tpl_warehouse   b,
       tpl_goodsowner  c,
       tpl_goods       d
 where a.comefrom in (4) --库内变动
   and a.operationtype in (28,29)--移位、补货
   and a.rffindate >= to_date('2021-01-01', 'yyyy-mm-dd') --任务完成时间
   and a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.sectionid in (select t.sectionid
                         from wms_st_section_def t
                        where nvl(t.iwcs_flag, 0) <> 1) --非自动库分区
   and a.warehid = 1
   and a.goodsownerid=1
   and a.ownergoodsid=d.ownergoodsid
 group by to_char(a.rffindate, 'yyyy-mm-dd'),
          a.warehid,
          b.warehname,
          a.goodsownerid,
          c.goodsownername,
          d.goodsownid
 order by to_char(a.rffindate, 'yyyy-mm-dd'), a.warehid, a.goodsownerid
"
"LYZX_TPRICE_GOODS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LYZX_TPRICE_GOODS_V"" (""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSFORMALNAME"", ""GOODSPINYIN"", ""GOODSQTYPE"", ""DICTNO"", ""CREDATE"", ""INPUTMANID"", ""MEMO"", ""BARCODE"", ""POISON_DRUG"", ""GOODSTYPE"", ""CLASSID"", ""CLASSNAME"", ""FACTID"", ""PRODAREA"", ""REGISTNO"", ""APPROVEDOCNO"", ""GMPFLAG"", ""UNIFYNO"", ""DRUGFORM"", ""L_PERIOD"", ""S_PERIODUNIT"", ""MANOPCODE"", ""EMPLOYEENAME"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""REPTYPE"", ""STORAGETYPE"", ""JKHZFLAG"", ""GOODSPY"", ""GOODSTYPEID"", ""TPRICEGTYPE"", ""SPECIALFLAG"", ""SIGNATURE"", ""FILEGROUPID"", ""ALONEPACKFLAG"", ""ZXCOL01"", ""ZXCOL02"", ""PACKSIZE"", ""PACKNAME"") AS 
  select a.goodsid,
       a.opcode,
       a.goodsname,
       a.goodsengname,
       a.goodsformalname,
       a.goodspinyin,
       a.goodsqtype,
       a.dictno,
       a.credate,
       a.inputmanid,
       a.memo,
       a.barcode,
       a.poison_drug,
       a.goodstype,
       a.classid,
       f.classname,
       a.factid,
       a.prodarea,
       a.registno,
       a.approvedocno,
       a.gmpflag,
       a.unifyno,
       a.drugform,
       a.l_period,
       a.s_periodunit,
       b.opcode manopcode,
       b.employeename,
       c.companyopcode,
       c.companyname,
       a.reptype,
       a.storagetype,
       a.jkhzflag,
       a.goodspy,
       a.goodstypeid,
       e.goodstypename tpricegtype,
       a.specialflag,
       a.signature,
       a.filegroupid,
       a.alonepackflag,
       a.zxcol01,
       a.zxcol02,
       g.packsize,
       g.packname
  from lyzx_Tprice_goods     a,
       tpl_pub_goods_packs g,
       pub_employee      b,
       tpl_pub_company   c,
       tprice_goods_type e,
       tpl_pub_goods_class f
 where a.inputmanid = b.employeeid(+)
   and a.factid = c.companyid(+)
   AND a.goodstypeid = e.goodstypeid(+)
   and a.classid = f.classid(+)
   and a.goodsid = g.goodsid (+)
   and g.baseunitflag =2
"
"LY_API_INORDER_FINISH_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LY_API_INORDER_FINISH_V"" (""WAREHID"", ""GOODSOWNERID"", ""ORDERID"", ""COMPANYID"", ""OPERATIONTYPE"", ""ORDERDTLID"", ""RECEIVEID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSTYPE"", ""TRADEPACK"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""MAH"", ""GOODSTATUS"", ""QUANSTATUS"", ""PRODAREA"", ""FACTNAME"", ""SHR"", ""SHDATE"", ""CHECKMAN"", ""CHECKDATE"", ""KEEPMAN"", ""KEEPDATE"", ""ARRIVALTEMPEARTURE"", ""INVOICECODE"", ""INVOICENO"", ""INVOICEDATE"") AS 
  select a.warehid, --物流中心ID
       a.goodsownerid, --货主ID
       a.zxcolumn4 as orderid, --ERP总单ID
       f.gcompanyid as companyid, --来货单位ID
       a.operationtype as operationtype, --业务类型（业务类型：1-进货 7-销退 9-移库入 22-报溢 42-收配退）
       b.dtlzxcolumn4 as orderdtlid, --ERP细单ID
       c.receiveid as receiveid, --WMS入库主键
       g.goodsownid as goodsownid, --货品编码
       g.goodsname as goodsname, --货品名称
       g.goodstype as goodstype, --规格
       g.tradepackname as tradepack, --基本单位
       h.packname as packname, -- 包装单位
       h.packsize as packsize, --包装大小
       c.goodsqty as goodsqty, --上架数量
       i.lotno as lotno, --批号
       to_char(i.validdate, 'yyyy-mm-dd') as validdate, --有效期至
       to_char(i.proddate, 'yyyy-mm-dd') as proddate, --生产日期
       nvl(i.approvedocno, g.approvedocno) as approvedocno, --批准文号
       nvl(i.mah, g.mah) as mah, --上市许可持有人
       c.goodsstatusid as goodstatus, --货品状态
       c.quantitystatus as quanstatus, --质量状态
       g.prodarea as prodarea, --产地
       g.factname as factname, --生产厂家
       j.employeename as shr, --收货员
       b.shdate as shdate, --收货时间
       k.employeename as checkman, --验收员
       c.checkdate as checkdate, --验收时间
       (select to_char(wm_concat(distinct x1.employeename))
          from wms_st_io_doc x, pub_employee x1
         where x.sourceid = c.receiveid
           and x.comefrom = 1
           and x.keepmanid = x1.employeeid) as keepman, --上架人员
       (select max(y.keepdate)
          from wms_st_io_doc y
         where y.sourceid = c.receiveid
           and y.comefrom = 1) as keepdate, --上架时间
       b.dhwd as arrivaltempearture, --到货温度
       c.invoicecode as invoicecode, --发票代码
       c.invoiceno as invoiceno, --发票号码
       c.invoicedate as invoicedate --发票日期
  from wms_in_order        a,
       wms_in_order_dtl    b,
       wms_receive_dtl     c,
       tpl_warehouse       d,
       tpl_goodsowner      e,
       tpl_go_company      f,
       tpl_goods           g,
       tpl_pub_goods_packs h,
       wms_goods_lot       i,
       pub_employee        j,
       pub_employee        k
 where a.inid = b.inid
   and b.indtlid = c.indtlid
   and a.usestatus = 3 --总单状态 3-完成
   and b.porderstatus = 5 --细单状态 5-上架完成
   and a.warehid = d.warehid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.sourcecompanyid = f.companyid(+)
   and c.ownergoodsid = g.ownergoodsid(+)
   and c.goodspackid = h.goodspackid(+)
   and c.lotid = i.lotid(+)
   and b.shrid = j.employeeid(+)
   and c.inputmanid = k.employeeid(+)
"
"LY_API_LOT_MODIFY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LY_API_LOT_MODIFY_V"" (""MODIFYDATE"", ""GOODSOWNERID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSTYPE"", ""TRADEPACK"", ""LOTNO"", ""TOLOTNO"", ""PRODDATE"", ""TOPRODDATE"", ""VALIDDATE"", ""TOVALIDDATE"", ""LOTNOFACTNAME"", ""TOLOTNOFACTNAME"", ""APPROVEDOCNO"", ""TOAPPROVEDOCNO"", ""MAH"", ""TOMAH"", ""PRODLICENSENO"", ""TOPRODLICENSENO"", ""PRINTMONTHFLAG"", ""TOPRINTMONTHFLAG"", ""PRINTEXPIREFLAG"", ""TOPRINTEXPIREFLAG"", ""PRODMONTHFLAG"", ""TOPRODMONTHFLAG"", ""MODIFYMAN"", ""MEMO"", ""MODIFYID"") AS 
  select a.modifydate,
       b.goodsownerid,
       b.goodsownid,
       b.goodsname,
       b.goodstype,
       b.tradepackname as tradepack,
       a.lotno,
       a.tolotno,
       to_char(a.proddate, 'yyyy-mm-dd') as proddate,
       to_char(a.toproddate, 'yyyy-mm-dd') as toproddate,
       to_char(a.validdate, 'yyyy-mm-dd') as validdate,
       to_char(a.tovaliddate, 'yyyy-mm-dd') as tovaliddate,
       a.lotnofactname,
       a.tolotnofactname,
       a.approvedocno,
       a.toapprovedocno,
       a.mah,
       a.tomah,
       a.prodlicenseno,
       a.toprodlicenseno,
       a.printmonthflag,
       a.toprintmonthflag,
       a.printexpireflag,
       a.toprintexpireflag,
       a.prodmonthflag,
       a.toprodmonthflag,
       nvl(a.modifyman, c.employeename) as modifyman,
       a.memo,
       a.modifyid
  from wms_lot_modify_lst a, tpl_goods b, pub_employee c
 where a.goodsid = b.waregoodsid
   and a.modifymanid = c.employeeid(+)
"
"LY_API_OUTORDER_FINISH","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LY_API_OUTORDER_FINISH"" (""GOODSOWNERID"", ""WAREHID"", ""ORDERID"", ""COMPANYID"", ""OPERATIONTYPE"", ""ORDERDTLID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSTYPE"", ""TRADEPACK"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""MAH"", ""GOODSTATUS"", ""QUANSTATUS"", ""PRODAREA"", ""FACTNAME"", ""PICKMAN"", ""PICKDATE"", ""CHECKMAN"", ""CHECKDATE"", ""WAVEDTLID"") AS 
  select a.goodsownerid, --货主id
       a.warehid, --物流中心ID
       a.zxcolumn4 as orderid, --erp总单ID
       f.gcompanyid as companyid, --出库单位
       a.operationtype as operationtype, --业务类型
       b.dtlzxcolumn4 as orderdtlid, --erp细单ID
       c.goodsownid as goodsownid, -- 货品编码
       c.goodsname as goodsname, --货品名称
       c.goodstype as goodstype, --货品规格
       c.tradepackname as tradepack, --基本单位名称
       h.packname, --包装单位
       h.packsize as packsize, --包装大小
       b.goodsqty, --出库明细数量
       i.lotno, --批号
       to_char(i.validdate, 'yyyy-mm-dd') as validdate, --有效期
       to_char(i.proddate, 'yyyy-mm-dd') as proddate, --生产日期
       nvl(i.approvedocno, c.approvedocno) as approvedocno, --批准文号
       nvl(i.mah, c.mah) as mah, --上市许可持有人
       b.goodsstatusid as goodstatus, --货品状态
       b.quantitystatus as quanstatus, --质量状态
       c.prodarea, --产地
       nvl(i.factname, c.factname) as factname, --生产厂家
       (select to_char(wm_concat(distinct x2.employeename))
          from wms_out_order_lot_dtl x, wms_st_io_doc x1, pub_employee x2
         where x.wavegoodsdtlid = x1.sourceid
           and x1.comefrom in (2, 3)
           and x1.rfmanid = x2.employeeid(+)
           and x.outdtlid = b.outdtlid) as pickman, --拣货人员
       (select max(x1.rffindate)
          from wms_out_order_lot_dtl x, wms_st_io_doc x1, pub_employee x2
         where x.wavegoodsdtlid = x1.sourceid
           and x1.comefrom in (2, 3)
           and x1.rfmanid = x2.employeeid(+)
           and x.outdtlid = b.outdtlid) as pickdate, --拣货完成时间
       (select to_char(wm_concat(distinct x2.employeename))
          from wms_out_order_lot_dtl x, wms_st_io_doc x1, pub_employee x2
         where x.wavegoodsdtlid = x1.sourceid
           and x1.comefrom in (2, 3)
           and x1.keepmanid = x2.employeeid(+)
           and x.outdtlid = b.outdtlid) as checkman, --复核人
       (select max(x1.keepdate)
          from wms_out_order_lot_dtl x, wms_st_io_doc x1, pub_employee x2
         where x.wavegoodsdtlid = x1.sourceid
           and x1.comefrom in (2, 3)
           and x1.rfmanid = x2.employeeid(+)
           and x.outdtlid = b.outdtlid) as checkdate, --复核完成时间
       a.wavedtlid --随货同行号
  From wms_out_order       a,
       wms_out_order_dtl   b,
       Tpl_goods           c,
       tpl_go_company      f,
       tpl_pub_goods_packs h,
       wms_goods_lot       i
 where a.outid = b.outid
   and a.usestatus = 4
   and b.usestatus = 5
   and a.reccompanyid = f.companyid(+)
   and b.ownergoodsid = c.ownergoodsid(+)
   and b.lotid = i.lotid(+)
   and b.goodspackid = h.goodspackid(+)
"
"LY_API_OUTORDER_PACKINGMSG","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LY_API_OUTORDER_PACKINGMSG"" (""WAVEDTLID"", ""PACKINGID"", ""INOUTID"", ""BOXNO"", ""PACKINGQTY"", ""WHOLEQTY"") AS 
  select (select x.wavedtlid
          from wms_wave_goods_dtl x
         where x.wavegoodsdtlid = a.sourceid) as wavedtlid, --随货同行号
       b.docid as packingid, --装箱ID
       a.inoutid,
       b.boxcode as boxno,
       d.goodsqty as packingqty,
       0 as wholeqty
  from wms_st_io_doc          a,
       wms_box_doc            b,
       wms_box_dtl            c,
       wms_turnbox_to_box_rel d
 where a.comefrom in (2, 3)
   and b.docid = c.docid
   and c.dtlid = d.boxdtlid
   and d.inoutid = a.inoutid
   and nvl(a.wholeqty, 0) = 0 --散件备货
union all
select (select x.wavedtlid
          from wms_wave_goods_dtl x
         where x.wavegoodsdtlid = a.sourceid) as wavedtlid, --随货同行号
       a.inoutid as packingid, --装箱ID
       a.inoutid,
       to_char(a.inoutid) as boxno,
       a.goodsqty as packingqty,
       a.wholeqty as wholeqty
  from wms_st_io_doc a
 where a.comefrom in (2, 3)
   and nvl(a.scatterqty, 0) = 0 --散件备货
"
"LY_API_QUAILTY_FEEDBACK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LY_API_QUAILTY_FEEDBACK_V"" (""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACK"", ""FACTNAME"", ""PRODAREA"", ""MAH"", ""APPROVEDOCNO"", ""PRODLICENSENO"", ""GOODSQTY"", ""CHECKQTY"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""INPUTMANID"", ""INPUTMAN"", ""GOODSSITUTION"", ""LOGISTICSIDEA"", ""OWNERQUALITYDEPTIDEA"", ""OWNERQUALITYDEPTMAN"", ""OWNERQUALITYDEPTDATE"", ""OWNERRELATEDEPTIDEA"", ""OWNERRELATEDEPTMAN"", ""OWNERRELATEDEPTDATE"", ""USESTATUS"", ""DEALRESULT"", ""FEEDBACKID"") AS 
  select a.credate,--创建时间
       a.goodsownerid,--货主ID
       d.goodsownername,--货主名称
       a.companyid,--来货单位ID
       c.companyname,--来货单位名称
       b.waregoodsid as goodsownid, --货品ID
       b.goodsname, --货品名称
       b.goodsengname, --商品名
       b.goodstype,    --规格
       b.tradepackname as tradepack,  --基本单位
       b.factname,       --生产厂家
       b.prodarea,        --产地
       b.mah,              --上市许可持有人
       nvl(a.approvedocno,b.approvedocno) as approvedocno, --批准文号
       h.prodlicenseno, --生产许可证号
       a.goodsqty, --应来货数量
       a.checkqty,--待复查数量
       a.lotno, --批号ID
       to_char(a.validdate,'yyyy-mm-dd') as validdate,--有效期
       to_char(a.proddate,'yyyy-mm-dd') as proddate,--生产日期
       a.inputmanid, --录入人ID
       e.employeename as inputman,--录入人名称
       a.goodssitution,--货品情况
       a.zgyidea as logisticsidea,--物流部意见
       a.wtfqualitydeptidea as ownerqualitydeptidea, --委托方质管部确认
       a.wtfqualitydeptman as ownerqualitydeptman,--委托方质管部确认人
       a.wtfqualitydeptdate as ownerqualitydeptdate,--委托方质管部确认时间
       a.wtfrelatedeptidea as ownerrelatedeptidea,--委托相关部门确认
       a.wtfrelatedeptman as ownerrelatedeptman,--委托相关部门确认人
       wtfrelatedeptdate as ownerrelatedeptdate, --委托方相关部门确认时间
       a.usestatus, --单据状态
       a.dealresult, --处理方式
       a.feedbackid --反馈记录ID
  from zx_gsp_quality_feedback a,
       tpl_goods               b,
       tpl_go_company          c,
       tpl_goodsowner          d,
       pub_employee            e,
       zx_goodsowner_employee  f,
       zx_goodsowner_employee  g,
       wms_goods_lot           h
where a.ownergoodsid = b.ownergoodsid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.companyid=c.companyid(+)
   and a.inputmanid = e.employeeid(+)
   and a.wtfqualitydeptmanid=f.employeeid(+)
   and a.wtfrelatedeptmaidid=g.employeeid(+)
   and a.lotno = h.lotno
   and b.waregoodsid = h.goodsid
"
"LY_API_QUERY_CONSERVE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LY_API_QUERY_CONSERVE_V"" (""WAREHID"", ""GOODSOWNERID"", ""CONSERVEDATE"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACK"", ""FACTNAME"", ""PRODAREA"", ""MAH"", ""APPROVEDOCNO"", ""PRODLICENSENO"", ""GOODSQTY"", ""QUILITYQTY"", ""UNQUILITYQTY"", ""GOODSSTATUSID"", ""QUANTITYSTATUS"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""CHECKMAN"", ""RESULT"", ""CONSERVEID"") AS 
  select a.warehid,
       a.goodsownerid,
       a.conservedate,
       b.goodsownid,
       b.goodsname,
       b.goodsengname,
       b.goodstype,
       b.tradepackname as tradepack,
       b.factname,
       b.prodarea,
       nvl(c.mah,b.mah) as mah,
       nvl(c.approvedocno,b.approvedocno) as approvedocno,
       b.prodlicenseno,
       a.goodsqty,
       a.quilityqty,
       a.unquilityqty,
       a.goodsstatusid,
       d.quantitystatus,
       c.lotno,
       to_char(c.proddate,'yyyy-mm-dd') as proddate,
       to_char(c.validdate,'yyyy-mm-dd') as validdate,
       e.employeename as checkman,
       a.result,
       a.conserveid
  from gsp_conserve a, tpl_goods b,wms_goods_lot c,wms_goodsstatus d,pub_employee e
 where a.ownergoodsid = b.ownergoodsid(+)
   and a.lotid=c.lotid(+)
   and a.goodsstatusid=d.goodsstatusid(+)
   and a.checkmanid=e.employeeid(+)
"
"LY_API_QUERY_INCHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LY_API_QUERY_INCHECK_V"" (""WAREHID"", ""GOODSOWNERID"", ""CHECKDATE"", ""ORDERID"", ""COMPANYID"", ""OPERATIONTYPE"", ""ORDERDTLID"", ""RECEIVEID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSTYPE"", ""TRADEPACK"", ""GOODSQTY"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""MAH"", ""GOODSTATUS"", ""QUANSTATUS"", ""PRODAREA"", ""FACTNAME"", ""CHECKMAN"", ""CHECKMAN2"") AS 
  select a.warehid, --物流中心ID
       a.goodsownerid, --货主ID
       c.checkdate as checkdate, --验收时间
       a.zxcolumn4 as orderid, --ERP总单ID
       f.gcompanyid as companyid, --来货单位ID
       a.operationtype as operationtype, --业务类型（业务类型：1-进货 7-销退 9-移库入 22-报溢 42-收配退）
       b.dtlzxcolumn4 as orderdtlid, --ERP细单ID
       c.receiveid as receiveid, --WMS验收记录主键
       g.goodsownid as goodsownid, --货品编码
       g.goodsname as goodsname, --货品名称
       g.goodstype as goodstype, --规格
       g.tradepackname as tradepack, --基本单位
       c.goodsqty as goodsqty, --验收数量
       i.lotno as lotno, --批号
       to_char(i.validdate, 'yyyy-mm-dd') as validdate, --有效期至
       to_char(i.proddate, 'yyyy-mm-dd') as proddate, --生产日期
       nvl(i.approvedocno, g.approvedocno) as approvedocno, --批准文号
       nvl(i.mah, g.mah) as mah, --上市许可持有人
       c.goodsstatusid as goodstatus, --货品状态
       c.quantitystatus as quanstatus, --质量状态
       g.prodarea as prodarea, --产地
       g.factname as factname, --生产厂家
       j.employeename as checkman, --验收员
       k.employeename as checkman2 --第二验收员
  from wms_in_order        a,
       wms_in_order_dtl    b,
       wms_receive_dtl     c,
       tpl_warehouse       d,
       tpl_goodsowner      e,
       tpl_go_company      f,
       tpl_goods           g,
       wms_goods_lot       i,
       pub_employee        j,
       pub_employee        k
 where a.inid = b.inid
   and b.indtlid = c.indtlid
   and a.usestatus = 3 --总单状态 3-完成
   and b.porderstatus = 5 --细单状态 5-上架完成
   and a.warehid = d.warehid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.sourcecompanyid = f.companyid(+)
   and c.ownergoodsid = g.ownergoodsid(+)
   and c.lotid = i.lotid(+)
   and c.inputmanid = j.employeeid(+)
   and c.checkmanid2 = k.employeeid(+)
"
"LY_API_QUERY_OUTCHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LY_API_QUERY_OUTCHECK_V"" (""WAREHID"", ""GOODSOWNERID"", ""CHECKDATE"", ""ORDERID"", ""ORDERDTLID"", ""OPERATIONTYPE"", ""RECCOMPANYID"", ""RECCOMPANYNAME"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACK"", ""FACTNAME"", ""PRODAREA"", ""MAH"", ""APPROVEDOCNO"", ""PRODLICENSENO"", ""GOODSQTY"", ""GOODSTATUS"", ""QUANSTATUS"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""CHECKMAN"", ""CHECKMAN2"", ""INOUTID"") AS 
  select a.warehid,
       a.goodsownerid,
       a.credate as checkdate,
       zx_get_orderid(a.inoutid) as orderid,
       zx_get_orderdtlid(a.inoutid) as orderdtlid,
       a.operationtype,
       a.companyid as reccompanyid,
       b.companyname as reccompanyname,
       c.goodsownid,
       c.goodsname,
       c.goodsengname,
       c.goodstype,
       c.tradepackname as tradepack,
       c.factname,
       c.prodarea,
       nvl(d.mah,c.mah) as mah,
       nvl(d.approvedocno,c.approvedocno) as approvedocno,
       c.prodlicenseno,
       a.goodsqty,
       a.goodsstatusid as goodstatus,
       a.quanstatus,
       d.lotno,
       to_char(d.proddate,'yyyy-mm-dd') as proddate,
       to_char(d.proddate,'yyyy-mm-dd') as validdate,
       e.employeename as checkman,
       f.employeename as checkman2,
       a.inoutid
  from gsp_st_io_record a, tpl_go_company b, tpl_goods c,wms_goods_lot d,pub_employee e,pub_employee f
 where a.companyid = b.companyid(+)
   and a.ownergoodsid = c.ownergoodsid(+)
   and a.lotid = d.lotid(+)
   and a.checkmanid = e.employeeid(+)
   and a.checkman2id=f.employeeid(+)
"
"LY_API_QUERY_RECEIPT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LY_API_QUERY_RECEIPT_V"" (""WAREHID"", ""GOODSOWNERID"", ""RECEIVEDATE"", ""ORDERID"", ""ORDERDTLID"", ""OPERATIONTYPE"", ""SOURCECOMPANYID"", ""SRCCOMPANYNAME"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACK"", ""FACTNAME"", ""PRODAREA"", ""MAH"", ""APPROVEDOCNO"", ""PRODLICENSENO"", ""ARRIVEDATE"", ""ARRIVALTEMPEARTURE"", ""GOODSQTY"", ""RECEIVEMAN"", ""STORAGECONDITION"", ""INDTLID"") AS 
  select a.warehid,
       b.goodsownerid,
       b.shdate           as receivedate,
       a.zxcolumn4        as orderid,
       b.dtlzxcolumn4     as orderdtlid,
       a.operationtype,
       c.gcompanyid       as sourcecompanyid,
       c.companyname      as srccompanyname,
       d.goodsownid,
       d.goodsname,
       d.goodsengname,
       d.goodstype,
       d.tradepackname    as tradepack,
       d.factname,
       d.prodarea,
       d.mah,
       d.approvedocno,
       d.prodlicenseno,
       b.dhdate           as arrivedate,
       b.dhwd             as arrivaltempearture,
       b.qty              as goodsqty,
       e.employeename     as receiveman,
       d.storagecondition,
       b.indtlid
  from wms_in_order     a,
       wms_in_order_dtl b,
       tpl_go_company   c,
       tpl_goods        d,
       pub_employee     e
 where a.inid = b.inid
   and a.usestatus in (1, 2, 3)
   and a.sourcecompanyid = c.companyid(+)
   and b.ownergoodsid = d.ownergoodsid(+)
   and b.shrid = e.employeeid(+)
   and b.clflag=1
"
"LY_API_QUERY_STQTY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LY_API_QUERY_STQTY_V"" (""WAREHID"", ""GOODSOWNERID"", ""OWNERGOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""FACTNAME"", ""PRODAREA"", ""DRUGFORM"", ""APPROVEDOCNO"", ""MAH"", ""PRODLICENSENO"", ""TRADEPACKNAME"", ""PACKSIZE"", ""PACKNAME"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""GOODSQTY"", ""BUSIQTY"") AS 
  select t.warehid, --物流中心ID
       t.goodsownerid, --货主ID
       t.ownergoodsid, --货主货品ID
       a.goodsownid, --货主原货品ID
       a.goodsname, --货品名称/产品名称
       a.goodsengname, --商品名
       a.goodstype, --规格/规格(型号)
       a.factname, --生产厂家/受托生产企业
       a.prodarea, --产地
       a.drugform, --剂型
       a.approvedocno, --批准文号/注册证编号(备案编号)
       a.mah, --上市许可持有人/注册人(备案人)
       a.prodlicenseno, --生产许可证号/生产许可证编号(备案编号)
       a.tradepackname, --基本单位
       d.packsize, --包装大小
       d.packname, --包装名称
       t.lotid, --批号ID
       b.lotno, --批号
       to_char(b.proddate, 'yyyy-mm-dd') proddate, --生产日期
       to_char(b.validdate, 'yyyy-mm-dd') validdate, --有效期/失效期
       t.goodsstatusid, --货品状态ID
       c.goodsstatus, --货品状态
       (select x.ddlname
          from pub_ddl_dtl x
         where x.sysid = 11
           and x.ddlid = c.quantitystatus) quantitystatus, --质量状态
       sum(t.goodsqty) goodsqty, --库存数量
       sum(t.busiqty) busiqty --业务数量
  from wms_st_qty_lst      t,
       tpl_goods           a,
       wms_goods_lot       b,
       wms_goodsstatus     c,
       tpl_pub_goods_packs d
 where t.ownergoodsid = a.ownergoodsid(+)
   and t.lotid = b.lotid(+)
   and t.goodsstatusid = c.goodsstatusid(+)
   and t.goodspackid = d.goodspackid(+)
   and exists (select 1
          from tpl_goodsowner y
         where y.goodsownerid = t.goodsownerid
           and nvl(y.innerflag, 0) = 0)
 group by t.warehid,
          t.goodsownerid,
          t.ownergoodsid,
          a.goodsownid,
          a.goodsname,
          a.goodsengname,
          a.goodstype,
          a.factname,
          a.prodarea,
          a.drugform,
          a.approvedocno,
          a.mah,
          a.prodlicenseno,
          a.tradepackname,
          d.packsize,
          d.packname,
          t.lotid,
          b.lotno,
          to_char(b.proddate, 'yyyy-mm-dd'),
          to_char(b.validdate, 'yyyy-mm-dd'),
          t.goodsstatusid,
          c.goodsstatus,
          c.quantitystatus
"
"LY_API_QUERY_TR_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LY_API_QUERY_TR_V"" (""WAREHID"", ""GOODSOWNERID"", ""ORDERID"", ""OPERATIONTYPE"", ""COMPANYID"", ""COMPANYNAME"", ""CONNECTOR"", ""CONNPHONE"", ""INCEPTADDR"", ""SCATTERPACKS"", ""WHOLEPACKS"", ""DISPATCHDATE"", ""DRIVERNAME"", ""VEHICLENO"", ""SIGNTIME"", ""YDNO"", ""EXCARRIE"") AS 
  select a.warehid,--物流中心ID
       a.goodsownerid,--货主ID
       b.zxcolumn4 as orderid,--ERP单据编号
       a.operationtype,--业务类型
       d.gcompanyid as companyid,--出库单位ID
       d.companyname,--出库单位名称
       c.connector,--收货人
       c.connphone,--联系电话
       c.inceptaddr,--详细地址
       (case
         when a.warehid in (1, 17) and a.comefrom = 1 then
          zx_get_boxno(a.sourceid)
         else
          a.scatterpacks
       end) scatterpacks,--散件件数
       (case
         when a.warehid in (1, 17) and a.comefrom = 1 then
          zx_get_wholeqty(a.sourceid)
         else
          a.wholepacks
       end) wholepacks,--整件件数
       nvl((select to_char(t.loadtime,'yyyy-mm-dd hh24:mi:ss')
          from track_out_order_dispatchmsg t
         where t.dispatchid = a.dispatchid
           and t.outid =  b.outid
           and rownum = 1
           and t.usestatus <> 0),e.dispatchdate) dispatchdate,--派车时间
       nvl((select t.drivername
          from track_out_order_dispatchmsg t
         where t.dispatchid = a.dispatchid
           and t.outid =  b.outid
           and rownum = 1
           and t.usestatus <> 0),e.drivername) as drivername,--主驾驶员
       e.vehicleno,--车牌号
       (select to_char(t.signtime,'yyyy-mm-dd hh24:mi:ss')
          from track_out_order_dispatchmsg t
         where t.dispatchid = a.dispatchid
           and t.outid =  b.outid
           and rownum = 1
           and t.usestatus <> 0) signtime,--签收时间
       a.ydno, --运单号码
       (case when a.excarrier is null and a.warehid=1
         then (select t1.goodsownername from tpl_goodsowner t1 where t1.goodsownerid=1)
           when a.excarrier is null and a.warehid=2
         then (select t1.goodsownername from tpl_goodsowner t1 where t1.goodsownerid=3)
           when a.excarrier is null and a.warehid=17
         then (select t1.goodsownername from tpl_goodsowner t1 where t1.goodsownerid=706)
           else
       (select t.ddlname
          from pub_ddl_dtl t
         where t.sysid = 810
           and t.ddlid = a.excarrier) end) excarrie --承运商
  from tms_tr_doc a,
       wms_out_order b,
       wms_transport_address c,
       tpl_go_company d,
       (select x.dispatchid,
               to_char(x.dispatchdate, 'yyyy-mm-dd hh24:mi:ss') dispatchdate,
               x.vehicleid,
               x1.vehicleno,
               x2.driverid,
               x2.drivername,
               x.inputmanid,
               x3.employeename inputman,
               x.credate
          from tms_dispatch_doc x,
               tms_vehicle      x1,
               tms_driver       x2,
               pub_employee     x3
         where x.vehicleid = x1.vehicleid(+)
           and x.driverid = x2.driverid(+)
           and x.inputmanid = x3.employeeid(+)
        union all
        select y.dispatchid,
               to_char(y.credate, 'yyyy-mm-dd hh24:mi:ss') dispatchdate,
               y.vehicleid,
               y1.vehicleno,
               y2.driverid,
               y2.drivername,
               y.inputmanid,
               y3.employeename inputman,
               y.credate
          from tms_luyan_dispatch_doc y,
               tms_vehicle            y1,
               tms_driver             y2,
               pub_employee           y3
         where y.vehicleid = y1.vehicleid(+)
           and y.driverid = y2.driverid(+)
           and y.inputmanid = y3.employeeid(+)) e
 where a.dispatchid is not null
   and a.transid = c.transid(+)
   and a.gcompanyid = d.companyid(+)
   and a.comefrom = 1
   and a.sourcetable = 1
   and a.sourceid = b.wavedtlid
   and a.dispatchid = e.dispatchid
"
"LY_API_TRADE_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LY_API_TRADE_ORDER_V"" (""TRADEDATE"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACK"", ""FACTNAME"", ""PRODAREA"", ""APPROVEDOCNO"", ""MAH"", ""PRODLICENSENO"", ""FROMLOTID"", ""FROMLOTNO"", ""TOLOTID"", ""TOLOTNO"", ""FROMGOODSSTATUS"", ""TOGOODSSTATUS"", ""INPUTMANID"", ""INPUTMAN"", ""MEMO"", ""TRADEDTLID"") AS 
  select a.confirmdate       as tradedate, --调整时间
       a.warehid,--物流中心ID
       a.goodsownerid,--货主ID
       c.goodsownid,--货主原货品ID：ERP系统货品编码
       c.goodsname,--货品名称(通用名)
       c.goodsengname,--商品名
       c.goodstype,--规格
       c.tradepackname     as tradepack,--基本单位
       c.factname,--生产厂家
       c.prodarea,--产地
       c.approvedocno,--批准文号
       c.mah,--上市许可持有人
       c.prodlicenseno,--生产许可证号
       b.fromlotid,--原批号ID
       d.lotno             as fromlotno,--原批号
       b.tolotid,--调整后批号ID
       e.lotno             as tolotno,--调整后批号
       b.fromgoodsstatusid as fromgoodsstatus,--原货品状态
       b.togoodsstatusid   as togoodsstatus,--调整后货品状态
       a.inputmanid,--录入人ID
       f.employeename      as inputman,--录入人
       a.memo,--备注
       b.tradedtlid --库存明细调整ID(WMS记录主键)
  from wms_trade_order a,
       wms_trade_dtl   b,
       tpl_goods       c,
       wms_goods_lot   d,
       wms_goods_lot   e,
       pub_employee    f
 where a.tradeid = b.tradeid
   and a.operationtype in (24, 31) --库存明细调整的业务类型
   and a.usestatus = 3 --完成状态
   and a.billfrom = 1 --单据来源:1-手工填单
   and b.ownergoodsid = c.ownergoodsid
   and b.fromlotid = d.lotid(+)
   and b.tolotid = e.lotid(+)
   and a.inputmanid = f.employeeid(+)
"
"LY_ZX_WMS_JCSJJC1_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LY_ZX_WMS_JCSJJC1_V"" (""GOODSID"", ""BB"", ""ENTRYID"", ""备注"", ""BUSISCOPENAME"", ""STORAGECONDITION1"") AS 
  SELECT distinct b.goodsid, 999 bb, a.entryid, '需下传货品基础数据-ERP800003' 备注,'' busiscopename,
                '' storagecondition1
  FROM lyerp.bms_su_con_doc a, lyerp.bms_su_con_dtl b
 WHERE b.goodsid not in
       (SELECT t.goodsownid FROM tpl_goods t WHERE t.goodsownerid = 164)
   and a.suconid = b.suconid
   and a.credate > to_date('2016-12-20 00:00:00', 'yyyy-mm-dd hh24:mi:ss')
   and a.entryid = 164
   and b.usestatus in (2, 3)

union all

SELECT distinct b.goodsid, c.waregoodsid, a.entryid,
                '需维护货品长宽高-6100 货品主档维护（小包装:5，大包装：25）' 备注,'' busiscopename,
                '' storagecondition1
  FROM lyerp.bms_su_con_doc a, lyerp.bms_su_con_dtl b, tpl_goods c
 WHERE b.goodsid not in
       (SELECT distinct t1.goodsownid
          FROM Tpl_Pub_Goods_Packs t, tpl_goods t1
         WHERE t.goodsid = t1.waregoodsid
           and t1.goodsownerid = 164
           and (nvl(t.goodslength, 0) * nvl(t.goodswidth, 0) *
               nvl(t.goodsweight, 0) * nvl(t.goodsheight, 0)) <> 0)
   and a.suconid = b.suconid
   and a.credate > to_date('2016-12-20 00:00:00', 'yyyy-mm-dd hh24:mi:ss')
   and a.entryid = 164
   and b.usestatus in (2, 3)
   and b.goodsid = c.goodsownid(+)
   and c.goodsownerid = 164
union all

SELECT distinct b.goodsid, c.waregoodsid, a.entryid,
                '需维护货品存储属性-4201 货品存储属性定义（频率ABC，分类要准确，码放量按参考或设小一些）' 备注, g.busiscopename,
                decode(g.storagecondition, 1, '常温', 2, '阴凉', 3, '冷藏', 4,
                        '冷冻', 5, '恒温', '未维护') storagecondition1
  FROM lyerp.bms_su_con_doc a, lyerp.bms_su_con_dtl b, tpl_goods c, lyerp.pub_goods_V g
 WHERE b.goodsid not in (SELECT distinct t1.goodsownid
                           FROM wms_goods_feature t, tpl_goods t1
                          WHERE t.goodsid = t1.waregoodsid
                            and t1.goodsownerid = 164
                            and t.warehid = 8)
   and a.suconid = b.suconid
   and a.credate > to_date('2016-12-20 00:00:00', 'yyyy-mm-dd hh24:mi:ss')
   and a.entryid = 164
   and b.usestatus in (2, 3)
   and b.goodsid = c.goodsownid(+)
   and b.goodsid = g.goodsid
   and c.goodsownerid = 164

union all

SELECT distinct b.goodsid, c.waregoodsid, a.entryid,
                '需维护货品存储属性-4202 货品货位类型存储属性定义（要先维护长宽高重量）' 备注,'' busiscopename,
                '' storagecondition1
  FROM lyerp.bms_su_con_doc a, lyerp.bms_su_con_dtl b, tpl_goods c
 WHERE b.goodsid not in (SELECT distinct t1.goodsownid
                           FROM Wms_goods_to_postype_v t, tpl_goods t1
                          WHERE t.goodsid = t1.waregoodsid
                            and t1.goodsownerid = 164
                            and t.warehid = 8)
   and a.suconid = b.suconid
   and a.credate > to_date('2016-12-20 00:00:00', 'yyyy-mm-dd hh24:mi:ss')
   and a.entryid = 164
   and b.usestatus in (2, 3)
   and b.goodsid = c.goodsownid(+)
   and c.goodsownerid = 164

union all

SELECT distinct b.goodsid, c.waregoodsid, a.entryid,
                '产品批件过期或未维护-6204货主货品信息维护' 备注,'' busiscopename,
                '' storagecondition1
  FROM lyerp.bms_su_con_doc a, lyerp.bms_su_con_dtl b, tpl_goods c
 WHERE b.goodsid in
       (SELECT t2.goodsownid
          FROM (SELECT t1.goodsownid, t1.productapproval, t1.gmpinvaliddate
                   FROM lywms.tpl_goods t1
                  where t1.goodsownerid = 164
                    and t1.drugform not in
                        (SELECT k.drugform
                           FROM lywms.tpl_drugform k
                          WHERE k.drugformid in
                                (2, 3, 4, 5, 6, 7, 8, 112, 113, 114, 117, 121,
                                 124))) t2
 WHERE nvl(t2.productapproval, sysdate - 1) < sysdate） --产品批件
   and a.suconid = b.suconid
   and a.credate > to_date('2016-12-20 00:00:00', 'yyyy-mm-dd hh24:mi:ss')
   and a.entryid = 164
   and b.usestatus in (2, 3)
   and b.goodsid = c.goodsownid(+)
   and c.goodsownerid = 164

union all

SELECT distinct b.goodsid, c.waregoodsid, a.entryid,
                '产品GMP过期或未维护-6204货主货品信息维护' 备注,'' busiscopename,
                '' storagecondition1
  FROM lyerp.bms_su_con_doc a, lyerp.bms_su_con_dtl b, tpl_goods c
 WHERE b.goodsid in
       (SELECT t2.goodsownid
          FROM (SELECT t1.goodsownid, t1.productapproval, t1.gmpinvaliddate
                   FROM lywms.tpl_goods t1
                  where t1.goodsownerid = 164
                    and t1.drugform not in
                        (SELECT k.drugform
                           FROM lywms.tpl_drugform k
                          WHERE k.drugformid in
                                (2, 3, 4, 5, 6, 7, 8, 113, 117, 121, 124, 1, 118,
                                 120))) t2
         WHERE nvl(t2.gmpinvaliddate, sysdate - 1) < sysdate) --GMP
   and a.suconid = b.suconid
   and a.credate > to_date('2016-12-20 00:00:00', 'yyyy-mm-dd hh24:mi:ss')
   and a.entryid = 164
   and b.usestatus in (2, 3)
   and b.goodsid = c.goodsownid(+)
   and c.goodsownerid = 164

union all

SELECT distinct a.supplyid, 999 bb, a.entryid, '需下传供应商数据-ERP800001' 备注,'' busiscopename,
                '' storagecondition1
  FROM lyerp.bms_su_con_doc a, lyerp.bms_su_con_dtl b
 WHERE a.supplyid not in (select distinct t.gcompanyid
                            from Tpl_go_company t
                           where goodsownerid = 164
                             and companystyle = 2
                             and usestatus = 1)
   and a.suconid = b.suconid
   and a.credate > to_date('2016-12-20 00:00:00', 'yyyy-mm-dd hh24:mi:ss')
   and a.entryid = 164
   and b.usestatus in (2, 3)

union all

SELECT distinct b.goodsid, c.waregoodsid, a.entryid, '疑似未维护大包装件' 备注, '' busiscopename,
                '' storagecondition1
  FROM lyerp.bms_su_con_doc a, lyerp.bms_su_con_dtl b, tpl_goods c
 WHERE b.goodsid not in (SELECT distinct t1.goodsownid
                           FROM Tpl_Pub_Goods_Packs t, tpl_goods t1
                          WHERE t.goodsid = t1.waregoodsid
                            and t1.goodsownerid = 164
                            and t.packname not like '件')
   and a.suconid = b.suconid
   and a.credate > to_date('2016-12-20 00:00:00', 'yyyy-mm-dd hh24:mi:ss')
   and a.entryid = 164
   and b.usestatus in (2, 3)
   and b.goodsid = c.goodsownid(+)
   and c.goodsownerid = 164
"
"LY_ZX_WMS_JCSJJC2_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LY_ZX_WMS_JCSJJC2_V"" (""GOODSID"", ""BB"", ""ENTRYID"", ""备注"", ""BUSISCOPENAME"", ""STORAGECONDITION1"") AS 
  SELECT distinct b.goodsid, 999 bb, a.entryid, '需下传货品基础数据-ERP800003' 备注,'' busiscopename,
                '' storagecondition1
  FROM lyerp.bms_su_con_doc a, lyerp.bms_su_con_dtl b
 WHERE b.goodsid not in
       (SELECT t.goodsownid FROM tpl_goods t WHERE t.goodsownerid = 124)
   and a.suconid = b.suconid
   and a.credate > to_date('2016-12-20 00:00:00', 'yyyy-mm-dd hh24:mi:ss')
   and a.entryid = 124
   and b.usestatus in (2, 3)

union all

SELECT distinct b.goodsid, c.waregoodsid, a.entryid,
                '需维护货品长宽高-6100 货品主档维护（小包装:5，大包装：25）' 备注,'' busiscopename,
                '' storagecondition1
  FROM lyerp.bms_su_con_doc a, lyerp.bms_su_con_dtl b, tpl_goods c
 WHERE b.goodsid not in
       (SELECT distinct t1.goodsownid
          FROM Tpl_Pub_Goods_Packs t, tpl_goods t1
         WHERE t.goodsid = t1.waregoodsid
           and t1.goodsownerid = 124
           and (nvl(t.goodslength, 0) * nvl(t.goodswidth, 0) *
               nvl(t.goodsweight, 0) * nvl(t.goodsheight, 0)) <> 0)
   and a.suconid = b.suconid
   and a.credate > to_date('2016-12-20 00:00:00', 'yyyy-mm-dd hh24:mi:ss')
   and a.entryid = 124
   and b.usestatus in (2, 3)
   and b.goodsid = c.goodsownid(+)
   and c.goodsownerid = 124
union all

SELECT distinct b.goodsid, c.waregoodsid, a.entryid,
                '需维护货品存储属性-4201 货品存储属性定义（频率ABC，分类要准确，码放量按参考或设小一些）' 备注, g.busiscopename,
                decode(g.storagecondition, 1, '常温', 2, '阴凉', 3, '冷藏', 4,
                        '冷冻', 5, '恒温', '未维护') storagecondition1
  FROM lyerp.bms_su_con_doc a, lyerp.bms_su_con_dtl b, tpl_goods c, lyerp.pub_goods_V g
 WHERE b.goodsid not in (SELECT distinct t1.goodsownid
                           FROM wms_goods_feature t, tpl_goods t1
                          WHERE t.goodsid = t1.waregoodsid
                            and t1.goodsownerid = 124
                            and t.warehid = 8)
   and a.suconid = b.suconid
   and a.credate > to_date('2016-12-20 00:00:00', 'yyyy-mm-dd hh24:mi:ss')
   and a.entryid = 124
   and b.usestatus in (2, 3)
   and b.goodsid = c.goodsownid(+)
   and b.goodsid = g.goodsid
   and c.goodsownerid = 124

union all

SELECT distinct b.goodsid, c.waregoodsid, a.entryid,
                '需维护货品存储属性-4202 货品货位类型存储属性定义（要先维护长宽高重量）' 备注,'' busiscopename,
                '' storagecondition1
  FROM lyerp.bms_su_con_doc a, lyerp.bms_su_con_dtl b, tpl_goods c
 WHERE b.goodsid not in (SELECT distinct t1.goodsownid
                           FROM Wms_goods_to_postype_v t, tpl_goods t1
                          WHERE t.goodsid = t1.waregoodsid
                            and t1.goodsownerid = 124
                            and t.warehid = 8)
   and a.suconid = b.suconid
   and a.credate > to_date('2016-12-20 00:00:00', 'yyyy-mm-dd hh24:mi:ss')
   and a.entryid = 124
   and b.usestatus in (2, 3)
   and b.goodsid = c.goodsownid(+)
   and c.goodsownerid = 124

union all

SELECT distinct b.goodsid, c.waregoodsid, a.entryid,
                '产品批件过期或未维护-6204货主货品信息维护' 备注,'' busiscopename,
                '' storagecondition1
  FROM lyerp.bms_su_con_doc a, lyerp.bms_su_con_dtl b, tpl_goods c
 WHERE b.goodsid in
       (SELECT t2.goodsownid
          FROM (SELECT t1.goodsownid, t1.productapproval, t1.gmpinvaliddate
                   FROM lywms.tpl_goods t1
                  where t1.goodsownerid = 124
                    and t1.drugform not in
                        (SELECT k.drugform
                           FROM lywms.tpl_drugform k
                          WHERE k.drugformid in
                                (2, 3, 4, 5, 6, 7, 8, 112, 113, 114, 117, 121,
                                 124))) t2
 WHERE nvl(t2.productapproval, sysdate - 1) < sysdate） --产品批件
   and a.suconid = b.suconid
   and a.credate > to_date('2016-12-20 00:00:00', 'yyyy-mm-dd hh24:mi:ss')
   and a.entryid = 124
   and b.usestatus in (2, 3)
   and b.goodsid = c.goodsownid(+)
   and c.goodsownerid = 124

union all

SELECT distinct b.goodsid, c.waregoodsid, a.entryid,
                '产品GMP过期或未维护-6204货主货品信息维护' 备注,'' busiscopename,
                '' storagecondition1
  FROM lyerp.bms_su_con_doc a, lyerp.bms_su_con_dtl b, tpl_goods c
 WHERE b.goodsid in
       (SELECT t2.goodsownid
          FROM (SELECT t1.goodsownid, t1.productapproval, t1.gmpinvaliddate
                   FROM lywms.tpl_goods t1
                  where t1.goodsownerid = 124
                    and t1.drugform not in
                        (SELECT k.drugform
                           FROM lywms.tpl_drugform k
                          WHERE k.drugformid in
                                (2, 3, 4, 5, 6, 7, 8, 113, 117, 121, 124, 1, 118,
                                 120))) t2
         WHERE nvl(t2.gmpinvaliddate, sysdate - 1) < sysdate) --GMP
   and a.suconid = b.suconid
   and a.credate > to_date('2016-12-20 00:00:00', 'yyyy-mm-dd hh24:mi:ss')
   and a.entryid = 124
   and b.usestatus in (2, 3)
   and b.goodsid = c.goodsownid(+)
   and c.goodsownerid = 124

union all

SELECT distinct a.supplyid, 999 bb, a.entryid, '需下传供应商数据-ERP800001' 备注,'' busiscopename,
                '' storagecondition1
  FROM lyerp.bms_su_con_doc a, lyerp.bms_su_con_dtl b
 WHERE a.supplyid not in (select distinct t.gcompanyid
                            from Tpl_go_company t
                           where goodsownerid = 124
                             and companystyle = 2
                             and usestatus = 1)
   and a.suconid = b.suconid
   and a.credate > to_date('2016-12-20 00:00:00', 'yyyy-mm-dd hh24:mi:ss')
   and a.entryid = 124
   and b.usestatus in (2, 3)

union all

SELECT distinct b.goodsid, c.waregoodsid, a.entryid, '疑似未维护大包装件' 备注,'' busiscopename,
                '' storagecondition1
  FROM lyerp.bms_su_con_doc a, lyerp.bms_su_con_dtl b, tpl_goods c
 WHERE b.goodsid not in (SELECT distinct t1.goodsownid
                           FROM Tpl_Pub_Goods_Packs t, tpl_goods t1
                          WHERE t.goodsid = t1.waregoodsid
                            and t1.goodsownerid = 124
                            and t.packname not like '件')
   and a.suconid = b.suconid
   and a.credate > to_date('2016-12-20 00:00:00', 'yyyy-mm-dd hh24:mi:ss')
   and a.entryid = 124
   and b.usestatus in (2, 3)
   and b.goodsid = c.goodsownid(+)
   and c.goodsownerid = 124
"
"LY_ZX_WMS_QTYLST_VALID_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LY_ZX_WMS_QTYLST_VALID_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSOPCODE"", ""BARCODE"", ""GOODSPINYIN"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTNAME"", ""TRADEPACKNAME"", ""LOTFACTNAME"", ""GOODSQTY"", ""BUSIQTY"", ""POSQTY"", ""POSWAITQTY"", ""TRADEINWAITQTY"", ""OUTWAITQTY"", ""OWNERGOODSID"", ""BATCHNO"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""POSID"", ""POSNO"", ""POSNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""SORTTYPE"", ""AREATYPE"", ""AREAFLAG"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSOWNID"", ""GOODSNO"", ""SUPPLYERNAME"", ""VARIETYDESCID"", ""VARIETYNAME"", ""VARIETYNO"", ""CONTAINERID"", ""CONTAINERNO"", ""TYPEID"", ""PCS"", ""FILEGROUPIDC"") AS 
  SELECT ""WAREHID"",
       ""WAREHNAME"",
       ""GOODSOWNERID"",
       ""GOODSOWNERNAME"",
       ""GOODSID"",
       ""GOODSOPCODE"",
       ""BARCODE"",
       ""GOODSPINYIN"",
       ""GOODSNAME"",
       ""GOODSENGNAME"",
       ""GOODSTYPE"",
       ""PRODAREA"",
       ""FACTID"",
       ""FACTNAME"",
       ""TRADEPACKNAME"",
       ""LOTFACTNAME"",
       ""GOODSQTY"",
       ""BUSIQTY"",
       ""POSQTY"",
       ""POSWAITQTY"",
       ""TRADEINWAITQTY"",
       ""OUTWAITQTY"",
       ""OWNERGOODSID"",
       ""BATCHNO"",
       ""GOODSPACKID"",
       ""PACKNAME"",
       ""PACKSIZE"",
       ""POSID"",
       ""POSNO"",
       ""POSNAME"",
       ""AREAID"",
       ""AREANO"",
       ""AREANAME"",
       ""SECTIONID"",
       ""SECTIONNO"",
       ""SECTIONNAME"",
       ""SORTTYPE"",
       ""AREATYPE"",
       ""AREAFLAG"",
       ""LOTID"",
       ""LOTNO"",
       ""VALIDDATE"",
       ""PRODDATE"",
       ""APPROVEDOCNO"",
       ""GOODSSTATUSID"",
       ""GOODSSTATUS"",
       ""QUANTITYSTATUS"",
       ""USEFLAG"",
       ""GOODSOWNID"",
       ""GOODSNO"",
       null SUPPLYERNAME,
       ""VARIETYDESCID"",
       ""VARIETYNAME"",
       ""VARIETYNO"",
       ""CONTAINERID"",
       ""CONTAINERNO"",
       ""TYPEID"",
       ""PCS"",
       ""FILEGROUPIDC""
  FROM wms_st_qty_lst_v a
 WHERE a.validdate - Sysdate < 180
   and a.warehid =2
"
"LY_ZZZZZ_1012_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""LY_ZZZZZ_1012_V"" (""INID"") AS 
  select inid
  from wms_in_order_dtl_v
 where dtlzxcolumn4 in
       ('1365760', '1365761')
"
"MEDICALDEVICE_CONSERVE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""MEDICALDEVICE_CONSERVE_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CONSERVEDATE"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""APPROVEDOCNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""GOODSQTY"", ""GOODSUNIT"", ""SECTIONID"", ""SECTIONNAME"", ""POSID"", ""POSNAME"", ""STORAGECONDITION"", ""PACKAGE"", ""QUANSTANDARD"", ""CHECKMANID"", ""CHECKMAN"", ""CONSERVEID"") AS 
  select a.warehid,
       b.warehname,
       a.goodsownerid, --货主ID
       c.goodsownername, --委托方名称
       a.conservedate, --检查日期
       a.ownergoodsid,
       a.goodsid, --货品主档ID
       d.goodsownid,
       d.goodsname, --医疗器械名称
       d.mah, --医疗器械注册人/备案人
       d.factname, --受托生产企业名称
       d.goodstype, --规格/型号
       d.approvedocno, --医疗器械注册证编号/备案编号
       a.lotid,
       e.lotno, --医疗器械的生产批号/序列号
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate, --使用期限/失效日期
       a.goodsqty, --数量
       a.goodsunit, --单位
       f.sectionid,
       g.sectionname, --库区
       a.posid,
       f.posname, --货位
       d.storagecondition, --贮存条件
       a.package, --标签、包装情况
       a.quanstandard, --质量状况
       a.checkmanid,
       h.employeename checkman, --检查人员
       a.conserveid
  from gsp_conserve       a,
       tpl_warehouse      b,
       tpl_goodsowner     c,
       tpl_goods          d,
       wms_goods_lot      e,
       wms_pos_def        f,
       wms_st_section_def g,
       pub_employee       h
 where a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.ownergoodsid = d.ownergoodsid(+)
   and a.lotid = e.lotid(+)
   and a.posid = f.posid(+)
   and f.sectionid = g.sectionid(+)
   and a.checkmanid = h.employeeid(+)
   and exists (select 1
          from wms_goods_feature x, pub_ddl_dtl y
         where x.goodsclass = y.ddlid
           and y.sysid = 9
           and nvl(y.qxflag, 0) = 1
           and a.warehid = x.warehid
           and a.goodsid = x.goodsid) --器械WMS货品分类
"
"MEDICALDEVICE_INCHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""MEDICALDEVICE_INCHECK_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CHECKDATE"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""COMPANYID"", ""COMPANYNAME"", ""SUPPLYERADDRESS"", ""SUPPLYERCONNPHONE"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""APPROVEDOCNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""UDI_CODE"", ""GOODSQTY"", ""TRADEPACKNAME"", ""TRANSCONDITION"", ""STORAGECONDITION"", ""DECISIONFLAG"", ""QUALIFIEDQTY"", ""UNQUALIFIEDMEMO"", ""CHECKMEMO"", ""CHECKMANID"", ""CHECKMAN"", ""CHECKID"", ""PRODLICENSENO"", ""CREDATE"", ""OPERATIONTYPE"") AS 
  select a.warehid,
       c.warehname,
       a.goodsownerid, --货主ID
       d.goodsownername, --委托方名称
       b.checkdate, --验收日期
       b.ownergoodsid,
       b.goodsid, --货品主档ID
       f.goodsownid,
       a.companyid,
       e.companyname, --供货者名称
       e.supplyeraddress, --供货者地址
       e.supplyerconnphone, --供货者联系方式
       f.goodsname, --医疗器械名称
       f.mah, --医疗器械注册人/备案人
       f.factname, --受托生产企业名称
       f.goodstype, --规格/型号
       f.approvedocno, --医疗器械注册证编号/备案编号
       a.lotid,
       g.lotno, --医疗器械的生产批号/序列号
       g.proddate,--生产日期
       decode(to_char(g.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              g.validdate) validdate, --使用期限/失效日期
       f.udi_code, --医疗器械唯一标识
       a.goodsqty, --数量
       f.tradepackname, --单位
       (select t.transclass from wms_goods_feature t where t.warehid=a.warehid and t.goodsid=a.goodsid) transcondition, --运输条件
       f.storagecondition, --贮存条件
       decode(a.quanstatus, 1, 1, 2, 3, 3, 2, 4) decisionflag, --验收结论
       decode(a.goodsstatusid, 1, a.goodsqty, 9, a.goodsqty, 0) qualifiedqty, --验收合格数量
       b.unqualifiedmemo, -- 处置措施
       decode(b.unqualifiedmemo,null,null,b.checkmemo) as checkmemo,--不合格事项
       a.inputmanid checkmanid,
       h.employeename checkman, --验收人员
       a.checkid,
       f.prodlicenseno,--生产许可证号
       i.credate,--购货日期
       i.operationtype --业务类型
  from gsp_physic_quality_check a,
       wms_receive_dtl          b,
       tpl_warehouse            c,
       tpl_goodsowner           d,
       tpl_go_company           e,
       tpl_goods                f,
       wms_goods_lot            g,
       pub_employee             h,
       wms_in_order             i,
       wms_in_order_dtl         j
 where a.receiveid = b.receiveid
   and j.indtlid = b.indtlid
   and i.inid = j.inid
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.companyid = e.companyid(+)
   and b.ownergoodsid = f.ownergoodsid(+)
   and a.lotid = g.lotid(+)
   and a.inputmanid = h.employeeid(+)
   and exists (select 1
          from wms_goods_feature x, pub_ddl_dtl y
         where x.goodsclass = y.ddlid
           and y.sysid = 9
           and nvl(y.qxflag, 0) = 1
           and a.warehid = x.warehid
           and a.goodsid = x.goodsid) --器械WMS货品分类
"
"MEDICALDEVICE_OUTCHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""MEDICALDEVICE_OUTCHECK_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""KEEPDATE"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""APPROVEDOCNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""UDI_CODE"", ""GOODSQTY"", ""TRADEPACKNAME"", ""TRANSCONDITION"", ""STORAGECONDITION"", ""QUANSTATUS"", ""CHECKMANID"", ""CHECKMAN"", ""INOUTID"", ""BUYER"", ""OUTDATE"") AS 
  select a.warehid,
       b.warehname,
       a.goodsownerid, --货主ID
       c.goodsownername, --委托方名称
       a.keepdate, --复核日期
       a.ownergoodsid,
       a.goodsid, --货品主档ID
       d.goodsownid,
       d.goodsname, --医疗器械名称
       d.mah, --医疗器械注册人/备案人
       d.factname, --受托生产企业名称
       d.goodstype, --规格/型号
       d.approvedocno, --医疗器械注册证编号/备案编号
       a.lotid,
       e.lotno, --医疗器械的生产批号/序列号
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate, --使用期限/失效日期
       d.udi_code, --医疗器械唯一标识
       a.goodsqty, --复核数量
       d.tradepackname, --单位
       (select t.transclass from wms_goods_feature t where t.warehid=a.warehid and t.goodsid=a.goodsid) transcondition, --运输条件
       d.storagecondition, --贮存条件
       a.quanstatus, --复核质量状况
       a.checkmanid,
       f.employeename checkman, --复核人员
       a.inoutid,
       g.companyname as buyer,--购货者
       a.keepdate as outdate --出库日期
  from gsp_st_io_record a,
       tpl_warehouse    b,
       tpl_goodsowner   c,
       tpl_goods        d,
       wms_goods_lot    e,
       pub_employee     f,
       tpl_go_company   g
 where a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.ownergoodsid = d.ownergoodsid(+)
   and a.lotid = e.lotid(+)
   and a.checkmanid = f.employeeid(+)
   and a.companyid=g.companyid(+)
   and exists (select 1
          from wms_goods_feature x, pub_ddl_dtl y
         where x.goodsclass = y.ddlid
           and y.sysid = 9
           and nvl(y.qxflag, 0) = 1
           and a.warehid = x.warehid
           and a.goodsid = x.goodsid) --器械WMS货品分类
"
"MEDICALDEVICE_OUT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""MEDICALDEVICE_OUT_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""TIME4"", ""RECCOMPANYID"", ""COMPANYNAME"", ""TRANSID"", ""INCEPTADDR"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""APPROVEDOCNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""UDI_CODE"", ""GOODSQTY"", ""TRADEGOODSPACK"", ""TRANSCONDITION"", ""STORAGECONDITION"", ""OUTID"", ""OUTDTLID"", ""ZXCOLUMN4"", ""DTLZXCOLUMN4"") AS 
  select a.warehid,
       c.warehname,
       a.goodsownerid, --货主ID
       d.goodsownername, --委托方名称
       a.time4, --发货日期(复核完成时间)
       a.reccompanyid,
       e.companyname, --收货单位名称
       a.transid,
       g.inceptaddr, --收货地址
       b.ownergoodsid,
       b.goodsid, --货品主档ID
       f.goodsownid,
       f.goodsname, --医疗器械名称
       f.mah, --医疗器械注册人/备案人
       f.factname, --受托生产企业名称
       f.goodstype, --规格/型号
       f.approvedocno, --医疗器械注册证编号/备案编号
       b.lotid,
       h.lotno, --医疗器械的生产批号/序列号
       decode(to_char(h.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              h.validdate) validdate, --使用期限/失效日期
       f.udi_code, --医疗器械唯一标识
       b.goodsqty, --发货数量
       b.tradegoodspack, --单位
       (select t.transclass from wms_goods_feature t where t.warehid=a.warehid and t.goodsid=b.goodsid) transcondition, --运输条件
       f.storagecondition, --贮存条件
       a.outid,
       b.outdtlid,
       a.zxcolumn4,
       b.dtlzxcolumn4
  from wms_out_order         a,
       wms_out_order_dtl     b,
       tpl_warehouse         c,
       tpl_goodsowner        d,
       tpl_go_company        e,
       tpl_goods             f,
       wms_transport_address g,
       wms_goods_lot         h
 where a.outid = b.outid
   and nvl(a.usestatus, 0) = 4 --已出货
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.reccompanyid = e.companyid(+)
   and b.ownergoodsid = f.ownergoodsid(+)
   and a.transid = g.transid(+)
   and b.lotid = h.lotid(+)
   and exists (select 1
          from wms_goods_feature x, pub_ddl_dtl y
         where x.goodsclass = y.ddlid
           and y.sysid = 9
           and nvl(y.qxflag, 0) = 1
           and a.warehid = x.warehid
           and b.goodsid = x.goodsid) --器械WMS货品分类
"
"MEDICALDEVICE_RECEIVING_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""MEDICALDEVICE_RECEIVING_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""SHDATE"", ""SOURCECOMPANYID"", ""COMPANYNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""APPROVEDOCNO"", ""TRADEPACKNAME"", ""QTY"", ""TRANSCONDITION"", ""STORAGECONDITION"", ""YSFS"", ""TRANSNAME"", ""DHWD"", ""SHRID"", ""SHR"", ""INID"", ""INDTLID"", ""ZXCOLUMN4"", ""DTLZXCOLUMN4"") AS 
  select a.warehid,
       c.warehname, --物流单元
       a.goodsownerid, --货主ID
       d.goodsownername, --委托方名称
       b.shdate, --收货日期
       a.sourcecompanyid,
       e.companyname, --供货单位
       b.ownergoodsid,
       b.goodsid, --货品主档ID
       f.goodsownid,
       f.goodsname, --医疗器械名称
       f.mah, --医疗器械注册人/备案人
       f.factname, --受托生产企业名称
       f.goodstype, --规格/型号
       f.approvedocno, --医疗器械注册证编号/备案编号
       f.tradepackname, --包装单位
       b.qty, --数量(收货数量)
       (select t.transclass from wms_goods_feature t where t.warehid=a.warehid and t.goodsid=b.goodsid) transcondition, --运输条件
       f.storagecondition, --贮存条件
       b.ysfs, --运输方式ID
       h.transname, --运输方式
       b.dhwd, --到货温度
       b.shrid,
       g.employeename shr, --收货人员
       a.inid,
       b.indtlid,
       a.zxcolumn4,
       b.dtlzxcolumn4
  from wms_in_order       a,
       wms_in_order_dtl   b,
       tpl_warehouse      c,
       tpl_goodsowner     d,
       tpl_go_company     e,
       tpl_goods          f,
       pub_employee       g,
       wms_transport_mode h
 where a.inid = b.inid
   and nvl(a.usestatus, 0) <> 0 --去掉取消状态的物流入库订单
   and nvl(b.clflag, 0) = 1 --收货完成
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.sourcecompanyid = e.companyid(+)
   and b.ownergoodsid = f.ownergoodsid(+)
   and b.shrid = g.employeeid(+)
   and b.ysfs = h.transmodeid(+)
   and exists (select 1
          from wms_goods_feature x, pub_ddl_dtl y
         where x.goodsclass = y.ddlid
           and y.sysid = 9
           and nvl(y.qxflag, 0) = 1
           and a.warehid = x.warehid
           and b.goodsid = x.goodsid) --器械WMS货品分类
"
"MEDICALDEVICE_RETURNING_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""MEDICALDEVICE_RETURNING_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CHECKDATE"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""COMPANYID"", ""COMPANYNAME"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""APPROVEDOCNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""UDI_CODE"", ""GOODSQTY"", ""TRADEPACKNAME"", ""TRANSCONDITION"", ""STORAGECONDITION"", ""QUANSTATUS"", ""UNQUALIFIEDMEMO"", ""CHECKMEMO"", ""SHRID"", ""SHRMAN"", ""CHECKMANID"", ""CHECKMAN"", ""DHWD"", ""YSFS"", ""TRANSNAME"", ""CHECKID"", ""BMSDOCID"", ""SBREASON"") AS 
  select a.warehid,
       c.warehname,
       a.goodsownerid, --货主ID
       d.goodsownername, --委托方名称
       b.checkdate, --退货日期(验收日期)
       b.ownergoodsid,
       b.goodsid, --货品主档ID
       f.goodsownid,
       a.companyid,
       e.companyname, --退货单位名称
       f.goodsname, --医疗器械名称
       f.mah, --医疗器械注册人/备案人
       f.factname, --受托生产企业名称
       f.goodstype, --规格/型号
       f.approvedocno, --医疗器械注册证编号/备案编号
       a.lotid,
       g.lotno, --医疗器械的生产批号/序列号
       g.proddate,--生产日期
       decode(to_char(g.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              g.validdate) validdate, --使用期限/失效日期
       f.udi_code, --医疗器械唯一标识
       a.goodsqty, --退货数量
       f.tradepackname, --单位
       (select t.transclass from wms_goods_feature t where t.warehid=a.warehid and t.goodsid=a.goodsid) transcondition, --运输条件
       f.storagecondition, --贮存条件
       a.quanstatus, --质量状态
       b.unqualifiedmemo, -- 处置措施
       b.checkmemo,--不合格事项
       j.shrid,
       k.employeename shrman, --收货人员
       a.inputmanid checkmanid,
       h.employeename checkman, --验收人员
       j.dhwd, --到货温度
       j.ysfs, --运输方式ID
       l.transname, --运输方式
       a.checkid,
       i.bmsdocid,--原出库单号
       j.memo as sbreason --退货原因
  from gsp_physic_quality_check a,
       wms_receive_dtl          b,
       tpl_warehouse            c,
       tpl_goodsowner           d,
       tpl_go_company           e,
       tpl_goods                f,
       wms_goods_lot            g,
       pub_employee             h,
       wms_in_order             i,
       wms_in_order_dtl         j,
       pub_employee             k,
       wms_transport_mode       l
 where a.receiveid = b.receiveid
   and j.indtlid = b.indtlid
   and i.inid = j.inid
   and a.operationtype in (7,42) --销退,收配退
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.companyid = e.companyid(+)
   and b.ownergoodsid = f.ownergoodsid(+)
   and a.lotid = g.lotid(+)
   and a.inputmanid = h.employeeid(+)
   and j.shrid = k.employeeid(+)
   and j.ysfs = l.transmodeid(+)
   and exists (select 1
          from wms_goods_feature x, pub_ddl_dtl y
         where x.goodsclass = y.ddlid
           and y.sysid = 9
           and nvl(y.qxflag, 0) = 1
           and a.warehid = x.warehid
           and a.goodsid = x.goodsid) --器械WMS货品分类
"
"MEDICALDEVICE_TRANSPORT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""MEDICALDEVICE_TRANSPORT_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""REALDISPATCHDATE"", ""GCOMPANYID"", ""COMPANYNAME"", ""TRANSID"", ""INCEPTADDR"", ""CONNPHONE"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""APPROVEDOCNO"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""TRADEPACKNAME"", ""SOURCEID"", ""TRANSCONDITION"", ""STORAGECONDITION"", ""SIGNDATE"", ""SELFTRANSTYPE"", ""EXCARRIER"", ""DISPATCHID"", ""VEHICLEID"", ""VEHICLENO"", ""TRANSMODEL"", ""DRIVERID"", ""DRIVERNAME"", ""TRID"", ""WAREHADDRESS"") AS 
  select a.warehid,
       c.warehname,
       a.goodsownerid, --货主ID
       d.goodsownername, --委托方名称
       i.realdispatchdate, --发货时间
       a.gcompanyid,
       e.companyname, --收货单位名称
       a.transid,
       f.inceptaddr, --地址
       f.connphone, --联系方式
       b.ownergoodsid,
       b.goodsid, --货品主档ID
       g.goodsownid,
       g.goodsname, --医疗器械名称
       g.mah, --医疗器械注册人/备案人
       g.factname, --受托生产企业名称
       g.goodstype, --规格/型号
       g.approvedocno, --医疗器械注册证编号/备案编号
       b.lotid,
       h.lotno, --生产批号/序列号
       b.goodsqty, --数量
       g.tradepackname, --单位
       a.sourceid, --随货同行单号
       (select t.transclass from wms_goods_feature t where t.warehid=a.warehid and t.goodsid=b.goodsid) transcondition, --运输条件
       g.storagecondition, --贮存条件
       nvl(a.signdate, a.enddate) signdate, --到货时间
       decode(nvl(a.excarrier,0),0,1,2) selftranstype,--自外运标志 1-自运 2-外运
       a.excarrier, --承运单位名称
       a.dispatchid, --运单号
       i.vehicleid,
       i.vehicleno, --车牌号
       i.transmodel,--运输方式
       i.driverid,
       i.drivername, --运输人员
       a.trid,
       c.warehaddress
  from tms_tr_doc a,
       tms_luyan_tr_dtl b,
       tpl_warehouse c,
       tpl_goodsowner d,
       tpl_go_company e,
       wms_transport_address f,
       tpl_goods g,
       wms_goods_lot h,
       (select t1.realdispatchdate,
               t1.dispatchid,
               t1.vehicleid,
               t2.vehicleno,
               t1.driverid,
               t3.drivername,
               t1.transmodel
          from tms_dispatch_doc t1, tms_vehicle t2, tms_driver t3
         where t1.usestatus in (0, 4, 5) --派车单状态在途、运输完成、撤单
           and t1.vehicleid = t2.vehicleid(+)
           and t1.driverid = t3.driverid(+)
        union all
        select tt1.credate realdispatchdate,
               tt1.dispatchid,
               tt1.vehicleid,
               tt2.vehicleno,
               tt1.driverid,
               tt3.drivername,
               26 transmodel
          from tms_luyan_dispatch_doc tt1, tms_vehicle tt2, tms_driver tt3
         where tt1.vehicleid = tt2.vehicleid(+)
           and tt1.driverid = tt3.driverid(+)) i
 where a.trid = b.trid
   and a.dispatchid = i.dispatchid
   and a.sourcetable = 1 --波次释放
   and a.comefrom = 1 --WMS转入
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.gcompanyid = e.companyid(+)
   and a.transid = f.transid(+)
   and b.ownergoodsid = g.ownergoodsid(+)
   and b.lotid = h.lotid(+)
   and exists (select 1
          from wms_goods_feature x, pub_ddl_dtl y
         where x.goodsclass = y.ddlid
           and y.sysid = 9
           and nvl(y.qxflag, 0) = 1
           and a.warehid = x.warehid
           and b.goodsid = x.goodsid) --器械WMS货品分类
"
"MSFX_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""MSFX_ORDER_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OUTID"", ""ZXCOLUMN4"", ""CREDATE"", ""WAVEDTLID"", ""COMPANYNAME"", ""RECCOMPANYID"", ""OPERATIONTYPE"", ""EXPORTMEMO"", ""SALERNAME"", ""REALRECADDR"", ""SRCEXPNO"", ""UPLOADFLAG"", ""UPLOADDATE"") AS 
  select a.warehid,
       c.warehname,
       a.goodsownerid,
       d.goodsownername,
       a.outid,
       a.zxcolumn4,
       a.credate,
       a.wavedtlid,
       e.companyname,
       a.reccompanyid,
       a.operationtype,
       a.exportmemo,
       a.salername,
       a.realrecaddr,
       a.srcexpno,
       nvl(a.uploadflag, 0) uploadflag,
       a.uploaddate
  from Wms_Out_Order a, tpl_warehouse c, tpl_goodsowner d, tpl_go_company e
 where a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.reccompanyid = e.companyid(+)
   and a.warehid=2
   and a.usestatus=4 --已出货
   and a.goodsownerid in (select t.goodsownerid from tpl_goodsowner t where nvl(t.innerflag,0)<>1)
"
"MSFX_TRANSPORTTEMP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""MSFX_TRANSPORTTEMP_V"" (""REF_ENT_ID"", ""BILL_CODE"", ""TRANSPORT_REF_ENT_ID"", ""TRANSPORT_REF_ENT_NAME"", ""EQUIPMENT_CODE"", ""EQUIPMENT_NAME"", ""DEVTEMPDATETIME"", ""DEVTEMPDATA"", ""RH"", ""AGENT_REF_ENT_ID"", ""TRID"") AS 
  select /*+ USE_NL(F,E) */3 ref_ent_id,
       --3 ref_ent_id,
       a.srcexpno bill_code,
       null transport_ref_ent_id,--运输企业
       null transport_ref_ent_name,--运输名称
       e.devname equipment_code,--设备编号,固定的
       e.devname equipment_name,--设备名称
       e.devtempdatetime,--温度时间
       e.devtempdata,--温度
       e.rh,--湿度
       null agent_ref_ent_id,
       b.trid
  from wms_out_order             a,
       tms_tr_doc                b,
       tms_dispatch_doc          c,
       tms_dispatch_dtl          d,
       tms_luyan_humiture_record e,
       tms_vehicle               f
 where a.wavedtlid = b.sourceid
   and a.warehid=b.warehid
   and a.goodsownerid=b.goodsownerid
   and b.sourcetable = 1 --单据来源 波次释放
   and b.comefrom = 1 --来源 WMS转入
   and c.dispatchid = d.dispatchid
   and nvl(d.usestatus,0) in (0,2) --去掉作废状态
   and b.trid = d.trid
   and nvl(b.uploadflag,0)=0
   and e.devtempdatetime between d.startdate and d.enddate
   and c.vehicleid=f.vehicleid
   and f.devnum = e.devnum
   and a.uploadflag=1
   and a.warehid=2
   and a.goodsownerid in (select t.goodsownerid from tpl_goodsowner t where nvl(t.innerflag,0)=0)
 order by e.devtempdatetime
"
"MSFX_TRANSPORTTEMP_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""MSFX_TRANSPORTTEMP_V1"" (""REF_ENT_ID"", ""BILL_CODE"", ""TRANSPORT_REF_ENT_ID"", ""TRANSPORT_REF_ENT_NAME"", ""EQUIPMENT_CODE"", ""EQUIPMENT_NAME"", ""DEVTEMPDATETIME"", ""DEVTEMPDATA"", ""RH"", ""AGENT_REF_ENT_ID"", ""TRID"") AS 
  select /*+ USE_NL(F,E) */2 ref_ent_id,
       --3 ref_ent_id,
       a.srcexpno bill_code,
       null transport_ref_ent_id,--运输企业
       null transport_ref_ent_name,--运输名称
       e.devname equipment_code,--设备编号,固定的
       e.devname equipment_name,--设备名称
       e.devtempdatetime,--温度时间
       e.devtempdata,--温度
       e.rh,--湿度
       null agent_ref_ent_id,
       b.trid
  from wms_out_order             a,
       tms_tr_doc                b,
       tms_dispatch_doc          c,
       tms_dispatch_dtl          d,
       tms_luyan_humiture_record e,
       tms_vehicle               f
 where a.wavedtlid = b.sourceid
   and a.warehid=b.warehid
   and a.goodsownerid=b.goodsownerid
   and b.sourcetable = 1 --单据来源 波次释放
   and b.comefrom = 1 --来源 WMS转入
   and c.dispatchid = d.dispatchid
   and nvl(d.usestatus,0) in (0,2) --去掉作废状态
   and b.trid = d.trid
   and nvl(b.uploadflag,0)=0
   and e.devtempdatetime between d.startdate and d.enddate
   and c.vehicleid=f.vehicleid
   and f.devnum = e.devnum
   and a.uploadflag=1
   and a.warehid=1
   and a.goodsownerid in (select t.goodsownerid from tpl_goodsowner t where nvl(t.innerflag,0)=0)
 order by e.devtempdatetime
"
"NPBI_INSTANCE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NPBI_INSTANCE_V"" (""REPORTID"", ""INSTANCEID"", ""NPBI_INSTANCEID"", ""YEAR"", ""MONTH"", ""DAY"", ""YEAR1"", ""MONTH1"", ""DAY1"", ""USESTATUS"", ""LASTCALCTIME"", ""REPORTNAME"") AS 
  select
NPBI_INSTANCE.REPORTID,
NPBI_INSTANCE.INSTANCEID,
NPBI_INSTANCE.npbi_instanceid,
NPBI_INSTANCE.YEAR,
NPBI_INSTANCE.MONTH,
NPBI_INSTANCE.DAY,
NPBI_INSTANCE.YEAR1,
NPBI_INSTANCE.MONTH1,
NPBI_INSTANCE.DAY1,
NPBI_INSTANCE.USESTATUS,
NPBI_INSTANCE.LASTCALCTIME,
npbi_report_def.reportname

from
npbi_instance,npbi_report_def
where
npbi_instance.reportid=npbi_report_def.reportid

"
"NPBI_VIEW_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NPBI_VIEW_V"" (""REPORTID"", ""VIEWID"", ""CALCORDER"", ""SQL"", ""JOINTYPE"", ""DSID"", ""MAXROWS"", ""DSNAME"") AS 
  select
NPBI_VIEW.REPORTID,
NPBI_VIEW.VIEWID,
NPBI_VIEW.CALCORDER,
NPBI_VIEW.SQL,
NPBI_VIEW.JOINTYPE,
NPBI_VIEW.DSID,
NPBI_VIEW.maxrows,
npbi_ds.dsname
from
npbi_view,npbi_ds
where
npbi_view.dsid=npbi_ds.dsid(+)
"
"NP_AUTHAREA_DEPT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_AUTHAREA_DEPT_V"" (""SEQID"", ""AREAID"", ""COMPANYID"", ""COMPANYNAME"") AS 
  select np_autharea_dept.""SEQID"",np_autharea_dept.""AREAID"",np_autharea_dept.""COMPANYID"", pub_company.companyname
from np_autharea_dept,pub_company
where
np_autharea_dept.companyid=pub_company.companyid
"
"NP_AUTHAREA_HOV_AP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_AUTHAREA_HOV_AP_V"" (""HOVNAME"", ""CLASSNAME"", ""PRODNAME"", ""MODULENAME"", ""APID"", ""AREAID"", ""HOVID"", ""ROLEID"", ""APTYPE"", ""APNAME"", ""APVALUE"") AS 
  select
NP_HOV.HOVNAME,
NP_HOV.CLASSNAME,
NP_HOV.PRODNAME,
NP_HOV.MODULENAME,
np_autharea_hov_ap.APID,
np_autharea_hov_ap.AREAID,
np_autharea_hov_ap.HOVID,
np_autharea_hov_ap.ROLEID,
np_autharea_hov_ap.APTYPE,
np_autharea_hov_ap.APNAME,
np_autharea_hov_ap.APVALUE
from
np_hov,np_autharea_hov_ap
where
np_hov.hovid=np_autharea_hov_ap.hovid
"
"NP_AUTHAREA_ROLEOP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_AUTHAREA_ROLEOP_V"" (""SEQID"", ""AREAID"", ""ROLEID"", ""OPID"", ""OPNAME"") AS 
  select
np_autharea_roleop.""SEQID"",np_autharea_roleop.""AREAID"",np_autharea_roleop.""ROLEID"",np_autharea_roleop.""OPID"",
np_op.opname
from
np_autharea_roleop,np_op
where
np_autharea_roleop.opid=np_op.opid
"
"NP_AUTHAREA_ROLE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_AUTHAREA_ROLE_V"" (""SEQID"", ""AREAID"", ""ROLEID"", ""ROLENAME"") AS 
  select
np_autharea_role.""SEQID"",np_autharea_role.""AREAID"",np_autharea_role.""ROLEID"",
np_role.rolename
from
np_autharea_role,np_role
where
np_autharea_role.roleid=np_role.roleid
"
"NP_BACKGROUND_TASK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_BACKGROUND_TASK_V"" (""PKID"", ""CLASSNAME"", ""DESCRIB"", ""CREDATE"", ""INPUTMANID"", ""OPCODE"", ""EMPLOYEENAME"") AS 
  select a.pkid,a.""CLASSNAME"", a.""DESCRIB"", a.""CREDATE"", a.""INPUTMANID"",b.opcode,b.employeename
  from np_background_task a,pub_employee b where a.inputmanid=b.employeeid(+)
"
"NP_BI_ROLE_OP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_BI_ROLE_OP_V"" (""ROLEOPID"", ""ROLEID"", ""ROLENAME"", ""COMPONENTID"", ""COMPONENTNAME"", ""CANEXPORT"") AS 
  select  a.roleopid,  a.roleid,  c.rolename,
a.componentid,  b.componentname,nvl(a.canexport,0) canexport
from np_role_op a,bi_component_v b, np_role c
where  a.roleid=c.roleid
and a.componentid=b.componentid
"
"NP_EFILES_DIR_AUTH_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_EFILES_DIR_AUTH_V"" (""SEQID"", ""DIRID"", ""AUTHTYPE"", ""ROLEID"", ""EMPLOYEEID"", ""CREATEDIR"", ""DELDIR"", ""LISTFILES"", ""CREATEFILE"", ""MODIFYFILE"", ""PREVIEWFILE"", ""DOWNLOADFILE"", ""PRINTFILE"", ""MODIFYAUTH"", ""ROLENAME"", ""EMPLOYEENAME"") AS 
  select
Np_efiles_dir_auth.""SEQID"",Np_efiles_dir_auth.""DIRID"",Np_efiles_dir_auth.""AUTHTYPE"",Np_efiles_dir_auth.""ROLEID"",Np_efiles_dir_auth.""EMPLOYEEID"",Np_efiles_dir_auth.""CREATEDIR"",Np_efiles_dir_auth.""DELDIR"",Np_efiles_dir_auth.""LISTFILES"",Np_efiles_dir_auth.""CREATEFILE"",Np_efiles_dir_auth.""MODIFYFILE"",Np_efiles_dir_auth.""PREVIEWFILE"",Np_efiles_dir_auth.""DOWNLOADFILE"",Np_efiles_dir_auth.""PRINTFILE"",Np_efiles_dir_auth.""MODIFYAUTH"",
np_role.rolename rolename,
pub_employee.employeename employeename
from
Np_efiles_dir_auth,
np_role,pub_employee
where
Np_efiles_dir_auth.roleid=np_role.roleid(+)
and Np_efiles_dir_auth.employeeid=pub_employee.employeeid(+)
"
"NP_EFILES_DIR_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_EFILES_DIR_V"" (""DIRID"", ""DIRNAME"", ""DIRURI"", ""COMEFROM"", ""OPID"", ""CREDATE"", ""FILESCOUNT"", ""FILESSIZE"", ""PARENTDIRID"", ""LIMITSIZE"", ""EXPLAIN"", ""USESTATUS"", ""CREEMPLOYEEID"", ""CREEMPLOYEENAME"") AS 
  select
Np_efiles_dir.""DIRID"",Np_efiles_dir.""DIRNAME"",Np_efiles_dir.""DIRURI"",Np_efiles_dir.""COMEFROM"",Np_efiles_dir.""OPID"",Np_efiles_dir.""CREDATE"",Np_efiles_dir.""FILESCOUNT"",Np_efiles_dir.""FILESSIZE"",Np_efiles_dir.""PARENTDIRID"",Np_efiles_dir.""LIMITSIZE"",Np_efiles_dir.""EXPLAIN"",Np_efiles_dir.""USESTATUS"",Np_efiles_dir.""CREEMPLOYEEID"",
pub_employee.employeename creemployeename
from
Np_efiles_dir,pub_employee
where
Np_efiles_dir.Creemployeeid=pub_employee.employeeid(+)
"
"NP_EFILES_FILE_AUTH_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_EFILES_FILE_AUTH_V"" (""SEQID"", ""FILEID"", ""AUTHTYPE"", ""ROLEID"", ""EMPLOYEEID"", ""MODIFYFILE"", ""PREVIEWFILE"", ""DOWNLOADFILE"", ""PRINTFILE"", ""DELFILE"", ""ROLENAME"", ""EMPLOYEENAME"") AS 
  select
Np_efiles_file_auth.""SEQID"",Np_efiles_file_auth.""FILEID"",Np_efiles_file_auth.""AUTHTYPE"",Np_efiles_file_auth.""ROLEID"",Np_efiles_file_auth.""EMPLOYEEID"",Np_efiles_file_auth.""MODIFYFILE"",Np_efiles_file_auth.""PREVIEWFILE"",Np_efiles_file_auth.""DOWNLOADFILE"",Np_efiles_file_auth.""PRINTFILE"",Np_efiles_file_auth.""DELFILE"",
np_role.rolename rolename,
pub_employee.employeename employeename
from
Np_efiles_file_auth,
np_role,pub_employee
where
Np_efiles_file_auth.roleid=np_role.roleid(+)
and Np_efiles_file_auth.employeeid=pub_employee.employeeid(+)
"
"NP_EFILES_FILE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_EFILES_FILE_V"" (""FILEID"", ""DIRID"", ""FILEURI"", ""EXPLAIN"", ""COMEFROM"", ""OPID"", ""PKID"", ""CREEMPLOYEEID"", ""CREDATE"", ""MODIFYEMPLOYEEID"", ""MODIFYDATE"", ""FILETYPE"", ""FILENAME"", ""FILESIZE"", ""USESTATUS"", ""CREEMPLOYEENAME"", ""MODIFYEMPLOYEENAME"") AS 
  select
Np_efiles_file.""FILEID"",Np_efiles_file.""DIRID"",Np_efiles_file.""FILEURI"",Np_efiles_file.""EXPLAIN"",Np_efiles_file.""COMEFROM"",Np_efiles_file.""OPID"",Np_efiles_file.""PKID"",Np_efiles_file.""CREEMPLOYEEID"",Np_efiles_file.""CREDATE"",Np_efiles_file.""MODIFYEMPLOYEEID"",Np_efiles_file.""MODIFYDATE"",Np_efiles_file.""FILETYPE"",Np_efiles_file.""FILENAME"",Np_efiles_file.""FILESIZE"",Np_efiles_file.""USESTATUS"",
pub_employee.employeename creemployeename,
pub_employee1.employeename modifyemployeename
from
Np_efiles_file,pub_employee,pub_employee pub_employee1
where
Np_efiles_file.Creemployeeid=pub_employee.employeeid(+)
and Np_efiles_file.modifyemployeeid=pub_employee1.employeeid(+)
"
"NP_EFILES_OP_FILE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_EFILES_OP_FILE_V"" (""FILEID"", ""OPID"", ""PKID"", ""FILENAME"", ""INPUTMANID"", ""CREDATE"", ""MODIFYMANID"", ""MODIFYDATE"", ""FILESIZE"", ""OPNAME"", ""STECLASSNAME"", ""CLASSNAME"", ""INPUTMANNAME"", ""MODIFYMANNAME"") AS 
  select
a.""FILEID"",a.""OPID"",a.""PKID"",a.""FILENAME"",a.""INPUTMANID"",a.""CREDATE"",a.""MODIFYMANID"",a.""MODIFYDATE"",a.""FILESIZE"",
b.opname,a.steclassname,a.classname,
ie.employeename inputmanname,
me.employeename modifymanname
from
np_efiles_op_file a,np_op b,pub_employee ie,pub_employee me
where a.opid=b.opid
and a.inputmanid=ie.employeeid(+)
and a.modifymanid=me.employeeid(+)
"
"NP_EFILES_OP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_EFILES_OP_V"" (""OPID"", ""USEEFILES"", ""TABLENAME"", ""PKCOLNAME"", ""OPNAME"") AS 
  select
np_efiles_op.opid,
np_efiles_op.useefiles,
np_efiles_op.tablename,
np_efiles_op.pkcolname,
np_op.opname
from
np_efiles_op,np_op
where
np_efiles_op.opid = np_op.opid
"
"NP_EMPLOYEESP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_EMPLOYEESP_V"" (""EMPLOYEESPID"", ""CREDATE"", ""REQMAN"", ""METHOD"", ""ROLEID"", ""ROLENAME"", ""EMPLOYEEID"", ""EMPLOYEENAME"", ""SPDATE"", ""SPRESULT"", ""SPMAN"", ""REQMANID"", ""SPMANID"", ""EMPLOYEEROLEID"") AS 
  select t.employeespid,
       t.credate,
       c.employeename reqman,
       t.method,
       t.roleid,
       a.rolename,
       t.employeeid,
       b.employeename,
       t.spdate,
       t.spresult,
       d.employeename spman,
       t.reqmanid,
       t.spmanid,
       t.EMPLOYEEROLEID
  from np_employeesp t, np_role a, pub_employee b, pub_employee c, pub_employee d
 where t.reqmanid = c.employeeid(+)
 and   t.roleid=a.roleid(+)
 and   t.employeeid=b.employeeid(+)
 and   t.spmanid=d.employeeid(+)
"
"NP_EMPLOYEE_ROLE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_EMPLOYEE_ROLE_V"" (""EMPLOYEEROLEID"", ""EMPLOYEEID"", ""EMPLOYEENAME"", ""DEPTID"", ""DEPTNAME"", ""ROLEID"", ""ROLENAME"") AS 
  select  a.employeeroleid,  a.employeeid,  b.employeename,  b.deptid,  b.deptname,  a.roleid,  c.rolename
 from np_employee_role a,pub_employee_v b,np_role c
 where a.employeeid=b.employeeid   and a.roleid=c.roleid
"
"NP_HOV_AP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_HOV_AP_V"" (""HOVNAME"", ""CLASSNAME"", ""PRODNAME"", ""MODULENAME"", ""APID"", ""HOVID"", ""ROLEID"", ""APTYPE"", ""APNAME"", ""APVALUE"") AS 
  select
NP_HOV.HOVNAME,
NP_HOV.CLASSNAME,
NP_HOV.PRODNAME,
NP_HOV.MODULENAME,
NP_HOV_AP.APID,
NP_HOV_AP.HOVID,
NP_HOV_AP.ROLEID,
NP_HOV_AP.APTYPE,
NP_HOV_AP.APNAME,
NP_HOV_AP.APVALUE
from
np_hov,np_hov_ap
where
np_hov.hovid=np_hov_ap.hovid
"
"NP_LOGIN_LOG_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_LOGIN_LOG_V"" (""SEQID"", ""EMPLOYEEID"", ""EMPLOYEENAME"", ""MAC"", ""CREDATE"", ""ACTION"") AS 
  select   a.seqid,
         a.employeeid,
         b.employeename,
         a.mac,
         a.credate,
         a.action
    from np_login_log a,
         pub_employee b
   where a.employeeid = b.employeeid(+)
"
"NP_LOG_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_LOG_V"" (""SEQID"", ""CREDATE"", ""EMPLOYEEID"", ""EMPLOYEENAME"", ""PRODNAME"", ""REMOTEIP"", ""COMMAND"", ""RESULT"", ""ERRORMSG"", ""USETIME"", ""OPID"", ""OPNAME"") AS 
  select
NP_LOG.SEQID,
NP_LOG.CREDATE,
NP_LOG.EMPLOYEEID,
NP_LOG.EMPLOYEENAME,
NP_LOG.PRODNAME,
NP_LOG.REMOTEIP,
NP_LOG.COMMAND,
NP_LOG.RESULT,
NP_LOG.ERRORMSG,
NP_LOG.USETIME,
NP_LOG.OPID,

NP_OP.OPNAME

from
NP_LOG,np_op
where
NP_LOG.opid=np_op.opid(+)"
"NP_MESSAGE_ADMIN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_MESSAGE_ADMIN_V"" (""MSGID"", ""TOUSERID"", ""TOUSERNAME"", ""TOGROUPID"", ""TOGROUPNAME"", ""MSG"", ""FILEGROUPID"", ""CREATEDATE"", ""FROMUSERID"", ""FROMUSERNAME"", ""USESTATUS"") AS 
  select m.msgid,
         dtl.touserid,
         e.employeename as tousername,
         dtl.togroupid,
         r.groupname     as togroupname,
         m.msg,
         m.filegroupid,
         m.createdate,
         m.fromuserid,
         p.employeename as fromusername,
         m.usestatus
    from np_message m, np_message_dtl dtl , pub_employee e, np_message_group r,pub_employee p
   where m.msgid = dtl.msgid
         and dtl.togroupid = r.groupid(+)
         and dtl.touserid = e.employeeid(+)
         and m.usestatus = 2
         and m.fromuserid = p.employeeid(+)
"
"NP_MESSAGE_GROUP_USER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_MESSAGE_GROUP_USER_V"" (""GROUPUSERID"", ""USERID"", ""USERNAME"", ""MOBILE"", ""EMAIL"", ""OPCODE"", ""GROUPID"", ""GROUPNAME"", ""FROMTYPE"") AS 
  select a.groupuserid,
       a.userid,
       b.username,
       --b.deptid,
       --d.companyname as deptname,
       b.mobile,
       b.email,
       b.opcode,
       a.groupid,
       c.groupname,
       b.fromtype
  from np_message_group_user a, np_shortmsg_setting b,/*pub_company d, */np_message_group  c
 where a.userid = b.userid
   --and b.deptid = d.companyid
   and a.groupid = c.groupid
"
"NP_MESSAGE_MSGCENTER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_MESSAGE_MSGCENTER_V"" (""MSGID"", ""TOUSERID"", ""TOUSERNAME"", ""TOGROUPID"", ""TOGROUPNAME"", ""CONTENT"", ""FILEGROUPID"", ""CREATEDATE"", ""FROMUSERID"", ""FROMROLEID"", ""FROMUSERNAME"", ""USESTATUS"", ""MSGTYPE"", ""BUSITYPE"", ""SOURCEID"", ""DOCID"", ""SENDDATE"") AS 
  select m.msgid,
         m.touserid,
         gf_get_nameofidset_new(m.touserid,'np_shortmsg_setting','USERID','username') tousername,
         m.togroupid,
         gf_get_nameofidset_new(m.togroupid,'np_message_group','groupid','groupname') togroupname,
         m.content,
         m.filegroupid,
         m.createdate,
         m.fromuserid,
         m.fromroleid,
         p.username as fromusername,
         --decode((select 1 from dual where exists (select 1 from np_message_user p where p.msgid=m.msgid)),1,1,0) usestatus,
         m.usestatus,
         m.msgtype,
         m.busitype,
         m.sourceid,
         m.docid,
         m.senddate
    from np_message m,NP_SHORTMSG_SETTING_V p
   where m.fromuserid = p.userid(+)
   order by m.createdate desc
"
"NP_MESSAGE_MYMSG_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_MESSAGE_MYMSG_V"" (""MSGID"", ""TOUSERID"", ""TOUSERNAME"", ""CONTENT"", ""FILEGROUPID"", ""CREATEDATE"", ""SENDDATE"", ""FROMUSERID"", ""FROMUSERNAME"", ""MSGTYPE"", ""BUSITYPE"", ""SOURCEID"", ""DOCID"", ""FROMTYPE"", ""ACTION"", ""USESTATUS"", ""SEQID"") AS 
  select   m.msgid,
         a.userid as touserid,
         b.USERNAME as tousername,
         m.content,
         m.filegroupid,
         m.createdate,
         m.senddate,
         m.fromuserid,
         d.USERNAME as fromusername,
         m.msgtype,
         m.busitype,
         m.sourceid,
         m.docid,
         d.fromtype,
         '' action,
         a.usestatus,
         a.seqid
    from np_message m,np_message_user a, np_shortmsg_setting b, np_shortmsg_setting d
    where m.msgid = a.msgid
      and a.userid = b.userid(+)
      and m.fromuserid = d.userid(+)
      and m.usestatus = 2

      order by m.createdate desc
"
"NP_MESSAGE_QUEUE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_MESSAGE_QUEUE_V"" (""MSGID"", ""TOUSERID"", ""TOUSERNAME"", ""TOGROUPID"", ""TOGROUPNAME"", ""CONTENT"", ""FILEGROUPID"", ""CREATEDATE"", ""FROMUSERID"", ""FROMROLEID"", ""FROMUSERNAME"", ""USESTATUS"", ""MSGTYPE"", ""BUSITYPE"", ""SOURCEID"", ""DOCID"") AS 
  select m.msgid,
         m.touserid,
         gf_get_nameofidset_new(m.touserid,'np_shortmsg_setting','USERID','username') tousername,
         m.togroupid,
         gf_get_nameofidset_new(m.togroupid,'np_message_group','groupid','groupname') togroupname,
         m.content,
         m.filegroupid,
         m.createdate,
         m.fromuserid,
         m.fromroleid,
         p.username as fromusername,
         decode((select 1 from dual where exists (select 1 from np_message_user p where p.msgid=m.msgid)),1,1,0) usestatus,
         m.msgtype,
         m.busitype,
         m.sourceid,
         m.docid
    from Np_Message_Queue m,NP_SHORTMSG_SETTING_V p
   where m.fromuserid = p.userid(+)
"
"NP_MESSAGE_RECEIVED_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_MESSAGE_RECEIVED_V"" (""MSGID"", ""FROMUSERID"", ""FROMUSERNAME"", ""TOUSERID"", ""ROLEID"", ""FROMROLENAME"", ""TOGROUPID"", ""MSG"", ""FILEGROUPID"", ""CREATEDATE"", ""USESTATUS"", ""SEQID"", ""READDATE"") AS 
  select m.msgid,
        fromuserid as fromuserid,
        e.employeename as  fromusername,
        u.userid       as touserid,
        fromroleid as roleid,
        r.rolename     as fromrolename,
        TOGROUPID,
        msg,
        filegroupid,
        u.createdate,
        u.usestatus as usestatus,
        u.seqid,
        u.readdate
   from np_message m, np_message_user u, pub_employee e, np_role r
  where m.usestatus = 2
    and m.msgid = u.msgid
    and m.fromuserid = e.employeeid
    and m.fromroleid = r.roleid
"
"NP_MESSAGE_SEND_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_MESSAGE_SEND_V"" (""MSGID"", ""TOUSERID"", ""TOUSERNAME"", ""TOGROUPID"", ""TOGROUPNAME"", ""MSG"", ""FILEGROUPID"", ""CREATEDATE"", ""FROMUSERID"", ""USESTATUS"") AS 
  select m.msgid,
         dtl.touserid,
         e.employeename as tousername,
         dtl.togroupid,
         r.groupname     as togroupname,
         m.msg,
         m.filegroupid,
         m.createdate,
         m.fromuserid,
         m.usestatus
    from np_message m, np_message_dtl dtl , pub_employee e, np_message_group r
   where m.msgid = dtl.msgid
         and dtl.togroupid = r.groupid(+)
         and dtl.touserid = e.employeeid(+)
         and m.usestatus = 2
"
"NP_MESSAGE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_MESSAGE_V"" (""MSGID"", ""CONTENT"", ""FROMUSERID"", ""FROMROLEID"", ""TOUSERID"", ""TOGROUPID"", ""FILEGROUPID"", ""CREATEDATE"", ""MSGTYPE"", ""BUSITYPE"", ""SOURCEID"", ""DOCID"", ""STATUS"") AS 
  SELECT

A.MSGID,A.CONTENT,A.FROMUSERID,A.FROMROLEID,A.TOUSERID,A.TOGROUPID,A.FILEGROUPID,A.CREATEDATE,A.MSGTYPE,A.BUSITYPE,A.SOURCEID,A.DOCID,
0 STATUS

FROM NP_MESSAGE_QUEUE A

UNION ALL

SELECT
B.MSGID,B.CONTENT,B.FROMUSERID,B.FROMROLEID,B.TOUSERID,B.TOGROUPID,B.FILEGROUPID,B.CREATEDATE,B.MSGTYPE,B.BUSITYPE,B.SOURCEID,B.DOCID,
1 STATUS
FROM NP_MESSAGE B
"
"NP_OP_STYLE_AUTH_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_OP_STYLE_AUTH_V"" (""AUTHID"", ""STYLEID"", ""AUTHTYPE"", ""ROLEID"", ""ROLENAME"", ""EMPLOYEEID"", ""EMPLOYEENAME"", ""QUERYFLAG"", ""MODIFYFLAG"", ""DELFLAG"") AS 
  select
a.authid,
a.styleid,
a.authtype,
a.roleid,
r.rolename,
a.employeeid,
e.employeename,
a.queryflag,
a.modifyflag,
a.delflag

from np_op_style_auth a,pub_employee e,np_role r
where
a.roleid = r.roleid(+)
and a.employeeid=e.employeeid(+)
"
"NP_PUB_DEPT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_PUB_DEPT_V"" (""DEPTID"", ""DEPTNAME"", ""PID"", ""PNAME"") AS 
  SELECT A.COMPANYID as deptid,
       A.COMPANYNAME as deptname,
       A.PARENTCOMPANYID as pid,
       B.COMPANYNAME as pname
  FROM PUB_COMPANY A, PUB_COMPANY B, PUB_EMPLOYEE C
 WHERE (A.PARENTCOMPANYID = B.COMPANYID(+))
   and (A.INPUTMANID = C.EMPLOYEEID(+))
   and a.companyid > 0
   and a.selfflag = 1
"
"NP_QF_INSTANCE_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_QF_INSTANCE_DTL_V"" (""INSTDTLID"", ""INSTID"", ""PID"", ""PNAME"", ""OPID"", ""OPNAME"", ""DOCID"", ""CURRENTLEVELID"", ""CREDATE"", ""ACTIONCREDATE"", ""EMPLOYEEID"", ""EMPLOYEENAME"", ""ACTIONNAME"", ""ACTIONMEMO"", ""NODEID"", ""ENTRYDESC"") AS 
  select
np_qf_instance_dtl.instdtlid,
np_qf_instance_dtl.Instid	,
np_qf_instance_dtl.Pid	,
np_qf.pname,
np_qf_instance_dtl.Opid,
np_op.opname,
np_qf_instance_dtl.Docid	,
np_qf_instance_dtl.currentlevelid	,
np_qf_instance_dtl.credate,
np_qf_instance_dtl.actionCredate,
np_qf_instance_dtl.Employeeid	,
pub_employee.employeename,
np_qf_instance_dtl.Actionname,
np_qf_instance_dtl.Actionmemo,
np_qf_instance_dtl.nodeid,
np_qf_instance_dtl.entrydesc
from np_qf_instance_dtl,
np_qf,
np_op,
pub_employee,
np_qf_node
where
np_qf_instance_dtl.pid=np_qf.pid
and np_qf_instance_dtl.opid=np_op.opid
and np_qf_instance_dtl.employeeid=pub_employee.employeeid(+)
and np_qf_instance_dtl.nodeid=np_qf_node.nodeid
"
"NP_QF_INSTANCE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_QF_INSTANCE_V"" (""INSTID"", ""PID"", ""PNAME"", ""OPID"", ""OPNAME"", ""DOCID"", ""CREDATE"", ""NEXTLEVEL"", ""STATUSFLAG"", ""DEPTID"", ""DEPTNAME"", ""QFUSESTATUS"") AS 
  select
np_qf_instance.instid	,
np_qf_instance.pid	,
np_qf.pname,
np_qf_instance.opid	,
np_op.opname,
np_qf_instance.docid,
np_qf_instance.credate,
np_qf_instance.nextlevel,
np_qf_instance.statusflag,
np_qf_instance.deptid,
pub_company.companyname deptname,
np_qf_instance.qfusestatus
from
np_qf_instance,
np_op,
np_qf,
pub_company
where
np_qf_instance.pid=np_qf.pid
and np_qf_instance.opid=np_op.opid
and np_qf_instance.deptid=pub_company.companyid(+)
"
"NP_QF_INSTANCE_WAIT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_QF_INSTANCE_WAIT_V"" (""WAITID"", ""INSTID"", ""INSTDTLID"", ""OPID"", ""PID"", ""PNAME"", ""OPNAME"", ""DOCID"", ""NODEID"", ""LEVELID"", ""ENTRYDESC"", ""AUTHTYPE"", ""EMPLOYEEID"", ""ROLEID"", ""CREDATE"", ""DEPTID"", ""DEPTNAME"") AS 
  select
np_qf_instance_wait.waitid,
np_qf_instance_wait.instid,
np_qf_instance_wait.instdtlid,
np_qf_instance_wait.opid,
np_qf_instance_wait.pid,
np_qf.pname,
np_op.opname,
np_qf_instance_wait.docid,
np_qf_instance_wait.nodeid,
np_qf_node.levelid,
np_qf_instance_dtl.entrydesc,
np_qf_instance_wait.authtype,
np_qf_instance_wait.employeeid,
np_qf_instance_wait.roleid,
np_qf_instance_dtl.credate,
np_qf_instance.deptid,
pub_company.companyname deptname
from
np_qf,
np_qf_instance_wait,
np_op,
np_qf_instance_dtl,
np_qf_node,
np_qf_instance,
pub_company
where
np_qf_instance_wait.pid=np_qf.pid
and np_qf_instance_wait.opid=np_op.opid
and np_qf_instance_wait.instdtlid=np_qf_instance_dtl.instdtlid
and np_qf_instance_wait.nodeid=np_qf_node.nodeid
and np_qf_instance_dtl.instid = np_qf_instance.instid
and np_qf_instance.deptid = pub_company.companyid(+)
"
"NP_QF_NODE_AUTH_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_QF_NODE_AUTH_V"" (""AUTHID"", ""NODEID"", ""PID"", ""OPID"", ""AUTHTYPE"", ""EMPLOYEEID"", ""ROLEID"", ""ROLENAME"", ""EMPLOYEENAME"") AS 
  select
a.Authid,
a.nodeid,
a.pid,
a.Opid	,
a.Authtype,
a.Employeeid,
a.Roleid	,
b.rolename,
c.employeename

from np_qf_node_auth a,np_role b,pub_employee c
where
a.employeeid=c.employeeid(+)
and a.roleid=b.roleid(+)
"
"NP_REPORT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_REPORT_V"" (""REPORTID"", ""REPORTNAME"") AS 
  select opid reportid,opname reportname from np_op where classname='bireport' order by sortno,opid
"
"NP_ROLE_OP_1_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_ROLE_OP_1_V"" (""ROLEOPID"", ""OPID"", ""ROLEID"", ""OPNAME"", ""CLASSNAME"", ""FLAG"") AS 
  select a.roleopid,a.opid,a.roleid,b.opname,b.classname,a.flag from np_role_op_1 a,np_op b where a.opid=b.opid
"
"NP_ROLE_OP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_ROLE_OP_V"" (""ROLEOPID"", ""ROLEID"", ""ROLENAME"", ""OPID"", ""OPNAME"", ""CLASSNAME"", ""COMPONENTID"", ""COMPONENTNAME"") AS 
  select  a.roleopid,  a.roleid,  c.rolename,  a.opid,  b.opname,  b.classname,d.COMPONENTID,d.COMPONENTNAME
from np_role_op a,np_op b, np_role c,bi_component_v d
where  a.roleid=c.roleid  and a.opid=b.opid
and a.componentid = d.COMPONENTID(+)
"
"NP_RPTCENT_AUTH_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_RPTCENT_AUTH_V"" (""SEQID"", ""DIRID"", ""ID"", ""AUTHTYPE"", ""EMPLOYEEID"", ""ROLEID"", ""QUERYFLAG"", ""EDITFLAG"", ""DELFLAG"", ""EMPLOYEENAME"", ""ROLENAME"") AS 
  select
seqid,dirid,id,authtype,np_rptcent_auth.employeeid,np_rptcent_auth.roleid,queryflag,editflag,delflag,
e.employeename,r.rolename
from np_rptcent_auth,pub_employee e,np_role r
where
np_rptcent_auth.employeeid=e.employeeid(+)
and np_rptcent_auth.roleid=r.roleid(+)
"
"NP_RPTCENT_DIR_AUTH_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_RPTCENT_DIR_AUTH_V"" (""SEQID"", ""DIRID"", ""AUTHTYPE"", ""EMPLOYEEID"", ""EMPLOYEENAME"", ""ROLEID"", ""ROLENAME"", ""MASTERFLAG"", ""QUERYFLAG"", ""EXPORTFLAG"") AS 
  select
a.seqid,a.dirid,a.authtype,a.employeeid,e.employeename,a.roleid,r.rolename,a.masterflag,a.queryflag,a.exportflag
from np_rptcent_dir_auth a,pub_employee e,np_role r
where a.employeeid=e.employeeid(+)
and a.roleid=r.roleid(+)
"
"NP_RPTCENT_STYLE_AUTH_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_RPTCENT_STYLE_AUTH_V"" (""SEQID"", ""ID"", ""STYLENAME"", ""AUTHTYPE"", ""EMPLOYEEID"", ""ROLEID"", ""QUERYFLAG"", ""EMPLOYEENAME"", ""ROLENAME"") AS 
  select
seqid,id,stylename,authtype,np_rptcent_style_auth.employeeid,np_rptcent_style_auth.roleid,queryflag,
e.employeename,r.rolename
from np_rptcent_style_auth,pub_employee e,np_role r
where
np_rptcent_style_auth.employeeid=e.employeeid(+)
and np_rptcent_style_auth.roleid=r.roleid(+)
"
"NP_RPTCENT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_RPTCENT_V"" (""ID"", ""INPUTMANID"", ""INPUTMANNAME"", ""CREDATE"", ""MODIFYMANID"", ""MODIFYMANNAME"", ""MODIFYDATE"") AS 
  select
np_rptcent.id,
np_rptcent.inputmanid,
i.employeename inputmanname,
np_rptcent.credate,
modifymanid,
m.employeename modifymanname,
modifydate
from np_rptcent,pub_employee i,pub_employee m
where
np_rptcent.inputmanid=i.employeeid(+)
and np_rptcent.modifymanid=m.employeeid(+)
"
"NP_RUNOP_LOG_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_RUNOP_LOG_V"" (""SEQID"", ""CREDATE"", ""EMPLOYEEID"", ""OPID"", ""ACTION"", ""OPNAME"", ""EMPLOYEENAME"") AS 
  select
a.seqid,
a.credate,
a.employeeid,
a.opid,
a.action,
b.opname,
c.employeename
from
np_runop_log a,
np_op b,
pub_employee c
where
a.opid=b.opid
and a.employeeid=c.employeeid
"
"NP_SHORTMSG_SETTING_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_SHORTMSG_SETTING_V"" (""USERID"", ""SOURCEID"", ""FROMTYPE"", ""BINDMOBILE"", ""OFFLINETRANSFER"", ""MOBILE"", ""BINDEMAIL"", ""TRANSFERMSGTYPES"", ""EMAIL"", ""OPCODE"", ""USERNAME"") AS 
  SELECT A.USERID,
       A.SOURCEID,
       A.FROMTYPE,
       A.BINDMOBILE,
       A.OFFLINETRANSFER,
       A.MOBILE,
       A.BINDEMAIL,
       A.TRANSFERMSGTYPES,
       A.EMAIL,
       A.OPCODE,
       A.USERNAME
  FROM NP_SHORTMSG_SETTING A
"
"NP_SP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_SP_V"" (""NPSPID"", ""CREDATE"", ""REQMAN"", ""METHOD"", ""ROLEID"", ""ROLENAME"", ""OPID"", ""OPNAME"", ""SPDATE"", ""SPRESULT"", ""SPMAN"", ""REQMANID"", ""SPMANID"", ""ROLEOPID"") AS 
  select t.npspid,
       t.credate,
       c.employeename reqman,
       t.method,
       t.roleid,
       a.rolename,
       t.opid,
       b.opname,
       t.spdate,
       t.spresult,
       d.employeename spman,
       t.reqmanid,
       t.spmanid,
       t.roleopid
  from np_sp t, np_role a, np_op b, pub_employee c, pub_employee d
 where t.reqmanid = c.employeeid(+)
 and   t.roleid=a.roleid(+)
 and   t.opid=b.opid(+)
 and   t.spmanid=d.employeeid(+)
"
"NP_TASK_INSTANCE_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_TASK_INSTANCE_DOC_V"" (""INSTANCEID"", ""TASKID"", ""SERVICEID"", ""RUNTIME"", ""REALRUNTIME"", ""RUNSTATUS"", ""FINISHTIME"", ""WASTTIME"") AS 
  (
select ""INSTANCEID"",""TASKID"",""SERVICEID"",""RUNTIME"",""REALRUNTIME"",""RUNSTATUS"",""FINISHTIME"",""WASTTIME""
  from (SELECT INSTANCEID,
               t.TASKID,
               t.SERVICEID,
               t.RUNTIME,
               REALRUNTIME,
               RUNSTATUS,
               FINISHTIME,
               decode(sign((T.FINISHTIME - T.REALRUNTIME) * 24 * 60 * 60 * 1000),
                      -1,
                      0,
                      (T.FINISHTIME - T.REALRUNTIME) * 24 * 60 * 60 * 1000) wasttime
          FROM NP_TASK_INSTANCE_DOC T
         order by runtime desc)
)
"
"NP_TASK_INSTANCE_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_TASK_INSTANCE_DTL_V"" (""LOGID"", ""ISMANUAL"", ""INSTANCEID"", ""CREDATE"", ""LOGLEVEL"", ""MESSAGE"", ""TASKNAME"", ""RUNSTATUS"", ""HOST"", ""TASKID"", ""SERVICEID"") AS 
  (
SELECT a.LOGID,
       a.ISMANUAL,
       a.INSTANCEID,
       a.CREDATE,
       a.LOGLEVEL,
       a.MESSAGE,
       c.taskname,
       b.runstatus,
       a.host,
       c.taskid,
       b.serviceid

  FROM NP_TASK_INSTANCE_DTL a, np_task_instance_doc b, np_task c
  where a.instanceid = b.instanceid(+)
  and b.serviceid = c.serviceid(+)
)
"
"NP_TASK_SERVICE_DEFUALTPARAM_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_TASK_SERVICE_DEFUALTPARAM_V"" (""PARAMID"", ""SERVICEID"", ""PARAMNAME"", ""PARAMTYPE"", ""PARAMVALUE"", ""DESCRIB"", ""NULLABLE"", ""INPUTMANID"", ""CREDATE"") AS 
  (SELECT ""PARAMID"",""SERVICEID"",""PARAMNAME"",""PARAMTYPE"",""PARAMVALUE"",""PARAMDESCRIB"" describ,nvl(NULLABLE,0) NULLABLE,""INPUTMANID"",""CREDATE"" FROM NP_TASK_SERVICE_DEFUALTPARAM)
"
"NP_TASK_SERVICE_REALPARAM_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_TASK_SERVICE_REALPARAM_V"" (""SEQID"", ""PARAMID"", ""SERVICEID"", ""TASKID"", ""PARAMVALUE"", ""SERVICENAME"", ""TASKNAME"", ""PARAMNAME"", ""PARAMTYPE"", ""DESCRIB"", ""NULLABLE"", ""SERVICETYPE"") AS 
  (SELECT a.seqid,a.PARAMID,a.SERVICEID,a.TASKID,a.paramvalue,b.servicename,c.taskname,d.paramname,d.paramtype,d.paramdescrib describ,d.nullable,b.servicetype
FROM NP_TASK_SERVICE_REALPARAM a,
NP_TASK_SERVICE b,np_task c,
NP_TASK_SERVICE_DEFUALTPARAM d
where a.serviceid=b.serviceid
and a.taskid=c.taskid
and a.paramid=d.paramid )
"
"NP_TASK_SERVICE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_TASK_SERVICE_V"" (""SERVICEID"", ""SERVICENAME"", ""DESCRIB"", ""CLASSNAME"", ""INPUTMANID"", ""OPCODE"", ""EMPLOYEENAME"", ""CREDATE"", ""SERVICETYPE"") AS 
  (select ""SERVICEID"",""SERVICENAME"",a.describ,""CLASSNAME"",a.INPUTMANID,b.opcode,b.employeename ,a.CREDATE,a.servicetype from NP_TASK_SERVICE a ,pub_employee b where a.inputmanid=b.employeeid(+))
"
"NP_TASK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_TASK_V"" (""TASKID"", ""TASKNAME"", ""USESTATUS"", ""TASKDESCRIB"", ""NEXTTIME"", ""LASTTIME"", ""LASTFINISHTIME"", ""RESULTSTATUS"", ""RESULTMSG"", ""SERVICEID"", ""SERVICENAME"", ""SERVICEDESCRIB"", ""CLASSNAME"", ""RUNTYPE"", ""BEGINTIME"", ""RUNTIME"", ""INTERVALTIME"", ""WEEKS"", ""DAYS"", ""REDOFLAG"", ""VALIDITYTIME"", ""VALIDITYDAYS"") AS 
  (select ""TASKID"",""TASKNAME"",nvl(USESTATUS,0) USESTATUS,""TASKDESCRIB"",""NEXTTIME"",""LASTTIME"",a.lastfinishtime,""RESULTSTATUS"",""RESULTMSG"",a.SERVICEID,b.servicename,b.describ servicedescrib,b.classname,a.runtype,a.begintime,a.runtime,a.intervaltime,a.weeks,a.days,a.redoflag,a.validitytime,a.validitydays from NP_TASK a, NP_TASK_SERVICE b where a.serviceid=b.serviceid(+) )
"
"NP_USER_OP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_USER_OP_V"" (""OPID"", ""OPCODE"", ""OPNAME"", ""CLASSNAME"", ""PRODNAME"", ""MODULENAME"", ""GROUPNAME"", ""USERID"", ""SEQID"") AS 
  select distinct p.opid,opcode,opname,classname,prodname,modulename,groupname,u.userid,u.seqid from np_user_op u ,np_op p where u.opid=p.opid
order by u.seqid
"
"NP_WF_DEMO_FEE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_WF_DEMO_FEE_V"" (""FEEDOCID"", ""CREDATE"", ""EMPLOYEEID"", ""MONEY"", ""USESTATUS"", ""APPROVESTATUS"", ""APPROVEMEMO"", ""MEMO"", ""EMPLOYEENAME"") AS 
  select
NP_WF_DEMO_FEE.FEEDOCID,
NP_WF_DEMO_FEE.CREDATE,
NP_WF_DEMO_FEE.EMPLOYEEID,
NP_WF_DEMO_FEE.MONEY,
NP_WF_DEMO_FEE.USESTATUS,
NP_WF_DEMO_FEE.APPROVESTATUS,
NP_WF_DEMO_FEE.APPROVEMEMO,
NP_WF_DEMO_FEE.MEMO,
pub_employee.employeename

from
NP_WF_DEMO_FEE,pub_employee
where
NP_WF_DEMO_FEE.EMPLOYEEID=pub_employee.employeeid(+)"
"NP_WF_INSTANCE_QRY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_WF_INSTANCE_QRY_V"" (""WFINSTANCEID"", ""WFNODEINSTANCEID"", ""WFNAME"", ""WFSTATUS"", ""CREDATE"", ""TABLENAME"", ""PKVALUE"", ""PKCOLNAME"", ""STAGE"", ""STARTDATE"", ""ENDDATE"", ""NODENAME"", ""EMPLOYEEID"", ""EMPLOYEENAME"", ""APPROVEMESSAGE"", ""ACTIONTYPE"") AS 
  select b.WFINSTANCEID,
       a.WFNODEINSTANCEID,
       b.WFNAME,
       decode(b.WFSTATUS, 'open', '运行中', 'close', '关闭', 'reject', '驳回','') WFSTATUS,
       b.credate,
       b.TABLENAME,
       b.PKVALUE,
       b.PKCOLNAME,
       a.STAGE,
       a.STARTDATE,
       a.ENDDATE,
       a.NODENAME,
       a.EMPLOYEEID,
       a.employeename,
       a.APPROVEMESSAGE,
       a.ACTIONTYPE
  from np_wf_node_instance_v a, np_wf_instance_v b
 WHERE a.WFINSTANCEID = b.WFINSTANCEID
"
"NP_WF_INSTANCE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_WF_INSTANCE_V"" (""WFINSTANCEID"", ""WFID"", ""CREDATE"", ""PKVALUE"", ""WFSTATUS"", ""CURRENTSTAGE"", ""WFNAME"", ""TABLENAME"", ""VIEWNAME"", ""PKCOLNAME"", ""STATUSCOLNAME"", ""MESSAGECOLNAME"", ""CONDEXPR"", ""SUMMARYEXPR"", ""USESTATUS"") AS 
  select
NP_WF_INSTANCE.WFINSTANCEID,
NP_WF_INSTANCE.WFID,
np_wf_instance.credate,
NP_WF_INSTANCE.PKVALUE,
NP_WF_INSTANCE.WFSTATUS,
NP_WF_INSTANCE.CURRENTSTAGE,
NP_WF_DEFINE.WFNAME,
NP_WF_DEFINE.TABLENAME,
NP_WF_DEFINE.VIEWNAME,
NP_WF_DEFINE.PKCOLNAME,
NP_WF_DEFINE.STATUSCOLNAME,
NP_WF_DEFINE.MESSAGECOLNAME,
NP_WF_DEFINE.CONDEXPR,
NP_WF_DEFINE.SUMMARYEXPR,
NP_WF_DEFINE.USESTATUS

from
NP_WF_INSTANCE,
np_wf_define
where
np_wf_define.wfid=NP_WF_INSTANCE.wfid
"
"NP_WF_NODE_EMPLOYEEID_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_WF_NODE_EMPLOYEEID_V"" (""WFNODEEMPLOYEEID"", ""WFNODEID"", ""EMPLOYEEID"", ""EMPLOYEENAME"") AS 
  select
np_wf_node_employeeid.wfnodeemployeeid,
np_wf_node_employeeid.wfnodeid,
np_wf_node_employeeid.employeeid,
pub_employee.employeename
from
np_wf_node_employeeid,pub_employee
where
np_wf_node_employeeid.employeeid=pub_employee.employeeid
"
"NP_WF_NODE_INSTANCE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_WF_NODE_INSTANCE_V"" (""WFNODEINSTANCEID"", ""WFINSTANCEID"", ""WFNODEID"", ""STARTDATE"", ""ENDDATE"", ""EMPLOYEEID"", ""EMPLOYEENAME"", ""APPROVEMESSAGE"", ""ACTIONRESULT"", ""WFID"", ""NODENAME"", ""STAGE"", ""PASSSTATUS"", ""REFUSESTATUS"", ""ACTIONTYPE"", ""CLASSNAME"") AS 
  select
NP_WF_NODE_INSTANCE.WFNODEINSTANCEID,
NP_WF_NODE_INSTANCE.WFINSTANCEID,
NP_WF_NODE_INSTANCE.WFNODEID,
NP_WF_NODE_INSTANCE.STARTDATE,
NP_WF_NODE_INSTANCE.ENDDATE,
NP_WF_NODE_INSTANCE.EMPLOYEEID,
pub_employee.employeename,
NP_WF_NODE_INSTANCE.APPROVEMESSAGE,
NP_WF_NODE_INSTANCE.ACTIONRESULT,
NP_WF_NODE.WFID,
NP_WF_NODE.NODENAME,
NP_WF_NODE.STAGE,
NP_WF_NODE.PASSSTATUS,
NP_WF_NODE.REFUSESTATUS,
NP_WF_NODE.ACTIONTYPE,
NP_WF_NODE.CLASSNAME
from
np_wf_node,
np_wf_node_instance,
pub_employee
where
np_wf_node_instance.wfnodeid=np_wf_node.wfnodeid
and NP_WF_NODE_INSTANCE.EMPLOYEEID=pub_employee.employeeid(+)
"
"NP_WF_NODE_ROLEID_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""NP_WF_NODE_ROLEID_V"" (""WFNODEROLEID"", ""WFNODEID"", ""ROLEID"", ""ROLENAME"") AS 
  select
np_wf_node_roleid.wfnoderoleid,
np_wf_node_roleid.wfnodeid,
np_wf_node_roleid.roleid,
np_role.rolename
from
np_wf_node_roleid,np_role
where
np_wf_node_roleid.roleid=np_role.roleid
"
"O1_TPL_ST_IO_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""O1_TPL_ST_IO_DOC_V"" (""ORDERID"", ""ORDERDTLID"", ""INOUTFLAG"", ""COMEFROM"", ""INOUTID"", ""WAREHID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSPACKID"", ""GSTORAGEID"", ""STORAGEID"", ""RSTORAGEID"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSSTATUSID"", ""QUANTITYSTATUS"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""GOODSQTY"", ""PICKQTY"", ""ARRIVEQTY"", ""GOODSPACK"", ""SOURCECOMPANYID"", ""PICKDATE"", ""PRINTLINE"", ""PRINTNO"", ""DIFFLAG"", ""DIFREASON"", ""PACKNAME"", ""PACKSIZE"", ""GOODSUNIT"", ""APPROVEDOCNO"", ""MEDCHKRPTNO"", ""PAKEUNIT"", ""APPROVENO"", ""EXPECTATION"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""SUPPLYNAME"", ""RECEIVEDATE"", ""DTLMEMO"", ""FINISHFLAG"", ""USESTATUS"", ""KEEPDATE"", ""KEEPMANID"", ""POSID"", ""OTHERID"", ""F"", ""D"", ""N"", ""GOODSOWNERID"", ""AREAID"", ""SECTIONID"", ""RFFLAG"", ""GSPFLAG"", ""RETRECEPTFLAG"", ""PRINTFLAG"", ""PRINTMANID"", ""PRINTDATE"", ""RECTIME"", ""RFNO"", ""RECMANID"", ""STOCKTEMPERATURE"", ""RFFINDATE"", ""RFMANID"", ""BARPRINT"", ""OPERATIONTYPE"", ""RECCOMPANYID"", ""SRCEXPDTLNO"", ""PRICE"") AS 
  select
b.outid orderid,c.outdtlid orderdtlid,
     a.inoutflag inoutflag,
       a.comefrom,
       a.inoutid,
      a.warehid warehid,
     a.ownergoodsid,
       a.goodsid,
       a.goodspackid,
       b.zxcolumn2 gstorageid,
        b.zxcolumn2 storageid,
     b.zxcolumn2  rstorageid,
       a.batchno,
       a.lotid,
       c.lotno,
       decode(to_char(c.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              c.validdate) validdate,
       c.proddate,
       c.goodsstatusid,
       a.quantitystatus,
       ingoodsqty,
       outgoodsqty,
      a.goodsqty goodsqty,
      a.goodsqty pickqty,
       '' arriveqty,
       '' goodspack,
       b.reccompanyid sourcecompanyid,
      '' pickdate,
      '' printline,
       '' printno,
       ''difflag,
       ''difreason,
       e.packname,
      e.packsize ,
        c.tradegoodspack goodsunit,
      c.approvedocno ,
      '' medchkrptno,
       '' pakeunit,
      c.approvedocno approveno,
       '' expectation,
       '' goodstype,
       ''prodarea,
       '' factname,
       '' supplyname,
       ''receivedate,
      c.dtlmemo ,
       b.finishflag,
       a.usestatus,
       ''keepdate,
       ''keepmanid,
       '' posid,
       c.otherid,
       null as f,
       null d,
       null n,
       a.goodsownerid,
       ''areaid,
       ''sectionid,
       ''rfflag,
       '' gspflag,
       retreceptflag,
       a.printflag,
       a.printmanid,
       a.printdate,
       ''rectime,
      '' rfno,
      '' recmanid,
       a.stocktemperature,
       ''rffindate,
       ''rfmanid,
       '' barprint,
       b.operationtype,
       b.RECCOMPANYID,
     c.srcexpdtlno,
     c.price
  from
  wms_st_io_doc a,
  wms_out_order_dtl c,
  wms_out_order b,
  tpl_pub_goods_packs e

 where
 a.sourceid=c.WAVEGOODSDTLID
 and c.OUTID=b.outid
 and a.goodspackid=e.goodspackid
 and a.inoutflag=1
 and a.comefrom=3
 and not exists(select 1 from wms_tpl_st_io_doc aa where a.inoutid=aa.inoutid)
"
"O1_WMS_HIS_PATCH_TPL1_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""O1_WMS_HIS_PATCH_TPL1_V"" (""INOUTID"", ""BARCODE"", ""GOODSID"", ""GOODSNAME"", ""PRODAREA"", ""LOTNO"", ""VALIDDATE"", ""PACKSIZE"", ""GOODSQTY"", ""EMPLOYEEID"", ""RECQTY"", ""COMPANYID"", ""APPROVENO"", ""RECTIME"", ""RFNO"", ""GOODSTYPE"", ""FLAG"", ""TRADEGOODSPACK"", ""E"", ""D"", ""F"", ""GOODSBARCODE"", ""RECMANID"", ""DIFREASON"", ""GOODSOWNERID"", ""WAREHID"", ""RFFINDATE"", ""TRANSID"", ""SRCEXPDTLNO"", ""VEHICLEID"", ""VEHICLENO"", ""DISPATCHDATE"", ""DISPATCHID"", ""EXPFLAG"", ""EXPDATE"", ""EXPFILENAME"") AS 
  select a.inoutid,
       b.boxcode barcode,
       a.goodsid,
       e.goodsname,
       e.prodarea,
       f.lotno,
       decode(to_char(f.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              f.validdate) validdate,
       1 packsize,
       d.goodsqty,
       null as employeeid,
       0 recqty,
       a.companyid,
       e.approvedocno approveno,
       null rectime,
       null rfno,
       e.goodstype,
       0 flag,
       i.tradegoodspack,
       null e,
       null d,
       null f,
       e.barcode goodsbarcode,
       null recmanid,
       null difreason,
       a.goodsownerid,
       a.warehid,
       a.rffindate,
       h.transid,
       i.SRCEXPDTLNO,
       null vehicleid,
       null vehicleno,
       null dispatchdate,
       null dispatchid,
       null expflag,
       null expdate,
       null expfilename
from wms_st_io_doc a,
     wms_box_doc b,
     wms_box_dtl c,
     WMS_TURNBOX_TO_BOX_REL d,
     tpl_pub_goods e,
     wms_goods_lot f,
     tpl_go_company g,
     wms_out_order h,
     wms_out_order_dtl i,
     wms_st_area_def j
where a.inoutflag = 1 and a.comefrom in(2,3) and a.usestatus = 1 and a.checkstatus = 1 and a.packingflag = 1
and a.inoutid = d.inoutid
and c.dtlid = d.boxdtlid
and b.docid=c.docid
and a.goodsid = e.goodsid
and a.lotid=f.lotid
and a.companyid = g.companyid
and a.sourceid = i.wavegoodsdtlid
and h.outid = i.outid
and a.areaid = j.areaid and j.areaflag in(2,3)  ---判断整散件
and not exists(select 1 from wms_his_patch aa where a.inoutid=aa.inoutid)
"
"O1_WMS_HIS_PATCH_TPL2_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""O1_WMS_HIS_PATCH_TPL2_V"" (""INOUTID"", ""BARCODE"", ""GOODSID"", ""GOODSNAME"", ""PRODAREA"", ""LOTNO"", ""VALIDDATE"", ""PACKSIZE"", ""GOODSQTY"", ""EMPLOYEEID"", ""RECQTY"", ""COMPANYID"", ""APPROVENO"", ""RECTIME"", ""RFNO"", ""GOODSTYPE"", ""FLAG"", ""TRADEGOODSPACK"", ""E"", ""D"", ""F"", ""GOODSBARCODE"", ""RECMANID"", ""DIFREASON"", ""GOODSOWNERID"", ""WAREHID"", ""RFFINDATE"", ""TRANSID"", ""SRCEXPDTLNO"", ""VEHICLEID"", ""VEHICLENO"", ""DISPATCHDATE"", ""DISPATCHID"", ""EXPFLAG"", ""EXPDATE"", ""EXPFILENAME"") AS 
  select a.inoutid,
       to_char(a.inoutid) barcode,
       a.goodsid,
       e.goodsname,
       e.prodarea,
       f.lotno,
       decode(to_char(f.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              f.validdate) validdate,
       k.packsize packsize,
       a.goodsqty,
       null as employeeid,
       0 recqty,
       a.companyid,
       e.approvedocno approveno,
       null rectime,
       null rfno,
       e.goodstype,
       0 flag,
       i.tradegoodspack,
       null e,
       null d,
       null f,
       e.barcode goodsbarcode,
       null recmanid,
       null difreason,
       a.goodsownerid,
       a.warehid,
       a.rffindate,
       h.transid,
       i.SRCEXPDTLNO,
       null vehicleid,
       null vehicleno,
       null dispatchdate,
       null dispatchid,
       null expflag,
       null expdate,
       null expfilename
from wms_st_io_doc a,
     tpl_pub_goods e,
     wms_goods_lot f,
     tpl_go_company g,
     wms_out_order h,
     wms_out_order_dtl i,
     wms_st_area_def j,
     tpl_pub_goods_packs k
where a.inoutflag = 1 and a.comefrom in(2,3) and a.usestatus = 1 and a.checkstatus = 1 and a.packingflag = 1
and a.goodsid = e.goodsid
and a.lotid=f.lotid
and a.companyid = g.companyid
and a.sourceid = i.wavegoodsdtlid
and h.outid = i.outid
and a.areaid = j.areaid and j.areaflag in(0,1)  ---判断整散件
and a.goodspackid = k.goodspackid
and not exists(select 1 from wms_his_patch aa where a.inoutid=aa.inoutid)
"
"OSGC_IWCS_CONFIG_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""OSGC_IWCS_CONFIG_V"" (""CONFIGID"", ""IWCS_URL"", ""MEMO"", ""WAREHID"", ""WAREHNAME"") AS 
  select a.CONFIGID, a.IWCS_URL, a.MEMO, a.WAREHID,b.warehname
  from osgc_iwcs_config a, tpl_warehouse b
 where a.warehid = b.warehid(+)
"
"OUT_GEN_INRECEIVE_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""OUT_GEN_INRECEIVE_DOC_V"" (""OUTGENID"", ""CREDATE"", ""WAREHID"", ""GOODSOWNERID"", ""INVOICETIME"", ""INVOICENO"", ""INVOICECODE"", ""MEMO"", ""USESTATUS"", ""GOODSOWNERNAME"", ""WAREHNAME"") AS 
  select a.""OUTGENID"",
       a.""CREDATE"",
       a.""WAREHID"",
       a.""GOODSOWNERID"",
       a.""INVOICETIME"",
       a.""INVOICENO"",
       a.""INVOICECODE"",
       a.""MEMO"",
       a.""USESTATUS"",
       b.goodsownername,
       c.WAREHNAME
  from OUT_GEN_INRECEIVE_DOC a, tpl_goodsowner b, tpl_warehouse c
 where a.warehid = c.warehid
   and a.goodsownerid = b.goodsownerid
"
"PUBSRV_MANAGER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""PUBSRV_MANAGER_V"" (""SEQID"", ""TYPE"", ""COMMAND"", ""CLASSNAME"", ""FUNNAME"", ""MEMO"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"") AS 
  select a.seqid,
       a.type,
       a.command,
       a.classname,
       a.funname,
       a.memo,
       a.credate,
       a.inputmanid,
       b.employeename inputmanname
  from pubsrv_manager a, pub_employee b
 where a.inputmanid=b.employeeid

 "
"PUB_COMPANY_SET_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""PUB_COMPANY_SET_DTL_V"" (""SETID"", ""SETDTLID"", ""COMPANYID"", ""OPCODE"", ""COMPANYNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.setid,
       a.setdtlid,
       b.companyid,
       b.opcode,
       b.companyname,
       b.goodsownerid,
       c.goodsownername
  from pub_company_set_dtl a, tpl_go_company b,tpl_goodsowner c
 where a.companyid = b.companyid
   and b.goodsownerid=c.goodsownerid
"
"PUB_COMPANY_SET_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""PUB_COMPANY_SET_V"" (""SETID"", ""SETOPCODE"", ""SETNAME"", ""INPUTMANID"", ""INPUTMANNAME"", ""CREDATE"", ""USESTATUS"", ""WAREHID"", ""WAREHNAME"") AS 
  select a.setid,
       a.setopcode,
       a.setname,
       a.inputmanid,
       b.employeeid inputmanname,
       a.credate,
       a.usestatus,
       a.warehid,
       c.warehname
  from pub_company_set a, pub_employee b,tpl_warehouse c
 where a.inputmanid = b.employeeid
   and a.warehid = c.warehid(+)
"
"PUB_COMPANY_VIEW","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""PUB_COMPANY_VIEW"" (""COMPANYID"", ""COMPANYOPCODE"", ""COMPANYPINYIN"", ""COMPANYNAME"", ""PARENTCOMPANYID"", ""PARENTCOMPANYOPCODE"", ""PARENTCOMPANYNAME"", ""CORPCODE"", ""SELFFLAG"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""REFERENCEDCOUNT"", ""COMPANYMEMO"", ""SUPPLYERFLAG"", ""QUDEPTFLAG"", ""CUSTOMFLAG"", ""FACTFLAG"", ""TRANSPORTFLAG"", ""DEPTSUPPLY"", ""DEPTSALESFLAG"", ""DEPTSTORERFLAG"", ""BANKFLAG"", ""FINANCENO"") AS 
  select a.companyid,
       a.companyopcode,
       a.companypinyin,
       a.companyname,
       a.parentcompanyid,
       b.companyopcode parentcompanyopcode,
       b.companyname parentcompanyname,
       a.corpcode,
       nvl(a.selfflag,0) selfflag,
       a.credate,
       a.inputmanid,
       c.employeename inputmanname,
       a.referencedcount,
       a.companymemo,
       nvl(a.supplyerflag,0) supplyerflag,
       nvl(a.qudeptflag,0) qudeptflag,
       nvl(a.customflag,0) customflag,
       nvl(a.factflag,0) factflag,
       nvl(a.transportflag,0) transportflag,
       nvl(a.deptsupply,0) deptsupply,
       nvl(a.deptsalesflag,0) deptsalesflag,
       nvl(a.deptstorerflag,0) deptstorerflag,
       nvl(a.bankflag,0) bankflag,
       a.financeno
  from pub_company a, pub_company b, pub_employee c
 where a.parentcompanyid = b.companyid
   and a.inputmanid = c.employeeid
   and a.companyid > 0

 "
"PUB_DDL_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""PUB_DDL_DTL_V"" (""SYSID"", ""SYSDTLID"", ""DDLID"", ""DDLNAME"", ""BTFLAG"", ""CHAINFLAG"", ""TGFLAG"", ""FFZJFLAG"") AS 
  select a.sysid,
       a.sysdtlid,
       a.ddlid,
       a.ddlname,
       a.btflag, --add by xyue 2016-12-30 收货验收必填标志
       a.chainflag, --add by xyue 2016-12-30 冷链品种标志
       a.tgflag, --add by xyue 2017-01-18 特管品种标志
       a.ffzjflag --add by xyue 2017-01-18 含特殊药品复方制剂标志
  from pub_ddl_dtl a
"
"PUB_DDL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""PUB_DDL_V"" (""SYSID"", ""KEYWORD"", ""TABLECOLUMN"", ""MEMO"") AS 
  select a.sysid,
       a.keyword,
       a.tablecolumn,
       a.memo
  from pub_ddl a

 "
"PUB_DEPT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""PUB_DEPT_V"" (""COMPANYNAME"", ""COMPANYOPCODE"", ""COMPANYPINYIN"", ""PARENTCOMPANYOPCODE"", ""PARENTCOMPANYNAME"", ""INPUTMANNAME"", ""CREDATE"", ""COMPANYMEMO"", ""SELFFLAG"", ""COMPANYID"", ""PARENTCOMPANYID"", ""INPUTMANID"") AS 
  select a.companyname,
        a.companyopcode,
        a.companypinyin,
        b.companyopcode parentcompanyopcode,
        b.companyname parentcompanyname,
        c.employeename inputmanname,
        a.credate,
        a.companymemo,
        a.selfflag,
        a.companyid,
        a.parentcompanyid,
        a.inputmanid
  from pub_company a,
        pub_company b,
        pub_employee c
        where a.parentcompanyid = b.companyid
        and a.inputmanid=c.employeeid(+)

 "
"PUB_EMPLOYEE_HIS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""PUB_EMPLOYEE_HIS_V"" (""EMPLOYEEID"", ""OPCODE"", ""EMPLOYEENAME"", ""PINYIN"", ""PDAPASS"", ""SEX"", ""BIRTHDATE"", ""BP"", ""DEPTID"", ""MEMO"", ""USESTATUS"", ""DEPTNAME"", ""DEPTOPCODE"", ""DEPTNO"", ""HISCOMPANYID"", ""COMPANYNAME"", ""COMPANYOPCODE"") AS 
  select pub_employee.employeeid,
       pub_employee.opcode,
       pub_employee.employeename,
       pub_employee.pinyin,
       pub_employee.pdapass,
       pub_employee.sex,
       pub_employee.birthdate,
       pub_employee.bp,
       pub_employee.deptid,
       pub_employee.memo,
       pub_employee.usestatus,
       pub_company.companyname deptname,
       pub_company.companyopcode deptopcode,
       pub_company.companyno deptno,
       pub_employee.hiscompanyid,
       tpl_go_company.companyname,
       tpl_go_company.opcode companyopcode
  from pub_employee, pub_company,tpl_go_company
 where employeeid > 0
   and pub_employee.deptid = pub_company.companyid(+)
    and pub_employee.HISCOMPANYID = tpl_go_company.companyid
"
"PUB_EMPLOYEE_TMS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""PUB_EMPLOYEE_TMS_V"" (""EMPLOYEEID"", ""EMPLOYEENAME"", ""ADMINFLAG"", ""WAREHIDS"", ""WEBPASS"", ""WAREHID"", ""WAREHNAME"") AS 
  select t.employeeid,
       t.employeename,
       nvl(t.adminflag,0) adminflag,
       t.warehids,
       t.webpass,
       t.warehid,
       tt.warehname
 from pub_employee t,tpl_warehouse tt
 where t.warehid=tt.warehid(+)
"
"PUB_EMPLOYEE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""PUB_EMPLOYEE_V"" (""EMPLOYEEID"", ""OPCODE"", ""EMPLOYEENAME"", ""PINYIN"", ""SEX"", ""BIRTHDATE"", ""IDCARD"", ""DEPTID"", ""DEPTOPCODE"", ""DEPTNAME"", ""MEMO"", ""USESTATUS"", ""EMAIL"", ""PHONE"", ""MOBILENO"", ""ADDRESS"", ""STATION"", ""JOBEDU"", ""SPECIALTY"", ""EDULEVEL"", ""SELFFLAG"", ""FINANCENO"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""WAREHID"", ""WAREHNAME"", ""GOOPCODE"", ""WAREHOPCODE"", ""WAREHIDS"", ""LOGINNAME"", ""PASSWORD"", ""DBINCHECK"", ""DBCHECK"") AS 
  select a.employeeid,
       a.opcode,
       a.employeename,
       a.pinyin,
       a.sex,
       a.birthdate,
       a.idcard,
       a.deptid,
       b.companyopcode deptopcode,
       b.companyname deptname,
       a.memo,
       a.usestatus,
       a.email,
       a.phone,
       a.mobileno,
       a.address,
       a.station,
       a.jobedu,
       a.specialty,
       a.edulevel,
       a.selfflag,
       a.financeno,
       a.goodsownerid,
       c.goodsownername,
       a.warehid,
       d.warehname,
       c.goopcode,
       d.warehopcode,
       a.warehids,
       a.loginname,--add by xyue 2018-11-20 TMS登录名
       a.password, --add by xyue 2018-11-20 TMS登录密码 MD5加密
       a.dbincheck,
       a.dbcheck
  from pub_employee a, pub_company b, tpl_goodsowner c, tpl_warehouse d
 where a.employeeid > 0
   and a.deptid = b.companyid
   and a.goodsownerid = c.goodsownerid(+)
   and a.warehid = d.warehid(+)
"
"PUB_GOODS_SET_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""PUB_GOODS_SET_DTL_V"" (""SETID"", ""SETDTLID"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"") AS 
  select a.setid,
       a.setdtlid,
       a.goodsid,
       b.opcode,
       b.goodsname,
       b.goodstype,
       b.prodarea
  from pub_goods_set_dtl a, tpl_pub_goods b
 where a.goodsid = b.goodsid

 
 "
"PUB_GOODS_SET_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""PUB_GOODS_SET_V"" (""SETID"", ""SETOPCODE"", ""SETNAME"", ""INPUTMANID"", ""INPUTMANNAME"", ""CREDATE"", ""USESTATUS"") AS 
  select a.setid,
       a.setopcode,
       a.setname,
       a.inputmanid,
       b.employeeid inputmanname,
       a.credate,
       a.usestatus
  from pub_goods_set a, pub_employee b
 where a.inputmanid = b.employeeid

 
 "
"RETROSPECT_HUMITURE_INFO_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RETROSPECT_HUMITURE_INFO_V"" (""TRANSPORTCOMPANY"", ""TRANSPORTNO"", ""TIMEPOINT"", ""TEMPERATURE"", ""TRID"", ""HUMIDITY"") AS 
  select tt.warehname transportcompany,
       tt.warehname || t.TRID transportno,
       b.devtempdatetime timepoint,
       b.devtempdata temperature,
       t.trid,
       nvl(b.rh,0) humidity
  from tms_luyan_tr_doc_v t, tms_luyan_dispatch_doc_v tt,tms_luyan_bin_record a,tms_luyan_humiture_record b
 where t.DISPATCHID = tt.dispatchid
 and   t.TRID=a.trid
 and   a.devnum=b.devnum
 and   b.devtempdatetime between t.dispatchdate and t.SIGNDATE
 and   t.WAREHID=1
 and   t.signflag in (3,4) --已签收和部分签收
 --and   b.rh is not null
"
"RETROSPECT_TRAJECTORY_INFO_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RETROSPECT_TRAJECTORY_INFO_V"" (""LONGITUDE"", ""LATITUDE"", ""TRANSPORTCOMPANY"", ""TRANSPORTNO"", ""TRID"", ""TIMEPOINT"") AS 
  select a.lng longitude,
       a.lat latitude,
       t.warehname transportcompany,
       t.warehname || t.TRID transportno,
       t.TRID,
       a.gpstime timepoint
  from tms_luyan_tr_doc_v t, tms_luyan_dispatch_doc_v tt,tms_luyan_gps_record a
 where t.DISPATCHID = tt.dispatchid
 and   tt.gpsno=a.imei
 and   a.gpstime<t.SIGNDATE
 and   a.gpstime>t.dispatchdate --装车时间
 and   t.WAREHID=1
 and   t.signflag in (3,4) --已签收和部分签收
 -- change by xyue 2018-05-14
"
"RETROSPECT_TRANSPORT_INFO_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RETROSPECT_TRANSPORT_INFO_V"" (""TRANSPORTCOMPANY"", ""TRANSPORTNO"", ""BILLNO"", ""STORENAME"", ""STOREADDRESS"", ""TRANSPORTADDRESS"", ""STARTTIME"", ""ENDTIME"", ""TRANSPORTMAN"", ""TRID"", ""TRANSPORTCARNO"") AS 
  select t.warehname transportcompany,
       t.warehname || t.TRID transportno,--唯一主键
       t.SOURCEID billno,
       t.warehname storename,
       nvl(h.province||h.city||h.district||h.poiname,t.warehname) storeaddress,
       nvl(t.POINAME,t.address) transportaddress,
       t.dispatchdate starttime,--装车时间
       t.SIGNDATE endtime,
       tt.drivername transportman,
       t.TRID,
       tt.vehicleno transportcarno
  from tms_luyan_tr_doc_v t, tms_luyan_dispatch_doc_V tt,tpl_warehouse h
 where t.DISPATCHID = tt.dispatchid
 and   t.signflag in (3,4)--已签收、部分签收
 and   t.COMEFROM=1 --wms转入
 and   t.WAREHID=1
 and   t.TASKTYPE=0 --任务类型送货
 and   t.WAREHID=h.warehid(+)
 and   t.address is not null
--change by xyue 2018-05-14
"
"RF_BIGPOS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_BIGPOS_V"" (""INOUTID"", ""WAREHID"", ""GOODSQTY"", ""OPERATIONTYPE"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSOWNID"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""PRODLICENSENO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""LPNCODE"", ""AREAID"", ""AREANAME"", ""AREAFLAG"", ""SECTIONID"", ""SECTIONNAME"", ""GROUPID"", ""SORTTYPE"", ""TRADEPACKNAME"", ""CONTAINERID"", ""CONTAINERNO"", ""INDTLID"", ""POSNO"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.inoutid,
       a.warehid,
       a.goodsqty,
       op.ddlname operationtype,
       a.goodsid,
       a.ownergoodsid,
       decode(d.goodsengname,
              null,
              d.goodsname,
              d.goodsname || '(' || d.goodsengname || ')') goodsname,
       --修改RF上【大货位上架】功能中货品名称的显示，若货品主档上没有商品名，就显示通用名；若有商品名就显示通用名（商品名字）
       --xyue 2014年1月15日 09:24:54
       d.goodstype,
       --修改RF上看到的信息为货主货品信息的内容
       d.prodarea,
       d.goodsownid,
       e.lotid,
       e.lotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              null,
              to_char(e.validdate, 'YYYY-MM-DD')) validdate,
       e.approvedocno,
       e.registno,
       e.prodlicenseno,
       f.goodsstatusid,
       f.goodsstatus,
       quan.ddlname quantitystatus,
       usef.ddlname useflag,
       h.goodspackid,
       h.packname,
       h.packsize,
       b.lpncode,
       a.areaid,
       i.areaname,
       i.areaflag,
       a.sectionid,
       g.sectionname,
       g.groupid,
       sortt.ddlname sorttype,
       t.packname tradepackname,
       a.containerid,
       j.containerno,
       b.indtlid,
       (select max(tt.posname)
          from wms_st_qty_lst t, wms_pos_def tt
         where t.posid = tt.posid
           and t.warehid = a.warehid
           and t.ownergoodsid = a.ownergoodsid
           and t.lotid = a.lotid
           and t.goodspackid = a.goodspackid
           and t.goodsstatusid = a.goodsstatusid) posno,
       a.goodsownerid,
       o.goodsownername || '(' || a.goodsownerid || ')' goodsownername
  from wms_st_io_doc       a,
       wms_container_def   j,
       wms_receive_dtl     b,
       tpl_pub_goods       c,
       tpl_goods           d,
       wms_goods_lot       e,
       wms_goodsstatus     f,
       wms_st_section_def  g,
       wms_st_area_def     i,
       tpl_pub_goods_packs h,
       tpl_pub_goods_packs t,
       sys_ddl_dtl         op,
       pub_ddl_dtl         quan,
       sys_ddl_dtl         usef,
       pub_ddl_dtl         sortt,
       tpl_goodsowner      o
 where a.comefrom = 1
   and a.containerid = j.containerid(+)
   and a.sourceid = b.receiveid
   and a.rfflag = 2
   and a.posid is null
   and a.areaid = i.areaid
   and a.sectionid = g.sectionid
   and a.goodsid = c.goodsid
   and a.ownergoodsid = d.ownergoodsid
   and a.lotid = e.lotid
   and a.goodspackid = h.goodspackid
   and a.goodsstatusid = f.goodsstatusid
   and a.goodsid = t.goodsid
   and t.baseunitflag = 1
   and a.operationtype = op.ddlid
   and op.sysid = 389 -- TPL_OPERATIONTYPE 业务类型
   and f.quantitystatus = quan.ddlid
   and quan.sysid = 11 --TPL_QUANTITYSTATUS 质量状态
   and f.useflag = usef.ddlid
   and usef.sysid = 456 --WMS_USEFLAG 可销状态
   and g.sorttype = sortt.ddlid
   and sortt.sysid = 573 --WMS_SECTION_SORTTYPE 分区类型
   and a.goodsownerid = o.goodsownerid(+)
"
"RF_DYNAMICQTYCUT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_DYNAMICQTYCUT_V"" (""WAREHID"", ""GOODSOWNERID"", ""GOODSQTY"", ""POSQTY"", ""BUSIQTY"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSOPCODE"", ""BARCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSOWNID"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""PRODLICENSENO"", ""BATCHNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""TRADEPACKNAME"", ""POSID"", ""AREAID"", ""SECTIONID"", ""SECTIONNAME"", ""AREANAME"", ""POSNO"", ""GROUPID"", ""SCATTERPICKRATE"", ""WHOLEPICKRATE"", ""GOODSOWNERNAME"") AS 
  select a.warehid,
       a.goodsownerid,
       a.goodsqty,
       a.posqty,
       a.busiqty,
       a.goodsid,
       a.ownergoodsid,
       c.opcode GOODSOPCODE,
       c.barcode,
       c.goodsname,
       c.goodstype,
       d.factname prodarea,
       d.goodsownid,
       e.lotid,
       e.lotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              null,
              to_char(e.validdate, 'YYYY-MM-DD')) validdate,
       e.approvedocno,
       e.registno,
       e.prodlicenseno,
       a.batchno,
       f.goodsstatusid,
       f.goodsstatus,
       quan.ddlname quantitystatus,
       usef.ddlname useflag,
       h.goodspackid,
       h.packname,
       h.packsize,
       t.packname tradepackname,
       a.posid,
       j.areaid,
       j.sectionid,
       g.sectionname,
       i.areaname,
       j.posno,
       y.groupid groupid,
       gtr.scatterpickrate,
       gtr.wholepickrate,
       o.goodsownername
  from wms_st_qty_lst       a,
       tpl_pub_goods        c,
       tpl_goods            d,
       wms_goods_lot        e,
       wms_goodsstatus      f,
       wms_st_section_def   g,
       wms_st_area_def      i,
       wms_pos_def          j,
       tpl_pub_goods_packs  h,
       tpl_pub_goods_packs  t,
       Sys_Ddl_All_v        quan,
       Sys_Ddl_All_v        usef,
       wms_pickarea_pos_def x,
       wms_pickarea         y,
       wms_goods_feature    gtr,
       tpl_goodsowner       o
 where a.posid = j.posid
   and j.areaid = i.areaid
   and j.sectionid = g.sectionid
   and a.goodsid = c.goodsid
   and a.ownergoodsid = d.ownergoodsid
   and a.lotid = e.lotid
   and a.goodspackid = h.goodspackid
   and a.goodsstatusid = f.goodsstatusid
   and a.goodsid = t.goodsid
   and t.baseunitflag = 1
   and f.quantitystatus = quan.ddlid
   and quan.keyword = 'TPL_QUANTITYSTATUS'
   and f.useflag = usef.ddlid
   and usef.keyword = 'WMS_USEFLAG'
   AND a.posid = x.posid
   AND y.pickareaid = x.pickareaid
   and a.goodsid = gtr.goodsid
   and gtr.warehid = a.warehid
   and a.goodsownerid = o.goodsownerid(+)
"
"RF_GROUP_OP_MAN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_GROUP_OP_MAN_V"" (""GROUPID"", ""GROUPNAME"", ""EMPLOYEEID"", ""EMPLOYEENAME"", ""OPID"", ""OPNAME"", ""WAREHID"") AS 
  select a.groupid,b.groupname,a.employeeid,e.employeename,d.opid,d.opname,b.warehid
  from wms_group_man a,
       wms_group_def b,
       rf_group_op   c,
       rf_op         d,
       pub_employee  e
 where a.groupid = b.groupid
   and a.groupid = c.groupid
   and c.opid = d.opid
   and a.employeeid = e.employeeid
"
"RF_GROUP_OP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_GROUP_OP_V"" (""GROUPOPID"", ""GROUPID"", ""OPID"", ""OPNAME"") AS 
  select a.groupopid,
a.groupid,
a.opid,
b.opname
from rf_group_op a,rf_op b
where a.opid=b.opid
"
"RF_HANDCARTPICK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_HANDCARTPICK_V"" (""INOUTID"", ""WAREHID"", ""GOODSQTY"", ""GOODSID"", ""OWNERGOODSID"", ""CARTID"", ""CARTNO"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSOWNID"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""PRODLICENSENO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SOURCEID"", ""AREAID"", ""AREANAME"", ""AREAFLAG"", ""POSID"", ""POSNO"", ""PICKSEQ"", ""SECTIONNAME"", ""GROUPID"", ""BOXDOCID"", ""CONTAINERNO"", ""OPERATIONTYPE"", ""SORTTYPE"", ""TRADEPACKNAME"", ""COMPANYNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.inoutid,
       a.warehid,
       a.goodsqty,
       a.goodsid,
       a.ownergoodsid,
       b.cartid,
       bc.containerno cartno,
       c.goodsname,
       c.goodstype,
       c.prodarea,
       d.goodsownid,
       e.lotid,
       e.lotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              null,
              to_char(e.validdate, 'YYYY-MM-DD')) validdate,
       e.approvedocno,
       e.registno,
       e.prodlicenseno,
       f.goodsstatusid,
       f.goodsstatus,
       quan.ddlname quantitystatus,
       usef.ddlname useflag,
       h.goodspackid,
       h.packname,
       h.packsize,
       a.sourceid,
       a.areaid,
       i.areaname,
       i.areaflag,
       j.posid,
       j.posno,
       l.pickseq,
       g.sectionname,
       k.groupid,
       a.boxdocid,
       bb.containerno,
       op.ddlname operationtype,
       sortt.ddlname sorttype,
       t.packname tradepackname,
       goc.companyname,
       a.goodsownerid,
       o.goodsownername
  from wms_st_io_doc        a,
       wms_turnbox_doc      b,
       wms_container_def    bb,
       wms_container_def    bc,
       tpl_pub_goods        c,
       tpl_goods            d,
       wms_goods_lot        e,
       wms_goodsstatus      f,
       wms_st_section_def   g,
       wms_st_area_def      i,
       wms_pos_def          j,
       wms_pickarea         k,
       wms_pickarea_pos_def l,
       tpl_pub_goods_packs  h,
       tpl_pub_goods_packs  t,
       Sys_Ddl_All_v        op,
       Sys_Ddl_All_v        quan,
       Sys_Ddl_All_v        usef,
       Sys_Ddl_All_v        sortt,
       tpl_go_company       goc,
       tpl_goodsowner       o
 where a.comefrom = 3
   and a.inoutflag = 1
   and a.boxdocid = b.boxdocid
   and b.containerid = bb.containerid(+)
   and b.cartid = bc.containerid(+)
   and a.rfflag = 2
   and i.areaflag in (2, 3)
   and a.pickareaid = k.pickareaid
   and a.posid = l.posid
   and a.areaid = i.areaid
   and a.sectionid = g.sectionid
   and a.posid = j.posid
   and a.goodsid = c.goodsid
   and a.ownergoodsid = d.ownergoodsid
   and a.lotid = e.lotid
   and a.goodspackid = h.goodspackid
   and a.goodsstatusid = f.goodsstatusid
   and a.goodsid = t.goodsid
   and t.baseunitflag = 1
   and a.operationtype = op.ddlid(+)
   and op.keyword(+) = 'TPL_OPERATIONTYPE'
   and f.quantitystatus = quan.ddlid
   and quan.keyword = 'TPL_QUANTITYSTATUS'
   and f.useflag = usef.ddlid
   and usef.keyword = 'WMS_USEFLAG'
   and g.sorttype = sortt.ddlid
   and sortt.keyword = 'WMS_SECTION_SORTTYPE'
   AND b.companyid = goc.companyid(+)
   and a.goodsownerid = o.goodsownerid(+)
"
"RF_INCHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_INCHECK_V"" (""RECEIVEID"", ""RECEIVEDATE"", ""CHECKDATE"", ""INDTLID"", ""WAREHID"", ""OWNERGOODSID"", ""OWNERGOODSNAME"", ""OWNERGOODSOPCODE"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""GOODSPACKID"", ""GOODSPACKNAME"", ""PACKSIZE"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSCUBAGE"", ""GOODSWEIGHT"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""PRODDATE"", ""PRODLICENSENO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""GOODSOWNID"", ""STORAGECONDITION"", ""RECMEMO"", ""FACEQUALITY"", ""PACKQUALITY"", ""TRANSTEMP"", ""IMPORTREPFLAG"", ""PASSGATEFLAG"", ""REGISTEFLAG"", ""MEDCHECKFLAG"", ""ELIGIBILITYFLAG"", ""APPROVEDOCNO"", ""REGISTNO"", ""RPTNO"", ""BACKWHYID"", ""CHECKMANID1"", ""CHECKMAN1"", ""CHECKMANID2"", ""CHECKMAN2"", ""CHECKDOCNO"", ""LQCCHECK"", ""PASSGATENO"", ""PIJIANNO"", ""QUCHECKID"", ""LPNCODE"", ""CONTAINERID"", ""CONTAINERNO"", ""TYPEID"", ""QUCHECKNAME"", ""INPUTMANID"", ""SORTTYPE"", ""TRAYSECTIONID"", ""TRAYSECTIONNO"", ""TRAYSECTIONNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""WHOLESECTIONID"", ""WHOLESECTIONNO"", ""WHOLESECTIONNAME"", ""SENDNO"", ""USESTATUS"", ""RULINGFLAG"", ""GSPFLAG"", ""RECEIVETYPE"", ""STATUSREASON"", ""RECEIVEDETAILID"", ""L_PERIOD"", ""S_PERIODUNIT"", ""CHECKMEMO"", ""MATCHFLAG"", ""ECODEFLAG"", ""GOODSOWNERID"", ""TRADEGOODSPACK"", ""PACKNAME"", ""GOODSOWNERNAME"", ""OPERATIONTYPE"", ""SOURCECOMPANYID"", ""SRCCOMPANYNAME"", ""DBINCHECK"") AS 
  select a.RECEIVEID,
       a.RECEIVEDATE,
       a.CHECKDATE,
       a.INDTLID,
       a.WAREHID,
       a.OWNERGOODSID,
       a.OWNERGOODSNAME,
       a.OWNERGOODSOPCODE,
       a.GOODSID,
       a.OPCODE,
       a.GOODSNAME,
       a.GOODSTYPE,
       a.PRODAREA,
       a.FACTNAME,
       a.GOODSPACKID,
       a.GOODSPACKNAME,
       a.PACKSIZE,
       a.GOODSLENGTH,
       a.GOODSWIDTH,
       a.GOODSHEIGHT,
       a.GOODSCUBAGE,
       a.GOODSWEIGHT,
       a.BATCHNO,
       a.LOTID,
       a.LOTNO,
       a.KILLLOTNO,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.PRODDATE,
       a.PRODLICENSENO,
       a.GOODSSTATUSID,
       a.GOODSSTATUS,
       a.QUANTITYSTATUS,
       a.GOODSQTY,
       a.WHOLEQTY,
       a.SCATTERQTY,
       a.GOODSOWNID,
       a.STORAGECONDITION,
       a.RECMEMO,
       a.FACEQUALITY,
       a.PACKQUALITY,
       a.TRANSTEMP,
       a.IMPORTREPFLAG,
       a.PASSGATEFLAG,
       a.REGISTEFLAG,
       a.MEDCHECKFLAG,
       a.ELIGIBILITYFLAG,
       a.APPROVEDOCNO,
       a.REGISTNO,
       a.RPTNO,
       a.BACKWHYID,
       a.CHECKMANID1,
       a.CHECKMAN1,
       a.CHECKMANID2,
       a.CHECKMAN2,
       a.CHECKDOCNO,
       a.LQCCHECK,
       a.PASSGATENO,
       a.PIJIANNO,
       a.QUCHECKID,
       a.LPNCODE,
       a.CONTAINERID,
       a.CONTAINERNO,
       a.TYPEID,
       a.QUCHECKNAME,
       a.INPUTMANID,
       a.SORTTYPE,
       a.TRAYSECTIONID,
       a.TRAYSECTIONNO,
       a.TRAYSECTIONNAME,
       a.SECTIONID,
       a.SECTIONNO,
       a.SECTIONNAME,
       a.WHOLESECTIONID,
       a.WHOLESECTIONNO,
       a.WHOLESECTIONNAME,
       a.SENDNO,
       a.USESTATUS,
       a.RULINGFLAG,
       a.GSPFLAG,
       a.RECEIVETYPE,
       a.STATUSREASON,
       a.RECEIVEDETAILID,
       a.L_PERIOD,
       a.S_PERIODUNIT,
       a.CHECKMEMO,
       a.MATCHFLAG,
       a.ECODEFLAG,
       c.goodsownerid,
       b.tradegoodspack,
       b.packname,
       c.goodsownername,
       c.operationtype,
       c.sourcecompanyid,
       c.srccompanyname,
       a.dbincheck--add by weitangjing 20131031
  from wms_receive_dtl_v a, wms_in_order_dtl_v b, wms_in_order_v c
 where a.indtlid = b.indtlid
   and b.inid = c.inid
   and a.usestatus <> 1
   and nvl(a.gspflag, 1) = 1
   and b.inid = c.inid
UNION
select a.RECEIVEID,
       a.RECEIVEDATE,
       a.CHECKDATE,
       a.INDTLID,
       a.WAREHID,
       a.OWNERGOODSID,
       a.OWNERGOODSNAME,
       a.OWNERGOODSOPCODE,
       a.GOODSID,
       a.OPCODE,
       a.GOODSNAME,
       a.GOODSTYPE,
       a.PRODAREA,
       a.FACTNAME,
       a.GOODSPACKID,
       a.GOODSPACKNAME,
       a.PACKSIZE,
       a.GOODSLENGTH,
       a.GOODSWIDTH,
       a.GOODSHEIGHT,
       a.GOODSCUBAGE,
       a.GOODSWEIGHT,
       a.BATCHNO,
       a.LOTID,
       a.LOTNO,
       a.KILLLOTNO,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.PRODDATE,
       a.PRODLICENSENO,
       a.GOODSSTATUSID,
       a.GOODSSTATUS,
       a.QUANTITYSTATUS,
       a.GOODSQTY,
       a.WHOLEQTY,
       a.SCATTERQTY,
       a.GOODSOWNID,
       a.STORAGECONDITION,
       a.RECMEMO,
       a.FACEQUALITY,
       a.PACKQUALITY,
       a.TRANSTEMP,
       a.IMPORTREPFLAG,
       a.PASSGATEFLAG,
       a.REGISTEFLAG,
       a.MEDCHECKFLAG,
       a.ELIGIBILITYFLAG,
       a.APPROVEDOCNO,
       a.REGISTNO,
       a.RPTNO,
       a.BACKWHYID,
       a.CHECKMANID1,
       a.CHECKMAN1,
       a.CHECKMANID2,
       a.CHECKMAN2,
       a.CHECKDOCNO,
       a.LQCCHECK,
       a.PASSGATENO,
       a.PIJIANNO,
       a.QUCHECKID,
       a.LPNCODE,
       a.CONTAINERID,
       a.CONTAINERNO,
       a.TYPEID,
       a.QUCHECKNAME,
       a.INPUTMANID,
       a.SORTTYPE,
       a.TRAYSECTIONID,
       a.TRAYSECTIONNO,
       a.TRAYSECTIONNAME,
       a.SECTIONID,
       a.SECTIONNO,
       a.SECTIONNAME,
       a.WHOLESECTIONID,
       a.WHOLESECTIONNO,
       a.WHOLESECTIONNAME,
       a.SENDNO,
       a.USESTATUS,
       a.RULINGFLAG,
       a.GSPFLAG,
       a.RECEIVETYPE,
       a.STATUSREASON,
       a.RECEIVEDETAILID,
       a.L_PERIOD,
       a.S_PERIODUNIT,
       a.CHECKMEMO,
       a.MATCHFLAG,
       a.ECODEFLAG,
       c.goodsownerid,
       '' tradegoodspack,
       b.goodspackname packname,
       c.goodsownername,
       c.operationtype,
       c.gocompanyid sourcecompanyid,
       c.companyname srccompanyname,
       a.dbincheck--add by weitangjing 20131031
  FROM wms_receive_dtl_v a, wms_receive_detail b, wms_receive_doc_v c
 where a.receivedetailid = b.receivedetailid
   AND b.receivedocid = c.receivedocid
   and nvl(a.usestatus, 0) <> 1
   and nvl(a.gspflag, 1) = 1
"
"RF_INSCAN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_INSCAN_V"" (""INID"", ""ZXCOLUMN4"", ""SOURCECOMPANYID"", ""SRCCOMPANYNAME"", ""WAREHID"", ""USESTATUS"", ""GOODSID"", ""GOODSNAME"", ""GOODSQTY"", ""FACTNAME"", ""GOODSTYPE"", ""INDTLID"", ""PRODAREA"", ""LOTNO"", ""VALIDDATE"", ""PACKSIZE"", ""PACKNAME"", ""ECODEFLAG"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.inid,
       a.zxcolumn4,
       a.sourcecompanyid,
       c.companyname srccompanyname,
       a.warehid,
       a.usestatus,
       b.goodsid,
       d.goodsname,
       nvl(b.qty,b.goodsqty) goodsqty,
       d.factname,
       d.goodstype,
       b.indtlid,
       d.prodarea,
       b.lotno,
       to_char(b.validdate, 'yyyy-mm-dd') validdate,
       e.packsize,
       e.packname,
       d.ecodeflag,
       a.goodsownerid,
       o.goodsownername||'('||a.goodsownerid||')' goodsownername
  from wms_in_order        a,
       wms_in_order_dtl    b,
       tpl_go_company      c,
       tpl_goods           d,
       tpl_pub_goods_packs e,
       tpl_goodsowner      o
 where a.inid = b.inid
   and a.sourcecompanyid = c.companyid(+)
   and b.ownergoodsid = d.ownergoodsid(+)
   and b.goodspackid = e.goodspackid(+)
   and nvl(b.porderstatus,0)<>4
   and nvl(b.clflag,0)=1
   and nvl(d.ecodeflag, 0) = 1 --货主货品信息维护上需要扫电子监管码的才需要扫码
   and a.goodsownerid=o.goodsownerid(+)
"
"RF_INTASK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_INTASK_V"" (""INOUTID"", ""WAREHID"", ""GOODSQTY"", ""OPERATIONTYPE"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSOWNID"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""PRODLICENSENO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""LPNCODE"", ""AREANAME"", ""AREAFLAG"", ""POSID"", ""POSNO"", ""INNERSEQ"", ""SECTIONNAME"", ""GROUPID"", ""SORTTYPE"", ""TRADEPACKNAME"", ""MEMO"", ""CONTAINERID"", ""CONTAINERNO"", ""RECEIVEID"", ""INDTLID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.inoutid,
       a.warehid,
       a.goodsqty,
       op.ddlname operationtype,
       a.goodsid,
       a.ownergoodsid,
       decode(d.goodsengname,
              null,
              d.goodsname,
              d.goodsname || '(' || d.goodsengname || ')') goodsname,
       --修改RF上【大货位上架】功能中货品名称的显示，若货品主档上没有商品名，就显示通用名；若有商品名就显示通用名（商品名字）
       --xyue 2014年1月15日 09:24:54
       d.goodstype,
       d.prodarea,
       d.goodsownid,
       e.lotid,
       e.lotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              null,
              to_char(e.validdate, 'YYYY-MM-DD')) validdate,
       e.approvedocno,
       e.registno,
       e.prodlicenseno,
       f.goodsstatusid,
       f.goodsstatus,
       quan.ddlname quantitystatus,
       usef.ddlname useflag,
       h.goodspackid,
       h.packname,
       h.packsize,
       b.lpncode,
       i.areaname,
       i.areaflag,
       a.posid,
       j.posno,
       j.innerseq,
       g.sectionname,
       g.groupid,
       sortt.ddlname sorttype,
       t.packname tradepackname,
       a.memo,
       b.containerid,
       aa.containerno,
       b.receiveid,
       b.indtlid,
       a.goodsownerid,
       o.goodsownername || '(' || a.goodsownerid || ')' goodsownername
  from wms_st_io_doc       a,
       wms_receive_dtl     b,
       tpl_pub_goods       c,
       tpl_goods           d,
       wms_goods_lot       e,
       wms_goodsstatus     f,
       wms_st_section_def  g,
       wms_st_area_def     i,
       wms_pos_def         j,
       tpl_pub_goods_packs h,
       tpl_pub_goods_packs t,
       Sys_Ddl_All_v       op,
       Sys_Ddl_All_v       quan,
       Sys_Ddl_All_v       usef,
       Sys_Ddl_All_v       sortt,
       wms_container_def   aa,
       tpl_goodsowner      o
 where a.comefrom = 1
   and a.sourceid = b.receiveid
   and a.rfflag = 2
   and a.areaid = i.areaid
   and a.sectionid = g.sectionid
   and a.posid = j.posid
   and a.goodsid = c.goodsid
   and a.ownergoodsid = d.ownergoodsid
   and a.lotid = e.lotid
   and a.goodspackid = h.goodspackid
   and a.goodsstatusid = f.goodsstatusid
   and a.goodsid = t.goodsid
   and t.baseunitflag = 1
   and a.operationtype = op.ddlid(+)
   and op.keyword(+) = 'TPL_OPERATIONTYPE'
   and f.quantitystatus = quan.ddlid
   and quan.keyword = 'TPL_QUANTITYSTATUS'
   and f.useflag = usef.ddlid
   and usef.keyword = 'WMS_USEFLAG'
   and g.sorttype = sortt.ddlid
   and sortt.keyword = 'WMS_SECTION_SORTTYPE'
   and b.containerid = aa.containerid(+)
   and a.goodsownerid = o.goodsownerid(+)
"
"RF_MAN_PICKAREA_SECTION_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_MAN_PICKAREA_SECTION_V"" (""GROUPID"", ""WAREHID"", ""GROUPNAME"", ""EMPLOYEEID"", ""EMPLOYEENAME"", ""PICKAREAID"", ""PICKAREANAME"", ""SECTIONID"", ""SECTIONNAME"") AS 
  select a.groupid,
       a.warehid,
       a.groupname,
       t.employeeid,
       t.employeename,
       c.pickareaid,
       c.pickareaname,
       null sectionid,
       null sectionname
  from pub_employee       t,
       wms_group_def      a,
       wms_group_man      b,
       wms_pickarea       c
 where t.employeeid = b.employeeid
   and b.groupid = a.groupid
   and b.groupid = c.groupid(+)
   union
   select a.groupid,
       a.warehid,
       a.groupname,
       t.employeeid,
       t.employeename,
       null pickareaid,
       null pickareaname,
       c.sectionid,
       c.sectionname
  from pub_employee       t,
       wms_group_def      a,
       wms_group_man      b,
       wms_st_section_def c
 where t.employeeid = b.employeeid
   and b.groupid = a.groupid
   and b.groupid = c.groupid(+)
"
"RF_MOVEPOSIN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_MOVEPOSIN_V"" (""INOUTID"", ""WAREHID"", ""CONTAINERID"", ""GOODSQTY"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSOWNID"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""PRODLICENSENO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SOURCEID"", ""AREAID"", ""AREANAME"", ""AREAFLAG"", ""POSID"", ""POSNO"", ""INNERSEQ"", ""SECTIONNAME"", ""GROUPID"", ""SORTTYPE"", ""TRADEPACKNAME"", ""CONTAINERNO"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.inoutid,
       a.warehid,
       a.containerid,
       a.goodsqty,
       a.goodsid,
       a.ownergoodsid,
       c.goodsname,
       c.goodstype,
       c.prodarea,
       d.goodsownid,
       e.lotid,
       e.lotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              null,
              to_char(e.validdate, 'YYYY-MM-DD')) validdate,
       e.approvedocno,
       e.registno,
       e.prodlicenseno,
       f.goodsstatusid,
       f.goodsstatus,
       quan.ddlname quantitystatus,
       usef.ddlname useflag,
       h.goodspackid,
       h.packname,
       h.packsize,
       a.sourceid,
       a.areaid,
       i.areaname,
       i.areaflag,
       j.posid,
       j.posno,
       j.innerseq,
       g.sectionname,
       g.groupid,
       sortt.ddlname sorttype,
       t.packname tradepackname,
       aa.containerno,
       a.goodsownerid,
       o.goodsownername || '(' || a.goodsownerid || ')' goodsownername
  from wms_st_io_doc       a,
       wms_trade_dtl       b,
       wms_trade_order     bb,
       tpl_pub_goods       c,
       tpl_goods           d,
       wms_goods_lot       e,
       wms_goodsstatus     f,
       wms_st_section_def  g,
       wms_st_area_def     i,
       wms_pos_def         j,
       tpl_pub_goods_packs h,
       tpl_pub_goods_packs t,
       Sys_Ddl_All_v       quan,
       Sys_Ddl_All_v       usef,
       Sys_Ddl_All_v       sortt,
       wms_container_def   aa,
       tpl_goodsowner      o
 where a.comefrom = 4
   and a.inoutflag = 0
   and a.sourceid = b.tradedtlid
   and b.tradeid = bb.tradeid
   and b.usestatus = 3
   and bb.operationtype = 28
   and a.rfflag = 2
   and a.areaid = i.areaid
   and a.sectionid = g.sectionid
   and a.posid = j.posid
   and a.goodsid = c.goodsid
   and a.ownergoodsid = d.ownergoodsid
   and a.lotid = e.lotid
   and a.goodspackid = h.goodspackid
   and a.goodsstatusid = f.goodsstatusid
   and a.goodsid = t.goodsid
   and t.baseunitflag = 1
   and f.quantitystatus = quan.ddlid
   and quan.keyword = 'TPL_QUANTITYSTATUS'
   and f.useflag = usef.ddlid
   and usef.keyword = 'WMS_USEFLAG'
   and g.sorttype = sortt.ddlid
   and sortt.keyword = 'WMS_SECTION_SORTTYPE'
   AND a.containerid = aa.containerid(+)
   and a.goodsownerid = o.goodsownerid(+)
"
"RF_MOVEPOSPICK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_MOVEPOSPICK_V"" (""INOUTID"", ""WAREHID"", ""GOODSQTY"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSOWNID"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""PRODLICENSENO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SOURCEID"", ""AREAID"", ""AREANAME"", ""AREAFLAG"", ""POSID"", ""POSNO"", ""PICKSEQ"", ""SECTIONNAME"", ""GROUPID"", ""SORTTYPE"", ""TRADEPACKNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.inoutid,
       a.warehid,
       a.goodsqty,
       a.goodsid,
       a.ownergoodsid,
       c.goodsname,
       c.goodstype,
       c.prodarea,
       d.goodsownid,
       e.lotid,
       e.lotno,
       to_char(e.validdate, 'YYYY-MM-DD') validdate,
       e.approvedocno,
       e.registno,
       e.prodlicenseno,
       f.goodsstatusid,
       f.goodsstatus,
       quan.ddlname quantitystatus,
       usef.ddlname useflag,
       h.goodspackid,
       h.packname,
       h.packsize,
       a.sourceid,
       a.areaid,
       i.areaname,
       i.areaflag,
       j.posid,
       j.posno,
       l.pickseq,
       g.sectionname,
       k.groupid,
       sortt.ddlname sorttype,
       t.packname tradepackname,
       a.goodsownerid,
       o.goodsownername || '(' || a.goodsownerid || ')' goodsownername
  from wms_st_io_doc        a,
       wms_trade_dtl        b,
       wms_trade_order      bb,
       tpl_pub_goods        c,
       tpl_goods            d,
       wms_goods_lot        e,
       wms_goodsstatus      f,
       wms_st_section_def   g,
       wms_st_area_def      i,
       wms_pos_def          j,
       wms_pickarea         k,
       wms_pickarea_pos_def l,
       tpl_pub_goods_packs  h,
       tpl_pub_goods_packs  t,
       Sys_Ddl_All_v        quan,
       Sys_Ddl_All_v        usef,
       Sys_Ddl_All_v        sortt,
       tpl_goodsowner       o
 where a.comefrom = 4
   and a.inoutflag = 1
   and a.sourceid = b.tradedtlid
   and b.tradeid = bb.tradeid
   and bb.operationtype = 28
   and a.rfflag = 2
   and a.pickareaid = k.pickareaid
   and a.posid = l.posid
   and a.areaid = i.areaid
   and a.sectionid = g.sectionid
   and a.posid = j.posid
   and a.goodsid = c.goodsid
   and a.ownergoodsid = d.ownergoodsid
   and a.lotid = e.lotid
   and a.goodspackid = h.goodspackid
   and a.goodsstatusid = f.goodsstatusid
   and a.goodsid = t.goodsid
   and t.baseunitflag = 1
   and f.quantitystatus = quan.ddlid
   and quan.keyword = 'TPL_QUANTITYSTATUS'
   and f.useflag = usef.ddlid
   and usef.keyword = 'WMS_USEFLAG'
   and g.sorttype = sortt.ddlid
   and sortt.keyword = 'WMS_SECTION_SORTTYPE'
   and a.goodsownerid = o.goodsownerid(+)
"
"RF_NOORDER_RECEIVE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_NOORDER_RECEIVE_V"" (""INID"", ""INDTLID"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""APPROVEDOCNO"", ""PRODLICENSENO"", ""REGISTDOCNO"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""OPERATIONTYPENAME"", ""OPERATIONTYPE"", ""SOURCECOMPANYID"", ""SRCCOMPANYNAME"", ""OWNERGOODSID"", ""LOTID"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""TRADEGOODSPACK"", ""GOODSQTY"", ""ECODEFLAG"", ""L_PERIOD"", ""S_PERIODUNIT"", ""GOODSSTATUSID"", ""SECTIONID"", ""WHOLESECTIONID"", ""RECEIVEMEMO"") AS 
  SELECT a.receivedocid inid,
       a.receivedetailid indtlid,
       b.warehid,
       b.goodsownerid,
       b.goodsownername,
       d.approvedocno,
       d.prodlicenseno,
       d.registdocno,
       a.goodsid,
       a.goodsname,
       a.goodstype,
       a.prodarea,
       a.factname,
       c.ddlname operationtypename,
       b.operationtype,
       b.gocompanyid sourcecompanyid,
       b.companyname srccompanyname,
       a.ownergoodsid,
       a.lotid,
       a.goodspackid,
       a.goodspackname packname,
       a.packsize,
       '' tradegoodspack,
       a.goodsqty,
       d.ecodeflag,
       e.l_period,
       e.s_periodunit,
       a.goodsstatusid,
       '' sectionid,
       '' wholesectionid,
       '' receivememo
  FROM WMS_receive_detail_v a,
       WMS_receive_doc_v    b,
       sys_ddl_all_v        c,
       tpl_goods            d,
       tpl_pub_goods        e
 WHERE b.receivedocid = a.receivedocid
   AND a.ownergoodsid = d.ownergoodsid
   AND nvl(a.usestatus, 0) IN (0, 1)
   AND a.goodsid = e.goodsid
   AND b.operationtype = c.ddlid(+)
   AND c.keyword = 'TPL_OPERATIONTYPE'
   AND a.warehid = 1
"
"RF_POSQUERY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_POSQUERY_V"" (""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""POSQTY"", ""GOODSQTY"", ""TRADEGOODSQTY"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSOPCODE"", ""BARCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSOWNID"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""PRODLICENSENO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""TRADEPACKNAME"", ""POSNO"", ""SCATTERPICKRATE"", ""WHOLEPICKRATE"", ""FACTNAME"", ""GOODSENGNAME"") AS 
  select a.warehid,
       a.goodsownerid,
       owner.goodsownername,
       a.posqty,
       a.goodsqty,
       a.busiqty-nvl(a.outwaitqty,0) tradegoodsqty,
       a.goodsid,
       a.ownergoodsid,
       d.opcode GOODSOPCODE,
       d.barcode,
       d.goodsname,
       d.goodstype,
       d.prodarea,
       d.goodsownid,
       e.lotid,
       e.lotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              null,
              to_char(e.validdate, 'YYYY-MM-DD')) validdate,
       e.approvedocno,
       e.registno,
       e.prodlicenseno,
       f.goodsstatusid,
       f.goodsstatus,
       quan.ddlname quantitystatus,
       usef.ddlname useflag,
       h.goodspackid,
       h.packname,
       h.packsize,
       t.packname tradepackname,
       j.posno,
       gtr.scatterpickrate,
       gtr.wholepickrate,
       d.factname,--厂家 add by wanghuaiyu 2013年8月5日 15:54:57
       d.goodsengname--通用名 add by wanghuaiyu 2013年8月5日 15:55:23
  from wms_st_qty_lst  a,
       tpl_pub_goods   c,
       tpl_goods       d,
       wms_goods_lot   e,
       wms_goodsstatus f,
       wms_pos_def        j,
       tpl_pub_goods_packs h,
       tpl_pub_goods_packs t,
       Sys_Ddl_All_v       quan,
       Sys_Ddl_All_v       usef,
        wms_goods_feature gtr,
        tpl_goodsowner owner
where
    a.posid = j.posid
   and a.goodsid = c.goodsid
   and a.ownergoodsid = d.ownergoodsid
   and a.lotid = e.lotid
   and a.goodspackid = h.goodspackid
   and a.goodsstatusid = f.goodsstatusid
   and a.goodsid = t.goodsid and t.baseunitflag=1
   and f.quantitystatus = quan.ddlid
   and quan.keyword = 'TPL_QUANTITYSTATUS'
   and f.useflag = usef.ddlid
   and usef.keyword = 'WMS_USEFLAG'
   and a.goodsid=gtr.goodsid
   and gtr.warehid=a.warehid
   and a.goodsownerid = owner.goodsownerid
"
"RF_SCATTERPICK_INFO_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_SCATTERPICK_INFO_V"" (""AREAID"", ""AREANAME"", ""AREAFLAG"", ""POSID"", ""POSNO"", ""PICKSEQ"", ""SECTIONNAME"", ""GROUPID"", ""BOXDOCID"", ""CONTAINERNO"", ""PICKORDER"", ""COMPANYNAME"") AS 
  SELECT a.areaid,
       i.areaname,
       i.areaflag,
       j.posid,
       j.posno,
       l.pickseq,
       g.sectionname,
       k.groupid,
       a.boxdocid,
       bb.containerno,
       nvl(k.pickorder,0) pickorder,
       c.companyname
  from wms_st_io_doc   a,
       wms_turnbox_doc b,
       wms_container_def bb,
       wms_st_section_def g,
       wms_st_area_def    i,
       wms_pos_def        j,
       wms_pickarea       k,
       wms_pickarea_pos_def l,
       tpl_go_company  c
 where a.comefrom = 3 and a.inoutflag=1
   and a.boxdocid = b.boxdocid
   and b.containerid = bb.containerid(+)
   and a.rfflag=2
   and i.areaflag in (2,3)
   and a.pickareaid = k.pickareaid
   and a.posid = l.posid
   and a.areaid = i.areaid
   and a.sectionid = g.sectionid
   and a.posid = j.posid
   AND a.companyid = c.companyid
"
"RF_SCATTERPICK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_SCATTERPICK_V"" (""INOUTID"", ""WAREHID"", ""GOODSQTY"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSOWNID"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""PRODLICENSENO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SOURCEID"", ""AREAID"", ""AREANAME"", ""AREAFLAG"", ""POSID"", ""POSNO"", ""PICKSEQ"", ""SECTIONNAME"", ""GROUPID"", ""BOXDOCID"", ""CONTAINERNO"", ""OPERATIONTYPE"", ""SORTTYPE"", ""TRADEPACKNAME"", ""COMPANYNAME"", ""DBPICKFLAG"", ""FACTNAME"", ""GOODSENGNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.inoutid,
       a.warehid,
       a.goodsqty,
       a.goodsid,
       a.ownergoodsid,
       d.goodsname,
       d.goodstype,
       --修改RF散件见后功能上显示的为货主货品信息的内容 xyue 2014-08-19
       c.prodarea,
       d.goodsownid,
       e.lotid,
       e.lotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              null,
              to_char(e.validdate, 'YYYY-MM-DD')) validdate,
       e.approvedocno,
       e.registno,
       e.prodlicenseno,
       f.goodsstatusid,
       f.goodsstatus,
       quan.ddlname quantitystatus,
       usef.ddlname useflag,
       h.goodspackid,
       h.packname,
       h.packsize,
       a.sourceid,
       a.areaid,
       i.areaname,
       i.areaflag,
       j.posid,
       j.posno,
       l.pickseq,
       g.sectionname,
       k.groupid,
       a.boxdocid,
       bb.containerno,
       op.ddlname operationtype,
       sortt.ddlname sorttype,
       t.packname tradepackname,
       goc.companyname,
       d.dbpickflag,
       d.factname, --厂家 add by wanghuaiyu 2013年8月5日 15:54:57
       d.goodsengname, --通用名 add by wanghuaiyu 2013年8月5日 15:55:23
       a.goodsownerid,
       o.goodsownername
  from wms_st_io_doc        a,
       wms_turnbox_doc      b,
       wms_container_def    bb,
       tpl_pub_goods        c,
       tpl_goods            d,
       wms_goods_lot        e,
       wms_goodsstatus      f,
       wms_st_section_def   g,
       wms_st_area_def      i,
       wms_pos_def          j,
       wms_pickarea         k,
       wms_pickarea_pos_def l,
       tpl_pub_goods_packs  h,
       tpl_pub_goods_packs  t,
       Sys_Ddl_All_v        op,
       Sys_Ddl_All_v        quan,
       Sys_Ddl_All_v        usef,
       Sys_Ddl_All_v        sortt,
       tpl_go_company       goc,
       tpl_goodsowner       o
 where a.comefrom = 3
   and a.inoutflag = 1
   and a.boxdocid = b.boxdocid
   and b.containerid = bb.containerid(+)
   and a.rfflag = 2
   and i.areaflag in (2, 3)
   and a.pickareaid = k.pickareaid
   and a.posid = l.posid
   and a.areaid = i.areaid
   and a.sectionid = g.sectionid
   and a.posid = j.posid
   and a.goodsid = c.goodsid
   and a.ownergoodsid = d.ownergoodsid
   and a.lotid = e.lotid
   and a.goodspackid = h.goodspackid
   and a.goodsstatusid = f.goodsstatusid
   and a.goodsid = t.goodsid
   and t.baseunitflag = 1
   and a.operationtype = op.ddlid(+)
   and op.keyword(+) = 'TPL_OPERATIONTYPE'
   and f.quantitystatus = quan.ddlid
   and quan.keyword = 'TPL_QUANTITYSTATUS'
   and f.useflag = usef.ddlid
   and usef.keyword = 'WMS_USEFLAG'
   and g.sorttype = sortt.ddlid
   and sortt.keyword = 'WMS_SECTION_SORTTYPE'
   and b.companyid = goc.companyid(+)
   and a.goodsownerid = o.goodsownerid(+)
"
"RF_STTRADE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_STTRADE_V"" (""WAREHID"", ""GOODSOWNERID"", ""GOODSQTY"", ""POSQTY"", ""OUTWAITQTY"", ""SORTTYPE"", ""BUSIQTY"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSOPCODE"", ""BARCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSOWNID"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""PRODLICENSENO"", ""BATCHNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""TRADEPACKNAME"", ""POSID"", ""AREAID"", ""SECTIONID"", ""SECTIONNAME"", ""AREANAME"", ""POSNO"", ""GROUPID"", ""SCATTERPICKRATE"", ""WHOLEPICKRATE"", ""GOODSOWNERNAME"") AS 
  select distinct a.warehid,
                a.goodsownerid,
                a.goodsqty,
                a.posqty,
                a.outwaitqty,
                g.sorttype,
                a.busiqty,
                a.goodsid,
                a.ownergoodsid,
                c.opcode GOODSOPCODE,
                c.barcode,
                c.goodsname,
                c.goodstype,
                c.prodarea,
                d.goodsownid,
                e.lotid,
                e.lotno,
                decode(to_char(e.validdate, 'yyyy-mm-dd'),
                       '2099-01-01',
                       null,
                       to_char(e.validdate, 'YYYY-MM-DD')) validdate,
                e.approvedocno,
                e.registno,
                e.prodlicenseno,
                a.batchno,
                f.goodsstatusid,
                f.goodsstatus,
                quan.ddlname quantitystatus,
                usef.ddlname useflag,
                h.goodspackid,
                h.packname,
                h.packsize,
                t.packname tradepackname,
                a.posid,
                j.areaid,
                j.sectionid,
                g.sectionname,
                i.areaname,
                j.posno,
                y.groupid groupid,
                gtr.scatterpickrate,
                gtr.wholepickrate,
                o.goodsownername
  from wms_st_qty_lst       a,
       tpl_pub_goods        c,
       tpl_goods            d,
       wms_goods_lot        e,
       wms_goodsstatus      f,
       wms_st_section_def   g,
       wms_st_area_def      i,
       wms_pos_def          j,
       tpl_pub_goods_packs  h,
       tpl_pub_goods_packs  t,
       Sys_Ddl_All_v        quan,
       Sys_Ddl_All_v        usef,
       wms_pickarea_pos_def x,
       wms_pickarea         y,
       wms_goods_feature    gtr,
       tpl_goodsowner       o
 where a.posid = j.posid
   and j.areaid = i.areaid
   and j.sectionid = g.sectionid
   and a.goodsid = c.goodsid
   and a.ownergoodsid = d.ownergoodsid
   and a.lotid = e.lotid
   and a.goodspackid = h.goodspackid
   and a.goodsstatusid = f.goodsstatusid
   and a.goodsid = t.goodsid
   and t.baseunitflag = 1
   and f.quantitystatus = quan.ddlid
   and quan.keyword = 'TPL_QUANTITYSTATUS'
   and f.useflag = usef.ddlid
   and usef.keyword = 'WMS_USEFLAG'
   and a.posid = x.posid
   and y.pickareaid = x.pickareaid
   and a.goodsid = gtr.goodsid
   and gtr.warehid = a.warehid
   and a.goodsownerid = o.goodsownerid(+)
"
"RF_TRADEIN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_TRADEIN_V"" (""INOUTID"", ""WAREHID"", ""CONTAINERID"", ""GOODSQTY"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSOWNID"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""PRODLICENSENO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SOURCEID"", ""AREAID"", ""AREANAME"", ""AREAFLAG"", ""POSID"", ""POSNO"", ""INNERSEQ"", ""SECTIONNAME"", ""GROUPID"", ""SORTTYPE"", ""SUBTYPE"", ""WAVEID"", ""TRADEPACKNAME"", ""CONTAINERNO"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.inoutid,
       a.warehid,
       a.containerid,
       a.goodsqty,
       a.goodsid,
       a.ownergoodsid,
       c.goodsname,
       c.goodstype,
       c.prodarea,
       d.goodsownid,
       e.lotid,
       e.lotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              null,
              to_char(e.validdate, 'YYYY-MM-DD')) validdate,
       e.approvedocno,
       e.registno,
       e.prodlicenseno,
       f.goodsstatusid,
       f.goodsstatus,
       quan.ddlname quantitystatus,
       usef.ddlname useflag,
       h.goodspackid,
       h.packname,
       h.packsize,
       a.sourceid,
       a.areaid,
       i.areaname,
       i.areaflag,
       j.posid,
       j.posno,
       j.innerseq,
       g.sectionname,
       g.groupid,
       sortt.ddlname sorttype,
       bb.subtype,
       bb.sourceid waveid,
       t.packname tradepackname,
       aa.containerno,
       a.goodsownerid,
       o.goodsownername || '(' || a.goodsownerid || ')' goodsownername
  from wms_st_io_doc       a,
       wms_trade_dtl       b,
       wms_trade_order     bb,
       tpl_pub_goods       c,
       tpl_goods           d,
       wms_goods_lot       e,
       wms_goodsstatus     f,
       wms_st_section_def  g,
       wms_st_area_def     i,
       wms_pos_def         j,
       tpl_pub_goods_packs h,
       tpl_pub_goods_packs t,
       Sys_Ddl_All_v       quan,
       Sys_Ddl_All_v       usef,
       Sys_Ddl_All_v       sortt,
       wms_container_def   aa,
       tpl_goodsowner      o
 where a.comefrom = 4
   and a.inoutflag = 0
   and a.sourceid = b.tradedtlid
   and b.tradeid = bb.tradeid
   and b.usestatus = 3
   and bb.operationtype = 29
   and a.rfflag = 2
   and a.areaid = i.areaid
   and a.sectionid = g.sectionid
   and a.posid = j.posid
   and a.goodsid = c.goodsid
   and a.ownergoodsid = d.ownergoodsid
   and a.lotid = e.lotid
   and a.goodspackid = h.goodspackid
   and a.goodsstatusid = f.goodsstatusid
   and a.goodsid = t.goodsid
   and t.baseunitflag = 1
   and f.quantitystatus = quan.ddlid
   and quan.keyword = 'TPL_QUANTITYSTATUS'
   and f.useflag = usef.ddlid
   and usef.keyword = 'WMS_USEFLAG'
   and g.sorttype = sortt.ddlid
   and sortt.keyword = 'WMS_SECTION_SORTTYPE'
   AND a.containerid = aa.containerid(+)
   and a.goodsownerid = o.goodsownerid(+)
"
"RF_TRADEPICK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_TRADEPICK_V"" (""INOUTID"", ""WAREHID"", ""GOODSQTY"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSOWNID"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""PRODLICENSENO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SOURCEID"", ""AREAID"", ""AREANAME"", ""AREAFLAG"", ""POSID"", ""POSNO"", ""PICKSEQ"", ""SECTIONNAME"", ""GROUPID"", ""SORTTYPE"", ""SUBTYPE"", ""WAVEID"", ""TRADEPACKNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.inoutid,
       a.warehid,
       a.goodsqty,
       a.goodsid,
       a.ownergoodsid,
       c.goodsname,
       c.goodstype,
       c.prodarea,
       d.goodsownid,
       e.lotid,
       e.lotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              null,
              to_char(e.validdate, 'YYYY-MM-DD')) validdate,
       e.approvedocno,
       e.registno,
       e.prodlicenseno,
       f.goodsstatusid,
       f.goodsstatus,
       quan.ddlname quantitystatus,
       usef.ddlname useflag,
       h.goodspackid,
       h.packname,
       h.packsize,
       a.sourceid,
       a.areaid,
       i.areaname,
       i.areaflag,
       j.posid,
       j.posno,
       l.pickseq,
       g.sectionname,
       k.groupid,
       sortt.ddlname sorttype,
       bb.subtype,
       bb.sourceid waveid,
       t.packname tradepackname,
       a.goodsownerid,
       o.goodsownername
  from wms_st_io_doc        a,
       wms_trade_dtl        b,
       wms_trade_order      bb,
       tpl_pub_goods        c,
       tpl_goods            d,
       wms_goods_lot        e,
       wms_goodsstatus      f,
       wms_st_section_def   g,
       wms_st_area_def      i,
       wms_pos_def          j,
       wms_pickarea         k,
       wms_pickarea_pos_def l,
       tpl_pub_goods_packs  h,
       tpl_pub_goods_packs  t,
       Sys_Ddl_All_v        quan,
       Sys_Ddl_All_v        usef,
       Sys_Ddl_All_v        sortt,
       tpl_goodsowner       o
 where a.comefrom = 4
   and a.inoutflag = 1
   and a.sourceid = b.tradedtlid
   and b.tradeid = bb.tradeid
   and bb.operationtype = 29
   and a.rfflag = 2
   and a.pickareaid = k.pickareaid
   and a.posid = l.posid
   and a.areaid = i.areaid
   and a.sectionid = g.sectionid
   and a.posid = j.posid
   and a.goodsid = c.goodsid
   and a.ownergoodsid = d.ownergoodsid
   and a.lotid = e.lotid
   and a.goodspackid = h.goodspackid
   and a.goodsstatusid = f.goodsstatusid
   and a.goodsid = t.goodsid
   and t.baseunitflag = 1
   and f.quantitystatus = quan.ddlid
   and quan.keyword = 'TPL_QUANTITYSTATUS'
   and f.useflag = usef.ddlid
   and usef.keyword = 'WMS_USEFLAG'
   and g.sorttype = sortt.ddlid
   and sortt.keyword = 'WMS_SECTION_SORTTYPE'
   and a.goodsownerid = o.goodsownerid(+)
"
"RF_WHOLEPICK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_WHOLEPICK_V"" (""INOUTID"", ""WAREHID"", ""GOODSQTY"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSOWNID"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""PRODLICENSENO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SOURCEID"", ""AREAID"", ""AREANAME"", ""AREAFLAG"", ""POSID"", ""POSNO"", ""PICKSEQ"", ""SECTIONNAME"", ""GROUPID"", ""OPERATIONTYPE"", ""SORTTYPE"", ""TRADEPACKNAME"", ""ECODEFLAG"", ""DBPICKFLAG"", ""FACTNAME"", ""GOODSENGNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.inoutid,
       a.warehid,
       a.goodsqty,
       a.goodsid,
       a.ownergoodsid,
       c.goodsname,
       c.goodstype,
       c.prodarea,
       d.goodsownid,
       e.lotid,
       e.lotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              null,
              to_char(e.validdate, 'YYYY-MM-DD')) validdate,
       e.approvedocno,
       e.registno,
       e.prodlicenseno,
       f.goodsstatusid,
       f.goodsstatus,
       quan.ddlname quantitystatus,
       usef.ddlname useflag,
       h.goodspackid,
       h.packname,
       h.packsize,
       a.sourceid,
       a.areaid,
       i.areaname,
       i.areaflag,
       j.posid,
       j.posno,
       l.pickseq,
       g.sectionname,
       k.groupid,
       op.ddlname operationtype,
       sortt.ddlname sorttype,
       t.packname tradepackname,
       d.ecodeflag,
       d.dbpickflag， d.factname, --厂家 add by wanghuaiyu 2013年8月5日 15:54:57
       d.goodsengname, --通用名 add by wanghuaiyu 2013年8月5日 15:55:23
       a.goodsownerid,
       o.goodsownername
  from wms_st_io_doc        a,
       tpl_pub_goods        c,
       tpl_goods            d,
       wms_goods_lot        e,
       wms_goodsstatus      f,
       wms_st_section_def   g,
       wms_st_area_def      i,
       wms_pos_def          j,
       wms_pickarea         k,
       wms_pickarea_pos_def l,
       tpl_pub_goods_packs  h,
       tpl_pub_goods_packs  t,
       Sys_Ddl_All_v        op,
       Sys_Ddl_All_v        quan,
       Sys_Ddl_All_v        usef,
       Sys_Ddl_All_v        sortt,
       tpl_goodsowner       o
 where a.comefrom = 3
   and a.inoutflag = 1
   and a.rfflag = 2
   and (i.areaflag in (0, 1) or a.wholeoutflag = 1)
   and a.pickareaid = k.pickareaid
   and a.posid = l.posid
   and a.areaid = i.areaid
   and a.sectionid = g.sectionid
   and a.posid = j.posid
   and a.goodsid = c.goodsid
   and a.ownergoodsid = d.ownergoodsid
   and a.lotid = e.lotid
   and a.goodspackid = h.goodspackid
   and a.goodsstatusid = f.goodsstatusid
   and a.goodsid = t.goodsid
   and t.baseunitflag = 1
   and a.operationtype = op.ddlid(+)
   and op.keyword(+) = 'TPL_OPERATIONTYPE'
   and f.quantitystatus = quan.ddlid
   and quan.keyword = 'TPL_QUANTITYSTATUS'
   and f.useflag = usef.ddlid
   and usef.keyword = 'WMS_USEFLAG'
   and g.sorttype = sortt.ddlid
   and sortt.keyword = 'WMS_SECTION_SORTTYPE'
   and a.goodsownerid = o.goodsownerid(+)
"
"RF_WHOLETMPOUT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""RF_WHOLETMPOUT_V"" (""INOUTID"", ""WAREHID"", ""GOODSQTY"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSOWNID"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""PRODLICENSENO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SOURCEID"", ""AREAID"", ""AREANAME"", ""AREAFLAG"", ""POSID"", ""POSNO"", ""PICKSEQ"", ""SECTIONNAME"", ""GROUPID"", ""WHOLEOUTFLAG"", ""OPERATIONTYPE"", ""SORTTYPE"", ""TRADEPACKNAME"") AS 
  select a.inoutid,
       a.warehid,
       a.goodsqty,
       a.goodsid,
       a.ownergoodsid,
       decode(c.goodsengname,null,c.goodsname,c.goodsname||'('||c.goodsengname||')') goodsname,
       --修改RF上【大货位上架】功能中货品名称的显示，若货品主档上没有商品名，就显示通用名；若有商品名就显示通用名（商品名字）
       --xyue 2014年1月15日 09:24:54
       c.goodstype,
       c.prodarea,
       d.goodsownid,
       e.lotid,
       e.lotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              null,
              to_char(e.validdate, 'YYYY-MM-DD')) validdate,
       e.approvedocno,
       e.registno,
       e.prodlicenseno,
       f.goodsstatusid,
       f.goodsstatus,
       quan.ddlname quantitystatus,
       usef.ddlname useflag,
       h.goodspackid,
       h.packname,
       h.packsize,
       a.sourceid,
       a.areaid,
       i.areaname,
       i.areaflag,
       j.posid,
       j.posno,
       l.pickseq,
       g.sectionname,
       k.groupid,
       a.wholeoutflag,
       op.ddlname operationtype,
       sortt.ddlname sorttype,
       t.packname tradepackname
  from wms_st_io_doc   a,
       tpl_pub_goods   c,
       tpl_goods       d,
       wms_goods_lot   e,
       wms_goodsstatus f,
       wms_st_section_def g,
       wms_st_area_def    i,
       wms_pos_def        j,
       wms_pickarea       k,
       wms_pickarea_pos_def l,
       tpl_pub_goods_packs h,
       tpl_pub_goods_packs t,
       Sys_Ddl_All_v       op,
       Sys_Ddl_All_v       quan,
       Sys_Ddl_All_v       usef,
       Sys_Ddl_All_v       sortt
 where a.comefrom = 3 and a.inoutflag=1
   and a.rfflag=3
   and i.areaflag in (0,1)
   and a.pickareaid = k.pickareaid
   and a.posid = l.posid
   and a.areaid = i.areaid
   and a.sectionid = g.sectionid
   and a.posid = j.posid
   and a.goodsid = c.goodsid
   and a.ownergoodsid = d.ownergoodsid
   and a.lotid = e.lotid
   and a.goodspackid = h.goodspackid
   and a.goodsstatusid = f.goodsstatusid
   and a.goodsid = t.goodsid and t.baseunitflag=1
   AND nvl(a.downstatus,0) = 1
   and a.operationtype = op.ddlid
   and op.keyword = 'TPL_OPERATIONTYPE'
   and f.quantitystatus = quan.ddlid
   and quan.keyword = 'TPL_QUANTITYSTATUS'

   and f.useflag = usef.ddlid
   and usef.keyword = 'WMS_USEFLAG'

   and g.sorttype = sortt.ddlid
   and sortt.keyword = 'WMS_SECTION_SORTTYPE'
"
"SYS_DDL_ALL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""SYS_DDL_ALL_V"" (""KEYWORD"", ""TABLECOLUMN"", ""DDLID"", ""DDLNAME"", ""MEMO"", ""COMEFROM"") AS 
  select a.keyword,
       a.tablecolumn,
       b.ddlid,
       b.ddlname,
       a.memo,
       '系统选项字典' comefrom
  from sys_ddl a, sys_ddl_dtl b
 where a.sysid = b.sysid
union all
select a.keyword,
       a.tablecolumn,
       b.ddlid,
       b.ddlname,
       a.memo,
       '用户选项字典' comefrom
  from pub_ddl a, pub_ddl_dtl b
 where a.sysid = b.sysid
"
"SYS_DDL_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""SYS_DDL_DTL_V"" (""SYSID"", ""SYSDTLID"", ""DDLID"", ""DDLNAME"", ""BTFLAG"") AS 
  select a.sysid,
       a.sysdtlid,
       a.ddlid,
       a.ddlname,
       a.btflag -- add by xyue 2016-12-30 收货验收必填项
  from sys_ddl_dtl a
"
"SYS_DDL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""SYS_DDL_V"" (""SYSID"", ""KEYWORD"", ""TABLECOLUMN"", ""MEMO"") AS 
  select a.sysid,
       a.keyword,
       a.tablecolumn,
       a.memo
  from sys_ddl a

 "
"TAIDE_WMS2SAP_DBRK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TAIDE_WMS2SAP_DBRK_V"" (""INDTLID"", ""MATNR"", ""MENGE"", ""MEINS"", ""CHARG"", ""WERKS"", ""LGORT"", ""MBLNR"", ""ZEILE"", ""INSMK"") AS 
  select t.indtlid,
       t.matnr,--泰德物料编码
       t.menge,--数量
       t.meins,--基本单位
       t.charg,--批号(批次)
       t.werks,--收货工厂编码-泰德提供的，鹭燕是1014
       t.lgort,--收货库存地点-泰德系统存放货位，泰德提供的，鹭燕合格货位是1001
       t.mblnr,--泰德调拨出库单号-erp总单ID
       t.zeile,--泰德调拨出库单行号-erp细单ID
       t.insmk--质量状态-默认1
  from taide_wms2sap_dbrk t, wms_in_order a
 where t.usestatus = 1
   and nvl(t.execflag, 0) = 0 --未反馈
   and t.inid = a.inid
   and a.usestatus = 3 --物流入库订单总单状态【完成】
"
"TAIDE_WMS2SAP_KCZY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TAIDE_WMS2SAP_KCZY_V"" (""TRADEDTLID"", ""MATNR"", ""MENGE"", ""MEINS"", ""CHARG"", ""WERKS_F"", ""LGORT_F"", ""WERKS_S"", ""LGORT_S"") AS 
  select t.tradedtlid,
       t.matnr,
       t.menge,
       t.meins,
       t.charg,
       t.werks_f,
       t.lgort_f,
       t.werks_s,
       t.lgort_s
  from taide_wms2sap_kczy t
 where t.usestatus = 1
   and nvl(t.execflag, 0) = 0
"
"TAIDE_WMS2SAP_SHTXD_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TAIDE_WMS2SAP_SHTXD_DOC_V"" (""标志"", ""物流出库订单ID"", ""随货同行号"", ""创建日期"", ""出库类别"", ""收货单位"", ""到货日期"", ""出库发货日期"", ""合计数量"", ""合计金额"", ""合计折扣额"", ""合计折后金额"", ""供货单位"", ""生产厂商"", ""收货地址"", ""收货人"", ""电话"", ""客户ID"", ""ERP总单ID"") AS 
  select distinct decode(nvl(t.printflag,0),1,'已打印','未打印') as 标志,
       OUTID as 物流出库订单ID,
       WAVEDTLID as 随货同行号,
       to_char(t.execdate,'yyyy-mm-dd hh24:mi:ss') as 创建日期,
       VTEXT as 出库类别,
       NAME1 as 收货单位,
       substr(t.bldat, 0, 4)||'-'||substr(t.bldat, 5, 2)||'-'||substr(t.bldat, -2) as 到货日期,
       substr(t.ERDAT, 0, 4)||'-'||substr(t.ERDAT, 5, 2)||'-'||substr(t.ERDAT, -2) as 出库发货日期,
       ZHJSL as 合计数量,
       ZHJJE as 合计金额,
       ZHJZKE as 合计折扣额,
       ZHJZHJE as 合计折后金额,
       ZGHDW as 供货单位,
       ZSCCS as 生产厂商,
       STREET as 收货地址,
       KUNNRREC as 收货人,
       TEL_NUMBER as 电话,
       KUNNRCUS as 客户ID,
       ERPDOCID as ERP总单ID
  from taide_wms2sap_shtxd t order by to_char(t.execdate,'yyyy-mm-dd hh24:mi:ss'),t.name1 desc
"
"TAIDE_WMS2SAP_SHTXD_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TAIDE_WMS2SAP_SHTXD_DTL_V"" (""物流出库订单ID"", ""物流出库细单ID"", ""打印时间"", ""出库单号"", ""货品ID"", ""工厂编码"", ""剂型"", ""通用名称"", ""商品/商标名"", ""包装规格"", ""规格"", ""批号"", ""生产日期"", ""有效期至"", ""单位"", ""数量"", ""单价"", ""金额"", ""折扣额"", ""折后金额"", ""分包单位"", ""ERP总单ID"") AS 
  select OUTID as 物流出库订单ID,
       OUTDTLID as 物流出库细单ID,
       printdate as 打印时间,
       VBELN as 出库单号,
       MATNR as 货品ID,
       WERKS as 工厂编码,
       WGBEZ as 剂型,
       MAKTXCUR as 通用名称,
       MAKTX as ""商品/商标名"",
       GROES as 包装规格,
       WRKST as 规格,
       CHARG as 批号,
       decode(t.hsdat,
              '00000000',
              null,
              to_char(to_date(t.hsdat, 'yyyymmdd'), 'yyyy-mm-dd')) as 生产日期,
       (case
         when length(t.mbdat) = 6 then
          decode(t.mbdat,
                 '000000',
                 null,
                 substr(t.mbdat, 0, 4) || '-' || substr(t.mbdat, -2))
         else
          decode(t.mbdat,
                 '00000000',
                 null,
                 to_char(to_date(t.mbdat, 'yyyymmdd'), 'yyyy-mm-dd'))
       end) as 有效期至,
       MSEHL as 单位,
       LFIMG as 数量,
       ZDJ as 单价,
       ZJE as 金额,
       ZZKE as 折扣额,
       ZZHJE as 折后金额,
       ZFBDW as 分包单位,
       ERPDOCID as ERP总单ID
  from taide_wms2sap_shtxd t
"
"TAIDE_WMS2SAP_SHTXD_PRINT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TAIDE_WMS2SAP_SHTXD_PRINT_V"" (""OUTID"", ""OUTDTLID"", ""WAVEDTLID"", ""VTEXT"", ""NAME1"", ""BLDAT_YEAR"", ""BLDAT_MONTH"", ""BLDAT_DAY"", ""ERDAT_YEAR"", ""ERDAT_MONTH"", ""ERDAT_DAY"", ""ZFBDW"", ""ZHJSL"", ""ZHJJE"", ""ZHJZKE"", ""ZHJZHJE"", ""ZGHDW"", ""ZSCCS"", ""STREET"", ""KUNNRREC"", ""TEL_NUMBER"", ""KUNNRCUS"", ""VBELN"", ""MATNR"", ""WERKS"", ""WGBEZ"", ""MAKTXCUR"", ""MAKTX"", ""GROES"", ""WRKST"", ""CHARG"", ""HSDAT"", ""MBDAT"", ""MSEHL"", ""LFIMG"", ""ZDJ"", ""ZJE"", ""ZZKE"", ""ZZHJE"", ""ZSFDY"", ""ERPDOCID"", ""ERPDTLID"", ""MARANORMT"", ""MAH"") AS 
  select OUTID,
       OUTDTLID,
       WAVEDTLID,
       VTEXT,
       NAME1,
       substr(t.bldat, 0, 4) bldat_year,
       substr(t.bldat, 5, 2) bldat_month,
       substr(t.bldat, -2) bldat_day,
       substr(t.ERDAT, 0, 4) ERDAT_year,
       substr(t.ERDAT, 5, 2) ERDAT_month,
       substr(t.ERDAT, -2) ERDAT_day,
       ZFBDW,
       ZHJSL,
       ZHJJE,
       ZHJZKE,
       ZHJZHJE,
       ZGHDW,
       ZSCCS,
       STREET,
       KUNNRREC,
       TEL_NUMBER,
       KUNNRCUS,
       VBELN,
       MATNR,
       WERKS,
       WGBEZ,
       MAKTXCUR,
       MAKTX,
       GROES,
       WRKST,
       CHARG,
       decode(t.hsdat,
              '00000000',
              null,
              to_char(to_date(t.hsdat, 'yyyymmdd'), 'yyyy-mm-dd')) HSDAT,
       (case
         when length(t.mbdat) = 6 then
          decode(t.mbdat,
                 '000000',
                 null,
                 substr(t.mbdat, 0, 4) || '-' || substr(t.mbdat, -2))
         else
          decode(t.mbdat,
                 '00000000',
                 null,
                 to_char(to_date(t.mbdat, 'yyyymmdd'), 'yyyy-mm-dd'))
       end) MBDAT,
       MSEHL,
       LFIMG,
       ZDJ,
       ZJE,
       ZZKE,
       ZZHJE,
       ZSFDY,
       ERPDOCID,
       t.erpdocid || '' || replace(t.erpdtlid, t.erpdocid, null) ERPDTLID,
       t.normt as MARANORMT,
       (select x.mah from tpl_goods x where x.goodsownerid=9113 and x.goodsownid=t.matnr) as mah
       --decode(t.MATNR,'30000043','MIKASA SEIYAKU CO.,LTD',ZSCCS) MAH
  from TAIDE_WMS2SAP_SHTXD t
"
"TAIDE_WMS2SAP_SHTXD_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TAIDE_WMS2SAP_SHTXD_V"" (""OUTID"", ""ERPDOCID"") AS 
  select distinct t.outid,t.erpdocid
  from taide_wms2sap_shtxd t
 where t.usestatus = 1
   and nvl(t.execflag, 0) = 0--未反馈
"
"TMP_IP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMP_IP_V"" (""IPID"", ""DRIVERMANAGER"", ""USERID"", ""PASSWORD"", ""USESTATUS"", ""WAREHID"") AS 
  select
  ipid,
  drivermanager,
  userid,
  password,
  usestatus,
  warehid
  from tmp_ip
"
"TMS_AREA_CODE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_AREA_CODE_V"" (""AREACODE"", ""AREANAME"", ""AREAID"", ""CREDATE"", ""CREMANID"", ""CREMANOPCODE"", ""CREMANNAME"") AS 
  SELECT a.areacode,
       a.areaname,
       a.areaid,
       a.credate,
       a.cremanid,
       b.opcode cremanopcode,
       b.employeename cremanname
  FROM tms_area_code a,
       pub_employee b
 WHERE a.cremanid = b.employeeid(+)
"
"TMS_DELIVERY_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_DELIVERY_DOC_V"" (""DELIVERYID"", ""DELIVERYNO"", ""DELIVERYPACKS"", ""GOODSOWNERID"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""SUPPLYERNAME"", ""DRIVERID"", ""DRIVEROPCODE"", ""DRIVERNAME"", ""OWNERGOODSID"", ""GOODSNAME"", ""OPCODE"", ""GOODSTYPE"", ""FACTNAME"", ""PRODAREA"", ""HANDOVERDATE"", ""HANDOVERMANID"", ""HANDOPCODE"", ""HANDOVERMANNAME"", ""CONFIRMDATE"", ""CONFIRMMANID"", ""CONFIRMOPCODE"", ""CONFIRMMANNAME"", ""PRINTMANID"", ""PRINTMANNAME"", ""PRINTDATE"", ""PRINTFLAG"", ""INPUTMANID"", ""INPUTMANNAME"", ""CREDATE"", ""USESTATUS"", ""WAREHID"", ""WAREHNAME"", ""MEMO"") AS 
  (
select deliveryid,
       deliveryno,
       deliverypacks,
       a.goodsownerid,
       b.goopcode goopcode,
       b.goodsownername,
       a.supplyername,
       a.driverid,
       c.opcode driveropcode,
       c.drivername,
       a.ownergoodsid,
       d.goodsname,
       d.opcode,
       d.goodstype,
       d.factname,
       d.prodarea,
       handoverdate,
       handovermanid,
       e.connopcode handopcode,
       e.connname  handovermanname,
       confirmdate,
       confirmmanid,
       f.opcode  confirmopcode,
       f.employeename confirmmanname,
       printmanid,
       g.employeename printmanname,
       printdate,
       --decode(printflag,null,null,1) printflag,
       nvl(printflag,0) printflag,--modify by weitangjing 20131030
       a.deliveryid inputmanid,
       h.employeename inputmanname,
       a.credate,
       a.usestatus,
       a.warehid,
       i.warehname ,
       a.memo
  from tms_delivery_doc a,
       tpl_goodsowner b,
       tms_driver c,
       tpl_goods d,
       tpl_go_connector e,
       pub_employee f,
       pub_employee g,
       pub_employee h,
       tpl_warehouse i
       where a.goodsownerid = b.goodsownerid(+)
       and   a.driverid = c.driverid(+)
       and a.ownergoodsid = d.ownergoodsid(+)
       and a.handovermanid = e.connid(+)
       and a.confirmmanid = f.employeeid(+)
       and a.printmanid = g.employeeid(+)
       and a.inputmanid = h.employeeid(+)
       and a.warehid = i.warehid(+)
  )
"
"TMS_DISPATCH_COST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_DISPATCH_COST_V"" (""COSTID"", ""DISPATCHID"", ""WAREHID"", ""INPUTMANID"", ""EMPLOYEENAME"", ""CREDATE"", ""ITEMID"", ""CNT"", ""UNITTYPE"", ""FEERATIO"", ""COST"", ""TASKTYPE"", ""TRANSREGIONID"", ""REGIONNAME"", ""TRANSMODEID"", ""TRANSNAME"", ""TRANSMODE"", ""MEMO"") AS 
  select a.COSTID,
       a.DISPATCHID,
       a.WAREHID,
       a.INPUTMANID,
       d.employeename,
       a.CREDATE,
       a.ITEMID,
       a.CNT,
       a.UNITTYPE,
       a.FEERATIO,
       a.COST,
       a.tasktype,
       a.transregionid,
       c.regionname,
       a.transmodeid,
       b.transname,
       b.transmode,
       a.MEMO
  from Tms_dispatch_cost   a,
       pub_employee        d,
       WMS_TRANSPORT_MODE  b,
       TPRICE_TRANS_REGION c
 where a.inputmanid = d.employeeid(+)
   and a.transmodeid = b.transmodeid(+)
   and a.transregionid = c.regionid(+)

 "
"TMS_DISPATCH_DOC_TMS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_DISPATCH_DOC_TMS_V"" (""DISPATCHID"", ""WAREHID"", ""WAREHNAME"", ""CREDATE"", ""REALDISPATCHDATE"", ""INPUTMANID"", ""INPUTMAN"", ""DISPATCHMANID"", ""DISPATCHMAN"", ""VEHICLEID"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVERNAME2"", ""USESTATUS"", ""USESTATUSNAME"", ""CHAINFLAG"", ""GPSNO"", ""SIMNO"") AS 
  select t.dispatchid,
       t.warehid,
       t.warehname,
       t.credate,
       t.realdispatchdate,
       t.inputmanid,
       t.inputman,
       t.dispatchmanid,
       t.dispatchman,
       t.vehicleid,
       t.vehicleno,
       t.driverid,
       t.drivername,
       t.driver2id,
       t.drivername2,
       t.usestatus,
       s.ddlname usestatusname,
       t.chainflag,
       t.gpsno,
       t.simno
  from tms_dispatch_doc_v t,sys_ddl_dtl s
  where s.sysid=423 --用户选项字典WMS_DISPATCH_STATUS
  and   t.usestatus=s.ddlid(+)
"
"TMS_DISPATCH_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_DISPATCH_DOC_V"" (""DISPATCHID"", ""WAREHID"", ""WAREHNAME"", ""CREDATE"", ""INPUTMANID"", ""INPUTMAN"", ""DISPATCHDATE"", ""DISPATCHMANID"", ""DISPATCHMAN"", ""SELFTRANSTYPE"", ""TRCOMPANYID"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""RETURNDATE"", ""PREDISTANCE"", ""REALDISTANCE"", ""PREGAS"", ""REALGAS"", ""VEHICLEID"", ""VEHICLENO"", ""TERRACEID"", ""TERRACENO"", ""VEHICLEMODEL"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVERNAME2"", ""ROUTEID"", ""ROUTENAME"", ""INTOWNFLAG"", ""FEEFLAG"", ""TOTALPACKS"", ""TOTALWEIGHT"", ""TOTALCUBAGE"", ""TOTALPACKS2"", ""TOTALWEIGHT2"", ""TOTALCUBAGE2"", ""UPDOWNMAN"", ""UPDOWNDATE"", ""TRANSMODEL"", ""USESTATUS"", ""BACKDESCR"", ""CHANGCARMANID"", ""CHANGCARMAN"", ""CHANGCARDATE"", ""TRANSCLASS"", ""COMEFROM"", ""ZONEID"", ""ZONENO"", ""ZONENAME"", ""REALDISPATCHDATE"", ""CONFIRMMANID"", ""CONFIRMMANNAME"", ""CONFIRMDATE"", ""MEMO"", ""CHAINFLAG"", ""PRINTFLAG"", ""PRINTDATE"", ""PRINTMANID"", ""PRINTMAN"", ""CHAINPRINTFLAG"", ""CHAINPRINTDATE"", ""LQSPRINTFLAG"", ""LQSPRINTDATE"", ""TGPRINTFLAG"", ""TGPRINTDATE"", ""PCDPRINTFLAG"", ""PCDPRINTDATE"", ""FFZJPRINTFLAG"", ""FFZJPRINTDATE"", ""SPECIALCARFLAG"", ""GPSNO"", ""SIMNO"", ""DTPRINTFLAG"", ""DTPRINTDATE"", ""UPDOWNMANID"") AS 
  select a.dispatchid,
       a.warehid,
       b.warehname,
       a.credate,
       a.inputmanid,
       c.employeename inputman,
       a.dispatchdate,
       a.dispatchmanid,
       d.employeename dispatchman,
       a.selftranstype,
       a.trcompanyid,
       e.companyopcode,
       e.companyname,
       a.returndate,
       a.predistance,
       a.realdistance,
       a.pregas,
       a.realgas,
       a.vehicleid,
       f.vehicleno,
       a.terraceid,
       g.terraceno,
       g.vehiclemodel,
       a.driverid,
       h.drivername,
       a.driver2id,
       i.drivername drivername2,
       a.routeid,
       j.routename,
       j.intownflag,
       a.feeflag,
       a.totalpacks,
       a.totalweight,
       a.totalcubage,
       a.totalpacks2,
       a.totalweight2,
       a.totalcubage2,
       a.updownman,
       a.updowndate,
       a.transmodel,
       a.usestatus,
       a.backdescr,
       a.changcarmanid,
       h.employeename changcarman,
       a.changcardate,
       a.transclass,
       a.comefrom,
       a.zoneid,
       k.zoneno,
       k.zonename,
       a.realdispatchdate,
       a.confirmmanid,
       l.employeename confirmmanname,
       a.confirmdate,
       a.memo,
       a.chainflag,--add by weitangjing 20130923 冷链标志
       a.printflag,
       a.printdate,
       a.printmanid,
       m.employeename printman,
       a.chainprintflag,
       a.chainprintdate,
       a.lqsprintflag,
       a.lqsprintdate,
       a.tgprintflag,
       a.tgprintdate,
       a.pcdprintflag, --add by xyue 2016-07-27 派车单打印标志
       a.pcdprintdate,  --add by xyue 2016-07-27 派车单打印时间
       a.ffzjprintflag,--add by xyue 2016-09-28 含复方制剂打印标志
       a.ffzjprintdate, --add by xyue 2016-09-28 含复方制剂打印标志
       nvl(a.specialcarflag,0)  specialcarflag,  --  add by tl 20170731  中宏专车标志
       f.gpsno,--add by xyue 2017-12-25 IMEI
       f.simno,--add by xyue 2017-12-25 SIMNO
       a.dtprintflag,--add by xyue 2018-08-30 含蛋肽打印标志
       a.dtprintdate ,--add by xyue 2018-08-30 含蛋肽打印标志
       a.updownmanid  --装卸工ID  by tl20181119
  from tms_dispatch_doc a,
       tpl_warehouse    b,
       pub_employee     c,
       pub_employee     d,
       tpl_pub_company  e,
       tms_vehicle      f,
       tms_terrace      g,
       tms_driver       h,
       tms_driver       i,
       wms_tr_route     j,
       pub_employee     h,
       wms_ship_zone    k,
       pub_employee     l,
       pub_employee     m
 where a.warehid = b.warehid
   and a.inputmanid = c.employeeid(+)
   and a.dispatchmanid = d.employeeid(+)
   and a.trcompanyid = e.companyid(+)
   and a.vehicleid = f.vehicleid(+)
   and a.terraceid = g.terraceid(+)
   and a.driverid = h.driverid(+)
   and a.driver2id = i.driverid(+)
   and a.routeid = j.routeid(+)
   and a.changcarmanid = h.employeeid(+)
   and a.zoneid = k.zoneid(+)
   and a.confirmmanid = l.employeeid(+)
   and a.printmanid = m.employeeid(+)
"
"TMS_DISPATCH_DOC_XM_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_DISPATCH_DOC_XM_V"" (""DISPATCHID"", ""DISPATCHTYPE"", ""DISPATCHDATE"", ""VEHICLEID"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"") AS 
  select a.dispatchid,
       1 dispatchtype, --WMS派车
       a.realdispatchdate dispatchdate,
       a.vehicleid,
       b.vehicleno,
       a.driverid,
       c.drivername,
       a.driver2id,
       d.drivername driver2name
  from tms_dispatch_doc a, tms_vehicle b, tms_driver c, tms_driver d
 where a.warehid = 1
   and a.vehicleid = b.vehicleid(+)
   and a.driverid = c.driverid(+)
   and a.driver2id = d.driverid(+)
 union all
select t.dispatchid,
       2 dispatchtype, --TMS派车
       t.credate dispatchdate,
       t.vehicleid,
       t1.vehicleno,
       t.driverid,
       t2.drivername,
       t.driver2id,
       t3.drivername driver2name
  from tms_luyan_dispatch_doc t,
       tms_vehicle            t1,
       tms_driver             t2,
       tms_driver             t3
 where t.warehid = 1
   and t.vehicleid = t1.vehicleid(+)
   and t.driverid = t2.driverid(+)
   and t.driver2id = t3.driverid(+)
"
"TMS_DISPATCH_DTL_TMS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_DISPATCH_DTL_TMS_V"" (""DISPATCHID"", ""DISPATCHDTLID"", ""TRID"", ""CREDATE"", ""COMPANYID"", ""COMPANYNAME"", ""WAVEDTLID"", ""PRINTFLAG"", ""USESTATUS"", ""USESTATUSNAME"", ""TRANSID"", ""INCEPTADDR"", ""OPERATIONTYPE"", ""OPERATIONTYPENAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""WAREHID"", ""WAREHNAME"", ""POINAME"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""TOWNSHIP"", ""LONGITUDE"", ""LATITUDE"", ""CONNECTOR"", ""CONNPHONE"", ""ROUTENAME"", ""CHAINFLAG"", ""URGENTFLAG"", ""WHOLEPACKS"", ""SCATTERPACKS"", ""TOTALPACKS"", ""CANFIXQTY"", ""VOLUME"", ""WEIGHT"", ""SIGNFLAG"", ""SIGNDATE"", ""TASKTYPE"") AS 
  select d.dispatchid,
       d.dispatchdtlid,
       t.trid,--任务单ID
       t.CREDATE ,--填单日期
       t.companyid,--单位ID
       t.companyname,--单位名称
       t.sourceid wavedtlid,--随货同行号
       decode(t.printflag,null,0,1) printflag,--随货同行打印标志
       t.USESTATUS,--状态ID
       s.ddlname USESTATUSname,--状态中文名称
       t.TRANSID,--运输地点ID
       t.inceptaddr,--WMS内部维护的运输地点
       t.OPERATIONTYPE,--业务类型ID
       s1.ddlname operationtypename,--业务类型中文名称
       t.GOODSOWNERID,--货主ID
       t.goodsownername,--货主名称
       t.WAREHID,--物流中心ID
       t.warehname,--物流中心
       t.poiname,--POI地址
       t.province,--省
       t.city,--市
       t.district,--区县
       t.township,--乡镇街道
       t.longitude,--经度
       t.latitude,--纬度
       t.connector,--联系人
       t.connphone,--联系电话
       t.routename,--线路名称
       t.chainflag,--冷链标志
       t.URGENTFLAG,--加急标志
       t.WHOLEPACKS,--整件件数
       t.SCATTERPACKS,--散件件数
       t.TOTALPACKS,--总件数
       t.canfixqty,--可派车数量
       t.VOLUME,--体积
       t.WEIGHT,--重量
       nvl(t.signflag,0) signflag,
       t.signdate,
       '送货' tasktype
  from tms_dispatch_dtl d,tms_tr_doc_v t,sys_ddl_dtl s ,sys_ddl_dtl s1
 where s.sysid=453 --系统选项字典WMS_TRDOC_STATUS
 and   t.USESTATUS=s.ddlid(+)
 and   s1.sysid=389 --系统选项字典TPL_OPERATIONTYPE
 and   t.OPERATIONTYPE=s1.ddlid(+)
 and   d.trid=t.trid(+)
"
"TMS_DISPATCH_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_DISPATCH_DTL_V"" (""DISPATCHID"", ""DISPATCHDTLID"", ""TASKTYPE"", ""TRID"", ""TRNO"", ""GCOMPANYID"", ""COMPANYID"", ""OPERATIONTYPE"", ""COMPANYNAME"", ""TRANSID"", ""ROUTEID"", ""ROUTENAME"", ""INCEPTADDR"", ""CONNECTOR"", ""CONNPHONE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""BACTERINFLAG"", ""SCATTERPACKS"", ""WHOLEPACKS"", ""WEIGHT"", ""CUBAGE"", ""BACKMAN"", ""BACKTIME"", ""BACKDESCR"", ""STEVEDORE"", ""USESTATUS"", ""FIXQTY"", ""MEMO"", ""EMPLOYEENAMES"", ""TOTALPACKS"", ""INPUTMANID"", ""INPUTMANNAME"", ""CREDATE"", ""BACKQTY"", ""RECEIVEMONEY"", ""CANFIXQTY"", ""SIGNFLAG"", ""SOURCEID"", ""CHAINFLAG"", ""FILEGROUPID"", ""WAYBILLNO"", ""CHAINHZFLAG"", ""FFZJHZFLAG"", ""SENDPOS"", ""CHAINUSESTATUS"", ""TMSSIGNFLAG"", ""SIGNDATE"", ""COMEFROM"", ""INNERFLAG"") AS 
  select distinct a.dispatchid,
       a.dispatchdtlid,
       a.tasktype,
       a.trid,
       b.trno,
       b.gcompanyid,
       b.companyid, --xyue 2014-06-02 增加货主单位ID
       b.operationtype,
       b.companyname,
       b.transid,  --tl 20170801 增加运输地点ID
       b.routeid,  --tl 20170919 取运输任务单上的线路ID
       b.routename,
       b.inceptaddr,
       b.connector,
       b.connphone,
       b.goodsownerid,
       b.goodsownername,
       b.bacterinflag, -- tl@200225 疫苗货主标志
       decode(b.comefrom,1,zx_get_boxno(b.sourceid),nvl(b.scatterpacks,0)) scatterpacks,
       decode(b.comefrom,1,zx_get_wholeqty(b.sourceid),nvl(b.wholepacks,0)) wholepacks,
       a.weight,
       a.cubage,
       a.backman,
       a.backtime,
       a.backdescr,
       a.stevedore,
       a.usestatus,
       a.fixqty,
       a.memo,
       a.employeenames,
       decode(b.comefrom,1,zx_get_boxno(b.sourceid)+zx_get_wholeqty(b.sourceid),nvl(b.totalpacks,0)) totalpacks,
       a.inputmanid,
       c.employeename inputmanname,
       a.credate,
       a.backqty,--退货件数
       a.receivemoney,
       b.canfixqty,
       a.signflag,--add by wanghuaiyu 20130708
       decode(b.sourcetable,1,b.sourceid,b.sourceid) sourceid,--by ydhu 2011-09-02
       nvl(a.chainflag,0) chainflag,--add by weitangjing 20130923 冷链标志
       a.filegroupid,--add by weitangjing 20130923 附件
       a.waybillno,--add by weitangjing 20131016 运单号
       a.chainhzflag,
       a.ffzjhzflag,
       b.sendpos, --add by xyue 送货地点
       nvl(a.chainusestatus,0)  chainusestatus,   --add by tl 20171229 冷链回执状态
       nvl(b.signflag,0) tmssignflag, --add by xyue 2018-01-24 签收状态 TMS使用
       b.signdate, --add by xyue 2018-01-24 签收时间 TMS使用
       b.comefrom,
       (select x.innerflag from tpl_goodsowner x where x.goodsownerid=b.GOODSOWNERID) innerflag
      /* b.zyflag,
       b.qxflag -- tl@200319 中药,器械标志*/
  from tms_dispatch_dtl a, tms_tr_doc_v b,pub_employee c
 where a.trid = b.trid(+)
 and a.inputmanid=c.employeeid(+)
"
"TMS_DISPATCH_IN_TRANSIT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_DISPATCH_IN_TRANSIT_V"" (""WAREHID"", ""WAREHNAME"", ""LSTID"", ""DISPATCHID"", ""VEHICLEID"", ""VEHICLENO"", ""TRDOCID"", ""TRNO"", ""TRCOMPANYID"", ""CREDATE"", ""INPUTMANID"", ""EMPLOYEENAME"", ""MSGTYPE"", ""MSG"") AS 
  select a.warehid,
       b.warehname,
       a.lstid,
       a.dispatchid,
       a.vehicleid,
       c.vehicleno,
       a.trdocid,
       d.trno,
       d.trcompanyid,
       a.credate,
       a.inputmanid,
       f.employeename,
       a.msgtype,
       a.msg
  from tms_dispatch_in_transit a,
  tpl_warehouse                b,
  tms_vehicle                  c,
  tms_tr_doc                   d,
  pub_employee                 f
  where a.warehid = b.warehid
  and a.vehicleid = c.vehicleid(+)
  and a.trdocid = d.trid(+)
  and a.inputmanid = f.employeeid(+)
"
"TMS_DRIVER_DELIVERY_QUERY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_DRIVER_DELIVERY_QUERY_V"" (""DRIVERID"", ""DRIVERNAME"", ""CNT"", ""TOTALPACKS"", ""WAREHID"", ""WAREHNAME"") AS 
  select
       driverid,
       drivername,
       count(deliveryid) cnt,
       sum(deliverypacks) totalpacks,
       warehid,
       warehname
       from tms_delivery_doc_v
 where usestatus = 1
 group by driverid, warehid, drivername, warehname
"
"TMS_DRIVER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_DRIVER_V"" (""WAREHID"", ""WAREHNAME"", ""DRIVERID"", ""DRIVERNAME"", ""OPCODE"", ""TRCOMPANYID"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""BIRTHDAY"", ""IDCARDNO"", ""LICENSENO"", ""LICENSETYPE"", ""GETDATE"", ""LASTCHECKDATE"", ""EMP_TYPE"", ""EMAIL"", ""MARRIAGE"", ""MOBILE"", ""ADDRESS"", ""USESTATUS"", ""MEMO"") AS 
  SELECT A.WAREHID,
       B.WAREHNAME,
       A.DRIVERID,
       A.DRIVERNAME,
       A.OPCODE,
       A.TRCOMPANYID,
       C.COMPANYOPCODE,
       C.COMPANYNAME,
       A.BIRTHDAY,
       A.IDCARDNO,
       A.LICENSENO,
       A.LICENSETYPE,
       A.GETDATE,
       A.LASTCHECKDATE,
       A.EMP_TYPE,
       A.EMAIL,
       A.MARRIAGE,
       A.MOBILE,
       A.ADDRESS,
       A.USESTATUS,
       A.MEMO
  FROM TMS_DRIVER A, TPL_WAREHOUSE B, TPL_PUB_COMPANY C
 WHERE A.WAREHID = B.WAREHID
   AND A.TRCOMPANYID = C.COMPANYID(+)

 "
"TMS_LUYAN_ADDRESS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_ADDRESS_V"" (""TRANSID"", ""WAREHID"", ""WAREHNAME"", ""SENDPOS"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""TOWNSHIP"", ""POINAME"", ""LONGITUDE"", ""LATITUDE"", ""MEMO"", ""CONNECTOR"", ""CONNPHONE"", ""INPUTMANID"", ""INPUTMANNAME"", ""CREDATE"", ""ADDRESS"") AS 
  select t.transid,
       t.warehid,
       tt.warehname,
       t.sendpos,
       t.province,
       t.city,
       t.district,
       t.township,
       t.poiname,
       t.longitude,
       t.latitude,
       t.memo,
       t.connector,
       t.connphone,
       t.inputmanid,
       a.employeename inputmanname,
       t.credate,
       t.address
  from tms_luyan_address t,tpl_warehouse tt,pub_employee a
  where t.warehid=tt.warehid(+)
  and   t.inputmanid=a.employeeid(+)
"
"TMS_LUYAN_DISPATCH_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_DISPATCH_DOC_V"" (""DISPATCHID"", ""WAREHID"", ""WAREHNAME"", ""CREDATE"", ""DISPATCHDATE"", ""INPUTMANID"", ""INPUTMAN"", ""VEHICLEID"", ""VEHICLENO"", ""GPSNO"", ""SIMNO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""PRINTFLAG"", ""MEMO"", ""UPDOWNMANID"", ""UPDOWNMAN"", ""PRINTDATE"", ""PRINTMANID"", ""PRINTMAN"", ""CHAINPRINTFLAG"", ""CHAINPRINTDATE"", ""LQSPRINTFLAG"", ""LQSPRINTDATE"", ""TGPRINTFLAG"", ""TGPRINTDATE"", ""FFZJPRINTFLAG"", ""FFZJPRINTDATE"", ""DTPRINTFLAG"", ""DTPRINTDATE"", ""YMPRINTFLAG"", ""YMPRINTDATE"", ""DYFYDFLAG"", ""DYFYDDATE"") AS 
  select t.dispatchid,
       t.warehid,
       a.warehname,
       t.credate,
       t.dispatchdate,
       t.inputmanid,
       b.employeename inputman,
       t.vehicleid,
       e.vehicleno,
       e.gpsno,
       e.simno,
       t.driverid,
       c.drivername,
       t.driver2id,
       d.drivername driver2name,
       t.printflag,
       t.memo,
       t.updownmanid,
       tms_luyan_getupdownman(t.warehid,t.updownmanid) updownman,
       t.printdate,
       t.printmanid,
       f.employeename printman,
       t.chainprintflag,
       t.chainprintdate,
       t.lqsprintflag,
       t.lqsprintdate,
       t.tgprintflag,
       t.tgprintdate,
       t.ffzjprintflag,
       t.ffzjprintdate,
       t.dtprintflag,
       t.dtprintdate,
       t.ymprintflag,
       t.ymprintdate,
       t.dyfydflag,
       t.dyfyddate
  from TMS_luyan_DISPATCH_DOC t,
       tpl_warehouse          a,
       pub_employee           b,
       tms_driver             c,
       tms_driver             d,
       tms_luyan_vehicle_v    e,
       pub_employee           f
 where t.warehid = a.warehid(+)
   and t.inputmanid = b.employeeid(+)
   and t.vehicleid = e.vehicleid(+)
   and t.driverid = c.driverid(+)
   and t.driver2id = d.driverid(+)
   and t.printmanid = f.employeeid(+)
   and nvl(t.usestatus,1)<>0
   and t.credate > to_date('2020-11-01', 'yyyy-mm-dd')

   union all

select t.dispatchid,
       t.warehid,
       a.warehname,
       t.credate,
       t.dispatchdate,
       t.inputmanid,
       b.employeename inputman,
       t.vehicleid,
       e.vehicleno,
       e.gpsno,
       e.simno,
       t.driverid,
       c.drivername,
       t.driver2id,
       d.drivername driver2name,
       t.printflag,
       t.memo,
       t.updownmanid,
       tms_luyan_getupdownman(t.warehid,t.updownmanid) updownman,
       t.printdate,
       t.printmanid,
       f.employeename printman,
       t.chainprintflag,
       t.chainprintdate,
       t.lqsprintflag,
       t.lqsprintdate,
       t.tgprintflag,
       t.tgprintdate,
       t.ffzjprintflag,
       t.ffzjprintdate,
       t.dtprintflag,
       t.dtprintdate,
       t.ymprintflag,
       t.ymprintdate,
       null dyfydflag,
       null dyfyddate
  from tms_dispatch_doc       t,
       tpl_warehouse          a,
       pub_employee           b,
       tms_driver             c,
       tms_driver             d,
       tms_luyan_vehicle_v    e,
       pub_employee           f
 where t.warehid = a.warehid(+)
   and t.inputmanid = b.employeeid(+)
   and t.vehicleid = e.vehicleid(+)
   and t.driverid = c.driverid(+)
   and t.driver2id = d.driverid(+)
   and t.printmanid = f.employeeid(+)
   and t.usestatus in (1,4,0,5) --初始、在途、撤单、运输完成（某条细单作废状态是撤单）
   and t.warehid in (1,2) --目前只有厦门物流中心使用
   --and t.inputmanid =3 --只有黎叔派的单才算
   and t.credate > to_date('2020-11-01', 'yyyy-mm-dd')
"
"TMS_LUYAN_DISPATCH_DOC_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_DISPATCH_DOC_V1"" (""DISPATCHID"", ""WAREHID"", ""WAREHNAME"", ""CREDATE"", ""DISPATCHDATE"", ""INPUTMANID"", ""INPUTMAN"", ""VEHICLEID"", ""VEHICLENO"", ""GPSNO"", ""SIMNO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""PRINTFLAG"", ""MEMO"", ""PRINTDATE"", ""PRINTMANID"", ""PRINTMAN"", ""CHAINPRINTFLAG"", ""CHAINPRINTDATE"", ""LQSPRINTFLAG"", ""LQSPRINTDATE"", ""TGPRINTFLAG"", ""TGPRINTDATE"", ""FFZJPRINTFLAG"", ""FFZJPRINTDATE"", ""DTPRINTFLAG"", ""DTPRINTDATE"", ""UPDOWNMANID"", ""UPDOWNMAN"", ""YMPRINTFLAG"", ""YMPRINTDATE"", ""USESTATUS"", ""TRAINNO"", ""DYFYDFLAG"", ""DYFYDDATE"", ""ZYPRINTFLAG"", ""ZYPRINTDATE"") AS 
  select t.dispatchid,
       t.warehid,
       a.warehname,
       t.credate,
       t.dispatchdate,
       t.inputmanid,
       b.employeename inputman,
       t.vehicleid,
       nvl(e.vehicleno,t.vehicleno) as vehicleno,
       e.gpsno,
       e.simno,
       t.driverid,
       nvl(c.drivername,t.drivername) as drivername,
       t.driver2id,
       nvl(d.drivername,t.driver2name) as  driver2name,
       t.printflag,
       t.memo,
       t.printdate,
       t.printmanid,
       f.employeename printman,
       t.chainprintflag,
       t.chainprintdate,
       t.lqsprintflag,
       t.lqsprintdate,
       t.tgprintflag,
       t.tgprintdate,
       t.ffzjprintflag,
       t.ffzjprintdate,
       t.dtprintflag,
       t.dtprintdate,
       t.updownmanid,
       nvl(tms_luyan_getupdownman(t.warehid,t.updownmanid),t.updownman) as  updownman,
       t.ymprintflag,
       t.ymprintdate,
       nvl(t.usestatus,1) usestatus,
       t.trainno,
       t.dyfydflag,
       t.dyfyddate,
       t.zyprintflag,
       t.zyprintdate
  from TMS_luyan_DISPATCH_DOC t,
       tpl_warehouse          a,
       pub_employee           b,
       tms_driver             c,
       tms_driver             d,
       tms_luyan_vehicle_v    e,
       pub_employee           f
 where t.warehid = a.warehid(+)
   and t.inputmanid = b.employeeid(+)
   and t.vehicleid = e.vehicleid(+)
   and t.driverid = c.driverid(+)
   and t.driver2id = d.driverid(+)
   and t.printmanid = f.employeeid(+)
   and t.credate > to_date('2018-03-01', 'yyyy-mm-dd')
"
"TMS_LUYAN_DISPATCH_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_DISPATCH_V"" (""DISPATCHID"", ""VEHICLEID"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""UPDOWNMAN"") AS 
  select x.dispatchid,
         x.vehicleid,
         x1.vehicleno,
         x.driverid,
         x2.drivername,
         x.driver2id,
         x3.drivername driver2name,
         tms_luyan_getupdownman(x.warehid, x.updownmanid) updownman
    from tms_luyan_dispatch_doc x,
         tms_vehicle            x1,
         tms_driver             x2,
         tms_driver             x3
   where x.vehicleid = x1.vehicleid(+)
     and x.driverid = x2.driverid(+)
     and x.driver2id = x3.driverid(+)

  union all

  select y.dispatchid,
         y.vehicleid,
         y1.vehicleno,
         y.driverid,
         y2.drivername,
         y.driver2id,
         y3.drivername driver2name,
         tms_luyan_getupdownman(y.warehid, y.updownmanid) updownman
    from tms_dispatch_doc y, tms_vehicle y1, tms_driver y2, tms_driver y3
   where y.vehicleid = y1.vehicleid(+)
     and y.driverid = y2.driverid(+)
     and y.driver2id = y3.driverid(+)
"
"TMS_LUYAN_DRIVER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_DRIVER_V"" (""WAREHID"", ""WAREHNAME"", ""DRIVERID"", ""DRIVERNAME"", ""OPCODE"", ""BIRTHDAY"", ""IDCARDNO"", ""LICENSENO"", ""LICENSETYPE"", ""LICENSETYPENAME"", ""GETDATE"", ""LASTCHECKDATE"", ""MOBILE"", ""USESTATUS"", ""MEMO"", ""TMSPASS"", ""OPENID"", ""LOGINNAME"", ""CREDATE"", ""INPUTMANID"", ""INPUTMAN"") AS 
  select t.warehid,
       a.warehname,
       t.driverid,
       t.drivername,
       t.opcode,
       t.birthday,
       t.idcardno,
       t.licenseno,
       t.licensetype,
       b.ddlname licensetypename,
       t.getdate,
       t.lastcheckdate,
       t.mobile,
       t.usestatus,
       t.memo,
       t.tmspass,
       t.openid,
       t.loginname,
       t.credate,
       t.inputmanid,
       tt.employeename inputman
  from tms_driver t,pub_employee tt,tpl_warehouse a,pub_ddl_dtl b
  where t.inputmanid=tt.employeeid(+)
  and   t.warehid=a.warehid(+)
  and   b.sysid(+)=571
  and   t.usestatus=1 --正式状态
  and   t.licensetype=b.ddlid(+)
"
"TMS_LUYAN_DRIVER_WORKLOAD_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_DRIVER_WORKLOAD_V"" (""TRID"", ""WAREHID"", ""WAREHNAME"", ""CREDATE"", ""TASKTYPE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYNAME"", ""ROUTENAME"", ""SCATTERPACKS"", ""WHOLEPACKS"", ""TOTALPACKS"", ""SIGNFLAG"", ""SIGNDATE"", ""DISPATCHID"", ""DISPATCHDATE"", ""GPSNO"", ""ADDRESS"", ""FROMADDRESS"", ""VEHICLEID"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""CURWAREHID"", ""UPDOWNMANID"", ""UPDOWNMAN"") AS 
  select t.TRID,
       t.WAREHID,
       a.warehname,
       j.credate,--取派车时间作为判断
       t.TASKTYPE,
       t.goodsownerid,
       b.goodsownername,
       c.companyname,
       d.routename,
       --nvl(t.SCATTERPACKS,0) SCATTERPACKS,
       decode(t.comefrom,1,zx_get_boxno(t.sourceid),nvl(t.scatterpacks,0)) scatterpacks,
       --nvl(t.WHOLEPACKS,0) WHOLEPACKS,
       decode(t.comefrom,1,zx_get_wholeqty(t.sourceid),nvl(t.wholepacks,0)) wholepacks,
       --nvl(t.TOTALPACKS,0) TOTALPACKS,
       decode(t.comefrom,1,zx_get_boxno(t.sourceid)+zx_get_wholeqty(t.sourceid),nvl(t.totalpacks,0)) totalpacks,
       nvl(t.SIGNFLAG,0) signflag,
       t.SIGNDATE,
       t.DISPATCHID,
       t.dispatchdate,
       t.gpsno,
       /*运输地点ID+货主单位+运输地点+派车时间的上午下午，拼接成一个判断字段;
       上午下午的时间范围界定：0点-15点上午，其余为下午*/
       t.transid||c.companyname||e.address||(case when to_number(to_char(j.credate,'HH24'))>=0 and to_number(to_char(j.credate,'HH24'))<=14 then 'AM' else 'PM' end) address,
       --e.address,
       null FROMADDRESS,
       j.vehicleid,
       j.vehicleno,
       j.driverid,
       j.drivername,
       j.driver2id,
       j.driver2name,
       decode(t.curwarehid,null,t.warehid,t.curwarehid) curwarehid,
       j.updownmanid,
       j.updownman
  from tms_tr_doc t,
       tpl_warehouse   a,
       tpl_goodsowner  b,
       tpl_go_company  c,
       wms_tr_route    d,
       wms_transport_address  e,
       tms_luyan_dispatch_doc_v j
  where t.warehid=a.warehid(+)
  and   t.goodsownerid=b.goodsownerid(+)
  and   t.gcompanyid=c.companyid(+)
  and   t.routeid=d.routeid(+)
  and   t.transid=e.transid(+)
  and   t.usestatus in (2,5) --确定和派车状态的运输任务单
  and   t.comefrom=1  --wms转入的运输任务单
  and   t.dispatchid=j.dispatchid(+)
  and   t.signflag in (3,4,5) --已签收、部分签收、拒收
  and   t.credate>to_date('2018-03-01','yyyy-mm-dd') --为了测试增加时间限制
/*
  union all

  select tt.TRID,
         tt.WAREHID,
         a.warehname,
         c.credate,
         tt.TASKTYPE,
         tt.goodsownerid,
         tt.goodsownername,
         tt.companyname,
         tt.routename,
         nvl(tt.SCATTERPACKS,0) SCATTERPACKS,
         nvl(tt.WHOLEPACKS,0) WHOLEPACKS,
         nvl(tt.TOTALPACKS,0) TOTALPACKS,
         nvl(tt.SIGNFLAG,0) signflag,
         tt.SIGNDATE,
         tt.DISPATCHID,
         tt.dispatchdate,
         tt.gpsno,
         --无运输地点ID
         tt.companyname||tt.address||(case when to_number(to_char(c.credate,'HH24'))>=0 and to_number(to_char(c.credate,'HH24'))<=14 then 'AM' else 'PM' end) address,
         tt.fromaddress,
         c.vehicleid,
         c.vehicleno,
         c.driverid,
         c.drivername,
         c.driver2id,
         c.driver2name,
         decode(tt.curwarehid,null,tt.warehid,tt.curwarehid) curwarehid,
         c.updownmanid,
         c.updownman
    from tms_luyan_tr_doc tt,
         tpl_warehouse   a,
         tms_luyan_dispatch_doc_v c
   where tt.warehid=a.warehid(+)
   and   tt.dispatchid=c.dispatchid(+)
   and   tt.signflag in (3,4,5)
   and   tt.credate>to_date('2018-03-01','yyyy-mm-dd') --为了测试增加时间限制
;
*/
"
"TMS_LUYAN_EMPLOYEE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_EMPLOYEE_V"" (""EMPLOYEEID"", ""OPCODE"", ""EMPLOYEENAME"", ""SEX"", ""BIRTHDATE"", ""IDCARD"", ""MEMO"", ""USESTATUS"", ""EMAIL"", ""PHONE"", ""MOBILENO"", ""WAREHID"", ""WAREHIDS"", ""ADMINFLAG"", ""LOGINNAME"", ""PASSWORD"", ""EMPLOYEETYPE"", ""CREDATE"", ""INPUTMANID"", ""INPUTMAN"") AS 
  select t.employeeid,
       t.opcode,
       t.employeename,
       t.sex,
       t.birthdate,
       t.idcard,
       t.memo,
       t.usestatus,
       t.email,
       t.phone,
       t.mobileno,
       t.warehid,
       t.warehids,
       nvl(t.adminflag,0) adminflag,
       t.loginname,
       t.password,
       nvl(t.employeetype,0) employeetype,
       t.credate,
       t.inputmanid,
       tt.employeename inputman
  from pub_employee t,pub_employee tt
  where t.inputmanid=tt.employeeid(+)
  and   t.password is not null
  and   t.loginname is not null
"
"TMS_LUYAN_HUMITURE_MONITOR_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_HUMITURE_MONITOR_V"" (""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""COMPANYNAME"", ""TRID"", ""SIGNFLAG"", ""SIGNDATE"", ""SOURCEID"", ""GOODSOWNERNAME"", ""TASKTYPE"", ""DRIVERID"", ""DRIVERNAME"", ""VEHICLEID"", ""VEHICLENO"", ""DEVNUM"", ""BINTIME"", ""MINTEMP"", ""MAXTEMP"") AS 
  select distinct t.credate,
       t.warehid,
       t.warehname,
       t.companyname,
       t.trid,
       t.signflag,
       t.SIGNDATE,
       t.SOURCEID,
       t.goodsownername,
       t.TASKTYPE,
       t.driverid,
       t.drivername,
       t.vehicleid,
       t.vehicleno,
       tt.devnum,
       tt.bintime,
       ttt.mintemp,
       ttt.maxtemp
from tms_luyan_tr_doc_v t,tms_luyan_bin_record tt,tms_luyan_tr_dtl ttt
where t.TRID=ttt.trid
and   ttt.TRID=tt.trid(+)
and   ttt.mintemp is not null
and   t.chainflag=1 -- 冷链监控视图，只显示冷链运输任务单
and   t.driverid not in (341,41,421,261,301,781) --去掉ZT、DYF、LQS、LYQX、DTZ、YYY
and   t.vehicleid<>22 --去掉22车
and   ttt.mintemp=tt.mintemp(+)
and   ttt.maxtemp=tt.maxtemp(+)
and   t.CREDATE>to_Date('2018-06-01','yyyy-mm-dd')
"
"TMS_LUYAN_TOTAL_DISTANCE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_TOTAL_DISTANCE_V"" (""CREDATE"", ""DRIVERID"", ""DRIVERNAME"", ""VEHICLEID"", ""VEHICLENO"", ""GPSNO"", ""TOTAL_DISTANCE"", ""WAREHID"", ""WAREHNAME"", ""DRIVERTYPE"") AS 
  select t.credate,
       t.driverid,
       b.drivername,
       t.vehicleid,
       t.vehicleno,
       t.gpsno,
       t.total_distance,
       t.warehid,
       a.warehname,
       t.drivertype
  from tms_luyan_total_distance t,tpl_warehouse a,tms_luyan_driver_v b
  where t.warehid=a.warehid(+)
  and   t.driverid=b.driverid(+)
"
"TMS_LUYAN_TR_DOC_SALER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_TR_DOC_SALER_V"" (""TRID"", ""WAREHID"", ""WAREHNAME"", ""WAREPHONE"", ""CREDATE"", ""OPERATIONTYPE"", ""TASKTYPE"", ""URGENTFLAG"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""ROUTEID"", ""ROUTENAME"", ""TRANSID"", ""SCATTERPACKS"", ""WHOLEPACKS"", ""TOTALPACKS"", ""VOLUME"", ""WEIGHT"", ""COMEFROM"", ""SOURCEID"", ""MEMO"", ""INPUTMANID"", ""INPUTMAN"", ""PRINTFLAG"", ""TGFLAG"", ""CHAINFLAG"", ""SIGNFLAG"", ""SIGNDATE"", ""DISPATCHID"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""POINAME"", ""LONGITUDE"", ""LATITUDE"", ""FROMPROVINCE"", ""FROMCITY"", ""FROMDISTRICT"", ""FROMPOINAME"", ""FROMLONGITUDE"", ""FROMLATITUDE"", ""FROMCONNECTOR"", ""FROMCONNPHONE"", ""CONNECTOR"", ""CONNPHONE"", ""DISPATCHDATE"", ""GPSNO"", ""ADDRESS"", ""FROMADDRESS"", ""VEHICLEID"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""UPDOWNMAN"", ""APPKEY"", ""CURWAREHID"", ""WAREHIDROUTE"", ""SALERNAME"", ""MOBILENO"") AS 
  select t.trid,
       t.warehid,
       a.warehname,
       a.connphone warephone,
       t.credate,
       (select x.ddlname
          from sys_ddl_dtl x
         where x.sysid = 389
           and x.ddlid = t.operationtype) operationtype,
       t.tasktype,
       t.urgentflag,
       t.goodsownerid,
       b.goodsownername,
       t.gcompanyid companyid,
       c.companyname,
       t.routeid,
       d.routename,
       t.transid,
       decode(t.comefrom,
              1,
              nvl(zx_get_boxno(t.sourceid), 0),
              nvl(t.scatterpacks, 0)) scatterpacks,
       decode(t.comefrom,
              1,
              nvl(zx_get_wholeqty(t.sourceid), 0),
              nvl(t.wholepacks, 0)) wholepacks,
       decode(t.comefrom,
              1,
              nvl(zx_get_boxno(t.sourceid), 0) +
              nvl(zx_get_wholeqty(t.sourceid), 0),
              nvl(t.totalpacks, 0)) totalpacks,
       null volume,
       null weight,
       t.comefrom,
       to_char(t.sourceid) sourceid,
       t.memo,
       0 INPUTMANID,
       null inputman,
       0 printflag,
       0 tgflag,
       nvl(t.chainflag, 0) chainflag,
       (case
         when t.usestatus = 5 and t.signflag is null then
          1
         else
          nvl(t.signflag, 0)
       end) signflag,--这个是关键
       t.signdate,
       t.dispatchid,
       e.province,
       e.city,
       e.district,
       e.poiname,
       e.longitude,
       e.latitude,
       null FROMPROVINCE,
       null FROMCITY,
       null FROMDISTRICT,
       null FROMPOINAME,
       null FROMLONGITUDE,
       null FROMLATITUDE,
       a.connector fromconnector,
       a.connphone fromconnphone,
       e.connector,
       e.connphone,
       t.dispatchdate,
       t.gpsno,
       e.address,
       null fromaddress,
       g.vehicleid,
       g.vehicleno,
       g.driverid,
       g.drivername,
       g.driver2id,
       g.driver2name,
       g.updownman,
       '' APPKEY,
       decode(t.curwarehid,null,t.warehid,t.curwarehid) curwarehid,
       t.warehIdRoute,
       zx_get_salername(t.warehid, t.sourceid) salername,
       zx_get_salermobile(t.warehid, t.sourceid) mobileno
  from tms_tr_doc            t,
       tpl_warehouse         a,
       tpl_goodsowner        b,
       tpl_go_company        c,
       wms_tr_route          d,
       wms_transport_address e,
       pub_employee          f,
       tms_luyan_dispatch_v  g
 where t.warehid = a.warehid(+)
   and t.goodsownerid = b.goodsownerid(+)
   and t.gcompanyid = c.companyid(+)
   and t.routeid = d.routeid(+)
   and t.transid = e.transid(+)
   and nvl(t.createmanid, 0) = f.employeeid(+)
   and t.usestatus in (2, 5) --确定和派出状态的运输任务单
   and t.comefrom = 1 --wms转入的运输任务单
   and t.sourcetable = 1
   and t.dispatchid = g.dispatchid(+)
   and nvl(g.driverid, 0) not in (341, 41, 421, 261, 301, 781, 401) --去掉ZT、DYF、LQS、LYQX、DTZ、YYY、SF、联冠1
   and nvl(g.vehicleid, 0) <> 22 --去掉22车
   and t.credate > to_date('2023-05-01', 'yyyy-mm-dd')
"
"TMS_LUYAN_TR_DOC_SALER_V_BAK","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_TR_DOC_SALER_V_BAK"" (""TRID"", ""WAREHID"", ""WAREHNAME"", ""WAREPHONE"", ""CREDATE"", ""OPERATIONTYPE"", ""TASKTYPE"", ""URGENTFLAG"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""ROUTEID"", ""ROUTENAME"", ""TRANSID"", ""SCATTERPACKS"", ""WHOLEPACKS"", ""TOTALPACKS"", ""VOLUME"", ""WEIGHT"", ""COMEFROM"", ""SOURCEID"", ""MEMO"", ""INPUTMANID"", ""INPUTMAN"", ""PRINTFLAG"", ""CHAINFLAG"", ""TGFLAG"", ""SIGNFLAG"", ""SIGNDATE"", ""DISPATCHID"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""POINAME"", ""LONGITUDE"", ""LATITUDE"", ""FROMPROVINCE"", ""FROMCITY"", ""FROMDISTRICT"", ""FROMPOINAME"", ""FROMLONGITUDE"", ""FROMLATITUDE"", ""FROMCONNECTOR"", ""FROMCONNPHONE"", ""CONNECTOR"", ""CONNPHONE"", ""DISPATCHDATE"", ""GPSNO"", ""ADDRESS"", ""FROMADDRESS"", ""VEHICLEID"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""APPKEY"", ""CURWAREHID"", ""WAREHIDROUTE"", ""SALERNAME"", ""MOBILENO"", ""UPDOWNMAN"") AS 
  select t.TRID,
       t.WAREHID,
       a.warehname,
       a.connphone warephone,
       t.CREDATE,
       --t.TRNO,
       i.ddlname OPERATIONTYPE,
       t.TASKTYPE,
       t.URGENTFLAG,
       t.GOODSOWNERID,
       b.goodsownername,
       t.gcompanyid companyid,
       c.companyname,
       t.ROUTEID,
       d.routename,
       t.TRANSID,
       t.SCATTERPACKS,
       t.WHOLEPACKS,
       t.TOTALPACKS,
       t.VOLUME,
       t.WEIGHT,
       t.COMEFROM,
       to_char(t.SOURCEID) sourceid,
       t.MEMO,
       nvl(t.createmanid,0) INPUTMANID,
       f.employeename inputman,
       decode(h.printflag,null,0,0,0,1) printflag,
       nvl(t.CHAINFLAG,0) chainflag,
       decode(g.tgflag,null,0,1)  tgflag,
       --1 tgflag,
       nvl(t.SIGNFLAG,0) signflag,
       t.SIGNDATE,
       t.DISPATCHID,
       e.PROVINCE,
       e.CITY,
       e.DISTRICT,
       e.POINAME,
       e.LONGITUDE,
       e.LATITUDE,
       null FROMPROVINCE,
       null FROMCITY,
       null FROMDISTRICT,
       null FROMPOINAME,
       null FROMLONGITUDE,
       null FROMLATITUDE,
       a.connector fromconnector,
       a.connphone fromconnphone,
       e.connector,
       e.connphone,
       t.dispatchdate,
       t.gpsno,
       e.address,
       null FROMADDRESS,
       j.vehicleid,
       j.vehicleno,
       j.driverid,
       j.drivername,
       j.driver2id,
       j.driver2name,
       '' APPKEY,
       decode(t.curwarehid,null,t.warehid,t.curwarehid) curwarehid,
       t.warehIdRoute,
       (select max(ttt.salername) from wms_out_order tt,pub_saler ttt where tt.wavedtlid=t.sourceid and tt.salerid=ttt.employeeid(+)) salername,
       (select max(ttt.mobileno) from wms_out_order tt,pub_saler ttt where tt.wavedtlid=t.sourceid and tt.salerid=ttt.employeeid(+)) mobileno,
       j.updownman
  from tms_tr_doc t,
       tpl_warehouse   a,
       tpl_goodsowner  b,
       tpl_go_company  c,
       wms_tr_route    d,
       wms_transport_address  e,
       pub_employee    f,
       zx_tl_tgflag_v  g,
       wms_wave_dtl    h,
       sys_ddl_dtl     i,
       tms_luyan_dispatch_doc_v j
  where t.warehid=a.warehid(+)
  and   t.goodsownerid=b.goodsownerid(+)
  and   t.gcompanyid=c.companyid(+)
  and   t.routeid=d.routeid(+)
  and   t.transid=e.transid(+)
  and   nvl(t.createmanid,0)=f.employeeid(+)
  and   t.sourceid=g.wavedtlid(+)
  and   t.sourceid = h.wavedtlid(+)
  and   i.sysid=389
  and   t.operationtype=i.ddlid(+)
  and   t.usestatus in (2,5) --确定和派出状态的运输任务单
  and   t.comefrom=1  --wms转入的运输任务单
  and   t.dispatchid=j.dispatchid
  and   t.credate>to_date('2023-05-01','yyyy-mm-dd') --为了测试增加时间限制

/*  union all

  select tt.TRID,
         tt.WAREHID,
         a.warehname,
         a.connphone warephone,
         tt.CREDATE,
         --tt.TRNO,
         null OPERATIONTYPE,
         tt.TASKTYPE,
         tt.URGENTFLAG,
         null GOODSOWNERID,
         tt.goodsownername,
         null COMPANYID,
         tt.companyname,
         null ROUTEID,
         tt.routename,
         null TRANSID,
         tt.SCATTERPACKS,
         tt.WHOLEPACKS,
         tt.TOTALPACKS,
         tt.VOLUME,
         tt.WEIGHT,
         tt.COMEFROM,
         tt.SOURCEID,
         tt.MEMO,
         tt.INPUTMANID,
         b.employeename inputman,
         0 printflag,
         tt.CHAINFLAG,
         tt.TGFLAG,
         nvl(tt.SIGNFLAG,0) signflag,
         tt.SIGNDATE,
         tt.DISPATCHID,
         tt.PROVINCE,
         tt.CITY,
         tt.DISTRICT,
         tt.POINAME,
         tt.LONGITUDE,
         tt.LATITUDE,
         tt.FROMPROVINCE,
         tt.FROMCITY,
         tt.FROMDISTRICT,
         tt.FROMPOINAME,
         tt.FROMLONGITUDE,
         tt.FROMLATITUDE,
         tt.fromconnector,
         tt.fromconnphone,
         tt.connector,
         tt.connphone,
         tt.dispatchdate,
         tt.gpsno,
         tt.address,
         tt.fromaddress,
         c.vehicleid,
         c.vehicleno,
         c.driverid,
         c.drivername,
         c.driver2id,
         c.driver2name,
         tt.appkey,
         decode(tt.curwarehid,null,tt.warehid,tt.curwarehid) curwarehid,
         --tt.curwarehid,
         tt.warehIdRoute,
         tt.salername,
         tt.mobileno,
         c.updownman
    from tms_luyan_tr_doc tt,
         tpl_warehouse   a,
         pub_employee    b,
         tms_luyan_dispatch_doc_v c
   where tt.warehid=a.warehid(+)
   and   tt.inputmanid=b.employeeid(+)
   and   tt.dispatchid=c.dispatchid(+)
   and   tt.credate>to_date('2018-03-01','yyyy-mm-dd') --为了测试增加时间限制*/
"
"TMS_LUYAN_TR_DOC_TRANSFER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_TR_DOC_TRANSFER_V"" (""ROUTEID"", ""FROMWAREHID"", ""FROMWAREHNAME"", ""TOWAREHID"", ""TOWAREHNAME"", ""DRIVERID"", ""DRIVERNAME"", ""TRANSFERID"", ""TRANSFERTIME"", ""TRID"", ""GOODSOWNERNAME"", ""COMPANYNAME"", ""SIGNFLAG"") AS 
  select r.id routeId,
       r.fromWarehId,
       a.warehname fromWarehName,
       r.toWarehId,
       aa.warehname toWarehName,
       r.driverId,
       d.drivername,
       r.transferId,
       r.optime transferTime,
       r.trid,
       b.goodsownername,
       c.companyname,
       nvl(t.signflag, 0) signflag
  from tms_luyan_route r,
       tms_tr_doc t,
       tms_driver d,
       tpl_warehouse a,
       tpl_warehouse aa,
       tpl_goodsowner b,
       tpl_go_company c
  where r.opevent = '转运中'
  and r.fromWarehId is not null
  and r.toWarehId is not null
  and r.trid = t.trid
  and r.fromWarehId=a.warehid(+)
  and r.toWarehId=aa.warehid(+)
  and r.driverid=d.driverid(+)
  and t.goodsownerid=b.goodsownerid(+)
  and t.gcompanyid=c.companyid(+)

  union all

  select r.id routeId,
       r.fromWarehId,
       a.warehname fromWarehName,
       r.toWarehId,
       aa.warehname toWarehName,
       r.driverId,
       d.drivername,
       r.transferId,
       r.optime transferTime,
       r.trid,
       t.goodsownername,
       null companyname,
       nvl(t.signflag, 0) signflag
  from tms_luyan_route r,
       tms_luyan_tr_doc t,
       tms_driver d,
       tpl_warehouse a,
       tpl_warehouse aa
  where r.opevent = '转运中'
  and r.fromWarehId is not null
  and r.toWarehId is not null
  and r.trid = t.trid
  and r.fromWarehId=a.warehid(+)
  and r.toWarehId=aa.warehid(+)
  and r.driverid=d.driverid(+)
"
"TMS_LUYAN_TR_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_TR_DOC_V"" (""TRID"", ""WAREHID"", ""WAREHNAME"", ""WAREPHONE"", ""CREDATE"", ""OPERATIONTYPE"", ""TASKTYPE"", ""URGENTFLAG"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""ROUTEID"", ""ROUTENAME"", ""TRANSID"", ""SCATTERPACKS"", ""WHOLEPACKS"", ""TOTALPACKS"", ""VOLUME"", ""WEIGHT"", ""COMEFROM"", ""SOURCEID"", ""MEMO"", ""INPUTMANID"", ""INPUTMAN"", ""PRINTFLAG"", ""CHAINFLAG"", ""TGFLAG"", ""SIGNFLAG"", ""SIGNDATE"", ""DISPATCHID"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""POINAME"", ""LONGITUDE"", ""LATITUDE"", ""FROMPROVINCE"", ""FROMCITY"", ""FROMDISTRICT"", ""FROMPOINAME"", ""FROMLONGITUDE"", ""FROMLATITUDE"", ""FROMCONNECTOR"", ""FROMCONNPHONE"", ""CONNECTOR"", ""CONNPHONE"", ""DISPATCHDATE"", ""GPSNO"", ""ADDRESS"", ""FROMADDRESS"", ""VEHICLEID"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""APPKEY"", ""CURWAREHID"", ""WAREHIDROUTE"", ""UPDOWNMANID"") AS 
  select t.TRID,
       t.WAREHID,
       a.warehname,
       a.connphone warephone,
       t.CREDATE,
       i.ddlname OPERATIONTYPE,
       t.TASKTYPE,
       t.URGENTFLAG,
       t.GOODSOWNERID,
       b.goodsownername,
       t.gcompanyid companyid,
       c.companyname,
       t.ROUTEID,
       d.routename,
       t.TRANSID,
       decode(t.comefrom,
              1,
              nvl(zx_get_boxno(t.sourceid), 0),
              nvl(t.scatterpacks, 0)) scatterpacks,
       decode(t.comefrom,
              1,
              nvl(zx_get_wholeqty(t.sourceid), 0),
              nvl(t.wholepacks, 0)) wholepacks,
       decode(t.comefrom,
              1,
              nvl(zx_get_boxno(t.sourceid), 0) +
              nvl(zx_get_wholeqty(t.sourceid), 0),
              nvl(t.totalpacks, 0)) totalpacks,
       t.VOLUME,
       t.WEIGHT,
       decode(t.COMEFROM, 2, 1, t.comefrom) comefrom,
       to_char(t.SOURCEID) sourceid,
       (case
         when t.goodsownerid = 682 and t.gcompanyid = 1791345 then
          e.sendpos
         else
          t.MEMO
       end) memo,
       nvl(t.createmanid, 0) INPUTMANID,
       f.employeename inputman,
       --decode(h.printflag,null,0,0,0,1) printflag,
       zx_get_printflag(t.sourceid) printflag,
       nvl(t.CHAINFLAG, 0) chainflag,
       decode(g.tgflag, null, 0, 1) tgflag,
       (case
         when t.usestatus = 5 and t.signflag is null then
          1
         else
          nvl(t.signflag, 0)
       end) signflag,
       t.SIGNDATE,
       t.dispatchid, --前端TMS派车就用记录的派车单ID
       e.PROVINCE,
       e.CITY,
       e.DISTRICT,
       e.POINAME,
       e.LONGITUDE,
       e.LATITUDE,
       null FROMPROVINCE,
       null FROMCITY,
       null FROMDISTRICT,
       null FROMPOINAME,
       null FROMLONGITUDE,
       null FROMLATITUDE,
       a.connector fromconnector,
       a.connphone fromconnphone,
       e.connector,
       e.connphone,
       t.dispatchdate,
       decode(t.gpsno, null, j.gpsno, t.gpsno) gpsno,
       nvl(e.address, e.inceptaddr) address,
       null FROMADDRESS,
       j.vehicleid,
       j.vehicleno,
       j.driverid,
       j.drivername,
       j.driver2id,
       j.driver2name,
       '' appkey,
       decode(t.curwarehid, null, t.warehid, t.curwarehid) curwarehid,
       t.warehIdRoute,
       j.updownmanid
  from tms_tr_doc               t,
       tpl_warehouse            a,
       tpl_goodsowner           b,
       tpl_go_company           c,
       wms_tr_route             d,
       wms_transport_address    e,
       pub_employee             f,
       zx_tl_tgflag_v           g,
       wms_wave_dtl             h,
       sys_ddl_dtl              i,
       tms_luyan_dispatch_doc_v j
 where t.warehid = a.warehid(+)
   and t.goodsownerid = b.goodsownerid(+)
   and t.gcompanyid = c.companyid(+)
   and t.routeid = d.routeid(+)
   and t.transid = e.transid(+)
   and nvl(t.createmanid, 0) = f.employeeid(+)
   and t.sourceid = g.wavedtlid(+)
   and t.sourceid = h.wavedtlid(+)
   and i.sysid(+) = 389
   and t.operationtype = i.ddlid(+)
   and t.usestatus in (2, 5) --确定、派车
   and t.comefrom in (1, 2) --wms转入的运输任务单\手工录入
   and t.dispatchid = j.dispatchid(+) --关联出在wms系统派车的任务单
   and nvl(j.driverid, 0) not in (341, 41, 421, 261, 301, 781, 401) --去掉ZT、DYF、LQS、LYQX、DTZ、YYY、SF、联冠1
   and nvl(j.vehicleid, 0) <> 22 --去掉22车
   and t.credate > to_date('2020-11-01', 'yyyy-mm-dd') --为了测试增加时间限制
   and t.warehid in (1, 2, 14)

/*  union all

  select tt.TRID,
         tt.WAREHID,
         a.warehname,
         a.connphone warephone,
         tt.CREDATE,
         --tt.TRNO,
         null OPERATIONTYPE,
         tt.TASKTYPE,
         tt.URGENTFLAG,
         tt.goodsownerid,
         tt.goodsownername,
         null COMPANYID,
         tt.companyname,
         null ROUTEID,
         tt.routename,
         null TRANSID,
         nvl(tt.SCATTERPACKS,0) SCATTERPACKS,
         nvl(tt.WHOLEPACKS,0) WHOLEPACKS,
         nvl(tt.TOTALPACKS,0) TOTALPACKS,
         tt.VOLUME,
         tt.WEIGHT,
         tt.COMEFROM,
         tt.SOURCEID,
         tt.MEMO,
         tt.INPUTMANID,
         b.employeename inputman,
         decode(tt.printflag,null,0,0,0,1) printflag,
         tt.CHAINFLAG,
         tt.TGFLAG,
         nvl(tt.SIGNFLAG,0) signflag,
         tt.SIGNDATE,
         tt.DISPATCHID,
         tt.PROVINCE,
         tt.CITY,
         tt.DISTRICT,
         tt.POINAME,
         tt.LONGITUDE,
         tt.LATITUDE,
         tt.FROMPROVINCE,
         tt.FROMCITY,
         tt.FROMDISTRICT,
         tt.FROMPOINAME,
         tt.FROMLONGITUDE,
         tt.FROMLATITUDE,
         tt.fromconnector,
         tt.fromconnphone,
         tt.connector,
         tt.connphone,
         tt.dispatchdate,
         tt.gpsno,
         tt.address,
         tt.fromaddress,
         c.vehicleid,
         c.vehicleno,
         c.driverid,
         c.drivername,
         c.driver2id,
         c.driver2name,
         tt.appkey,
         tt.curwarehid,
         tt.warehIdRoute,
         c.updownmanid
    from tms_luyan_tr_doc tt,
         tpl_warehouse   a,
         pub_employee    b,
         tms_luyan_dispatch_doc_v c
   where tt.warehid=a.warehid(+)
   and   tt.inputmanid=b.employeeid(+)
   and   tt.dispatchid=c.dispatchid(+)
   and   nvl(c.driverid,0) not in (341,41,421,261,301,781,401) --去掉ZT、DYF、LQS、LYQX、DTZ、YYY、SF、联冠1
   and   nvl(c.vehicleid,0)<>22 --去掉22车
   and   tt.credate>to_date('2020-11-01','yyyy-mm-dd') --为了测试增加时间限制
   and   tt.warehid in (1,2,14)*/
"
"TMS_LUYAN_TR_DOC_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_TR_DOC_V1"" (""TRID"", ""WAREHID"", ""WAREHNAME"", ""CREDATE"", ""OPERATIONTYPE"", ""TASKTYPE"", ""URGENTFLAG"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""ROUTEID"", ""ROUTENAME"", ""TRANSID"", ""SCATTERPACKS"", ""WHOLEPACKS"", ""TOTALPACKS"", ""VOLUME"", ""WEIGHT"", ""COMEFROM"", ""SOURCEID"", ""MEMO"", ""INPUTMANID"", ""INPUTMAN"", ""PRINTFLAG"", ""CHAINFLAG"", ""TGFLAG"", ""SIGNFLAG"", ""SIGNDATE"", ""DISPATCHID"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""POINAME"", ""LONGITUDE"", ""LATITUDE"", ""FROMPROVINCE"", ""FROMCITY"", ""FROMDISTRICT"", ""FROMPOINAME"", ""FROMLONGITUDE"", ""FROMLATITUDE"", ""FROMCONNECTOR"", ""FROMCONNPHONE"", ""CONNECTOR"", ""CONNPHONE"", ""DISPATCHDATE"", ""GPSNO"", ""ADDRESS"", ""FROMADDRESS"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""UPDOWNMAN"", ""BILLNO"", ""INCEPTADDR"", ""SENDPOS"", ""BACTERINFLAG"", ""STARTDATE"", ""STARTTEMP"", ""ENDDATE"", ""ENDTEMP"", ""CHAINUSESTATUS"", ""CHAINSIGNDATE"", ""VEHICLEID"") AS 
  select t.TRID,
       t.WAREHID,
       a.warehname,
       t.CREDATE,
       --t.TRNO,
       i.ddlname        OPERATIONTYPE,
       t.TASKTYPE,
       t.URGENTFLAG,
       t.GOODSOWNERID,
       b.goodsownername,
       t.gcompanyid     companyid,
       c.companyname,
       t.ROUTEID,
       d.routename,
       t.TRANSID,
       --nvl(t.SCATTERPACKS,0) SCATTERPACKS,
       decode(t.comefrom,
              1,
              zx_get_boxno(t.sourceid),
              nvl(t.scatterpacks, 0)) scatterpacks,
       --nvl(t.WHOLEPACKS,0) WHOLEPACKS,
       decode(t.comefrom,
              1,
              zx_get_wholeqty(t.sourceid),
              nvl(t.wholepacks, 0)) wholepacks,
       --nvl(t.TOTALPACKS,0) TOTALPACKS,
       decode(t.comefrom,
              1,
              zx_get_boxno(t.sourceid) + zx_get_wholeqty(t.sourceid),
              nvl(t.totalpacks, 0)) totalpacks,
       t.VOLUME,
       t.WEIGHT,
       --decode(t.COMEFROM,2,1,t.comefrom) comefrom,
       t.comefrom,
       to_char(t.SOURCEID) SOURCEID,
       t.MEMO,
       nvl(t.createmanid, 0) INPUTMANID,
       f.employeename inputman,
       decode(h.printflag, null, 0, 0, 0, 1) printflag,
       nvl(t.CHAINFLAG, 0) chainflag,
       --decode(g.tgflag, null, 0, 1) tgflag,
       decode(zx_get_tgflag(t.warehid,t.sourceid),0,0,1) as tgflag,
       nvl(t.SIGNFLAG, 0) signflag,
       t.SIGNDATE,
       t.DISPATCHID,
       e.PROVINCE,
       e.CITY,
       e.DISTRICT,
       e.POINAME,
       e.LONGITUDE,
       e.LATITUDE,
       null FROMPROVINCE,
       null FROMCITY,
       null FROMDISTRICT,
       null FROMPOINAME,
       null FROMLONGITUDE,
       null FROMLATITUDE,
       a.connector fromconnector,
       a.connphone fromconnphone,
       e.connector,
       e.connphone,
       t.dispatchdate,
       t.gpsno,
       --decode(e.address,null,e.inceptaddr,e.address) address,
       (case
         when substr(e.inceptaddr, 1, 1) = '*' or e.address is null then
          e.inceptaddr
         else
          e.address
       end) address,
       null FROMADDRESS,
       j.vehicleno,
       j.driverid,
       j.drivername,
       j.driver2id,
       j.driver2name,
       j.updownman,
       zx_pf_print_transinvo(t.sourceid) billno,
       e.inceptaddr,
       e.sendpos, --地点名称
       b.bacterinflag, --疫苗货主标志 tl@210302
       t.startdate,--add by xyue 2024-07-18 启运时间
       t.starttemp,--add by xyue 2024-07-18 启运温度
       t.enddate,--add by xyue 2024-07-18 到达时间
       t.endtemp ,--add by xyue 2024-07-18 到达温度
       t.chainusestatus, --tl@241231冷链回执标志
       t.chainsigndate, --tl@241231冷链回执时间
       j.vehicleid  ---tl@250109车辆ID
  from tms_tr_doc               t,
       tpl_warehouse            a,
       tpl_goodsowner           b,
       tpl_go_company           c,
       wms_tr_route             d,
       wms_transport_address    e,
       pub_employee             f,
       zx_tl_tgflag_v           g,
       wms_wave_dtl             h,
       sys_ddl_dtl              i,
       tms_luyan_dispatch_doc_v j
 where t.warehid = a.warehid(+)
   and t.goodsownerid = b.goodsownerid(+)
   and t.gcompanyid = c.companyid(+)
   and t.routeid = d.routeid(+)
   and t.transid = e.transid(+)
   and nvl(t.createmanid, 0) = f.employeeid(+)
   and t.sourceid = g.wavedtlid(+)
   and t.sourceid = h.wavedtlid(+)
   and i.sysid(+) = 389
   and t.operationtype = i.ddlid(+)
   and t.usestatus in (2, 5) --确定和派出状态的运输任务单
   and t.comefrom in (1, 2) --wms转入的运输任务单/手工录入
   and t.dispatchid = j.dispatchid(+)
   and t.warehid in (1,17,2)
"
"TMS_LUYAN_TR_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_TR_DTL_V"" (""TRID"", ""TRDTLID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""GOODSUNIT"", ""PRODAREA"", ""FACTNAME"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSQTY"", ""SIGNGOODSQTY"", ""MINTEMP"", ""MAXTEMP"") AS 
  select t.trid,
       t.trdtlid,
       t.ownergoodsid,
       t.goodsid,
       t.goodsownid,
       t.goodsname,
       t.goodsengname,
       t.goodstype,
       t.goodsunit,
       t.prodarea,
       t.factname,
       t.lotid,
       t.lotno,
       t.proddate,
       t.validdate,
       t.goodsqty,
       t.signgoodsqty,
       decode(t.mintemp,null,tt.mintemp,t.mintemp) mintemp,
       decode(t.maxtemp,null,tt.maxtemp,t.maxtemp) maxtemp
  from tms_luyan_tr_dtl t,tpl_goods tt
  where t.ownergoodsid=tt.ownergoodsid(+)
"
"TMS_LUYAN_VEHICLE_ALL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_VEHICLE_ALL_V"" (""WAREHID"", ""VEHICLEID"", ""WAREHNAME"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""GPSNO"", ""SIMNO"", ""BASALDISCNO"", ""ENGINENO"", ""USESTATUS"", ""MEMO"", ""VEHICLETYPEID"", ""VEHICLETYPENO"", ""VEHICLETYPE"", ""LENGTH"", ""WIDTH"", ""HEIGHT"", ""LOAD"", ""VOLUMN"", ""CREDATE"", ""INPUTMANID"", ""INPUTMAN"") AS 
  select t.warehid,
       t.vehicleid,
       a.warehname,
       t.vehicleno,
       t.driverid,
       b.drivername,
       t.driver2id,
       c.drivername driver2name,
       t.gpsno,
       t.simno,
       t.basaldiscno,
       t.engineno,
       1 usestatus,
       t.memo,
       t.vehicletypeid,
       d.vehicletypeno,
       d.vehicletype,
       d.length,
       d.width,
       d.height,
       d.load,
       d.volumn,
       t.credate,
       nvl(t.inputmanid,0) inputmanid,
       e.employeename inputman
  from tms_vehicle t,tpl_warehouse a,tms_driver b,tms_driver c,tms_vehicle_type d,pub_employee e
  where t.warehid=a.warehid(+)
  and   t.driverid=b.driverid(+)
  and   t.driver2id=c.driverid(+)
  and   nvl(t.inputmanid,0)=e.employeeid(+)
  and   t.vehicletypeid=d.vehicletypeid(+)
  --and   t.usestatus=4 --运输状态

  union all

select t.warehid,
       t.vehicleid,
       a.warehname,
       t.vehicleno,
       t.driverid,
       b.drivername,
       t.driver2id,
       c.drivername driver2name,
       t.gpsno,
       t.simno,
       t.basaldiscno,
       t.engineno,
       t.usestatus,
       t.memo,
       t.vehicletypeid,
       d.vehicletypeno,
       d.vehicletype,
       d.length,
       d.width,
       d.height,
       d.load,
       d.volumn,
       t.credate,
       t.inputmanid,
       e.employeename inputman
  from tms_luyan_vehicle t,tpl_warehouse a,tms_driver b,tms_driver c,tms_vehicle_type d,pub_employee e
  where t.warehid=a.warehid(+)
  and   t.driverid=b.driverid(+)
  and   t.driver2id=c.driverid(+)
  and   t.inputmanid=e.employeeid(+)
  and   t.vehicletypeid=d.vehicletypeid(+)
"
"TMS_LUYAN_VEHICLE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_VEHICLE_V"" (""WAREHID"", ""VEHICLEID"", ""WAREHNAME"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""GPSNO"", ""SIMNO"", ""BASALDISCNO"", ""ENGINENO"", ""USESTATUS"", ""MEMO"", ""VEHICLETYPEID"", ""VEHICLETYPENO"", ""VEHICLETYPE"", ""LENGTH"", ""WIDTH"", ""HEIGHT"", ""LOAD"", ""VOLUMN"", ""CREDATE"", ""INPUTMANID"", ""INPUTMAN"", ""BACTERINFLAG"", ""VEHICLEMODEL"") AS 
  select t.warehid,
       t.vehicleid,
       a.warehname,
       t.vehicleno,
       t.driverid,
       b.drivername,
       t.driver2id,
       c.drivername driver2name,
       t.gpsno,
       t.simno,
       t.basaldiscno,
       t.engineno,
       decode(t.usestatus,4,1,0) usestatus,
       t.memo,
       t.vehicletypeid,
       d.vehicletypeno,
       d.vehicletype,
       d.length,
       d.width,
       d.height,
       d.load,
       d.volumn,
       t.credate,
       nvl(t.inputmanid,0) inputmanid,
       e.employeename inputman,
       t.bacterinflag,
       d.vehiclemodel
  from tms_vehicle t,tpl_warehouse a,tms_driver b,tms_driver c,tms_vehicle_type d,pub_employee e
  where t.warehid=a.warehid(+)
  and   t.driverid=b.driverid(+)
  and   t.driver2id=c.driverid(+)
  and   nvl(t.inputmanid,0)=e.employeeid(+)
  and   t.vehicletypeid=d.vehicletypeid(+)
  --and   t.usestatus=4 --运输状态

  union all

select t.warehid,
       t.vehicleid,
       a.warehname,
       t.vehicleno,
       t.driverid,
       b.drivername,
       t.driver2id,
       c.drivername driver2name,
       t.gpsno,
       t.simno,
       t.basaldiscno,
       t.engineno,
       t.usestatus,
       t.memo,
       t.vehicletypeid,
       d.vehicletypeno,
       d.vehicletype,
       d.length,
       d.width,
       d.height,
       d.load,
       d.volumn,
       t.credate,
       t.inputmanid,
       e.employeename inputman,
       null bacterinflag,
       d.vehiclemodel
  from tms_luyan_vehicle t,tpl_warehouse a,tms_driver b,tms_driver c,tms_vehicle_type d,pub_employee e
  where t.warehid=a.warehid(+)
  and   t.driverid=b.driverid(+)
  and   t.driver2id=c.driverid(+)
  and   t.inputmanid=e.employeeid(+)
  and   t.vehicletypeid=d.vehicletypeid(+)
"
"TMS_LUYAN_WAREHOUSE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_LUYAN_WAREHOUSE_V"" (""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""WAREHSHORTNAME"", ""CHIEFOFFICER"", ""TELEPHONE"", ""POSTCODE"", ""WAREHADDRESS"", ""CONNECTOR"", ""CONNPHONE"", ""MEMO"", ""WAREHTYPE"", ""CREDATE"", ""INPUTMANID"", ""INPUTMAN"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""TOWNSHIP"", ""POINAME"", ""LONGITUDE"", ""LATITUDE"") AS 
  select t.warehid,
       t.warehopcode,
       t.warehname,
       t.warehshortname,
       t.chiefofficer,
       t.telephone,
       t.postcode,
       t.warehaddress,
       t.connector,
       t.connphone,
       t.memo,
       nvl(t.warehtype,0) warehtype,
       t.credate,
       t.inputmanid,
       tt.employeename inputman,
       t.province,
       t.city,
       t.district,
       t.township,
       t.poiname,
       t.longitude,
       t.latitude
  from tpl_warehouse t,pub_employee tt
  where t.inputmanid=tt.employeeid(+)
"
"TMS_OUT_EMPLOYEE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_OUT_EMPLOYEE_V"" (""EMPLOYEEID"", ""TRCOMPANYID"", ""OPCODE"", ""EMPLOYEENAME"", ""PINYIN"", ""SEX"", ""BIRTHDATE"", ""IDCARD"", ""DEPTID"", ""DEPTOPCODE"", ""DEPTNAME"", ""MEMO"", ""USESTATUS"", ""EMAIL"", ""PHONE"", ""MOBILENO"", ""ADDRESS"", ""STATION"", ""JOBEDU"", ""SPECIALTY"", ""EDULEVEL"", ""SELFFLAG"", ""FINANCENO"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""WAREHID"", ""WAREHNAME"", ""GOOPCODE"", ""WAREHOPCODE"", ""EMPTYPE"") AS 
  select e.employeeid,
       e.trcompanyid,
       a.opcode,
       a.employeename,
       a.pinyin,
       a.sex,
       a.birthdate,
       a.idcard,
       a.deptid,
       b.companyopcode deptopcode,
       b.companyname deptname,
       a.memo,
       a.usestatus,
       a.email,
       a.phone,
       a.mobileno,
       a.address,
       a.station,
       a.jobedu,
       a.specialty,
       a.edulevel,
       a.selfflag,
       a.financeno,
       a.goodsownerid,
       c.goodsownername,
       a.warehid,
       d.warehname,
       c.goopcode,
       d.warehopcode,
       e.emptype
  from tms_out_employee e,
  pub_employee a,
  pub_company b,
  tpl_goodsowner c,
  tpl_warehouse d
 where e.employeeid > 0
   and e.employeeid = a.employeeid(+)
   and a.employeeid > 0
   and a.deptid = b.companyid
   and a.goodsownerid=c.goodsownerid(+)
   and a.warehid = d.warehid(+)
"
"TMS_PARK_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_PARK_LST_V"" (""WAREHID"", ""CHECKINDATE"", ""VEHICLEID"", ""CHECKOUTDATE"", ""MEMO"", ""VEHICLENO"", ""WAREHNAME"") AS 
  SELECT A.WAREHID,
       A.Checkindate,
       A.VEHICLEID,
       a.checkoutdate,
       A.MEMO,
       a.VEHICLENO,
       C.WAREHNAME
  FROM Tms_park_lst A, TPL_WAREHOUSE C
 WHERE A.WAREHID = C.WAREHID

 "
"TMS_PARK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_PARK_V"" (""WAREHID"", ""CHECKINDATE"", ""VEHICLEID"", ""MEMO"", ""VEHICLENO"", ""WAREHNAME"", ""KEYID"") AS 
  SELECT A.WAREHID,
       A.Checkindate,
       A.VEHICLEID,
       A.MEMO,
       A.VEHICLENO,
       C.WAREHNAME,
       A.KEYID
  FROM TMS_PARK A, TPL_WAREHOUSE C
 WHERE A.WAREHID = C.WAREHID

 "
"TMS_ROUTE_POS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_ROUTE_POS_V"" (""KEYID"", ""WAREHID"", ""ROUTEID"", ""TRANSID"", ""ROUTESEQ"", ""DISTANCE"", ""INCEPTADDR"", ""EQUTRANSID"", ""SENDPOS"") AS 
  SELECT A.""KEYID"",
       A.""WAREHID"",
       A.""ROUTEID"",
       A.""TRANSID"",
       A.""ROUTESEQ"",
       A.""DISTANCE"",
       B.Inceptaddr,
       b.equtransid,
       b.sendpos -- add by xyue 2017-11-08
  from TMS_ROUTE_POS A,
       WMS_TRANSPORT_ADDRESS B
 where a.transid = b.transid(+)
"
"TMS_SUBCONTRACT_COST_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_SUBCONTRACT_COST_DTL_V"" (""COSTID"", ""COSTDTLID"", ""ITEMID"", ""COST"", ""MEMO"") AS 
  select ""COSTID"",""COSTDTLID"",""ITEMID"",""COST"",""MEMO""
  from Tms_subcontract_cost_dtl

 "
"TMS_SUBCONTRACT_COST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_SUBCONTRACT_COST_V"" (""COSTID"", ""WAREHID"", ""WAREHNAME"", ""TRCOMPANYID"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""TOTALCOST"", ""MEMO"") AS 
  SELECT A.COSTID,
       A.WAREHID,
       C.WAREHNAME,
       A.TRCOMPANYID,
       B.COMPANYOPCODE,
       B.COMPANYNAME,
       A.USEMM,
       d.useyear,
       d.usemonth,
       A.TOTALCOST,
       A.MEMO
  FROM TMS_SUBCONTRACT_COST A, TPL_PUB_COMPANY B, TPL_WAREHOUSE C,
  tprice_usemm d
 WHERE A.TRCOMPANYID = B.COMPANYID(+)
   AND A.WAREHID = C.WAREHID
   and a.usemm = d.usemm

 "
"TMS_SUBCONTRACT_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_SUBCONTRACT_DOC_V"" (""WAREHID"", ""WAREHNAME"", ""DOCID"", ""SUBCONTRACT"", ""SUBCONTRACTNO"", ""TRCOMPANYID"", ""COMPANYNAME"", ""COMPANYOPCODE"", ""SIGNDATE"", ""VALIDDATE"", ""INVALIDDATE"", ""INPUTMANID"", ""EMPLOYEENAME"", ""CREDATE"", ""USESTATUS"", ""MEMO"") AS 
  select a.WAREHID,
       b.warehname,
       a.DOCID,
       a.SUBCONTRACT,
       a.SUBCONTRACTNO,
       a.TRCOMPANYID,
       d.companyname,
       d.companyopcode,
       a.SIGNDATE,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.INVALIDDATE,
       a.INPUTMANID,
       c.employeename,
       a.CREDATE,
       a.USESTATUS,
       a.MEMO
  from Tms_subcontract_doc a,
  tpl_warehouse            b,
  pub_employee             c,
  tpl_pub_company          d
  where a.warehid = b.warehid
    and a.trcompanyid = d.companyid(+)
    and a.inputmanid = c.employeeid(+)
"
"TMS_SUBCONTRACT_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_SUBCONTRACT_DTL_V"" (""DOCID"", ""DTLID"", ""TRANSMODEID"", ""TRANSNAME"", ""TRANSMODE"", ""ITEMID"", ""TRANSREGIONID"", ""REGIONNAME"", ""DISTANCE"", ""TASKTYPE"", ""UNITTYPE"", ""FEERATIO"", ""MEMO"") AS 
  select a.DOCID,
       a.DTLID,
       a.TRANSMODEID,
       b.transname,
       b.transmode,
       a.ITEMID,
       a.TRANSREGIONID,
       c.regionname,
       c.distance,
       a.TASKTYPE,
       a.UNITTYPE,
       a.FEERATIO,
       a.MEMO
  from Tms_subcontract_dtl a,
  WMS_TRANSPORT_MODE b,
  TPRICE_TRANS_REGION c
  where a.transmodeid = b.transmodeid(+)
  and a.transregionid = c.regionid(+)

 "
"TMS_TERRACE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_TERRACE_V"" (""WAREHID"", ""TERRACEID"", ""TERRACENO"", ""VEHICLEMODEL"", ""VEHICLEID"", ""USESTATUS"", ""MEMO"", ""VEHICLENO"", ""WAREHNAME"") AS 
  SELECT A.WAREHID,
       A.TERRACEID,
       A.TERRACENO,
       A.VEHICLEMODEL,
       A.VEHICLEID,
       A.USESTATUS,
       A.MEMO,
       B.VEHICLENO,
       C.WAREHNAME
  FROM TMS_TERRACE A, TMS_VEHICLE B, TPL_WAREHOUSE C
 WHERE A.WAREHID = C.WAREHID
   AND A.VEHICLEID = B.VEHICLEID(+)

 "
"TMS_TRANSIT_POS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_TRANSIT_POS_V"" (""KEYID"", ""TRANSITNO"", ""TRANSITNAME"", ""INCHARGE"", ""ADDRESS"", ""TEL"", ""TRCOMPANYID"", ""COMPANYNAME"") AS 
  select a.keyid,
       a.transitno,
       a.transitname,
       a.incharge,
       a.address,
       a.tel,
       a.TRCOMPANYID,
       b.companyname
  from tms_transit_pos a,
  tpl_pub_company         b
  where a.TRCOMPANYID = b.companyid(+)

 "
"TMS_TRANSPORT_RECORD_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_TRANSPORT_RECORD_V"" (""DISPATCHID"", ""DISPATCHDTLID"", ""WAREHID"", ""WAREHNAME"", ""TRID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""REALDISPATCHDATE"", ""WAREHADDRESS"", ""GCOMPANYID"", ""COMPANYNAME"", ""TRANSID"", ""INCEPTADDR"", ""SOURCEID"", ""TOTALPACKS"", ""TRANSMODEL"", ""DRIVERID"", ""DRIVERNAME"", ""VEHICLEID"", ""VEHICLENO"", ""YDNO"", ""EXCARRIER"", ""INPUTMANID"", ""INPUTMANNAME"", ""TRANSMODE"", ""CHAINFLAG"", ""STARTDATE"", ""STARTTEMP"", ""ENDDATE"", ""ENDTEMP"", ""SHR"", ""ROUTESEQ"") AS 
  select a.dispatchid,
       b.dispatchdtlid,
       a.warehid,
       c.warehname,
       d.trid,
       d.goodsownerid,
       e.goodsownername,
       a.realdispatchdate,
       c.warehaddress,
       d.gcompanyid,
       f.companyname,
       d.transid,
       g.inceptaddr,
       d.sourceid,
       (nvl(b.scatterpacks, 0) + nvl(b.wholepacks, 0)) totalpacks,
       a.transmodel,
       a.driverid,
       h.drivername,
       a.vehicleid,
       i.vehicleno,
       d.ydno,     --运单号码 用于记录快递单号
			 d.excarrier, --外部承运商  用于记录
       a.inputmanid,
       j.employeename inputmanname,
       k.transmode,
       d.chainflag,--add by xyue 2019-05-28 冷链标识
       d.startdate,--add by xyue 2019-05-28 启运时间
       d.starttemp,--add by xyue 2019-05-28 启运温度
       d.enddate,--add by xyue 2019-05-28 到达时间
       d.endtemp,--add by xyue 2019-05-28 到达温度
       d.shr,--add by xyue 2019-05-28 收货人
       --l.routeseq
       null routeseq
  from tms_dispatch_doc      a,
       tms_dispatch_dtl      b,
       tpl_warehouse         c,
       tms_tr_doc            d,
       tpl_goodsowner        e,
       tpl_go_company        f,
       wms_transport_address g,
       tms_driver            h,
       tms_vehicle           i,
       pub_employee          j,
       wms_transport_mode    k
       --tms_route_pos         l
 where a.usestatus in (0, 4, 5) --派车单状态在途、运输完成、撤单
   and a.dispatchid = b.dispatchid
   and b.usestatus in (0,2) --细单状态正常，1是作废，服了。。。2是完成
   and a.warehid = c.warehid(+)
   and b.trid = d.trid
   and d.goodsownerid = e.goodsownerid(+)
   and d.gcompanyid = f.companyid(+)
   and d.transid = g.transid(+)
   and a.driverid = h.driverid(+)
   and a.vehicleid = i.vehicleid(+)
   and a.inputmanid=j.employeeid(+)
   and a.transmodel=k.transmodeid(+)
   --and g.transid=l.transid(+)
"
"TMS_TR_DOC_TMS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_TR_DOC_TMS_V"" (""TRID"", ""DISPATCHID"", ""CREDATE"", ""COMPANYID"", ""COMPANYNAME"", ""WAVEDTLID"", ""PRINTFLAG"", ""USESTATUS"", ""USESTATUSNAME"", ""TRANSID"", ""INCEPTADDR"", ""OPERATIONTYPE"", ""OPERATIONTYPENAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""WAREHID"", ""WAREHNAME"", ""POINAME"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""TOWNSHIP"", ""LONGITUDE"", ""LATITUDE"", ""CONNECTOR"", ""CONNPHONE"", ""ROUTENAME"", ""CHAINFLAG"", ""URGENTFLAG"", ""WHOLEPACKS"", ""SCATTERPACKS"", ""TOTALPACKS"", ""CANFIXQTY"", ""VOLUME"", ""WEIGHT"", ""SIGNFLAG"", ""SIGNDATE"", ""VEHICLEID"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVERNAME2"", ""TASKTYPE"") AS 
  select t.trid,
       t.dispatchid,
       t.CREDATE ,
       t.companyid,
       t.companyname,
       t.sourceid wavedtlid,
       decode(t.printflag,null,0,1) printflag,
       t.USESTATUS,
       s.ddlname USESTATUSname,
       t.TRANSID,
       t.inceptaddr,
       t.OPERATIONTYPE,
       s1.ddlname operationtypename,
       --t.TASKTYPE,
       t.GOODSOWNERID,
       t.goodsownername,
       t.WAREHID,
       t.warehname,
       t.poiname,
       t.province,
       t.city,
       t.district,
       t.township,
       t.longitude,
       t.latitude,
       t.connector,
       t.connphone,
       t.routename,
       nvl(t.chainflag,0) chainflag,
       t.URGENTFLAG,
       t.WHOLEPACKS,
       t.SCATTERPACKS,
       t.TOTALPACKS,
       t.canfixqty,
       t.VOLUME,
       t.WEIGHT,
       nvl(t.signflag,0) signflag,
       t.signdate,
       tt.vehicleid,--车辆ID
       tt.vehicleno,--车辆名称
       tt.driverid,--主驾驶员ID
       tt.drivername,--主驾驶员
       tt.driver2id,--副驾驶员ID
       tt.drivername2,--副驾驶员
       '送货' tasktype
 from tms_tr_doc_v t,sys_ddl_dtl s ,sys_ddl_dtl s1,tms_dispatch_doc_v tt
 where s.sysid=453 --系统选项字典WMS_TRDOC_STATUS
 and   t.USESTATUS=s.ddlid(+)
 and   s1.sysid=389 --系统选项字典TPL_OPERATIONTYPE
 and   t.OPERATIONTYPE=s1.ddlid(+)
 and   t.dispatchid = tt.dispatchid(+)
 and   t.USESTATUS=5
 and   t.CREDATE>sysdate-60
"
"TMS_TR_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_TR_DOC_V"" (""TRID"", ""WAREHID"", ""WAREHNAME"", ""CREDATE"", ""CREATEMANID"", ""CREATEMANNAME"", ""TARGETDATE"", ""TRNO"", ""OPERATIONTYPE"", ""TASKTYPE"", ""URGENTFLAG"", ""TRANSCLASS"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""BACTERINFLAG"", ""GCOMPANYID"", ""COMPANYID"", ""COMPANYNAME"", ""COMPANYOPCODE"", ""ROUTEID"", ""ROUTENAME"", ""TRANSID"", ""SENDPOS"", ""INCEPTADDR"", ""CONNECTOR"", ""CONNPHONE"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""TOWNSHIP"", ""POINAME"", ""LONGITUDE"", ""LATITUDE"", ""ZONEID"", ""ZONENO"", ""ZONENAME"", ""SCATTERPACKS"", ""WHOLEPACKS"", ""TOTALPACKS"", ""VOLUME"", ""WEIGHT"", ""COMEFROM"", ""SOURCETABLE"", ""SOURCEID"", ""USESTATUS"", ""FROMAREA"", ""ADDRESS"", ""TELEPHONE"", ""DRIVERNAME"", ""GOODSOWNID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""OWNERGOODSID"", ""SRCEXPNO"", ""LOTID"", ""LOTNO"", ""PRINTCLASS"", ""JKHZFLAG"", ""POISON_DRUG"", ""GMPFLAG"", ""DRUGFORM"", ""REPTYPE"", ""L_PERIOD"", ""S_PERIODUNIT"", ""VARIETYDESCID"", ""VARIETYNO"", ""PASTEFLAG"", ""TRCOMPANYID"", ""TRCOMPANYOPCODE"", ""TRCOMPANYNAME"", ""SELFTRANSTYPE"", ""CANFIXQTY"", ""MEMO"", ""FIXQTY"", ""GOODSPACKID"", ""PACKNAME"", ""TRADEGOODSPACK"", ""ROUTESEQ"", ""SENDPOINTFLAG"", ""PRINTFLAG"", ""CHAINFLAG"", ""DISPATCHID"", ""YDNO"", ""EXCARRIER"", ""YDWEIGHT"", ""TGFLAG"", ""ZYFLAG"", ""FFZJFLAG"", ""QXFLAG"", ""XGFLAG"", ""SIGNFLAG"", ""SIGNDATE"", ""SALERNAME"", ""UPLOADFLAG"", ""UPLOADDATE"", ""JCFLAG"", ""OLDDISPATCHID"", ""TRANSCLASS1"") AS 
  select a.TRID,
       a.WAREHID,
       b.warehname,
       a.CREDATE,
       a.createmanid,
       m.employeename createmanname,
       a.TARGETDATE,
       a.TRNO,
       a.OPERATIONTYPE,
       a.TASKTYPE,
       a.URGENTFLAG,
       a.TRANSCLASS,
       a.GOODSOWNERID,
       c.goodsownername,
       c.goopcode,
       c.bacterinflag, --by tl@200225 疫苗货主标志
       a.GCOMPANYID,
       d.companyid, --xyue 2014-06-02 增加货主单位ID
       d.companyname,
       d.opcode companyopcode,
       a.ROUTEID,
       e.routename,
       a.TRANSID,
       f.sendpos,
       f.inceptaddr,
       f.connector,
       f.connphone,
       f.province, --add by xyue 2017-12-25
       f.city, --add by xyue 2017-12-25
       f.district, --add by xyue 2017-12-25
       f.township, --add by xyue 2017-12-25
       f.poiname, --add by xyue 2017-12-25
       f.longitude, --add by xyue 2017-12-25
       f.latitude, --add by xyue 2017-12-25
       a.ZONEID,
       g.zoneno,
       g.zonename,
       (case
         when a.warehid in (1,17) and a.comefrom = 1 then
          zx_get_boxno(a.sourceid)
         else
          a.scatterpacks
       end) scatterpacks,
       (case
         when a.warehid in (1,17) and a.comefrom = 1 then
          zx_get_wholeqty(a.sourceid)
         else
          a.wholepacks
       end) wholepacks,
       (case
         when a.warehid in (1,17) and a.comefrom = 1 then
          zx_get_boxno(a.sourceid) + zx_get_wholeqty(a.sourceid)
         else
          a.totalpacks
       end) totalpacks,
       a.VOLUME,
       a.WEIGHT,
       a.COMEFROM,
       a.SOURCETABLE,
       a.sourceid,
       --decode(a.comefrom,2,'A'||a.SOURCEID,a.sourceid) sourceid,
       a.USESTATUS,
       a.fromarea,
       a.address,
       a.telephone,
       a.drivername,
       a.goodsownid,
       j.opcode,
       j.goodsname,
       j.goodstype,
       j.prodarea,
       a.ownergoodsid,
       (select zh_concat(wms_out_order.srcexpno)
          from wms_out_order
         where wms_out_order.wavedtlid = a.sourceid
           and a.sourcetable = 1) srcexpno,
       a.lotid,
       k.lotno,
       a.printclass,
       y.jkhzflag,
       y.poison_drug,
       y.gmpflag,
       y.drugform,
       y.reptype,
       y.l_period,
       y.s_periodunit,
       j.varietydescid,
       j.varietyno,
       j.pasteflag,
       a.trcompanyid,
       z.companyopcode trcompanyopcode,
       z.companyname trcompanyname,
       a.selftranstype,
       (NVL(a.totalpacks, 0) - nvl(i.fixqty, 0)) canfixqty, --厦门物流中心可派车数量永远是1
       (case when a.goodsownerid=682 and a.gcompanyid=1791345
          then
           f.sendpos
           else
             case when a.goodsownerid=4 and a.gcompanyid=29579
               then
                  f.sendpos
               else
                 a.MEMO end   end ) memo,
       a.fixqty,
       a.goodspackid,
       a.packname,
       a.tradegoodspack,
       ee.routeseq,
       a.sendpointflag, --是否送到门店 add by wanghuaiyu 20130619
       decode(x.printflag, null, null, 1) printflag, --随货联打印标志 zhaocl 2013年7月25日 21:28:13
       a.chainflag, --add by weitangjing 20130923 冷链标志
       nvl(i.dispatchid,a.dispatchid) dispatchid, --派车单ID by xyue 2023-05-29
       a.ydno, --运单号码 用于记录快递单号
       a.excarrier, --外部承运商  用于记录
       a.ydweight, --记录运单重量
       zx_get_tgflag(a.warehid, a.sourceid) tgflag, --add by xyue 2019-06-11
       zx_tl_zyflag(a.warehid, a.sourceid) zyflag,
       zx_get_ffzjflag(a.warehid,a.sourceid) ffzjflag,--add by xyue 2022-08-31 含特殊复方制剂标志
       decode(a.goodsownerid,264,1,zx_tl_qxflag(a.warehid, a.sourceid)) qxflag, --add by tl@200319 功能710026
       zx_tl_xgflag(a.sourceid) xgflag, -- tl@210224 710026
       (case
         when a.usestatus = 5 and a.signflag is null then
          1
         when a.usestatus = 2 and a.dispatchid is null then
          0
         when a.usestatus = 1 and a.signflag is null then
          -1
         else
          a.signflag
       end) signflag,
       --add by xyue 2018-03-08,运输任务单是派车状态5，同时signflag为空，则为待装车
       --运输任务单是派车状态2，同时为空，则为待派车
       a.signdate, --add by xyue 2017-12-25
       decode(a.goodsownerid,
              3,
              (select zh_concat(distinct t1.salername)
                 from wms_out_order t1
                where t1.wavedtlid = a.sourceid
                  and t1.goodsownerid = 3
                  and t1.operationtype = a.operationtype
                  and t1.billfrom = 3),
              null) salername, --取出库订单上的业务员,集采需求止 by tl@190529
        a.uploadflag,
        a.uploaddate, --码上放心温度上传标志 by tl@20210118
        (case when a.memo like '%集采%'
             then 1
             else 0
               end )  jcflag ,--加集采标志,用于显示红色 tl@210513
        a.olddispatchid, --测试用tl@240315
        zx_get_transclass(a.trid) as transclass1 --运输分类 xyue 2024-07-01

  from TMS_TR_DOC a,
       tpl_warehouse b,
       tpl_goodsowner c,
       tpl_go_company d,
       wms_tr_route e,
       tms_route_pos ee,
       wms_transport_address f,
       wms_ship_zone g,
       tpl_goods j,
       wms_goods_lot k,
       (SELECT trid,
               sum(nvl(fixqty, 0)) fixqty,
               max(h.dispatchid) dispatchid
          FROM tms_dispatch_dtl h
         WHERE NVL(h.usestatus, 0) <> 1
         GROUP BY trid) i,
       pub_employee m,
       tpl_pub_goods y,
       tpl_pub_company z,
       wms_wave_dtl x
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid(+)
   and a.gcompanyid = d.companyid(+)
   and a.routeid = e.routeid(+)
   and a.transid = f.transid(+)
   and a.zoneid = g.zoneid(+)
   and a.trid = i.trid(+)
   AND a.ownergoodsid = j.ownergoodsid(+)
   AND a.lotid = k.lotid(+)
   AND a.createmanid = m.employeeid(+)
   AND j.waregoodsid = y.goodsid(+)
   AND a.trcompanyid = z.companyid(+)
   and a.sourceid = x.wavedtlid(+)
   and (a.transid = ee.transid(+) and a.routeid = ee.routeid(+))
"
"TMS_TR_DTL_TMS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_TR_DTL_TMS_V"" (""TRID"", ""WAVEDTLID"", ""OUTID"", ""OUTDTLID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""GOODSUNIT"", ""PRODAREA"", ""FACTNAME"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSQTY"", ""INVOICENO"") AS 
  select t.trid,
       a.wavedtlid,
       b.outid,
       b.outdtlid,
       b.goodsid,
       b.goodsownid,
       b.goodsname,
       b.goodsengname,
       b.goodstype,
       b.tradegoodspack goodsunit,
       b.prodarea,
       b.factname,
       b.lotid,
       b.lotno,
       proddate,
       validdate,
       b.goodsqty,
       b.invoiceno
  from tms_tr_doc t, wms_out_order a, wms_out_order_dtl_v b
 where a.outid = b.outid
   and t.sourceid = a.wavedtlid
   and t.comefrom = 1 --wms转入，去除手工订单
"
"TMS_TR_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_TR_DTL_V"" (""WAVEDTLID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""GOODSUNIT"", ""PRODAREA"", ""FACTNAME"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSQTY"", ""MINTEMP"", ""MAXTEMP"") AS 
  select   a.wavedtlid,
         a.ownergoodsid,
         a.goodsid,
         b.goodsownid,
         b.goodsname,
         b.goodsengname,
         b.goodstype,
         b.tradepackname goodsunit,
         b.prodarea,
         b.factname,
         a.lotid,
         c.lotno,
         to_char(c.proddate,'yyyy-mm-dd') proddate,
         decode(to_char(c.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_char(null, 'yyyy-mm-dd'),
              to_char(c.validdate, 'yyyy-mm-dd')) validdate,
         a.goodsqty,
         b.mintemp,--TMS冷链监控温度范围最低温度 add by xyue 2018-07-30
         b.maxtemp --TMS冷链监控温度范围最高温度 add by xyue 2018-07-30
  from wms_wave_goods_dtl  a,
       tpl_goods_v         b,
       wms_goods_lot       c
 where a.ownergoodsid = b.ownergoodsid(+)
   and a.lotid = c.lotid(+)
"
"TMS_TR_MONITOR_XM_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_TR_MONITOR_XM_V"" (""TRID"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CREDATE"", ""GCOMPANYID"", ""COMPANYNAME"", ""SOURCEID"", ""OPERATIONTYPE"", ""COMEFROM"", ""ROUTEID"", ""ROUTENAME"", ""TRANSID"", ""SENDPOS"", ""INCEPTADDR"", ""WAVEDTLFINDATE"", ""DISPATCHID"", ""DISPATCHTYPE"", ""DISCREDATE"", ""VEHICLEID"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""DISPATCHDATE"", ""SIGNFLAG"", ""SIGNDATE"") AS 
  select a.trid,
       a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.credate,
       a.gcompanyid,
       g.companyname,
       a.sourceid,
       a.operationtype,
       a.comefrom, --1.wms转入 2.手工填单
       a.routeid,
       d.routename,
       a.transid,
       e.sendpos, --地点名称
       e.inceptaddr, --运输地址
       zx_get_wavedtl_findate(decode(a.comefrom,1,a.sourceid,0)) wavedtlfindate,--wms转入的运输任务单
       f.dispatchid,
       f.dispatchtype,
       f.dispatchdate discredate,
       f.vehicleid,
       f.vehicleno,
       f.driverid,
       f.drivername,
       f.driver2id,
       f.driver2name,
       a.dispatchdate,
       a.signflag,
       a.signdate
  from tms_tr_doc            a,
       tpl_warehouse         b,
       tpl_goodsowner        c,
       wms_tr_route          d,
       wms_transport_address e,
       tms_dispatch_doc_xm_v f,
       tpl_go_company        g
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.routeid = d.routeid(+)
   and a.transid = e.transid(+)
   and a.dispatchid=f.dispatchid(+)
   and a.warehid=1
   and a.gcompanyid=g.companyid(+)
   and a.credate>to_date('2019-01-01','yyyy-mm-dd')
"
"TMS_VEHICLE_GAS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_VEHICLE_GAS_V"" (""GASID"", ""WAREHID"", ""VEHICLEID"", ""VEHICLENO"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANOPCODE"", ""EMPLOYEENAME"", ""GASDATE"", ""GASSTATION"", ""GASVOLUMN"", ""GASMANID"", ""GASMANOPCODE"", ""GASMANNAME"", ""MEMO"", ""DISTANCE"", ""FEEAMT"", ""BACTERINFLAG"") AS 
  select a.GASID,
       a.WAREHID,
       a.VEHICLEID,
       d.vehicleno,
       a.CREDATE,
       a.INPUTMANID,
       c.opcode inputmanopcode,
       c.employeename,
       a.GASDATE,
       a.GASSTATION,
       a.GASVOLUMN,
       a.GASMANID,
       b.opcode gasmanopcode,
       b.drivername gasmanname,
       a.MEMO,
       a.distance,
       a.feeamt,
       d.bacterinflag
  from tms_vehicle_gas a,
       tms_driver b,
       pub_employee c,
       tms_luyan_vehicle_v  d
       where a.gasmanid =b.driverid(+)
       and a.inputmanid = c.employeeid(+)
       and a.vehicleid=d.vehicleid(+)
"
"TMS_VEHICLE_MAINTAIN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_VEHICLE_MAINTAIN_V"" (""MAINTAINID"", ""WAREHID"", ""VEHICLEID"", ""VEHICLENO"", ""CREDATE"", ""INPUTMANID"", ""DRIVERID"", ""DRIVERNAME"", ""INPUTMANOPCODE"", ""EMPLOYEENAME"", ""STARTDATE"", ""ENDDATE"", ""FEEAMT"", ""CONTENT"", ""MEMO"", ""BACTERINFLAG"", ""WAREHNAME"", ""VEHICLETYPEID"") AS 
  select a.""MAINTAINID"",
       a.""WAREHID"",
       a.""VEHICLEID"",
       c.vehicleno,
       a.""CREDATE"",
       a.""INPUTMANID"",
       a.driverId,
       d.driverName,
       b.opcode INPUTMANopcode,
       b.employeename,
       a.""STARTDATE"",
       a.""ENDDATE"",
       a.""FEEAMT"",
       a.""CONTENT"",
       a.""MEMO"",
       c.bacterinflag,
       e.warehname,
       c.vehicletypeid
  from tms_vehicle_maintain a,
       pub_employee b,
       tms_luyan_vehicle_v c,
       tms_driver d,
       tpl_warehouse e
  where a.inputmanid = b.employeeid(+)
    and a.vehicleid=c.vehicleid(+)
    and a.driverId=d.driverId(+)
    and a.warehid=e.warehid(+)
"
"TMS_VEHICLE_RECORD_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_VEHICLE_RECORD_V"" (""RECORDID"", ""WAREHID"", ""WAREHNAME"", ""CREDATE"", ""DISPATCHDATE"", ""DISPATCHMANID"", ""DISPATCHMAN"", ""SELFTRANSTYPE"", ""TRCOMPANYID"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""RETURNDATE"", ""REALDISTANCE"", ""REALGAS"", ""VEHICLEID"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVERNAME2"", ""ROUTEID"", ""ROUTENAME"", ""INTOWNFLAG"", ""USESTATUS"", ""BACKDESCR"", ""SOURCEID"", ""MEMO"") AS 
  select a.recordid,
       a.warehid,
       b.warehname,
       a.credate,
       a.dispatchdate,
       a.dispatchmanid,
       d.employeename dispatchman,
       a.selftranstype,
       a.trcompanyid,
       e.companyopcode,
       e.companyname,
       a.returndate,
       a.realdistance,
       a.realgas,
       a.vehicleid,
       f.vehicleno,
       a.driverid,
       h.drivername,
       a.driver2id,
       i.drivername drivername2,
       a.routeid,
       j.routename,
       j.intownflag,
       a.usestatus,
       a.backdescr,
       a.sourceid,
       a.memo
  from tms_vehicle_record a,
       tpl_warehouse    b,
       pub_employee     d,
       tpl_pub_company  e,
       tms_vehicle      f,
       tms_driver       h,
       tms_driver       i,
       wms_tr_route     j
 where a.warehid = b.warehid
   and a.dispatchmanid = d.employeeid(+)
   and a.trcompanyid = e.companyid(+)
   and a.vehicleid = f.vehicleid(+)
   and a.driverid = h.driverid(+)
   and a.driver2id = i.driverid(+)
   and a.routeid = j.routeid(+)
"
"TMS_VEHICLE_TYPE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_VEHICLE_TYPE_V"" (""VEHICLETYPEID"", ""VEHICLETYPENO"", ""VEHICLETYPE"", ""VEHICLEMODEL"", ""LENGTH"", ""WIDTH"", ""HEIGHT"", ""LOAD"", ""VOLUMN"", ""ESTIMATEPACKS"", ""USAGERATIO"", ""ENGINEPOWER"", ""FUEL"", ""GASPER"", ""MEMO"") AS 
  SELECT A.VEHICLETYPEID,
       A.VEHICLETYPENO,
       A.VEHICLETYPE,
       A.VEHICLEMODEL,
       A.LENGTH,
       A.WIDTH,
       A.HEIGHT,
       A.LOAD,
       A.VOLUMN,
       A.ESTIMATEPACKS,
       A.USAGERATIO,
       A.ENGINEPOWER,
       A.FUEL,
       A.GASPER,
       A.MEMO
  FROM TMS_VEHICLE_TYPE A

 "
"TMS_VEHICLE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TMS_VEHICLE_V"" (""WAREHID"", ""WAREHNAME"", ""VEHICLEID"", ""VEHICLENO"", ""TRCOMPANYID"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""VEHICLETYPEID"", ""VEHICLETYPENO"", ""VEHICLETYPE"", ""VEHICLEMODEL"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVERNAMEOPCODE"", ""DRIVER2ID"", ""DRIVER2NAME"", ""BUYDATE"", ""DISPATCHDATE"", ""LASTCHECKDATE"", ""CHECKPERIOD"", ""GPSNO"", ""BASALDISCNO"", ""ENGINENO"", ""OWNER"", ""USESTATUS"", ""MEMO"", ""SIMNO"", ""BACTERINFLAG"") AS 
  select a.warehid,
       c.warehname,
       a.vehicleid,
       a.vehicleno,
       a.trcompanyid,
       f.companyopcode,
       f.companyname,
       a.vehicletypeid,
       e.vehicletypeno,
       e.vehicletype,
       e.vehiclemodel,
       a.driverid,
       b.drivername,
       b.opcode drivernameopcode,
       a.driver2id,
       d.drivername driver2name,
       a.buydate,
       a.dispatchdate,
       a.lastcheckdate,
       a.checkperiod,
       a.gpsno,
       a.basaldiscno,
       a.engineno,
       a.owner,
       a.usestatus,
       a.memo,
       a.simno, --add by llq 18.9.177
       nvl(a.bacterinflag,0) bacterinflag--疫苗标志
  from tms_vehicle a,
       tms_driver b,
       tpl_warehouse c,
       tms_driver d,
       tms_vehicle_type e,
       tpl_pub_company f
 where a.warehid = c.warehid
   and a.driverid = b.driverid(+)
   and a.driver2id = d.driverid(+)
   and a.vehicletypeid = e.vehicletypeid(+)
   and a.trcompanyid = f.companyid(+)
"
"TPLA_BAONUO_T320_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_BAONUO_T320_V"" (""GOODSOWNERID"", ""LORDERID"", ""PORDERID"", ""OPERATIONTYPE"", ""OPSTATUS"", ""ARRIVEDATE"", ""PUTUPDATE"", ""SOURCECOMPANYID"", ""COMPANYSTYLE"", ""DTLLINES"", ""MEMO"", ""LORDERDTLID"", ""PORDERDTLID"", ""SRCDTLNO"", ""GOODSID"", ""STORAGEID"", ""GOODSNAME"", ""PACKNAME"", ""PACKSIZE"", ""PACKUNIT"", ""BATCHNO"", ""LOTNO"", ""VALIDDATE"", ""PRDDATE"", ""APPROVEDOCNO"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""SUPPLYNAME"", ""GOODSTATUS"", ""QUANSTATUS"", ""TRADEPACK"", ""REALRECVQTY"", ""TINYID"", ""TINYQTY"", ""DTLMEMO"", ""MEDCHKRPTNO"", ""CHECKDATE"", ""CHECKMANA"", ""CHECKMANB"", ""TRANSTEMP"", ""IMPORTREPFLAG"", ""PASSGATEFLAG"", ""REGISTEFLAG"", ""MEDCHECKFLAG"", ""ELIGIBILITYFLAG"", ""IMPREGNO"", ""RPTNO"", ""BACKWHYID"", ""CHECKMAN1"", ""CHECKMAN2"", ""REGISTNO"", ""SECTIONID"", ""PRINTMONTHFLAG"", ""MAH"") AS 
  select a.GoodsOwnerId, --1  货主ID
       a.inid Lorderid, --2  平台入库订单号
       a.zxcolumn4 PorderId, --3  货主入库订单总单ID
       i.ddlid OperationType, --4  业务类型
     /*  a.operationtype,*/
       decode(a.usestatus, 3, 1, 2) OPSTATUS, --5  业务状态
       max(b.ArriveDate) ArriveDate, --6  收货时间      --to_char(a.ArriveDate,'yyyy-mm-dd hh24:mi:ss') ArriveDate,--6  收货时间 20080707Arivedate取细单
       max(c.keepdate) PutupDate, --7  上架时间
       g.gcompanyid SourceCompanyId, --8  来货单位ID
       g.CompanyStyle, --9  单位类型
       a.DtlLines, --10  细目条数
       a.Memo, --11  总单备注
       b.indtlid LorderDtlId, --12  平台入库订单细单ID
       b.dtlzxcolumn4 PorderDtlId, --13  货主入库订单细单ID
       b.srcdtlno SrcDtlNo, --14  原业务细单ID
       d.goodsownid GoodsId, --15  货主货品ID
       j.zxcolumn1 StorageId, --16  货主仓别
       d.goodsname GoodsName, --17  品名
       d1.PackName, --18  包装名称
       d1.PackSize, --19  包装大小
       b.tradegoodspack PackUnit, --20  基本单位
       0 BatchNo, --21  批次
       e.LotNo, --22  批号
       e.ValidDate ValidDate, --23  效期
       e.proddate Prddate, --24  生产日期
       e.ApproveDocNo, --25  批准文号
       d.GoodsType, --26  规格
       d.ProdArea, --27  产地
       --d.FactName, --28  生产厂家
       e.factname,--批号生产厂家 add by wanghuaiyu 2013年7月25日 19:07:57
       g.companyname Supplyname, --29  供应商名称
       f.goodsstatusid goodstatus,
       aa.goquantityid quanstatus,
       b.tradegoodspack TradePack, --32  交易单位
       sum(c.goodsqty)  RealRecvQty, --33  实收数量
       0                TinyId, --34  平台入库订单明细Id
       null             TinyQty, --35  物流入库订单明细数量
       b.memo dtlmemo, --36  细单备注
       '' Medchkrptno, --37  药检报告号
       b.checkdate, --38 检验日期
       b.checkmanA, --39 验收员A
       b.checkmanB, --40 验收员B
       b.Transtemp, -- 运输温度linwc 2009-9-16
       b.Importrepflag, --  进口报告单
       b.Passgateflag, -- 通关单
       b.Registeflag, --  注册证
       b.medcheckflag, -- 药检证标志
       b.eligibilityflag, --  合格证标志
       b.impregno, -- 进口注册证号
       b.rptno, --  岸检验报告编号
       b.backwhyid, --  退货原因
       b.checkman1, --  验收员A
       b.Checkman2, --  验收员B
       b.registno,--批号上的注册号
       null sectionid, --分区id
       --c.goodsqty,
       e.printmonthflag, -- 打印精确到月
       e.mah
  from tpl_in_order        a,
       tpl_in_order_dtl    b,
       tpl_goods           d,
       tpl_pub_goods_packs d1,
       tpl_go_company        g,
       tpl_edi_queue     h,
       tpl_owner_ddl_def     i,
       tpl_st_io_doc c,
       wms_goods_lot e,
       wms_goodsstatus f,
       tpl_purchase_order j,
       tpl_owner_quanstatus_def aa
 where a.inid = b.inid
   and a.sourcecompanyid = g.companyid
   and b.ownergoodsid = d.ownergoodsid
   and c.goodspackid = d1.goodspackid(+)
   and a.usestatus = 3
   and b.porderstatus <> 0
   and h.srcid = a.inid
   and nvl(h.expflag, 0) = 0
   and h.queuetype = 1
   and 'OWNER_OPERATION' = i.keyword
   and a.operationtype = i.dicid
   and a.goodsownerid = i.goodsownerid
   and a.inid=c.orderid
   and b.indtlid=c.orderdtlid
   and c.comefrom=1
   and c.lotid=e.lotid
  and c.goodsstatusid = f.goodsstatusid
  and a.oldid = j.porderid
  and a.goodsownerid=aa.goodsownerid
  and f.quantitystatus=aa.quantityid
  and j.billfrom = 3 --只有数据传输的才回传 Dempsey 2011/05/04;
  and nvl(j.nowlflag,0) <> 1
  group by a.GoodsOwnerId, --1  货主ID
       a.inid , --2  平台入库订单号
       a.zxcolumn4 , --3  货主入库订单总单ID
       i.ddlid , --4  业务类型
       decode(a.usestatus, 3, 1, 2) , --5  业务状态
       g.gcompanyid, --8  来货单位ID
       g.CompanyStyle, --9  单位类型
       a.DtlLines, --10  细目条数
       a.Memo, --11  总单备注
       b.indtlid, --12  平台入库订单细单ID
       b.dtlzxcolumn4, --13  货主入库订单细单ID
       b.srcdtlno, --14  原业务细单ID
       d.goodsownid, --15  货主货品ID
       j.zxcolumn1, --16  货主仓别
       d.goodsname, --17  品名
       d1.PackName, --18  包装名称
       d1.PackSize, --19  包装大小
       b.tradegoodspack , --20  基本单位
       e.LotNo, --22  批号
       e.ValidDate, --23  效期
       e.proddate , --24  生产日期
       e.ApproveDocNo, --25  批准文号
       d.GoodsType, --26  规格
       d.ProdArea, --27  产地
       e.factname,--批号生产厂家 add by wanghuaiyu 2013年7月25日 19:07:57
       g.companyname, --29  供应商名称
       f.goodsstatusid,
       aa.goquantityid,
       b.tradegoodspack , --32  交易单位
       b.memo , --36  细单备注
       b.checkdate, --38 检验日期
       b.checkmanA, --39 验收员A
       b.checkmanB, --40 验收员B
       b.Transtemp, -- 运输温度linwc 2009-9-16
       b.Importrepflag, --  进口报告单
       b.Passgateflag, -- 通关单
       b.Registeflag, --  注册证
       b.medcheckflag, -- 药检证标志
       b.eligibilityflag, --  合格证标志
       b.impregno, -- 进口注册证号
       b.rptno, --  岸检验报告编号
       b.backwhyid, --  退货原因
       b.checkman1, --  验收员A
       b.Checkman2, --  验收员B
       b.registno,--批号上的注册号
       e.printmonthflag, -- 打印精确到月
       e.mah
"
"TPLA_BAONUO_T340_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_BAONUO_T340_V"" (""GOODSOWNERID"", ""EXPORDERID"", ""OPERATIONTYPE"", ""PREEXPDATE"", ""PREARRIVEDATE"", ""TRANSNO"", ""EXPDATE"", ""SRCEXPNO"", ""LINENO"", ""OPSTATUS"", ""TTRANSMODE"", ""DETAILLINES"", ""GCOMPANYID"", ""EXPORTMEMO"", ""SRCEXPDTLNO"", ""EXPORDERDTLID"", ""GOODSID"", ""GOSTOCKID"", ""BATCHNO"", ""LOTNO"", ""VALIDDATE"", ""PRDDATE"", ""GOODSTATUS"", ""QUANSTATUS"", ""APPROVEDOCNO"", ""TRADEGOODSPACK"", ""GOODSQTY"", ""TRADEGOODSQTY"", ""EXPDTLMEMO"", ""PACKSIZE"", ""STATUS"", ""WMSSCATTERFINPACKS"", ""WMSWHOLEFINPACKS"") AS 
  select
	a.GOODSOWNERID	,--	1	:1:2ID
	a.otherid EXPORDERID	,--	2	:3:4:5:6ID
  --a.otherid old_outid,
  j.ddlid OPERATIONTYPE	,--	5	:7:8:9:10
  a.PREEXPDATE PREEXPDATE,--	7	:11:12:13:14:15
	a.PREARRIVEDATE PREARRIVEDATE,--	8	:16:17:18:19:20
  a.transno TRANSNO	,--	10
  a.EXPDATE	EXPDATE,--	11	:21:22:23:24:25:26
	a.zxcolumn4 SRCEXPNO	,--	3	:27:28:29:30:31:32:33:34ID
  80000000+a.wavedtlid Lineno	,
	decode(a.usestatus,2,1,2) OPSTATUS	,--	6	:35:36:37:38
	i.gotransid TTRANSMODE	,--	9	:39:40:41:42:43
	--a.Reccompanyid,缺
	a.DETAILLINES	,--	13	:44:45:46:47
	g.GCOMPANYID	,--	12	:48:49:50:51:52:53ID
	a.EXPORTMEMO	,--	14	:54:55:56:57
	--b.SRCEXPDTLNO	,--	15	:58:59:60:61:62:63ID
  b.dtlzxcolumn4 srcexpdtlno,
	b.outdtlid EXPORDERDTLID	,--	16	:64:65:66:67:68:69:70:71ID
	d.goodsownid GOODSID	,--	17	:72:73:74:75ID
	null GOSTOCKID	,--	18	:76:77:78:79ID
	b.BATCHNO	,--	19	:80:81
	b.LOTNO	,--	20	:82:83
	b.VALIDDATE VALIDDATE,--	21	:84:85
	b.proddate prddate	,--	22	:86:87:88:89
	e.gostatusid Goodstatus	,--	23	:90:91:92:93
	e1.goquantityid	quanstatus,--	24	:94:95:96:97:98:99ID
	d.Approvedocno	,--	25	:100:101:102:103
  --d.registdocno registno, --26 :104:105:106:107
	b.TRADEGOODSPACK	,--	27	:108:109:110:111
	b.Realqty	goodsqty,--	28	:112:113:114:115
	b.tRADEGOODSQTY	,--	29	:116:117:118:119:120:121
	b.EXPDTLMEMO	,--	30	:122:123:124:125
	d.PACKSIZE	,--	31	:126:127:128:129
	1	STATUS,	--	32	:130:131:132:133:134:135
  k.scatterfinpacks,
  k.wholefinpacks
From
	wms_out_order a,
	wms_out_order_dtl  b,
	tpl_goods d,
	tpl_pub_goods_packs d1,
	tpl_owner_goodsstatus_def e,
  tpl_owner_quanstatus_def e1,
  wms_goodsstatus f,
	tpl_go_company g    ,
	tpl_edi_queue h,
	tpl_owner_trans_def i,
 	tpl_owner_ddl_def j,
  wms_wave_dtl k,
  tpl_export_order aa
Where	a.outid = b.outid
	and a.reccompanyid = g.companyid
	and b.ownergoodsid = d.ownergoodsid
	and b.goodspackid = d1.goodspackid
  and b.goodsstatusid = f.goodsstatusid
  and a.goodsownerid=e.goodsownerid
  and f.goodsstatusid = e.goodsstatusid
  and f.quantitystatus = e1.quantityid
  and a.goodsownerid=e1.goodsownerid
  and a.oldid=aa.exporderid(+)
	and (a.transmodeid = i.transportid(+)   	and a.goodsownerid = i.goodsownerid(+) )
	and a.usestatus = 4
	and h.srcid = a.otherid
	and nvl(h.expflag,0) = 0
  and h.queuetype = 2
	and 'OWNER_OPERATION' = j.keyword
 	and a.operationtype = j.dicid
 	and a.goodsownerid = j.goodsownerid
  AND a.wavedtlid = k.wavedtlid(+)
  and b.usestatus=5
  and a.operationtype <> 21 --把报损的去掉
Order by a.outid
"
"TPLA_BAONUO_T350_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_BAONUO_T350_V"" (""GOODSOWNERID"", ""CREDATE"", ""JOBFLAG"", ""OPERATIONTYPE"", ""JOBID"", ""JOBDTLID"", ""STATUS"", ""MEMO"", ""CANCELID"") AS 
  select a.GoodsOwnerId, -- 1 :1:2ID  Varchar2(12)
       a.canceldate CreDate, -- 2 :3:4:5:6  Date
       a.jobtype Jobflag, --  3 :7:8:9:10:11:12:13  Number(2,0)
       a.operationtype, --  4 :14:15:16:17:18:19  Number(2,0)
       case when substr(to_char(a.oldid),1,4) ='1000' then 'GJDJ'||substr(to_char(a.oldid),5,length(to_char(a.oldid))-8)
       else to_char(a.oldid) end jobid,
       --to_char(a.oldid) Jobid, --  5 :20:21:22:23ERP:24:25 Varchar2(20)
       to_char(to_number(substr(to_char(a.oldid),-1,4))) Jobdtlid, --  6 ERP:26:27:28  Varchar2(20)
       a.jobcancelstatus STATUS, -- 7 :29:30:31:32:33:34  Number(2,0)
       a.canmemo Memo, -- 8 :35:36:37:38:39:40  Varchar2(100)
       a.CANCELID
  from wms_cancel_job_lst a, tpl_edi_queue h
 where a.cancelid = h.srcid
   and nvl(h.expflag, 0) = 0
   and a.goodsownerid = 520
   and h.queuetype = 4
   and a.operationtype=1

union all

--2.销售的取消
select a.GoodsOwnerId, -- 1 :1:2ID  Varchar2(12)
       a.canceldate CreDate, -- 2 :3:4:5:6  Date
       a.jobtype Jobflag, --  3 :7:8:9:10:11:12:13  Number(2,0)
       a.operationtype, --  4 :14:15:16:17:18:19  Number(2,0)
       b.zxcolumn4 jobid,
       to_char(to_number(substr(to_char(a.olddtlid),-1,4))) Jobdtlid, --  6 ERP:26:27:28  Varchar2(20)
       a.jobcancelstatus STATUS, -- 7 :29:30:31:32:33:34  Number(2,0)
       a.canmemo Memo, -- 8 :35:36:37:38:39:40  Varchar2(100)
       a.CANCELID
  from wms_cancel_job_lst a, tpl_edi_queue h,tpl_export_order b
 where a.cancelid = h.srcid
   and nvl(h.expflag, 0) = 0
   and a.goodsownerid = 520
   and h.queuetype = 4
   and b.goodsownerid=520
   and a.operationtype=11
   and a.oldid = b.trdtlid(+)

union all

--3.销退取消
select a.GoodsOwnerId, -- 1 :1:2ID  Varchar2(12)
       a.canceldate CreDate, -- 2 :3:4:5:6  Date
       a.jobtype Jobflag, --  3 :7:8:9:10:11:12:13  Number(2,0)
       a.operationtype, --  4 :14:15:16:17:18:19  Number(2,0)
       case when substr(to_char(a.oldid),1,4) ='4000' then 'XHTH'||substr(to_char(a.oldid),5,length(to_char(a.oldid))-8)
       else to_char(a.oldid) end jobid,
       --to_char(a.oldid) Jobid, --  5 :20:21:22:23ERP:24:25 Varchar2(20)
       to_char(to_number(substr(to_char(a.oldid),-1,4))) Jobdtlid, --  6 ERP:26:27:28  Varchar2(20)
       a.jobcancelstatus STATUS, -- 7 :29:30:31:32:33:34  Number(2,0)
       a.canmemo Memo, -- 8 :35:36:37:38:39:40  Varchar2(100)
       a.CANCELID
  from wms_cancel_job_lst a, tpl_edi_queue h
 where a.cancelid = h.srcid
   and nvl(h.expflag, 0) = 0
   and a.goodsownerid = 520
   and h.queuetype = 4
   and a.operationtype=7
"
"TPLA_EDI_T320_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_EDI_T320_V"" (""GOODSOWNERID"", ""LORDERID"", ""PORDERID"", ""OPERATIONTYPE"", ""OPSTATUS"", ""ARRIVEDATE"", ""PUTUPDATE"", ""SOURCECOMPANYID"", ""COMPANYSTYLE"", ""DTLLINES"", ""MEMO"", ""LORDERDTLID"", ""PORDERDTLID"", ""SRCDTLNO"", ""GOODSID"", ""STORAGEID"", ""GOODSNAME"", ""PACKNAME"", ""PACKSIZE"", ""PACKUNIT"", ""BATCHNO"", ""LOTNO"", ""VALIDDATE"", ""PRDDATE"", ""APPROVEDOCNO"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""SUPPLYNAME"", ""GOODSTATUS"", ""QUANSTATUS"", ""TRADEPACK"", ""REALRECVQTY"", ""TINYID"", ""TINYQTY"", ""DTLMEMO"", ""MEDCHKRPTNO"", ""CHECKDATE"", ""CHECKMANA"", ""CHECKMANB"", ""TRANSTEMP"", ""IMPORTREPFLAG"", ""PASSGATEFLAG"", ""REGISTEFLAG"", ""MEDCHECKFLAG"", ""ELIGIBILITYFLAG"", ""IMPREGNO"", ""RPTNO"", ""BACKWHYID"", ""CHECKMAN1"", ""CHECKMAN2"", ""REGISTNO"", ""SECTIONID"", ""PRINTMONTHFLAG"", ""INVNO"", ""INVCODE"", ""INVDATE"", ""MAH"", ""PRINTEXPIREFLAG"", ""VALIDDATE2"", ""PRODMONTHFLAG"") AS 
  select /*+ leading(a,h) */
       a.GoodsOwnerId, --1  货主ID
       a.inid Lorderid, --2  平台入库订单号
       a.SRCNO PorderId, --3  货主入库订单总单ID
       i.ddlid OperationType, --4  业务类型
       /*  a.operationtype,*/
       decode(a.usestatus, 3, 1, 2) OPSTATUS, --5  业务状态
       b.ArriveDate ArriveDate, --6  收货时间      --to_char(a.ArriveDate,'yyyy-mm-dd hh24:mi:ss') ArriveDate,--6  收货时间 20080707Arivedate取细单
       c.keepdate PutupDate, --7  上架时间
       g.gcompanyid SourceCompanyId, --8  来货单位ID
       g.CompanyStyle, --9  单位类型
       a.DtlLines, --10  细目条数
       a.Memo, --11  总单备注
       c.inoutid LorderDtlId, --12  平台入库订单细单ID
       b.srcdtlno PorderDtlId, --13  货主入库订单细单ID
       b.srcdtlno SrcDtlNo, --14  原业务细单ID
       d.goodsownid GoodsId, --15  货主货品ID
       j.zxcolumn1 StorageId, --16  货主仓别
       d.goodsname GoodsName, --17  品名
       d1.PackName, --18  包装名称
       d1.PackSize, --19  包装大小
       d.tradepackname PackUnit, --20  基本单位
       c.BatchNo, --21  批次
       e.LotNo, --22  批号
       e.ValidDate ValidDate, --23  效期
       e.proddate Prddate, --24  生产日期
       e.ApproveDocNo, --25  批准文号
       d.GoodsType, --26  规格
       d.ProdArea, --27  产地
       --d.FactName, --28  生产厂家
       e.factname, --批号生产厂家 add by wanghuaiyu 2013年7月25日 19:07:57
       g.companyname Supplyname, --29  供应商名称
       f.goodsstatusid goodstatus,
       aa.goquantityid quanstatus,
       b.tradegoodspack TradePack, --32  交易单位
       c.goodsqty RealRecvQty, --33  实收数量
       0 TinyId, --34  平台入库订单明细Id
       null TinyQty, --35  物流入库订单明细数量
       b.memo dtlmemo, --36  细单备注
       '' Medchkrptno, --37  药检报告号
       b.checkdate, --38 检验日期
       b.checkmanA, --39 验收员A
       b.checkmanB, --40 验收员B
       b.Transtemp, -- 运输温度linwc 2009-9-16
       b.Importrepflag, --  进口报告单
       b.Passgateflag, -- 通关单
       b.Registeflag, --  注册证
       b.medcheckflag, -- 药检证标志
       b.eligibilityflag, --  合格证标志
       b.impregno, -- 进口注册证号
       b.rptno, --  岸检验报告编号
       b.backwhyid, --  退货原因
       b.checkman1, --  验收员A
       b.Checkman2, --  验收员B
       b.registno, --批号上的注册号
       c.sectionid, --分区id
       --c.goodsqty,
       e.printmonthflag, -- 打印精确到月
       substr(zx_get_t320_invno(a.goodsownerid, b.indtlid),0,100) invno, --只反馈中宏 add by xyue 2019-07-01
       zx_get_t320_invcode(a.goodsownerid, b.indtlid) invcode,--add by xyue 2019-07-01
       zx_get_t320_invdate(a.goodsownerid, b.indtlid) invdate,--add by xyue 2019-07-01
       e.mah, --add by xyue 2020-01-03
       e.printexpireflag, --add by xyue 2020-11-10
       e.validdate2,
       e.prodmonthflag
  from tpl_in_order             a,
       tpl_in_order_dtl         b,
       tpl_goods                d,
       tpl_pub_goods_packs      d1,
       tpl_go_company           g,
       tpl_edi_queue            h,
       tpl_owner_ddl_def        i,
       tpl_st_io_doc            c,
       wms_goods_lot            e,
       wms_goodsstatus          f,
       tpl_purchase_order       j,
       tpl_owner_quanstatus_def aa
 where a.inid = b.inid
   and a.sourcecompanyid = g.companyid
   and b.ownergoodsid = d.ownergoodsid
   and c.goodspackid = d1.goodspackid(+)
   and a.usestatus = 3
   and b.porderstatus <> 0
   and h.srcid = a.inid
   and nvl(h.expflag, 0) = 0
   and h.queuetype = 1
   and 'OWNER_OPERATION' = i.keyword
   and a.operationtype = i.dicid
   and a.goodsownerid = i.goodsownerid
   and a.inid = c.orderid
   and b.indtlid = c.orderdtlid
   and c.comefrom = 1
   and c.lotid = e.lotid
   and c.goodsstatusid = f.goodsstatusid
   and a.oldid = j.porderid
   and a.goodsownerid = aa.goodsownerid
   and f.quantitystatus = aa.quantityid
   and j.billfrom = 3 --只有数据传输的才回传 Dempsey 2011/05/04;
   --and nvl(j.nowlflag, 0) <> 1 --目前全系统都是等于0
/*union all
select a.GoodsOwnerId, --1  货主ID
       a.inid Lorderid, --2  平台入库订单号
       a.SRCNO PorderId, --3  货主入库订单总单ID
       i.ddlid OperationType, --4  业务类型
       \*  a.operationtype,*\
       decode(a.usestatus, 3, 1, 2) OPSTATUS, --5  业务状态
       b.ArriveDate ArriveDate, --6  收货时间      --to_char(a.ArriveDate,'yyyy-mm-dd hh24:mi:ss') ArriveDate,--6  收货时间 20080707Arivedate取细单
       sysdate PutupDate, --7  上架时间
       g.gcompanyid SourceCompanyId, --8  来货单位ID
       g.CompanyStyle, --9  单位类型
       a.DtlLines, --10  细目条数
       a.Memo, --11  总单备注
       c.receiveid LorderDtlId, --12  平台入库订单细单ID
       b.srcdtlno PorderDtlId, --13  货主入库订单细单ID
       b.srcdtlno SrcDtlNo, --14  原业务细单ID
       d.goodsownid GoodsId, --15  货主货品ID
       t.zxcolumn1 StorageId, --16  货主仓别
       d.goodsname GoodsName, --17  品名
       d1.PackName, --18  包装名称
       d1.PackSize, --19  包装大小
       d.tradepackname PackUnit, --20  基本单位
       --d.tradepackname PackUnit,--20  基本单位,change by xyue 2019-03-11
       c.BatchNo, --21  批次
       \*c.LotNo, --22  批号
              c.ValidDate ValidDate, --23  效期
              c.proddate Prddate, --24  生产日期
              c.ApproveDocNo, --25  批准文号*\
       e.LotNo, --22  批号
       e.ValidDate ValidDate, --23  效期
       e.proddate Prddate, --24  生产日期
       e.ApproveDocNo, --25  批准文号
       d.GoodsType, --26  规格
       d.ProdArea, --27  产地
       --d.FactName, --28  生产厂家
       e.factname, --批号生产厂家 add by wanghuaiyu 2013年7月25日 19:08:53
       g.companyname Supplyname, --29  供应商名称
       f.goodsstatusid goodstatus,
       aa.goquantityid quanstatus,
       b.tradegoodspack TradePack, --32  交易单位
       c.goodsqty RealRecvQty, --33  实收数量
       0 TinyId, --34  平台入库订单明细Id
       null TinyQty, --35  物流入库订单明细数量
       b.memo dtlmemo, --36  细单备注
       '' Medchkrptno, --37  药检报告号
       b.checkdate, --38 检验日期
       b.checkmanA, --39 验收员A
       b.checkmanB, --40 验收员B
       b.Transtemp, -- 运输温度linwc 2009-9-16
       b.Importrepflag, --  进口报告单
       b.Passgateflag, -- 通关单
       b.Registeflag, --  注册证
       b.medcheckflag, -- 药检证标志
       b.eligibilityflag, --  合格证标志
       b.impregno, -- 进口注册证号
       b.rptno, --  岸检验报告编号
       b.backwhyid, --  退货原因
       b.checkman1, --  验收员A
       b.Checkman2, --  验收员B
       b.registno, --批号上的注册号
       c.sectionid, --分区id
       --c.goodsqty
       e.printmonthflag, -- 打印精确到月
       null invno,
       null invcode,
       null invdate,
       e.mah, --add by xyue 2020-01-03
       e.printexpireflag, --add by xyue 2020-11-10
       e.validdate2
  from tpl_in_order             a,
       tpl_in_order_dtl         b,
       tpl_goods                d,
       tpl_pub_goods_packs      d1,
       tpl_go_company           g,
       tpl_edi_queue            h,
       tpl_owner_ddl_def        i,
       wms_receive_dtl          c,
       wms_goods_lot            e,
       wms_goodsstatus          f,
       wms_in_order_dtl         j,
       tpl_owner_quanstatus_def aa,
       tpl_purchase_order       t
 where a.inid = b.inid
   and a.sourcecompanyid = g.companyid
   and b.ownergoodsid = d.ownergoodsid
   and b.indtlid = j.otherid
   and j.indtlid = c.indtlid
   and c.goodspackid = d1.goodspackid(+)
   and a.usestatus = 3
   and b.porderstatus <> 0
   and h.srcid = a.inid
   and nvl(h.expflag, 0) = 0
   and h.queuetype = 1
   and 'OWNER_OPERATION' = i.keyword
   and a.operationtype = i.dicid
   and a.goodsownerid = i.goodsownerid
   and c.lotid = e.lotid
   and c.goodsstatusid = f.goodsstatusid
   and a.goodsownerid = aa.goodsownerid
   and f.quantitystatus = aa.quantityid
   and a.oldid = t.porderid
   and t.billfrom = 3 --只有数据传输的才回传 Dempsey 2011/05/04;
   and nvl(t.nowlflag, 0) = 1*/
/*union all
\*货品状态为【当场拒收】的 xyue 2014-05-19*\
select t4.goodsownerid, --1货主ID
       t4.inid Lorderid, --2  平台入库订单号
       t4.SRCNO PorderId, --3  货主入库订单总单ID
       t9.ddlid OperationType, --4  业务类型
       decode(t4.usestatus, 3, 1, 2) OPSTATUS, --5  业务状态
       t3.ArriveDate ArriveDate, --6  收货时间
       sysdate PutupDate, --7  上架时间
       t8.gcompanyid SourceCompanyId, --8  来货单位ID
       t8.CompanyStyle, --9  单位类型
       t4.DtlLines, --10  细目条数
       t4.Memo, --11  总单备注
       t1.receiveid LorderDtlId, --12  平台入库订单细单ID
       t3.srcdtlno PorderDtlId, --13  货主入库订单细单ID
       t3.srcdtlno SrcDtlNo, --14  原业务细单ID
       t6.goodsownid GoodsId, --15  货主货品ID
       t5.zxcolumn1 StorageId, --16  货主仓别
       t6.goodsname GoodsName, --17  品名
       t7.PackName, --18  包装名称
       t7.PackSize, --19  包装大小
       t3.tradegoodspack PackUnit, --20  基本单位
       --t6.tradepackname PackUnit,--20  基本单位,change by xyue 2019-03-11
       t1.BatchNo, --21  批次
       t1.LotNo, --22  批号
       t1.ValidDate, --23  效期
       t1.proddate Prddate, --24  生产日期
       t1.ApproveDocNo, --25  批准文号
       t6.GoodsType, --26  规格
       t6.ProdArea, --27  产地
       --t6.FactName, --28  生产厂家
       t13.factname, --批号生产厂家 add by wanghuaiyu 2013年7月25日 19:09:34
       t8.companyname Supplyname, --29  供应商名称
       t10.goodsstatusid goodstatus,
       t11.goquantityid quanstatus,
       t3.tradegoodspack TradePack, --32  交易单位
       t1.goodsqty RealRecvQty, --33  实收数量
       0 TinyId, --34  平台入库订单明细Id
       null TinyQty, --35  物流入库订单明细数量
       t3.memo dtlmemo, --36  细单备注
       null Medchkrptno, --37  药检报告号
       t3.checkdate, --38 检验日期
       t3.checkmanA, --39 验收员A
       t3.checkmanB, --40 验收员B
       t3.Transtemp, -- 运输温度linwc 2009-9-16
       t3.Importrepflag, --  进口报告单
       t3.Passgateflag, -- 通关单
       t3.Registeflag, --  注册证
       t3.medcheckflag, -- 药检证标志
       t3.eligibilityflag, --  合格证标志
       t3.impregno, -- 进口注册证号
       t3.rptno, --  岸检验报告编号
       t3.backwhyid, --  退货原因
       t3.checkman1, --  验收员A
       t3.Checkman2, --  验收员B
       t3.registno, --批号上的注册号
       t1.sectionid, --分区id
       t13.printmonthflag, --打印精确到月
       null invno,
       null invcode,
       null invdate,
       t13.mah, --add by xyue 2020-01-03
       t13.printexpireflag, --add by xyue 2020-11-10
       t13.validdate2
  from wms_receive_dtl          t1,
       wms_in_order_dtl         t2,
       tpl_in_order_dtl         t3,
       tpl_in_order             t4,
       tpl_purchase_order       t5,
       tpl_goods                t6,
       tpl_pub_goods_packs      t7,
       tpl_go_company           t8,
       tpl_owner_ddl_def        t9,
       wms_goodsstatus          t10,
       tpl_owner_quanstatus_def t11,
       tpl_edi_queue            t12,
       wms_goods_lot            t13
 where t1.indtlid = t2.indtlid
   and t2.otherid = t3.indtlid
   and t1.lotid = t13.lotid(+)
   and t3.inid = t4.inid
   and t4.oldid = t5.porderid
   and t3.ownergoodsid = t6.ownergoodsid
   and t1.goodspackid = t7.goodspackid(+)
   and t4.sourcecompanyid = t8.companyid
   and t9.keyword = 'OWNER_OPERATION'
   and t4.operationtype = t9.dicid
   and t4.goodsownerid = t9.goodsownerid
   and t10.goodsstatusid = t1.goodsstatusid
   and t4.goodsownerid = t11.goodsownerid
   and t10.quantitystatus = t11.quantityid
   and t3.porderstatus <> 0
   and t4.usestatus = 3
   and t5.billfrom = 3 --只有数据传输的订单才允许回传
   and nvl(t5.nowlflag, 0) = 0
   and t12.srcid = t4.inid
   and nvl(t12.expflag, 0) = 0
   and t12.queuetype = 1
   and t10.goodsstatusid = -2*/
"
"TPLA_EDI_T320_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_EDI_T320_V1"" (""GOODSOWNERID"", ""LORDERID"", ""PORDERID"", ""OPERATIONTYPE"", ""OPSTATUS"", ""ARRIVEDATE"", ""PUTUPDATE"", ""SOURCECOMPANYID"", ""COMPANYSTYLE"", ""DTLLINES"", ""MEMO"", ""LORDERDTLID"", ""PORDERDTLID"", ""SRCDTLNO"", ""GOODSID"", ""STORAGEID"", ""GOODSNAME"", ""PACKNAME"", ""PACKSIZE"", ""PACKUNIT"", ""BATCHNO"", ""LOTNO"", ""VALIDDATE"", ""PRDDATE"", ""APPROVEDOCNO"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""SUPPLYNAME"", ""GOODSTATUS"", ""QUANSTATUS"", ""TRADEPACK"", ""REALRECVQTY"", ""TINYID"", ""TINYQTY"", ""DTLMEMO"", ""MEDCHKRPTNO"", ""CHECKDATE"", ""CHECKMANA"", ""CHECKMANB"", ""GOODSSUPPLYID"", ""SRCID"") AS 
  select a.GoodsOwnerId, --1  货主ID
       a.inid Lorderid, --2  平台入库订单号
       a.SRCNO PorderId, --3  货主入库订单总单ID
       i.ddlid OperationType, --4  业务类型
       /*  a.operationtype,*/
       decode(a.usestatus, 3, 1, 2) OPSTATUS, --5  业务状态
       b.ArriveDate ArriveDate, --6  收货时间      --to_char(a.ArriveDate,'yyyy-mm-dd hh24:mi:ss') ArriveDate,--6  收货时间 20080707Arivedate取细单
       c.keepdate PutupDate, --7  上架时间
       g.gcompanyid SourceCompanyId, --8  来货单位ID
       g.CompanyStyle, --9  单位类型
       a.DtlLines, --10  细目条数
       a.Memo, --11  总单备注
       a.inid LorderDtlId, --12  平台入库订单细单ID
       b.srcdtlno PorderDtlId, --13  货主入库订单细单ID
       b.srcdtlno SrcDtlNo, --14  原业务细单ID
       d.goodsownid GoodsId, --15  货主货品ID
       j.zxcolumn1 StorageId, --16  货主仓别
       d.goodsname GoodsName, --17  品名
       d1.PackName, --18  包装名称
       d1.PackSize, --19  包装大小
       b.tradegoodspack PackUnit, --20  基本单位
       c.BatchNo, --21  批次
       e.LotNo, --22  批号
       e.ValidDate ValidDate, --23  效期
       e.proddate Prddate, --24  生产日期
       e.ApproveDocNo, --25  批准文号
       d.GoodsType, --26  规格
       d.ProdArea, --27  产地
       --d.FactName, --28  生产厂家
       e.factname, --批号生产厂家 add by wanghuaiyu 2013年7月25日 19:07:57
       g.companyname Supplyname, --29  供应商名称
       1 goodstatus,--诺和诺德要求按全部合格反馈
       1 quanstatus,--诺和诺德要求按全部合格反馈
       b.tradegoodspack TradePack, --32  交易单位
       sum(c.goodsqty) RealRecvQty, --33  实收数量
       null TinyId, --34  平台入库订单明细Id
       null TinyQty, --35  物流入库订单明细数量
       null dtlmemo, --36  细单备注
       '' Medchkrptno, --37  药检报告号
       null checkdate, --38 检验日期
       null checkmanA, --39 验收员A
       null checkmanB, --40 验收员B
       null goodssupplyid, --41 货主源供应商ID
       null srcid --42 货主业务ID
/*b.Transtemp, -- 运输温度linwc 2009-9-16
       b.Importrepflag, --  进口报告单
       b.Passgateflag, -- 通关单
       b.Registeflag, --  注册证
       b.medcheckflag, -- 药检证标志
       b.eligibilityflag, --  合格证标志
       b.impregno, -- 进口注册证号
       b.rptno, --  岸检验报告编号
       b.backwhyid, --  退货原因
       b.checkman1, --  验收员A
       b.Checkman2, --  验收员B
       --b.registno,--批号上的注册号
       --c.sectionid, --分区id
       --c.goodsqty,
       --e.printmonthflag -- 打印精确到月*/
  from tpl_in_order             a,
       tpl_in_order_dtl         b,
       tpl_goods                d,
       tpl_goods_packs          d1,
       tpl_go_company           g,
       tpl_edi_queue            h,
       tpl_owner_ddl_def        i,
       tpl_st_io_doc            c,
       wms_goods_lot            e,
       wms_goodsstatus          f,
       tpl_purchase_order       j,
       tpl_owner_quanstatus_def aa
 where a.inid = b.inid
   and a.sourcecompanyid = g.companyid
   and b.ownergoodsid = d.ownergoodsid
   and b.ownergoodsid = d1.ownergoodsid -- xyue 2016-05-16
   and c.goodspackid = d1.goodspackid
   and a.usestatus = 3
   and b.porderstatus <> 0
   and h.srcid = a.inid
   and nvl(h.expflag, 0) = 0
   and h.queuetype = 1
   and 'OWNER_OPERATION' = i.keyword
   and a.operationtype = i.dicid
   and a.goodsownerid = i.goodsownerid
   and a.inid = c.orderid
   and b.indtlid = c.orderdtlid
   and c.comefrom = 1
   and c.lotid = e.lotid
   and c.goodsstatusid = f.goodsstatusid
   and a.oldid = j.porderid
   and a.goodsownerid = aa.goodsownerid
   and f.quantitystatus = aa.quantityid
   and j.billfrom = 3 --只有数据传输的才回传 Dempsey 2011/05/04;
   and nvl(j.nowlflag, 0) <> 1
   and j.inputmanid=0 --录入人是系统管理员
   and a.goodsownerid = 178 --该视图只针对诺和诺德货主ID=178
 group by a.GoodsOwnerId, --1  货主ID
          a.inid , --2  平台入库订单号
          a.SRCNO , --3  货主入库订单总单ID
          i.ddlid , --4  业务类型
          /*  a.operationtype,*/
          decode(a.usestatus, 3, 1, 2), --5  业务状态
          b.ArriveDate , --6  收货时间      --to_char(a.ArriveDate,'yyyy-mm-dd hh24:mi:ss') ArriveDate,--6  收货时间 20080707Arivedate取细单
          c.keepdate , --7  上架时间
          g.gcompanyid , --8  来货单位ID
          g.CompanyStyle, --9  单位类型
          a.DtlLines, --10  细目条数
          a.Memo, --11  总单备注
          b.srcdtlno , --13  货主入库订单细单ID
          b.srcdtlno , --14  原业务细单ID
          d.goodsownid, --15  货主货品ID
          j.zxcolumn1 , --16  货主仓别
          d.goodsname , --17  品名
          d1.PackName, --18  包装名称
          d1.PackSize, --19  包装大小
          b.tradegoodspack , --20  基本单位
          c.BatchNo, --21  批次
          e.LotNo, --22  批号
          e.ValidDate , --23  效期
          e.proddate , --24  生产日期
          e.ApproveDocNo, --25  批准文号
          d.GoodsType, --26  规格
          d.ProdArea, --27  产地
          e.factname, --批号生产厂家 add by wanghuaiyu 2013年7月25日 19:07:57
          g.companyname , --29  供应商名称
          b.tradegoodspack  --32  交易单位


union all

select a.GoodsOwnerId, --1  货主ID
       a.inid Lorderid, --2  平台入库订单号
       a.SRCNO PorderId, --3  货主入库订单总单ID
       i.ddlid OperationType, --4  业务类型
       /*  a.operationtype,*/
       decode(a.usestatus, 3, 1, 2) OPSTATUS, --5  业务状态
       b.ArriveDate ArriveDate, --6  收货时间      --to_char(a.ArriveDate,'yyyy-mm-dd hh24:mi:ss') ArriveDate,--6  收货时间 20080707Arivedate取细单
       sysdate PutupDate, --7  上架时间
       g.gcompanyid , --8  来货单位ID
       g.CompanyStyle, --9  单位类型
       a.DtlLines, --10  细目条数
       a.Memo, --11  总单备注
       a.inid , --12  平台入库订单细单ID
       b.srcdtlno , --13  货主入库订单细单ID
       b.srcdtlno , --14  原业务细单ID
       d.goodsownid , --15  货主货品ID
       t.zxcolumn1 , --16  货主仓别
       d.goodsname , --17  品名
       d1.PackName, --18  包装名称
       d1.PackSize, --19  包装大小
       b.tradegoodspack , --20  基本单位
       c.BatchNo, --21  批次
       e.LotNo, --22  批号
       e.ValidDate , --23  效期
       e.proddate , --24  生产日期
       e.ApproveDocNo, --25  批准文号
       d.GoodsType, --26  规格
       d.ProdArea, --27  产地
       --d.FactName, --28  生产厂家
       e.factname, --批号生产厂家 add by wanghuaiyu 2013年7月25日 19:08:53
       g.companyname , --29  供应商名称
       1 ,--诺和诺德要求按全部合格反馈
       1 ,--诺和诺德要求按全部合格反馈
       b.tradegoodspack , --32  交易单位
       sum(c.goodsqty)  RealRecvQty, --33  实收数量
       null TinyId, --34  平台入库订单明细Id
       null TinyQty, --35  物流入库订单明细数量
       null dtlmemo, --36  细单备注
       '' Medchkrptno, --37  药检报告号
       null checkdate, --38 检验日期
       null checkmanA, --39 验收员A
       null checkmanB, --40 验收员B
       null goodssupplyid, --41 货主源供应商ID
       null srcid --42 货主业务ID
/*       b.Transtemp, -- 运输温度linwc 2009-9-16
       b.Importrepflag, --  进口报告单
       b.Passgateflag, -- 通关单
       b.Registeflag, --  注册证
       b.medcheckflag, -- 药检证标志
       b.eligibilityflag, --  合格证标志
       b.impregno, -- 进口注册证号
       b.rptno, --  岸检验报告编号
       b.backwhyid, --  退货原因
       b.checkman1, --  验收员A
       b.Checkman2, --  验收员B
       b.registno,--批号上的注册号
       c.sectionid ,--分区id
       --c.goodsqty
       --e.printmonthflag -- 打印精确到月*/
  from tpl_in_order             a,
       tpl_in_order_dtl         b,
       tpl_goods                d,
       tpl_goods_packs          d1,
       tpl_go_company           g,
       tpl_edi_queue            h,
       tpl_owner_ddl_def        i,
       wms_receive_dtl          c,
       wms_goods_lot            e,
       wms_goodsstatus          f,
       wms_in_order_dtl         j,
       tpl_owner_quanstatus_def aa,
       tpl_purchase_order       t
 where a.inid = b.inid
   and a.sourcecompanyid = g.companyid
   and b.ownergoodsid = d.ownergoodsid
   and b.indtlid = j.otherid
   and j.indtlid = c.indtlid
   and b.ownergoodsid = d1.ownergoodsid -- xyue 2016-05-16
   and c.goodspackid = d1.goodspackid(+)
   and a.usestatus = 3
   and b.porderstatus <> 0
   and h.srcid = a.inid
   and nvl(h.expflag, 0) = 0
   and h.queuetype = 1
   and 'OWNER_OPERATION' = i.keyword
   and a.operationtype = i.dicid
   and a.goodsownerid = i.goodsownerid
   and c.lotid = e.lotid
   and c.goodsstatusid = f.goodsstatusid
   and a.goodsownerid = aa.goodsownerid
   and f.quantitystatus = aa.quantityid
   and a.oldid = t.porderid
   and t.billfrom = 3 --只有数据传输的才回传 Dempsey 2011/05/04;
   and nvl(t.nowlflag, 0) = 1
   and a.goodsownerid = 178 --该视图只针对诺和诺德货主ID=178
 group by a.GoodsOwnerId, --1  货主ID
          a.inid , --2  平台入库订单号
          a.SRCNO , --3  货主入库订单总单ID
          i.ddlid , --4  业务类型
          /*  a.operationtype,*/
          decode(a.usestatus, 3, 1, 2) , --5  业务状态
          b.ArriveDate , --6  收货时间      --to_char(a.ArriveDate,'yyyy-mm-dd hh24:mi:ss') ArriveDate,--6  收货时间 20080707Arivedate取细单
          sysdate , --7  上架时间
          g.gcompanyid , --8  来货单位ID
          g.CompanyStyle, --9  单位类型
          a.DtlLines, --10  细目条数
          a.Memo, --11  总单备注
          b.srcdtlno , --13  货主入库订单细单ID
          b.srcdtlno , --14  原业务细单ID
          d.goodsownid , --15  货主货品ID
          t.zxcolumn1 , --16  货主仓别
          d.goodsname , --17  品名
          d1.PackName, --18  包装名称
          d1.PackSize, --19  包装大小
          b.tradegoodspack , --20  基本单位
          c.BatchNo, --21  批次
          e.LotNo, --22  批号
          e.ValidDate , --23  效期
          e.proddate , --24  生产日期
          e.ApproveDocNo, --25  批准文号
          d.GoodsType, --26  规格
          d.ProdArea, --27  产地
          e.factname, --批号生产厂家 add by wanghuaiyu 2013年7月25日 19:08:53
          g.companyname , --29  供应商名称
          b.tradegoodspack  --32  交易单位


union all

/*货品状态为【当场拒收】的 xyue 2014-05-19*/
select t4.goodsownerid, --1货主ID
       t4.inid Lorderid, --2  平台入库订单号
       t4.SRCNO PorderId, --3  货主入库订单总单ID
       t9.ddlid OperationType, --4  业务类型
       decode(t4.usestatus, 3, 1, 2) OPSTATUS, --5  业务状态
       t3.ArriveDate ArriveDate, --6  收货时间
       sysdate PutupDate, --7  上架时间
       t8.gcompanyid SourceCompanyId, --8  来货单位ID
       t8.CompanyStyle, --9  单位类型
       t4.DtlLines, --10  细目条数
       t4.Memo, --11  总单备注
       t4.inid LorderDtlId, --12  平台入库订单细单ID
       t3.srcdtlno PorderDtlId, --13  货主入库订单细单ID
       t3.srcdtlno SrcDtlNo, --14  原业务细单ID
       t6.goodsownid GoodsId, --15  货主货品ID
       t5.zxcolumn1 StorageId, --16  货主仓别
       t6.goodsname GoodsName, --17  品名
       t7.PackName, --18  包装名称
       t7.PackSize, --19  包装大小
       t3.tradegoodspack PackUnit, --20  基本单位
       t1.BatchNo, --21  批次
       t1.LotNo, --22  批号
       t1.ValidDate, --23  效期
       t1.proddate Prddate, --24  生产日期
       t1.ApproveDocNo, --25  批准文号
       t6.GoodsType, --26  规格
       t6.ProdArea, --27  产地
       --t6.FactName, --28  生产厂家
       t13.factname, --批号生产厂家 add by wanghuaiyu 2013年7月25日 19:09:34
       t8.companyname Supplyname, --29  供应商名称
       1 goodstatus,--诺和诺德要求按全部合格反馈
       1 quanstatus,--诺和诺德要求按全部合格反馈
       t3.tradegoodspack TradePack, --32  交易单位
       sum(t1.goodsqty) RealRecvQty, --33  实收数量
       null TinyId, --34  平台入库订单明细Id
       null TinyQty, --35  物流入库订单明细数量
       null dtlmemo, --36  细单备注
       null Medchkrptno, --37  药检报告号
       null checkdate, --38 检验日期
       null checkmanA, --39 验收员A
       null checkmanB, --40 验收员B
       null goodssupplyid, --41 货主源供应商ID
       null srcid --42 货主业务ID
/*t3.Transtemp, -- 运输温度linwc 2009-9-16
       t3.Importrepflag, --  进口报告单
       t3.Passgateflag, -- 通关单
       t3.Registeflag, --  注册证
       t3.medcheckflag, -- 药检证标志
       t3.eligibilityflag, --  合格证标志
       t3.impregno, -- 进口注册证号
       t3.rptno, --  岸检验报告编号
       t3.backwhyid, --  退货原因
       t3.checkman1, --  验收员A
       t3.Checkman2, --  验收员B
       t3.registno, --批号上的注册号
       t1.sectionid, --分区id
       t13.printmonthflag --打印精确到月*/
  from wms_receive_dtl          t1,
       wms_in_order_dtl         t2,
       tpl_in_order_dtl         t3,
       tpl_in_order             t4,
       tpl_purchase_order       t5,
       tpl_goods                t6,
       tpl_goods_packs          t7,
       tpl_go_company           t8,
       tpl_owner_ddl_def        t9,
       wms_goodsstatus          t10,
       tpl_owner_quanstatus_def t11,
       tpl_edi_queue            t12,
       wms_goods_lot            t13
 where t1.indtlid = t2.indtlid
   and t2.otherid = t3.indtlid
   and t1.lotid = t13.lotid(+)
   and t3.inid = t4.inid
   and t4.oldid = t5.porderid
   and t3.ownergoodsid = t6.ownergoodsid
   and t1.ownergoodsid = t7.ownergoodsid -- xyue 2016-05-16
   and t1.goodspackid = t7.goodspackid(+)
   and t4.sourcecompanyid = t8.companyid
   and t9.keyword = 'OWNER_OPERATION'
   and t4.operationtype = t9.dicid
   and t4.goodsownerid = t9.goodsownerid
   and t10.goodsstatusid = t1.goodsstatusid
   and t4.goodsownerid = t11.goodsownerid
   and t10.quantitystatus = t11.quantityid
   and t3.porderstatus <> 0
   and t4.usestatus = 3
   and t5.billfrom = 3 --只有数据传输的订单才允许回传
   and nvl(t5.nowlflag, 0) = 0
   and t12.srcid = t4.inid
   and nvl(t12.expflag, 0) = 0
   and t12.queuetype = 1
   and t10.goodsstatusid = -2
 group by t4.goodsownerid, --1货主ID
          t4.inid , --2  平台入库订单号
          t4.SRCNO , --3  货主入库订单总单ID
          t9.ddlid , --4  业务类型
          decode(t4.usestatus, 3, 1, 2) , --5  业务状态
          t3.ArriveDate , --6  收货时间
          sysdate , --7  上架时间
          t8.gcompanyid , --8  来货单位ID
          t8.CompanyStyle, --9  单位类型
          t4.DtlLines, --10  细目条数
          t4.Memo, --11  总单备注
          t3.srcdtlno , --13  货主入库订单细单ID
          t3.srcdtlno , --14  原业务细单ID
          t6.goodsownid , --15  货主货品ID
          t5.zxcolumn1 , --16  货主仓别
          t6.goodsname , --17  品名
          t7.PackName, --18  包装名称
          t7.PackSize, --19  包装大小
          t3.tradegoodspack , --20  基本单位
          t1.BatchNo, --21  批次
          t1.LotNo, --22  批号
          t1.ValidDate, --23  效期
          t1.proddate , --24  生产日期
          t1.ApproveDocNo, --25  批准文号
          t6.GoodsType, --26  规格
          t6.ProdArea, --27  产地
          t13.factname, --批号生产厂家 add by wanghuaiyu 2013年7月25日 19:09:34
          t8.companyname , --29  供应商名称
          t3.tradegoodspack  --32  交易单位
"
"TPLA_EDI_T330_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_EDI_T330_V"" (""GOODSOWNERID"", ""LORDERID"", ""PORDERID"", ""OPERATIONTYPE"", ""OPSTATUS"", ""ARRIVEDATE"", ""PUTUPDATE"", ""SOURCECOMPANYID"", ""COMPANYSTYLE"", ""DTLLINES"", ""MEMO"", ""LORDERDTLID"", ""PORDERDTLID"", ""SRCDTLNO"", ""GOODSID"", ""STORAGEID"", ""GOODSNAME"", ""PACKNAME"", ""PACKSIZE"", ""PACKUNIT"", ""BATCHNO"", ""LOTNO"", ""VALIDDATE"", ""PRDDATE"", ""APPROVEDOCNO"", ""PRINTMONTHFLAG"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""SUPPLYNAME"", ""GOODSTATUS"", ""QUANSTATUS"", ""TRADEPACK"", ""REALRECVQTY"", ""TINYID"", ""TINYQTY"", ""DTLMEMO"", ""MEDCHKRPTNO"", ""CHECKDATE"", ""CHECKMANA"", ""CHECKMANB"", ""TRANSTEMP"", ""IMPORTREPFLAG"", ""PASSGATEFLAG"", ""REGISTEFLAG"", ""MEDCHECKFLAG"", ""ELIGIBILITYFLAG"", ""IMPREGNO"", ""RPTNO"", ""BACKWHYID"", ""CHECKMAN1"", ""CHECKMAN2"", ""REGISTNO"", ""SECTIONID"", ""PLANQUALIFIEDREASON"", ""MAH"", ""PRINTEXPIREFLAG"", ""VALIDDATE2"", ""INVNO"", ""INVCODE"", ""INVDATE"", ""PRODMONTHFLAG"") AS 
  select t4.goodsownerid, --1货主ID
       t4.inid Lorderid, --2  平台入库订单号
       t4.SRCNO PorderId, --3  货主入库订单总单ID
       t9.ddlid OperationType, --4  业务类型
       decode(t4.usestatus, 3, 1, 2) OPSTATUS, --5  业务状态
       t3.ArriveDate ArriveDate, --6  收货时间
       sysdate PutupDate, --7  上架时间
       t8.gcompanyid SourceCompanyId, --8  来货单位ID
       t8.CompanyStyle, --9  单位类型
       t4.DtlLines, --10  细目条数
       t4.Memo, --11  总单备注
       t1.receiveid LorderDtlId, --12  平台入库订单细单ID
       t3.srcdtlno PorderDtlId, --13  货主入库订单细单ID
       t3.srcdtlno SrcDtlNo, --14  原业务细单ID
       t6.goodsownid GoodsId, --15  货主货品ID
       t5.zxcolumn1 StorageId, --16  货主仓别
       t6.goodsname GoodsName, --17  品名
       t7.PackName, --18  包装名称
       t7.PackSize, --19  包装大小
       t3.tradegoodspack PackUnit, --20  基本单位
       t1.BatchNo, --21  批次
       t13.LotNo, --22  批号
       t13.ValidDate, --23  效期
       t13.proddate Prddate, --24  生产日期
       t13.ApproveDocNo, --25  批准文号
       t13.printmonthflag, --打印精确到月
       t6.GoodsType, --26  规格
       t6.ProdArea, --27  产地
       --t6.FactName, --28  生产厂家
       T13.Factname,--批号生产厂家 add by wanghuaiyu 2013年7月25日 19:04:25
       t8.companyname Supplyname, --29  供应商名称
       t10.goodsstatusid goodstatus,
       t11.goquantityid quanstatus,
       t3.tradegoodspack TradePack, --32  交易单位
       t1.goodsqty  RealRecvQty, --33  实收数量
       0                TinyId, --34  平台入库订单明细Id
       null             TinyQty, --35  物流入库订单明细数量
        t3.memo dtlmemo, --36  细单备注
       null Medchkrptno, --37  药检报告号
       t3.checkdate, --38 检验日期
       t3.checkmanA, --39 验收员A
       t3.checkmanB, --40 验收员B
       t3.Transtemp, -- 运输温度linwc 2009-9-16
       t3.Importrepflag, --  进口报告单
       t3.Passgateflag, -- 通关单
       t3.Registeflag, --  注册证
       t3.medcheckflag, -- 药检证标志
       t3.eligibilityflag, --  合格证标志
       t3.impregno, -- 进口注册证号
       t3.rptno, --  岸检验报告编号
       t3.backwhyid, --  退货原因
       t3.checkman1, --  验收员A
       t3.Checkman2, --  验收员B
       t3.registno, --批号上的注册号
       t1.sectionid, --分区id
       t1.planqualifiedreason, --拟合格原因
       t13.mah, --add by xyue 2020-01-03
       t13.printexpireflag, --add by xyue 2020-11-10
       t13.validdate2,
       substr(zx_get_t320_invno(t4.goodsownerid, t3.indtlid),0,100) invno, --只反馈中宏 add by xyue 2019-07-01
       zx_get_t320_invcode(t4.goodsownerid, t3.indtlid) invcode,--add by xyue 2019-07-01
       zx_get_t320_invdate(t4.goodsownerid, t3.indtlid) invdate,--add by xyue 2019-07-01
       t13.prodmonthflag
from wms_receive_dtl      t1,
     wms_in_order_dtl     t2,
     tpl_in_order_dtl     t3,
     tpl_in_order          t4,
     tpl_purchase_order    t5,
     tpl_goods             t6,
     tpl_pub_goods_packs   t7,
     tpl_go_company        t8,
     tpl_owner_ddl_def     t9,
     wms_goodsstatus       t10,
     tpl_owner_quanstatus_def t11,
     tpl_edi_queue            t12,
     wms_goods_lot t13
  where t1.indtlid = t2.indtlid
  and t2.otherid = t3.indtlid
  and t1.lotid = t13.lotid(+)
  and t3.inid = t4.inid
  and t4.oldid = t5.porderid
  and t3.ownergoodsid = t6.ownergoodsid
  and t1.goodspackid = t7.goodspackid(+)
  and t4.sourcecompanyid = t8.companyid
  and t9.keyword = 'OWNER_OPERATION'
  and t4.operationtype = t9.dicid
  and t4.goodsownerid = t9.goodsownerid
  and t10.goodsstatusid = t1.goodsstatusid
  and t4.goodsownerid = t11.goodsownerid
  and t10.quantitystatus = t11.quantityid
  and t3.porderstatus <> 0
  and t4.usestatus = 2
 and t5.billfrom = 3 --只有数据传输的订单才允许回传
  and nvl(t5.nowlflag,0) = 0
   and t12.srcid = t4.inid
   and nvl(t12.expflag, 0) = 0
   and t12.queuetype = 21
   and t10.goodsstatusid=-1
"
"TPLA_EDI_T340_20250122BAK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_EDI_T340_20250122BAK_V"" (""GOODSOWNERID"", ""EXPORDERID"", ""OPERATIONTYPE"", ""PREEXPDATE"", ""PREARRIVEDATE"", ""TRANSNO"", ""EXPDATE"", ""SRCEXPNO"", ""LINENO"", ""OPSTATUS"", ""TTRANSMODE"", ""DETAILLINES"", ""GCOMPANYID"", ""EXPORTMEMO"", ""SRCEXPDTLNO"", ""EXPORDERDTLID"", ""GOODSID"", ""GOSTOCKID"", ""BATCHNO"", ""LOTNO"", ""VALIDDATE"", ""PRDDATE"", ""GOODSTATUS"", ""QUANSTATUS"", ""APPROVEDOCNO"", ""TRADEGOODSPACK"", ""GOODSQTY"", ""TRADEGOODSQTY"", ""EXPDTLMEMO"", ""PACKSIZE"", ""STATUS"", ""SCATTERFINPACKS"", ""WHOLEFINPACKS"") AS 
  select /*+ leading(a,h) index(a WMS_OUT_IDX15) */
       a.GOODSOWNERID, -- 1 :1:2ID
       a.otherid EXPORDERID, -- 2 :3:4:5:6ID
       --a.otherid old_outid,
       j.ddlid OPERATIONTYPE, -- 5 :7:8:9:10
       a.PREEXPDATE PREEXPDATE, --  7 :11:12:13:14:15
       a.PREARRIVEDATE PREARRIVEDATE, -- 8 :16:17:18:19:20
       a.transno TRANSNO, -- 10
       a.EXPDATE EXPDATE, --  11  :21:22:23:24:25:26
       a.SRCEXPNO, -- 3 :27:28:29:30:31:32:33:34ID
       80000000 + a.wavedtlid Lineno,
       decode(a.usestatus, 2, 1, 2) OPSTATUS, -- 6 :35:36:37:38
       i.gotransid TTRANSMODE, -- 9 :39:40:41:42:43
       --a.Reccompanyid,缺
       a.DETAILLINES, --  13  :44:45:46:47
       g.GCOMPANYID, -- 12  :48:49:50:51:52:53ID
       null EXPORTMEMO, -- 14  :54:55:56:57 --xyue 2024-06-13 出库反馈备注没用
       b.SRCEXPDTLNO, --  15  :58:59:60:61:62:63ID
       b.outdtlid      EXPORDERDTLID, -- 16  :64:65:66:67:68:69:70:71ID
       d.goodsownid    GOODSID, -- 17  :72:73:74:75ID
       null            GOSTOCKID, -- 18  :76:77:78:79ID
       b.BATCHNO, --  19  :80:81
       b.LOTNO, --  20  :82:83
       b.VALIDDATE     VALIDDATE, -- 21  :84:85
       b.proddate      prddate, -- 22  :86:87:88:89
       e.gostatusid    Goodstatus, --  23  :90:91:92:93
       e1.goquantityid quanstatus, --  24  :94:95:96:97:98:99ID
       d.Approvedocno, -- 25  :100:101:102:103
       --d.registdocno registno, --26 :104:105:106:107
       b.TRADEGOODSPACK, -- 27  :108:109:110:111
       b.Realqty         goodsqty, --  28  :112:113:114:115
       b.tRADEGOODSQTY, --  29  :116:117:118:119:120:121
       b.EXPDTLMEMO, -- 30  :122:123:124:125
       d.PACKSIZE, -- 31  :126:127:128:129
       1                 STATUS, -- 32  :130:131:132:133:134:135
       k.scatterfinpacks,
       k.wholefinpacks
  From wms_out_order             a,
       wms_out_order_dtl         b,
       tpl_goods                 d,
       tpl_pub_goods_packs       d1,
       tpl_owner_goodsstatus_def e,
       tpl_owner_quanstatus_def  e1,
       wms_goodsstatus           f,
       tpl_go_company            g,
       lywms.tpl_edi_queue_t340_v      h, -- add by xyue 2017-11-23
       tpl_owner_trans_def       i,
       tpl_owner_ddl_def         j,
       wms_wave_dtl              k,
       tpl_export_order          aa
 Where a.outid = b.outid
   and a.reccompanyid = g.companyid
   and b.ownergoodsid = d.ownergoodsid
   and b.goodspackid = d1.goodspackid
   and b.goodsstatusid = f.goodsstatusid
   and a.goodsownerid = e.goodsownerid
   and f.goodsstatusid = e.goodsstatusid
   and f.quantitystatus = e1.quantityid
   and a.goodsownerid = e1.goodsownerid
   and a.oldid = aa.exporderid(+)
   and (a.transmodeid = i.transportid(+) and
       a.goodsownerid = i.goodsownerid(+))
   and a.usestatus = 4
   and h.srcid = a.otherid
   and nvl(h.expflag, 0) = 0
   and h.queuetype = 2
   and 'OWNER_OPERATION' = j.keyword
   and a.operationtype = j.dicid
   and a.goodsownerid = j.goodsownerid
   AND a.wavedtlid = k.wavedtlid(+)
   and b.usestatus = 5
 Order by a.outid
"
"TPLA_EDI_T340_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_EDI_T340_V"" (""GOODSOWNERID"", ""EXPORDERID"", ""OPERATIONTYPE"", ""PREEXPDATE"", ""PREARRIVEDATE"", ""TRANSNO"", ""EXPDATE"", ""SRCEXPNO"", ""LINENO"", ""OPSTATUS"", ""TTRANSMODE"", ""DETAILLINES"", ""GCOMPANYID"", ""EXPORTMEMO"", ""SRCEXPDTLNO"", ""EXPORDERDTLID"", ""GOODSID"", ""GOSTOCKID"", ""BATCHNO"", ""LOTNO"", ""VALIDDATE"", ""PRDDATE"", ""GOODSTATUS"", ""QUANSTATUS"", ""APPROVEDOCNO"", ""TRADEGOODSPACK"", ""GOODSQTY"", ""TRADEGOODSQTY"", ""EXPDTLMEMO"", ""PACKSIZE"", ""STATUS"", ""SCATTERFINPACKS"", ""WHOLEFINPACKS"") AS 
  select
       a.GOODSOWNERID, -- 1 :1:2ID
       a.otherid EXPORDERID, -- 2 :3:4:5:6ID
       --a.otherid old_outid,
       j.ddlid OPERATIONTYPE, -- 5 :7:8:9:10
       a.PREEXPDATE PREEXPDATE, --  7 :11:12:13:14:15
       a.PREARRIVEDATE PREARRIVEDATE, -- 8 :16:17:18:19:20
       a.transno TRANSNO, -- 10
       a.EXPDATE EXPDATE, --  11  :21:22:23:24:25:26
       a.SRCEXPNO, -- 3 :27:28:29:30:31:32:33:34ID
       80000000 + a.wavedtlid Lineno,
       decode(a.usestatus, 2, 1, 2) OPSTATUS, -- 6 :35:36:37:38
       null as  TTRANSMODE, -- 9 :39:40:41:42:43
       --a.Reccompanyid,缺
       a.DETAILLINES, --  13  :44:45:46:47
       g.GCOMPANYID, -- 12  :48:49:50:51:52:53ID
       null EXPORTMEMO, -- 14  :54:55:56:57 --xyue 2024-06-13 出库反馈备注没用
       b.SRCEXPDTLNO, --  15  :58:59:60:61:62:63ID
       b.outdtlid      EXPORDERDTLID, -- 16  :64:65:66:67:68:69:70:71ID
       d.goodsownid    GOODSID, -- 17  :72:73:74:75ID
       null            GOSTOCKID, -- 18  :76:77:78:79ID
       b.BATCHNO, --  19  :80:81
       b.LOTNO, --  20  :82:83
       b.VALIDDATE     VALIDDATE, -- 21  :84:85
       b.proddate      prddate, -- 22  :86:87:88:89
       b.goodsstatusid    Goodstatus, --  23  :90:91:92:93
       b.quantitystatus quanstatus, --  24  :94:95:96:97:98:99ID
       d.Approvedocno, -- 25  :100:101:102:103
       --d.registdocno registno, --26 :104:105:106:107
       b.TRADEGOODSPACK, -- 27  :108:109:110:111
       b.Realqty         goodsqty, --  28  :112:113:114:115
       b.tRADEGOODSQTY, --  29  :116:117:118:119:120:121
       b.EXPDTLMEMO, -- 30  :122:123:124:125
       d.PACKSIZE, -- 31  :126:127:128:129
       1                 STATUS, -- 32  :130:131:132:133:134:135
       null as scatterfinpacks,
       null as wholefinpacks
  From wms_out_order             a,
       wms_out_order_dtl         b,
       tpl_goods                 d,
       tpl_go_company            g,
       tpl_edi_queue_t340_v      h, -- add by xyue 2017-11-23
       tpl_owner_ddl_def         j
 Where a.outid = b.outid
   and a.reccompanyid = g.companyid
   and b.ownergoodsid = d.ownergoodsid
   and a.usestatus = 4
   and h.srcid = a.otherid
   and nvl(h.expflag, 0) = 0
   and h.queuetype = 2
   and 'OWNER_OPERATION' = j.keyword
   and a.operationtype = j.dicid
   and a.goodsownerid = j.goodsownerid
   and b.usestatus = 5
   and a.credate>sysdate-90
 --Order by a.outid
"
"TPLA_EDI_T340_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_EDI_T340_V1"" (""GOODSOWNERID"", ""EXPORDERID"", ""OPERATIONTYPE"", ""PREEXPDATE"", ""PREARRIVEDATE"", ""TRANSNO"", ""EXPDATE"", ""SRCEXPNO"", ""LINENO"", ""OPSTATUS"", ""TTRANSMODE"", ""DETAILLINES"", ""GCOMPANYID"", ""EXPORTMEMO"", ""SRCEXPDTLNO"", ""EXPORDERDTLID"", ""GOODSID"", ""GOSTOCKID"", ""BATCHNO"", ""LOTNO"", ""VALIDDATE"", ""PRDDATE"", ""GOODSTATUS"", ""QUANSTATUS"", ""APPROVEDOCNO"", ""TRADEGOODSPACK"", ""GOODSQTY"", ""TRADEGOODSQTY"", ""EXPDTLMEMO"", ""PACKSIZE"", ""STATUS"", ""WMSSCATTERFINPACKS"", ""WMSWHOLEFINPACKS"") AS 
  select
	a.GOODSOWNERID	,--	1	:1:2ID
	a.otherid EXPORDERID	,--	2	:3:4:5:6ID
  --a.otherid old_outid,
  j.ddlid OPERATIONTYPE	,--	5	:7:8:9:10
  a.PREEXPDATE PREEXPDATE,--	7	:11:12:13:14:15
	a.PREARRIVEDATE PREARRIVEDATE,--	8	:16:17:18:19:20
  a.transno TRANSNO	,--	10
  a.EXPDATE	EXPDATE,--	11	:21:22:23:24:25:26
	a.SRCEXPNO	,--	3	:27:28:29:30:31:32:33:34ID
  --80000000+a.wavedtlid Lineno	,
  b.lydtlzxcolumn20 lineno, -- xyue 2016-05-12 真正取T302下传对应的lineno字段的值
	decode(a.usestatus,2,1,2) OPSTATUS	,--	6	:35:36:37:38
	i.gotransid TTRANSMODE	,--	9	:39:40:41:42:43
	--a.Reccompanyid,缺
	a.DETAILLINES	,--	13	:44:45:46:47
	g.GCOMPANYID	,--	12	:48:49:50:51:52:53ID
	a.EXPORTMEMO	,--	14	:54:55:56:57
	b.SRCEXPDTLNO	,--	15	:58:59:60:61:62:63ID
	b.outdtlid EXPORDERDTLID	,--	16	:64:65:66:67:68:69:70:71ID
	d.goodsownid GOODSID	,--	17	:72:73:74:75ID
	null GOSTOCKID	,--	18	:76:77:78:79ID
	b.BATCHNO	,--	19	:80:81
	b.LOTNO	,--	20	:82:83
	b.VALIDDATE VALIDDATE,--	21	:84:85
	b.proddate prddate	,--	22	:86:87:88:89
	e.gostatusid Goodstatus	,--	23	:90:91:92:93
	e1.goquantityid	quanstatus,--	24	:94:95:96:97:98:99ID
	d.Approvedocno	,--	25	:100:101:102:103
  --d.registdocno registno, --26 :104:105:106:107
	b.TRADEGOODSPACK	,--	27	:108:109:110:111
	b.Realqty	goodsqty,--	28	:112:113:114:115
	b.tRADEGOODSQTY	,--	29	:116:117:118:119:120:121
	b.EXPDTLMEMO	,--	30	:122:123:124:125
	d.PACKSIZE	,--	31	:126:127:128:129
	1	STATUS,	--	32	:130:131:132:133:134:135
  k.scatterfinpacks,
  k.wholefinpacks
From
	wms_out_order a,
	wms_out_order_dtl  b,
	tpl_goods d,
	tpl_pub_goods_packs d1,
	tpl_owner_goodsstatus_def e,
  tpl_owner_quanstatus_def e1,
  wms_goodsstatus f,
	tpl_go_company g    ,
	tpl_edi_queue h,
	tpl_owner_trans_def i,
 	tpl_owner_ddl_def j,
  wms_wave_dtl k,
  tpl_export_order aa
Where	a.outid = b.outid
	and a.reccompanyid = g.companyid
	and b.ownergoodsid = d.ownergoodsid
	and b.goodspackid = d1.goodspackid
  and b.goodsstatusid = f.goodsstatusid
  and a.goodsownerid=e.goodsownerid
  and f.goodsstatusid = e.goodsstatusid
  and f.quantitystatus = e1.quantityid
  and a.goodsownerid=e1.goodsownerid
  and a.oldid=aa.exporderid(+)
	and (a.transmodeid = i.transportid(+)   	and a.goodsownerid = i.goodsownerid(+) )
	and a.usestatus = 4
	and h.srcid = a.otherid
	and nvl(h.expflag,0) = 0
  and h.queuetype = 2
	and 'OWNER_OPERATION' = j.keyword
 	and a.operationtype = j.dicid
 	and a.goodsownerid = j.goodsownerid
  AND a.wavedtlid = k.wavedtlid(+)
  and b.usestatus=5
Order by a.outid
"
"TPLA_EDI_T350_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_EDI_T350_V"" (""GOODSOWNERID"", ""CREDATE"", ""JOBFLAG"", ""OPERATIONTYPE"", ""JOBID"", ""JOBDTLID"", ""STATUS"", ""MEMO"", ""CANCELID"") AS 
  select a.GoodsOwnerId, -- 1 :1:2ID  Varchar2(12)
       a.canceldate CreDate, -- 2 :3:4:5:6  Date
       a.jobtype Jobflag, --  3 :7:8:9:10:11:12:13  Number(2,0)
       a.operationtype, --  4 :14:15:16:17:18:19  Number(2,0)
       a.oldid Jobid, --  5 :20:21:22:23ERP:24:25 Varchar2(20)
       a.olddtlid Jobdtlid, --  6 ERP:26:27:28  Varchar2(20)
       a.jobcancelstatus STATUS, -- 7 :29:30:31:32:33:34  Number(2,0)
       a.canmemo Memo, -- 8 :35:36:37:38:39:40  Varchar2(100)
       a.CANCELID
  from wms_cancel_job_lst a, tpl_edi_queue h
 where a.cancelid = h.srcid
   and nvl(h.expflag, 0) = 0
   and h.queuetype = 4
"
"TPLA_EDI_T360_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_EDI_T360_V"" (""RECEIVEID"", ""RECEIVEDATE"", ""CHECKDATE"", ""INDTLID"", ""WAREHID"", ""OWNERGOODSID"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""GOODSPACKID"", ""GOODSPACKNAME"", ""PACKSIZE"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSCUBAGE"", ""GOODSWEIGHT"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""GOODSOWNID"", ""STORAGECONDITION"", ""RECMEMO"", ""FACEQUALITY"", ""PACKQUALITY"", ""TRANSTEMP"", ""IMPORTREPFLAG"", ""PASSGATEFLAG"", ""REGISTEFLAG"", ""MEDCHECKFLAG"", ""ELIGIBILITYFLAG"", ""APPROVEDOCNO"", ""REGISTNO"", ""RPTNO"", ""BACKWHYID"", ""CHECKMANID1"", ""CHECKMAN1"", ""CHECKMANID2"", ""CHECKMAN2"", ""CHECKDOCNO"", ""LQCCHECK"", ""PASSGATENO"", ""PIJIANNO"", ""QUCHECKID"", ""LPNCODE"", ""CONTAINERID"", ""CONTAINERNO"", ""TYPEID"", ""QUCHECKNAME"", ""INPUTMANID"", ""SORTTYPE"", ""TRAYSECTIONID"", ""TRAYSECTIONNO"", ""TRAYSECTIONNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""WHOLESECTIONID"", ""WHOLESECTIONNO"", ""WHOLESECTIONNAME"", ""SENDNO"", ""USESTATUS"", ""RULINGFLAG"", ""GSPFLAG"", ""RECEIVETYPE"", ""GOODSOWNERID"", ""REASON"") AS 
  select a.receiveid,
       a.receivedate,
       a.checkdate,
       a.indtlid,
       a.warehid,
       a.ownergoodsid,
       a.goodsid,
       c.opcode,
       c.goodsname,
       c.goodstype,
       c.prodarea,
       f.companyname factname,
       a.goodspackid,
       a.goodspackname,
       a.packsize,
       a.goodslength,
       a.goodswidth,
       a.goodsheight,
       a.goodscubage,
       a.goodsweight,
       a.batchno,
       a.lotid,
       a.lotno,
       a.killlotno,
       a.validdate,
       a.proddate,
       a.goodsstatusid,
       e.goodsstatus,
       a.quantitystatus,
       a.goodsqty,
       a.wholeqty,
       a.scatterqty,
       h.goodsownid,
       h.storagecondition,
       a.recmemo,
       a.facequality,
       a.packquality,
       a.transtemp,
       a.importrepflag,
       a.passgateflag, -- 通关单
       a.registeflag, --  注册证
       a.medcheckflag, -- 药检证标志
       a.eligibilityflag, --  合格证标志
       a.approvedocno, --  批准文号
       a.registno, -- 进口注册证号
       a.rptno, --  岸检验报告编号
       a.backwhyid, -- 退货原因
       a.checkmanid1, --   验收员A
       a.checkman1,
       a.checkmanid2, --  验收员B
       a.checkman2,
       a.checkdocno, --检验单号
       a.lqccheck,--可见异物检验
       a.passgateno,--通关单号
       a.pijianno,--批件号
       a.qucheckid, --检查部门ID
       a.lpncode,
       a.containerid,
       s.containerno,
       s.typeid,
       o.companyname qucheckname,
       a.inputmanid,
       a.sorttype,
       a.traysectionid,
        t.sectionno traysectionno,
       t.sectionname traysectionname,
       a.sectionid,
       p.sectionno,
       p.sectionname,
       a.wholesectionid ,
       r.sectionno wholesectionno,
       r.sectionname wholesectionname,
       a.sendno,
       a.usestatus,
       a.rulingflag,
       a.gspflag,
       a.receivetype,
       i.goodsownerid,
       j.ddlname reason
  from wms_receive_dtl          a,
       wms_goods_lot            b,
       tpl_pub_goods            c,
       tpl_pub_company          f,
       tpl_pub_goods_packs      d,
       wms_goodsstatus          e,
       tpl_goods                h,
       pub_company              o,
       wms_st_section_def       p,
       wms_st_section_def       r,
       wms_container_def        s,
       wms_st_section_def       t,
       tpl_edi_queue            g,
       wms_in_order_dtl         i,
       sys_ddl_all_v            j
 where a.lotid = b.lotid(+)
   and a.goodsid = c.goodsid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.goodsstatusid = e.goodsstatusid(+)
   and a.ownergoodsid = h.ownergoodsid(+)
   and a.qucheckid = o.companyid(+)
   and a.sectionid = p.sectionid(+)
   and a.wholesectionid = r.sectionid(+)
   and a.containerid = s.containerid(+)
   and c.factid = f.companyid(+)
   and a.traysectionid = t.sectionid(+)
   AND g.srcid = a.receiveid
   AND g.queuetype = 50
   AND i.indtlid = a.indtlid
   AND j.keyword LIKE 'WMS_GOODSSTATUS_REASON'
   AND a.statusreason = j.ddlid(+)
"
"TPLA_EDI_T370_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_EDI_T370_V"" (""RECEIVEID"", ""RECEIVEDATE"", ""CHECKDATE"", ""INDTLID"", ""WAREHID"", ""OWNERGOODSID"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""GOODSPACKID"", ""GOODSPACKNAME"", ""PACKSIZE"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSCUBAGE"", ""GOODSWEIGHT"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""GOODSOWNID"", ""STORAGECONDITION"", ""RECMEMO"", ""FACEQUALITY"", ""PACKQUALITY"", ""TRANSTEMP"", ""IMPORTREPFLAG"", ""PASSGATEFLAG"", ""REGISTEFLAG"", ""MEDCHECKFLAG"", ""ELIGIBILITYFLAG"", ""APPROVEDOCNO"", ""REGISTNO"", ""RPTNO"", ""BACKWHYID"", ""CHECKMANID1"", ""CHECKMAN1"", ""CHECKMANID2"", ""CHECKMAN2"", ""CHECKDOCNO"", ""LQCCHECK"", ""PASSGATENO"", ""PIJIANNO"", ""QUCHECKID"", ""LPNCODE"", ""CONTAINERID"", ""CONTAINERNO"", ""TYPEID"", ""QUCHECKNAME"", ""INPUTMANID"", ""SORTTYPE"", ""TRAYSECTIONID"", ""TRAYSECTIONNO"", ""TRAYSECTIONNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""WHOLESECTIONID"", ""WHOLESECTIONNO"", ""WHOLESECTIONNAME"", ""SENDNO"", ""USESTATUS"", ""RULINGFLAG"", ""GSPFLAG"", ""RECEIVETYPE"", ""GOODSOWNERID"") AS 
  select a.receiveid,
       a.receivedate,
       a.checkdate,
       a.indtlid,
       a.warehid,
       a.ownergoodsid,
       a.goodsid,
       c.opcode,
       c.goodsname,
       c.goodstype,
       c.prodarea,
       f.companyname factname,
       a.goodspackid,
       a.goodspackname,
       a.packsize,
       a.goodslength,
       a.goodswidth,
       a.goodsheight,
       a.goodscubage,
       a.goodsweight,
       a.batchno,
       a.lotid,
       a.lotno,
       a.killlotno,
       a.validdate,
       a.proddate,
       a.goodsstatusid,
       e.goodsstatus,
       a.quantitystatus,
       a.goodsqty,
       a.wholeqty,
       a.scatterqty,
       h.goodsownid,
       h.storagecondition,
       a.recmemo,
       a.facequality,
       a.packquality,
       a.transtemp,
       a.importrepflag,
       a.passgateflag, -- 通关单
       a.registeflag, --  注册证
       a.medcheckflag, -- 药检证标志
       a.eligibilityflag, --  合格证标志
       a.approvedocno, --  批准文号
       a.registno, -- 进口注册证号
       a.rptno, --  岸检验报告编号
       a.backwhyid, -- 退货原因
       a.checkmanid1, --   验收员A
       a.checkman1,
       a.checkmanid2, --  验收员B
       a.checkman2,
       a.checkdocno, --检验单号
       a.lqccheck,--可见异物检验
       a.passgateno,--通关单号
       a.pijianno,--批件号
       a.qucheckid, --检查部门ID
       a.lpncode,
       a.containerid,
       s.containerno,
       s.typeid,
       o.companyname qucheckname,
       a.inputmanid,
       a.sorttype,
       a.traysectionid,
        t.sectionno traysectionno,
       t.sectionname traysectionname,
       a.sectionid,
       p.sectionno,
       p.sectionname,
       a.wholesectionid ,
       r.sectionno wholesectionno,
       r.sectionname wholesectionname,
       a.sendno,
       a.usestatus,
       a.rulingflag,
       a.gspflag,
       a.receivetype,
       i.goodsownerid
  from wms_receive_dtl          a,
       wms_goods_lot            b,
       tpl_pub_goods            c,
       tpl_pub_company          f,
       tpl_pub_goods_packs      d,
       wms_goodsstatus          e,
       tpl_goods                h,
       pub_company              o,
       wms_st_section_def       p,
       wms_st_section_def       r,
       wms_container_def        s,
       wms_st_section_def       t,
       tpl_edi_queue            g,
       wms_in_order_dtl         i
 where a.lotid = b.lotid(+)
   and a.goodsid = c.goodsid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.goodsstatusid = e.goodsstatusid(+)
   and a.ownergoodsid = h.ownergoodsid(+)
   and a.qucheckid = o.companyid(+)
   and a.sectionid = p.sectionid(+)
   and a.wholesectionid = r.sectionid(+)
   and a.containerid = s.containerid(+)
   and c.factid = f.companyid(+)
   and a.traysectionid = t.sectionid(+)
   AND g.srcid = a.receiveid
   AND g.queuetype = 51
   AND i.indtlid = a.indtlid
   and nvl(g.expflag, 0) = 0
"
"TPLA_EDI_T380_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_EDI_T380_V"" (""GOODSID"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSWEIGHT"", ""WEIGHTUNIT"", ""BASEPACKID"", ""BASENAME"", ""BASESIZE"", ""BASEPACKSIZE"", ""GOODSOWNERID"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""OWNGOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""USESTATUS"", ""CREATEDATE"", ""CREATEMANID"", ""CREATEMAN"", ""MEMO"") AS 
  select a.goodsid,
         a.goodspackid,
         a.packname,
         a.packsize,
         a.goodslength,
         a.goodswidth,
         a.goodsheight,
         a.goodsweight,
         a.weightunit,
         a.basepackid,
         b.packname basename,
         b.packsize basesize,
         a.basepacksize,
         a.goodsownerid,
         d.goopcode,
         d.goodsownername,
         a.owngoodsid,
         c.opcode,
         c.goodsname,
         c.goodstype,
         a.usestatus,
         a.createdate,
         a.createmanid,
         e.employeename createman,
         a.memo
    from wms_goods_center_pack a,
         tpl_pub_goods_packs b,
         tpl_goods c ,
         tpl_goodsowner d,
         pub_employee e,
         tpl_edi_queue f
    WHERE a.basepackid = b.goodspackid
    AND a.goodsownerid = d.goodsownerid
    AND a.owngoodsid = c.ownergoodsid
    AND a.createmanid = e.employeeid(+)
    AND f.srcid = a.goodspackid
    AND NVL(expflag,0) <> 1
    AND f.queuetype = 52
"
"TPLA_EDI_T390_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_EDI_T390_V"" (""DTLID"", ""DOCID"", ""MAYGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSWEIGHT"", ""WHOLETOTAL"", ""SECTOTAL"", ""POSID"", ""POSNO"", ""POSNAME"", ""GOODSOWNERID"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""MAYGOODSUNITID"", ""MAYGOODSUNIT"", ""COMFIRMDATE"", ""COMFIRMGOODSID"", ""COMFIRMGOODSPACKID"", ""ZHUANDATE"", ""ZHUANMETHOD"", ""USESTATUS"", ""FROMCOMPANY"", ""FROMTRANSCOMPANY"", ""CREATEDATE"", ""RECEIVEDATE"", ""COMFIRMCMPID"", ""COMFIRMCMP"") AS 
  select a.dtlid,
         a.docid,
         a.maygoodsid,
         a.goodsname,
         a.goodstype,
         a.goodspackid,
         a.packname,
         a.packsize,
         a.goodslength,
         a.goodswidth,
         a.goodsheight,
         a.goodsweight,
         a.wholetotal,
         a.sectotal,
         a.posid,
         c.posno,
         c.posname,
         a.goodsownerid,
         b.goopcode,
         b.goodsownername,
         a.maygoodsunitid,
         a.maygoodsunit,
         a.comfirmdate,
         a.comfirmgoodsid,
         a.comfirmgoodspackid,
         a.zhuandate,
         a.zhuanmethod,
         a.usestatus,
         d.fromcompany,
         d.fromtranscompany,
         d.createdate,
         d.receivedate,
         d.comfirmcmpid,
         d.comfirmcmp
    from wms_instans_mange_dtl a,
         tpl_goodsowner b,
         wms_pos_def c,
         wms_instans_mange_doc d,
         tpl_edi_queue e
    WHERE a.docid = d.docid
    AND   a.goodsownerid = b.goodsownerid(+)
    AND   a.posid = c.posid(+)
    AND   e.srcid = a.docid
    AND   e.queuetype = 53
"
"TPLA_EDI_T400_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_EDI_T400_V"" (""GOODSOWNERID"", ""TRADEID"", ""TRADEDATE"", ""OPERATIONTYPE"", ""DTLLINES"", ""USESTATUS"", ""TRADEDTLID"", ""OWNERGOODSID"", ""FROMCOMPANYID"", ""FROMSTORAGEID"", ""FROMGOODSTATUS"", ""FROMQUANSTATUS"", ""FROMBATCHNO"", ""FROMLOTNO"", ""FROMPRODDATE"", ""FROMVALIDDATE"", ""FROMAPPROVENO"", ""TOCOMPANYID"", ""TOSTORAGEID"", ""TOGOODSTATUS"", ""TOQUNSTATUS"", ""TOBATCHNO"", ""TOLOTNO"", ""TOPRODDATE"", ""TOVALIDDATE"", ""TOAPPROVENO"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""GOODSPACKID"", ""QTY"", ""GSTORAGEID"", ""PACKNAME"", ""SRCDTLID"", ""PACKSIZE"", ""WAREHID"", ""PRINTMONTHFLAG"", ""PRINTEXPIREFLAG"", ""FROMVALIDDATE2"", ""TOVALIDDATE2"", ""TOLOTNOFACTNAME"", ""PRODMONTHFLAG"", ""TOPACKSIZE"", ""TOPACKNAME"", ""MAH"", ""TOMAH"") AS 
  select a.Goodsownerid, -- 1 :1:2ID
       a.tradeid, --  2 :3:4:5:6:7ID
       a.Tradedate,
       '00' Operationtype, -- 4 :8:9:10:11
       a.Dtllines, -- 5 :12:13:14:15:16:17:18:19:20
       a.Usestatus, --  6 :21:22:23:24
       b.Tradedtlid, -- 7 :25:26:27:28:29:30ID
       d.goodsownid ownerGoodsid, --  8 :31:32:33:34:35ID
       0 Fromcompanyid, -- 9 调整前货源单位ID
       '' Fromstorageid, --  10  调整前仓别
       ab.gostatusid FromGoodstatus, -- 11  调整前货品状态
       aa.goquantityid Fromquanstatus, -- 12  :36:37:38:39:40:41:42
       '0' Frombatchno, --  13  :43:44:45:46:47
       b.Fromlotno, --  14  :48:49:50:51:52
       b.Fromproddate Fromproddate,
       b.FromValiddate FromValiddate,
       b.FROMAPPROVEDOCNO FromApproveno, -- 17  :53:54:55:56:57:58:59
       0 Tocompanyid,
       '' Tostorageid, --  19  调整后仓别
       ad.gostatusid ToGoodstatus, -- 20  :60:61:62:63:64:65:66
       ac.goquantityid TOQUNSTATUS,
       '0' Tobatchno, --  22  :67:68:69:70:71
       b.Tolotno, --  23  :72:73:74:75:76
       b.Toproddate Toproddate,
       b.ToValiddate ToValiddate,
       b.TOAPPROVEDOCNO ToApproveno, -- 26  :77:78:79:80:81:82:83
       b.Tradegoodsqty, --  27  :84:85:86:87:88:89:90:91
       b.Tradegoodspack, -- 28  :92:93:94:95:96:97
       null Goodspackid, -- 29  :98:99
       b.Qty, --  30  :100:101
       '' gstorageid,
       b.packname,
       a.srcdtlid,
       b.packsize,
       a.warehid, --add by xyue 2016-03-09 新增中间表物流中心字段，用于区分同一核算单元下不同物流中心保管帐
       e.printmonthflag,
       e.printexpireflag,
       e.validdate2 fromvaliddate2,
       e.validdate2 tovaliddate2,
       nvl(e.factname,d.factname) as tolotnofactname,
       e.prodmonthflag,
       xyue_get_trade_topacksize(b.tradedtlid) as topacksize,
       xyue_get_trade_topackname(b.tradedtlid) as topackname,
       e.mah,
       e.mah as tomah
  From Tpl_trade_order           a,
       Tpl_trade_dtl             b,
       tpl_goods                 d,
       tpl_pub_goods_packs       d1,
       tpl_edi_queue             h,
       tpl_owner_quanstatus_def  aa,
       tpl_owner_goodsstatus_def ab,
       tpl_owner_quanstatus_def  ac,
       tpl_owner_goodsstatus_def ad,
       wms_goods_lot             e
 Where a.tradeid = b.tradeid
   and b.ownergoodsid = d.ownergoodsid
   and b.goodspackid = d1.goodspackid
   and a.usestatus = 3
   and h.srcid = a.tradeid
   and a.goodsownerid = aa.goodsownerid
   and a.goodsownerid = ab.goodsownerid
   and b.fromgoodsstatusid = ab.goodsstatusid
   and b.fromquanstatus = aa.quantityid
   and a.goodsownerid = ac.goodsownerid
   and a.goodsownerid = ad.goodsownerid
   and b.togoodsstatusid = ad.goodsstatusid
   and b.toquanstatus = ac.quantityid
   and nvl(h.expflag, 0) = 0
   and h.queuetype = 3
   and nvl(b.qty, 0) <> 0
   and b.togoodsstatusid not in (-4, -3) --change by xyue 2020-08-19 货位丢失、在库丢失不反馈
   and b.tolotid = e.lotid(+)
 Order by a.tradeid
"
"TPLA_EDI_T410_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_EDI_T410_V"" (""GOODSOWNERID"", ""GOODSID"", ""LOTID"", ""OLDLOTNO"", ""NEWLOTNO"", ""INVALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""REGISTDOCNO"", ""SEQID"", ""CRE_DATE"", ""MODIFYID"", ""PRODLICENSENO"", ""LOTNOFACTNAME"", ""TOLOTNOFACTNAME"", ""MEMO"", ""PRINTMONTHFLAG"", ""KILLLOTNO"", ""TOKILLLOTNO"", ""MAH"", ""TOMAH"", ""VALIDDATE2"", ""TOVALIDDATE2"", ""PRODMONTHFLAG"", ""PRINTEXPIREFLAG"") AS 
  select h.goodsownerid,
       b.goodsownid      GOODSID,
       a.lotid           lotid,
       a.lotno           OLDLOTNO,
       a.tolotno         NEWLOTNO,
       a.tovaliddate     INVALIDDATE,
       a.toproddate      PRODDATE,
       a.toapprovedocno  APPROVEDOCNO,
       a.toregistno      REGISTDOCNO,
       h.seqid           SEQID,
       sysdate           CRE_DATE,
       a.modifyid        modifyid,
       a.prodlicenseno   prodlicenseno,
       a.lotnofactname, --批号生产厂家 add by wanghuaiyu 2013年7月25日 18:23:00
       a.tolotnofactname, --调整后的批号生产厂家 add by wanghuaiyu 2013年7月25日 18:23:00
       a.memo,
       d.printmonthflag, --打印精确到时月 add by wanghuaiyu 20130717
       a.killlotno, --add by xyue 2019-12-05 增加灭菌批号的修改
       a.tokilllotno, --add by xyue 2019-12-05 增加灭菌批号的修改
       a.mah, --add by xyue 2019-12-05 增加上市许可持有人的修改
       a.tomah, --add by xyue 2019-12-05 增加上市许可持有人的修改
       a.validdate2,
       a.tovaliddate2,
       d.prodmonthflag,
       d.printexpireflag
  from wms_lot_modify_lst   a,
       tpl_goods            b,
       tpl_edi_queue_t410_v h,
       wms_goods_lot        d
 where a.goodsid = b.waregoodsid
   and b.goodsownerid = h.goodsownerid
   and h.srcid = a.modifyid
   and nvl(h.expflag, 0) = 0
   and h.queuetype = 20
   and a.usestatus = 2
   and b.goodsstatus = 1 -- 解决一个货品主档对应两个ERP货品ID的问题，停用旧记录，xyue 2014-04-29
   and a.lotid = d.lotid
   and h.goodsownerid in
       (select tt.goodsownerid from tpl_goodsowner tt where tt.innerflag = 1) -- add by xyue 2018-07-31 屏蔽外部货主队列
"
"TPLA_EDI_T800_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_EDI_T800_V"" (""GOODSOWNERID"", ""WAREHID"", ""RESPONSEID"", ""RESPONSEDATE"", ""RESPONSETYPEID"", ""DESCR"", ""INOUTFLAG"", ""OPERATIONTYPE"", ""ORDERID"", ""SRCNO"", ""SRCDTLNO"", ""GETBACKTIME"", ""GETBACKMEMO"") AS 
  select b.goodsownerid,
        b.warehid,
        a.responseid,
        a.responsedate,
        a.responsetypeid,
        a.descr,
        '入库' inoutflag,
        a.operationtype,
        a.orderid,
        b.srcno,
        c.srcdtlno,
        c.getbacktime,-- 取回时间 add by wanghuaiyu 20130615
        c.getbackmemo-- 取回备注 add by wanghuaiyu 20130615
 from wms_response a, wms_in_order b, wms_in_order_dtl c, tpl_edi_queue d
where a.responseid = d.srcid
  and nvl(d.expflag,0) = 0
  and d.queuetype = 5
  and b.goodsownerid = d.goodsownerid
  and a.operationtype in (1,2,3,4,5,6,7,8,22,42)
  and a.orderid = c.indtlid
  and c.inid = b.inid
  and a.responsetypeid <> 22
union all
select b.goodsownerid,
        b.warehid,
        a.responseid,
        a.responsedate,
        a.responsetypeid,
        a.descr,
        '入库' inoutflag,
        a.operationtype,
        a.orderid,
        b.srcno,
        c.srcdtlno,
        b.backprintdate getbacktime,-- 打印时间 add by wanghuaiyu 20130615
        '' getbackmemo
 from wms_response a, wms_in_order b, wms_in_order_dtl c, tpl_edi_queue d
where a.responseid = d.srcid
  and nvl(d.expflag,0) = 0
  and d.queuetype = 5
  and b.goodsownerid = d.goodsownerid
  and a.operationtype in (1,2,3,4,5,6,7,8,22,42)
  and a.responsetypeid = 22
  and a.orderid = c.indtlid
  and c.inid = b.inid
union all
select b.goodsownerid,
        b.warehid,
        a.responseid,
        a.responsedate,
        a.responsetypeid,
        a.descr,
        '出库' inoutflag,
        a.operationtype,
        a.orderid,
        b.srcexpno srcno,
        '' srcdtlno,
        null getbacktime, --取回时间 add by wanghuaiyu 20130615
        '' getbackmemo --取回备注 add by wanghuaiyu 20130615
 from wms_response a, wms_out_order b,tpl_edi_queue d
where a.responseid = d.srcid
  and nvl(d.expflag,0) = 0
  and d.queuetype = 5
  and b.goodsownerid = d.goodsownerid
  and a.operationtype in (11,12,13,14,15,16,17,21) --去掉业务类型18-移库出，43-配送出 xyue 2014-11-06
  and a.orderid = b.outid
"
"TPLA_EDI_T810_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_EDI_T810_V"" (""TRID"", ""GOODSOWNERID"", ""GOODSQTY"", ""SIGNQTY"", ""DIFFQTY"", ""SIGNDATE"", ""MEMO"", ""QUEUETYPE"", ""SRCEXPDTLNO"", ""SRCEXPNO"") AS 
  SELECT A.TRID,
       A.GOODSOWNERID,
       Tt.GOODSQTY,
       NVL(D.SIGNQTY, Tt.GOODSQTY) SIGNQTY,
       nvl(D.diffqty, 0) DIFFQTY,
       nvl(d.SIGNDATE, g.credate) signdate,
       D.MEMO,
       g.queuetype,
       t.srcexpdtlno,
       f.srcexpno

  FROM TMS_TR_DOC              A,
       wms_wave_goods_dtl      B,
       wms_out_order_lot_dtl_V tt,
       WMS_OUT_ORDER_DTL_V     T,
       wms_out_order           f,
       ZX_RECEIPT_CHECKDETAIL  D,
       tms_dispatch_dtl        e,
       tpl_edi_queue           g

 WHERE A.SOURCETABLE = 1
   AND A.SOURCEID = B.WAVEDTLID
   AND B.wavegoodsdtlid = TT.wavegoodsdtlid
   AND TT.OUTDTLID = T.outdtlid
   AND TT.outlotid = D.outlotid(+)
   and a.trid = e.trid
   and t.outid = f.outid
   and g.srcid = a.trid
   and g.queuetype = 22
   and g.goodsownerid = a.goodsownerid
   and f.operationtype=11
"
"TPLA_EDI_T820_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_EDI_T820_V"" (""TRID"", ""GOODSOWNERID"", ""GOODSQTY"", ""SIGNQTY"", ""DIFFQTY"", ""SIGNDATE"", ""MEMO"", ""QUEUETYPE"", ""SRCEXPDTLNO"", ""SRCEXPNO"") AS 
  SELECT A.TRID,
       A.GOODSOWNERID,
       Tt.GOODSQTY,
       NVL(D.SIGNQTY, Tt.GOODSQTY) SIGNQTY,
       nvl(D.diffqty, 0) DIFFQTY,
       nvl(d.SIGNDATE, g.credate) signdate,
       D.MEMO,
       g.queuetype,
       t.srcexpdtlno,
       f.srcexpno

  FROM TMS_TR_DOC              A,
       wms_wave_goods_dtl      B,
       wms_out_order_lot_dtl_V tt,
       WMS_OUT_ORDER_DTL_V     T,
       wms_out_order           f,
       ZX_RECEIPT_CHECKDETAIL  D,
       tms_dispatch_dtl        e,
       tpl_edi_queue           g

 WHERE A.SOURCETABLE = 1
   AND A.SOURCEID = B.WAVEDTLID
   AND B.wavegoodsdtlid = TT.wavegoodsdtlid
   AND TT.OUTDTLID = T.outdtlid
   AND TT.outlotid = D.outlotid(+)
   and a.trid = e.trid
   and t.outid = f.outid
   and g.srcid = a.trid
   and g.queuetype = 23
   and g.goodsownerid = a.goodsownerid
   and f.operationtype=11
"
"TPLA_PHYSIC_QUALITY_CHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_PHYSIC_QUALITY_CHECK_V"" (""INID"", ""INDTLID"", ""WAREHID"", ""WAREHNAME"", ""SRCNO"", ""SRCDTLNO"", ""GOODSOWNERID"", ""OPERATIONTYPE"", ""INPUTMAN"", ""ECODEFLAG"", ""CREDATE"", ""DHQTY"", ""BPQTY"", ""GOODSQTY"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""INVOICENO"", ""INVOICECODE"", ""INVOICEDATE"", ""CHECKDOCNO"", ""ELIGIBILITYFLAG"", ""FACEQUALITY"", ""PACKQUALITY"", ""TAB"", ""INSTRUCTIONS"", ""PQFHGZ"", ""PASSGATENO"", ""CHECKMAN1"", ""CHECKMAN2"", ""CHECKDATE"", ""DECISIONFLAG"", ""CHECKRESULT"", ""MEMO"", ""GOODSOWNID"", ""MAH"") AS 
  select i.inid,
       i.indtlid,--订单细单ID
       a.warehid,
       o.warehname,
       r.zxcolumn4 srcno,
       i.dtlzxcolumn4 srcdtlno,
       a.goodsownerid,
       s.ddlid OPERATIONTYPE,
       q.employeename inputman,--录入人，制单人
       null ecodeflag,
       max(a.credate) credate,--制单日期,
       i.goodsqty dhqty,--到货数量,
       sum(a.goodsqty) bpqty,--本批数量,
       sum(a.goodsqty) goodsqty,--合格数量,
       h.lotno,
       decode(to_char(h.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              h.validdate) validdate,
       h.proddate,
       j.invoiceno,
       j.invoicecode,
       to_char(j.invoicedate,'yyyy-mm-dd') invoicedate,
       j.checkdocno,--检验报告书编号
       j.eligibilityflag,--合格证标志
       j.facequality,--外观质量
       j.packquality,--包装质量
       1 tab, --标签情况
       1 instructions,--说明书情况,
       1 pqfhgz,--批签发合格证,
       j.passgateno,--进口通关单号
       q.employeename checkman1,--验收员A
       p.employeename checkman2,--验收员B
       j.checkdate ,--验收日期
       decode(a.quanstatus,1,'合格',3,'不合格','不合格') decisionflag,--验收结论
       --nvl(a.decisionflag,1) decisionflag,
       /*验收结论逻辑：质量状态1=入合格区，质量状态3（不合格）=入不合格区，质量状态2=入退货区*/
       '' checkresult,--验收结果原因分析
       a.memo,--备注
       k.goodsownid, --erp商品编码
       h.mah
  from gsp_physic_quality_check a,
       pub_company              b,
       pub_employee             c,
       tpl_goodsowner           e,
       tpl_pub_goods            f,
       wms_goods_lot            h,
       tpl_warehouse            o,
       wms_in_order_dtl         i,
       wms_receive_dtl          j,
       tpl_goods                k,
       tpl_pub_company          l,
       pub_employee             q,
       pub_employee             p,
       wms_in_order             r,
       TPL_OWNER_DDL_DEF        s,
       tpl_edi_queue            t
 where a.qucheckid = b.companyid(+)
   and a.inputmanid = c.employeeid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.goodsid = f.goodsid(+)
   and a.lotid = h.lotid(+)
   and a.receiveid = j.receiveid
   and i.indtlid = j.indtlid
   and a.warehid = o.warehid
   and a.ownergoodsid = k.ownergoodsid(+)
   and f.factid = l.companyid(+)
   AND a.checkmanid1 = q.employeeid(+)
   AND a.checkmanid2 = p.employeeid(+)
   and r.inid=i.inid
   and 'OWNER_OPERATION' = s.KEYWORD(+)
   and a.OPERATIONTYPE = s.dicid
   and a.goodsownerid=s.goodsownerid
   and r.usestatus=3
   and a.goodsownerid=520
   and j.goodsstatusid=1 --只传合格的
   and t.queuetype=48
   and nvl(t.expflag, 0) = 0
   and i.inid=t.srcid
group by i.inid,
       i.indtlid,--订单细单ID
       a.warehid,
       o.warehname,
       r.zxcolumn4,
       i.dtlzxcolumn4,
       a.goodsownerid,
       s.ddlid,
       --c.employeename,--录入人，制单人
       i.goodsqty,--到货数量,
       h.lotno,
       decode(to_char(h.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              h.validdate),
       h.proddate,
       j.invoiceno,
       j.invoicecode,
       to_char(j.invoicedate,'yyyy-mm-dd'),
       j.checkdocno,--检验报告书编号
       j.eligibilityflag,--合格证标志
       j.facequality,--外观质量
       j.packquality,--包装质量
       j.passgateno,--进口通关单号
       q.employeename,--验收员A
       p.employeename,--验收员B
       j.checkdate ,--验收日期
       decode(a.quanstatus,1,'合格',3,'不合格','不合格'),--验收结论
       --nvl(a.decisionflag,1) decisionflag,
       /*验收结论逻辑：质量状态1=入合格区，质量状态3（不合格）=入不合格区，质量状态2=入退货区*/
       a.memo,--备注
       k.goodsownid, --erp商品编码
       h.mah
"
"TPLA_WMS_GOODSGROUP_ADD_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_WMS_GOODSGROUP_ADD_V"" (""GOODSOWNERID"", ""CREDATE"", ""OTHERID"", ""ERPDOCID"", ""ERPDTLID"", ""GROUPID"", ""OPERATIONTYPE"", ""GOODSID"", ""GOODSQTY"", ""LOTNO"", ""FINDATE"", ""USESTATUS"", ""ERRMSG"") AS 
  select a.goodsownerid,
       sysdate CREDATE,
       a.otherid,
       i.erpdocid,
       j.erpdtlid,
       i.groupid,
       a.operationtype,
       g.goodsownid goodsid,
       b.goodsqty,
       h.lotno,
       d.keepdate findate,
       d.usestatus,
       null errmsg
  from wms_out_order            a,
       wms_out_order_dtl        b,
       tpl_edi_queue            c,
       wms_st_io_doc            d,
       tpl_export_order         e,
       tpl_export_order_dtl     f,
       tpl_goods                g,
       wms_goods_lot            h,
       wms_goodsgroup_order     i,
       wms_goodsgroup_order_dtl j
 where a.outid = b.outid
   and a.oldid = e.exporderid(+)
   and e.srcexpno = i.grouporderid(+)
   and b.olddtlid = f.exporderdtlid(+)
   and f.srcexpdtlno = j.grouporderdtlid(+)
   and a.otherid = c.srcid
   and a.goodsownerid = c.goodsownerid
   and c.queuetype = 2
   and nvl(c.expflag, 0) = 0
   and a.operationtype in (62)
   and b.outdtlid = d.sourceid
   and d.comefrom = 5
   and b.ownergoodsid = g.ownergoodsid(+)
   and b.lotid = h.lotid(+)
"
"TPLA_WMS_GOODSGROUP_DEL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_WMS_GOODSGROUP_DEL_V"" (""GOODSOWNERID"", ""CREDATE"", ""OTHERID"", ""ERPDOCID"", ""ERPDTLID"", ""GROUPID"", ""OPERATIONTYPE"", ""GOODSID"", ""GOODSQTY"", ""LOTNO"", ""FINDATE"", ""USESTATUS"", ""ERRMSG"") AS 
  select a.goodsownerid,
       sysdate CREDATE,
       a.otherid,
       i.erpdocid,
       f.dtlzxcolumn4 erpdtlid,
       i.groupid,
       a.operationtype,
       g.goodsownid goodsid,
       b.goodsqty,
       h.lotno,
       d.keepdate findate,
       d.usestatus,
       null errmsg
  from wms_in_order             a,
       wms_in_order_dtl         b,
       tpl_edi_queue            c,
       wms_st_io_doc            d,
       tpl_purchase_order       e,
       tpl_purchase_order_dtl   f,
       tpl_goods                g,
       wms_goods_lot            h,
       wms_goodsgroup_order     i,
       --wms_goodsgroup_order_dtl j,
       wms_receive_dtl          k
 where a.inid = b.inid
   and b.indtlid=k.indtlid
   and b.porderstatus=5 --上架完成
   and a.oldid = e.porderid(+)
   and e.srcno=i.grouporderid(+)
   and b.olddtlid = f.porderdtlid(+)
   --and f.srcdtlno=j.grouporderdtlid(+)
   and a.otherid = c.srcid
   and a.goodsownerid = c.goodsownerid
   and c.queuetype = 1
   and nvl(c.expflag, 0) = 0
   and a.operationtype in (63)
   and k.receiveid = d.sourceid
   and d.comefrom = 1
   and b.ownergoodsid=g.ownergoodsid(+)
   and b.lotid=h.lotid(+)
"
"TPLA_WMS_GOODSGROUP_FEEDBACK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPLA_WMS_GOODSGROUP_FEEDBACK_V"" (""GOODSOWNERID"", ""CREDATE"", ""OTHERID"", ""ERPDOCID"", ""ERPDTLID"", ""GROUPID"", ""OPERATIONTYPE"", ""GOODSID"", ""GOODSQTY"", ""LOTNO"", ""FINDATE"", ""USESTATUS"", ""ERRMSG"") AS 
  select a.goodsownerid,
       sysdate CREDATE,
       a.otherid,
       i.erpdocid,
       j.erpdtlid,
       i.groupid,
       a.operationtype,
       g.goodsownid goodsid,
       b.goodsqty,
       h.lotno,
       d.keepdate findate,
       d.usestatus,
       null errmsg
  from wms_out_order            a,
       wms_out_order_dtl        b,
       tpl_edi_queue            c,
       wms_st_io_doc            d,
       tpl_export_order         e,
       tpl_export_order_dtl     f,
       tpl_goods                g,
       wms_goods_lot            h,
       wms_goodsgroup_order     i,
       wms_goodsgroup_order_dtl j
 where a.outid = b.outid
   and a.oldid = e.exporderid(+)
   and e.srcexpno = i.grouporderid(+)
   and b.olddtlid = f.exporderdtlid(+)
   and f.srcexpdtlno = j.grouporderdtlid(+)
   and a.otherid = c.srcid
   and a.goodsownerid = c.goodsownerid
   and c.queuetype = 2
   and nvl(c.expflag, 0) = 0
   and a.operationtype in (61)
   and b.outdtlid = d.sourceid
   and d.comefrom = 5
   and b.ownergoodsid = g.ownergoodsid(+)
   and b.lotid = h.lotid(+)
"
"TPL_BACK_REASON_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_BACK_REASON_V"" (""BACKID"", ""BACKREASON"", ""MEMO"", ""USESTATUS"") AS 
  select backid, backreason, memo, usestatus from tpl_back_reason

 "
"TPL_CB_COST_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CB_COST_DTL_V"" (""COSTID"", ""COSTDTLID"", ""ITEMID"", ""ITEMNAME"", ""ITEMTYPE"", ""COST"", ""MEMO"") AS 
  select a.costid,
         a.costdtlid,
         a.itemid,
         b.itemname,
         b.itemtype,
         a.cost,
         a.memo
    from TPL_CB_COST_DTL a,
         TPL_CB_EXPENSE_ITEM b
    where a.itemid=b.itemid(+)

 "
"TPL_CB_COST_ITEM_QRY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CB_COST_ITEM_QRY_V"" (""USEMM"", ""COST"", ""ITEMID"", ""ITEMNAME"", ""USEYEAR"", ""USEMONTH"", ""TOTALCOST"", ""RATE"") AS 
  select d.usemm,d.cost,d.itemid,e.itemname,h.useyear,h.usemonth,n.totalcost,(round((d.cost/n.totalcost),4)*100) as rate
from
(select b.usemm,sum(a.cost) cost ,a.itemid from TPL_CB_COST_DTL a,TPL_CB_COST b
 where a.costid=b.costid(+)
 group by  b.usemm,a.itemid
 order by  b.usemm ,a.itemid ) d ,
 TPL_CB_EXPENSE_ITEM e,TPRICE_USEMM h,
 (select m.usemm,sum(m.totalcost) as totalcost from TPL_CB_COST m group by m.usemm order by m.usemm asc ) n
 where d.itemid=e.itemid(+)
 and d.usemm=h.usemm(+)
 and d.usemm=n.usemm(+)

 "
"TPL_CB_COST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CB_COST_V"" (""COSTID"", ""WAREHID"", ""WAREHNAME"", ""WAREHOPCODE"", ""USEMM"", ""TOTALCOST"", ""MEMO"") AS 
  select a.costid,
         a.warehid,
         b.warehname,
         b.warehopcode,
         a.usemm,
         a.totalcost,
         a.memo
    from TPL_CB_COST a ,
         tpl_warehouse b

  where a.warehid=b.warehid(+)

 "
"TPL_CB_COST_WHITEM_QRY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CB_COST_WHITEM_QRY_V"" (""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""USEMM"", ""COST"", ""ITEMID"", ""ITEMNAME"", ""USEYEAR"", ""USEMONTH"", ""RATE"", ""TOTALCOST"") AS 
  select d.warehid,g.warehopcode,g.warehname, d.usemm,d.cost,d.itemid,e.itemname,h.useyear,h.usemonth,(round((d.cost/n.totalcost),4)*100) as rate,n.totalcost
 from
(select b.warehid,b.usemm,sum(a.cost) cost ,a.itemid from TPL_CB_COST_DTL a,TPL_CB_COST b
 where a.costid=b.costid(+)
 group by  b.warehid,b.usemm,a.itemid
 order by  b.warehid asc,b.usemm asc,a.itemid ) d ,TPL_CB_EXPENSE_ITEM e,TPRICE_USEMM h, tpl_warehouse g,
 (select m.warehid, m.usemm,sum(m.totalcost) as totalcost from TPL_CB_COST m group by m.warehid, m.usemm order by m.warehid asc,m.usemm asc ) n
 where d.itemid=e.itemid(+)
 and d.usemm=h.usemm(+)
 and d.warehid=g.warehid(+)
 and d.warehid=n.warehid(+)
 and d.usemm=n.usemm(+)

 "
"TPL_CB_EXPENSE_ITEM_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CB_EXPENSE_ITEM_V"" (""ITEMID"", ""ITEMNAME"", ""ITEMTYPE"", ""MEMO"") AS 
  select a.itemid,
         a.itemname,
         a.itemtype,
         a.memo
    from TPL_CB_EXPENSE_ITEM a

 "
"TPL_CB_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CB_LST_V"" (""LSTID"", ""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""COST1"", ""EVALUEATE1"", ""COST2"", ""EVALUEATE2"", ""COST3"", ""EVALUEATE3"", ""SUMCOST"") AS 
  select a.lstid,
         a.warehid,
         b.warehopcode,
         b.warehname,
         a.usemm,
         c.useyear,
         c.usemonth,
         a.cost1,
         a.evalueate1,
         a.cost2,
         a.evalueate2,
         a.cost3,
         a.evalueate3,
         a.sumcost
    from TPL_CB_LST a,
         tpl_warehouse b,
         TPRICE_USEMM c
    where a.warehid=b.warehid(+)
    and a.usemm=c.usemm(+)

 "
"TPL_CB_OPGDS_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CB_OPGDS_LST_V"" (""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""GOODSCLASS"", ""GOODSCLASSNAME"", ""SUMCOST"", ""SUMPACKS"", ""EVALUEATE"", ""KEYID"", ""USEMMSUMCOST"", ""RATE"") AS 
  select a.warehid,
        b.warehopcode,
        b.warehname,
         a.usemm,
           c.useyear,
         c.usemonth,
        a.goodsclass,
         d.ddlname as goodsclassname,
         a.sumcost,
         a.sumpacks,
         a.evalueate,
         a.keyid,
            e.sumcost as usemmsumcost,
       (round((a.sumcost/e.sumcost),4)*100) as rate
    from TPL_CB_OPGDS_LST a,
    tpl_warehouse b,
    TPRICE_USEMM c,
   sys_ddl_all_v d,
     TPL_CB_OP_STATISTICS e
    where a.warehid=b.warehid(+)
           and a.usemm=c.usemm(+)
           and a.goodsclass=d.ddlid(+)
           and d.keyword='WMS_GOODS_CLASS'
            and a.warehid=e.warehid(+)
           and a.usemm=e.usemm(+)
           order by a.warehid,a.usemm,a.goodsclass

 "
"TPL_CB_OPGG_TATISTICS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CB_OPGG_TATISTICS_V"" (""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""GOODSCLASS"", ""GOODSCLASSNAME"", ""SUMCOST"", ""SUMPACKS"", ""EVALUEATE"", ""KEYID"", ""USEMMSUMCOST"", ""RATE"") AS 
  select a.warehid,
         b.warehopcode,
         b.warehname,
         a.usemm,
         d.useyear,
         d.usemonth,
         a.goodsownerid,
         c.goodsownername,
         c.goopcode,
         a.goodsclass,
         e.ddlname as goodsclassname,
         a.sumcost,
         a.sumpacks,
         a.evalueate,
         a.keyid,
          f.sumcost as usemmsumcost,
       (round((a.sumcost/decode(f.sumcost,0,1,f.sumcost)),4)*100) as rate--dengshaobo 修改
    from TPL_CB_OPGG_TATISTICS a,
         tpl_warehouse b,
         tpl_goodsowner c,
           TPRICE_USEMM d,
            sys_ddl_all_v e,
               TPL_CB_OPGO_LST_V f
    where a.warehid=b.warehid(+)
    and a.goodsownerid=c.goodsownerid(+)
    and a.usemm=d.usemm(+)
      and a.goodsclass=e.ddlid(+)
           and e.keyword='WMS_GOODS_CLASS'
             and a.warehid=f.warehid(+)
        and a.usemm=f.usemm(+)
        and a.goodsownerid=f.goodsownerid(+)
        order by a.warehid,a.usemm,a.goodsownerid,a.goodsclass

 "
"TPL_CB_OPGO_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CB_OPGO_LST_V"" (""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""SUMCOST"", ""SUMPACKS"", ""EVALUEATE"", ""KEYID"", ""USEMMSUMCOST"", ""RATE"") AS 
  select a.warehid,
        b.warehopcode,
        b.warehname,
         a.usemm,
         d.useyear,
         d.usemonth,
         a.goodsownerid,
         c.goodsownername,
         c.goopcode,
         a.sumcost,
         a.sumpacks,
         a.evalueate,
         a.keyid,
           e.sumcost as usemmsumcost,
       (round((a.sumcost/e.sumcost),4)*100) as rate
    from TPL_CB_OPGO_LST a,
         tpl_warehouse b,
         tpl_goodsowner c,
         TPRICE_USEMM d,
          TPL_CB_OP_STATISTICS e
   where a.warehid=b.warehid(+)
        and a.goodsownerid=c.goodsownerid(+)
        and a.usemm=d.usemm(+)
           and a.warehid=e.warehid(+)
           and a.usemm=e.usemm(+)
           order by a.warehid,a.usemm,a.goodsownerid

 "
"TPL_CB_OP_APPORTIONMENT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CB_OP_APPORTIONMENT_V"" (""KEYID"", ""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""USEMM"", ""SUMCOST"", ""MEMO"", ""USEYEAR"", ""USEMONTH"") AS 
  select  a.keyid,
         a.warehid,
         b.warehopcode,
         b.warehname,
         a.usemm,
         a.sumcost,
         a.memo,
         c.useyear,
         c.usemonth
    from TPL_CB_OP_APPORTIONMENT a,
         tpl_warehouse b,
         tprice_usemm c
    where a.warehid=b.warehid(+)
          and a.usemm=c.usemm(+)

 "
"TPL_CB_OP_STATISTICS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CB_OP_STATISTICS_V"" (""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""LSTID"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""SUMCOST"", ""SUMPACKS"", ""EVALUEATE"", ""MEMO"") AS 
  select a.warehid,
         b.warehopcode,
         b.warehname,
         a.lstid,
         a.usemm,
         c.useyear,
         c.usemonth,
         a.sumcost,
         a.sumpacks,
         a.evalueate,
         a.memo
    from TPL_CB_OP_STATISTICS a,
         tpl_warehouse b,
         TPRICE_USEMM c
    where a.warehid=b.warehid(+)
          and a.usemm=c.usemm(+)

 "
"TPL_CB_STGDS_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CB_STGDS_LST_V"" (""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""GOODSCLASS"", ""GOODSCLASSNAME"", ""STCOST"", ""SUMCOST"", ""SUMPACKS"", ""EVALUEATE"", ""FULLEVALUEATE"", ""KEYID"", ""USEMMSUMCOST"", ""RATE"") AS 
  select a.warehid,
         b.warehopcode,
         b.warehname,
         a.usemm,
          c.useyear,
         c.usemonth,
         a.goodsclass,
           d.ddlname as goodsclassname,
         a.stcost,
         a.sumcost,
         a.sumpacks,
         a.evalueate,
         a.fullevalueate,
         a.keyid,
            e.sumcost as usemmsumcost,
           (round((a.sumcost/e.sumcost),4)*100) as rate
    from TPL_CB_STGDS_LST a,
         tpl_warehouse b,
          TPRICE_USEMM c,
          sys_ddl_all_v d,
            TPL_CB_ST_STATISTICS e
    where a.warehid=b.warehid(+)
        and a.usemm=c.usemm(+)
        and a.goodsclass=d.ddlid(+)
        and d.keyword='WMS_GOODS_CLASS'
        and a.warehid=e.warehid(+)
        and a.usemm=e.usemm(+)
        order by a.warehid,a.usemm,a.goodsclass

 "
"TPL_CB_STGG_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CB_STGG_LST_V"" (""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""GOODSCLASS"", ""GOODSCLASSNAME"", ""STCOST"", ""SUMCOST"", ""SUMPACKS"", ""EVALUEATE"", ""FULLEVALUEATE"", ""MEMO"", ""KEYID"", ""USEMMSUMCOST"", ""RATE"") AS 
  select a.warehid,
         b.warehopcode,
         b.warehname,
         a.usemm,
         d.useyear,
         d.usemonth,
         a.goodsownerid,
         c.goodsownername,
         c.goopcode,
         a.goodsclass,
           e.ddlname as goodsclassname,
         a.stcost,
         a.sumcost,
         a.sumpacks,
         a.evalueate,
         a.fullevalueate,
         a.memo,
         a.keyid,
            f.sumcost as usemmsumcost,
           (round((a.sumcost/f.sumcost),4)*100) as rate
    from TPL_CB_STGG_LST a,
         tpl_warehouse b,
         tpl_goodsowner c,
           TPRICE_USEMM d,
            sys_ddl_all_v e,
            TPL_CB_STGO_LST f
    where a.warehid=b.warehid(+)
    and a.goodsownerid=c.goodsownerid(+)
    and a.usemm=d.usemm(+)
    and a.goodsclass=e.ddlid(+)
    and e.keyword='WMS_GOODS_CLASS'
    and a.warehid=f.warehid(+)
    and a.usemm=f.usemm(+)
    and a.goodsownerid=f.goodsownerid(+)
    order by a.warehid,a.usemm,a.goodsownerid,a.goodsclass

 "
"TPL_CB_STGO_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CB_STGO_LST_V"" (""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""STCOST"", ""SUMCOST"", ""SUMPACKS"", ""EVALUEATE"", ""FULLEVALUEATE"", ""KEYID"", ""USEMMSUMCOST"", ""RATE"") AS 
  select a.warehid,
         b.warehopcode,
         b.warehname,
         a.usemm,
         d.useyear,
         d.usemonth,
         a.goodsownerid,
         c.goodsownername,
         c.goopcode,
         a.stcost,
         a.sumcost,
         a.sumpacks,
         a.evalueate,
         a.fullevalueate,
         a.keyid,
         e.sumcost as usemmsumcost,
           (round((a.sumcost/e.sumcost),4)*100) as rate
    from TPL_CB_STGO_LST a,
    tpl_warehouse b,
    tpl_goodsowner c,
     TPRICE_USEMM d,
     TPL_CB_ST_STATISTICS e
   where a.warehid=b.warehid(+)
   and a.goodsownerid=c.goodsownerid(+)
   and a.usemm=d.usemm(+)
      and a.warehid=e.warehid(+)
        and a.usemm=e.usemm(+)
        order by a.warehid,a.usemm,a.goodsownerid

 "
"TPL_CB_ST_STATISTICS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CB_ST_STATISTICS_V"" (""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""LSTID"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""STCOST"", ""MNCOST"", ""SUMCOST"", ""SUMPACKS"", ""EVALUEATE"", ""FULLEVALUEATE"", ""MEMO"") AS 
  select a.warehid,
         b.warehopcode,
         b.warehname,
         a.lstid,
         a.usemm,
          c.useyear,
         c.usemonth,
         a.stcost,
         a.mncost,
         a.sumcost,
         a.sumpacks,
         a.evalueate,
         a.fullevalueate,
         a.memo
    from TPL_CB_ST_STATISTICS a ,
         tpl_warehouse b,
         TPRICE_USEMM c
    where a.warehid=b.warehid(+)
     and a.usemm=c.usemm(+)

 "
"TPL_CB_TRANS_REGION_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CB_TRANS_REGION_LST_V"" (""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""LSTID"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""REGIONID"", ""REGIONNAME"", ""SUMCOST"", ""SUMDISTANCE"", ""EVALUEATE"", ""SUMCOST1"", ""SUMDISTANCE1"", ""EVALUEATE1"", ""SUMCOST2"", ""SUMDISTANCE2"", ""EVALUEATE2"", ""MEMO"", ""RATE1"", ""RATE2"") AS 
  select a.warehid,
         b.warehopcode,
         b.warehname,
         a.lstid,
         a.usemm,
         d.useyear,
         d.usemonth,
         a.regionid,
         c.regionname,
         a.sumcost,
         a.sumdistance,
         a.evalueate,
         a.sumcost1,
         a.sumdistance1,
         a.evalueate1,
         a.sumcost2,
         a.sumdistance2,
         a.evalueate2,
         a.memo,
          (round((a.sumcost1/a.sumcost),4)*100) as rate1,
          (round((a.sumcost2/a.sumcost),4)*100) as rate2
    from TPL_CB_TRANS_REGION_LST a,
         tpl_warehouse b,
         TPRICE_TRANS_REGION c,
          TPRICE_USEMM d
    where a.warehid=b.warehid(+)
          and a.regionid=c.regionid(+)
          and a.usemm=d.usemm(+)
          order by a.warehid,a.usemm,a.regionid

 "
"TPL_CB_TRANS_STATISTICS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CB_TRANS_STATISTICS_V"" (""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""LSTID"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""SUMCOST"", ""SUMDISTANCE"", ""EVALUEATE"", ""SUMCOST1"", ""SUMDISTANCE1"", ""EVALUEATE1"", ""SUMCOST2"", ""SUMDISTANCE2"", ""EVALUEATE2"", ""MEMO"", ""RATE1"", ""RATE2"") AS 
  select a.warehid,
         b.warehopcode,
         b.warehname,
         a.lstid,
         a.usemm,
          c.useyear,
         c.usemonth,
         a.sumcost,
         a.sumdistance,
         a.evalueate,
         a.sumcost1,
         a.sumdistance1,
         a.evalueate1,
         a.sumcost2,
         a.sumdistance2,
         a.evalueate2,
         a.memo,
         (round((a.sumcost1/a.sumcost),4)*100) as rate1,
          (round((a.sumcost2/a.sumcost),4)*100) as rate2
    from TPL_CB_TRANS_STATISTICS a,
         tpl_warehouse b,
          TPRICE_USEMM c
    where a.warehid=b.warehid(+)
      and a.usemm=c.usemm(+)
      order by a.warehid,a.usemm

 "
"TPL_CITY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CITY_V"" (""CITYID"", ""CITYOPCODE"", ""CITYNAME"", ""PROVINCEID"", ""DISTRICTID"", ""PROVINCEOPCODE"", ""PROVINCENAME"", ""DISTRICTOPCODE"", ""DISTRICTNAME"") AS 
  select a.""CITYID"",
       a.""CITYOPCODE"",
       a.""CITYNAME"",
       a.""PROVINCEID"",
       a.""DISTRICTID"",
       b.provinceopcode,
       b.provincename,
       c.districtopcode,
       c.districtname
  from ""TPL_CITY"" a, tpl_province b, tpl_district c
 where a.provinceid = b.provinceid(+)
   and a.districtid = c.districtid(+)

 "
"TPL_CONSOLE_OPERATOR_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CONSOLE_OPERATOR_V"" (""EMPLOYEEID"", ""WAREHID"", ""CONSOLE_NO"", ""CONSOLE_PASSWORD"", ""OPCODE"", ""EMPLOYEENAME"", ""USESTATUS"", ""WAREHNAME"", ""WAREHOPCODE"", ""REAL_PASSWORD"") AS 
  SELECT a.employeeid,
       a.warehid,
       a.console_no,
       '******' console_password,
       b.opcode,
       b.employeename,
       a.usestatus,
       c.warehname,
       c.warehopcode,
       a.console_password as real_password
  from TPL_CONSOLE_OPERATOR a, Pub_employee b, tpl_warehouse c
 where a.employeeid = b.employeeid
   and a.warehid = c.warehid(+)
"
"TPL_CUST_RETVISIT_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CUST_RETVISIT_LST_V"" (""LSTID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""COMPANYID"", ""COMPANYNAME"", ""TARGET"", ""DESCR"", ""DEALING"", ""NEXTDOING"", ""DEALMANID"", ""DEALMANNAME"", ""DEALDATE"", ""COMPANYOPCODE"") AS 
  select  lstid,
          a.credate,
          a.inputmanid,
          b.employeename inputmanname,
          companyid,
          companyname,
          target,
          descr,
          dealing,
          nextdoing,
          dealmanid,
          c.employeename dealmanname,
          dealdate,
          a.companyopcode
    from tpl_cust_retvisit_lst a,pub_employee b,pub_employee c
    WHERE a.inputmanid = b.employeeid(+)
    AND   a.dealmanid = c.employeeid(+)
"
"TPL_CUST_SERVICE_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_CUST_SERVICE_LST_V"" (""LSTID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""LSTTYPE"", ""COMPANYID"", ""COMPANYNAME"", ""COMPANYOPCODE"", ""DESCR"", ""DEALING"", ""DEALMANID"", ""DEALMANNAME"", ""DEALDATE"", ""USESTATUS"", ""ADMISSIBLENO"", ""ENDDATE"", ""ENDMANID"", ""ENDMANNAME"", ""RESPDEPT"", ""RESPDEPTNAME"", ""GSI"", ""ISFEEDBACK"", ""CONTENTTYPE"") AS 
  select    a.lstid,
          a.credate,
          a.inputmanid,
          b.employeename inputmanname,
          a.lsttype,
          a.companyid,
          a.companyname,
          a.companyopcode,
          a.descr,
          a.dealing,
          a.dealmanid,
          c.employeename dealmanname,
          a.dealdate,
          a.usestatus,
          a.admissibleno,
          a.enddate,
          a.endmanid,
          d.employeename endmanname,
          a.respdept,
          e.companyname respdeptname,
          a.gsi,
          a.isfeedback,
          a.contenttype
    from tpl_cust_service_lst a,
         pub_employee b,pub_employee c,pub_employee d,
         pub_dept_v e
    WHERE a.inputmanid = b.employeeid(+)
    AND   a.dealmanid = c.employeeid(+)
    and   a.endmanid = d.employeeid(+)
    and a.respdept = e.companyid
"
"TPL_DAYCUT_SETUP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_DAYCUT_SETUP_V"" (""KEYID"", ""TASKID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""CONNECTOR"", ""CONNPHONE"", ""PRIORITY"", ""EXEFLAG"", ""WAREHID"", ""WAREHNAME"", ""WAREHOPCODE"", ""WAREHSHORTNAME"", ""WAREHNO"") AS 
  select t.keyid,
         t.taskid,
         t.goodsownerid,
         a.goodsownername,
         a.goopcode,
         a.connector,
         a.connphone,
         t.priority,
         t.exeflag,
         t.warehid,
         b.warehname,
          b.warehopcode,
          b.warehshortname,
          b.warehno
    from tpl_daycut_setup t,tpl_goodsowner a,tpl_warehouse b
   where t.goodsownerid = a.goodsownerid(+)
   AND t.warehid = b.warehid(+)

 "
"TPL_DAYCUT_TASK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_DAYCUT_TASK_V"" (""TASKID"", ""TASKNAME"", ""DESCR"", ""PROGTYPE"", ""PROGNAME"", ""PRIORITY"", ""EXEFLAG"") AS 
  select taskid,
         taskname,
         descr,
         progtype,
         progname,
         priority,
         exeflag
    from tpl_daycut_task

 "
"TPL_DISTRICT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_DISTRICT_V"" (""DISTRICTID"", ""DISTRICTNAME"", ""MEMO"", ""USESTATUS"", ""DISTRICTOPCODE"") AS 
  select districtid, districtname, memo, usestatus, districtopcode
  from tpl_district

 "
"TPL_EDI_GSP_QUALITY_RECHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_EDI_GSP_QUALITY_RECHECK_V"" (""FEEDBACKID"", ""CREDATE"", ""GOODSOWNERID"", ""GCOMPANYID"", ""COMPANYNAME"", ""GOODSOWNID"", ""GOODSQTY"", ""CHECKQTY"", ""REALQTY"", ""LOTNO"", ""APPROVEDOCNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSSITUTION"", ""EMPLOYEENAME"", ""ZGYIDEA"") AS 
  select t.feedbackid,
       t.credate,
       t.goodsownerid,
       a.gcompanyid,
       t.companyname,
       t.goodsownid,
       t.goodsqty,
       t.checkqty,
       t.realqty,
       t.lotno,
       t.approvedocno,
       t.proddate,
       t.validdate,
       t.goodssitution,
       t.employeename,
       t.zgyidea
from ZX_GSP_QUALITY_FEEDBACK_v t,tpl_edi_queue tt,tpl_go_company a
where t.feedbackid = tt.srcid
   and tt.queuetype=45
   and t.usestatus=1
   and nvl(tt.expflag, 0) = 0
   and t.companyid = a.companyid
"
"TPL_EDI_QUEUE_GOODSGROUP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_EDI_QUEUE_GOODSGROUP_V"" (""SEQID"", ""GOODSOWNERID"", ""QUEUETYPE"", ""SRCID"") AS 
  select c.seqid,c.goodsownerid,a.operationtype queuetype, c.srcid
  from wms_out_order a,tpl_edi_queue c
 where a.otherid = c.srcid
   and a.goodsownerid = c.goodsownerid
   and c.queuetype=2
   and a.operationtype in (61,62)
union all
select c.seqid,c.goodsownerid,a.operationtype queuetype, c.srcid
  from wms_in_order a,tpl_edi_queue c
 where a.otherid = c.srcid
   and a.goodsownerid = c.goodsownerid
   and c.queuetype=1
   and a.operationtype in (63)
"
"TPL_EDI_QUEUE_T340_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_EDI_QUEUE_T340_V"" (""GOODSOWNERID"", ""QUEUETYPE"", ""SRCID"", ""EXPFLAG"") AS 
  select distinct t.goodsownerid, t.queuetype, t.srcid, t.expflag
  from tpl_edi_queue t
 where t.queuetype = 2
"
"TPL_EDI_QUEUE_T410_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_EDI_QUEUE_T410_V"" (""GOODSOWNERID"", ""QUEUETYPE"", ""SRCID"", ""EXPFLAG"", ""SEQID"") AS 
  select distinct t.goodsownerid, t.queuetype, t.srcid, t.expflag,min(t.seqid) seqid
  from tpl_edi_queue t
 where t.queuetype = 20
 group by t.goodsownerid, t.queuetype, t.srcid, t.expflag
"
"TPL_EDI_QUEUE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_EDI_QUEUE_V"" (""GOODSOWNERID"", ""CREDATE"", ""QUEUETYPE"", ""SRCID"", ""EXPDATE"", ""EXPFLAG"", ""SEQID"", ""TABTYPEID"", ""TABLENAME"", ""DESCR"", ""VIEWNAME"", ""KEYCOLUMN"") AS 
  select ""GOODSOWNERID"",""CREDATE"",""QUEUETYPE"",""SRCID"",""EXPDATE"",""EXPFLAG"",""SEQID"",""TABTYPEID"",""TABLENAME"",""DESCR"",""VIEWNAME"",""KEYCOLUMN""
  from tpl_edi_queue a,(select t.tabtypeid,t.tablename, t.descr, t.viewname,t.keycolumn
  from tpla_swap_data_cfg t
 where t.goodsownerid = 1
   and t.clientproctype = 2) b
   where a.queuetype=b.tabtypeid(+)
"
"TPL_EDI_SHGL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_EDI_SHGL_V"" (""INID"", ""GOODSOWNERID"", ""ZXCOLUMN4"", ""OPERATIONTYPE"", ""CREDATE"", ""ARRIVEDATE"", ""GCOMPANYID"", ""SRCCOMPANYNAME"", ""SRCNO"", ""WAREHID"", ""ZXCOLUMN2"", ""GOODSOWNID"", ""GOODSCLASS"", ""GOODSQTY"", ""DTLZXCOLUMN4"", ""QTY"", ""DHWD"", ""SHQK"", ""YCFLAG"", ""CLFLAG"", ""YSFS"", ""YSTJ"", ""TRANSNAME"", ""SHDATE"", ""SHR"", ""PZXFFLAG"", ""QYWD"", ""WDCJDATE"", ""TZWDFLAG"", ""CJQNO"", ""QYDATE"", ""DHDATE"", ""TRANSNO"", ""TRANSTOOLS"", ""MAH"") AS 
  select b.inid,
       a.goodsownerid, --货主ID
       a.zxcolumn4, --ERP总单ID
       a.operationtype, --业务类型
       a.credate, --制单日期
       a.arrivedate, --预定到货日
       d.gcompanyid,--货主原单位ID
       d.companyname srccompanyname, --来货单位名称
       a.srcno, --来源细单ID
       a.warehid, --物流中心ID
       a.zxcolumn2, --采购员
       j.goodsownid, --货主原货品ID
       (select t.goodsclass
          from wms_goods_feature t
         where t.warehid = a.warehid
           and t.goodsid = b.goodsid) goodsclass, --存储分类
       b.goodsqty, --原单数量
       b.dtlzxcolumn4, --ERP细单ID
       b.qty, --收货数量
       b.dhwd, --到货温度
       b.shqk, --收货情况
       b.ycflag, --异常标志
       b.clflag, --处理标志
       B.YSFS, --运输方式
       B.YSTJ, --运输条件
       h.transname, --运输方式
       b.shdate, --收货日期
       tt.username shr,
       nvl(b.pzxfflag,0) pzxfflag,
       b.qywd,
       b.wdcjdate,
       b.tzwdflag,
       b.cjqno,
       b.qydate,
       b.dhdate1 dhdate,
       b.transno,
       b.transtools,
       j.mah
  from wms_in_order       a,
       wms_in_order_dtl   b,
       tpl_go_company     d,
       wms_transport_mode h,
       tpl_goods          j,
       tpl_edi_queue      q,
       (select distinct t.userid,t.username,t.pkvalue from np_update_log t where t.tablename='WMS_IN_ORDER_DTL') tt,
       TPL_OWNER_DDL_DEF  c
 where a.inid = b.inid
   and b.ownergoodsid = j.ownergoodsid
   and b.ysfs = h.transmodeid(+)
   and a.sourcecompanyid = d.companyid(+)
   and q.queuetype=44
   and nvl(q.expflag, 0) = 0
   and a.inid=q.srcid
   and b.indtlid=tt.pkvalue(+)
   and 'OWNER_OPERATION' = C.KEYWORD(+)
   and a.OPERATIONTYPE = C.dicid
   and a.goodsownerid=c.goodsownerid
"
"TPL_ERP_CONN_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_ERP_CONN_LST_V"" (""GOODSOWNERID"", ""REMOTEIP"", ""LASTLOGONDATE"", ""LASTLOGOFFDATE"", ""USESTATUS"", ""REMOTEMAC"", ""LASTLXTIME"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""PROVINCE"", ""CITYNAME"", ""RUNSTATUS"") AS 
  select a.goodsownerid,
       a.remoteip,
       a.lastlogondate,
       a.lastlogoffdate,
       decode(a.usestatus, 0, '未连接', 1, '已连接', '') usestatus,
       a.remotemac,
       a.lastlxtime,
       b.goodsownername,
       b.goopcode,
       b.province,
       c.cityname,
       decode(nvl(a.runstatus,0), 0, '未连接', 1, '已连接', '') runstatus
  from tpl_erp_conn_lst a, tpl_goodsowner b, tpl_city c
 WHERE a.goodsownerid = b.goodsownerid
   and b.cityid = c.cityid(+)
"
"TPL_EXPORT_ORDER_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_EXPORT_ORDER_DTL_V"" (""EXPORDERID"", ""EXPORDERDTLID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""PRODAREA"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""PRICE"", ""GOODSQTY"", ""REALQTY"", ""GOODSPACKID"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""CUSTCANCELSTATUS"", ""WMSCANCELSTATUS"", ""ADDMEDCHECKFLAG"", ""SRCEXPDTLNO"", ""USESTATUS"", ""GTRADEPACK"", ""PRINTFLAG"", ""PRINTERROR"", ""DTLMEMO"", ""DISTRIBUTEID"", ""DISTRIBUTEDTLID"", ""RETAILPRICE"", ""AMT"", ""ALLOCATETIME"", ""FAILREASON"", ""EXPDTLMEMO"", ""PLACESUPPLYID"", ""PLACESUPPLYDTLID"", ""PLACEPRICE"", ""RESALEPRICE"", ""PLACEMONEY"", ""GOODSCLASSID"", ""TRADEMARK"", ""APPROVEDOCNO"", ""PRODDATE"", ""QUALIFYDOCNO"", ""GOODSCLASSNAME"", ""TPRICETICK"", ""TPRICEFLAG"", ""GOODSOWNID"", ""PACKSIZE"", ""INVNO"", ""PACKNAME"", ""PRTORDERSET"", ""SORTTYPE"", ""LOTLIMIT"", ""PERIODLIMIT"", ""PERIODLIMITUNIT"", ""OTCFLAG"", ""CANCELDATE"", ""CANCELMANID"", ""CANCELMANNAME"", ""DTLZXCOLUMN4"", ""FROM_SUDTLID"", ""DTLMEMO1"") AS 
  select a.exporderid,
       a.exporderdtlid,
       a.ownergoodsid,
       a.goodsid,
       b.opcode goodsopcode,
       b.goodsname,
       b.goodstype,
       b.factname,
       b.prodarea,
       a.batchno,
       a.lotid,
       a.lotno,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.goodsstatusid,
       c.goodsstatus,
       a.quantitystatus,
       a.price,
       a.goodsqty,
       a.realqty,
       a.goodspackid,
       a.tradegoodsqty,
       a.tradegoodspack,
       a.custcancelstatus,
       a.wmscancelstatus,
       a.addmedcheckflag,
       a.srcexpdtlno,
       a.usestatus,
       a.gtradepack,
       decode(a.printflag, null, null, 1) printflag,
       a.printerror,
       a.dtlmemo,
       a.distributeid,
       a.distributedtlid,
       a.retailprice,
       a.amt,
       a.allocatetime,
       a.failreason,
       a.expdtlmemo,
       a.placesupplyid,
       a.placesupplydtlid,
       a.placeprice,
       a.resaleprice,
       a.placemoney,
       a.goodsclassid,
       -- a.otcflag,
       a.trademark,
       --a.approvedocno,
       b.approvedocno,
       -- 修改货主入库订单取货主货品的批准文号，让【收货验收】新增细单时默认为货主货品的批准文号，xyue 2014年1月22日 13:16:54
       a.proddate,
       a.qualifydocno,
       a.goodsclassname,
       a.tpricetick,
       a.tpriceflag,
       a.goodsownid,
       a.packsize,
       a.invno,
       a.packname,
       a.prtorderset,
       a.sorttype,
       a.lotlimit,
       a.periodlimit,
       a.periodlimitunit,
       nvl(b.otcflag, 0) otcflag,
       a.canceldate,
       a.cancelmanid,
       d.employeename cancelmanname,
       a.dtlzxcolumn4, --ERP细单ID add by wanghuaiyu 2013年8月7日 18:32:40
       a.from_sudtlid,
       a.dtlmemo1
  from tpl_export_order_dtl a,
       tpl_goods            b,
       wms_goodsstatus_v    c,
       pub_employee         d
 where a.ownergoodsid = b.ownergoodsid(+)
   and a.goodsstatusid = c.goodsstatusid(+)
   and a.cancelmanid = d.employeeid(+)
"
"TPL_EXPORT_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_EXPORT_ORDER_V"" (""WAREHID"", ""WAREHNAME"", ""WAREHOPCODE"", ""GOODSOWNERID"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""EXPORDERID"", ""EORDERNO"", ""LINENO"", ""CREDATE"", ""PREEXPDATE"", ""EXPDATE"", ""PREARRIVEDATE"", ""ARRIVEDATE"", ""PTRANSMODEID"", ""TRANSMODEID"", ""TRANSMODE"", ""TRANSNAME"", ""EARLYDATE"", ""COMPOSEINFO"", ""TRANSNO"", ""RECCOMPANYID"", ""RECCOMPANYOPCODE"", ""RECCOMPANYNAME"", ""COMPANYTYPE"", ""TAXFLAG"", ""INPUTMANID"", ""IMPUTMANNAME"", ""JOBTYPE"", ""OPERATIONTYPE"", ""MEDICINECLASS"", ""RECEIVEADDR"", ""RECEIVEHEAD"", ""REALRECADDR"", ""REALRECMAN"", ""RECEIVEMAN"", ""SIGNMAN"", ""PARTEXPFLAG"", ""SAMELOTFLAG"", ""URGENFLAG"", ""ADDINVOICEFLAG"", ""ARRIVEMEMO"", ""EXPORTMEMO"", ""DETAILLINES"", ""SRCEXPNO"", ""NOWLFLAG"", ""TRANSID"", ""INCEPTADDR"", ""PORDERID"", ""BILLFROM"", ""CONFIRMMAN"", ""CONFIRMMANNAME"", ""CONFIRMDATE"", ""USESTATUS"", ""OUTMODE"", ""INVOICETYPE"", ""TRANSCLASS"", ""RECEIVEPHONE"", ""ALLOCATETIME"", ""FINISHFLAG"", ""TPRICETICK"", ""TPRICEFLAG"", ""DEPTNO"", ""DEPTNAME"", ""ORDERFLAG"", ""GCOMPANYID"", ""FIXFLAG"", ""SALERID"", ""SALERNAME"", ""TRDTLID"", ""SASETTLEDTLID"", ""PRTCLASS"", ""PRTGROUPSET"", ""EMPLOYEEID"", ""EMPLOYEEOPCODE"", ""EMPLOYEENAME"", ""CANCELDATE"", ""CANCELMANID"", ""CANCELMANNAME"", ""ZXCOLUMN4"", ""GCOMPANYNAME"", ""FROM_SUDOCID"", ""AUTOFLAG"", ""ERROR_MSG"", ""ORDERNO"") AS 
  select a.warehid,
       b.warehname,
       b.warehopcode,
       a.goodsownerid,
       e.goopcode,
       e.goodsownername,
       a.exporderid,
       a.eorderno,
       a.lineno,
       a.credate,
       a.preexpdate,
       a.expdate,
       a.prearrivedate,
       a.arrivedate,
       a.ptransmodeid,
       a.transmodeid,
       d.transmode,
       d.transname,
       a.earlydate,
       a.composeinfo,
       a.transno,
       a.reccompanyid,
       c.opcode reccompanyopcode,
       c.companyname reccompanyname,
       a.companytype,
       a.taxflag,
       a.inputmanid,
       g.employeename imputmanname,
       a.jobtype,
       a.operationtype,
       a.medicineclass,
       a.receiveaddr,
       a.receivehead,
       a.realrecaddr,
       a.realrecman,
       a.receiveman,
       a.signman,
       a.partexpflag,
       a.samelotflag,
       a.urgenflag,
       a.addinvoiceflag,
       a.arrivememo,
       a.exportmemo,
       a.detaillines,
       a.srcexpno,
       a.nowlflag,
       a.transid,
       h.inceptaddr,
       a.porderid,
       a.billfrom,
       a.confirmman,
       f.employeename confirmmanname,
       a.confirmdate,
       a.usestatus,
       a.outmode,
       a.invoicetype,
       a.transclass,
       a.receivephone,
       a.allocatetime,
       a.finishflag,
       a.tpricetick,
       a.tpriceflag,
       a.deptno,
       a.deptname,
       a.orderflag,
       a.gcompanyid,
       a.fixflag,
       a.salerid,
       a.salername,
       a.trdtlid,
       a.sasettledtlid,
       a.prtclass,
       a.prtgroupset,
       a.employeeid,
       i.opcode employeeopcode,
       i.employeename,
       a.canceldate,
       a.cancelmanid,
       dd.employeename cancelmanname,
       a.zxcolumn4,--ERP总单ID add by wanghuaiyu 2013年8月7日 18:31:24
       a.gcompanyname,--add by weitangjing 20131102 货主原单位名称
       a.from_sudocid,
       a.autoflag,
       a.error_msg,
       a.orderno --雨诺单据编号
  from tpl_export_order   a,
       tpl_warehouse      b,
       tpl_go_company     c,
       wms_transport_mode d,
       tpl_goodsowner     e,
       pub_employee       f,
       pub_employee       g,
       wms_transport_address h,
       pub_employee          i,
       pub_employee      dd
   where a.warehid = b.warehid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.reccompanyid = c.companyid(+)
   and a.transmodeid = d.transmodeid(+)
   and a.confirmman = f.employeeid(+)
   and a.inputmanid = g.employeeid(+)
   and a.transid = h.transid(+)
   and a.employeeid = i.employeeid(+)
   and a.cancelmanid = dd.employeeid(+)
"
"TPL_FACTORY_HOV_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_FACTORY_HOV_V"" (""COMPANYID"", ""COMPANYNO"", ""COMPANYOPCODE"", ""COMPANYPINYIN"", ""COMPANYNAME"", ""COMPANYSHORTNAME"", ""LEGALPERSION"", ""COMPANYCREDATE"", ""INPUTMANID"", ""COMPANYMEMO"", ""CHIEFOFFICER"", ""CONNECTOR"", ""TELEPHONE"", ""POSTCODE"", ""SUPPLIERADDRESS"", ""TAXREGISTNO"", ""BANK"", ""BANKNO"", ""PROVINCE"", ""CUSTOMTYPE"") AS 
  select companyid,
       companyno,
       companyopcode,
       companypinyin,
       companyname,
       companyshortname,
       legalpersion,
       companycredate,
       inputmanid,
       companymemo,
       chiefofficer,
       connector,
       telephone,
       postcode,
       supplieraddress,
       taxregistno,
       bank,
       bankno,
       province,
       customtype
  from tpl_pub_company
 where factflag = 1

 "
"TPL_FORBIT_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_FORBIT_LST_V"" (""COMPANYID"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""DRUGFORMID"", ""DRUGFORMNO"", ""DRUGFORM"", ""KEYID"", ""USESTATUS"") AS 
  select a.companyid,
       b.companyopcode,
       b.companyname,
       a.drugformid,
       c.drugformno,
       c.drugform,
       a.keyid,
       a.usestatus
  from tpl_forbit_lst a, tpl_pub_company b, tpl_drugform c
 where a.companyid = b.companyid(+)
   and a.drugformid = c.drugformid(+)
"
"TPL_GOODSOWNER_FIX_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GOODSOWNER_FIX_V"" (""GOODSOWNERID"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""OUTTYPE"", ""LOTFLAG"", ""VALUEADD_SVC"", ""GSP_SVC"", ""RECV_SVC"", ""INSTEADRECV_SVC"", ""ACC_SVC"", ""ECODE_SVC"", ""FCODE_SVC"", ""INVOICEPRINTPLAN"", ""MIXGOODSFLAG"", ""MERGEORDERFLAG"", ""BACKSTATUSMSG"", ""ZXCOLUMN0"", ""ZXCOLUMN1"", ""ZXCOLUMN2"", ""ZXCOLUMN3"", ""ZXCOLUMN4"", ""ZXCOLUMN5"", ""ZXCOLUMN6"", ""ZXCOLUMN7"", ""ZXCOLUMN8"", ""ZXCOLUMN9"", ""DTLZXCOLUMN0"", ""DTLZXCOLUMN1"", ""DTLZXCOLUMN2"", ""DTLZXCOLUMN3"", ""DTLZXCOLUMN4"", ""DTLZXCOLUMN5"", ""DTLZXCOLUMN6"", ""DTLZXCOLUMN7"", ""DTLZXCOLUMN8"", ""DTLZXCOLUMN9"", ""LOTLIMIT"", ""PERIODLIMIT"", ""PERIODLIMITUNIT"", ""OUTDIFFLAG"", ""MULRECFLAG"", ""REMAININGORDERPERIOD"", ""REMAININGORDERRATE"") AS 
  select a.goodsownerid,
       b.goopcode,
       b.goodsownername,
       a.outtype,
       a.lotflag,
       a.valueadd_svc,
       a.gsp_svc,
       a.recv_svc,
       a.insteadrecv_svc,
       a.acc_svc,
       a.ecode_svc,
       a.fcode_svc,
       a.invoiceprintplan,
       a.mixgoodsflag,
       a.mergeorderflag,
       a.backstatusmsg,
       a.zxcolumn0,
       a.zxcolumn1,
       a.zxcolumn2,
       a.zxcolumn3,
       a.zxcolumn4,
       a.zxcolumn5,
       a.zxcolumn6,
       a.zxcolumn7,
       a.zxcolumn8,
       a.zxcolumn9,
       a.dtlzxcolumn0,
       a.dtlzxcolumn1,
       a.dtlzxcolumn2,
       a.dtlzxcolumn3,
       a.dtlzxcolumn4,
       a.dtlzxcolumn5,
       a.dtlzxcolumn6,
       a.dtlzxcolumn7,
       a.dtlzxcolumn8,
       a.dtlzxcolumn9,
       a.lotlimit,
       a.periodlimit,
       a.periodlimitunit,
       a.outdifflag,
       a.mulrecflag,--多次收货标志
       a.remainingorderperiod,--剩余订单处理期限
       a.remainingorderrate--剩余订单比例
  from tpl_goodsowner_fix a, tpl_goodsowner b
 where a.goodsownerid = b.goodsownerid(+)
"
"TPL_GOODSOWNER_HOV_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GOODSOWNER_HOV_V"" (""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""GOODSOWNERSHORT"", ""CHIEFOFFICER"", ""TELEPHONE"", ""POSTCODE"", ""ADDRESS"", ""INVOICEHEAD"", ""INVOICEADDRESS"", ""CONNECTOR"", ""CONNPHONE"", ""MEMO"", ""USESTATUS"", ""GPRTFLAG"", ""CPRTFLAG"", ""TAXREGISTNO"", ""BANK"", ""BANKNO"", ""DISTRICTID"", ""DISTRICTNAME"", ""PROVINCE"", ""WARECID"", ""LOTFLAG"", ""BATCHFLAG"", ""COMEFLAG"", ""MULRECFLAG"", ""HOLDMONTH"", ""REMAINPERC"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""CITYID"", ""CITYOPCODE"", ""CITYNAME"", ""DECISIONFLAG"", ""CORTYPE"", ""GOUSESTATUS"") AS 
  select a.goodsownerid,
       a.goodsownername,
       a.goopcode,
       a.goodsownershort,
       a.chiefofficer,
       a.telephone,
       a.postcode,
       a.address,
       a.invoicehead,
       a.invoiceaddress,
       a.connector,
       a.connphone,
       a.memo,
       a.usestatus,
       a.gprtflag,
       a.cprtflag,
       a.taxregistno,
       a.bank,
       a.bankno,
       a.districtid,
       c.districtname,
       a.province,
       a.warecid,
       a.LOTFLAG,
       a.BATCHFLAG,
       a.COMEFLAG,
       a.mulrecflag,
       a.holdmonth,
       a.remainperc,
       b.companyopcode,
       b.companyname,
       a.cityid,
       d.CITYOPCODE,
       d.CITYNAME,a.decisionflag,
       a.cortype,
       a.usestatus gousestatus
  from tpl_goodsowner a, tpl_pub_company b, tpl_district c, TPL_CITY d
 where a.warecid = b.companyid(+)
   and a.districtid = c.districtid(+)
   and a.cityid = d.cityid(+)
   and a.usestatus = 1

 "
"TPL_GOODSOWNER_OPSET_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GOODSOWNER_OPSET_V"" (""KEYID"", ""GOODSOWNERID"", ""OPERATIONTYPE"", ""CHANGELOT"", ""CHANGEQTY"", ""CHANGESTATUS"", ""CHANGEPACK"", ""PARTITIONFLAG"", ""MEMO"") AS 
  select a.keyid,
      a.goodsownerid,
      a.operationtype,
      a.changelot,
      a.changeqty,
      a.changestatus,
      a.changepack,
      a.partitionflag,
      a.memo
    from TPL_GOODSOWNER_OPSET a
"
"TPL_GOODSOWNER_RESPONSE_SET_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GOODSOWNER_RESPONSE_SET_V"" (""SEQID"", ""GOODSOWNERID"", ""RESPONSETYPEID"", ""RESPONSETYPE"", ""RESPONSESUBTYPE"") AS 
  Select a.Seqid,
       a.Goodsownerid,
       a.Responsetypeid,
       b.Responsetype,
       b.Responsesubtype
  From Tpl_Goodsowner_Response_Set a, Wms_Response_Type b
 Where a.Responsetypeid = b.Responsetypeid
"
"TPL_GOODSOWNER_TO_WAREHOUSE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GOODSOWNER_TO_WAREHOUSE_V"" (""RELKEYID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""WAREHID"", ""WAREHNAME"", ""WAREHOPCODE"", ""PRIORITY"", ""INNERFLAG"", ""CHECKLICENSE"") AS 
  select a.relkeyid,
       a.goodsownerid,
       b.goodsownername,
       b.goopcode,
       a.warehid,
       c.warehname,
       c.warehopcode,
       a.priority,
       b.innerflag, --内外部货主标志,用于货主原货品ID取值判断  tl@180123
       a.checklicense
  from Tpl_goodsowner_to_warehouse a, tpl_goodsowner b, tpl_warehouse c
 where a.goodsownerid = b.goodsownerid(+)
   and a.warehid = c.warehid(+)
"
"TPL_GOODSOWNER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GOODSOWNER_V"" (""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""GOODSOWNERSHORT"", ""CHIEFOFFICER"", ""TELEPHONE"", ""POSTCODE"", ""ADDRESS"", ""INVOICEHEAD"", ""INVOICEADDRESS"", ""CONNECTOR"", ""CONNPHONE"", ""MEMO"", ""USESTATUS"", ""GSPUSESTATUS"", ""GPRTFLAG"", ""CPRTFLAG"", ""TAXREGISTNO"", ""BANK"", ""BANKNO"", ""DISTRICTID"", ""DISTRICTNAME"", ""DISTRICTOPCODE"", ""PROVINCE"", ""WARECID"", ""LOTFLAG"", ""BATCHFLAG"", ""COMEFLAG"", ""MULRECFLAG"", ""HOLDMONTH"", ""REMAINPERC"", ""INVPHONE"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""GOMACODE"", ""CITYID"", ""CITYOPCODE"", ""CITYNAME"", ""LICDATE"", ""AREA"", ""CORTYPE"", ""DECISIONFLAG"", ""ISCHECK"", ""INSTEADRECV_SVC"", ""GOTYPE"", ""FILEGROUPID"", ""INNERFLAG"", ""LOTVALIDATEDAYS"", ""MIDFLAG"", ""WEBPWD"", ""BTFLAG"", ""BACTERINFLAG"", ""IWCS_FLAG"", ""SHIPPOSFLAG"", ""QA_APPROVEFLAG"", ""QA_APPROVEDATE"", ""QA_APPROVEMEMO"", ""QA_APPROVEMANID"", ""QA_APPROVEMANNAME"", ""APPROVEFLAG"", ""APPROVEDATE"", ""APPROVEMEMO"", ""APPROVEMANID"", ""APPROVEMANNAME"", ""CHECKLICENSE"", ""WARNLICENSEDAYS"", ""TRGOODSOWNERID"", ""TRGOODSOWNERNAME"") AS 
  select a.goodsownerid,
       a.goodsownername,
       a.goopcode,
       a.goodsownershort,
       a.chiefofficer,
       a.telephone,
       a.postcode,
       a.address,
       a.invoicehead,
       a.invoiceaddress,
       a.connector,
       a.connphone,
       a.memo,
       a.usestatus,
       a.gspusestatus,--xyue 2014-12-03 根据第三方物流验收要求新增审批状态字段
       a.gprtflag,
       a.cprtflag,
       a.taxregistno,
       a.bank,
       a.bankno,
       a.districtid,
       c.districtname,
       c.districtopcode,
       a.province,
       a.warecid,
       a.lotflag,
       a.batchflag,
       a.comeflag,
       a.mulrecflag,
       a.holdmonth,
       a.remainperc,
       a.invphone,
       b.companyopcode,
       b.companyname,
       a.gomacode,
       a.cityid,
       d.cityopcode,
       d.cityname,
       a.licdate,
       a.area,
       a.cortype,
       a.decisionflag,
       a.ischeck,
       a.insteadrecv_svc,
       a.gotype,
       a.filegroupid,
       nvl(a.innerflag,0) innerflag,
       nvl(a.lotvalidatedays,0)lotvalidatedays,
       a.midflag,--add by zyc 20161214 中间表标志
       a.webpwd, --add by zyc 20161214 用户密码
       a.btflag, --add by xyue 20161230 收货验收必填项
			 a.bacterinflag,  --add by tl 20170329 疫苗货主标志
       a.iwcs_flag,
       a.shipposflag,
       nvl(a.QA_APPROVEFLAG,0) QA_APPROVEFLAG,
       a.QA_APPROVEDATE,
       a.QA_APPROVEMEMO,
       a.QA_APPROVEMANID,
       f.employeename QA_APPROVEMANNAME,
       nvl(a.APPROVEFLAG,0) APPROVEFLAG,
       a.APPROVEDATE,
       a.APPROVEMEMO,
       a.APPROVEMANID,
       e.employeename APPROVEMANNAME,
       a.CHECKLICENSE,
       a.WARNLICENSEDAYS,
       a.trgoodsownerid,--受托方货主ID
       g.goodsownername as trgoodsownername --受托方货主名称
  from tpl_goodsowner a, tpl_pub_company b, tpl_district c, tpl_city d,pub_employee e,pub_employee f,tpl_goodsowner g
 where a.warecid = b.companyid(+)
   and a.districtid = c.districtid(+)
   and a.cityid = d.cityid(+)
   and a.approvemanid=e.employeeid(+)
   and a.qa_approvemanid = f.employeeid(+)
   and a.trgoodsownerid=g.goodsownerid(+)
   --and a.goodsownerid <> 0
"
"TPL_GOODSOWNER_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GOODSOWNER_V1"" (""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""GOODSOWNERSHORT"", ""CHIEFOFFICER"", ""TELEPHONE"", ""POSTCODE"", ""ADDRESS"", ""INVOICEHEAD"", ""INVOICEADDRESS"", ""CONNECTOR"", ""CONNPHONE"", ""MEMO"", ""USESTATUS"", ""GSPUSESTATUS"", ""GPRTFLAG"", ""CPRTFLAG"", ""TAXREGISTNO"", ""BANK"", ""BANKNO"", ""DISTRICTID"", ""DISTRICTNAME"", ""DISTRICTOPCODE"", ""PROVINCE"", ""WARECID"", ""LOTFLAG"", ""BATCHFLAG"", ""COMEFLAG"", ""MULRECFLAG"", ""HOLDMONTH"", ""REMAINPERC"", ""INVPHONE"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""GOMACODE"", ""CITYID"", ""CITYOPCODE"", ""CITYNAME"", ""LICDATE"", ""AREA"", ""CORTYPE"", ""DECISIONFLAG"", ""ISCHECK"", ""INSTEADRECV_SVC"", ""GOTYPE"", ""INNERFLAG"") AS 
  select a.goodsownerid,
       a.goodsownername,
       a.goopcode,
       a.goodsownershort,
       a.chiefofficer,
       a.telephone,
       a.postcode,
       a.address,
       a.invoicehead,
       a.invoiceaddress,
       a.connector,
       a.connphone,
       a.memo,
       a.usestatus,
       a.gspusestatus,--xyue 2014-12-03 根据第三方物流验收要求新增审批状态字段
       a.gprtflag,
       a.cprtflag,
       a.taxregistno,
       a.bank,
       a.bankno,
       a.districtid,
       c.districtname,
       c.districtopcode,
       a.province,
       a.warecid,
       a.lotflag,
       a.batchflag,
       a.comeflag,
       a.mulrecflag,
       a.holdmonth,
       a.remainperc,
       a.invphone,
       b.companyopcode,
       b.companyname,
       a.gomacode,
       a.cityid,
       d.cityopcode,
       d.cityname,
       a.licdate,
       a.area,
       a.cortype,
       a.decisionflag,
       a.ischeck,
       a.insteadrecv_svc,
       a.gotype,
       a.innerflag
  from tpl_goodsowner a, tpl_pub_company b, tpl_district c, tpl_city d
 where a.warecid = b.companyid(+)
   and a.districtid = c.districtid(+)
   and a.cityid = d.cityid(+)
   and a.goodsownerid <> 0
   and a.gspusestatus <> 2 -- 初始状态的货主信息不显示
"
"TPL_GOODS_ALLDTL_INFO_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GOODS_ALLDTL_INFO_V"" (""COMEFROM"", ""MDTYPE"", ""DOCID"", ""DTLID"", ""STOREPERCENT"", ""COSTRATE"", ""UNITTYPE"", ""GOODSOWNERID"") AS 
  SELECT
      a.comefrom,
      a.mdtype,
      b.docid,
      b.dtlid,
      -1 storepercent,
      b.costrate,
      b.unittype,
      e.goodsownerid

  FROM TPRICE_PRICE_TYPE A,
       TPRICE_GO_JOB_DTL B,
       Tprice_Go_Price_Doc e
  WHERE a.priceid = b.priceid
UNION ALL
  SELECT
      a.comefrom,
      a.mdtype,
      c.docid,
      c.dtlid,
      c.storepercent,
      c.costrate,
      c.unittype,
      f.goodsownerid
  FROM TPRICE_PRICE_TYPE A,
       TPRICE_GO_TRANS_DTL C,
       Tprice_Go_Price_Doc f
  WHERE a.priceid = c.priceid
UNION ALL
  SELECT
      a.comefrom,
      a.mdtype,
      d.docid,
      d.dtlid,
      d.storepercent,
      d.costrate,
      d.unittype,
      g.goodsownerid
  FROM TPRICE_PRICE_TYPE A,
        TPRICE_GO_STORE_DTL D,
        Tprice_Go_Price_Doc g
  WHERE a.priceid = d.priceid

 "
"TPL_GOODS_DIFFERENCE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GOODS_DIFFERENCE_V"" (""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""GOODSOWNID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""DIFFTYPE"", ""NEEDTYPE"", ""PROCSTATUS"", ""COMEFIRMDATE"", ""COMEFIRMMANID"", ""COMEFIRMMAN"", ""PRIMERKEY"") AS 
  select a.goodsownerid,
         b.goodsownername,
         b.goopcode,
         a.goodsownid,
         c.opcode,
         c.goodsname,
         c.goodstype,
         c.prodarea,
         c.factname,
         a.difftype,
         a.needtype,
         a.procstatus,
         a.comefirmdate,
         a.comefirmmanid,
         d.employeename comefirmman,
         a.primerkey
    from tpl_goods_difference a,
    tpl_goodsowner b,
    tpl_goods c,
    pub_employee d
   where a.goodsownerid = b.goodsownerid (+)
   and a.goodsownid = c.goodsownid(+)
   AND a.comefirmmanid = d.employeeid(+)

 "
"TPL_GOODS_HOV_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GOODS_HOV_V"" (""OWNERGOODSID"", ""OPCODE"", ""GOODSOWNERID"", ""GOODSNO"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSFORMALNAME"", ""GOODSTYPE"", ""CREDATE"", ""FACTNAME"", ""PRODAREA"", ""MEMO"", ""BARCODE"", ""ALLOWINDAYS"", ""ALLOWOUTDAYS"", ""PASTEFLAG"", ""WHOLESALEPRICE"", ""RESALEPRICE"", ""SAFESTOCK"", ""PURCHASETAX"", ""SALETAX"", ""ALARMDAYS"", ""TRADEPACKID"", ""TRADEPACKNAME"", ""TRADEPACKSIZE"", ""WAREGOODSID"", ""POISON_DRUG"", ""LOTFLAG"", ""BATCHFLAG"", ""COMEFLAG"", ""GOODSSTATUS"", ""DRUGFORM"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""ALLNAME"", ""GOODSOWNID"", ""GOPCODE"", ""OUTPACKID"", ""OUTPACKNAME"", ""OUTPACKSIZE"", ""PACKSIZE"", ""APPORVENO"", ""MAH"") AS 
  select a.ownergoodsid,
       a.opcode,
       a.goodsownerid,
       a.goodsno,
       a.goodsname,
       a.goodsengname,
       a.goodsformalname,
       a.goodstype,
       a.credate,
       a.factname,
       a.prodarea,
       a.memo,
       a.barcode,
       a.allowindays,
       a.allowoutdays,
       a.pasteflag,
       a.wholesaleprice,
       a.resaleprice,
       a.safestock,
       a.purchasetax,
       a.saletax,
       a.alarmdays,
       a.tradepackid,
       a.tradepackname,
       d.packsize tradepacksize,
       a.waregoodsid,
       a.poison_drug,
       a.lotflag,
       a.batchflag,
       a.comeflag,
       a.goodsstatus,
       a.drugform,
       b.goodsownername,
       b.goopcode,
       nvl(a.goodsname, '') || nvl(a.goodsengname, '') ||
       nvl(a.goodsformalname, '') allname,
       a.Goodsownid,
       a.Gopcode,
       a.outpackid,
       c.packname outpackname,
       c.packsize outpacksize,
       a.packsize,
       a.approvedocno apporveno,
       a.mah
  from tpl_goods           a,
       tpl_goodsowner      b,
       tpl_pub_goods_packs c,
       tpl_pub_goods_packs d
 where a.goodsownerid = b.goodsownerid
   and a.outpackid = c.goodspackid(+)
   and a.tradepackid = d.goodspackid(+)
"
"TPL_GOODS_PACKS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GOODS_PACKS_V"" (""OWNERPACKID"", ""OWNERGOODSID"", ""OWNERGOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""BASEUNITFLAG"", ""PACKNAME"", ""PACKSIZE"", ""GOODSPACKID"", ""PUBPACKNAME"", ""PUBPACKSIZE"", ""PUBBASEUNITFLAG"", ""PUBUSESTATUS"", ""USESTATUS"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSWEIGHT"", ""GOODSCUBAGE"", ""WEIGHTUNIT"", ""MEMO"", ""PACKID"", ""ERPGOODSDTLID"") AS 
  select a.ownerpackid,
       a.ownergoodsid,
       b.opcode ownergoodsopcode,
       b.goodsname,
       b.goodstype,
       a.baseunitflag,
       a.packname,
       a.packsize,
       a.goodspackid,
       c.packname pubpackname,
       c.packsize pubpacksize,
       c.baseunitflag pubbaseunitflag,
       c.usestatus pubusestatus,
       a.usestatus,
       a.goodslength,
       a.goodswidth,
       a.goodsheight,
       a.goodsweight,
       a.goodscubage,
       a.weightunit,
       --a.memo,
       (select to_char(tt.credate,'yyyy-mm-dd hh24:mi:ss')||' '||tt.username||tt.updatelog from np_update_log tt where tt.seqid=
       (select max(t.seqid)
          from np_update_log t
         where t.pkvalue = a.ownerpackid
           and t.tablename = 'TPL_GOODS_PACKS')) memo,
       a.packid,
       a.erpgoodsdtlid
  from tpl_goods_packs a, tpl_goods b, tpl_pub_goods_packs c
 where a.ownergoodsid = b.ownergoodsid
   and a.goodspackid = c.goodspackid(+)
"
"TPL_GOODS_PACKS_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GOODS_PACKS_V1"" (""OWNERPACKID"", ""OWNERGOODSID"", ""OWNERGOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""BASEUNITFLAG"", ""PACKNAME"", ""PACKSIZE"", ""GOODSPACKID"", ""PUBPACKNAME"", ""PUBPACKSIZE"", ""PUBBASEUNITFLAG"", ""PUBUSESTATUS"", ""USESTATUS"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSWEIGHT"", ""GOODSCUBAGE"", ""WEIGHTUNIT"", ""MEMO"", ""PACKID"") AS 
  select a.ownerpackid,
         a.ownergoodsid,
         b.opcode ownergoodsopcode,
         b.goodsname,
         b.goodstype,
         a.baseunitflag,
         a.packname,
         a.packsize,
         a.goodspackid,
         c.packname pubpackname,
         c.packsize pubpacksize,
         c.baseunitflag pubbaseunitflag,
         c.usestatus pubusestatus,
         a.usestatus,
         a.goodslength,
         a.goodswidth,
         a.goodsheight,
         a.goodsweight,
         a.goodscubage,
         a.weightunit,
         a.memo,
         a.packid
    from tpl_goods_packs a,tpl_goods b,tpl_pub_goods_packs c
  where  a.ownergoodsid = b.ownergoodsid
  and    a.goodspackid = c.goodspackid(+)
 -- AND a.usestatus = 1 --2014年1月19日 12:43:54 增加条件只查询出正在使用的包装，用于货主货品包装hov
"
"TPL_GOODS_PACK_HOV_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GOODS_PACK_HOV_V"" (""GOODSID"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""USESTATUS"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSWEIGHT"", ""WEIGHTUNIT"", ""BASEUNITFLAG"", ""GOODSPACKLAYER"", ""GOODSCUBAGE"") AS 
  select goodsid,
       goodspackid,
       packname,
       packsize,
       usestatus,
       goodslength,
       goodswidth,
       goodsheight,
       goodsweight,
       weightunit,
       baseunitflag,
       goodspacklayer,
       goodscubage
  from tpl_pub_goods_packs

 "
"TPL_GOODS_TOTAL_QTY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GOODS_TOTAL_QTY_V"" (""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""GOODSID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTNAME"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"") AS 
  select a.goodsownerid,
       b.goodsownername,
       b.goopcode,
       a.goodsid,
       f.opcode goodsopcode,
       f.goodsname,
       f.goodstype,
       f.prodarea,
       f.factid,
       d.companyname factname,
       sum(a.goodsqty) goodsqty,
       a.goodspackid,
       i.packname,
       i.packsize,
       a.goodsstatusid,
       m.goodsstatus,
       m.quantitystatus
  from wms_st_qty_lst      a,
       tpl_goodsowner      b,
       tpl_pub_company     d,
       tpl_pub_goods       f,
       tpl_pub_goods_packs i,
       wms_goodsstatus     m
 where a.goodsownerid = b.goodsownerid
   and a.goodsid = f.goodsid
   and f.factid = d.companyid
   and a.goodspackid = i.goodspackid
   and a.goodsstatusid =m.goodsstatusid
   group by a.goodsownerid,
       b.goodsownername,
       b.goopcode,
       a.goodsid,
       f.opcode,
       f.goodsname,
       f.goodstype,
       f.prodarea,
       f.factid,
       d.companyname,
       a.goodspackid,
       i.packname,
       i.packsize,
       a.goodsstatusid,
       m.goodsstatus,
       m.quantitystatus
"
"TPL_GOODS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GOODS_V"" (""OWNERGOODSID"", ""GOODSSTATUS"", ""OPCODE"", ""GOODSOWNERID"", ""GOODSNO"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSFORMALNAME"", ""GOODSTYPE"", ""CREDATE"", ""PRODAREA"", ""MEMO"", ""BARCODE"", ""ALLOWINDAYS"", ""ALLOWOUTDAYS"", ""PASTEFLAG"", ""WHOLESALEPRICE"", ""RESALEPRICE"", ""SAFESTOCK"", ""PURCHASETAX"", ""SALETAX"", ""ALARMDAYS"", ""POISON_DRUG"", ""GOPCODE"", ""TRADEPACKID"", ""TRADEPACKNAME"", ""OUTPACKID"", ""OUTPACKNAME"", ""FACTNAME"", ""ADDMEDCHECKFLAG"", ""LOTFLAG"", ""BATCHFLAG"", ""COMEFLAG"", ""WAREGOODSID"", ""GOODSOWNID"", ""DRUGFORM"", ""PACKSIZE"", ""EM_GOODS_FLAG"", ""EM_GOODS_REASON"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""WAREGOODSOPCODE"", ""WAREGOODSNAME"", ""MAINTRADNAME"", ""MAINOUTNAME"", ""ALLNAME"", ""WPACKSIZE"", ""TRADEMARK"", ""STORAGECONDITION"", ""CLASSID"", ""APPROVEDOCNO"", ""BOXNOFLAG"", ""QTYGENE"", ""GOODSPY"", ""REPFLAG"", ""STORAGETYPE"", ""USESTATUS"", ""DBCHECK"", ""PUBPOISON_DRUG"", ""JKHZFLAG"", ""GMPFLAG"", ""L_PERIOD"", ""S_PERIODUNIT"", ""REGISTDOCNO"", ""DICTNO"", ""REPTYPE"", ""FACTID"", ""VARIETYNAME"", ""VARIETYNO"", ""SUPPLYERNAME"", ""VARIETYDESCID"", ""ECODEFLAG"", ""PRODLICENSENO"", ""PACKSEQFLAG"", ""DBPICKFLAG"", ""DBINCHECK"", ""TRADEPACKSIZE"", ""FIRSTSALEFLAG"", ""FIRSTINDATE"", ""ALONEPACKFLAG"", ""PRODUCTAPPROVAL"", ""GMPINVALIDDATE"", ""SERVICERATE"", ""SERVICEUNITPRICE"", ""MINTEMP"", ""MAXTEMP"", ""SERSTARTDATE"", ""SERENDDATE"", ""MJYSFLAG"", ""SEQFLAG"", ""MAH"", ""UDI_CODE"", ""UDI_FLAG"", ""UDI_PARSER_RULE_ID"", ""RULENAME"", ""RULECODE"", ""ZX_WDFW"", ""TRANSCONDITION"", ""BUSISCOPENAME"", ""APPROVEFLAG"", ""APPROVEDATE"", ""APPROVEMEMO"", ""APPROVEMANID"", ""BUSCOPEID"", ""ISGSPCONTROL"", ""APPROVEMANNAME"", ""ERPGOODSID"") AS 
  select a.ownergoodsid,
       a.goodsstatus,
       a.opcode,
       a.goodsownerid,
       a.goodsno,
       a.goodsname,
       --nvl(a.print_goodsname,a.goodsname) as goodsname,
       a.goodsengname,
       a.goodsformalname,
       a.goodstype,
       a.credate,
       a.prodarea,
       a.memo,
       a.barcode,
       a.allowindays,
       a.allowoutdays,
       a.pasteflag,
       a.wholesaleprice,
       a.resaleprice,
       a.safestock,
       a.purchasetax,
       a.saletax,
       a.alarmdays,
       a.poison_drug,
       a.gopcode,
       a.tradepackid,
       a.tradepackname,
       a.outpackid,
       a.outpackname,
       a.factname,
       a.addmedcheckflag,
       a.lotflag,
       a.batchflag,
       a.comeflag,
       a.waregoodsid,
       a.goodsownid,
       a.drugform,
       a.packsize,
       nvl(a.em_goods_flag, 0) em_goods_flag,
       a.em_goods_reason,
       b.goodsownername,
       b.goopcode,
       c.opcode waregoodsopcode,
       c.goodsname waregoodsname,
       d.packname maintradname,
       e.packname mainoutname,
       --nvl(a.goodsname, '') || nvl(a.goodsengname, '') ||nvl(a.goodsformalname, '') allname,
       a.goodsname as allname,
       e.packsize as wpacksize,
       a.TRADEMARK,
       a.STORAGECONDITION,
       c.classid,
       a.approvedocno,
       a.BoxNoFlag,
       a.QtyGene,
       a.Goodspy,
       a.repflag,
       a.storagetype,
       a.usestatus,
       a.dbcheck,
       c.poison_drug pubpoison_drug,
       c.jkhzflag,
       c.gmpflag,
       c.l_period,
       c.s_periodunit,
       a.registdocno,
       c.dictno,
       c.reptype,
       c.factid,
       a.varietyname,
       a.varietyno,
       a.supplyername,
       a.varietydescid,
       a.ecodeflag,
       a.prodlicenseno,
       a.packseqflag,
       a.dbpickflag,
       a.dbincheck,
       a.tradepacksize,
       a.firstsaleflag,
       a.firstindate,
       a.alonepackflag,
       a.productapproval, --产品批件有效期至 add by wanghuaiyu 20130617
       a.gmpinvaliddate, --GMP证书有效期至 add by wanghuaiyu 20130617
       a.servicerate, --中宏疫苗货主计算服务费（按金额百分比） by tl@180403
       a.serviceunitprice, --中宏疫苗货主计算服务费（按数量的单价） by tl@180403
       a.mintemp, --TMS冷链监控温度范围最低温度 add by xyue 2018-07-30
       a.maxtemp, --TMS冷链监控温度范围最高温度 add by xyue 2018-07-30
       a.serstartdate, --中宏计算服务费开始时间 add by tl@181213
       a.serenddate, --中宏计算服务费结束时间 add by tl@181213
       a.mjysflag,
       a.seqflag,
       a.mah, --add by xyue 2019-08-21 上市许可持有人
       a.udi_code,
       a.udi_flag,
       a.udi_parser_rule_id,
       f.rulename,
       f.rulecode,
       a.zx_wdfw,
       a.transcondition,
       a.busiscopename,
       nvl(a.approveflag, 4) approveflag,
       a.approvedate,
       a.approvememo,
       a.approvemanid,
       a.buscopeid,
       a.isgspcontrol,
       g.employeename approvemanname,
       a.erpgoodsid
  from tpl_goods           a,
       tpl_goodsowner      b,
       tpl_pub_goods       c,
       tpl_pub_goods_packs d,
       tpl_pub_goods_packs e,
       wms_udi_parser_rule f,
       pub_employee        g
 where a.goodsownerid = b.goodsownerid(+)
   and a.Waregoodsid = c.goodsid(+)
   and a.tradepackid = d.goodspackid(+)
   and a.outpackid = e.goodspackid(+)
   and a.udi_parser_rule_id = f.ruleid(+)
   and a.approvemanid = g.employeeid(+)
"
"TPL_GO_COMPANY_HOV_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GO_COMPANY_HOV_V"" (""COMPANYID"", ""COMPANYNAME"", ""OPCODE"", ""COMPANYSHORTNAME"", ""WARECID"", ""COMPANYSTYLE"", ""GOODSOWNERID"", ""GCOMPANYID"", ""GCOMPANYNO"", ""GCOMPANYOPCODE"", ""GOODSOWNERFLAG"", ""BANK"", ""BANKNO"", ""CHIEFOFFICER"", ""CONNECTOR"", ""CONNPHONE"", ""CREDIT"", ""USEDCREDIT"", ""COMPANYTYPE"", ""LOTLIMIT"", ""VALIDDAYS"", ""DELIVERADDRESS"", ""DELIVERROUTE"", ""DISTRICTID"", ""PROVINCE"", ""ADDMEDCHECKFLAG"", ""INVOICEADDRESS"", ""INVOICEHEAD"", ""INVOICEMAN"", ""INVOICETELE"", ""POSTCODE"", ""SPECIALREQUIRE"", ""TAXREGISTNO"", ""TELEPHONE"", ""MEMO"", ""USESTATUS"", ""WARECOPCODE"", ""WARECNAME"", ""DISTRICTNAME"", ""DISTRICTOPCODE"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""CITYID"", ""CITYOPCODE"", ""CITYNAME"", ""DEFTRANID"") AS 
  select a.companyid,
       a.companyname,
       a.opcode,
       a.companyshortname,
       a.warecid,
       a.companystyle,
       a.goodsownerid,
       a.gcompanyid,
       a.gcompanyno,
       a.gcompanyopcode,
       a.goodsownerflag,
       a.bank,
       a.bankno,
       a.chiefofficer,
       a.connector,
       a.connphone,
       a.credit,
       a.usedcredit,
       a.companytype,
       a.lotlimit,
       a.validdays,
       a.deliveraddress,
       a.deliverroute,
       a.districtid,
       a.province,
       a.addmedcheckflag,
       a.invoiceaddress,
       a.invoicehead,
       a.invoiceman,
       a.invoicetele,
       a.postcode,
       a.specialrequire,
       a.taxregistno,
       a.telephone,
       a.memo,
       a.usestatus,
       b.companyopcode warecopcode,
       b.companyname warecname,
       c.districtname,
       c.districtopcode,
       d.goodsownername,
       d.goopcode,
       a.cityid,
       e.cityopcode,
       e.cityname,
       a.deftranid
  from tpl_go_company  a,
       tpl_pub_company b,
       tpl_district    c,
       tpl_goodsowner  d,
       tpl_city        e
 where a.warecid = b.companyid(+)
   and a.districtid = c.districtid(+)
   and a.goodsownerid = d.goodsownerid
   and a.companyid <> 0
   and a.cityid = e.cityid(+)
   --and a.opcode like '%XMYLF%'
"
"TPL_GO_COMPANY_MAN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GO_COMPANY_MAN_V"" (""SEQID"", ""COMPANYID"", ""EMPTYPE"", ""EMPLOYEEID"", ""EMPLOYEENAME"", ""OPCODE"", ""ZX_OUTERMAN"") AS 
  SELECT A.SEQID,
       A.COMPANYID,
       A.EMPTYPE,
       A.EMPLOYEEID,
       B.EMPLOYEENAME,
       B.OPCODE,
       a.zx_outerman--add by wanghuaiyu 20130708
  FROM TPL_GO_COMPANY_MAN A, PUB_EMPLOYEE B
 WHERE A.EMPLOYEEID = B.EMPLOYEEID(+)
"
"TPL_GO_COMPANY_TMS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GO_COMPANY_TMS_V"" (""COMPANYID"", ""COMPANYNAME"", ""GCOMPANYID"", ""COMPANYSTYLE"", ""COMPANYSTYLENAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select t.companyid,
       t.companyname,
       t.gcompanyid,
       t.companystyle,
       '客户' companystylename,
       t.goodsownerid,
       tt.goodsownername
  from tpl_go_company t,tpl_goodsowner tt
 where t.goodsownerid = tt.goodsownerid(+)
   and t.COMPANYID <> 0
   and t.companystyle=1 --直接只显示客户
"
"TPL_GO_COMPANY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GO_COMPANY_V"" (""COMPANYID"", ""COMPANYNAME"", ""OPCODE"", ""COMPANYSHORTNAME"", ""WARECID"", ""COMPANYSTYLE"", ""GOODSOWNERID"", ""GCOMPANYID"", ""GCOMPANYNO"", ""GCOMPANYOPCODE"", ""GOODSOWNERFLAG"", ""BANK"", ""BANKNO"", ""CHIEFOFFICER"", ""CONNECTOR"", ""CONNPHONE"", ""CREDIT"", ""USEDCREDIT"", ""COMPANYTYPE"", ""LOTLIMIT"", ""PERIODLIMIT"", ""PERIODLIMITUNIT"", ""VALIDDAYS"", ""DELIVERADDRESS"", ""DELIVERROUTE"", ""DISTRICTID"", ""PROVINCE"", ""ADDMEDCHECKFLAG"", ""INVOICEADDRESS"", ""INVOICEHEAD"", ""INVOICEMAN"", ""INVOICETELE"", ""POSTCODE"", ""SPECIALREQUIRE"", ""TAXREGISTNO"", ""TELEPHONE"", ""MEMO"", ""USESTATUS"", ""ORGNO"", ""WARECOPCODE"", ""WARECNAME"", ""DISTRICTNAME"", ""DISTRICTOPCODE"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""COMPANYPY"", ""CITYID"", ""CITYOPCODE"", ""CITYNAME"", ""DEFTRANID"", ""INCEPTADDR1"", ""ORDERFLAG"", ""PRINTPLAN"", ""INVTYPE"", ""INVCLASS"", ""INVPRINTPLAN"", ""PRINTFLAG"", ""MODEDOCID"", ""MODELNAME"", ""LOTNOPRINTFLAG"", ""CORPID"", ""COMPANYCLASS"", ""SUPPLYERADDRESS"", ""SUPPLYERCONNPHONE"", ""ERPCOMPANYID"") AS 
  select a.COMPANYID,
       a.COMPANYNAME,
       a.OPCODE,
       a.COMPANYSHORTNAME,
       a.WARECID,
       a.COMPANYSTYLE,
       a.GOODSOWNERID,
       a.GCOMPANYID,
       a.GCOMPANYNO,
       a.GCOMPANYOPCODE,
       a.GOODSOWNERFLAG,
       a.BANK,
       a.BANKNO,
       a.CHIEFOFFICER,
       a.CONNECTOR,
       a.CONNPHONE,
       a.CREDIT,
       a.USEDCREDIT,
       a.COMPANYTYPE,
       a.LOTLIMIT,
       a.periodlimit,
       a.periodlimitunit,
       a.VALIDDAYS,
       a.DELIVERADDRESS,
       a.DELIVERROUTE,
       a.DISTRICTID,
       a.PROVINCE,
       a.addmedcheckflag,
       a.INVOICEADDRESS,
       a.INVOICEHEAD,
       a.INVOICEMAN,
       a.INVOICETELE,
       a.POSTCODE,
       a.SPECIALREQUIRE,
       a.TAXREGISTNO,
       a.TELEPHONE,
       a.MEMO,
       a.USESTATUS,
       a.orgno,
       b.COMPANYOPCODE warecopcode,
       b.COMPANYNAME warecname,
       c.DISTRICTNAME,
       c.DISTRICTOPCODE,
       d.GOODSOWNERNAME,
       d.GOOPCODE,
       a.Companypy,
       a.cityid,
       e.cityopcode,
       e.cityname,
       a.Deftranid,
       f.Inceptaddr inceptaddr1,
       a.orderflag,
       a.printplan,
       a.invtype,
       a.invclass,
       a.invprintplan,
       decode(nvl(a.printflag,0),0,0,1) printflag,
       a.modedocid,
       g.modelname,
       nvl(a.lotnoprintflag,0) lotnoprintflag,--add by weitangjing 20131015 打印一次同批号的药检单
       a.corpid, --add by xyue 20020309 企业自定义编号
       a.companyclass, --tl@211102 客户大类
       a.supplyeraddress,
       a.supplyerconnphone,
       a.erpcompanyid
  from tpl_go_company        a,
       tpl_pub_company       b,
       tpl_district          c,
       tpl_goodsowner        d,
       tpl_city              e,
       wms_transport_address f,
       WMS_BARCODE2V_MODE_DOC     g
 where a.warecid = b.companyid(+)
   and a.districtid = c.districtid(+)
   and a.cityid = e.cityid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.COMPANYID <> 0
   and a.Deftranid = f.transid(+)
   And a.modedocid = g.modedocid(+)
"
"TPL_GO_CONNECTOR_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_GO_CONNECTOR_V"" (""CONNID"", ""GOODSOWNERID"", ""CONNOPCODE"", ""CONNTYPE"", ""CONNPHONE"", ""CONNNAME"", ""CONNSEX"", ""BIRTHDAY"", ""EMAIL"", ""FAX"", ""MOBILE"", ""USESTATUS"", ""MEMO"", ""GOOPCODE"", ""GOODSOWNERNAME"") AS 
  SELECT a.CONNID,
       a.GOODSOWNERID,
       a.CONNOPCODE,
       a.CONNTYPE,
       a.CONNPHONE,
       a.CONNNAME,
       a.CONNSEX,
       a.BIRTHDAY,
       a.EMAIL,
       a.FAX,
       a.MOBILE,
       a.USESTATUS,
       a.MEMO,
       b.goopcode,
       b.goodsownername
  from tpl_go_connector a, tpl_goodsowner b
 where a.goodsownerid = b.goodsownerid

 "
"TPL_INOUT_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_INOUT_ORDER_V"" (""ORDERFLAG"", ""ORDERID"", ""JOBTYPE"", ""CREDATE"", ""WAREHID"", ""TOWAREHID"", ""GOODSOWNERID"", ""DETAILLINES"", ""OPERATIONTYPE"", ""PARTEXPFLAG"", ""EXPORTMEMO"", ""USESTATUS"", ""MEDICINECLASS"", ""INPUTMANID"", ""TAXFLAG"", ""BILLFROM"", ""CONFIRMMAN"", ""CONFIRMDATE"", ""CONFIRMNAME"", ""WAREHOPCODE"", ""WAREHNAME"", ""WAREHNO"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""RECCOMPANOPCODE"", ""RECCOMPANYNAME"", ""OPCODE"", ""EMPLOYEENAME"", ""TRANSID"", ""INCEPTADDR"", ""OUTMODE"", ""PROVINCE"", ""CONNECTOR"", ""CONNPHONE"", ""RECCOMPANYID"") AS 
  SELECT 2 orderflag,
       a.EXPORDERID orderid,
      a.jobtype,
       a.CREDATE,
       a.WAREHID,
       0 towarehid,
       a.GOODSOWNERID,
       a.DETAILLINES,
       a.operationtype,
       a.PARTEXPFLAG,
       a.EXPORTMEMO,
       a.usestatus,
       a.medicineclass,
       a.inputmanid,
       a.TAXFLAG,
       a.billfrom,
       a.confirmman,
       a.confirmdate,
       j.employeename confirmname,
       c.WAREHOPCODE,
       c.WAREHNAME,
       c.WAREHNO,
       d.GOODSOWNERNAME,
       d.GOOPCODE,
       f.OPCODE reccompanopcode,
       f.companyNAME reccompanyname,
       g.OPCODE,
       g.EMPLOYEENAME,
       a.transid,
       i.Inceptaddr,
       a.outmode,
       f.province,
       i.connector,
       i.connphone,
       a.reccompanyid
  from tpl_export_order      a,
       wms_transport_mode    b,
       tpl_warehouse         c,
       tpl_goodsowner        d,
       tpl_go_company        f,
       pub_employee          g,
       wms_transport_address i,
       pub_employee          j
 where a.transmodeid = b.transmodeid(+)
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid
   and a.reccompanyid = f.companyid(+)
   and a.inputmanid = g.employeeid(+)
   and a.transid = i.transid(+)
   and a.confirmman = j.employeeid(+)
   and a.usestatus in (2,-2,-3,-4)
UNION ALL
SELECT 1 orderflag,
       a.PORDERID orderid,
       a.jobtype,
       a.CREDATE,
       a.WAREHID,
       0 towarehid,
       a.GOODSOWNERID,
       a.DTLLINES,
       a.operationtype,
       a.mulrecflag PARTEXPFLAG,
       a.Memo,
       a.usestatus,
       a.medicineclass,
       a.inputmanid,
       a.TAXFLAG,
       a.billfrom,
       a.confirmman,
       a.confirmdate,
       j.employeename confirmname,
       c.WAREHOPCODE,
       c.WAREHNAME,
       c.WAREHNO,
       d.GOODSOWNERNAME,
       d.GOOPCODE,
       f.OPCODE reccompanopcode,
       f.companyNAME reccompanyname,
       g.OPCODE,
       g.EMPLOYEENAME,
       a.transid,
       i.Inceptaddr,
       a.inmode,
       f.province,
       i.connector,
       i.connphone,
       a.Sourcecompanyid
  from tpl_purchase_order    a,
       tpl_warehouse         c,
       tpl_goodsowner        d,
       tpl_go_company        f,
       pub_employee          g,
       wms_transport_address i,
       pub_employee          j
 where a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid
   and a.Sourcecompanyid = f.companyid(+)
   and a.inputmanid = g.employeeid(+)
   and a.transid = i.transid(+)
   and a.confirmman = j.employeeid(+)
and a.usestatus in (2,-2,-3,-4)
"
"TPL_INSPECTION_REPORT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_INSPECTION_REPORT_V"" (""INSPECTIONID"", ""GOODSOWNERID"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""GOODSID"", ""OPCODE"", ""FACTID"", ""FACTNAME"", ""INPUTMANID"", ""EMPLOYEENAME"", ""CREDATE"", ""REPORTNO"", ""GOODSNAME"", ""LOTNO"", ""GOODSTYPE"", ""PRODAREA"", ""PACKSNAME"", ""SUPPLYUNIT"", ""VALIDDATE"", ""CHECKPURPOSE"", ""CHECKQTY"", ""CHECKITEM"", ""CHECKDATE"", ""CHECKPROOF"", ""REPORTDATE"", ""FILENAME"", ""USESTATUS"", ""APPROVEDOCNO"", ""REGISTDOCNO"", ""PRODDATE"", ""PAGENUM"", ""LICENSEID"", ""FILEGROUPID"") AS 
  SELECT A.INSPECTIONID,
       A.GOODSOWNERID,
       B.Goopcode,
       B.GoodsOwnerName,
       A.GOODSID,
       C.Opcode,
       c.factid,
       e.companyname factname,
       A.INPUTMANID,
       D.EMPLOYEENAME,
       A.CREDATE,
       A.REPORTNO,
       A.GOODSNAME,
       A.LOTNO,
       A.GOODSTYPE,
       A.PRODAREA,
       A.PACKSNAME,
       A.SUPPLYUNIT,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       A.CHECKPURPOSE,
       A.CHECKQTY,
       A.CHECKITEM,
       A.CHECKDATE,
       A.CHECKPROOF,
       A.REPORTDATE,
       A.FILENAME,
       A.USESTATUS,
       A.APPROVEDOCNO,
       A.REGISTDOCNO,
       A.Proddate,
       A.Pagenum,
       A.LICENSEID,
       a.filegroupid
  FROM TPL_INSPECTION_REPORT A,
       tpl_goodsowner        B,
       tpl_pub_goods         C,
       pub_employee          D,
       tpl_pub_company e
 WHERE A.GOODSOWNERID = B.GOODSOWNERID(+)
   AND A.GOODSID = C.GOODSID(+)
   and A.INPUTMANID = d.EMPLOYEEID(+)
   and c.factid = e.companyid(+)
"
"TPL_INVOICE_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_INVOICE_DOC_V"" (""WAREHID"", ""WAREHNAME"", ""WAREHOPCODE"", ""WAREHSHORTNAME"", ""WAREHNO"", ""KEYID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""GOODSOWNERSHORT"", ""INVOICEHEAD"", ""INVOICEADDRESS"", ""INVPHONE"", ""INVID"", ""INVFIRSTNO"", ""INVNO"", ""INVTYPE"", ""INVCLASS"", ""CREDATE"", ""CUSTOMID"", ""CUSTOMNAME"", ""CUSTOMTAXNO"", ""CUSTOMTELEPHONE"", ""CUSTOMADDRESS"", ""CUSTOMBANKNAME"", ""CUSTOMACCNO"", ""ABSTRACT"", ""TOTAL"", ""TOTALTAX"", ""TOTALNOTAX"", ""TOTALLINE"", ""INPUTMAN"", ""RECMAN"", ""CHECKMAN"", ""SALER"", ""INVALIDMANID"", ""INVALIDMAN"", ""INVALIDDATE"", ""USEMANID"", ""USEMAN"", ""USEDATE"", ""PRTMANID"", ""PRTMAN"", ""PRTDATE"", ""INVLIMIT"", ""INVSTATUS"", ""PRTLINES"", ""INSEQ"", ""PRINTLINE"", ""PRINTNO"", ""EXPFLAG"", ""EXPDATE"", ""EXPFILENAME"", ""MEMO"") AS 
  select  a.warehid,
          b.warehname,
          b.warehopcode,
          b.warehshortname,
          b.warehno,
          a.keyid,
          a.goodsownerid,
          c.goodsownername,
          c.goopcode,
          c.goodsownershort,
          c.invoicehead,
          c.invoiceaddress,
          c.invphone,
          a.invid,
          a.invfirstno,
          a.invno,
          a.invtype,
          a.invclass,
          a.credate,
          a.customid,
          a.customname,
          a.customtaxno,
          a.customtelephone,
          a.customaddress,
          a.custombankname,
          a.customaccno,
          a.abstract,
          a.total,
          a.totaltax,
          a.totalnotax,
          a.totalline,
          a.inputman,
          a.recman,
          a.checkman,
          a.saler,
          a.invalidmanid,
          d.employeename invalidman,
          a.invaliddate,
          a.usemanid,
          e.employeename useman,
          a.usedate,
          a.prtmanid,
          f.employeename prtman,
          a.prtdate,
          a.invlimit,
          a.invstatus,
          a.prtlines,
          a.inseq,
          a.printline,
          a.printno,
          a.expflag,
          a.expdate,
          a.expfilename,
          a.memo
    from tpl_invoice_doc a,tpl_warehouse b,tpl_goodsowner c,pub_employee d,pub_employee e,pub_employee f
   WHERE a.warehid = b.warehid
   AND   a.goodsownerid = c.goodsownerid
   AND   a.invalidmanid = d.employeeid(+)
   AND   a.usemanid = e.employeeid(+)
   AND   a.prtmanid = f.employeeid(+)

 "
"TPL_INVOICE_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_INVOICE_DTL_V"" (""INVID"", ""INVDTLID"", ""INVLINE"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSQTY"", ""GOODSUNIT"", ""UNITPRICE"", ""TOTAL_LINE"", ""TAXRATE"", ""TAXMONEY"", ""NOTAXMONEY"", ""NOTAXUNITPRICE"", ""LOTNO"", ""PRINTLINE"", ""PRINTNO"", ""SRCDTLID"", ""SRCTINYID"", ""DTLINVMEMO"", ""EXPFLAG"", ""EXPDATE"", ""EXPFILENAME"") AS 
  select  invid,
          invdtlid,
          invline,
          goodsid,
          goodsname,
          goodstype,
          goodsqty,
          goodsunit,
          unitprice,
          total_line,
          taxrate,
          taxmoney,
          notaxmoney,
          notaxunitprice,
          lotno,
          printline,
          printno,
          srcdtlid,
          srctinyid,
          dtlinvmemo,
          expflag,
          expdate,
          expfilename
    from tpl_invoice_dtl

 "
"TPL_INVOICE_IN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_INVOICE_IN_V"" (""KEYID"", ""WAREHID"", ""WAREHNAME"", ""WAREHOPCODE"", ""WAREHSHORTNAME"", ""WAREHNO"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""GOODSOWNERSHORT"", ""INVOICEHEAD"", ""INVOICEADDRESS"", ""INVPHONE"", ""INMANID"", ""INMAN"", ""INDATE"", ""INVFIRSTNO"", ""STARTINVNO"", ""ENDINVNO"", ""INVTYPE"", ""INVLIMIT"", ""PRTLINES"", ""CONFIRMMANID"", ""CONFIRMMAN"", ""CONFIRMDATE"", ""INVALIDMANID"", ""INVALIDMAN"", ""INVALIDDATE"", ""USESTATUS"", ""MEMO"") AS 
  select  a.keyid,
          a.warehid,
          b.warehname,
          b.warehopcode,
          b.warehshortname,
          b.warehno,
          a.goodsownerid,
          c.goodsownername,
          c.goopcode,
          c.goodsownershort,
          c.invoicehead,
          c.invoiceaddress,
          c.invphone,
          a.inmanid,
          d.employeename inman,
          a.indate,
          a.invfirstno,
          a.startinvno,
          a.endinvno,
          a.invtype,
          a.invlimit,
          a.prtlines,
          a.confirmmanid,
          e.employeename confirmman,
          a.confirmdate,
          a.invalidmanid,
          f.employeename invalidman,
          a.invaliddate,
          a.usestatus,
          a.memo
    from tpl_invoice_in a,tpl_warehouse b,tpl_goodsowner c,pub_employee d,pub_employee e,pub_employee f
    WHERE a.warehid = b.warehid
    AND   a.goodsownerid = c.goodsownerid
    AND   a.inmanid = d.employeeid(+)
    AND   a.confirmmanid = e.employeeid(+)
    AND   a.invalidmanid = f.employeeid(+)

 "
"TPL_INVOICE_PRINT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_INVOICE_PRINT_V"" (""INVID"", ""INVDTLID"", ""INVLINE"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSQTY"", ""GOODSUNIT"", ""UNITPRICE"", ""TOTAL_LINE"", ""TAXRATE"", ""TAXMONEY"", ""NOTAXMONEY"", ""NOTAXUNITPRICE"", ""LOTNO"", ""PRINTLINE"", ""PRINTNO"", ""SRCDTLID"", ""SRCTINYID"", ""DTLINVMEMO"", ""EXPFLAG"", ""EXPDATE"", ""EXPFILENAME"", ""INVNO"", ""CUSTOMID"", ""COMPANYNAME"", ""BANKNO"", ""INVOICETELE"", ""INVOICEADDRESS"") AS 
  select  a.invid,
          a.invdtlid,
          a.invline,
          a.goodsid,
          a.goodsname,
          a.goodstype,
          a.goodsqty,
          a.goodsunit,
          a.unitprice,
          a.total_line,
          a.taxrate,
          a.taxmoney,
          a.notaxmoney,
          a.notaxunitprice,
          a.lotno,
          a.printline,
          a.printno,
          a.srcdtlid,
          a.srctinyid,
          a.dtlinvmemo,
          a.expflag,
          a.expdate,
          a.expfilename,
          b.invno,
          b.customid,
          c.companyname,
          c.bankno,
          c.invoicetele,
          c.invoiceaddress
    from tpl_invoice_dtl a,
    tpl_invoice_doc b,
    tpl_go_company c
    WHERE a.invid = b.invid
    AND b.customid = c.companyid
    AND b.goodsownerid = c.goodsownerid

 "
"TPL_IN_ORDER_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_IN_ORDER_DTL_V"" (""INID"", ""INDTLID"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTNAME"", ""OWNERGOODSID"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""PORDERSTATUS"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""MEMO"", ""ARRIVEDATE"", ""CHECKDATE"", ""PUTUPDATE"", ""SRCDTLNO"", ""LOTFLAG"", ""BATCHFLAG"", ""CUSTCANCELSTATUS"", ""KEEPFLAG"", ""GTRADEPACK"", ""ORIGINQTY"", ""PRICE"", ""RETAILPRICE"", ""AMT"", ""QTY"", ""QUADQTY"", ""UNQUADQTY"", ""TESTQTY"", ""STOCKQTY"", ""SADTLID"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""OLDDTLID"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""FIRSTFLAG"", ""OTHERID"", ""TPRICETICK"", ""TPRICEFLAG"", ""GOODSOWNID"", ""GOODSNO"", ""GOODSCLASS"", ""CANCELDATE"", ""CANCELMANID"", ""CANCELMANNAME"") AS 
  select a.inid,
       a.indtlid,
       a.warehid,
       a.goodsownerid,
       b.goodsownername,
       a.goodsid,
       c.opcode,
       c.goodsname,
       c.goodstype,
       c.prodarea,
       c.factid,
       h.companyname factname,
       a.ownergoodsid,
       a.goodspackid,
       d.packname,
       d.packsize,
       a.porderstatus,
       a.batchno,
       a.lotid,
       a.lotno,
       a.goodsqty,
       a.tradegoodsqty,
       a.tradegoodspack,
       a.memo,
       a.arrivedate,
       a.checkdate,
       a.putupdate,
       a.srcdtlno,
       a.lotflag,
       a.batchflag,
       a.custcancelstatus,
       a.keepflag,
       a.gtradepack,
       a.originqty,
       a.price,
       a.retailprice,
       a.amt,
       a.qty,
       a.quadqty,
       a.unquadqty,
       a.testqty,
       a.stockqty,
       a.sadtlid,
       a.goodsstatusid,
       e.goodsstatus,
       e.quantitystatus,
       a.olddtlid,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.proddate,
       a.approvedocno,
       a.firstflag,
       a.otherid,
       a.tpricetick,
       a.tpriceflag,
       f.goodsownid,
       f.goodsno,
       g.goodsclass,
       a.canceldate,
       a.cancelmanid,
       dd.employeename cancelmanname
  from tpl_in_order_dtl    a,
       tpl_goodsowner      b,
       tpl_pub_goods       c,
       tpl_pub_goods_packs d,
       wms_goodsstatus     e,
       tpl_goods           f,
       wms_goods_feature   g,
       pub_employee        dd,
       tpl_pub_company     h
 where a.goodsownerid = b.goodsownerid
   and a.goodsid = c.goodsid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.goodsstatusid = e.goodsstatusid(+)
   and a.ownergoodsid = f.ownergoodsid
   and a.goodsid = g.goodsid(+)
   and a.warehid = g.warehid(+)
   and c.factid = h.companyid(+)
   and a.cancelmanid = dd.employeeid(+)
"
"TPL_IN_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_IN_ORDER_V"" (""INID"", ""PORDERNO"", ""COMEFROM"", ""CREDATE"", ""ARRIVEDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""SOURCECOMPANYID"", ""SRCCOMPANYNAME"", ""MEDICINECLASS"", ""IMPORTFLAG"", ""TAXFLAG"", ""JOBTYPE"", ""OPERATIONTYPE"", ""DTLLINES"", ""MEMO"", ""INPUTMANID"", ""INPUTMANNAME"", ""SRCNO"", ""TRANSID"", ""INCEPTADDR"", ""EXPORDERID"", ""BILLFROM"", ""CONFIRMMAN"", ""CONFIRMNAME"", ""CONFIRMDATE"", ""USESTATUS"", ""MULRECFLAG"", ""RECCOUNT"", ""INMODE"", ""VALIDDAYS"", ""INVALIDATE"", ""ORDERFLAG"", ""GENFLAG"", ""SABACKDATE"", ""SBREASONID"", ""BACKREASON"", ""NOWLFLAG"", ""CUSTOMTYPE"", ""FINISHFLAG"", ""OLDID"", ""OTHERID"", ""TPRICETICK"", ""TPRICEFLAG"", ""DEPTNO"", ""DEPTNAME"", ""GCOMPANYID"", ""GCOMPANYNO"", ""GCOMPANYOPCODE"", ""BMSDOCID"", ""TRANSMODEID"", ""TRANSMODE"", ""TRANSNAME"", ""TRANSCLASS"", ""CANCELDATE"", ""CANCELMANID"", ""CANCELMANNAME"", ""GCOMPANYNAME"", ""ORDERNO"") AS 
  select a.inid,
       a.porderno,
       a.comefrom,
       a.credate,
       a.arrivedate,
       a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.sourcecompanyid,
       d.companyname srccompanyname,
       a.medicineclass,
       a.importflag,
       a.taxflag,
       a.jobtype,
       a.operationtype,
       a.dtllines,
       a.memo,
       a.inputmanid,
       e.employeename inputmanname,
       a.srcno,
       a.transid,
       h.inceptaddr,
       a.exporderid,
       a.billfrom,
       a.confirmman,
       f.employeename confirmname,
       a.confirmdate,
       a.usestatus,
       a.mulrecflag,
       a.reccount,
       a.inmode,
       a.validdays,
       a.invalidate,
       a.orderflag,
       a.genflag,
       a.sabackdate,
       a.sbreasonid,
       g.backreason,
       a.nowlflag,
       a.customtype,
       a.finishflag,
       a.oldid,
       a.otherid,
       a.tpricetick,
       a.tpriceflag,
       a.deptno,
       a.deptname,
       d.gcompanyid,
       d.gcompanyno,
       d.gcompanyopcode,
       a.bmsdocid,
       a.transmodeid,
       i.transmode,
       i.transname,
       a.transclass,
       a.canceldate,
       a.cancelmanid,
       dd.employeename cancelmanname,
       a.gcompanyname,--add by weitangjing 20131102 原货主单位名称
       a.orderno --雨诺系统的单据编号
  from tpl_in_order     a,
        tpl_warehouse   b,
        tpl_goodsowner  c,
        tpl_go_company  d,
        pub_employee    e,
        pub_employee    f,
        tpl_back_reason g,
        wms_transport_address h,
        pub_employee       dd,
        wms_transport_mode i
  where a.warehid = b.warehid(+)
    and a.goodsownerid = c.goodsownerid(+)
    and a.sourcecompanyid = d.companyid(+)
    and a.inputmanid = e.employeeid(+)
    and a.confirmman = f.employeeid(+)
    and a.transid = h.transid(+)
    and a.Sbreasonid=g.backid(+)
    AND a.transmodeid = i.transmodeid(+)
 and a.cancelmanid = dd.employeeid(+)
"
"TPL_LICENSE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_LICENSE_V"" (""LICENSEID"", ""GOODSOWNERID"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""GOODSID"", ""OPCODE"", ""INPUTMANID"", ""EMPLOYEENAME"", ""CREDATE"", ""LICENSENO"", ""COMPANY"", ""ADDRESS"", ""GOODSNAME"", ""MAINSECT"", ""MEDFORM"", ""GOODSTYPE"", ""PACKSIZE"", ""MEDVALIDMONTH"", ""FACTORYNAME"", ""PRODAREA"", ""VALIDDATE"", ""LICENSESTANDARD"", ""FILENAME"", ""PAGENUM"", ""USESTATUS"", ""FILEGROUPID"") AS 
  SELECT a.LICENSEID,
       a.GOODSOWNERID,
       b.Goopcode,
       b.GoodsOwnerName,
       a.GOODSID,
       c.Opcode,
       a.INPUTMANID,
       d.EMPLOYEENAME,
       a.CREDATE,
       a.LICENSENO,
       a.COMPANY,
       a.ADDRESS,
       a.GOODSNAME,
       a.MAINSECT,
       a.MEDFORM,
       a.GOODSTYPE,
       a.PACKSIZE,
       a.MEDVALIDMONTH,
       a.FACTORYNAME,
       a.PRODAREA,
       a.VALIDDATE,
       a.LICENSESTANDARD,
       a.FILENAME,
       a.pAgenum,
       a.USESTATUS,
       a.filegroupid
  from TPL_LICENSE a, tpl_goodsowner b, tpl_pub_goods c, pub_employee d
 where a.GOODSOWNERID = b.GOODSOWNERID(+)
   and a.GOODSID = c.GOODSID(+)
   and a.INPUTMANID = d.EMPLOYEEID(+)

 "
"TPL_ORDER_ALLOT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_ORDER_ALLOT_V"" (""GOODSOWNERID"", ""GOODSOWNERNAME"", ""PORDERID"", ""INOUTFLAG"", ""OPERATIONTYPE"", ""OPERATIONTYPENAME"", ""USESTATUS"", ""USESTATUSNAME"", ""SRCNO"") AS 
  select a.goodsownerid,
         b.goodsownername,
         a.porderid,
         '入库' inoutflag,
         a.operationtype,
         c.ddlname operationtypename,
         a.usestatus,
         d.ddlname usestatusname,
         a.srcno
    from tpl_purchase_order a,tpl_goodsowner b,sys_ddl_all_v c,sys_ddl_all_v d
    WHERE a.goodsownerid = b.goodsownerid
    AND   c.keyword LIKE 'TPL_OPERATIONTYPE'
    AND   d.keyword LIKE 'TPL_PO_STATUS'
    AND   a.usestatus = d.ddlid
    AND   a.operationtype = c.ddlid

  UNION

  select a.goodsownerid,
         b.goodsownername,
         a.exporderid porderid,
         '出库' inoutflag,
         a.operationtype,
         c.ddlname operationtypename,
         a.usestatus,
         d.ddlname usestatusname,
         a.srcexpno srcno
    from tpl_export_order a,tpl_goodsowner b,sys_ddl_all_v c,sys_ddl_all_v d
    WHERE a.goodsownerid = b.goodsownerid
    AND   c.keyword LIKE 'TPL_OPERATIONTYPE'
    AND   d.keyword LIKE 'TPL_EXPORT_ORDER_STATUS'
    AND   a.usestatus = d.ddlid
    AND   a.operationtype = c.ddlid

 "
"TPL_OUT_ORDER_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_OUT_ORDER_DTL_V"" (""OUTID"", ""BMSINOUTID"", ""OUTDTLID"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTNAME"", ""OWNERGOODSID"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""PRICE"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""REALQTY"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""STOCKQTY"", ""CUSTCANCELSTATUS"", ""WMSCANCELSTATUS"", ""ADDMEDCHECKFLAG"", ""SRCEXPDTLNO"", ""USESTATUS"", ""PRINTFLAG"", ""PRINTERROR"", ""DISTRIBUTEID"", ""DISTRIBUTEDTLID"", ""RETAILPRICE"", ""AMT"", ""ALLOCATETIME"", ""FAILREASON"", ""EXPDTLMEMO"", ""PLACESUPPLYID"", ""PLACESUPPLYDTLID"", ""PLACEPRICE"", ""RESALEPRICE"", ""PLACEMONEY"", ""GOODSCLASSID"", ""OTCFLAG"", ""TRADEMARK"", ""APPROVEDOCNO"", ""REGISTNO"", ""JKHZFLAG"", ""PRODDATE"", ""QUALIFYDOCNO"", ""GOODSCLASSNAME"", ""OLDDTLID"", ""OTHERID"", ""EXPFLAG"", ""EXPDATE"", ""EXPFILENAME"", ""INVOICENO"", ""INVOICELINE"", ""CANKEEP"", ""ZXCOLOR"", ""TPRICETICK"", ""TPRICEFLAG"", ""SORTTYPE"", ""LOTLIMIT"", ""PERIODLIMIT"", ""PERIODLIMITUNIT"", ""GOODSOWNID"", ""PRTORDERSET"", ""DTLMEMO"", ""GOODSCLASS"", ""GOODSNO"", ""CANCELDATE"", ""CANCELMANID"", ""CANCELMANNAME"") AS 
  select a.outid,
       a.bmsinoutid,
       a.outdtlid,
       a.warehid,
       a.goodsownerid,
       a.goodsid,
       b.goodsname,
       b.goodstype,
       b.prodarea,
       b.factid,
       h.companyname factname,
       a.ownergoodsid,
       a.batchno,
       a.lotid,
       a.lotno,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.goodsstatusid,
       d.goodsstatus,
       a.quantitystatus,
       a.price,
       a.goodsqty,
       a.goodspackid,
       c.packname,
       c.packsize,
       a.realqty,
       a.tradegoodsqty,
       a.tradegoodspack,
       a.stockqty,
       a.custcancelstatus,
       a.wmscancelstatus,
       a.addmedcheckflag,
       a.srcexpdtlno,
       a.usestatus,
       decode(a.printflag,null,null,1) printflag,
       a.printerror,
       a.distributeid,
       a.distributedtlid,
       a.retailprice,
       a.amt,
       a.allocatetime,
       a.failreason,
       a.expdtlmemo,
       a.placesupplyid,
       a.placesupplydtlid,
       a.placeprice,
       a.resaleprice,
       a.placemoney,
       a.goodsclassid,
       a.otcflag,
       a.trademark,
       g.approvedocno,
       g.registno,
       b.jkhzflag,
       a.proddate,
       a.qualifydocno,
       a.goodsclassname,
       a.olddtlid,
       a.otherid,
       a.expflag,
       a.expdate,
       a.expfilename,
       a.invoiceno,
       a.invoiceline,
       a.cankeep,
       a.zxcolor,
       a.tpricetick,
       a.tpriceflag,
       a.sorttype,
       a.lotlimit,
       a.periodlimit,
       a.periodlimitunit,
       e.goodsownid,
       a.prtorderset,
       a.dtlmemo,
       f.goodsclass,
       e.goodsno,
       a.canceldate,
       a.cancelmanid,
       dd.employeename cancelmanname
  from tpl_out_order_dtl   a,
        tpl_pub_goods       b,
        tpl_pub_goods_packs c,
        wms_goodsstatus     d,
        tpl_goods           e,
        wms_goods_feature   f,
        wms_goods_lot       g,
        pub_employee        dd,
        tpl_pub_company     h
  where a.goodsid = b.goodsid(+)
    and a.goodspackid = c.goodspackid(+)
    and a.goodsstatusid = d.goodsstatusid(+)
    and a.ownergoodsid = e.ownergoodsid(+)
    and a.goodsid = f.goodsid(+)
    and a.warehid = f.warehid(+)
    and a.lotid = g.lotid(+)
    and b.factid = h.companyid(+)
    and a.cancelmanid = dd.employeeid(+)
"
"TPL_OUT_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_OUT_ORDER_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMEFROM"", ""OUTID"", ""WAVEID"", ""WAVEDTLID"", ""EORDERNO"", ""LINENO"", ""CREDATE"", ""PREEXPDATE"", ""EXPDATE"", ""PREARRIVEDATE"", ""ARRIVEDATE"", ""PTRANSMODEID"", ""PTRANSMODE"", ""PTRANSNAME"", ""TRANSMODEID"", ""TRANSMODE"", ""TRANSNAME"", ""EARLYDATE"", ""COMPOSEINFO"", ""TRANSNO"", ""RECCOMPANYID"", ""RECCOMPANYNAME"", ""COMPANYTYPE"", ""TAXFLAG"", ""INPUTMANID"", ""EMPLOYEENAME"", ""JOBTYPE"", ""OPERATIONTYPE"", ""MEDICINECLASS"", ""RECEIVEADDR"", ""RECEIVEHEAD"", ""REALRECADDR"", ""REALRECMAN"", ""RECEIVEMAN"", ""SIGNMAN"", ""PARTEXPFLAG"", ""SAMELOTFLAG"", ""URGENFLAG"", ""ADDINVOICEFLAG"", ""ARRIVEMEMO"", ""EXPORTMEMO"", ""DETAILLINES"", ""NOWLFLAG"", ""SRCEXPNO"", ""TRANSID"", ""INCEPTADDR"", ""CONNECTOR"", ""CONNPHONE"", ""PORDERID"", ""BILLFROM"", ""CONFIRMMAN"", ""CONFIRMDATE"", ""CONFIRMNAME"", ""USESTATUS"", ""OUTMODE"", ""INVOICETYPE"", ""TRANSCLASS"", ""FLOWLINENO"", ""SCATTERPACKS"", ""SCATTERFINPACKS"", ""WHOLEPACKS"", ""WHOLEFINPACKS"", ""ALLOCATETIME"", ""FINISHFLAG"", ""FIXFLAG"", ""SALERID"", ""SALERNAME"", ""OLDID"", ""OTHERID"", ""TPRICETICK"", ""TPRICEFLAG"", ""DEPTNO"", ""DEPTNAME"", ""RECEIVEPHONE"", ""TRDTLID"", ""SASETTLEDTLID"", ""PRTCLASS"", ""PRTGROUPSET"", ""GCOMPANYID"", ""GCOMPANYNO"", ""CUSTTYPE"", ""EMPLOYEEID"", ""MANOPCODE"", ""MANNAME"", ""CANCELDATE"", ""CANCELMANID"", ""CANCELMANNAME"", ""GCOMPANYNAME"", ""ORDERNO"") AS 
  select a.warehid,
       c.warehname,
       a.goodsownerid,
       d.goodsownername,
       a.comefrom,
       a.outid,
       a.waveid,
       a.wavedtlid,
       a.eorderno,
       a.lineno,
       a.credate,
       a.preexpdate,
       a.expdate,
       a.prearrivedate,
       a.arrivedate,
       a.ptransmodeid,
       h.transmode ptransmode,
       h.transname ptransname,
       a.transmodeid,
       b.transmode,
       b.transname,
       a.earlydate,
       a.composeinfo,
       a.transno,
       a.reccompanyid,
       f.companyname reccompanyname,
       a.companytype,
       a.taxflag,
       a.inputmanid,
       g.employeename,
       a.jobtype,
       a.operationtype,
       a.medicineclass,
       a.receiveaddr,
       a.receivehead,
       a.realrecaddr,
       a.realrecman,
       a.receiveman,
       a.signman,
       a.partexpflag,
       a.samelotflag,
       nvl(a.urgenflag, 0) urgenflag,
       a.addinvoiceflag,
       a.arrivememo,
       a.exportmemo,
       a.detaillines,
       a.nowlflag,
       a.srcexpno,
       a.transid,
       i.inceptaddr,
       i.connector,
       i.connphone,
       a.porderid,
       a.billfrom,
       a.confirmman,
       a.confirmdate,
       j.employeename confirmname,
       a.usestatus,
       a.outmode,
       a.invoicetype,
       a.transclass,
       a.flowlineno,
       a.scatterpacks,
       a.scatterfinpacks,
       a.wholepacks,
       a.wholefinpacks,
       a.allocatetime,
       a.finishflag,
       a.fixflag,
       a.salerid,
       a.salername,
       a.oldid,
       a.otherid,
       a.tpricetick,
       a.tpriceflag,
       a.deptno,
       a.deptname,
       a.receivephone,
       a.trdtlid,
       a.sasettledtlid,
       a.prtclass,
       a.prtgroupset,
       f.gcompanyid,
       f.gcompanyno,
       substr(f.gcompanyno, 6, 1) custtype,
       a.employeeid,
       k.opcode manopcode,
       k.employeename manname,
       a.canceldate,
       a.cancelmanid,
       dd.employeename cancelmanname,
       a.gcompanyname,--add by weitangjing 20131102 货主原单位名称
       a.orderno --雨诺系统的单据编号
  from tpl_out_order         a,
       wms_transport_mode    b,
       tpl_warehouse         c,
       tpl_goodsowner        d,
       tpl_go_company        f,
       pub_employee          g,
       wms_transport_mode    h,
       wms_transport_address i,
       pub_employee          j,
       pub_employee          dd,
       pub_employee          k
 where a.transmodeid = b.transmodeid(+)
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.reccompanyid = f.companyid(+)
   and a.inputmanid = g.employeeid(+)
   and a.transid = i.transid(+)
   and a.confirmman = j.employeeid(+)
   and a.ptransmodeid = h.transmodeid(+)
   and a.employeeid = k.employeeid(+)
   and a.cancelmanid = dd.employeeid(+)
"
"TPL_OWNERGOODS_PACKS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_OWNERGOODS_PACKS_V"" (""OWNERPACKID"", ""OWNERGOODSID"", ""OWNERGOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""BASEUNITFLAG"", ""PACKNAME"", ""PACKSIZE"", ""GOODSPACKID"", ""PUBPACKNAME"", ""PUBPACKSIZE"", ""PUBBASEUNITFLAG"", ""PUBUSESTATUS"", ""USESTATUS"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSWEIGHT"", ""GOODSCUBAGE"", ""WEIGHTUNIT"", ""MEMO"", ""PACKID"") AS 
  select a.ownerpackid,
         a.ownergoodsid,
         b.opcode ownergoodsopcode,
         b.goodsname,
         b.goodstype,
         a.baseunitflag,
         a.packname,
         a.packsize,
         a.goodspackid,
         c.packname pubpackname,
         c.packsize pubpacksize,
         c.baseunitflag pubbaseunitflag,
         c.usestatus pubusestatus,
         a.usestatus,
         a.goodslength,
         a.goodswidth,
         a.goodsheight,
         a.goodsweight,
         a.goodscubage,
         a.weightunit,
         a.memo,
         a.packid
    from tpl_goods_packs a,tpl_goods b,tpl_pub_goods_packs c
  where  a.ownergoodsid = b.ownergoodsid
  and    a.goodspackid = c.goodspackid(+)
"
"TPL_OWNER_BACK_REASON_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_OWNER_BACK_REASON_DEF_V"" (""SEQID"", ""GFBACKID"", ""GFBACKREASON"", ""GFMEMO"", ""BACKID"", ""BACKREASON"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.seqid,
       a.gfbackid,
       a.gfbackreason,
       a.gfmemo,
       a.backid,
       c.backreason,
       a.goodsownerid,
       b.goodsownername
  from tpl_owner_back_reason_def a,
       tpl_goodsowner b,
       tpl_back_reason c
 where  a.goodsownerid = b.goodsownerid
        and a.backid = c.backid

 "
"TPL_OWNER_DDL_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_OWNER_DDL_DEF_V"" (""SEQID"", ""KEYWORD"", ""DDLID"", ""DDLNAME"", ""DICID"", ""MEMO"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.seqid,
       a.Keyword,
       a.ddlid,
       a.Ddlname,
       a.Dicid,
       a.Memo,
       a.goodsownerid,
       b.goodsownername
  from tpl_owner_ddl_def a, tpl_goodsowner b
 where a.goodsownerid = b.goodsownerid

 "
"TPL_OWNER_GOODSSTATUS_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_OWNER_GOODSSTATUS_DEF_V"" (""SEQID"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOSTATUSID"", ""GOSTATUSNAME"") AS 
  select a.seqid,
       a.goodsstatusid,
       c.goodsstatus,
       c.quantitystatus,
       c.useflag,
       a.goodsownerid,
       b.goodsownername,
       a.gostatusid,
       a.gostatusname
  from tpl_owner_goodsstatus_def a,
       tpl_goodsowner b,
       wms_goodsstatus c
 where  a.goodsownerid = b.goodsownerid
        and a.goodsstatusid = c.goodsstatusid

 "
"TPL_OWNER_QUANSTATUS_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_OWNER_QUANSTATUS_DEF_V"" (""SEQID"", ""QUANTITYID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOQUANTITYID"", ""GOQUANTITYNAME"", ""QUALITY"") AS 
  select a.seqid,
       a.quantityid,
       a.goodsownerid,
       b.goodsownername,
       a.goquantityid,
       a.goquantityname,
       a.quality
  from tpl_owner_quanstatus_def a,
       tpl_goodsowner b
 where  a.goodsownerid = b.goodsownerid

 "
"TPL_OWNER_TRANS_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_OWNER_TRANS_DEF_V"" (""SEQID"", ""TRANSPORTID"", ""TRANSMODE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOTRANSID"", ""GOTRANSNAME"") AS 
  select a.seqid,
       a.transportid,
       c.transmode,
       a.goodsownerid,
       b.goodsownername,
       a.gotransid,
       a.gotransname
  from tpl_owner_trans_def a,
       tpl_goodsowner b,
       wms_transport_mode c
 where a.transportid = c.transmodeid
       and a.goodsownerid = b.goodsownerid

 "
"TPL_PROVINCE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_PROVINCE_V"" (""PROVINCEID"", ""PROVINCEOPCODE"", ""PROVINCENAME"") AS 
  SELECT 	PROVINCEID ,     	PROVINCEOPCODE ,      	PROVINCENAME  from TPL_PROVINCE  
 "
"TPL_PUB_COMPANY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_PUB_COMPANY_V"" (""COMPANYID"", ""COMPANYNO"", ""COMPANYOPCODE"", ""COMPANYPINYIN"", ""COMPANYNAME"", ""COMPANYSHORTNAME"", ""LEGALPERSION"", ""COMPANYCREDATE"", ""INPUTMANID"", ""COMPANYMEMO"", ""GOODSOWNERFLAG"", ""SUPPLIERFLAG"", ""CUSTOMFLAG"", ""FACTFLAG"", ""CHIEFOFFICER"", ""CONNECTOR"", ""TELEPHONE"", ""POSTCODE"", ""SUPPLIERADDRESS"", ""TAXREGISTNO"", ""BANK"", ""BANKNO"", ""DISTRICTID"", ""PROVINCE"", ""CUSTOMTYPE"", ""UNIFYNO"", ""ORGNO"", ""OPCODE"", ""EMPLOYEENAME"", ""DISTRICTNAME"", ""DISTRICTOPCODE"", ""WAREHOUSEFLAG"", ""CITYID"", ""CITYOPCODE"", ""CITYNAME"", ""TRANSFLAG"", ""REGIONID"", ""REGIONNAME"", ""DISTANCE"", ""CORPID"", ""ERPCOMPANYID"") AS 
  select a.companyid,
       a.companyno,
       a.companyopcode,
       a.companypinyin,
       a.companyname,
       a.companyshortname,
       a.legalpersion,
       a.companycredate,
       a.inputmanid,
       a.companymemo,
       a.goodsownerflag,
       a.supplierflag,
       a.customflag,
       a.factflag,
       a.chiefofficer,
       a.connector,
       a.telephone,
       a.postcode,
       a.supplieraddress,
       a.taxregistno,
       a.bank,
       a.bankno,
       a.districtid,
       a.province,
       a.customtype,
       a.unifyno,
       a.orgno,
       b.opcode,
       b.employeename,
       c.districtname,
       c.districtopcode,
       a.Warehouseflag,
       a.Cityid,
       d.CITYOPCODE,
       d.CITYNAME,
       a.transflag,
       a.regionid,
       e.regionname,
       e.distance,
       a.corpid,
       a.erpcompanyid
  from tpl_pub_company a, pub_employee b, tpl_district c, TPL_CITY d,tprice_trans_region e
 where a.inputmanid = b.employeeid(+)
   and a.districtid = c.districtid(+)
   and a.cityid = d.cityid(+)
   and a.regionid=e.regionid(+)
"
"TPL_PUB_GOODS_CLASS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_PUB_GOODS_CLASS_V"" (""CLASSID"", ""OPCODE"", ""CLASSPINYIN"", ""CLASSNO"", ""CLASSNAME"", ""PARENTCLASSID"", ""PARENTCLASSNAME"", ""USESTATUS"", ""CLASSCODE"") AS 
  select a.classid,
       a.opcode,
       a.classpinyin,
       a.classno,
       a.classname,
       a.parentclassid,
       b.classname parentclassname,
       a.usestatus,
       a.classcode

  from tpl_pub_goods_class a,
       tpl_pub_goods_class b

 where a.parentclassid = b.classid(+)

 "
"TPL_PUB_GOODS_HOV_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_PUB_GOODS_HOV_V"" (""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSFORMALNAME"", ""GOODSPINYIN"", ""GOODSQTYPE"", ""DICTNO"", ""CREDATE"", ""INPUTMANID"", ""MEMO"", ""BARCODE"", ""POISON_DRUG"", ""GOODSTYPE"", ""CLASSID"", ""FACTID"", ""PRODAREA"", ""UNIFYNO"", ""DRUGFORM"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""REGISTNO"") AS 
  select a.goodsid,
       a.opcode,
       a.goodsname,
       a.goodsengname,
       a.goodsformalname,
       a.goodspinyin,
       a.goodsqtype,
       a.dictno,
       a.credate,
       a.inputmanid,
       a.memo,
       a.barcode,
       a.poison_drug,
       a.goodstype,
       a.classid,
       a.factid,
       a.prodarea,
       a.unifyno,
       a.drugform,
       b.CompanyOpcode,
       b.Companyname,
       a.registno
  from tpl_pub_goods a, tpl_pub_company b
 where a.factid = b.Companyid(+)
 /*and a.goodsid in (select b.goodsid
                       from tpl_purchase_order a, tpl_purchase_order_dtl b
                      where a.porderid = b.porderid
                        and a.goodsownerid = 9142)
   and exists (select 1
          from wms_goods_feature x
         where x.warehid = 1
           and x.goodsid = a.goodsid
           and x.goodsclass not in (20, 15, 16))*/
"
"TPL_PUB_GOODS_HOV_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_PUB_GOODS_HOV_V1"" (""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSFORMALNAME"", ""GOODSPINYIN"", ""GOODSQTYPE"", ""DICTNO"", ""CREDATE"", ""INPUTMANID"", ""MEMO"", ""BARCODE"", ""POISON_DRUG"", ""GOODSTYPE"", ""CLASSID"", ""FACTID"", ""PRODAREA"", ""UNIFYNO"", ""DRUGFORM"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""REGISTNO"") AS 
  select a.goodsid,
       a.opcode,
       a.goodsname,
       a.goodsengname,
       a.goodsformalname,
       a.goodspinyin,
       a.goodsqtype,
       a.dictno,
       a.credate,
       a.inputmanid,
       a.memo,
       a.barcode,
       a.poison_drug,
       a.goodstype,
       a.classid,
       a.factid,
       a.prodarea,
       a.unifyno,
       a.drugform,
       b.CompanyOpcode,
       b.Companyname,
       a.registno
  from tpl_pub_goods a,
   tpl_pub_company b
 where a.factid = b.Companyid(+)
"
"TPL_PUB_GOODS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_PUB_GOODS_V"" (""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSFORMALNAME"", ""GOODSPINYIN"", ""GOODSQTYPE"", ""DICTNO"", ""CREDATE"", ""INPUTMANID"", ""MEMO"", ""BARCODE"", ""POISON_DRUG"", ""GOODSTYPE"", ""CLASSID"", ""CLASSNAME"", ""FACTID"", ""PRODAREA"", ""REGISTNO"", ""APPROVEDOCNO"", ""GMPFLAG"", ""UNIFYNO"", ""DRUGFORM"", ""L_PERIOD"", ""S_PERIODUNIT"", ""MANOPCODE"", ""EMPLOYEENAME"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""REPTYPE"", ""STORAGETYPE"", ""JKHZFLAG"", ""GOODSPY"", ""GOODSTYPEID"", ""TPRICEGTYPE"", ""SPECIALFLAG"", ""SIGNATURE"", ""FILEGROUPID"", ""ALONEPACKFLAG"", ""ZXCOL01"", ""TRADEPACK"", ""GOODSTEMPERATURE"", ""MAH"", ""XGFLAG"", ""ERPGOODSID"") AS 
  select a.goodsid,
       a.opcode,
       a.goodsname,
       a.goodsengname,
       a.goodsformalname,
       a.goodspinyin,
       a.goodsqtype,
       a.dictno,
       a.credate,
       a.inputmanid,
       a.memo,
       a.barcode,
       a.poison_drug,
       a.goodstype,
       a.classid,
       f.classname,
       a.factid,
       a.prodarea,
       a.registno,
       a.approvedocno,
       a.gmpflag,
       a.unifyno,
       a.drugform,
       a.l_period,
       a.s_periodunit,
       b.opcode manopcode,
       b.employeename,
       c.companyopcode,
       c.companyname,
       a.reptype,
       a.storagetype,
       a.jkhzflag,
       a.goodspy,
       a.goodstypeid,
       e.goodstypename tpricegtype,
       a.specialflag,
       a.signature,
       a.filegroupid,
       a.alonepackflag,
       g.zxcol01,
       a.tradepack ,-- add by guzhiqi
       a.goodstemperature,   --tl 货品温度要求,用于打印冷藏药品运输交接单中的""温度控制'  170605
       a.mah , --add by xyue 2019-08-21 上市许可持有人
       a.xgflag, --tl@210224 710022
       a.erpgoodsid
  from tpl_pub_goods     a,
       pub_employee      b,
       tpl_pub_company   c,
       tprice_goods_type e,
       tpl_pub_goods_class f,
       lyzx_Tprice_goods g
 where a.inputmanid = b.employeeid(+)
   and a.factid = c.companyid(+)
   AND a.goodstypeid = e.goodstypeid(+)
   and a.classid = f.classid(+)
   and a.goodsid = g.goodsid(+)
"
"TPL_PUB_PACKNAME_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_PUB_PACKNAME_DEF_V"" (""PACKID"", ""PACKNAME"", ""OPCODE"", ""INPUTMANID"", ""CREDATE"", ""MODIFYMANID"", ""MODIFYDATE"", ""INPUTMANNAME"", ""MODIFYMANNAME"") AS 
  (
select
a.PACKID,
a.PACKNAME,
a.OPCODE,
a.INPUTMANID,
a.CREDATE,
a.MODIFYMANID,
a.MODIFYDATE ,
 b.employeename inputmanname,
 c.employeename modifymanname
from
tpl_pub_packname_def a,
pub_employee b,
pub_employee c
where a.inputmanid = b.employeeid(+)
and a.modifymanid = c.employeeid(+)
)
"
"TPL_PUB_PACKS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_PUB_PACKS_V"" (""GOODSID"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""USESTATUS"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSWEIGHT"", ""WEIGHTUNIT"", ""BASEUNITFLAG"", ""GOODSPACKLAYER"", ""GOODSCUBAGE"") AS 
  select goodsid,
       goodspackid,
       packname,
       packsize,
       usestatus,
       goodslength,
       goodswidth,
       goodsheight,
       goodsweight,
       weightunit,
       baseunitflag,
       goodspacklayer,
       goodscubage
  from tpl_pub_goods_packs

 "
"TPL_PURCHASE_ORDER_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_PURCHASE_ORDER_DTL_V"" (""PORDERID"", ""PORDERDTLID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""PRODAREA"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSCLASSID"", ""QUANTITYSTATUS"", ""MEMO"", ""ARRIVEDATE"", ""CHECKDATE"", ""PUTUPDATE"", ""CANCELDATE"", ""SRCDTLNO"", ""LOTFLAG"", ""BATCHFLAG"", ""CUSTCANCELSTATUS"", ""WMSCANCELSTATUS"", ""KEEPFLAG"", ""GTRADEPACK"", ""ORIGINQTY"", ""PRICE"", ""RETAILPRICE"", ""AMT"", ""QTY"", ""QUADQTY"", ""UNQUADQTY"", ""TESTQTY"", ""SADTLID"", ""EXPDTLMEMO"", ""FIRSTFLAG"", ""TPRICETICK"", ""TPRICEFLAG"", ""GOODSOWNID"", ""PRTCLASS"", ""PORDERSTATUS"", ""PRINTNO"", ""PRINTLINE"", ""CANCELMANID"", ""CANCELMANNAME"", ""DTLZXCOLUMN5"", ""DTLZXCOLUMN4"", ""SRCPORDERDTLID"", ""SRCGOODSQTY"", ""FROM_SALESDTLID"", ""CURRENCY"", ""MAH"", ""PRODLICENSENO"") AS 
  select a.porderid,
       a.porderdtlid,
       a.ownergoodsid,
       a.goodsid,
       b.opcode goodsopcode,
       b.goodsname,
       b.goodstype,
       nvl(a.factname,b.factname) as factname,--取货主入库订单上的生产厂家
       b.prodarea,
       a.goodspackid,
       a.packname,
       a.packsize,
       a.goodsqty,
       a.tradegoodsqty,
       a.tradegoodspack,
       a.batchno,
       a.lotid,
       a.lotno,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.proddate,
       a.approvedocno,
       a.goodsstatusid,
       a.goodsclassid,
       a.quantitystatus,
       a.memo,
       a.arrivedate,
       a.checkdate,
       a.putupdate,
       a.canceldate,
       a.srcdtlno,
       a.lotflag,
       a.batchflag,
       a.custcancelstatus,
       a.wmscancelstatus,
       a.keepflag,
       a.gtradepack,
       a.originqty,
       a.price,
       a.retailprice,
       a.amt,
       a.qty,
       a.quadqty,
       a.unquadqty,
       a.testqty,
       a.sadtlid,
       a.expdtlmemo,
       a.firstflag,
       a.tpricetick,
       a.tpriceflag,
       a.goodsownid,
       a.prtclass,
       a.porderstatus,
       a.printno,
       a.printline,
       a.cancelmanid,
       dd.employeename cancelmanname,
       a.dtlzxcolumn5,--错误信息add by wanghuaiyu 2013年8月4日 17:20:40
       a.dtlzxcolumn4,--ERP细单ID add by wanghuaiyu 2013年8月7日 18:44:28
       a.srcporderdtlid,--add by weitangjing 20131010 原入库订单细单ID
       a.srcgoodsqty,--add by weitangjing 20131010 原货主入库订单数量
       a.from_salesdtlid,
       a.currency, --币种
       a.mah,--取订单上的上市许可持有人
       a.prodlicenseno --取订单上的生产许可证号
  from tpl_purchase_order_dtl a,
       tpl_goods              b,
       pub_employee           dd
     where a.ownergoodsid = b.ownergoodsid(+)
     and a.cancelmanid = dd.employeeid(+)
"
"TPL_PURCHASE_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_PURCHASE_ORDER_V"" (""PORDERID"", ""PORDERNO"", ""CREDATE"", ""ARRIVEDATE"", ""WAREHID"", ""GOODSOWNERID"", ""SOURCECOMPANYID"", ""MEDICINECLASS"", ""IMPORTFLAG"", ""TAXFLAG"", ""JOBTYPE"", ""OPERATIONTYPE"", ""DTLLINES"", ""MEMO"", ""INPUTMANID"", ""SRCNO"", ""TRANSID"", ""EXPORDERID"", ""BILLFROM"", ""CONFIRMMAN"", ""CONFIRMDATE"", ""USESTATUS"", ""MULRECFLAG"", ""RECCOUNT"", ""INMODE"", ""VALIDDAYS"", ""INVALIDATE"", ""ORDERFLAG"", ""GENFLAG"", ""SABACKDATE"", ""SBREASONID"", ""CUSTOMTYPE"", ""FINISHFLAG"", ""TPRICETICK"", ""TPRICEFLAG"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""DEPTNO"", ""DEPTNAME"", ""GCOMPANYID"", ""DECISIONFLAG"", ""BMSDOCID"", ""NOWLFLAG"", ""ALLOCATETIME"", ""INCEPTADDR"", ""WAREHOPCODE"", ""WAREHNAME"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""SRCCOMPANYNAME"", ""SRCCOMPANYOPCODE"", ""INPUTMANNAME"", ""CONFIRMMANNAME"", ""TRANSMODEID"", ""TRANSMODE"", ""TRANSNAME"", ""TRANSCLASS"", ""ECODEIMPFLAG"", ""CANCELDATE"", ""CANCELMANID"", ""CANCELMANNAME"", ""ZXCOLUMN5"", ""ZXCOLUMN4"", ""SRCPORDERID"", ""GCOMPANYNAME"", ""FROM_SALESID"", ""AUTOFLAG"", ""ERROR_MSG"", ""TRADEMODE"", ""TRANSTOOLNO"", ""TRANSTOOL"", ""ORDERNO"") AS 
  select a.porderid,
       a.porderno,
       a.credate,
       a.arrivedate,
       a.warehid,
       a.goodsownerid,
       a.sourcecompanyid,
       a.medicineclass,
       a.importflag,
       a.taxflag,
       a.jobtype,
       a.operationtype,
       a.dtllines,
       a.memo,
       a.inputmanid,
       a.srcno,
       a.transid,
       a.exporderid,
       a.billfrom,
       a.confirmman,
       a.confirmdate,
       a.usestatus,
       a.mulrecflag,--多次收货标志
       a.reccount,--第n次收货
       a.inmode,
       a.validdays,
       a.invalidate,
       a.orderflag,
       a.genflag,
       a.sabackdate,
       a.sbreasonid,
       a.customtype,
       a.finishflag,
       a.tpricetick,
       a.tpriceflag,
       a.tradegoodsqty,
       a.tradegoodspack,
       a.deptno,
       a.deptname,
       a.gcompanyid,
       a.decisionflag,
       a.bmsdocid,
       a.nowlflag,
       a.allocatetime,
       g.inceptaddr,
       b.warehopcode,
       b.warehname,
       c.goodsownername,
       c.goopcode,
       e.companyname srccompanyname,
       e.opcode srccompanyopcode,
       f.employeename inputmanname,
       h.employeename confirmmanname,
       a.transmodeid,
       d.transmode,
       d.transname,
       a.transclass,
       a.ecodeimpflag,
       a.canceldate,
       a.cancelmanid,
       dd.employeename cancelmanname,
       a.zxcolumn5,--错误信息add by wanghuaiyu 2013年8月4日 17:12:15
       a.zxcolumn4,--ERP总单ID add by wanghuaiyu 2013年8月7日 18:42:27
       a.srcporderid, --add by weitangjing 20131010 原货主入库订单ID
       a.gcompanyname,--add by weitangjing 20131102 货主原单位名称
       a.from_salesid,
       a.autoflag,
       a.error_msg,
       a.trademode,--贸易方式
       a.transtoolno,--运输工具编号
       a.transtool, --运输工具
       a.orderno --雨诺单据编号
  from tpl_purchase_order    a,
       tpl_warehouse         b,
       tpl_goodsowner        c,
       wms_transport_mode    d,
       tpl_go_company        e,
       pub_employee          f,
       wms_transport_address g,
       pub_employee          dd,
       pub_employee          h
 where a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid
   and a.sourcecompanyid = e.companyid(+)
   and a.inputmanid = f.employeeid(+)
   and a.confirmman = h.employeeid(+)
   and a.transid = g.transid(+)
   AND a.transmodeid = d.transmodeid(+)
   and a.cancelmanid = dd.employeeid(+)
"
"TPL_QTY_DAY_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_QTY_DAY_DTL_V"" (""DAYID"", ""DAYDTLID"", ""GOODSOWNERID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSPACKID"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSSTATUSID"", ""QUANTITYSTATUS"", ""GOQTY"", ""QTY"", ""REALQTY"", ""GODIFFQTY"", ""WMSDIFFQTY"", ""PROCFLAG"", ""WHNUMBER"", ""MEMO"", ""GOODSTYPE"", ""GOODSNAME"", ""OPCODE"", ""GOODSOWNERNAME"", ""PACKNAME"", ""TRADEPACKID"", ""TRADENAME"", ""PACKSIZE"", ""TRADEGOQTY"", ""TRADEQTY"", ""TRADEREALQTY"", ""TRADEGODIFFQTY"", ""TRADEWMSDIFFQTY"") AS 
  SELECT a.""DAYID"",
       a.""DAYDTLID"",
       a.""GOODSOWNERID"",
       a.""OWNERGOODSID"",
       a.""GOODSID"",
       a.""GOODSPACKID"",
       a.""BATCHNO"",
       a.""LOTID"",
       a.""LOTNO"",
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.""PRODDATE"",
       a.""GOODSSTATUSID"",
       a.""QUANTITYSTATUS"",
       a.""GOQTY"",
       a.""QTY"",
       a.""REALQTY"",
       a.""GODIFFQTY"",
       a.""WMSDIFFQTY"",
       a.""PROCFLAG"",
       a.""WHNUMBER"",
       a.""MEMO"",
       c.goodstype,
       c.goodsname,
       c.opcode,
       d.goodsownername,
       e.packname,
       g.tradepackid,
       h.packname tradename,
       h.packsize,
       a.goqty / h.packsize tradegoqty,
       a.qty / h.packsize tradeqty,
       a.REALQTY / h.packsize tradeREALQTY,
       a.GODIFFQTY / h.packsize tradeGODIFFQTY,
       a.WMSDIFFQTY / h.packsize tradeWMSDIFFQTY

  from TPL_QTY_DAY_DTL     a,
       tpl_pub_goods       c,
       tpl_GOODSOWNER      d,
       tpl_pub_goods_packs e,
       tpl_goods           g,
       tpl_pub_goods_packs h

 where a.goodsid = c.goodsid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.goodspackid = e.goodspackid(+)
   and a.ownergoodsid = g.ownergoodsid(+)
   and g.tradepackid = h.goodspackid(+)
"
"TPL_QTY_DAY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_QTY_DAY_V"" (""DAYID"", ""GOODSOWNERID"", ""CREDATE"", ""DTLLINES"", ""MEMO"", ""PROCFLAG"", ""INF_TFLAG"", ""INF_GOTFLAG"", ""GOODSOWNERNAME"") AS 
  SELECT a.""DAYID"",
       a.""GOODSOWNERID"",
       a.""CREDATE"",
       a.""DTLLINES"",
       a.""MEMO"",
       a.""PROCFLAG"",
       a.""INF_TFLAG"",
       a.""INF_GOTFLAG"",
       b.GOODSOWNERNAME
  from TPL_QTY_DAY a, tpl_goodsowner b
 where a.goodsownerid = b.goodsownerid(+)

 "
"TPL_RULING_LST_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_RULING_LST_DTL_V"" (""DTLID"", ""LSTID"", ""OWNERGOODSID"", ""OPCODE"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSNAME"", ""FACTNAME"", ""WAREGOODSID"", ""WAREGOODSOPCODE"", ""WAREGOODSNAME"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""GOODSQTY"", ""PRICE"", ""REASON"", ""EXPFLAG"", ""EXPDATE"", ""EXPFILENAME"", ""SOURCEID"") AS 
  select a.dtlid,
         a.lstid,
         a.ownergoodsid,
         b.opcode,
         b.goodstype,
         b.prodarea,
         b.goodsname,
         b.factname,
         b.waregoodsid,
         c.opcode waregoodsopcode,
         c.goodsname waregoodsname,
         a.lotno,
         a.killlotno,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
         a.proddate,
         a.approvedocno,
         a.registno,
         a.goodsqty,
         a.price,
         a.reason,
         a.expflag,
         a.expdate,
         a.expfilename,
         a.sourceid
    from tpl_ruling_lst_dtl a,tpl_goods b,tpl_pub_goods c
    where a.ownergoodsid = b.ownergoodsid
    and b.waregoodsid = c.goodsid
"
"TPL_RULING_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_RULING_LST_V"" (""LSTID"", ""CREDATE"", ""APPLYTYPE"", ""WAREHID"", ""WAREHNAME"", ""WAREHOPCODE"", ""WAREHSHORTNAME"", ""WAREHNO"", ""SOURCEID"", ""DESCRIP"", ""DEALING"", ""CONCLUSION"", ""EXPFLAG_000"", ""EXPDATE_000"", ""EXPFILENAME"", ""USESTATUS"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"") AS 
  select a.lstid,
         a.credate,
         a.applytype,
         a.warehid,
         b.warehname,
         b.warehopcode,
         b.warehshortname,
         b.warehno,
         a.sourceid,
         a.descrip,
         a.dealing,
         a.conclusion,
         a.expflag_000,
         a.expdate_000,
         a.expfilename,
         a.usestatus,
         a.goodsownerid,
         c.goodsownername,
         c.goopcode
    from tpl_ruling_lst a,tpl_warehouse b,tpl_goodsowner c
    WHERE a.warehid = b.warehid
    AND a.goodsownerid = c.goodsownerid(+)

 "
"TPL_SERVICE_CTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_SERVICE_CTL_V"" (""SERVICEID"", ""REMOTEIP"", ""USESTATUS"", ""EXCEPTIONCNT"", ""LXTIME"") AS 
  select a.serviceid,
         a.remoteip,
         a.usestatus,
         '0' exceptioncnt,
         a.lxtime
    from tpl_service_ctl a

 "
"TPL_SERVICE_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_SERVICE_LST_V"" (""SERVICEID"", ""REMOTEIP"", ""USESTATUS"", ""EXCEPTIONCNT"") AS 
  select a.serviceid,
         a.remoteip,
         a.usestatus,
         '' exceptioncnt
    from tpl_service_ctl a

 "
"TPL_ST_IO_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_ST_IO_DOC_V"" (""ORDERID"", ""ORDERDTLID"", ""INOUTFLAG"", ""COMEFROM"", ""INOUTID"", ""WAREHID"", ""OWNERGOODSID"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""QUANTITYSTATUS"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""GOODSQTY"", ""DIFFLAG"", ""DIFREASON"", ""RECEIVEDATE"", ""MEMO"", ""FINISHFLAG"", ""USESTATUS"", ""KEEPDATE"", ""KEEPMANID"", ""OTHERID"", ""GOODSOWNERID"") AS 
  select a.orderid,
       a.orderdtlid,
       a.inoutflag,
       a.comefrom,
       a.inoutid,
       a.warehid,
       a.ownergoodsid,
       a.goodsid,
       c.opcode,
       c.goodsname,
       c.goodstype,
       c.prodarea,
       a.goodspackid,
       d.packname,
       d.packsize,
       a.batchno,
       a.lotid,
       b.lotno,
       decode(to_char(b.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              b.validdate) validdate,
       b.proddate,
       b.approvedocno,
       a.goodsstatusid,
       a.quantitystatus,
       a.ingoodsqty,
       a.outgoodsqty,
       a.goodsqty,
       a.difflag,
       a.difreason,
       a.receivedate,
       a.memo,
       a.finishflag,
       a.usestatus,
       a.keepdate,
       a.keepmanid,
       a.otherid,
       a.goodsownerid
  from tpl_st_io_doc a, wms_goods_lot b, tpl_goods c, tpl_pub_goods_packs d
 where a.ownergoodsid = c.ownergoodsid(+)
   and a.lotid = b.lotid(+)
   and a.goodspackid = d.goodspackid(+)
"
"TPL_ST_QTY_DAY_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_ST_QTY_DAY_LST_V"" (""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTNAME"", ""GOODSQTY"", ""BUSIQTY"", ""OWNERGOODSID"", ""BATCHNO"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSOWNID"", ""GOODSNO"", ""STORAGECONDITION"", ""BUSISCOPE"", ""BUSISCOPENAME"", ""DRUGFORM"", ""GOODSTYPEID"", ""GOODSTYPENAME"", ""JS"") AS 
  select a.credate,
       a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.goodsid,
       f.opcode goodsopcode,
       f.goodsname,
       f.goodstype,
       f.prodarea,
       f.factid,
       d.companyname factname,
       a.goodsqty,
       a.busiqty,
       a.ownergoodsid,
       a.batchno,
       a.goodspackid,
       i.packname,
       i.packsize,
       a.lotid,
       l.lotno,
       decode(to_char(l.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              l.validdate) validdate,
       l.proddate,
       l.approvedocno,
       a.goodsstatusid,
       m.goodsstatus,
       m.quantitystatus,
       m.useflag,
       h.goodsownid,
       h.goodsno,
       h.storagecondition,
       n.busiscope, --xlq 于20141023 增加 用于物流计费
       n.busiscopename,
       f.drugform,
       f.goodstypeid, --zyc 20151106 计费货品分类ID
       o.goodstypename, --zyc 20151106 计费货品分类
        decode(nvl(i.packsize,0),0,0,ceil(a.goodsqty/i.packsize)) js --件数 向上取整 add by 20160705 zyc


  from tpl_st_qty_day_lst      a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_pub_company     d,
       tpl_pub_goods       f,
       tpl_goods           h,
       tpl_pub_goods_packs i,
       wms_goods_lot       l,
       wms_goodsstatus     m,
       lyerp.pub_goods_v   n,
       tprice_goods_type   o
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.goodsid = f.goodsid
   and h.goodsownid = to_char(n.goodsid(+)) --erp原ID
   and f.factid = d.companyid(+)
   and a.ownergoodsid = h.ownergoodsid(+)
   and a.goodspackid = i.goodspackid(+)
   and a.lotid = l.lotid(+)
   and a.goodsstatusid =m.goodsstatusid(+)
   and f.goodstypeid = o.goodstypeid(+) -- xyue by 20151010
"
"TPL_ST_QTY_GOODSCLASS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_ST_QTY_GOODSCLASS_V"" (""GOODSOWNERID"", ""GOODSCLASS"", ""GOODSCOUNT"", ""GOODSQTY"", ""BUSIQTY"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""DDLNAME"") AS 
  select c.""GOODSOWNERID"",c.""GOODSCLASS"",c.""GOODSCOUNT"",c.""GOODSQTY"",c.""BUSIQTY"",e.goodsownername,e.goopcode,h.ddlname from
 (select  a.goodsownerid,b.goodsclass, count(*) as goodscount,sum(a.goodsqty)as goodsqty,sum(a.busiqty)as busiqty  from tpl_st_qty_lst a,wms_goods_feature b
 where a.goodsid=b.goodsid(+)
 group by a.goodsownerid,b.goodsclass) c,
  tpl_goodsowner e,
   sys_ddl_all_v h
where c.goodsownerid=e.goodsownerid(+)
      and c.goodsclass=h.ddlid(+)
           and h.keyword='WMS_GOODS_CLASS'

 "
"TPL_ST_QTY_LST_GOODSCLASS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_ST_QTY_LST_GOODSCLASS_V"" (""GOODSOWNERID"", ""GOODSCLASS"", ""GOODSCOUNT"", ""GOODSQTY"", ""BUSIQTY"", ""GOODSOWNERNAME"", ""GOOPCODE"") AS 
  select c.""GOODSOWNERID"",c.""GOODSCLASS"",c.""GOODSCOUNT"",c.""GOODSQTY"",c.""BUSIQTY"",e.goodsownername,e.goopcode from
 (select  a.goodsownerid,b.goodsclass, count(*) as goodscount,sum(a.goodsqty)as goodsqty,sum(a.busiqty)as busiqty  from tpl_st_qty_lst a,wms_goods_feature b
 where a.goodsid=b.goodsid(+)
 group by a.goodsownerid,b.goodsclass) c,
  tpl_goodsowner e
where c.goodsownerid=e.goodsownerid(+)

 "
"TPL_ST_QTY_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_ST_QTY_LST_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""DRUGFORM"", ""FACTNAME"", ""GOODSQTY"", ""BUSIQTY"", ""OWNERGOODSID"", ""BATCHNO"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSOWNID"", ""GOODSNO"", ""OTCFLAG"") AS 
  select a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.goodsid,
       f.opcode goodsopcode,
       f.goodsname,
       f.goodstype,
       f.prodarea,
       f.factid,
			 f.drugform,
       d.companyname factname,
       a.goodsqty,
       a.busiqty,
       a.ownergoodsid,
       a.batchno,
       a.goodspackid,
       i.packname,
       i.packsize,
       a.lotid,
       l.lotno,
       decode(to_char(l.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              l.validdate) validdate,
       l.proddate,
       l.approvedocno,
       a.goodsstatusid,
       m.goodsstatus,
       m.quantitystatus,
       m.useflag,
       h.goodsownid,
       h.goodsno,
       h.otcflag
  from tpl_st_qty_lst      a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_pub_company     d,
       tpl_pub_goods       f,
       tpl_goods           h,
       tpl_pub_goods_packs i,
       wms_goods_lot       l,
       wms_goodsstatus     m
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.goodsid = f.goodsid
   and f.factid = d.companyid(+)
   and a.ownergoodsid = h.ownergoodsid(+)
   and a.goodspackid = i.goodspackid(+)
   and a.lotid = l.lotid(+)
   and a.goodsstatusid =m.goodsstatusid(+)
"
"TPL_ST_QTY_LST_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_ST_QTY_LST_V1"" (""WAREHID"", ""GOODSOWNERID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSPACKID"", ""LOTID"", ""GOODSSTATUSID"", ""PACKSIZE"") AS 
  select t.warehid,t.goodsownerid,t.ownergoodsid,t.goodsid,t.goodspackid,t.lotid,t.goodsstatusid,tt.packsize from (

select a.warehid,a.goodsownerid,a.ownergoodsid,a.goodsid,max(a.goodspackid) goodspackid,a.lotid,a.goodsstatusid
  from tpl_st_qty_lst a
  group by a.warehid,a.goodsownerid,a.ownergoodsid,a.goodsid,a.lotid,a.goodsstatusid) t,tpl_pub_goods_packs tt
  where t.goodspackid=tt.goodspackid
"
"TPL_ST_QTY_WAREH_SUM_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_ST_QTY_WAREH_SUM_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTNAME"", ""GOODSQTY"", ""BUSIQTY"", ""BATCHNO"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"") AS 
  select a.warehid,
       b.warehname,
       a.goodsid,
       f.opcode goodsopcode,
       f.goodsname,
       f.goodstype,
       f.prodarea,
       f.factid,
       d.companyname factname,
       sum(a.goodsqty) goodsqty,
       sum(a.busiqty) busiqty,
       a.batchno,
       a.goodspackid,
       i.packname,
       i.packsize,
       a.lotid,
       l.lotno,
       decode(to_char(l.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              l.validdate) validdate,
       l.proddate,
       l.approvedocno,
       a.goodsstatusid,
       m.goodsstatus,
       m.quantitystatus,
       m.useflag
  from tpl_st_qty_lst      a,
       tpl_warehouse       b,
       tpl_pub_company     d,
       tpl_pub_goods       f,
       tpl_pub_goods_packs i,
       wms_goods_lot       l,
       wms_goodsstatus     m
 where a.warehid = b.warehid
   and a.goodsid = f.goodsid
   and f.factid = d.companyid(+)
   and a.goodspackid = i.goodspackid(+)
   and a.lotid = l.lotid(+)
   and a.goodsstatusid =m.goodsstatusid(+)
group by a.warehid,
       b.warehname,
       a.goodsid,
       f.opcode ,
       f.goodsname,
       f.goodstype,
       f.prodarea,
       f.factid,
       d.companyname,
       a.batchno,
       a.goodspackid,
       i.packname,
       i.packsize,
       a.lotid,
       l.lotno,
       l.validdate,
       l.proddate,
       l.approvedocno,
       a.goodsstatusid,
       m.goodsstatus,
       m.quantitystatus,
       m.useflag
"
"TPL_ST_QTY_WAREH_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_ST_QTY_WAREH_V"" (""GOODSOWNERID"", ""WAREHID"", ""GOODSCOUNT"", ""GOODSQTY"", ""BUSIQTY"", ""WAREHNAME"", ""WAREHOPCODE"", ""GOODSOWNERNAME"", ""GOOPCODE"") AS 
  select c.""GOODSOWNERID"",c.""WAREHID"",c.""GOODSCOUNT"",c.""GOODSQTY"",c.""BUSIQTY"",e.warehname,e.warehopcode,h.goodsownername,h.goopcode  from
 (select  a.goodsownerid,b.warehid, count(*) as goodscount,sum(a.goodsqty)as goodsqty,sum(a.busiqty)as busiqty  from tpl_st_qty_lst a,tpl_warehouse b
 where a.warehid=b.warehid(+)
 group by  b.warehid,a.goodsownerid) c,
  tpl_warehouse e,
  tpl_goodsowner h

where c.warehid=e.warehid(+)
      and c.goodsownerid=h.goodsownerid(+)

 "
"TPL_SYS_LOG_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_SYS_LOG_V"" (""LOGID"", ""CREDATE"", ""COMEFROMID"", ""LOGTYPEID"", ""COMEFROM"", ""LOGSORT"", ""LOGTYPE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INOUTFLAG"", ""SOURCEID"", ""SOURCEDTLID"", ""MSGNO"", ""MSG"") AS 
  select a.logid,
         a.credate,
         a.comefrom comefromid,
         a.logtype logtypeid,
         decode(a.comefrom,1,'货主接口',2,'物流接口',3,'订单分配',4,'波次生成',5,'波次释放',6,'货主服务系统',7,'RF操作',8,'计费统计',9,'计费转财务','其他') comefrom,
         decode(a.logsort,1,'基础数据',2,'货主订单',3,'物流订单',4,'波次分配',5,'系统设置',6,'库存','其他') logsort,
         decode(a.logtype,1,'信息','异常') logtype,
         a.goodsownerid,
         b.goodsownername,
         decode(a.inoutflag,1,'入库',2,'出库','') inoutflag,
         a.sourceid,
         a.sourcedtlid,
         a.msgno,
         a.msg
    from tpl_sys_log a,
         tpl_goodsowner b
    WHERE a.goodsownerid = b.goodsownerid(+)

 "
"TPL_TRADE_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_TRADE_DTL_V"" (""TRADEID"", ""TRADEDTLID"", ""GOODSOWNERID"", ""WMSNO"", ""OWNERGOODSID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSID"", ""FROMQUANSTATUS"", ""FROMBATCHNO"", ""FROMLOTNO"", ""FROMVALIDDATE"", ""TOQUANSTATUS"", ""TOBATCHNO"", ""TOLOTNO"", ""TOVALIDDATE"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""GOODSPACKID"", ""QTY"", ""SRCPROCDTLID"", ""PROCFLAG"", ""CUSTCANCELSTATUS"", ""WMSCANCELSTATUS"", ""CONFIRMMAN"", ""CONFIRMDATE"", ""OTHERID"", ""FROMLOTID"", ""FROMGOODSSTATUSID"", ""FROMPRODDATE"", ""FROMAPPROVEDOCNO"", ""TOLOTID"", ""TOGOODSSTATUSID"", ""TOPRODDATE"", ""TOAPPROVEDOCNO"", ""PACKNAME"", ""PACKSIZE"", ""SECTIONID"", ""FROMREGISTNO"", ""TOREGISTNO"") AS 
  select a.Tradeid,
       a.Tradedtlid,
       a.Goodsownerid,
       a.Wmsno,
       a.Ownergoodsid,
       b.opcode goodsopcode,
       b.goodsname,
       b.goodstype,
       b.prodarea,
       a.Goodsid,
       a.Fromquanstatus,
       a.Frombatchno,
       a.Fromlotno,
       decode(to_char(a.fromvaliddate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.fromvaliddate) fromvaliddate,
       a.Toquanstatus,
       a.Tobatchno,
       a.Tolotno,
       decode(to_char(a.tovaliddate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.tovaliddate) tovaliddate,
       a.Tradegoodsqty,
       a.Tradegoodspack,
       a.Goodspackid,
       a.Qty,
       a.Srcprocdtlid,
       a.Procflag,
       a.Custcancelstatus,
       a.Wmscancelstatus,
       a.Confirmman,
       a.Confirmdate,
       a.Otherid,
       a.fromLotid,
       a.fromGoodsstatusid,
       a.fromProddate,
       a.fromApprovedocno,
       a.toLotid,
       a.toGoodsstatusid,
       a.toProddate,
       a.toApprovedocno,
       a.packname,
       a.packsize,
       a.sectionid,
       a.fromregistno,
       a.toregistno
  from tpl_trade_dtl a, tpl_goods b
 where a.Ownergoodsid = b.ownergoodsid
"
"TPL_TRADE_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_TRADE_ORDER_V"" (""TRADEID"", ""WAREHID"", ""WMSNO"", ""TRADEDATE"", ""OPERATIONTYPE"", ""GOODSOWNERID"", ""BILLFROM"", ""DTLLINES"", ""USESTATUS"", ""OTHERID"", ""MEMO"", ""WAREHNAME"", ""WAREHOPCODE"", ""WAREHNO"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""INPUTMANID"", ""INPUTMANNAME"") AS 
  SELECT a.TRADEID,
       a.WAREHID,
       a.wmsno,
       a.TRADEDATE,
       a.operationtype,
       a.GOODSOWNERID,
       a.billfrom,
       a.DTLLINES,
       a.usestatus,
       a.otherid,
       a.memo,
       b.warehname,
       b.warehopcode,
       b.warehno,
       c.goodsownername,
       c.goopcode,
       a.inputmanid,
       d.employeename inputmanname
  from tpl_trade_order a,
  tpl_warehouse b,
  tpl_goodsowner c,
  pub_employee d
 where a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.inputmanid = d.employeeid(+)

 "
"TPL_UNQUALIFIED_GOODS_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_UNQUALIFIED_GOODS_LST_V"" (""LSTID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""OWNERGOODSID"", ""OPCODE"", ""GOODSNO"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSFORMALNAME"", ""GOODSTYPE"", ""CREDATE"", ""PRODAREA"", ""BARCODE"", ""LOTID"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""PRODDATE"", ""WAREGOODSID"") AS 
  select a.lstid,
       a.goodsownerid,
       b.goodsownername,
       b.goopcode,
       a.ownergoodsid,
       c.opcode,
       c.goodsno,
       c.goodsname,
       c.goodsengname,
       c.goodsformalname,
       c.goodstype,
       c.credate,
       c.prodarea,
       c.barcode,

       a.lotid,
       d.lotno,
       d.killlotno,
       decode(to_char(d.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              d.validdate) validdate,
       d.proddate,
       c.waregoodsid

  from Tpl_unqualified_goods_lst a,
       tpl_goodsowner            b,
       tpl_goods                 c,
       wms_goods_lot             d

 where a.goodsownerid = b.goodsownerid(+)
   and a.ownergoodsid = c.ownergoodsid(+)
   and a.lotid = d.lotid(+)
"
"TPL_WAREHOUSE_HOV_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_WAREHOUSE_HOV_V"" (""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""WAREHNO"", ""WAREHSHORTNAME"", ""CHIEFOFFICER"", ""TELEPHONE"", ""POSTCODE"", ""WAREHADDRESS"", ""INVOICEHEAD"", ""INVOICEADDRESS"", ""CONNECTOR"", ""CONNPHONE"", ""MEMO"", ""TAXREGISTNO"", ""BANK"", ""BANKNO"", ""TRANSADDRESSID"", ""TRANSADDRESSNAME"", ""WARE4CODE"", ""WAREHFLAG"") AS 
  select warehid,
       warehopcode,
       warehname,
       warehno,
       warehshortname,
       chiefofficer,
       telephone,
       postcode,
       warehaddress,
       invoicehead,
       invoiceaddress,
       connector,
       connphone,
       memo,
       TAXREGISTNO,
       BANK,
       BANKNO,
       TRANSADDRESSID,
       TRANSADDRESSNAME,
       Ware4Code,
       Warehflag
  from tpl_warehouse_v
 where usestatus = 1
 order by warehid
"
"TPL_WAREHOUSE_SETUP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_WAREHOUSE_SETUP_V"" (""KEYID"", ""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""DEFAULTVEHTYPEID"", ""RATIO"", ""VEHICLETYPENO"", ""VEHICLETYPE"", ""VEHICLEMODEL"") AS 
  select a.keyid,
  a.warehid,
  c.warehopcode,
  c.warehname,
  a.defaultvehtypeid,
  a.ratio,
  b.vehicletypeno,
  b.vehicletype,
  b.vehiclemodel
    from Tpl_warehouse_setup a,
    TMS_VEHICLE_TYPE b,
    tpl_warehouse c
    where a.defaultvehtypeid=b.vehicletypeid(+)
    and a.warehid=c.warehid(+)

 "
"TPL_WAREHOUSE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_WAREHOUSE_V"" (""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""WAREHNO"", ""WAREHSHORTNAME"", ""CHIEFOFFICER"", ""TELEPHONE"", ""POSTCODE"", ""WAREHADDRESS"", ""INVOICEHEAD"", ""INVOICEADDRESS"", ""CONNECTOR"", ""CONNPHONE"", ""MEMO"", ""USESTATUS"", ""TAXREGISTNO"", ""BANK"", ""BANKNO"", ""TRANSADDRESSID"", ""TRANSADDRESSNAME"", ""COMPANYID"", ""COMPANYNAME"", ""COMPANYOPCODE"", ""WAREHTYPE"", ""PARENTID"", ""WARE4CODE"", ""WAREHFLAG"", ""WAREHAREA"", ""WMSTYPE"", ""USECONTAINERFLAG"", ""CANCHANGEPOS"", ""ISTRANS"", ""CHECKMANID2"", ""CHECKMAN"", ""CHECKMANOPCODE"", ""BTFLAG"", ""CONTEXT"") AS 
  select a.warehid,
       a.warehopcode,
       a.warehname,
       a.warehno,
       a.warehshortname,
       a.chiefofficer,
       a.telephone,
       a.postcode,
       a.warehaddress,
       a.invoicehead,
       a.invoiceaddress,
       a.connector,
       a.connphone,
       a.memo,
       a.usestatus,
       a.taxregistno,
       a.bank,
       a.bankno,
       a.transaddressid,
       b.inceptaddr transaddressname,
       a.companyid,
       c.companyname,
       c.companyopcode,
       a.warehtype,
       a.parentid,
       a.ware4code,
       d.warehflag,
       a.wareharea,
       a.wmstype,
       d.usecontainerflag,
       d.canchangepos,
       nvl(d.istrans,0) istrans,
       a.checkmanid2,--第二验收员ID add by wanghuaiyu 20130614
       e.employeename checkman, -- 第二验收员 add by wanghuaiyu 20130614
       e.opcode checkmanopcode,--第二验收员操作码 add by wanghuaiyu 20130614
       a.btflag, -- add by 20161230 收货验收必填项判断
       a.context
  from tpl_warehouse a, wms_transport_address b,tpl_pub_company c,tpl_warehouse_controlset d,pub_employee e
 where a.transaddressid = b.transid(+)
   and a.companyid = c.companyid(+)
   and a.warehid = d.warehid(+)
   and a.checkmanid2 = e.employeeid(+)
"
"TPL_WMS_CONN_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPL_WMS_CONN_LST_V"" (""WAREHID"", ""REMOTEIP"", ""LASTLOGONDATE"", ""LASTLOGOFFDATE"", ""USESTATUS"", ""REMOTEMAC"", ""LASTLXTIME"", ""WAREHNAME"", ""WAREHOPCODE"", ""WAREHADDRESS"", ""WAREHNO"", ""WAREHSHORTNAME"") AS 
  select   a.warehid,
         a.remoteip,
         a.lastlogondate,
         a.lastlogoffdate,
         decode(a.usestatus,0,'未连接',1,'已连接','') usestatus,
         a.remotemac,
         a.lastlxtime,
         b.warehname,
         b.warehopcode,
         b.warehaddress,
         b.warehno,
         b.warehshortname
    from tpl_wms_conn_lst a,Tpl_warehouse b
 WHERE a.warehid = b.warehid

 "
"TPRICE_ACC_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_ACC_DOC_V"" (""ACCDOCID"", ""CREDATE"", ""USEDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""TOTAL"", ""TOTALSTORE"", ""TOTALJOB"", ""TOTALTRANS"", ""USESTATUS"", ""USEMM"", ""MEMO"") AS 
  select   a.accdocid,
         a.credate,
         a.usedate,
         a.goodsownerid,
         b.goodsownername,
         b.goopcode,
         a.total,
         a.totalstore,
         a.totaljob,
         a.totaltrans,
         a.usestatus,
         a.usemm,
         a.memo
    from tprice_acc_doc a,
         tpl_goodsowner b
    WHERE a.goodsownerid = b.goodsownerid

 "
"TPRICE_ACC_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_ACC_DTL_V"" (""ACCDOCID"", ""ACCDTLID"", ""PRICEID"", ""PRICENAME"", ""MDTYPE"", ""PRICETYPE"", ""COMEFROM"", ""GOODSTYPEID"", ""GOODSTYPENAME"", ""STORETYPEID"", ""STORETYPENAME"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""JOBTYPEID"", ""JOBTYPENAME"", ""SPECIALTYPE"", ""INOUTFLAG"", ""TRANSTYPEID"", ""TRANSTYPENAME"", ""CARGOFLAG"", ""CARGORATE"", ""TOTALQTY"", ""COSTRATE"", ""TOTALCOST"", ""MEMO"") AS 
  select   a.accdocid,
         a.accdtlid,
         a.priceid,
         b.pricename,
         b.mdtype,
         b.pricetype,
         b.comefrom,
         a.goodstypeid,
         c.goodstypename,
         a.storetypeid,
         d.storetypename,
         d.goodsstatusid,
         g.goodsstatus,
         a.jobtypeid,
         f.jobtypename,
         f.specialtype,
         f.inoutflag,
         a.transtypeid,
         e.transtypename,
         e.cargoflag,
         e.cargorate,
         a.totalqty,
         a.costrate,
         a.totalcost,
         a.memo
    from tprice_acc_dtl a,
         Tprice_Price_Type b,
         Tprice_Goods_Type c,
         Tprice_Store_Type d,
         Tprice_Trans_Type e,
         Tprice_Job_Type f,
         wms_goodsstatus g
    WHERE a.priceid = b.priceid
     AND  a.goodstypeid = c.goodstypeid
     AND  a.storetypeid = d.storetypeid(+)
     AND  a.jobtypeid = f.jobtypeid(+)
     AND  a.transtypeid = e.transtypeid(+)
     AND  d.goodsstatusid = g.goodsstatusid(+)

 "
"TPRICE_ACC_ITEM_STATISTICS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_ACC_ITEM_STATISTICS_V"" (""USEMM"", ""PRICETYPE"", ""TYPEID"", ""TYPEUSEMMCOST"") AS 
  select a.usemm,a.pricetype,a.typeid,sum(a.totalcost) typeusemmcost from tprice_acc_statistics_v a
 group by a.usemm,a.pricetype,a.typeid

 "
"TPRICE_ACC_OWNERUSEMM_COST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_ACC_OWNERUSEMM_COST_V"" (""USEMM"", ""GOODSOWNERID"", ""USEMMTOTALCOST"") AS 
  select b.usemm,b.goodsownerid,sum(b.totalcost)as usemmtotalcost from  Tprice_Acc_Statistics b group by b.usemm,b.goodsownerid

 "
"TPRICE_ACC_OWNER_STSTISTICS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_ACC_OWNER_STSTISTICS_V"" (""USEMM"", ""GOODSOWNERID"", ""PRICETYPE"", ""TOTALCOST"", ""USEMMTOTALCOST"", ""RATE"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""USEYEAR"", ""USEMONTH"", ""DDLNAME"") AS 
  select table1.usemm,table1.goodsownerid,table1.pricetype,
table1.totalcost,table2.usemmtotalcost,(round((totalcost/usemmtotalcost),4)*100) as rate,
table3.goodsownername,
table3.goopcode,
table4.useyear,
table4.usemonth,
table5.ddlname
from
(select a.usemm,a.goodsownerid,a.pricetype,sum(a.totalcost)as totalcost from Tprice_Acc_Statistics_v a
 group by a.usemm,a.goodsownerid,a.pricetype) table1,
 tprice_acc_ownerusemm_cost_v  table2,
 tpl_goodsowner  table3,
 tprice_usemm  table4,
 sys_ddl_all_v table5
where table1.usemm=table2.usemm(+)
     and table1.goodsownerid=table2.goodsownerid(+)
     and table1.usemm=table4.usemm(+)
     and table1.goodsownerid=table3.goodsownerid(+)
       and table1.pricetype=table5.ddlid(+)
      and table5.keyword='TPRICE_PRICETYPE'
      order by table1.usemm,table1.goodsownerid

 "
"TPRICE_ACC_STATISTICS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_ACC_STATISTICS_V"" (""TYPEID"", ""PRICETYPE"", ""TYPENAME"", ""USEMM"", ""WAREHID"", ""GOODSOWNERID"", ""TOTALCOST"") AS 
  select t.typeid ,t.pricetype,a.jobtypename as typename,t.usemm,t.warehid,t.goodsownerid,t.totalcost from tprice_acc_statistics t,TPRICE_JOB_TYPE a
where t.typeid=a.jobtypeid(+) and t.pricetype=1
union
select t.typeid ,t.pricetype,a.TRANSTYPENAME as typename,t.usemm,t.warehid,t.goodsownerid,t.totalcost from tprice_acc_statistics t,TPRICE_TRANS_TYPE a
where t.typeid=a.TRANSTYPEID(+) and t.pricetype=2
union
select t.typeid ,t.pricetype,a.STORETYPENAME as typename,t.usemm,t.warehid,t.goodsownerid,t.totalcost from tprice_acc_statistics t,TPRICE_STORE_TYPE a
where t.typeid=a.STORETYPEID(+) and t.pricetype=0

 "
"TPRICE_ACC_TINY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_ACC_TINY_V"" (""ACCDOCID"", ""ACCDTLID"", ""ACCTINYID"", ""OPERATIONTYPE"", ""SOURCEID"", ""SOURCEDTLID"", ""OWNERGOODSID"", ""ORIGOODSQTY"", ""ORIGOODSMONEY"", ""GOODSQTY"", ""COSTPRICE"", ""COSTMONEY"", ""COMEFROM"") AS 
  select a.accdocid,
         a.accdtlid,
         a.acctinyid,
         a.operationtype,
         a.sourceid,
         a.sourcedtlid,
         a.ownergoodsid,
         a.origoodsqty,
         a.origoodsmoney,
         a.goodsqty,
         a.costprice,
         a.costmoney,
         a.comefrom
    from tprice_acc_tiny a

 "
"TPRICE_ACC_TOTAL_STATISTICS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_ACC_TOTAL_STATISTICS_V"" (""PRICETYPE"", ""TOTALCOST"", ""USEMM"", ""USEMMTOTALCOST"", ""RATE"", ""USEYEAR"", ""USEMONTH"", ""DDLNAME"") AS 
  select table1.pricetype,table1.totalcost,table1.usemm,
table2.usemmtotalcost,(round((totalcost/usemmtotalcost),4)*100) as rate,
table3.useyear,
table3.usemonth,
table4.ddlname
from
(select a.pricetype,sum(a.totalcost)as totalcost,a.usemm from Tprice_Acc_Statistics_v a
 group by a.usemm,a.pricetype) table1,
Tprice_acc_usemm_totalcost_v  table2,
tprice_usemm  table3,
 sys_ddl_all_v table4

where table1.usemm=table2.usemm(+)
      and table1.usemm=table3.usemm(+)
      and table1.pricetype=table4.ddlid(+)
      and table4.keyword='TPRICE_PRICETYPE'
      order by usemm,pricetype

 "
"TPRICE_ACC_TYPE_STATISTICS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_ACC_TYPE_STATISTICS_V"" (""USEMM"", ""PRICETYPE"", ""PRICETYPENAME"", ""TYPEID"", ""TYPENAME"", ""TOTALCOST"", ""PRINTSEQ"", ""RATE"", ""USEMMTOTALCOST"", ""USEYEAR"", ""USEMONTH"") AS 
  select uniontable.usemm,uniontable.pricetype,sys_ddl_all_v.ddlname as pricetypename ,uniontable.typeid,uniontable.typename,uniontable.totalcost,uniontable.printseq,uniontable.rate,uniontable.usemmtotalcost,tprice_usemm.useyear,tprice_usemm.usemonth
from (
       select table1.usemm,table1.pricetype,table1.typeid,tjt.jobtypename as typename,table1.totalcost,tjt.printseq,(round((totalcost/usemmtotalcost),4)*100) as rate,taut.usemmtotalcost
       from
       (select a.usemm,a.pricetype,a.typeid,sum(a.totalcost)as totalcost from Tprice_Acc_Statistics_v a
       group by a.usemm,a.pricetype,a.typeid)  table1,
        TPRICE_JOB_TYPE tjt,
        Tprice_acc_usemm_totalcost_v  taut
        where table1.typeid=tjt.jobtypeid(+) and table1.pricetype=1 and table1.usemm=taut.usemm(+)

       union
       select table1.usemm,table1.pricetype,table1.typeid,tst.storetypename as typename,table1.totalcost,tst.printseq,(round((totalcost/usemmtotalcost),4)*100) as rate,taut.usemmtotalcost
       from
       (select a.usemm,a.pricetype,a.typeid,sum(a.totalcost)as totalcost from Tprice_Acc_Statistics_v a
       group by a.usemm,a.pricetype,a.typeid)  table1,
       Tprice_Store_Type tst,
       Tprice_acc_usemm_totalcost_v  taut
       where table1.typeid=tst.storetypeid(+) and table1.pricetype=0 and table1.usemm=taut.usemm(+)

      union
      select table1.usemm,table1.pricetype,table1.typeid,ttt.transtypename as typename,table1.totalcost,ttt.printseq,(round((totalcost/usemmtotalcost),4)*100) as rate,taut.usemmtotalcost
      from
      (select a.usemm,a.pricetype,a.typeid,sum(a.totalcost)as totalcost from Tprice_Acc_Statistics_v a
      group by a.usemm,a.pricetype,a.typeid)  table1,
      Tprice_Trans_Type ttt,
      Tprice_acc_usemm_totalcost_v  taut
      where table1.typeid=ttt.transtypeid(+) and table1.pricetype=2 and table1.usemm=taut.usemm(+)
) uniontable,
 tprice_usemm,
 sys_ddl_all_v
 where uniontable.usemm=tprice_usemm.usemm(+)
 and uniontable.pricetype=sys_ddl_all_v.ddlid(+)
 and sys_ddl_all_v.keyword='TPRICE_PRICETYPE'
order by uniontable.usemm asc,uniontable.pricetype,uniontable.printseq

 "
"TPRICE_ACC_USEMM_TOTALCOST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_ACC_USEMM_TOTALCOST_V"" (""USEMM"", ""USEMMTOTALCOST"") AS 
  select b.usemm,sum(b.totalcost)as usemmtotalcost from  Tprice_Acc_Statistics b group by b.usemm

 "
"TPRICE_CORP_MODEL_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_CORP_MODEL_DOC_V"" (""MODELDOCID"", ""DESCRIPTION"", ""CORPTYPE"", ""CREDATE"", ""MEMO"") AS 
  select t.modeldocid,
         t.description,
         t.corptype,
         t.credate,
         t.memo
    from Tprice_corp_model_doc t

 "
"TPRICE_CORP_MODEL_JOB_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_CORP_MODEL_JOB_V"" (""MODELID"", ""MODELDOCID"", ""DESCRIPTION"", ""PRICEID"", ""PRICENAME"", ""MDTYPE"", ""PRICETYPE"", ""COMEFROM"", ""GOODSTYPEID"", ""GOODSTYPENAME"", ""JOBTYPEID"", ""JOBTYPENAME"", ""SPECIALTYPE"", ""OPERATIONTYPE"", ""UNITTYPE"", ""COSTRATE"", ""MEMO"") AS 
  select   a.modelid,
         a.modeldocid,
         a.description,
         a.priceid,
         b.pricename,
         b.mdtype,
         b.pricetype,
         b.comefrom,
         a.goodstypeid,
         c.goodstypename,
         a.jobtypeid,
         d.jobtypename,
         d.specialtype,
         a.operationtype,
         b.unittype,
         a.costrate,
         a.memo
    from Tprice_corp_model_job a,
         Tprice_price_type b,
         tprice_goods_type c,
         tprice_job_type d
    WHERE a.priceid = b.priceid
    AND   a.goodstypeid = c.goodstypeid
    AND   a.jobtypeid = d.jobtypeid

 "
"TPRICE_CORP_MODEL_STORE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_CORP_MODEL_STORE_V"" (""MODELDOCID"", ""MODELID"", ""DESCRIPTION"", ""PRICEID"", ""PRICENAME"", ""MDTYPE"", ""PRICETYPE"", ""COMEFROM"", ""GOODSTYPEID"", ""GOODSTYPENAME"", ""STORETYPEID"", ""STORETYPENAME"", ""GOODSSTATUS"", ""UNITTYPE"", ""COSTRATE"", ""PERIODTYPE"", ""MEMO"") AS 
  select   a.modeldocid,
         a.modelid,
         a.description,
         a.priceid,
         b.pricename,
         b.mdtype,
         b.pricetype,
         b.comefrom,
         a.goodstypeid,
         c.goodstypename,
         a.storetypeid,
         d.storetypename,
         d.goodsstatus,
         b.unittype,
         a.costrate,
         a.periodtype,
         a.memo
    from Tprice_corp_model_store a,
         Tprice_price_type b,
         tprice_goods_type c,
         tprice_store_type_v d
    WHERE a.priceid = b.priceid
    AND   a.goodstypeid = c.goodstypeid
    AND   a.storetypeid = d.storetypeid

 "
"TPRICE_CORP_MODEL_TRANS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_CORP_MODEL_TRANS_V"" (""MODELID"", ""MODELDOCID"", ""DESCRIPTION"", ""PRICEID"", ""PRICENAME"", ""MDTYPE"", ""PRICETYPE"", ""COMEFROM"", ""GOODSTYPEID"", ""GOODSTYPENAME"", ""TRANSTYPEID"", ""TRANSTYPENAME"", ""CARGOFLAG"", ""CARGORATE"", ""TRANSREGIONID"", ""REGIONNAME"", ""DISTANCE"", ""UNITTYPE"", ""COSTRATE"", ""MEMO"") AS 
  select   a.modelid,
         a.modeldocid,
         a.description,
         a.priceid,
         b.pricename,
         b.mdtype,
         b.pricetype,
         b.comefrom,
         a.goodstypeid,
         c.goodstypename,
         a.transtypeid,
         d.transtypename,
         d.cargoflag,
         d.cargorate,
         a.transregionid,
         g.regionname,
         g.distance,
         b.unittype,
         a.costrate,
         a.memo
    from Tprice_corp_model_trans a,
         Tprice_price_type b,
         tprice_goods_type c,
         tprice_trans_type d,
         tprice_trans_region g
    WHERE a.priceid = b.priceid
    AND   a.goodstypeid = c.goodstypeid
    AND   a.transtypeid = d.transtypeid
    AND   a.transregionid = g.regionid(+)

 "
"TPRICE_DAYCUT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_DAYCUT_V"" (""DAYCUTID"", ""CREDATE"", ""GOODSOWNERID"", ""USEDAY"", ""FLAG"", ""USEDAYID"", ""GOODSOWNERNAME"", ""GOOPCODE"") AS 
  select a.daycutid,
      a.credate,
      a.goodsownerid,
      a.useday,
      a.flag,
      a.usedayid,
      b.goodsownername,
      b.goopcode
    from tprice_daycut a,tpl_goodsowner b
    where a.goodsownerid=b.goodsownerid(+)

 "
"TPRICE_ESTIMATE_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_ESTIMATE_DOC_V"" (""ESTIMATEDOCID"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""GOMACODE"", ""TOTAL"", ""TOTALSTORE"", ""TOTALTRANS"", ""TOTALJOB"", ""DOCID"", ""MEMO"") AS 
  select a.estimatedocid,
         a.credate,
         a.goodsownerid,
         b.goodsownername,
         b.goopcode,
         b.gomacode,
         a.total,
         a.totalstore,
         a.totaltrans,
         a.totaljob,
         a.docid,
         a.memo
    from Tprice_estimate_doc a,
         Tpl_Goodsowner b
    WHERE a.goodsownerid = b.goodsownerid

 "
"TPRICE_ESTIMATE_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_ESTIMATE_DTL_V"" (""ESTIMATEDOCID"", ""ESTIMATEDTLID"", ""PRICEID"", ""PRICENAME"", ""MDTYPE"", ""PRICETYPE"", ""COMEFROM"", ""GOODSTYPEID"", ""GOODSTYPENAME"", ""GOODSSTATUS"", ""STORETYPEID"", ""STORETYPENAME"", ""JOBTYPEID"", ""JOBTYPENAME"", ""SPECIALTYPE"", ""TRANSTYPEID"", ""TRANSTYPENAME"", ""CARGOFLAG"", ""CARGORATE"", ""TOTALQTY"", ""COSTRATE"", ""TOTALCOST"", ""DTLID"", ""MEMO"") AS 
  select   a.estimatedocid,
         a.estimatedtlid,
         a.priceid,
         b.pricename,
         b.mdtype,
         b.pricetype,
         b.comefrom,
         a.goodstypeid,
         c.goodstypename,
         g.goodsstatus,
         a.storetypeid,
         d.storetypename,
         a.jobtypeid,
         f.jobtypename,
         f.specialtype,
         a.transtypeid,
         e.transtypename,
         e.cargoflag,
         e.cargorate,
         a.totalqty,
         a.costrate,
         a.totalcost,
         a.dtlid,
         a.memo
    from Tprice_estimate_dtl a,
         Tprice_Price_Type b,
         Tprice_Goods_Type c,
         Tprice_Store_Type d,
         Tprice_Trans_Type e,
         Tprice_Job_Type f,
         wms_goodsstatus g
   WHERE a.priceid = b.priceid
   AND   a.goodstypeid = c.goodstypeid
   AND   a.storetypeid = d.storetypeid(+)
   AND   d.goodsstatusid = g.goodsstatusid(+)
   AND   a.transtypeid = e.transtypeid(+)
   AND   a.jobtypeid = f.jobtypeid(+)

 "
"TPRICE_ESTIMATE_MODEL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_ESTIMATE_MODEL_V"" (""MODELID"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""CONNPHONE"", ""GOUSESTATUS"", ""CORTYPE"", ""CONNECTOR"", ""DISTRICTNAME"", ""COMPANYNAME"", ""PROVINCE"", ""INCNT"", ""INLINESCNT"", ""INAMT"", ""INQTY"", ""INPACKS"", ""INPALLETS"", ""OUTCNT"", ""OUTLINESCNT"", ""OUTAMT"", ""OUTQTY"", ""OUTPACKS"", ""OUTPALLETS"", ""DISTANCE"", ""WEIGHT"", ""STAMT"", ""STSTOCK"", ""STPACKS"", ""STPALLETS"", ""MEMO"") AS 
  select a.modelid,
         a.credate,
         a.goodsownerid,
         b.goodsownername,
         b.goopcode,
         b.connphone,
         b.usestatus gousestatus,
         b.cortype,
         b.connector,
         b.districtname,
         b.companyname,
         b.province,
         a.incnt,
         a.inlinescnt,
         a.inamt,
         a.inqty,
         a.inpacks,
         a.inpallets,
         a.outcnt,
         a.outlinescnt,
         a.outamt,
         a.outqty,
         a.outpacks,
         a.outpallets,
         a.distance,
         a.weight,
         a.stamt,
         a.ststock,
         a.stpacks,
         a.stpallets,
         a.memo
    from tprice_estimate_model a,tpl_goodsowner_v b
   where a.goodsownerid = b.goodsownerid

 "
"TPRICE_GOODS_TYPE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_GOODS_TYPE_V"" (""GOODSTYPEID"", ""GOODSTYPENAME"", ""MEMO"") AS 
  select a.GOODSTYPEID,
       a.GOODSTYPENAME,
       a.memo
    from tprice_goods_type a

 "
"TPRICE_GO_JOB_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_GO_JOB_DTL_V"" (""DTLID"", ""DOCID"", ""PRICEID"", ""PRICENAME"", ""MDTYPE"", ""PRICETYPE"", ""COMEFROM"", ""GOODSTYPEID"", ""GOODSTYPENAME"", ""JOBTYPEID"", ""JOBTYPENAME"", ""SPECIALTYPE"", ""OPERATIONTYPE"", ""UNITTYPE"", ""COSTRATE"", ""STOREPERCENT"", ""GOODSOWNERID"", ""USESTATUS"", ""MEMO"", ""INOUTFLAG"") AS 
  select   a.dtlid,
         a.docid,
         a.priceid,
         b.pricename,
         b.mdtype,
         b.pricetype,
         b.comefrom,
         a.goodstypeid,
         c.goodstypename,
         a.jobtypeid,
         d.jobtypename,
         d.specialtype,
         a.operationtype,
         b.unittype,
         a.costrate,
         a.storepercent,
         e.goodsownerid,
         e.usestatus,
         a.memo,
         d.inoutflag
    from Tprice_go_job_dtl a,
         Tprice_price_type b,
         tprice_goods_type c,
         tprice_job_type d,
         tprice_go_price_doc e
    WHERE a.priceid = b.priceid
    AND   a.goodstypeid = c.goodstypeid
    AND   a.jobtypeid = d.jobtypeid
    AND   a.docid = e.docid
"
"TPRICE_GO_PRICE_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_GO_PRICE_DOC_V"" (""DOCID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMAN"", ""STARTDATE"", ""ENDDATE"", ""APPROVEMANID"", ""APPROVEMAN"", ""USESTATUS"", ""MEMO"", ""APPROVEDATE"", ""WFUSESTATUS"", ""WFPROCESS"", ""WFMEMO"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""CONNPHONE"", ""GOUSESTATUS"", ""CORTYPE"", ""CONNECTOR"", ""DISTRICTNAME"", ""COMPANYNAME"", ""PROVINCE"") AS 
  select   a.docid,
         a.credate,
         a.inputmanid,
         b.employeename inputman,
         a.startdate,
         a.enddate,
         a.approvemanid,
         c.employeename approveman,
         a.usestatus,
         a.memo,
         a.approvedate,
         a.wfusestatus,
         a.wfprocess,
         a.wfmemo,
         a.goodsownerid,
         d.goodsownername,
         d.goopcode,
         d.connphone,
         d.usestatus gousestatus,
         d.cortype,
         d.connector,
         d.districtname,
         d.companyname,
         d.province
    from Tprice_go_price_doc a,pub_employee b,pub_employee c,tpl_goodsowner_v d
   where a.inputmanid = b.employeeid(+)
   AND   a.approvemanid = c.employeeid(+)
   AND   a.goodsownerid = d.goodsownerid

 "
"TPRICE_GO_STORE_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_GO_STORE_DTL_V"" (""DOCID"", ""DTLID"", ""PRICEID"", ""PRICENAME"", ""MDTYPE"", ""PRICETYPE"", ""COMEFROM"", ""GOODSTYPEID"", ""GOODSTYPENAME"", ""STORETYPEID"", ""STORETYPENAME"", ""GOODSSTATUS"", ""UNITTYPE"", ""COSTRATE"", ""PERIODTYPE"", ""STOREPERCENT"", ""GOODSOWNERID"", ""USESTATUS"", ""MEMO"") AS 
  select   a.docid,
         a.dtlid,
         a.priceid,
         b.pricename,
         b.mdtype,
         b.pricetype,
         b.comefrom,
         a.goodstypeid,
         c.goodstypename,
         a.storetypeid,
         d.storetypename,
         d.goodsstatus,
         b.unittype,
         a.costrate,
         a.periodtype,
         a.storepercent,
         e.goodsownerid,
         e.usestatus,
         a.memo
    from Tprice_go_store_dtl a,
         Tprice_price_type b,
         tprice_goods_type c,
         tprice_store_type_v d,
         tprice_go_price_doc e
    WHERE a.priceid = b.priceid
    AND   a.goodstypeid = c.goodstypeid
    AND   a.storetypeid = d.storetypeid
    AND   a.docid = e.docid

 "
"TPRICE_GO_TRANS_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_GO_TRANS_DTL_V"" (""DTLID"", ""DOCID"", ""PRICEID"", ""PRICENAME"", ""MDTYPE"", ""PRICETYPE"", ""COMEFROM"", ""GOODSTYPEID"", ""GOODSTYPENAME"", ""TRANSTYPEID"", ""TRANSTYPENAME"", ""CARGOFLAG"", ""CARGORATE"", ""TRANSREGIONID"", ""REGIONNAME"", ""DISTANCE"", ""UNITTYPE"", ""COSTRATE"", ""STOREPERCENT"", ""GOODSOWNERID"", ""USESTATUS"", ""MEMO"") AS 
  select   a.dtlid,
         a.docid,
         a.priceid,
         b.pricename,
         b.mdtype,
         b.pricetype,
         b.comefrom,
         a.goodstypeid,
         c.goodstypename,
         a.transtypeid,
         d.transtypename,
         d.cargoflag,
         d.cargorate,
         a.transregionid,
         g.regionname,
         g.distance,
         b.unittype,
         a.costrate,
         a.storepercent,
         e.goodsownerid,
         e.usestatus,
         a.memo
    from Tprice_go_trans_dtl a,
         Tprice_price_type b,
         tprice_goods_type c,
         tprice_trans_type d,
         tprice_trans_region g,
         tprice_go_price_doc e
    WHERE a.priceid = b.priceid
    AND   a.goodstypeid = c.goodstypeid
    AND   a.transtypeid = d.transtypeid
    AND   a.transregionid = g.regionid(+)
    AND   a.docid = e.docid

 "
"TPRICE_JOB_TYPE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_JOB_TYPE_V"" (""JOBTYPEID"", ""JOBTYPENAME"", ""SPECIALTYPE"", ""INOUTFLAG"", ""MEMO"", ""PRINTSEQ"") AS 
  SELECT t.jobtypeid,
       t.jobtypename,
       t.specialtype,
       t.inoutflag,
       t.memo,
       t.printseq
    from tprice_job_type t

 "
"TPRICE_MODEL_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_MODEL_DOC_V"" (""MODELDOCID"", ""DESCRIPTION"", ""ENTERPRISENAME"", ""WAREHID"", ""WAREHNAME"", ""WAREHOPCODE"", ""WAREHTYPE"", ""WAREHNO"", ""CREDATE"", ""MEMO"") AS 
  select t.modeldocid,
         t.description,
         t.enterprisename,
         t.warehid,
         a.warehname,
         a.warehopcode,
         a.warehtype,
         a.warehno,
         t.credate,
         t.memo

    from Tprice_model_doc t,
         tpl_warehouse a
   WHERE t.warehid = a.warehid

 "
"TPRICE_MODEL_JOB_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_MODEL_JOB_V"" (""MODELID"", ""DESCRIPTION"", ""PRICEID"", ""PRICENAME"", ""MDTYPE"", ""PRICETYPE"", ""COMEFROM"", ""GOODSTYPEID"", ""GOODSTYPENAME"", ""JOBTYPEID"", ""JOBTYPENAME"", ""SPECIALTYPE"", ""OPERATIONTYPE"", ""UNITTYPE"", ""COSTRATE"", ""MEMO"", ""MODELDOCID"") AS 
  select   a.modelid,
         a.description,
         a.priceid,
         b.pricename,
         b.mdtype,
         b.pricetype,
         b.comefrom,
         a.goodstypeid,
         c.goodstypename,
         a.jobtypeid,
         d.jobtypename,
         d.specialtype,
         a.operationtype,
         b.unittype,
         a.costrate,
         a.memo,
         a.modeldocid
    from Tprice_model_job a,
         Tprice_price_type b,
         tprice_goods_type c,
         tprice_job_type d
    WHERE a.priceid = b.priceid
    AND   a.goodstypeid = c.goodstypeid
    AND   a.jobtypeid = d.jobtypeid

 "
"TPRICE_MODEL_STORE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_MODEL_STORE_V"" (""MODELID"", ""DESCRIPTION"", ""PRICEID"", ""PRICENAME"", ""MDTYPE"", ""PRICETYPE"", ""COMEFROM"", ""GOODSTYPEID"", ""GOODSTYPENAME"", ""STORETYPEID"", ""STORETYPENAME"", ""GOODSSTATUS"", ""UNITTYPE"", ""COSTRATE"", ""PERIODTYPE"", ""MEMO"", ""MODELDOCID"") AS 
  select a.modelid,
         a.description,
         a.priceid,
         b.pricename,
         b.mdtype,
         b.pricetype,
         b.comefrom,
         a.goodstypeid,
         c.goodstypename,
         a.storetypeid,
         d.storetypename,
         d.goodsstatus,
         b.unittype,
         a.costrate,
         a.periodtype,
         a.memo,
         a.modeldocid
    from Tprice_model_store a,
         Tprice_price_type b,
         tprice_goods_type c,
         tprice_store_type_v d
    WHERE a.priceid = b.priceid
    AND   a.goodstypeid = c.goodstypeid
    AND   a.storetypeid = d.storetypeid

 "
"TPRICE_MODEL_TRANS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_MODEL_TRANS_V"" (""MODELID"", ""DESCRIPTION"", ""PRICEID"", ""PRICENAME"", ""MDTYPE"", ""PRICETYPE"", ""COMEFROM"", ""GOODSTYPEID"", ""GOODSTYPENAME"", ""TRANSTYPEID"", ""TRANSTYPENAME"", ""CARGOFLAG"", ""CARGORATE"", ""TRANSREGIONID"", ""REGIONNAME"", ""DISTANCE"", ""UNITTYPE"", ""COSTRATE"", ""MEMO"", ""MODELDOCID"") AS 
  select   a.modelid,
         a.description,
         a.priceid,
         b.pricename,
         b.mdtype,
         b.pricetype,
         b.comefrom,
         a.goodstypeid,
         c.goodstypename,
         a.transtypeid,
         d.transtypename,
         d.cargoflag,
         d.cargorate,
         a.transregionid,
         g.regionname,
         g.distance,
         b.unittype,
         a.costrate,
         a.memo,
         a.modeldocid
    from Tprice_model_trans a,
         Tprice_price_type b,
         tprice_goods_type c,
         tprice_trans_type d,
         tprice_trans_region g
    WHERE a.priceid = b.priceid
    AND   a.goodstypeid = c.goodstypeid
    AND   a.transtypeid = d.transtypeid
    AND   a.transregionid = g.regionid(+)

 "
"TPRICE_OWNER_ITEM_STSTISTICS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_OWNER_ITEM_STSTISTICS_V"" (""USEMM"", ""GOODSOWNERID"", ""PRICETYPE"", ""TYPEID"", ""TYPENAME"", ""TYPECOST"", ""USEMMTOTALCOST"", ""USERATE"", ""TYPERATE"", ""TYPEUSEMMCOST"", ""USEYEAR"", ""USEMONTH"", ""GOODSOWNERNAME"", ""GOOPCODE"") AS 
  select table1.usemm,table1.goodsownerid,table1.pricetype,table1.typeid,table1.typename,table1.typecost,
  table2.usemmtotalcost,
  (round((table1.typecost/ table2.usemmtotalcost),4)*100) as userate,
  (round((table1.typecost/ table3.typeusemmcost),4)*100) as typerate,
  table3.typeusemmcost,
  table4.useyear,table4.usemonth,table5.goodsownername,table5.goopcode
  from
   (select a.usemm,a.goodsownerid,a.pricetype,a.typeid,a.typename,sum(a.totalcost) as typecost
    from tprice_acc_statistics_v a
   group by a.usemm,a.goodsownerid,a.pricetype,a.typeid,a.typename) table1,
   tprice_acc_ownerusemm_cost_v table2,

   tprice_acc_item_statistics_v table3,
   tprice_usemm table4,
   tpl_goodsowner table5
   where table1.usemm=table2.usemm(+)
         and table1.goodsownerid=table2.goodsownerid(+)
         and table1.usemm=table3.usemm(+)
         and table1.pricetype=table3.pricetype(+)
         and table1.typeid=table3.typeid(+)
         and table1.usemm=table4.usemm(+)
         and table1.goodsownerid=table5.goodsownerid(+)
    order by   usemm asc,pricetype asc,typeid asc

 "
"TPRICE_OWNER_USEMM_STA_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_OWNER_USEMM_STA_DTL_V"" (""USEMM"", ""GOODSOWNERID"", ""PRICETYPE"", ""TYPEID"", ""TYPENAME"", ""ITEMTOTALCOST"", ""PRINTSOURCE"", ""USEMMTOTALCOST"", ""RATE"", ""USEYEAR"", ""USEMONTH"", ""GOODSOWNERNAME"", ""GOOPCODE"") AS 
  select table1.usemm,table1.goodsownerid,table1.pricetype,table1.typeid,table1.typename,table1.itemtotalcost,table1.printsource,
  table2.usemmtotalcost,(round((table1.itemtotalcost/ table2.usemmtotalcost),4)) as rate,
  table3.useyear,table3.usemonth,
  table4.goodsownername,table4.goopcode
   from
   (select a.usemm,a.goodsownerid,a.pricetype,a.typeid,a.typename,sum(a.totalcost) as itemtotalcost,a.usemm||':'||a.goodsownerid as printsource
   from Tprice_Acc_Statistics_v a
   group by a.usemm,a.goodsownerid,a.pricetype,a.typeid,a.typename) table1,
   Tprice_Acc_Ownerusemm_Cost_v table2,
   tprice_usemm table3,
   tpl_goodsowner table4
   where table1.usemm=table2.usemm(+)
   and table1.goodsownerid=table2.goodsownerid(+)
   and table1.usemm=table3.usemm(+)
   and table1.goodsownerid=table4.goodsownerid(+)

 "
"TPRICE_OWNER_USEMM_STA_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_OWNER_USEMM_STA_V"" (""USEMM"", ""GOODSOWNERID"", ""OWNERUSEMMCOST"", ""USEMMTOTALCOST"", ""USEYEAR"", ""USEMONTH"", ""RATE"", ""GOODSOWNERNAME"", ""GOOPCODE"") AS 
  select a.usemm,a.goodsownerid,a.usemmtotalcost ownerusemmcost,
b.usemmtotalcost,c.useyear,c.usemonth,(round((a.usemmtotalcost/b.usemmtotalcost),4)) as rate,
d.goodsownername,d.goopcode
  from tprice_acc_ownerusemm_cost_v a,
  Tprice_acc_usemm_totalcost_v b,
  tprice_usemm c,
  tpl_goodsowner d
  where a.usemm=b.usemm(+)
        and a.usemm=c.usemm(+)
        and a.goodsownerid=d.goodsownerid(+)

 "
"TPRICE_PRICE_TYPE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_PRICE_TYPE_V"" (""PRICEID"", ""PRICENAME"", ""MDTYPE"", ""PRICETYPE"", ""COMEFROM"", ""UNITTYPE"", ""MEMO"") AS 
  select t.priceid,
         t.pricename,
         t.mdtype,
         t.pricetype,
         t.comefrom,
         t.unittype,
         t.memo
    from tprice_price_type t

 "
"TPRICE_STORE_TYPE_HOV_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_STORE_TYPE_HOV_V"" (""STORETYPEID"", ""STORETYPENAME"", ""GOODSSTATUSID"", ""MEMO"", ""GOODSSTATUS"") AS 
  SELECT   t.storetypeid,
         t.storetypename,
         t.goodsstatusid,
         t.memo,
         c.goodsstatus
   FROM tprice_store_type t,
        wms_goodsstatus c
   WHERE t.goodsstatusid = c.goodsstatusid

 "
"TPRICE_STORE_TYPE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_STORE_TYPE_V"" (""STORETYPEID"", ""STORETYPENAME"", ""GOODSSTATUSID"", ""GOODSTYPEID"", ""GOODSTYPENAME"", ""MEMO"", ""GOODSSTATUS"", ""PRINTSEQ"") AS 
  SELECT   t.storetypeid,
         t.storetypename,
         t.goodsstatusid,
         t.goodstypeid,
         b.goodstypename,
         t.memo,
         a.goodsstatus,
         t.printseq
   FROM tprice_store_type t,
        wms_goodsstatus a,
        tprice_goods_type b
   WHERE t.goodsstatusid = a.goodsstatusid
   AND   t.goodstypeid = b.goodstypeid(+)

 "
"TPRICE_TRANS_REGION_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_TRANS_REGION_V"" (""REGIONID"", ""REGIONNAME"", ""DISTANCE"", ""WAREHID"", ""WAREHNAME"", ""WAREHOPCODE"", ""MEMO"") AS 
  select t.regionid,
         t.regionname,
         t.distance,
         t.warehid,
         a.warehname,
         a.warehopcode,
         t.memo
    from tprice_trans_region t,tpl_warehouse a
    WHERE t.warehid = a.warehid(+)

 "
"TPRICE_TRANS_TYPE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_TRANS_TYPE_V"" (""TRANSTYPEID"", ""TRANSTYPENAME"", ""CARGOFLAG"", ""CARGORATE"", ""MEMO"", ""PRINTSEQ"") AS 
  SELECT t.transtypeid,
       t.transtypename,
       t.cargoflag,
       t.cargorate,
       t.memo,
       t.printseq
 from Tprice_trans_type t

 "
"TPRICE_USEDAY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_USEDAY_V"" (""USEDAYID"", ""USEDAY"", ""DAYFLAG"", ""STFLAG"", ""DAYEND"", ""USEMM"", ""USESTATUS"") AS 
  SELECT t.usedayid,
       t.useday,
       t.dayflag,
       t.stflag,
       t.dayend,
       t.usemm,
       t.usestatus
    from tprice_useday t

 "
"TPRICE_USEMM_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_USEMM_DTL_V"" (""USEMM"", ""GOODSOWNERID"", ""ENDDATE"", ""CHECKFLAG"", ""GOODSOWNERNAME"", ""GOOPCODE"") AS 
  select a.USEMM,a.GOODSOWNERID,a.ENDDATE,a.CHECKFLAG,b.goodsownername, b.goopcode
    from tprice_usemm_dtl a,tpl_goodsowner b
     where a.goodsownerid = b.goodsownerid(+)

 "
"TPRICE_USEMM_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TPRICE_USEMM_V"" (""USEMM"", ""USEYEAR"", ""USEMONTH"", ""ENDDATE"", ""USESTATUS"") AS 
  select ""USEMM"",""USEYEAR"",""USEMONTH"",""ENDDATE"",""USESTATUS""
    from tprice_usemm

 "
"TRACE_CODE_ORDER_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TRACE_CODE_ORDER_DTL_V"" (""ORDERDATE"", ""OUTID"", ""OUTDTLID"", ""ERPORDERNO"", ""ERPORDERDTLNO"", ""YNORDERNO"", ""SALERNAME"", ""OWNERGOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""DRUGFORM"", ""FACTNAME"", ""MAH"", ""APPROVEDOCNO"", ""GOODSQTY"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""INOUTID"", ""SOURCEID"", ""RECORDID"", ""GATHERDATE"", ""INPUTMANID"", ""INPUTMAN"", ""ECODE"", ""UUID"") AS 
  select a.credate as orderdate,
       a.outid,
       a.outdtlid,
       a.erporderno,
       a.erporderdtlno,
       a.ynorderno,
       a.salername,
       a.ownergoodsid,
       a.goodsownid,
       a.goodsname,
       a.goodsengname,
       a.goodstype,
       a.tradepackname,
       a.drugform,
       a.factname,
       a.mah,
       a.approvedocno,
       a.goodsqty,
       a.lotno,
       a.proddate,
       a.validdate,
       b.inoutid,
       b.sourceid,
       b.recordid,
       b.credate       as gatherdate,
       b.inputmanid,
       c.employeename  as inputman,
       b.ecode,
       b.uuid
  from trace_code_order_dtl a, trace_code_order_record b, pub_employee c
 where a.uuid = b.uuid
   and a.wavegoodsdtlid = b.sourceid
   and b.inputmanid = c.employeeid(+)
"
"TRACE_CODE_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""TRACE_CODE_ORDER_V"" (""UUID"", ""CREDATE"", ""JOBDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""ORDERNO"", ""INOUTTYPE"", ""COMEFROM"", ""BILLCODE"", ""OPERATIONTYPE"", ""COMPANYID"", ""CORPID"", ""COMPANYNAME"", ""CORPNAME"", ""WAVEDTLID"", ""TRANSID"", ""SENDPOS"", ""INCEPTADDR"", ""EXECFLAG"", ""EXECDATE"", ""EXECMSG"", ""SIGNFLAG"", ""SIGNDATE"") AS 
  select t.uuid,
       t.credate,
       t.jobdate,
       t.warehid,
       t.warehname,
       t.goodsownerid,
       t.goodsownername,
       t.orderno,
       t.inouttype,
       t.comefrom,
       t.billcode,
       t.operationtype,
       t.companyid,
       t.corpid,
       t.companyname,
       t.corpname,
       t.wavedtlid,
       t.transid,
       t.sendpos,
       t.inceptaddr,
       t.execflag,
       t.execdate,
       t.execmsg,
       t.signflag,
       t.signdate
  from trace_code_order t
"
"T_DESTROYMESSAGE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""T_DESTROYMESSAGE_V"" (""GOODSOWNERID"", ""OUTID"", ""OUTDTLID"", ""SRCEXPNO"", ""SRCEXPDTLNO"", ""OPERATIONTYPE"", ""GOODSID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSQTY"", ""DESTROYREASON"", ""DESTROYMETHOD"", ""DESTROYADDRESS"", ""DESTROYMAN"", ""DESTROYJDMAN"", ""TRANSMAN"", ""TRANSTOOLS"", ""SITUATION"", ""CHECKMAN"", ""CHECKDATE"", ""DESTROYMEMO"", ""DESTROYDTLMEMO"", ""DESTROYDATE"") AS 
  select t.goodsownerid,
       t.outid,
       tt.outdtlid,
       t.srcexpno,
       tt.srcexpdtlno,
       t.operationtype,
       tt.goodsid,
       tt.lotno,
       tt.validdate,
       tt.proddate,
       tt.goodsqty,
       t.destroyreason,
       t.destroymethod,
       t.destroyaddress,
       t.destroyman,
       t.destroyjdman,
       t.transman,
       t.transtools,
       t.situation,
       t.checkman,
       t.checkdate,
       t.destroymemo,
       '' DESTROYDTLMEMO,
       t.destroydate
  from WMS_DESTROY_ORDER_V t, wms_destroy_order_dtl_v tt,tpl_edi_queue h
 where t.outid = tt.outid
 and t.goodsownerid=520
 and t.destroystatus=1
 and h.srcid = t.outid
 and nvl(h.expflag,0) = 0
 and h.queuetype = 49
"
"T_GSP_CONSERVE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""T_GSP_CONSERVE_V"" (""CONSERVEID"", ""GOODSOWNERID"", ""CREDATE"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSFORMALNAME"", ""GOODSQTYPE"", ""PRODAREA"", ""FACTNAME"", ""LOTNO"", ""APPROVEDOCNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSQTY"", ""GOODSUNIT"", ""MATTER"", ""QUANSTANDARD"", ""STORAGECONDITION"", ""PACKAGE"", ""CHECKMANID"", ""CHECKMAN"", ""EMFLAG"", ""MEMO"", ""MAH"") AS 
  select gsp_conserve.conserveid,
       gsp_conserve.goodsownerid,
       gsp_conserve.conservedate credate,--change by xyue 取养护日期 2019-02-11
       gsp_conserve.goodsid,
       g.goodsownid, --add by xyue 货主原货品ID 2015-12-10
       g.goodsname,
       g.goodsformalname,
       g.goodstype goodsqtype,
       g.prodarea,
       g.factname,
       wms_goods_lot.lotno,
       wms_goods_lot.approvedocno,
       wms_goods_lot.proddate,
        decode(to_char(wms_goods_lot.validdate, 'yyyy-mm-dd'),
        '2099-01-01',
        to_date(null, 'yyyy-mm-dd'),
        wms_goods_lot.validdate) validdate,
       gsp_conserve.goodsqty,
       gsp_conserve.goodsunit,
       gsp_conserve.matter, --发现问题
       decode(gsp_conserve.quanstandard,0,'不合格',1,'合格') quanstandard,--质量标准
       decode(gsp_conserve.storagecondition,0,'不合格',1,'合格') storagecondition, --储存要求
       decode(gsp_conserve.package,0,'不合格',1,'合格',2,'包装完好',3,'性状合格') package,--包装情况
       gsp_conserve.checkmanid,
       a.employeename checkman,
       emflag,
       a.memo,
       wms_goods_lot.mah
  from gsp_conserve,
       wms_goods_lot,
       pub_employee a,
       tpl_goods g,
       tpl_edi_queue h
 where gsp_conserve.lotid = wms_goods_lot.lotid(+)
   and gsp_conserve.checkmanid = a.employeeid(+)
   and gsp_conserve.goodsid = g.waregoodsid
   and gsp_conserve.goodsownerid=g.goodsownerid
   and gsp_conserve.conserveid=h.srcid
   and h.queuetype=47
   and nvl(h.expflag,0) = 0
"
"T_GSP_QUALITY_RECHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""T_GSP_QUALITY_RECHECK_V"" (""FEEDBACKID"", ""CREDATE"", ""GOODSOWNERID"", ""GCOMPANYID"", ""COMPANYNAME"", ""GOODSOWNID"", ""GOODSQTY"", ""CHECKQTY"", ""REALQTY"", ""LOTNO"", ""APPROVEDOCNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSSITUTION"", ""EMPLOYEENAME"", ""ZGYIDEA"", ""ZGJLIDEA"", ""WTFQUALITYDEPTIDEA"", ""WTFRELATEDEPTIDEA"", ""DEALRESULT"") AS 
  select a.feedbackid,
       a.credate,
       a.goodsownerid,
       c.gcompanyid,
       c.companyname,
       b.goodsownid,
       a.goodsqty,--应来货数量
       a.checkqty,--待复查数量
       a.goodsqty - a.checkqty as realqty, --实际来货数量
       a.lotno,
       a.approvedocno,
       a.proddate,
       a.validdate,
       a.goodssitution,
       e.employeename,
       a.zgyidea,
       a.zgjlidea,
       a.wtfqualitydeptidea,
       a.wtfrelatedeptidea,
       a.dealresult
  from zx_gsp_quality_feedback a,
       tpl_goods            b,
       tpl_go_company       c,
       tpl_goodsowner       d,
       pub_employee         e
 where a.ownergoodsid = b.ownergoodsid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.companyid=c.companyid(+)
   and a.inputmanid = e.employeeid(+)
"
"T_WMS_TO_ERP_FEEDBACK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""T_WMS_TO_ERP_FEEDBACK_V"" (""GOODSOWNERID"", ""TRADEID"", ""FEEDBACKID"", ""CREDATE"", ""INPUTMAN"", ""FEEDIDEA"", ""SHENHER"", ""SHENHRQ"", ""SHENHYJ"", ""GOODSOWNID"", ""GOODSQTY"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""BHGYY"", ""ZHILQK"", ""CHULYJ"") AS 
  select a.Goodsownerid,
       b.tradeid,
       a.feedbackid,
       a.credate,
       a.inputmanname inputman,
       a.GOODSSITUATION feedidea,
       '' shenher,
       '' shenhrq,
       '' shenhyj,
       a.goodsownid,
       a.GOODSQTY,
       a.LOTID,
       a.lotno,
       a.proddate,
       a.validdate,
       '' bhgyy,
       '' zhilqk,
       '' chulyj
  From gsp_quality_feedback_v           a,
       tpl_trade_order                  b,
       tpl_edi_queue h
 Where a.tradeid = b.wmsno
   and b.tradeid=h.srcid
   and nvl(h.expflag, 0) = 0
   and h.queuetype = 3
   and a.goodsownerid=h.goodsownerid
   and nvl(a.goodsqty, 0) <> 0
"
"V_SJMB_GOODSCUBAGE","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""V_SJMB_GOODSCUBAGE"" (""GOODSID"", ""PACKSIZE"", ""PACKNAME"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSCUBAGE"", ""GOODSOWNERID"") AS 
  Select a.goodsownid goodsid,
       b.packsize,
       b.packname,
       b.goodslength,
       b.goodswidth,
       b.goodsheight,
       b.goodscubage,
       a.goodsownerid
  from tpl_goods a, tpl_goods_packs b
 where a.ownergoodsid = b.ownergoodsid
   and a.goodsownerid in (select t.goodsownerid
                            from tpl_goodsowner t
                           where nvl(t.innerflag, 0) = 1)
"
"V_TMP","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""V_TMP"" (""GOODSOWNERID"", ""EXPORDERID"", ""LINENO"", ""CREDATE"", ""PREEXPDATE"", ""EXPCOMPANYID"", ""COMPANYSTYLE"", ""JOBTYPE"", ""ADDINVOICEFLAG"", ""COMPANYTYPE"", ""OPERATIONTYPE"", ""MEDICINECLASS"", ""RECEIVEADDR"", ""RECEIVEHEAD"", ""RECEIVEMAN"", ""SAMELOTFLAG"", ""TAXFLAG"", ""TRANSMODEID"", ""URGENFLAG"", ""DTLLINES"", ""MEMO"", ""EXPORDERDTLID"", ""GOODSID"", ""GSTORAGEID"", ""BATCHNO"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSTATUS"", ""QUANSTATUS"", ""APPROVEDOCNO"", ""TRADEPACK"", ""QTY"", ""ADDMEDCHECKFLAG"", ""DTLMEMO"", ""PARTEXPFLAG"", ""OUTMODE"", ""INVOICETYPE"", ""PLACESUPPLYID"", ""PLACESUPPLYDTLID"", ""PLACEPRICE"", ""RESALEPRICE"", ""PLACEMONEY"", ""OTCFLAG"", ""TRADEMARK"", ""QUALITYDOCNO"", ""GOODSCLASSNAME"", ""PACKSIZE"", ""ISBOXUP"", ""PLANARRIVE"", ""PIONARRIVE"", ""ADDRESSID"", ""SPELLBILLNO"", ""SPECIALTYPE"", ""DEPTNO"", ""DEPTNAME"", ""AMT"", ""WHID"", ""ORDERFLAG"", ""FIXFLAG"", ""SALERID"", ""SALERNAME"", ""TRDTLID"", ""SASETTLEDTLID"", ""PRTCLASS"", ""PRTORDERSET"", ""PRTGROUPSET"", ""INVNO"", ""PACKNAME"", ""SORTTYPE"", ""ZXCOLUMN1"", ""ZXCOLUMN2"", ""ZXCOLUMN3"", ""ZXCOLUMN4"", ""ZXCOLUMN5"", ""ZXCOLUMN6"", ""ZXCOLUMN7"", ""ZXCOLUMN8"", ""ZXCOLUMN9"", ""ZXCOLUMN10"", ""IMPFLAG"", ""STORAGEID"", ""GOODSATUS"", ""DTLZXCOLUMN1"", ""DTLZXCOLUMN2"", ""DTLZXCOLUMN3"", ""DTLZXCOLUMN4"", ""DTLZXCOLUMN5"", ""TRANSCLASS"", ""NOWLFLAG"", ""QUEUEID"", ""SASETTLEID"", ""SEQID"", ""WAREHNO"", ""LYZXCOLUMN1"", ""LYZXCOLUMN2"", ""LYZXCOLUMN3"", ""LYZXCOLUMN4"", ""LYZXCOLUMN5"", ""LYZXCOLUMN6"", ""LYZXCOLUMN7"", ""LYZXCOLUMN8"", ""LYZXCOLUMN9"", ""LYZXCOLUMN10"", ""LYDTLZXCOLUMN1"", ""LYDTLZXCOLUMN2"", ""LYDTLZXCOLUMN3"", ""LYDTLZXCOLUMN4"", ""LYDTLZXCOLUMN5"", ""LYDTLZXCOLUMN6"", ""LYDTLZXCOLUMN7"", ""LYDTLZXCOLUMN8"", ""LYDTLZXCOLUMN9"", ""LYDTLZXCOLUMN10"", ""LYZXCOLUMN11"", ""LYZXCOLUMN12"", ""LYZXCOLUMN13"", ""LYZXCOLUMN14"", ""LYZXCOLUMN15"", ""LYZXCOLUMN16"", ""LYZXCOLUMN17"", ""LYZXCOLUMN18"", ""LYZXCOLUMN19"", ""LYZXCOLUMN20"", ""LYDTLZXCOLUMN11"", ""LYDTLZXCOLUMN12"", ""LYDTLZXCOLUMN13"", ""LYDTLZXCOLUMN14"", ""LYDTLZXCOLUMN15"", ""LYDTLZXCOLUMN16"", ""LYDTLZXCOLUMN17"", ""LYDTLZXCOLUMN18"", ""LYDTLZXCOLUMN19"", ""LYDTLZXCOLUMN20"") AS 
  select t.""GOODSOWNERID"",t.""EXPORDERID"",t.""LINENO"",t.""CREDATE"",t.""PREEXPDATE"",t.""EXPCOMPANYID"",t.""COMPANYSTYLE"",t.""JOBTYPE"",t.""ADDINVOICEFLAG"",t.""COMPANYTYPE"",t.""OPERATIONTYPE"",t.""MEDICINECLASS"",t.""RECEIVEADDR"",t.""RECEIVEHEAD"",t.""RECEIVEMAN"",t.""SAMELOTFLAG"",t.""TAXFLAG"",t.""TRANSMODEID"",t.""URGENFLAG"",t.""DTLLINES"",t.""MEMO"",t.""EXPORDERDTLID"",t.""GOODSID"",t.""GSTORAGEID"",t.""BATCHNO"",t.""LOTNO"",t.""VALIDDATE"",t.""PRODDATE"",t.""GOODSTATUS"",t.""QUANSTATUS"",t.""APPROVEDOCNO"",t.""TRADEPACK"",t.""QTY"",t.""ADDMEDCHECKFLAG"",t.""DTLMEMO"",t.""PARTEXPFLAG"",t.""OUTMODE"",t.""INVOICETYPE"",t.""PLACESUPPLYID"",t.""PLACESUPPLYDTLID"",t.""PLACEPRICE"",t.""RESALEPRICE"",t.""PLACEMONEY"",t.""OTCFLAG"",t.""TRADEMARK"",t.""QUALITYDOCNO"",t.""GOODSCLASSNAME"",t.""PACKSIZE"",t.""ISBOXUP"",t.""PLANARRIVE"",t.""PIONARRIVE"",t.""ADDRESSID"",t.""SPELLBILLNO"",t.""SPECIALTYPE"",t.""DEPTNO"",t.""DEPTNAME"",t.""AMT"",t.""WHID"",t.""ORDERFLAG"",t.""FIXFLAG"",t.""SALERID"",t.""SALERNAME"",t.""TRDTLID"",t.""SASETTLEDTLID"",t.""PRTCLASS"",t.""PRTORDERSET"",t.""PRTGROUPSET"",t.""INVNO"",t.""PACKNAME"",t.""SORTTYPE"",t.""ZXCOLUMN1"",t.""ZXCOLUMN2"",t.""ZXCOLUMN3"",t.""ZXCOLUMN4"",t.""ZXCOLUMN5"",t.""ZXCOLUMN6"",t.""ZXCOLUMN7"",t.""ZXCOLUMN8"",t.""ZXCOLUMN9"",t.""ZXCOLUMN10"",t.""IMPFLAG"",t.""STORAGEID"",t.""GOODSATUS"",t.""DTLZXCOLUMN1"",t.""DTLZXCOLUMN2"",t.""DTLZXCOLUMN3"",t.""DTLZXCOLUMN4"",t.""DTLZXCOLUMN5"",t.""TRANSCLASS"",t.""NOWLFLAG"",t.""QUEUEID"",t.""SASETTLEID"",t.""SEQID"",t.""WAREHNO"",t.""LYZXCOLUMN1"",t.""LYZXCOLUMN2"",t.""LYZXCOLUMN3"",t.""LYZXCOLUMN4"",t.""LYZXCOLUMN5"",t.""LYZXCOLUMN6"",t.""LYZXCOLUMN7"",t.""LYZXCOLUMN8"",t.""LYZXCOLUMN9"",t.""LYZXCOLUMN10"",t.""LYDTLZXCOLUMN1"",t.""LYDTLZXCOLUMN2"",t.""LYDTLZXCOLUMN3"",t.""LYDTLZXCOLUMN4"",t.""LYDTLZXCOLUMN5"",t.""LYDTLZXCOLUMN6"",t.""LYDTLZXCOLUMN7"",t.""LYDTLZXCOLUMN8"",t.""LYDTLZXCOLUMN9"",t.""LYDTLZXCOLUMN10"",t.""LYZXCOLUMN11"",t.""LYZXCOLUMN12"",t.""LYZXCOLUMN13"",t.""LYZXCOLUMN14"",t.""LYZXCOLUMN15"",t.""LYZXCOLUMN16"",t.""LYZXCOLUMN17"",t.""LYZXCOLUMN18"",t.""LYZXCOLUMN19"",t.""LYZXCOLUMN20"",t.""LYDTLZXCOLUMN11"",t.""LYDTLZXCOLUMN12"",t.""LYDTLZXCOLUMN13"",t.""LYDTLZXCOLUMN14"",t.""LYDTLZXCOLUMN15"",t.""LYDTLZXCOLUMN16"",t.""LYDTLZXCOLUMN17"",t.""LYDTLZXCOLUMN18"",t.""LYDTLZXCOLUMN19"",t.""LYDTLZXCOLUMN20"" from t302 t where t.goodsownerid=6 --for update
"
"WCS_DEVICE_GOODS_INOUT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WCS_DEVICE_GOODS_INOUT_V"" (""INOUTID"", ""SOURCEID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSUNIT"", ""FACTNAME"", ""GOODSMEMO"", ""USESTATUS"", ""GOODSQTY"", ""MEMO"", ""INPUTMANID"", ""CREDATE"", ""INPUTMAN"", ""COMPANYNAME"") AS 
  select a.inid inoutid,
       1 sourceid,--单据来源：入库
       a.goodsid,
       b.goodsname,
       b.goodstype,
       b.goodsunit,
       b.factname,
       b.memo goodsmemo,
       nvl(a.usestatus,0) usestatus,
       a.goodsqty,
       a.memo,
       a.inputmanid,
       a.credate,
       c.employeename inputman,
       a.sourcecompany companyname
  from wcs_device_goods_in a, wcs_device_goods b, pub_employee c
 where a.goodsid = b.goodsid
   and b.inputmanid = c.employeeid(+)

union all

select a.outid inoutid,
       2 sourceid,--单据来源：出库
       a.goodsid,
       b.goodsname,
       b.goodstype,
       b.goodsunit,
       b.factname,
       b.memo goodsmemo,
       nvl(a.usestatus,0) usestatus,
       a.goodsqty,
       a.memo,
       a.inputmanid,
       a.credate,
       c.employeename inputman,
       a.reccompany companyname
  from wcs_device_goods_out a, wcs_device_goods b, pub_employee c
 where a.goodsid = b.goodsid
   and b.inputmanid = c.employeeid(+)
"
"WCS_DEVICE_GOODS_IN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WCS_DEVICE_GOODS_IN_V"" (""INID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSUNIT"", ""FACTNAME"", ""GOODSMEMO"", ""USESTATUS"", ""GOODSQTY"", ""MEMO"", ""INPUTMANID"", ""CREDATE"", ""INPUTMAN"", ""SOURCECOMPANY"") AS 
  select a.inid,
       a.goodsid,
       b.goodsname,
       b.goodstype,
       b.goodsunit,
       b.factname,
       b.memo goodsmemo,
       nvl(a.usestatus,0) usestatus,
       a.goodsqty,
       a.memo,
       a.inputmanid,
       a.credate,
       c.employeename inputman,
       a.sourcecompany
  from wcs_device_goods_in a, wcs_device_goods b, pub_employee c
 where a.goodsid = b.goodsid
   and b.inputmanid = c.employeeid(+)
"
"WCS_DEVICE_GOODS_OUT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WCS_DEVICE_GOODS_OUT_V"" (""OUTID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSUNIT"", ""FACTNAME"", ""GOODSMEMO"", ""USESTATUS"", ""GOODSQTY"", ""MEMO"", ""INPUTMANID"", ""CREDATE"", ""INPUTMAN"", ""RECCOMPANY"") AS 
  select a.outid,
       a.goodsid,
       b.goodsname,
       b.goodstype,
       b.goodsunit,
       b.factname,
       b.memo goodsmemo,
       nvl(a.usestatus,0) usestatus,
       a.goodsqty,
       a.memo,
       a.inputmanid,
       a.credate,
       c.employeename inputman,
       a.reccompany
  from wcs_device_goods_out a, wcs_device_goods b, pub_employee c
 where a.goodsid = b.goodsid
   and b.inputmanid = c.employeeid(+)
"
"WCS_DEVICE_GOODS_QTY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WCS_DEVICE_GOODS_QTY_V"" (""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSUNIT"", ""FACTNAME"", ""GOODSMEMO"", ""GOODSQTY"") AS 
  select a.goodsid,
       b.goodsname,
       b.goodstype,
       b.goodsunit,
       b.factname,
       b.memo goodsmemo,
       a.goodsqty
  from wcs_device_goods_qty a, wcs_device_goods b
 where a.goodsid = b.goodsid(+)
"
"WCS_DEVICE_GOODS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WCS_DEVICE_GOODS_V"" (""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSUNIT"", ""FACTNAME"", ""MEMO"", ""INPUTMANID"", ""CREDATE"", ""INPUTMAN"") AS 
  select a.goodsid,
       a.goodsname,
       a.goodstype,
       a.goodsunit,
       a.factname,
       a.memo,
       a.inputmanid,
       a.credate,
       b.employeename inputman
  from wcs_device_goods a, pub_employee b
 where a.inputmanid = b.employeeid(+)
"
"WMS2ZSPT_IN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS2ZSPT_IN_V"" (""BILLNO"", ""BILLDATE"", ""GOODSOWNERNAME"", ""CAMERANO"", ""BILLTYPE"", ""COMPANYID"", ""GOODSID"", ""GOODSQTY"", ""STORENAME"", ""STOREADDRESS"", ""SEQID"", ""LOTNO"", ""INVALIDDATE"", ""PRODDATE"", ""BILLDTLNO"", ""PRODAREA"", ""UPPERBILLTYPE"", ""UPPERNUM"") AS 
  select c.indtlid billno,--物流入库细单
       a.credate billdate,
       g.goodsownername,--货主名称
       b.cameraid camerano,
       '3'billtype,
       d.gcompanyid companyid,--供应商ID
       f.goodsownid goodsid,--货品ID
       c.goodsqty,--数量
       e.warehname storename,--仓库名称
       nvl(e.province||e.city||e.district||e.poiname,e.warehname) storeaddress,--仓库地址
       ''seqid,--中间表ID
       c.lotno,--批号
       c.validdate invaliddate,--有效期至
       c.proddate,--生产日期
       c.receiveid billdtlno,--物流入库收货细单ID
       f.factname prodarea,--产地
       '-1' upperbilltype,--上级业务类型
       '1' uppernum --上级单号
  from wms_in_order a,
       wms_in_order_dtl_v b,
       wms_receive_dtl c,
       tpl_go_company  d,
       tpl_warehouse   e,
       tpl_goods       f,
       tpl_goodsowner  g
 where a.inid = b.inid
   and b.indtlid=c.indtlid
   and b.porderstatus = 5
   and a.sourcecompanyid=d.companyid(+)
   and b.ownergoodsid=f.ownergoodsid(+)
   and a.goodsownerid=g.goodsownerid(+)
   and a.warehid=e.warehid
   and a.operationtype=1 --只取进货
   and a.warehid=1
"
"WMS2ZSPT_OUT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS2ZSPT_OUT_V"" (""BILLNOS"", ""SEQID"", ""BILLDATE"", ""CAMERANO"", ""BILLTYPE"", ""COMPANYID"", ""GOODSID"", ""GOODSQTY"", ""STORENAME"", ""STOREADDRESS"", ""LOTNO"", ""PRODDATE"", ""INVALIDDATE"", ""PRODAREA"", ""BILLDTLNO"", ""BILLNO"", ""UPPERBILLTYPE"", ""UPPERNUM"") AS 
  select b.outdtlid billnos,
       '' seqid,
       e.keepdate billdate,--任务完成时间，复核时间
       e.cameraid camerano, --摄像头编号
       '8' billtype, --业务类型
       f.gcompanyid companyid, --客户id
       g.goodsownid goodsid, --货品id
       nvl(e.realqty, 0) goodsqty, --数量
       h.warehname storename, --仓库名称（物流中心名称）
       nvl(h.province||h.city||h.district||h.poiname, h.warehname) storeaddress, --仓库地址（物流中心地址）
       i.lotno, --批号
       i.proddate, --生产日期
       i.validdate invaliddate, --有效期至
       g.factname prodarea, --产地
       a.trdtlid billdtlno, --业务明细单据ID
       a.wavedtlid billno,
       '3' upperbilltype, --上级业务类型
       zx_zspt_getreceiveid(b.goodsownerid, b.outdtlid,b.ownergoodsid,b.lotid) uppernum
  from wms_out_order      a,
       wms_out_order_dtl  b,
       wms_wave_dtl       c,
       wms_wave_goods_dtl d,
       wms_st_io_doc      e,
       tpl_go_company     f,
       tpl_goods          g,
       tpl_warehouse      h,
       wms_goods_lot      i
where a.outid=b.outid
and   c.wavedtlid=d.wavedtlid
and   a.wavedtlid=c.wavedtlid
and   d.wavegoodsdtlid=e.sourceid
and   b.ownergoodsid=d.ownergoodsid
and   b.lotid=d.lotid
and   a.warehid=1
and   a.usestatus=4 --已出货
and   a.reccompanyid=f.companyid(+)
and   b.ownergoodsid=g.ownergoodsid(+)
and   a.warehid=h.warehid(+)
and   b.lotid=i.lotid(+)
and   nvl(zx_zspt_getreceiveid(b.goodsownerid, b.outdtlid,b.ownergoodsid,b.lotid),0)<>0
   --change by xyue 2018-05-14;
and a.credate >to_date('2024-01-01 00:00:00','yyyy-mm-dd hh24:mi:ss')
"
"WMS_ABC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ABC_V"" (""INOUTID"", ""WAREHID"", ""GOODSID"", ""GOODSQTY"", ""WHOLEQTY"", ""AREAID"", ""SECTIONID"", ""AREAFLAG"", ""SCATTERPICKRATE"", ""WHOLEPICKRATE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""KEEPDATE"") AS 
  select a.inoutid, a.warehid, a.goodsid, a.goodsqty, a.wholeqty, a.areaid,
       a.sectionid, c.areaflag, d.scatterpickrate, d.wholepickrate,
       b.goodsname, b.goodstype, b.prodarea, a.keepdate
  from wms_st_io_doc a, tpl_pub_goods b, wms_st_area_def c,
       wms_goods_feature d, tpl_pub_goods_packs e
 where a.inoutflag = 1 and a.comefrom = 3 and a.areaid = c.areaid and
       a.warehid = d.warehid and a.goodsid = d.goodsid and
       a.goodsid = b.goodsid and a.goodspackid = e.goodspackid
"
"WMS_APPKEY_MANAGE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_APPKEY_MANAGE_V"" (""APPKEYMANAGEID"", ""APPKEY"", ""SECRET"", ""USESTATUS"", ""OWNERID"", ""WAREHOUSEID"", ""GOODSOWNERNAME"", ""WAREHNAME"", ""TELEPHONE"") AS 
  select a.appkeymanageid,
       a.appkey,
       a.secret,
       a.usestatus,
       a.ownerid,
       a.warehouseid,
       b.goodsownername,
       c.warehname,
       c.telephone
from wms_appkey_manage  a,
     tpl_goodsowner     b,
     tpl_warehouse      c
where a.ownerid=b.goodsownerid(+)
and   a.warehouseid = c.warehid(+)
and a.usestatus=1
"
"WMS_AUTO_TASK_CONFIG_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_AUTO_TASK_CONFIG_V"" (""AUTOTASKID"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""TOGOODSOWNERID"", ""TOGOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""SOURCECOMPANYID"", ""SOURCECOMPANYNAME"", ""OPERATIONTYPE"", ""TOOPERATIONTYPE"", ""PROCESSMODE"", ""INOUTFLAG"") AS 
  select a.autotaskid,
       a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.togoodsownerid,
       d.goodsownername togoodsownername,
       a.companyid,
       e.companyname,
       a.sourcecompanyid,
       f.companyname sourcecompanyname,
       a.operationtype,
       a.tooperationtype,
       a.processmode,
       a.inoutflag
  from wms_auto_task_config a,
       tpl_warehouse        b,
       tpl_goodsowner       c,
       tpl_goodsowner       d,
       tpl_go_company       e,
       tpl_go_company       f
 where a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.togoodsownerid = d.goodsownerid(+)
   and a.companyid=e.companyid(+)
   and a.sourcecompanyid=f.companyid(+)
"
"WMS_BARCODE2V_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_BARCODE2V_DOC_V"" (""SEQID"", ""COMEFROM"", ""SRCID"", ""PRINTFLAG"", ""CUSTOMERID"", ""OPCODE"", ""COMPANYNAME"", ""PRINTMANID"", ""PRINTDATE"", ""PRINTMANNAME"") AS 
  select a.seqid,
       a.comefrom,
       a.srcid,
       decode(a.printflag,null,null,1) printflag,
       a.customerid,
       b.opcode,
       b.companyname,
       a.printmanid,
       a.printdate,
       c.employeename printmanname
  from wms_barcode2v_doc a,
       tpl_go_company b,
       pub_employee   c
       where a.customerid = b.companyid(+)
         and a.printmanid = c.employeeid(+)
"
"WMS_BOX_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_BOX_DOC_V"" (""DOCID"", ""CREDATE"", ""BOXCODE"", ""BOXMANID"", ""MEMO"", ""BOXMANOPCODE"", ""BOXMAN"", ""OUTTERID"", ""CONTAINERID"", ""CONTAINERNO"", ""OUTBINDTIME"", ""OUTRETFLAG"", ""OUTRETTIME"", ""CUSTOMID"", ""WARECID"", ""CUSTOMNAME"", ""GCOMPANYID"", ""GCOMPANYNO"", ""USETYPE"", ""WAREHID"", ""OPERATIONTYPE"", ""WAVEDTLID"", ""WAREHNAME"", ""PRINTFLAG"", ""PRINTMANID"", ""PRINTDATE"", ""SHIPPOSID"", ""SHIPPOSFLAG"", ""POSNO"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.docid,
       a.credate,
       a.boxcode,
       a.boxmanid,
       a.memo,
       b.opcode boxmanopcode,
       b.employeename boxman,
       a.outterid,
       c.containerid,
       c.containerno,
       a.outbindtime,
       a.outretflag,
       a.outrettime,
       a.customid,
       d.warecid, --xyue 2014-06-02 增加单位主档ID
       d.companyname customname,
       d.gcompanyid,
       d.gcompanyno,
       A.USETYPE,
       a.WAREHID,
       a.operationtype,
       a.wavedtlid,
       e.warehname,
       decode(a.print2flag,null,null,1) printflag,
       a.print2manid printmanid,
       a.print2date printdate,
       a.shipposid,
       a.shipposflag,
       f.posno,
       d.goodsownerid,
       g.goodsownername  --加上货主ID @20180111 by tl
  from Wms_box_doc       a,
       pub_employee      b,
       wms_container_def c,
       tpl_go_company    d,
       tpl_warehouse     e,
       wms_ship_zone_pos f,
       tpl_goodsowner g
 where a.boxmanid = b.employeeid(+)
   and a.outterid = c.containerid(+)
   and a.customid = d.companyid(+)
   and a.warehid = e.warehid(+)
   and a.shipposid = f.shipposid(+)
   and d.goodsownerid = g.goodsownerid(+)
"
"WMS_BOX_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_BOX_DTL_V"" (""DOCID"", ""DTLID"", ""GOODSID"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""INOUTID"", ""GOODSQTY"", ""GOODSUNIT"", ""GOODSPACK"", ""PACKSIZE"", ""MEMO"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""CHECKMANID"", ""SALERID"", ""SALERNAME"", ""CHECKMANNAME"", ""SOURCEID"") AS 
  select a.docid,
       a.dtlid,
       a.goodsid,
       a.lotid,
       a.lotno,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.proddate,
       a.goodsstatusid,
       c.goodsstatus,
       a.quantitystatus,
       e.inoutid,
       e.goodsqty,
       a.goodsunit,
       a.goodspack,
       a.packsize,
       a.memo,
       b.opcode goodsopcode,
       b.goodsname,
       b.goodstype,
       b.prodarea,
       d.checkmanid,
       --aa.salerid,
       null salerid,
       --aa.salername,
       null salername,
       cc.employeename checkmanname,
       d.sourceid


  from wms_box_dtl            a,
       tpl_pub_goods          b,
       wms_goodsstatus        c,
       wms_turnbox_to_box_rel e,
       wms_st_io_doc          d,
       --wms_out_order          aa,
       --wms_out_order_dtl      bb,
       pub_employee           cc
 where a.goodsid = b.goodsid(+)
   and a.dtlid = e.boxdtlid(+)
   and a.goodsstatusid = c.goodsstatusid(+)
   and e.inoutid = d.inoutid(+)
   --and d.sourceid = bb.wavegoodsdtlid(+)
   --and bb.outid = aa.outid(+)
   and d.checkmanid = cc.employeeid(+)
"
"WMS_CHANNEL_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_CHANNEL_DEF_V"" (""WAREHID"", ""CHANNELID"", ""CHANNELNAME"", ""STARTPOINTID"", ""STARTPOINTNO"", ""STARTPOINTNAME"", ""ENDPOINTID"", ""ENDPOINTNO"", ""ENDPOINTNAME"", ""MEMO"", ""WAREHNAME"") AS 
  select a.warehid,
       a.channelid,
       a.channelname,
       a.startpointid,
       c.sectionno startpointno,
       c.sectionname startpointname,
       a.endpointid,
       d.sectionno endpointno,
       d.sectionname endpointname,
       a.memo,
       b.warehname
  from wms_channel_def    a,
       wms_st_section_def c,
       wms_st_section_def d,
       tpl_warehouse      b
 where a.warehid = b.warehid(+)
   and a.startpointid = c.sectionid(+)
   and a.endpointid = d.sectionid(+)

 "
"WMS_CHANNEL_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_CHANNEL_DTL_V"" (""CHANNELID"", ""CHANNELDTLID"", ""SEQUENCE"", ""POSID"", ""POSNO"", ""POSTYPE"", ""POSFLAG"", ""AREAID"", ""SECTIONID"") AS 
  select a.CHANNELID,
       a.CHANNELDTLID,
       a.SEQUENCE,
       a.POSID,
       b.posno,
       b.postype,
       b.posflag,
       b.areaid,
       b.sectionid
  from Wms_channel_dtl a,
  wms_pos_def          b
  where a.posid = b.posid

 "
"WMS_CODE_INCHECKORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_CODE_INCHECKORDER_V"" (""CREDATE"", ""JOBDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""ORDERID"", ""INOUTTYPE"", ""COMEFROM"", ""BILLCODE"", ""OPERATIONTYPE"", ""COMPANYID"", ""CORPID"", ""COMPANYNAME"", ""OWNERGOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""DRUGFORM"", ""FACTNAME"", ""MAH"", ""APPROVEDOCNO"", ""GOODSQTY"", ""LOTNO"", ""ERPORDERNO"", ""ERPORDERDTLNO"", ""WAVEDTLID"") AS 
  select a.credate, --订单日期
       b.shdate as jobdate, --作业日期
       a.warehid, --物流中心ID
       c.warehname, --物流中心
       a.goodsownerid, --货主ID
       d.goodsownername, --货主名称
       g.receiveid as orderid, --系统单据主键
       1 as inouttype, --出入库类型
       2 as comefrom,--业务来源
       a.operationtype as billcode, --单据类型
       (select x.ddlname
          from sys_ddl_dtl x
         where x.sysid = 389
           and x.ddlid = a.operationtype) as operationtype, --业务类型
       a.sourcecompanyid as companyid, --往来单位ID
       nvl(f.corpid, f.gcompanyid) as corpid, --企业自定义编码
       f.companyname, --往来单位
       b.ownergoodsid, --货主货品ID
       e.goodsownid, --货品编码
       e.goodsname, --货品通用名
       e.goodsengname, --商品名
       e.goodstype, --规格
       e.tradepackname, --单位
       e.drugform, --剂型
       nvl(h.factname, e.factname) as factname, --生产厂家
       nvl(h.mah, e.mah) as mah, --上市许可持有人
       nvl(h.approvedocno, e.approvedocno) as approvedocno, --批准文号
       g.goodsqty as goodsqty, --数量
       h.lotno, --批号
       a.zxcolumn4 as erporderno,
       b.dtlzxcolumn4 as erporderdtlno,
       null as wavedtlid
  from wms_in_order     a,
       wms_in_order_dtl b,
       tpl_warehouse    c,
       tpl_goodsowner   d,
       tpl_goods        e,
       tpl_go_company   f,
       wms_receive_dtl  g,
       wms_goods_lot    h
 where a.inid = b.inid
   and a.warehid = c.warehid
   and a.goodsownerid = d.goodsownerid
   and b.ownergoodsid = e.ownergoodsid
   and a.sourcecompanyid = f.companyid
   and b.clflag = 1
   and b.indtlid = g.indtlid
   and g.lotid = h.lotid(+)
   and g.usestatus in (3,4)
"
"WMS_CODE_INORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_CODE_INORDER_V"" (""CREDATE"", ""JOBDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""ORDERID"", ""INOUTTYPE"", ""COMEFROM"", ""BILLCODE"", ""OPERATIONTYPE"", ""COMPANYID"", ""CORPID"", ""COMPANYNAME"", ""OWNERGOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""DRUGFORM"", ""FACTNAME"", ""MAH"", ""APPROVEDOCNO"", ""GOODSQTY"", ""LOTNO"", ""ERPORDERNO"", ""ERPORDERDTLNO"", ""WAVEDTLID"") AS 
  select a.credate, --订单日期
       b.shdate as jobdate, --作业日期
       a.warehid, --物流中心ID
       c.warehname, --物流中心
       a.goodsownerid, --货主ID
       d.goodsownername, --货主名称
       b.indtlid as orderid,--系统单据主键
       1 as inouttype, --出入库类型
       1 as comefrom,--业务来源
       a.operationtype as billcode, --单据类型
       (select x.ddlname
          from sys_ddl_dtl x
         where x.sysid = 389
           and x.ddlid = a.operationtype) as operationtype, --业务类型
       a.sourcecompanyid as companyid, --往来单位ID
       nvl(f.corpid, f.gcompanyid) as corpid, --企业自定义编码
       f.companyname, --往来单位
       b.ownergoodsid, --货主货品ID
       e.goodsownid, --货品编码
       e.goodsname, --货品通用名
       e.goodsengname, --商品名
       e.goodstype, --规格
       e.tradepackname, --单位
       e.drugform, --剂型
       nvl(b.factname, e.factname) as factname, --生产厂家
       nvl(b.mah, e.mah) as mah, --上市许可持有人
       nvl(b.approvedocno, e.approvedocno) as approvedocno, --批准文号
       b.qty as goodsqty, --数量
       b.lotno, --批号
       a.zxcolumn4 as erporderno,
       b.dtlzxcolumn4 as erporderdtlno,
       null as wavedtlid
  from wms_in_order     a,
       wms_in_order_dtl b,
       tpl_warehouse    c,
       tpl_goodsowner   d,
       tpl_goods        e,
       tpl_go_company   f
 where a.inid = b.inid
   and a.warehid = c.warehid
   and a.goodsownerid = d.goodsownerid
   and b.ownergoodsid = e.ownergoodsid
   and a.sourcecompanyid = f.companyid
   and b.clflag = 1
"
"WMS_CODE_OUTCHECKORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_CODE_OUTCHECKORDER_V"" (""CREDATE"", ""JOBDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""ORDERID"", ""INOUTTYPE"", ""COMEFROM"", ""BILLCODE"", ""OPERATIONTYPE"", ""COMPANYID"", ""CORPID"", ""COMPANYNAME"", ""OWNERGOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""DRUGFORM"", ""FACTNAME"", ""MAH"", ""APPROVEDOCNO"", ""GOODSQTY"", ""LOTNO"", ""ERPORDERNO"", ""ERPORDERDTLNO"", ""WAVEDTLID"") AS 
  select a.credate, --订单日期
       a.rffindate as jobdate, --作业日期
       a.warehid, --物流中心ID
       c.warehname, --物流中心
       a.goodsownerid, --货主ID
       d.goodsownername, --货主名称
       a.inoutid as orderid, --系统单据主键
       2 as inouttype, --出入库类型
       3 as comefrom, --业务来源
       a.operationtype as billcode, --单据类型
       (select x.ddlname
          from sys_ddl_dtl x
         where x.sysid = 389
           and x.ddlid = a.operationtype) as operationtype, --业务类型
       a.companyid as companyid, --往来单位ID
       nvl(f.corpid, f.gcompanyid) as corpid, --企业自定义编码
       f.companyname, --往来单位
       a.ownergoodsid, --货主货品ID
       e.goodsownid, --货品编码
       e.goodsname, --货品通用名
       e.goodsengname, --商品名
       e.goodstype, --规格
       e.tradepackname, --单位
       e.drugform, --剂型
       nvl(h.factname, e.factname) as factname, --生产厂家
       nvl(h.mah, e.mah) as mah, --上市许可持有人
       nvl(h.approvedocno, e.approvedocno) as approvedocno, --批准文号
       a.goodsqty as goodsqty, --数量
       h.lotno, --批号
       zx_get_orderid(a.inoutid) as erporderno,--ERP总单ID
       zx_get_orderdtlid(a.inoutid) as erporderdtlno,--ERP细单ID
       (select max(y.wavedtlid) from wms_wave_goods_dtl y where y.wavedtlid=a.sourceid) as wavedtlid
  from wms_st_io_doc  a,
       tpl_warehouse  c,
       tpl_goodsowner d,
       tpl_goods      e,
       tpl_go_company f,
       wms_goods_lot  h
 where a.comefrom in (2, 3)
   and a.warehid = c.warehid
   and a.goodsownerid = d.goodsownerid
   and a.ownergoodsid = e.ownergoodsid
   and a.companyid = f.companyid
   and a.lotid = h.lotid(+)
"
"WMS_CODE_RULE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_CODE_RULE_V"" (""RULEID"", ""CODENAME"", ""CODETYPE"", ""TECHTYPE"", ""PREFIX"", ""SUFFIX"", ""CODELENGTH"", ""CONJ"", ""MEMO"", ""WAREHID"", ""WAREHNAME"") AS 
  select a.ruleid,
a.codename,
a.codetype,
a.techtype,
a.prefix,
a.suffix,
a.codelength,
a.conj,
a.memo,
a.warehid,
b.warehname
from wms_code_rule a,tpl_warehouse b
where a.warehid=b.warehid

 "
"WMS_CONTAINER_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_CONTAINER_DEF_V"" (""CONTAINERID"", ""TYPEID"", ""CONTAINERNO"", ""BUYDATE"", ""VOLUMN"", ""VOLUMNRATE"", ""USESTATUS"", ""MEMO"", ""WAREHID"", ""WAREHNAME"") AS 
  select a.containerid,
       a.typeid,
       a.containerno,
       a.buydate,
       a.volumn,
       a.volumnrate,
       a.usestatus,
       a.memo,
       a.warehid,
       b.warehname
  from wms_container_def a,
  tpl_warehouse b
  where a.warehid = b.warehid

 "
"WMS_DATACHECK_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_DATACHECK_DOC_V"" (""CHECKDOCID"", ""CHECKMANID"", ""CHECKMAN"", ""CHECKTYPEID"", ""CHECKTYPENAME"", ""CHECKTYPEEXT"", ""BEGINDATE"", ""ENDDATE"", ""RECORDNUM"", ""ALLDEALFLAG"", ""MEMO"") AS 
  select a.checkdocid,
       a.checkmanid,
       b.employeename checkman,
       a.checktypeid,
       c.checktypename,
       c.checktypeext,
       a.begindate,
       a.enddate,
       a.recordnum,
       a.alldealflag,
       a.memo
  from wms_datacheck_doc a,
       pub_employee      b,
       wms_datacheck_type c
  where a.checkmanid=b.employeeid(+)
  and a.checktypeid = c.checktypeid(+)

 "
"WMS_DATACHECK_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_DATACHECK_DTL_V"" (""CHECKDOCID"", ""CHECKDTLID"", ""DETALFLAG"", ""DEALTIME"", ""SOURCEID"", ""MEMO"") AS 
  select ""CHECKDOCID"",""CHECKDTLID"",""DETALFLAG"",""DEALTIME"",""SOURCEID"",""MEMO"" from wms_datacheck_dtl

 "
"WMS_DATACHECK_TYPE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_DATACHECK_TYPE_V"" (""CHECKTYPEID"", ""CHECKTYPENAME"", ""CHECKTYPEEXT"", ""PROGTYPE"", ""PROGNAME"", ""LASTCHECKDATE"", ""PROCPROGTYPE"", ""PROCPROGNAME"", ""MEMO"") AS 
  select ""CHECKTYPEID"",""CHECKTYPENAME"",""CHECKTYPEEXT"",""PROGTYPE"",""PROGNAME"",""LASTCHECKDATE"",""PROCPROGTYPE"",""PROCPROGNAME"",""MEMO""
  from wms_datacheck_type

 "
"WMS_DATAIMP_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_DATAIMP_DOC_V"" (""DOCID"", ""CREDATE"", ""INPUTMANID"", ""TYPEID"", ""MEMO"", ""EMPLOYEENAME"") AS 
  select
      a.docid,
      a.credate,
      a.inputmanid,
      a.typeid,
      a.memo,
      b.employeename
from
    wms_dataimp_doc a,
    pub_employee    b
where
     a.inputmanid = b.employeeid(+)
"
"WMS_DESTROY_ORDER_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_DESTROY_ORDER_DTL_V"" (""OUTID"", ""BMSINOUTID"", ""OUTDTLID"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTNAME"", ""OWNERGOODSID"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""PRICE"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""REALQTY"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""STOCKQTY"", ""CUSTCANCELSTATUS"", ""WMSCANCELSTATUS"", ""ADDMEDCHECKFLAG"", ""SRCEXPDTLNO"", ""USESTATUS"", ""PRINTFLAG"", ""PRINTERROR"", ""DISTRIBUTEID"", ""DISTRIBUTEDTLID"", ""RETAILPRICE"", ""AMT"", ""ALLOCATETIME"", ""FAILREASON"", ""EXPDTLMEMO"", ""PLACESUPPLYID"", ""PLACESUPPLYDTLID"", ""PLACEPRICE"", ""RESALEPRICE"", ""PLACEMONEY"", ""GOODSCLASSID"", ""OTCFLAG"", ""TRADEMARK"", ""APPROVEDOCNO"", ""REGISTNO"", ""JKHZFLAG"", ""PRODDATE"", ""QUALIFYDOCNO"", ""GOODSCLASSNAME"", ""OLDDTLID"", ""OTHERID"", ""EXPFLAG"", ""EXPDATE"", ""EXPFILENAME"", ""INVOICENO"", ""INVOICELINE"", ""CANKEEP"", ""ZXCOLOR"", ""TPRICETICK"", ""TPRICEFLAG"", ""SORTTYPE"", ""LOTLIMIT"", ""PERIODLIMIT"", ""PERIODLIMITUNIT"", ""GOODSOWNID"", ""PRTORDERSET"", ""DTLMEMO"", ""GOODSCLASS"", ""GOODSNO"", ""PRINTNO"", ""WAVEGOODSDTLID"", ""CANCELDATE"", ""WAITFORCANCEL"", ""CANCELMANID"", ""LYDTLZXCOLUMN3"", ""LYDTLZXCOLUMN1"", ""LYDTLZXCOLUMN2"", ""LYDTLZXCOLUMN4"", ""LYDTLZXCOLUMN5"", ""LYDTLZXCOLUMN6"", ""LYDTLZXCOLUMN7"", ""PRINTMONTHFLAG"", ""CANCELMANNAME"", ""DTLZXCOLUMN4"", ""LYDTLZXCOLUMN8"", ""LYDTLZXCOLUMN9"", ""LYDTLZXCOLUMN10"", ""LYDTLZXCOLUMN11"", ""LYDTLZXCOLUMN12"") AS 
  select a.outid,
       a.bmsinoutid,
       a.outdtlid,
       a.warehid,
       a.goodsownerid,
       a.goodsid,
       e.goodsname,
       e.goodsengname,--增加通用名字段,xyue 2013年10月28日 8:03:54
       e.goodstype,
       e.prodarea,
       b.factid,
       nvl(g.factname,h.companyname) factname,--取批号上的生产厂家 zhaocl 2013年7月26日 17:21:46
       a.ownergoodsid,
       a.batchno,
       a.lotid,
       g.lotno,
       g.killlotno,--xyue 2014-06-02 批号信息上的灭菌批号，器械要求
       decode(to_char(g.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              g.validdate) validdate,
       a.goodsstatusid,
       d.goodsstatus,
       a.quantitystatus,
       a.price,
       a.goodsqty,
       a.goodspackid,
       c.packname,
       c.packsize,
       a.realqty,
       a.tradegoodsqty,
       a.tradegoodspack,
       a.stockqty,
       a.custcancelstatus,
       a.wmscancelstatus,
       a.addmedcheckflag,
       a.srcexpdtlno,
       a.usestatus,
       decode(a.printflag,null,null,1) printflag,
       a.printerror,
       a.distributeid,
       a.distributedtlid,
       a.retailprice,
       a.amt,
       a.allocatetime,
       a.failreason,
       a.expdtlmemo,
       a.placesupplyid,
       a.placesupplydtlid,
       a.placeprice,
       a.resaleprice,
       a.placemoney,
       a.goodsclassid,
       a.otcflag,
       a.trademark,
       g.approvedocno,
       g.registno,
       b.jkhzflag,
       g.proddate,
       a.qualifydocno,
       a.goodsclassname,
       a.olddtlid,
       a.otherid,
       a.expflag,
       a.expdate,
       a.expfilename,
       a.invoiceno,
       a.invoiceline,
       a.cankeep,
       a.zxcolor,
       a.tpricetick,
       a.tpriceflag,
       a.sorttype,
       a.lotlimit,
       a.periodlimit,
       a.periodlimitunit,
       e.goodsownid,
       a.prtorderset,
       a.dtlmemo,
       f.goodsclass,
       e.goodsno,
       a.printno,
       a.wavegoodsdtlid,
       a.canceldate,
       a.waitforcancel,
       a.cancelmanid,
       a.Lydtlzxcolumn3,--原价 zhaocl 2013年7月22日 17:25:23
       a.Lydtlzxcolumn1,--折扣率 zhaocl 2013年7月22日 17:33:51
       a.Lydtlzxcolumn2,--价格类型 zhaocl 2013年7月22日 17:33:51
       a.Lydtlzxcolumn4,--标期 zhaocl 2013年7月22日 17:33:51
       a.Lydtlzxcolumn5,--打印单位 zhaocl 2013年7月22日 17:33:51
       a.Lydtlzxcolumn6,--换算比例 zhaocl 2013年7月22日 17:33:51
       a.lydtlzxcolumn7,--打印分类 add by wanghuaiyu 2013年7月30日 21:52:20
       g.printmonthflag,--打印精确到月 zhaocl 2013年7月22日 18:41:22
       dd.employeename cancelmanname,
       a.dtlzxcolumn4,--ERP细单ID add by wanghuaiyu 2013年8月7日 18:03:09
       a.lydtlzxcolumn8, --ERP细单税率 add by xyue 2013年9月16日 20:27:54
       a.lydtlzxcolumn9,--器械别名系统，ERP细单打印通用名 add by xyue 2013年10月05日 23:27:54
       a.lydtlzxcolumn10,--器械别名系统，ERP细单打印商品名 add by xyue 2013年10月05日 23:27:54
       a.lydtlzxcolumn11,--器械别名系统，ERP细单打印规格 add by xyue 2013年10月05日 23:27:54
       a.lydtlzxcolumn12--器械别名系统，ERP细单打印产地 add by xyue 2013年10月05日 23:27:54
  from wms_out_order_dtl   a,
        tpl_pub_goods       b,
        tpl_pub_goods_packs c,
        wms_goodsstatus     d,
        tpl_goods           e,
        wms_goods_feature   f,
        wms_goods_lot       g,
        tpl_pub_company     h,
        pub_employee      dd
  where a.goodsid = b.goodsid(+)
    and a.goodspackid = c.goodspackid(+)
    and a.goodsstatusid = d.goodsstatusid(+)
    and a.ownergoodsid = e.ownergoodsid
    and a.goodsid = f.goodsid(+)
    and a.warehid = f.warehid(+)
    and a.lotid = g.lotid(+)
    and b.factid = h.companyid(+)
 and a.cancelmanid = dd.employeeid(+)
"
"WMS_DESTROY_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_DESTROY_ORDER_V"" (""WAREHID"", ""GOODSOWNERID"", ""COMEFROM"", ""OUTID"", ""WAVEID"", ""WAVEDTLID"", ""CREDATE"", ""RECCOMPANYID"", ""INPUTMANID"", ""IMPUTMAN"", ""OPERATIONTYPE"", ""SRCEXPNO"", ""USESTATUS"", ""OLDID"", ""OTHERID"", ""TRDTLID"", ""WAREHNAME"", ""GOODSOWNERNAME"", ""GCOMPANYID"", ""RECCOMPANYNAME"", ""ZXCOLUMN4"", ""GCOMPANYNAME"", ""DESTROYREASON"", ""DESTROYMETHOD"", ""DESTROYADDRESS"", ""DESTROYMANID"", ""DESTROYMAN"", ""DESTROYJDMANID"", ""DESTROYJDMAN"", ""TRANSMANID"", ""TRANSMAN"", ""TRANSTOOLS"", ""SITUATION"", ""CHECKMANID"", ""CHECKMAN"", ""CHECKDATE"", ""DESTROYMEMO"", ""DESTROYSTATUS"", ""DESTROYDATE"") AS 
  select a.warehid,
       a.goodsownerid,
       a.comefrom,
       a.outid,
       a.waveid,
       a.wavedtlid,
       a.credate,
       a.reccompanyid,
       a.inputmanid,
       g.employeename imputman,
       a.operationtype,
       -- decode(zx_yl.isallwhole(a.outid),1,decode(a.exportmemo,null,'[Z]','[Z]'||a.exportmemo),a.exportmemo),
       a.srcexpno,
       a.usestatus,
       a.oldid,
       a.otherid,
       a.trdtlid,
       c.warehname,
       d.goodsownername,
       f.gcompanyid,
       f.companyname reccompanyname,
       a.zxcolumn4,--ERP总单ID add by wanghuaiyu 2013年8月6日 17:54:54
       a.gcompanyname,--add by weitangjing 20131102 货主原单位名称
       a.destroyreason,--销毁原因
       a.destroymethod,--销毁方式
       a.destroyaddress,--销毁地址
       a.destroymanid,--销毁人员ID
       j.employeename destroyman,--视图显示出来的，销毁人
       a.destroyjdmanid,--销毁监督人ID
       aa.employeename destroyjdman,--视图显示
			 a.transmanid,--运输人员ID
			 ee.employeename transman,--视图显示
			 a.transtools ,--运输工具
			 a.situation ,--销毁后现场情况
       a.checkmanid,--复核人ID
       dd.employeename checkman,--视图显示
       a.checkdate,--复核时间
       a.destroymemo,--销毁总单备注
       a.destroystatus,--销毁订单状态，通过按钮【销毁确认】来变成1
       a.time4 destroydate-- 销毁时间，视图显示
  from wms_out_order      a,
       --wms_transport_mode b,
       tpl_warehouse      c,
       tpl_goodsowner     d,
       tpl_go_company     f,
       pub_employee       g,
      -- wms_transport_mode h,
       pub_employee       j,
       --tms_route_pos      k,
       --wms_tr_route       l,
       pub_employee       aa,
       pub_employee       dd,
			  pub_employee      ee
      -- wms_wave_dtl_v     t
 where a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.reccompanyid = f.companyid(+)
   and a.inputmanid = g.employeeid(+)
   and a.destroymanid = j.employeeid(+)
   and a.destroyjdmanid = aa.employeeid(+)
   and a.checkmanid = dd.employeeid(+)
	 AND a.transmanid = ee.employeeid(+)
   and a.usestatus = 4 --已出货
   and a.operationtype=21
"
"WMS_DEVICE_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_DEVICE_DEF_V"" (""WAREHID"", ""WAREHNAME"", ""DEVICEID"", ""DEVNAME"", ""FACTROY"", ""DEVSTANDARD"", ""DEVMOD"", ""LADDRMODEL"", ""DEVTYPE"", ""MEMO"") AS 
  select a.WAREHID,
       b.warehname,
       a.DEVICEID,
       a.DEVNAME,
       a.FACTROY,
       a.DEVSTANDARD,
       a.DEVMOD,
       a.LADDRMODEL,
       a.DEVTYPE,
       a.MEMO
  from WMS_DEVICE_DEF a,
       tpl_warehouse  b
 where a.warehid = b.warehid

 "
"WMS_DEVICE_DPS_SETUP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_DEVICE_DPS_SETUP_V"" (""WAREHID"", ""SETUPID"", ""DEVICEID"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVERCLASS"", ""POLLING"", ""INSECTIONS"", ""PICKAREAIDS"", ""PICKAREANAMES"", ""ISOUTFLAG"", ""DBTYPE"", ""DBCPIP"", ""DBCPPORT"", ""DBCPSID"", ""DBCPUSERNAME"", ""DBCPUSERPWD"", ""USESTATUS"", ""MEMO"") AS 
  select a.WAREHID,
       a.SETUPID,
       a.DEVICEID,
       a.driverid,
       b.DRIVERNAME,
       b.driverclass,
       a.POLLING,
       a.INSECTIONS,
       a.PICKAREAIDS,
       a.pickareanames,
       a.ISOUTFLAG    ,
       a.DBTYPE        ,
       a.DBCPIP       ,
       a.DBCPPORT      ,
       a.DBCPSID       ,
       a.DBCPUSERNAME  ,
       a.DBCPUSERPWD   ,
        a.usestatus,
       a.MEMO
  from WMS_DEVICE_DPS_SETUP a,WMS_DEVICE_DRIVER_INFO b
  where a.driverid = b.driverid(+)
"
"WMS_DEVICE_SETUP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_DEVICE_SETUP_V"" (""WAREHID"", ""SETUPID"", ""DEVICEID"", ""DRIVERNAME"", ""POLLING"", ""INSECTIONS"", ""PICKAREAIDS"", ""MEMO"") AS 
  select a.WAREHID,
       a.SETUPID,
       a.DEVICEID,
       a.DRIVERNAME,
       a.POLLING,
       a.INSECTIONS,
       a.PICKAREAIDS,
       a.MEMO
  from WMS_DEVICE_SETUP a

 "
"WMS_DEVICE_WCS_SETUP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_DEVICE_WCS_SETUP_V"" (""WAREHID"", ""SETUPID"", ""DEVICEID"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVERCLASS"", ""POLLING"", ""INSECTIONS"", ""PICKAREAIDS"", ""PICKAREANAMES"", ""ISOUTFLAG"", ""DBTYPE"", ""DBCPIP"", ""DBCPPORT"", ""DBCPSID"", ""DBCPUSERNAME"", ""DBCPUSERPWD"", ""USESTATUS"", ""MEMO"") AS 
  select a.WAREHID,
       a.SETUPID,
       a.DEVICEID,
       a.driverid,
       b.DRIVERNAME,
       b.driverclass,
       a.POLLING,
       a.INSECTIONS,
       a.PICKAREAIDS,
       a.pickareanames,
       a.ISOUTFLAG    ,
       a.DBTYPE        ,
       a.DBCPIP       ,
       a.DBCPPORT      ,
       a.DBCPSID       ,
       a.DBCPUSERNAME  ,
       a.DBCPUSERPWD   ,
        a.usestatus,
       a.MEMO
  from WMS_DEVICE_WCS_SETUP a,WMS_DEVICE_DRIVER_INFO b
  where a.driverid = b.driverid(+)
"
"WMS_ECODE_IN_TO_OUT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ECODE_IN_TO_OUT_V"" (""ECODE"", ""CREDATE"", ""INOUTID"", ""INOUTFLAG"", ""INPUTMANID"", ""OUTID"", ""OUTDTLID"") AS 
  select t.ecode,
       sysdate credate,
       g.inoutid,
       1 inoutflag,--出库是1
       0 inputmanid,--系统管理员
       a.outid,
       b.outdtlid
  from wms_ecode_record      t,
       wms_out_order         a,
       wms_out_order_dtl     b,
       wms_out_order_lot_dtl c,
       wms_in_order          d,
       wms_in_order_dtl      e,
       wms_receive_dtl       f,
       wms_st_io_doc         g
 where a.outid = b.outid
   and b.outdtlid = c.outdtlid
   and d.inid = e.inid
   and e.indtlid = f.indtlid
   and t.sourceid = f.receiveid
   and t.inoutflag = 0
   and d.operationtype=1--进货
   and d.usestatus=3 --入库总单完成
   and e.porderstatus=5 --入库细单上架完成
   and f.usestatus=4 --验收明细上架完成
   and nvl(d.autoflag,0)=1 --自动生成的入库订单
   and nvl(a.autoflag,0)=1 --自动生成的出库订单
   and a.goodsownerid=b.goodsownerid --同一货主
   and to_char(a.from_sudocid)=d.zxcolumn4
   and to_char(b.from_sudtlid)=e.dtlzxcolumn4
   and g.comefrom=3
   and c.wavegoodsdtlid=g.sourceid
"
"WMS_ECODE_MANAGEMENT_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ECODE_MANAGEMENT_DTL_V"" (""UUID"", ""RECORDID"", ""INPUTMANID"", ""INPUTMAN"", ""DTLCREATE"", ""ECODE"") AS 
  select t.uuid,
       t.recordid,
       t.inputmanid,
       a.employeename as inputman,
       t.credate as dtlcreate,
       t.ecode
  from wms_ecode_management_dtl t, pub_employee a
 where t.inputmanid = a.employeeid(+)
"
"WMS_ECODE_MANAGEMENT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ECODE_MANAGEMENT_V"" (""UUID"", ""CREDATE"", ""JOBDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""ORDERNO"", ""INOUTTYPE"", ""COMEFROM"", ""BILLCODE"", ""OPERATIONTYPE"", ""COMPANYID"", ""CORPID"", ""COMPANYNAME"", ""OWNERGOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""DRUGFORM"", ""FACTNAME"", ""MAH"", ""APPROVEDOCNO"", ""GOODSQTY"", ""LOTNO"", ""OUTID"", ""OUTDTLID"", ""ERPORDERNO"", ""YNORDERNO"", ""WAVEDTLID"", ""EXECFLAG"", ""EXECDATE"", ""EXECMSG"", ""INOUTID"", ""TRANSID"", ""SENDPOS"", ""INCEPTADDR"") AS 
  select t.uuid,
       t.credate,
       t.jobdate,
       t.warehid,
       t.warehname,
       t.goodsownerid,
       t.goodsownername,
       t.orderno,
       t.inouttype,
       t.comefrom,
       t.billcode,
       t.operationtype,
       t.companyid,
       t.corpid,
       t.companyname,
       t.ownergoodsid,
       t.goodsownid,
       t.goodsname,
       t.goodsengname,
       t.goodstype,
       t.tradepackname,
       t.drugform,
       t.factname,
       t.mah,
       t.approvedocno,
       t.goodsqty,
       t.lotno,
       t.outid,
       t.outdtlid,
       t.erporderno,
       t.ynorderno,
       t.wavedtlid,
       t.execflag,
       t.execdate,
       t.execmsg,
       t.inoutid,
       t.transid,
       t.sendpos,
       t.inceptaddr
  from wms_ecode_management t
"
"WMS_ECODE_OUT_TO_IN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ECODE_OUT_TO_IN_V"" (""ECODE"", ""CREDATE"", ""RECEIVEID"", ""INOUTFLAG"", ""INPUTMANID"", ""INID"", ""INDTLID"") AS 
  select t.ecode,
       sysdate credate,
       f.receiveid,
       0 inoutflag,--入库是0
       0 inputmanid,--系统管理员
       d.inid,
       e.indtlid
  from wms_ecode_record      t,
       wms_out_order         a,
       wms_out_order_dtl     b,
       wms_out_order_lot_dtl c,
       wms_in_order          d,
       wms_in_order_dtl      e,
       wms_receive_dtl       f,
       wms_st_io_doc         g
 where a.outid = b.outid
   and b.outdtlid = c.outdtlid
   and d.inid = e.inid
   and e.indtlid = f.indtlid
   and a.operationtype=11--销售
   and a.usestatus=4 --出库状态已出货
   and b.usestatus=5 --出库细单状态已出库
   and nvl(d.autoflag,0)=1 --自动生成的入库订单
   and g.comefrom=3
   and c.wavegoodsdtlid=g.sourceid
   and t.inoutflag = 1
   and t.sourceid=g.inoutid
   and f.outdtlid=b.outdtlid
"
"WMS_ECODE_RECORD_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ECODE_RECORD_V"" (""RECORDID"", ""SOURCEIDBAK"", ""SOURCEID"", ""ECODE"", ""CREDATE"", ""EXPFLAG"", ""QTY"", ""INOUTFLAG"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""WARECID"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""DRUGFORM"", ""APPROVEDOCNO"", ""MAH"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""TRADETIME"", ""TRADENO"", ""INPUTMANID"", ""INPUTMANNAME"", ""EXPDATE"", ""EXPMANID"", ""EXPMANNAME"", ""SPECIALFLAG"", ""SIGNATURE"", ""CORPID"", ""BILLTYPE"", ""COMEFROM"", ""SRCEXPNO"") AS 
  select a.recordid,
       a.sourceid as sourceidbak,
       replace(replace(replace(nvl(a.srcexpno, a.sourceid), chr(10), ''),
                       chr(13),
                       ''),
               chr(9),
               '') as sourceid,
       a.ecode,
       trunc(a.credate) as credate,
       nvl(a.expflag, 0) as expflag,
       a.qty,
       a.inoutflag,
       a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.companyid,
       g.warecid as warecid,
       replace(replace(replace(g.companyname, chr(10), ''), chr(13), ''),
               chr(9),
               '') as companyname,
       --decode(a.operationtype, 43, 11, 25, 21, 18, 11, a.operationtype) as operationtype,
       (case
         when a.operationtype in (43, 18) then
          11
         when a.operationtype in (25) then
          21
         when a.operationtype in (8) and a.goodsownerid in (10003,9175,10008,10005) then
          1
         when a.operationtype in (42) and a.goodsownerid in (304,4) then
           7  --收配退转销退 tl@250305
         else
          a.operationtype
       end) as operationtype,
       a.ownergoodsid,
       d.waregoodsid as goodsid,
       d.goodsname,
       d.goodsengname,
       d.goodstype,
       d.tradepackname,
       d.factname,
       d.prodarea,
       d.drugform,
       d.approvedocno,
       d.mah,
       a.goodspackid,
       e.packname,
       e.packsize,
       null as batchno,
       a.lotid,
       f.lotno,
       f.proddate,
       f.validdate,
       null as goodsstatusid,
       null as goodsstatus,
       null as quantitystatus,
       a.credate as tradetime,
       a.inoutid as tradeno,
       a.inputmanid,
       h.employeename as inputmanname,
       a.expdate,
       a.expmanid,
       i.employeename as expmanname,
       (select nvl(x.specialflag, 2)
          from tpl_pub_goods x
         where x.goodsid = a.goodsid) as specialflag,
       null as signature,
       --nvl(g.corpid, g.gcompanyid) corpid,
       /*       decode(o.goodsownerid,
       8100,
       (select nvl(max(t1.gcompanyid), 0)
          from tpl_go_company t1
         where t1.goodsownerid = 8100
           and t1.companyname = o.receivehead),
       nvl(f.corpid, f.gcompanyid)) corpid, --辰欣 by tl@230825*/
       (case
         when a.goodsownerid = 8100 and a.comefrom = 3 then
          (select nvl(max(z.gcompanyid), 0)
             from wms_out_order y, tpl_go_company z
            where y.outid = a.outid
              and y.goodsownerid = z.goodsownerid
              and y.receivehead = z.companyname)
         else
          nvl(g.corpid, g.gcompanyid)
       end) as corpid,
       --nvl(g.corpid, g.gcompanyid) as corpid,--xyue 2025-03-24
       null billtype,
       nvl(a.comefrom, 0) as comefrom,
       a.srcexpno
  from wms_ecode_record    a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       tpl_pub_goods_packs e,
       wms_goods_lot       f,
       tpl_go_company      g,
       pub_employee        h,
       pub_employee        i
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.goodspackid = e.goodspackid(+)
   and a.lotid = f.lotid(+)
   and a.companyid = g.companyid
   and a.inputmanid = h.employeeid(+)
   and a.expmanid = i.employeeid(+)
   and a.credate > to_Date('2023-01-01', 'yyyy-mm-dd')
 order by nvl(a.srcexpno, a.sourceid), a.ownergoodsid
"
"WMS_ECODE_RECORD_V2","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ECODE_RECORD_V2"" (""RECORDID"", ""SOURCEIDBAK"", ""SOURCEID"", ""ECODE"", ""CREDATE"", ""EXPFLAG"", ""QTY"", ""INOUTFLAG"", ""INPUTMANID"", ""INPUTMANNAME"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""TRADEPACKNAME"", ""OPERATIONTYPE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""WARECID"", ""TRADETIME"", ""TRADENO"", ""EXPDATE"", ""EXPMANID"", ""EXPMANNAME"", ""SPECIALFLAG"", ""SIGNATURE"", ""CORPID"", ""BILLTYPE"", ""COMEFROM"", ""SRCEXPNO"", ""YJJCODE"") AS 
  select aa.recordid,
       aa.sourceidbak,
       aa.sourceid,
       aa.ecode,
       aa.credate,
       aa.expflag,
       aa.qty,
       aa.inoutflag,
       aa.inputmanid,
       aa.inputmanname,
       aa.warehid,
       aa.warehname,
       aa.ownergoodsid,
       aa.goodsid,
       aa.goodsname,
       aa.goodstype,
       aa.prodarea,
       aa.factname,
       aa.goodspackid,
       aa.packname,
       aa.packsize,
       aa.batchno,
       aa.lotid,
       aa.lotno,
       aa.proddate,
       aa.validdate,
       aa.approvedocno,
       aa.goodsstatusid,
       aa.goodsstatus,
       aa.quantitystatus,
       aa.tradepackname,
       aa.operationtype,
       aa.goodsownerid,
       aa.goodsownername,
       aa.companyid,
       aa.companyname,
       aa.warecid,
       aa.tradetime,
       aa.tradeno,
       aa.expdate,
       aa.expmanid,
       aa.expmanname,
       aa.specialflag,
       aa.signature,
       aa.corpid,
       aa.billtype,
       aa.comefrom ,-- add by xyue 2015-12-01 区分数据来源是外部导入还是系统内部生成
       aa.srcexpno,
       aa.yjjcode from
(select a.recordid,
       (100000000+a.sourceid) sourceidbak,
       --to_char(a.credate,'yyyymmdd')||(case when to_char(a.credate,'hh24')<14 then '01' else '02' end)||nvl(gg.specialflag,2)||b.companyid sourceid,
       b.srcexpno sourceid,
       a.ecode,
       --to_char(a.credate,'yyyy-mm-dd') credate,
       trunc(a.credate) credate,
       a.expflag,
       a.qty,
       a.inoutflag,
       a.inputmanid,
       c.employeename inputmanname,
       b.warehid,
       b.warehname,
       b.ownergoodsid,
       b.goodsid,
       b.goodsname,
       b.goodstype,
       b.prodarea,
       b.factoryname factname,
       b.goodspackid,
       b.packname,
       b.packsize,
       b.batchno,
       b.lotid,
       b.lotno,
       b.proddate,
       b.validdate,
       b.approvedocno,
       b.goodsstatusid,
       b.goodsstatus,
       b.quantitystatus,
       b.tradepackname,
       decode(b.operationtype,43,11,25,21,b.operationtype) operationtype,
       --decode(b.operationtype,18,11,b.operationtype) operationtype,
       b.goodsownerid,
       b.goodsownername,
       b.companyid,
       b.companyname,
       f.warecid,
       to_char(nvl(b.credate, sysdate), 'yyyy-MM-dd hh24:mi:ss') tradetime,
       b.sourceid tradeno,
       a.expdate,
       a.expmanid,
       ss.employeename expmanname,
       nvl(gg.specialflag,2) specialflag,
       gg.signature,
       null corpid,
       (select max(tt.outmode) from wms_wave_goods_dtl t,wms_out_order_v tt where t.wavedtlid=tt.wavedtlid and t.wavegoodsdtlid=b.sourceid) billtype,
       -- add by xyue 2015-11-18 用于区分湖里门市送货和自提的标志
       nvl(a.comefrom,0) comefrom ,-- add by xyue 2015-12-01 区分数据来源是外部导入还是系统内部生成
       b.srcexpno,
       g.yjjcode
  from wms_ecode_record a,
       wms_st_io_doc_v1 b,
       pub_employee     c,
       tpl_go_company   f,
       pub_employee     ss,
       tpl_pub_goods     gg,
       --tpl_pub_company cc,
       zx_nhnd_scmcode g
 where a.sourceid = b.inoutid
   and a.inoutflag = 1
   and b.companyid = f.companyid(+)
   and a.inputmanid = c.employeeid(+)
   and a.expmanid = ss.employeeid(+)
    and b.goodsid = gg.goodsid(+)
    --AND f.warecid = cc.companyid
    and b.comefrom =3
    and nvl(a.comefrom,0) = 3
    and b.companyid=g.companyid(+)

union all

--入库电子监管码
select a.recordid,
       (100000000+a.sourceid) sourceidbak,
       --to_char(a.credate,'yyyymmdd')||(case when to_char(a.credate,'hh24')<14 then '01' else '02' end)||nvl(gg.specialflag,2)||b.companyid sourceid,
       to_char(b.sourceid) sourceid,
       a.ecode,
       --to_char(a.credate,'yyyy-mm-dd') credate,
       trunc(a.credate) credate,
       a.expflag,
       a.qty,
       a.inoutflag,
       a.inputmanid,
       c.employeename inputmanname,
       b.warehid,
       e.warehname,
       b.ownergoodsid,
       d.waregoodsid goodsid,
       d.goodsname,
       d.goodstype,
       d.prodarea,
       d.factname factname,
       b.goodspackid,
       h.packname,
       h.packsize,
       b.batchno,
       b.lotid,
       i.lotno,
       i.proddate,
       i.validdate,
       i.approvedocno,
       b.goodsstatusid,
       j.goodsstatus,
       j.quantitystatus,
       d.tradepackname,
       b.operationtype,
       b.goodsownerid,
       g.goodsownername,
       b.companyid,
       f.companyname,
       f.warecid,
       to_char(nvl(b.credate, sysdate), 'yyyy-MM-dd hh24:mi:ss') tradetime,
       b.sourceid tradeno,
       a.expdate,
       a.expmanid,
       ss.employeename expmanname,
       null specialflag,
       null signature,
       null corpid,
       null billtype,
       nvl(a.comefrom,0) comefrom ,-- add by xyue 2015-12-01 区分数据来源是外部导入还是系统内部生成
       to_char(b.sourceid) srcexpno,
       null yjjcode
  from wms_ecode_record_goodsseq a,
       wms_st_io_doc    b,
       pub_employee     c,
       tpl_go_company   f,
       pub_employee     ss,
       tpl_warehouse    e,
       tpl_goodsowner   g,
       tpl_goods        d,
       tpl_pub_goods_packs h,
       wms_goods_lot    i,
       wms_goodsstatus  j
 where a.sourceid = b.sourceid
   and a.inoutflag = 0 --入库采集
   and b.companyid = f.companyid(+)
   and a.inputmanid = c.employeeid(+)
   and a.expmanid = ss.employeeid(+)
   and b.ownergoodsid = d.ownergoodsid(+)
   and b.warehid=e.warehid(+)
   and b.goodsownerid=g.goodsownerid(+)
   and b.goodspackid=h.goodspackid(+)
   and b.lotid=i.lotid(+)
   and b.goodsstatusid=j.goodsstatusid(+)
   and b.comefrom =1
   and nvl(a.comefrom,0) = 0) aa order by aa.sourceid,aa.goodsid
"
"WMS_ECODE_RECORD_V_BAK20240623","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ECODE_RECORD_V_BAK20240623"" (""RECORDID"", ""SOURCEIDBAK"", ""SOURCEID"", ""ECODE"", ""CREDATE"", ""EXPFLAG"", ""QTY"", ""INOUTFLAG"", ""INPUTMANID"", ""INPUTMANNAME"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""TRADEPACKNAME"", ""OPERATIONTYPE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""WARECID"", ""TRADETIME"", ""TRADENO"", ""EXPDATE"", ""EXPMANID"", ""EXPMANNAME"", ""SPECIALFLAG"", ""SIGNATURE"", ""CORPID"", ""BILLTYPE"", ""COMEFROM"", ""SRCEXPNO"") AS 
  select aa.recordid,
       aa.sourceidbak,
       replace(replace(replace(aa.sourceid,chr(10),''),chr(13),''),chr(9),'') as sourceid,
       aa.ecode,
       aa.credate,
       aa.expflag,
       aa.qty,
       aa.inoutflag,
       aa.inputmanid,
       aa.inputmanname,
       aa.warehid,
       aa.warehname,
       aa.ownergoodsid,
       aa.goodsid,
       aa.goodsname,
       aa.goodstype,
       aa.prodarea,
       aa.factname,
       aa.goodspackid,
       aa.packname,
       aa.packsize,
       aa.batchno,
       aa.lotid,
       aa.lotno,
       aa.proddate,
       aa.validdate,
       aa.approvedocno,
       aa.goodsstatusid,
       aa.goodsstatus,
       aa.quantitystatus,
       aa.tradepackname,
       aa.operationtype,
       aa.goodsownerid,
       aa.goodsownername,
       aa.companyid,
       replace(replace(replace(aa.companyname,chr(10),''),chr(13),''),chr(9),'') as companyname,
       aa.warecid,
       aa.tradetime,
       aa.tradeno,
       aa.expdate,
       aa.expmanid,
       aa.expmanname,
       aa.specialflag,
       aa.signature,
       aa.corpid,
       aa.billtype,
       aa.comefrom ,-- add by xyue 2015-12-01 区分数据来源是外部导入还是系统内部生成
       aa.srcexpno
        from
(select a.recordid,
       (100000000 + a.sourceid) sourceidbak,
       replace(o.srcexpno,chr(10),'') sourceid,
       a.ecode,
       trunc(a.credate) credate,
       nvl(a.expflag, 0) expflag,
       a.qty,
       a.inoutflag,
       a.inputmanid,
       c.employeename inputmanname,
       b.warehid,
       d.warehname,
       b.ownergoodsid,
       b.goodsid,
       e.goodsname,
       e.goodstype,
       e.prodarea,
       e.factname factname,
       b.goodspackid,
       g.packname,
       g.packsize,
       b.batchno,
       b.lotid,
       h.lotno,
       h.proddate,
       h.validdate,
       h.approvedocno,
       b.goodsstatusid,
       i.goodsstatus,
       i.quantitystatus,
       e.tradepackname,
       decode(b.operationtype, 43, 11, 25, 21, 18, 11, b.operationtype) operationtype,
       b.goodsownerid,
       j.goodsownername,
       b.companyid,
       f.companyname,
       f.warecid,
       to_char(nvl(b.credate, sysdate), 'yyyy-MM-dd hh24:mi:ss') tradetime,
       b.sourceid tradeno,
       a.expdate,
       a.expmanid,
       k.employeename expmanname,
       nvl(l.specialflag, 2) specialflag,
       l.signature,
      /* nvl(f.corpid,f.gcompanyid) corpid,*/
      decode(o.goodsownerid,
              8100,
              (select  nvl(max(t1.gcompanyid),0)  from tpl_go_company t1  where t1.goodsownerid=8100  and t1.companyname = o.receivehead),
              nvl(f.corpid,f.gcompanyid))  corpid,--辰欣 by tl@230825
       null billtype,
       nvl(a.comefrom, 0) comefrom, -- add by xyue 2015-12-01 区分数据来源是外部导入还是系统内部生成
       o.srcexpno
  from wms_ecode_record      a,
       wms_st_io_doc         b,
       pub_employee          c,
       tpl_warehouse         d,
       tpl_goods             e,
       tpl_go_company        f,
       tpl_pub_goods_packs   g,
       wms_goods_lot         h,
       wms_goodsstatus       i,
       tpl_goodsowner        j,
       pub_employee          k,
       tpl_pub_goods         l,
       wms_out_order_lot_dtl m,
       wms_out_order_dtl     n,
       wms_out_order         o
 where a.sourceid = b.inoutid
   and a.inoutflag = 1
   and a.inputmanid = c.employeeid(+)
   and b.warehid = d.warehid(+)
   and b.ownergoodsid = e.ownergoodsid(+)
   and b.goodspackid = g.goodspackid(+)
   and b.lotid = h.lotid(+)
   and b.goodsstatusid = i.goodsstatusid(+)
   and b.goodsownerid = j.goodsownerid(+)
   and b.companyid = f.companyid(+)
   and a.expmanid = k.employeeid(+)
   and b.goodsid = l.goodsid(+)
   and b.comefrom = 3
   and nvl(a.comefrom, 0) = 3
   and b.sourceid=m.wavegoodsdtlid
   and n.outdtlid=m.outdtlid
   and o.outid=n.outid
   and a.credate>to_Date('2017-01-01','yyyy-mm-dd')

/*union all

--器械序列号
select a.recordid,
       (100000000+a.sourceid) sourceidbak,
       to_char(b.sourceid) sourceid,
       a.ecode,
       trunc(a.credate) credate,
       nvl(a.expflag,0) expflag,
       a.qty,
       a.inoutflag,
       a.inputmanid,
       c.employeename inputmanname,
       b.warehid,
       e.warehname,
       b.ownergoodsid,
       d.waregoodsid goodsid,
       d.goodsname,
       d.goodstype,
       d.prodarea,
       d.factname factname,
       b.goodspackid,
       h.packname,
       h.packsize,
       b.batchno,
       b.lotid,
       i.lotno,
       i.proddate,
       i.validdate,
       i.approvedocno,
       b.goodsstatusid,
       j.goodsstatus,
       j.quantitystatus,
       d.tradepackname,
       b.operationtype,
       b.goodsownerid,
       g.goodsownername,
       b.companyid,
       f.companyname,
       f.warecid,
       to_char(nvl(b.credate, sysdate), 'yyyy-MM-dd hh24:mi:ss') tradetime,
       b.sourceid tradeno,
       a.expdate,
       a.expmanid,
       ss.employeename expmanname,
       null specialflag,
       null signature,
       null corpid,
       null billtype,
       nvl(a.comefrom,0) comefrom ,-- add by xyue 2015-12-01 区分数据来源是外部导入还是系统内部生成
       to_char(b.sourceid) srcexpno
  from wms_ecode_record_goodsseq a,
       wms_st_io_doc    b,
       pub_employee     c,
       tpl_go_company   f,
       pub_employee     ss,
       tpl_warehouse    e,
       tpl_goodsowner   g,
       tpl_goods        d,
       tpl_pub_goods_packs h,
       wms_goods_lot    i,
       wms_goodsstatus  j
 where a.sourceid = b.sourceid
   and a.inoutflag = 0 --入库采集
   and b.companyid = f.companyid(+)
   and a.inputmanid = c.employeeid(+)
   and a.expmanid = ss.employeeid(+)
   and b.ownergoodsid = d.ownergoodsid(+)
   and b.warehid=e.warehid(+)
   and b.goodsownerid=g.goodsownerid(+)
   and b.goodspackid=h.goodspackid(+)
   and b.lotid=i.lotid(+)
   and b.goodsstatusid=j.goodsstatusid(+)
   and b.comefrom =1
   and nvl(a.comefrom,0) = 0
   and a.credate>to_Date('2024-05-01','yyyy-mm-dd')*/

   union all

--入库电子监管码
select a.recordid,
       (100000000+a.sourceid) sourceidbak,
       to_char(b.sourceid) sourceid,
       a.ecode,
       trunc(a.credate) credate,
       nvl(a.expflag,0) expflag,
       a.qty,
       a.inoutflag,
       a.inputmanid,
       c.employeename inputmanname,
       b.warehid,
       e.warehname,
       b.ownergoodsid,
       d.waregoodsid goodsid,
       d.goodsname,
       d.goodstype,
       d.prodarea,
       d.factname factname,
       b.goodspackid,
       h.packname,
       h.packsize,
       b.batchno,
       b.lotid,
       i.lotno,
       i.proddate,
       i.validdate,
       i.approvedocno,
       b.goodsstatusid,
       j.goodsstatus,
       j.quantitystatus,
       d.tradepackname,
       decode(b.operationtype,43,11,25,21,18,11,b.operationtype) operationtype,
       b.goodsownerid,
       g.goodsownername,
       b.companyid,
       f.companyname,
       f.warecid,
       to_char(nvl(b.credate, sysdate), 'yyyy-MM-dd hh24:mi:ss') tradetime,
       b.sourceid tradeno,
       a.expdate,
       a.expmanid,
       k.employeename expmanname,
       null specialflag,
       null signature,
       nvl(f.corpid,f.gcompanyid) corpid,
       null billtype,
       nvl(a.comefrom,0) comefrom ,-- add by xyue 2015-12-01 区分数据来源是外部导入还是系统内部生成
       to_char(b.sourceid) srcexpno
  from wms_ecode_record a,
       wms_st_io_doc    b,
       pub_employee     c,
       tpl_goods        d,
       tpl_warehouse    e,
       tpl_go_company   f,
       tpl_goodsowner   g,
       tpl_pub_goods_packs h,
       wms_goods_lot    i,
       wms_goodsstatus  j,
       pub_employee     k
 where a.sourceid = b.sourceid
   and a.inoutflag = 0 --入库采集
   and b.companyid = f.companyid(+)
   and a.inputmanid = c.employeeid(+)
   and a.expmanid = k.employeeid(+)
   and b.ownergoodsid = d.ownergoodsid(+)
   and b.warehid=e.warehid(+)
   and b.goodsownerid=g.goodsownerid(+)
   and b.goodspackid=h.goodspackid(+)
   and b.lotid=i.lotid(+)
   and b.goodsstatusid=j.goodsstatusid(+)
   and b.comefrom =2
   and nvl(a.comefrom,0) = 0
   and a.credate>to_Date('2017-01-01','yyyy-mm-dd')

   union all

--入库收货采集电子监管码
select a.recordid,
       (100000000+a.sourceid) sourceidbak,
       to_char(c.indtlid) sourceid,
       a.ecode,
       trunc(a.credate) credate,
       nvl(a.expflag,0) expflag,
       a.qty,
       a.inoutflag,
       a.inputmanid,
       d.employeename inputmanname,
       b.warehid,
       g.warehname,
       c.ownergoodsid,
       f.waregoodsid goodsid,
       f.goodsname,
       f.goodstype,
       f.prodarea,
       f.factname factname,
       null goodspackid,
       null packname,
       null packsize,
       null batchno,
       null lotid,
       null lotno,
       null proddate,
       null validdate,
       null approvedocno,
       null goodsstatusid,
       null goodsstatus,
       null quantitystatus,
       f.tradepackname,
       decode(b.operationtype,43,11,25,21,18,11,b.operationtype) operationtype,
       b.goodsownerid,
       i.goodsownername,
       b.sourcecompanyid companyid,
       h.companyname,
       h.warecid,
       to_char(nvl(b.credate, sysdate), 'yyyy-MM-dd hh24:mi:ss') tradetime,
       c.indtlid tradeno,
       a.expdate,
       a.expmanid,
       e.employeename expmanname,
       null specialflag,
       null signature,
       nvl(h.corpid,h.gcompanyid) corpid,
       null billtype,
       0 comefrom ,-- add by xyue 2015-12-01 区分数据来源是外部导入还是系统内部生成
       to_char(c.indtlid) srcexpno
  from wms_ecode_record a,
       wms_in_order     b,
       wms_in_order_dtl c,
       pub_employee     d,
       pub_employee     e,
       tpl_goods        f,
       tpl_warehouse    g,
       tpl_go_company   h,
       tpl_goodsowner   i
 where a.sourceid = c.indtlid
   and b.inid=c.inid
   and a.inoutflag = 0 --入库采集
   and b.sourcecompanyid = h.companyid(+)
   and a.inputmanid = d.employeeid(+)
   and a.expmanid = e.employeeid(+)
   and c.ownergoodsid = f.ownergoodsid(+)
   and b.warehid=g.warehid(+)
   and b.goodsownerid=i.goodsownerid(+)
   and nvl(a.comefrom,0) = 1
   and a.credate>to_Date('2017-01-01','yyyy-mm-dd')

   ) aa order by aa.sourceid,aa.goodsid
"
"WMS_ELABLE_ADDRESS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ELABLE_ADDRESS_V"" (""DEVICEID"", ""POSID"", ""LADDRESS"", ""MEMO"", ""POSNO"") AS 
  select a.DEVICEID,
       a.POSID,
       a.LADDRESS,
       a.MEMO,
       b.posno
  from Wms_Elable_Address a,
       wms_pos_def        b
 where a.posid = b.posid

 "
"WMS_ELABLE_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ELABLE_DEF_V"" (""ELABLEID"", ""ELABLENO"", ""CREDATE"", ""INPUTMANID"", ""USESTATUS"", ""OPCODE"", ""EMPLOYEENAME"", ""MEMO"") AS 
  select a.ELABLEID,
a.ELABLENO,
a.CREDATE,
a.INPUTMANID,
a.usestatus,
pub_employee.opcode,
pub_employee.employeename,
a.MEMO
from wms_elable_def a,
     pub_employee
where a.inputmanid = pub_employee.employeeid(+)

 "
"WMS_ERP_COMPARE_QTY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ERP_COMPARE_QTY_V"" (""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""WAREHSHORTNAME"", ""GOODSOWNERID"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""GOODSOWNERSHORT"", ""OWNERGOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSOWNID"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSID"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""ERPQTY"", ""STQTY"", ""OUTQTY"", ""INQTY"", ""TRADEOUTQTY"", ""TRADEINQTY"") AS 
  select a1.warehid,
       a.warehopcode,
       a.warehname,
       a.warehshortname,
       a1.goodsownerid,
       b.goopcode,
       b.goodsownername,
       b.goodsownershort,
       a1.ownergoodsid,
       c.opcode,
       c.goodsname,
       c.goodsownid,
       c.goodstype,
       c.prodarea,
       a1.goodsid,
       a1.goodspackid,
       d.packname,
       d.packsize,
       a1.batchno,
       a1.lotid,
       e.lotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,
       e.proddate,
       e.approvedocno,
       a1.goodsstatusid,
       f.goodsstatus,
       f.quantitystatus,
       a1.erpqty,
       a1.stqty,
       a1.outqty,
       a1.inqty,
       a1.tradeoutqty,
       a1.tradeinqty
  from wms_erp_st_qty_v    a1,
       tpl_warehouse       a,
       tpl_goodsowner      b,
       tpl_goods           c,
       tpl_pub_goods_packs d,
       wms_goods_lot       e,
       wms_goodsstatus     f
 where a1.warehid = a.warehid
   and a1.goodsownerid = b.goodsownerid
   and a1.ownergoodsid = c.ownergoodsid
   and a1.goodspackid = d.goodspackid
   and a1.lotid = e.lotid
   and a1.goodsstatusid = f.goodsstatusid
"
"WMS_ERP_ST_QTY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ERP_ST_QTY_V"" (""WAREHID"", ""GOODSOWNERID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSPACKID"", ""BATCHNO"", ""LOTID"", ""GOODSSTATUSID"", ""ERPQTY"", ""STQTY"", ""OUTQTY"", ""INQTY"", ""TRADEOUTQTY"", ""TRADEINQTY"") AS 
  select a1.warehid,
       a1.goodsownerid,
       a1.ownergoodsid,
       a1.goodsid,
       a1.goodspackid,
       a1.batchno,
       a1.lotid,
       a1.goodsstatusid,
       a1.stqty + nvl(a2.outqty, 0) - nvl(a3.inqty, 0) + nvl(a4.outqty, 0) -
       nvl(a4.inqty, 0) erpqty,
       a1.stqty,
       a2.outqty,
       a3.inqty,
       a4.outqty tradeoutqty,
       a4.inqty tradeinqty
  from (select a.warehid,
               a.goodsownerid,
               a.ownergoodsid,
               a.goodsid,
               a.goodspackid,
               a.batchno,
               a.lotid,
               a.goodsstatusid,
               sum(a.goodsqty) stqty
          from wms_st_qty_lst a
         group by a.warehid,
                  a.goodsownerid,
                  a.ownergoodsid,
                  a.goodsid,
                  a.goodspackid,
                  a.batchno,
                  a.lotid,
                  a.goodsstatusid) a1,
       --出库
       (select a.warehid,
               a.goodsownerid,
               a.ownergoodsid,
               a.goodsid,
               a.goodspackid,
               a.batchno,
               a.lotid,
               a.goodsstatusid,
               0 inqty,
               sum(outgoodsqty) outqty
          from wms_st_io_doc a, wms_out_order_dtl b, wms_out_order c
         where a.comefrom = 3
           and a.usestatus = 1
           and a.sourceid = b.wavegoodsdtlid
           and b.outid = c.outid
           and c.usestatus = 3 --2 待拣货 3待复核
         group by a.warehid,
                  a.goodsownerid,
                  a.ownergoodsid,
                  a.goodsid,
                  a.goodspackid,
                  a.batchno,
                  a.lotid,
                  a.goodsstatusid) a2,
       --入库
       (select a.warehid,
               a.goodsownerid,
               a.ownergoodsid,
               a.goodsid,
               a.goodspackid,
               a.batchno,
               a.lotid,
               a.goodsstatusid,
               sum(a.ingoodsqty) inqty,
               sum(outgoodsqty) outqty
          from wms_st_io_doc    a,
               wms_receive_dtl  b,
               wms_in_order_dtl c,
               wms_in_order     d
         where a.comefrom = 1
           and a.usestatus = 1
           and a.sourceid = b.receiveid
           and b.indtlid = c.indtlid
           and c.inid = d.inid
           and d.usestatus = 2 --2 处理中
         group by a.warehid,
                  a.goodsownerid,
                  a.ownergoodsid,
                  a.goodsid,
                  a.goodspackid,
                  a.batchno,
                  a.lotid,
                  a.goodsstatusid) a3,
       --库存变动
       (select a.warehid,
               a.goodsownerid,
               a.ownergoodsid,
               a.goodsid,
               a.goodspackid,
               a.batchno,
               a.lotid,
               a.goodsstatusid,
               sum(a.ingoodsqty) inqty,
               sum(outgoodsqty) outqty
          from wms_st_io_doc a, wms_trade_dtl b, wms_trade_order c
         where a.comefrom = 4
           and a.usestatus = 1
           and a.sourceid = b.tradedtlid
           and b.tradeid = c.tradeid
           and c.usestatus = 2 --2 确认
         group by a.warehid,
                  a.goodsownerid,
                  a.ownergoodsid,
                  a.goodsid,
                  a.goodspackid,
                  a.batchno,
                  a.lotid,
                  a.goodsstatusid) a4
 where a1.warehid = a2.warehid(+)
   and a1.goodsownerid = a2.goodsownerid(+)
   and a1.ownergoodsid = a2.ownergoodsid(+)
   and a1.goodsid = a2.goodsid(+)
   and a1.goodspackid = a2.goodspackid(+)
   and a1.batchno = a2.batchno(+)
   and a1.lotid = a2.lotid(+)
   and a1.goodsstatusid = a2.goodsstatusid(+)
   and a1.warehid = a3.warehid(+)
   and a1.goodsownerid = a3.goodsownerid(+)
   and a1.ownergoodsid = a3.ownergoodsid(+)
   and a1.goodsid = a3.goodsid(+)
   and a1.goodspackid = a3.goodspackid(+)
   and a1.batchno = a3.batchno(+)
   and a1.lotid = a3.lotid(+)
   and a1.goodsstatusid = a3.goodsstatusid(+)
   and a1.warehid = a4.warehid(+)
   and a1.goodsownerid = a4.goodsownerid(+)
   and a1.ownergoodsid = a4.ownergoodsid(+)
   and a1.goodsid = a4.goodsid(+)
   and a1.goodspackid = a4.goodspackid(+)
   and a1.batchno = a4.batchno(+)
   and a1.lotid = a4.lotid(+)
   and a1.goodsstatusid = a4.goodsstatusid(+)
"
"WMS_GOODSCODE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODSCODE_V"" (""SEQID"", ""CHARGE_CODE"", ""SERIAL"", ""GROUP_NO"", ""DRUGNAME"", ""SPECIFICATION"", ""MANUFACTURE"", ""ABBR_NAME"", ""UNIT_NAME"", ""DEPT_NAME"", ""MANUFACTORY"", ""CHANGEFLAG"", ""RATE"", ""HOSRATE"", ""DOSAGE_NAME"", ""HOSPITALID"", ""GOODSID"", ""GOODSNAME"", ""OPCODE"", ""GOODSTYPE"", ""PRODAREA"") AS 
  select  a.SEQID,
        a.CHARGE_CODE,
        a.SERIAL,
        a.GROUP_NO,
        a.DRUGNAME,
        a.SPECIFICATION,
        a.MANUFACTURE,
        a.ABBR_NAME,
        a.UNIT_NAME,
        a.DEPT_NAME,
        a.MANUFACTORY,
        a.CHANGEFLAG,
        a.rate,
        a.hosrate,
        a.dosage_name,
        a.hospitalid,
        a.goodsid,
        b.goodsname,
        b.opcode,
        b.goodstype,
        b.prodarea
  from wms_goodscode a,
  tpl_pub_goods b
  where a.goodsid = b.goodsid
"
"WMS_GOODSGROUP_DTL_RF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODSGROUP_DTL_RF_V"" (""CUTDTLID"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""POSID"", ""POSNO"", ""GOODSQTY"", ""GOODSQTYTEXT"", ""GOODSOWNID"", ""USESTATUS"", ""CUTMETHOD"", ""BARCODE"") AS 
  select (select c.inoutid
          from wms_st_io_doc c
         where c.sourceid = b.outdtlid
           and a.warehid = c.warehid
           and c.comefrom = 5)  cutdtlid,
       a.warehid,
       a.goodsownerid,
       c.goodsownername,
       b.ownergoodsid,
       b.goodsid,
       (case
         when d.goodsengname is null then
          d.goodsname
         else
          d.goodsname || '(' || d.goodsengname || ')'
       end) goodsname,
       d.goodstype,
       d.factname prodarea,
       b.goodspackid,
       e.packname,
       e.packsize,
       b.batchno,
       b.lotid,
       f.lotno,
       decode(to_char(f.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              f.validdate) validdate,
       f.proddate,
       f.approvedocno,
       b.goodsstatusid,
       g.goodsstatus,
       g.quantitystatus,
       (select d.posno
          from wms_st_io_doc c,wms_pos_def d
         where c.sourceid = b.outdtlid
           and a.warehid = c.warehid
           and c.posid=d.posid(+)
           and c.comefrom = 5) posid,--显示的货位
       to_char(a.wavedtlid) posno, --暂时修改为来源ID
       (select c.goodsqty
          from wms_st_io_doc c
         where c.sourceid = b.outdtlid
           and a.warehid = c.warehid
           and c.comefrom = 5) goodsqty,
       (select c.goodsqty
          from wms_st_io_doc c
         where c.sourceid = b.outdtlid
           and a.warehid = c.warehid
           and c.comefrom = 5) goodsqtytext,
       d.goodsownid,
       (select c.usestatus
          from wms_st_io_doc c
         where c.sourceid = b.outdtlid
           and a.warehid = c.warehid
           and c.comefrom = 5) usestatus,
       1 cutmethod,
       '' barcode
  from wms_out_order     a,
       wms_out_order_dtl b,
       tpl_goodsowner    c,
       tpl_goods         d,
       tpl_pub_goods_packs e,
       wms_goods_lot       f,
       wms_goodsstatus     g
 where a.outid = b.outid
   and a.operationtype in (61,62)
   and a.usestatus = 4
   and a.goodsownerid=c.goodsownerid(+)
   and b.ownergoodsid=d.ownergoodsid(+)
   and b.goodspackid=e.goodspackid(+)
   and b.lotid=f.lotid(+)
   and b.goodsstatusid=g.goodsstatusid(+)
"
"WMS_GOODSGROUP_ORDER_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODSGROUP_ORDER_DTL_V"" (""GROUPORDERID"", ""GROUPORDERDTLID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""TRADEPACKNAME"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""QUANTITYSTATUS"", ""GOODSSTATUS"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""ERPDTLID"", ""USESTATUS"", ""DTLMEMO"") AS 
  select a.grouporderid,
       a.grouporderdtlid,
       a.ownergoodsid,
       a.goodsid,
       b.goodsname,
       b.goodsengname,
       b.goodstype,
       b.prodarea,
       b.factname,
       b.tradepackname,
       a.batchno,
       a.lotid,
       a.lotno,
       a.proddate,
       a.validdate,
       a.approvedocno,
       a.goodsstatusid,
       a.quantitystatus,
       c.goodsstatus,
       a.goodsqty,
       a.goodspackid,
       d.packname,
       d.packsize,
       a.erpdtlid,
       a.usestatus,
       a.dtlmemo
  from wms_goodsgroup_order_dtl a,
       tpl_goods                b,
       wms_goodsstatus          c,
       tpl_pub_goods_packs      d
 where a.ownergoodsid = b.ownergoodsid(+)
   and a.goodsstatusid = c.goodsstatusid(+)
   and a.goodspackid = d.goodspackid(+)
"
"WMS_GOODSGROUP_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODSGROUP_ORDER_V"" (""GROUPORDERID"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CREDATE"", ""CONFIRMDATE"", ""FINSISHDATE"", ""USESTATUS"", ""OPERATIONTYPE"", ""MEMO"", ""INPUTMANID"", ""INPUTMANNAME"", ""ERPDOCID"", ""GROUPID"", ""CONFIRMMANID"", ""CONFIRMMAN"", ""COMPANYID"", ""COMPANYNAME"") AS 
  select a.grouporderid,
       a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.credate,
       a.confirmdate,
       a.finsishdate,
       a.usestatus,
       a.operationtype,
       a.memo,
       a.inputmanid,
       a.inputmanname,
       a.erpdocid,
       a.groupid,
       a.confirmmanid,
       d.employeename confirmman,
       a.companyid,
       e.companyname
  from WMS_GOODSGROUP_ORDER a,
       tpl_warehouse        b,
       tpl_goodsowner       c,
       pub_employee         d,
       tpl_go_company       e
 where a.warehid = b.warehid(+)
   and a.goodsownerid=c.goodsownerid(+)
   and a.confirmmanid=d.employeeid(+)
   and a.companyid=e.companyid(+)
"
"WMS_GOODSOWNER_STATISTCS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODSOWNER_STATISTCS_V"" (""SEQID"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""WAREHID"", ""WAREHNAME"", ""WAREHOPCODE"", ""OUTORDERS"", ""OUTGOODS"", ""OUTCOMPANY"", ""OUTWHOLEPACKS"", ""OUTSCATTERPACKS"", ""INORDERS"", ""INGOODS"", ""INCOMPANY"", ""INWHOLEPACKS"", ""INSCATTERQTY"", ""TRADEORDERS"", ""TRADEGOODS"", ""UPTASK"", ""DOWNTASK"", ""TRADETASK"", ""POS"", ""POSTP"", ""POSWHOLE"", ""POSSCATTER"") AS 
  select
  s.SEQID,
  s.CREDATE,
  s.GOODSOWNERID ,
  g.goodsownername,
  g.goopcode,
  s.WAREHID,
  w.warehname,
  w.warehopcode,
  s.OUTORDERS,
  s.OUTGOODS  ,
  s.OUTCOMPANY  ,
  s.OUTWHOLEPACKS ,
  s.OUTSCATTERPACKS,
  s.INORDERS,
  s.INGOODS,
  s.INCOMPANY,
  s.INWHOLEPACKS,
  s.INSCATTERQTY,
  s.TRADEORDERS,
  s.TRADEGOODS,
  s.UPTASK,
  s.DOWNTASK,
  s.TRADETASK,
  s.POS,
  s.POSTP,
  s.POSWHOLE,
  s.POSSCATTER

  from  WMS_GOODSOWNER_STATISTCS s ,tpl_goodsowner  g,tpl_warehouse w
    where s.goodsownerid = g.goodsownerid(+)
  and s.warehid = w.warehid(+)
"
"WMS_GOODSOWNER_TO_SECTION_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODSOWNER_TO_SECTION_V"" (""WAREHID"", ""LSTID"", ""GOODSOWNERID"", ""SECTIONID"", ""SORTTYPE"", ""SECTIONNO"", ""SECTIONNAME"", ""AREAID"", ""AREANAME"", ""PRIORITY"", ""AREAFLAG"") AS 
  select b.warehid,
       b.lstid,
       b.goodsownerid,
       b.sectionid,
       a.sorttype,
       a.sectionno,
       a.sectionname,
       a.areaid,
       d.areaname,
       b.priority,
       d.areaflag
  from wms_goodsowner_to_section b,
       wms_st_section_def        a,
       wms_st_area_def           d
 where a.sectionid = b.sectionid(+)
   and a.areaid = d.areaid(+)

 "
"WMS_GOODSSTATUS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODSSTATUS_V"" (""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""USESTATUS"", ""WMSSTATUS"") AS 
  select goodsstatusid,
       goodsstatus,
       quantitystatus,
       useflag,
       usestatus,
       wmsstatus --add by xyue 2016-01-07 增加物流形态
  from wms_goodsstatus
"
"WMS_GOODSSTATUS_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODSSTATUS_V1"" (""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""QUANTITYSTATUSTEXT"", ""USEFLAG"", ""USEFLAGTEXT"", ""USESTATUS"") AS 
  select t.goodsstatusid,
       t.goodsstatus,
       t.quantitystatus,
       tt.ddlname quantitystatustext,
       t.useflag,
       ttt.ddlname useflagtext,
       t.usestatus
  from wms_goodsstatus t,pub_ddl_dtl tt,sys_ddl_dtl ttt
  where tt.sysid=11
  and   t.quantitystatus=tt.ddlid(+)
  and   ttt.sysid=456
  and   t.useflag=ttt.ddlid(+)
"
"WMS_GOODS_ALLOCATE_RULE_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODS_ALLOCATE_RULE_DTL_V"" (""RULEID"", ""RULEDTLID"", ""SECTIONID"", ""PRIORITY"", ""SECTIONNO"", ""SECTIONNAME"") AS 
  select a.ruleid,
       a.ruledtlid,
        a.sectionid,
       a.priority,
       b.sectionno,
       b.sectionname
  from WMS_GOODS_ALLOCATE_RULE_DTL a,
       wms_st_section_def       b
 where a.sectionid = b.sectionid(+)

 "
"WMS_GOODS_ALLOCATE_RULE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODS_ALLOCATE_RULE_V"" (""WAREHID"", ""RULEID"", ""CLASS_SET"", ""PICKRATE_SET"", ""GOODSSTATUS_SET"", ""CLASS_SETS"", ""PICKRATE_SETS"", ""GOODSSTATUS_SETS"", ""OPLEVEL"", ""WAREHNAME"") AS 
  select a.warehid,
       a.ruleid,
       a.class_set,
       a.pickrate_set,
       a.goodsstatus_set,
       a.class_sets,
       a.pickrate_sets,
       a.goodsstatus_sets,
       a.oplevel,
       b.warehname
  from WMS_GOODS_ALLOCATE_RULE a,
  tpl_warehouse        b
 where a.warehid = b.warehid(+)

 "
"WMS_GOODS_CENTER_PACK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODS_CENTER_PACK_V"" (""GOODSID"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSWEIGHT"", ""WEIGHTUNIT"", ""BASEPACKID"", ""BASENAME"", ""BASESIZE"", ""BASEPACKSIZE"", ""GOODSOWNERID"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""OWNGOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""USESTATUS"", ""CREATEDATE"", ""CREATEMANID"", ""CREATEMAN"", ""MEMO"") AS 
  select a.goodsid,
         a.goodspackid,
         a.packname,
         a.packsize,
         a.goodslength,
         a.goodswidth,
         a.goodsheight,
         a.goodsweight,
         a.weightunit,
         a.basepackid,
         b.packname basename,
         b.packsize basesize,
         a.basepacksize,
         a.goodsownerid,
         d.goopcode,
         d.goodsownername,
         a.owngoodsid,
         c.opcode,
         c.goodsname,
         c.goodstype,
         a.usestatus,
         a.createdate,
         a.createmanid,
         e.employeename createman,
         a.memo
    from wms_goods_center_pack a,
         tpl_pub_goods_packs b,
         tpl_goods c ,
         tpl_goodsowner d,
         pub_employee e
    WHERE a.basepackid = b.goodspackid
    AND a.goodsownerid = d.goodsownerid
    AND a.owngoodsid = c.ownergoodsid
    AND a.createmanid = e.employeeid(+)

 "
"WMS_GOODS_CHECK_RULE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODS_CHECK_RULE_V"" (""RULEID"", ""WAREHID"", ""WAREHNAME"", ""WAREHOPCODE"", ""L_PERIOD"", ""S_PERIODUNIT"", ""CHECKMONTHES"") AS 
  select a.ruleid,
       a.warehid,
       b.warehname,
       b.warehopcode,
       a.l_period,
       a.s_periodunit,
       a.checkmonthes
from wms_goods_check_rule a,tpl_warehouse b
where a.warehid = b.warehid
"
"WMS_GOODS_DEF_POS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODS_DEF_POS_V"" (""DEFID"", ""GOODSOWNERID"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""POSID"", ""POSNO"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""WAREHID"") AS 
  select a.defid,
       a.goodsownerid,
       b.goopcode,
       b.goodsownername,
       a.goodsid,
       c.opcode goodsopcode,
       c.goodsname,
       c.goodstype,
       c.prodarea,
       d.companyname factname,
       a.posid,
       f.posno,
       a.sectionid,
       e.sectionno,
       e.sectionname,
       g.warehid
  from wms_goods_def_pos a,
       tpl_goodsowner    b,
       tpl_pub_goods     c,
       tpl_pub_company   d,
       wms_st_section_def e,
       wms_pos_def     f,
       wms_st_area_def g
 where a.goodsownerid = b.goodsownerid(+)
   and a.posid = f.posid(+)
   and a.goodsid = c.goodsid(+)
   and c.factid = d.companyid(+)
   and a.sectionid = e.sectionid(+)
   and f.areaid = g.areaid(+)
"
"WMS_GOODS_FEATURE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODS_FEATURE_V"" (""FEATUREID"", ""WAREHID"", ""GOODSID"", ""GOODSCLASS"", ""SCATTERPICKRATE"", ""WHOLEPICKRATE"", ""BOXGOODSQTY"", ""TRANSCLASS"", ""PREBOXQTY"", ""GOODSCLASSMEMO"", ""SCATTERPICKRATEMEMO"", ""WHOLEPICKRATEMEMO"", ""BOXGOODSQTYMEMO"", ""TRANSCLASSMEMO"", ""MEMO"", ""WAREHNAME"", ""OPCODE"", ""GOODSNAME"", ""PRODAREA"", ""GOODSTYPE"", ""FACTNAME"", ""DTMFL"", ""MAH"") AS 
  select a.FEATUREID,
       a.WAREHID,
       a.GOODSID,
       a.GOODSCLASS,
       a.SCATTERPICKRATE,
       a.WHOLEPICKRATE,
       a.BOXGOODSQTY,
       a.transclass,
       a.preboxqty,
       a.goodsclassmemo,
       a.scatterpickratememo,
       a.wholepickratememo,
       a.boxgoodsqtymemo,
       a.transclassmemo,
       a.MEMO,
       b.warehname,
       c.opcode,
       c.goodsname,
       c.prodarea,
       c.goodstype,
       d.companyname factname,
       NULL dtmfl,
       c.mah --add by xyue 2019-08-22 上市许可持有人
  from wms_goods_feature a,
       tpl_warehouse     b,
       tpl_pub_goods     c,
       tpl_pub_company   d
 where a.warehid = b.warehid
 and a.goodsid = c.goodsid(+)
 and c.factid = d.companyid(+)
"
"WMS_GOODS_LOT_CONSERVE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODS_LOT_CONSERVE_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSFORMALNAME"", ""PRODAREA"", ""FACTID"", ""COMPANYNAME"", ""LOTNO"", ""DRUGFORM"", ""DRUGFORMNO"", ""GOODSQTYPE"", ""LOTID"", ""CONSERVEDATE"", ""LOTVALIDDATE"", ""APPROVEDOCNO"", ""PRODDATE"", ""JKHZFLAG"", ""COMPANYOPCODE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""POSID"", ""POSNAME"", ""POSNO"") AS 
  select wms_goods_lot_conserve.warehid,
       tpl_warehouse.warehname,
       wms_goods_lot_conserve.goodsid,
       tpl_pub_goods.opcode,
       tpl_pub_goods.goodsname,
       tpl_pub_goods.goodsformalname,
       tpl_pub_goods.prodarea,
       tpl_pub_goods.factid,
       tpl_pub_company.companyname,
       wms_goods_lot.lotno,
       tpl_drugform.drugform,
       tpl_drugform.drugformno,
       tpl_pub_goods.goodstype goodsqtype,
       wms_goods_lot_conserve.lotid,
       wms_goods_lot_conserve.conservedate,
       decode(to_char(wms_goods_lot.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              wms_goods_lot.validdate) lotvaliddate,
       wms_goods_lot.approvedocno,
       wms_goods_lot.proddate,
       tpl_pub_goods.jkhzflag,
       tpl_pub_company.companyopcode,
       wms_goods_lot_conserve.goodsownerid,
       tpl_goodsowner.goodsownername,
       wms_goods_lot_conserve.posid, --add by weitangjing 20130926 货位ID
       po.posname, --add by weitangjing 20130926 货位
       po.posno --add by weitangjing 20130926 货位编码
  from wms_goods_lot_conserve,
       tpl_warehouse,
       tpl_pub_goods,
       tpl_pub_company,
       tpl_drugform,
       wms_goods_lot,
       tpl_goodsowner,
       wms_pos_def po --add by weitangjing 20130926
 where wms_goods_lot_conserve.warehid = tpl_warehouse.warehid(+)
   and wms_goods_lot_conserve.goodsid = tpl_pub_goods.goodsid(+)
   and tpl_pub_goods.factid = tpl_pub_company.companyid(+)
   and tpl_drugform.drugformno(+) = tpl_pub_goods.drugform
   AND wms_goods_lot_conserve.lotid = wms_goods_lot.lotid(+)
   AND wms_goods_lot_conserve.goodsownerid = tpl_goodsowner.goodsownerid(+)
   and wms_goods_lot_conserve.posid = po.posid(+)
"
"WMS_GOODS_LOT_MODIFY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODS_LOT_MODIFY_V"" (""LOTID"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTNAME"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""PRODLICENSENO"", ""CONSERVEDATE"", ""MEMO"", ""YJDPIC"", ""CREDATE"", ""PRINTMONTHFLAG"", ""PRINTEXPIREFLAG"", ""BARCODE"", ""LSH"", ""MAH"") AS 
  select a.lotid,
       a.goodsid,
       b.opcode,
       b.goodsname,
       b.goodstype,
       b.prodarea,
       b.factid,
       a.factname,
       a.lotno,
       a.killlotno,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.proddate,
       a.approvedocno,
       a.registno,
       a.prodlicenseno,
       a.conservedate,
       a.memo,
       Null yjdpic,
       a.credate,
       a.printmonthflag,
       a.printexpireflag,--add by xyue 2020-11-10
       a.barcode, --条码形 add by zyc 20150710
       a.lsh,
       a.mah --上市许可持有人
  from wms_goods_lot a, tpl_pub_goods b, tpl_pub_company c
 where a.goodsid = b.goodsid
   and b.factid = c.companyid(+)
"
"WMS_GOODS_LOT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODS_LOT_V"" (""LOTID"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTNAME"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""PRODLICENSENO"", ""CONSERVEDATE"", ""MEMO"", ""YJDPIC"", ""CREDATE"", ""PRINTMONTHFLAG"", ""PRINTEXPIREFLAG"", ""BARCODE"", ""LSH"", ""MAH"", ""PRINTPRODFLAG"", ""PRODMONTHFLAG"", ""VALIDDATE2"") AS 
  select a.lotid,
       a.goodsid,
       b.opcode,
       b.goodsname,
       b.goodstype,
       b.prodarea,
       b.factid,
       a.factname,
       a.lotno,
       a.killlotno,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.proddate,
       a.approvedocno,
       a.registno,
       a.prodlicenseno,
       a.conservedate,
       a.memo,
       Null yjdpic,
       a.credate,
       nvl(a.printmonthflag,0) printmonthflag,
       nvl(a.printexpireflag,0) printexpireflag,--add by xyue 2020-11-10
       a.barcode, --条码形 add by zyc 20150710
       a.lsh,
       a.mah, --上市许可持有人
       nvl(a.printprodflag,0) printprodflag,
       nvl(a.prodmonthflag,0) prodmonthflag,
       a.validdate2
  from wms_goods_lot a, tpl_pub_goods b, tpl_pub_company c
 where a.goodsid = b.goodsid
   and b.factid = c.companyid(+)
"
"WMS_GOODS_QTYLIMIT_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODS_QTYLIMIT_DEF_V"" (""DEFID"", ""AREAID"", ""SECTIONID"", ""OWNERGOODSID"", ""MINQTY"", ""MAXQTY"", ""STANDARDQTY"", ""USESTATUS"", ""AREANO"", ""AREANAME"", ""AREATYPE"", ""SECTIONNO"", ""SECTIONNAME"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""GOODSID"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""WAREHID"", ""WAREHNAME"") AS 
  select t.defid,
      t.areaid,
      t.sectionid,
      t.ownergoodsid,
      t.minqty,
      t.maxqty,
      t.standardqty,
      t.usestatus,
      a.areano,
      a.areaname,
      a.areatype,
      b.sectionno,
      b.sectionname,
      c.opcode,
      c.goodsname,
      c.goodstype,
      c.prodarea,
      c.factname,
      t.goodsid,
      t.goodspackid,
      e.packname,
      e.packsize,
      t.goodsownerid,
      f.goodsownername,
      t.warehid,
      d.warehname
  from wms_goods_qtylimit_def    t,
       tpl_goodsowner            f,
        wms_st_area_def           a,
        wms_st_section_def        b,
        tpl_goods                 c,
        tpl_warehouse             d,
        tpl_pub_goods_packs       e
  where t.areaid = a.areaid(+)
    and t.sectionid = b.sectionid(+)
    and t.ownergoodsid = c.ownergoodsid(+)
    and t.warehid = d.warehid(+)
    and t.goodspackid = e.goodspackid(+)
    and t.goodsownerid = f.goodsownerid(+)

 "
"WMS_GOODS_REPLENISHMENT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODS_REPLENISHMENT_V"" (""WAREHID"", ""SETUPID"", ""SECTIONID"", ""SOURCESECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""AREAID"", ""AREANAME"", ""PRIORITY"", ""AUTOFLAG"", ""UPDOWNFLAG"") AS 
  select d.warehid,
       a.SETUPID,
       a.SECTIONID,
       a.sourcesectionid,
       b.sectionno,
       b.sectionname,
       b.areaid,
       d.areaname,
       a.priority,
       a.AUTOFLAG,
       a.updownflag
  from WMS_GOODS_REPLENISHMENT a,
       wms_st_section_def        b,
       wms_st_area_def           d
 where a.sourcesectionid = b.sectionid(+)
   and b.areaid = d.areaid(+)
"
"WMS_GOODS_STORE_RULE_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODS_STORE_RULE_DTL_V"" (""RULEID"", ""RULEDTLID"", ""SECTIONID"", ""PRIORITY"", ""SECTIONNO"", ""SECTIONNAME"", ""SORTTYPE"", ""AREAID"", ""AREANO"", ""AREANAME"", ""AREAFLAG"") AS 
  select a.ruleid,
       a.ruledtlid,
        a.sectionid,
       a.priority,
       b.sectionno,
       b.sectionname,
       b.sorttype,
       c.areaid,
       c.areano,
       c.areaname,
       c.areaflag
  from wms_goods_store_rule_dtl a,
       wms_st_section_def       b,
       wms_st_area_def          c
 where a.sectionid = b.sectionid(+)
 and b.areaid = c.areaid(+)
"
"WMS_GOODS_STORE_RULE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODS_STORE_RULE_V"" (""WAREHID"", ""RULEID"", ""CLASS_SET"", ""PICKRATE_SET"", ""GOODSSTATUS_SET"", ""CLASS_SETS"", ""PICKRATE_SETS"", ""GOODSSTATUS_SETS"", ""STORELEVEL"", ""WAREHNAME"") AS 
  select a.warehid,
       a.ruleid,
       a.class_set,
       a.pickrate_set,
       a.goodsstatus_set,
       a.class_sets,
       a.pickrate_sets,
       a.goodsstatus_sets,
       a.storelevel,
       b.warehname
  from wms_goods_store_rule a,
       tpl_warehouse        b
 where a.warehid = b.warehid(+)

 "
"WMS_GOODS_STORE_UNUSUAL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODS_STORE_UNUSUAL_V"" (""RULEID"", ""PICKRATE_SET"", ""RATE"", ""CLASS_SET"", ""GOODSCLASS"", ""GOODSSTATUS_SET"", ""GOODSSTATUSID"", ""AREAFLAG"", ""STORELEVEL"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""LOTID"", ""LOTNO"", ""POSID"", ""POSNO"", ""SECTIONID"", ""SECTIONNAME"", ""AREAID"", ""AREANAME"", ""GOODSQTY"", ""BUSIQTY"", ""PCS"") AS 
  select d.ruleid,
       d.pickrate_set,
       decode(a.areaflag, 2, b.scatterpickrate, b.wholepickrate) rate,
       d.class_set,
       b.goodsclass,
       d.goodsstatus_set,
       a.goodsstatusid,
       a.areaflag,
       d.storelevel,
       a.goodsid,
       a.goodsname,
       a.goodstype,
       a.lotid,a.lotno,
       a.posid,a.posno,
       a.sectionid, a.sectionname,
       a.areaid,a.areaname,
       a.goodsqty,a.busiqty,
       a.pcs
  from wms_st_qty_lst_v           a,
       wms_goods_feature        b,
       wms_goodsstatus          c,
       wms_goods_store_rule     d,
       wms_goods_store_rule_dtl e
 where a.goodsid = b.goodsid
   and a.goodsstatusid = c.goodsstatusid
   and d.ruleid = e.ruleid
   and a.sectionid = e.sectionid
   and a.areaflag = d.storelevel
   and a.warehid = b.warehid
   and a.warehid = d.warehid
   and (instr(',' || d.pickrate_set || ',',
              ',' || to_char(decode(a.areaflag,
                                    2,
                                    b.scatterpickrate,
                                    b.wholepickrate)) || ',') = 0 or
       instr(',' || d.class_set || ',',
              ',' || to_char(b.goodsclass) || ',') = 0 or
       instr(',' || d.goodsstatus_set || ',',
              ',' || to_char(c.goodsstatusid) || ',') = 0)
"
"WMS_GOODS_TO_POSTYPE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODS_TO_POSTYPE_V"" (""DEFID"", ""WAREHID"", ""GOODSID"", ""GOODSPACKID"", ""POSTYPE"", ""TYPENAME"", ""STORELEVEL"", ""TRAYNUM"", ""GOODSUSEQTY"", ""LAYERCOUNT"", ""ROCKBOTTOM"", ""WAREHNAME"", ""OPCODE"", ""GOODSNAME"", ""PRODAREA"", ""GOODSTYPE"", ""FACTNAME"", ""PACKNAME"", ""PACKSIZE"") AS 
  select a.defid,
       a.warehid,
       a.goodsid,
       a.goodspackid,
       a.postype,
       e.typename,
       e.storelevel,
       e.traynum,
       a.goodsuseqty,
       a.layercount,
       a.rockbottom,
       b.warehname,
       c.opcode,
       c.goodsname,
       c.prodarea,
       c.goodstype,
       f.companyname factname,
       d.packname,
       d.packsize
  from Wms_goods_to_postype a,
       tpl_warehouse        b,
       tpl_pub_goods        c,
       tpl_pub_company      f,
       tpl_pub_goods_packs  d,
       wms_pos_type         e
 where a.warehid = b.warehid(+)
   and a.goodsid = c.goodsid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.postype = e.typeid(+)
   and c.factid = f.companyid(+)

 "
"WMS_GOODS_TO_SECTION_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODS_TO_SECTION_V"" (""WAREHID"", ""DEFID"", ""GOODSID"", ""SECTIONID"", ""POSCOUNT"", ""OPCODE"", ""GOODSNAME"", ""PRODAREA"", ""GOODSTYPE"", ""WAREHNAME"") AS 
  select a.warehid,
       a.defid,
       a.goodsid,
       a.sectionid,
       a.poscount,
       b.opcode,
       b.goodsname,
       b.prodarea,
       b.goodstype,
       c.warehname
  from wms_goods_to_section a,
       tpl_pub_goods        b,
       tpl_warehouse        c
 where a.warehid = c.warehid(+)
   and a.goodsid = b.goodsid(+)

 "
"WMS_GOODS_TRADE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GOODS_TRADE_V"" (""WAREHID"", ""GOODSOWNERID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSPACKID"", ""POSID"", ""BATCHNO"", ""LOTID"", ""GOODSQTY"", ""BUSIQTY"", ""POSQTY"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""PACKNAME"", ""PACKSIZE"", ""POISON_DRUG"", ""POSNO"", ""POSNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSOWNID"", ""APPROVEDOCNO"", ""IWCS_FLAG"") AS 
  select a.warehid,
       a.goodsownerid,
       a.ownergoodsid,
       a.goodsid,
       a.goodspackid,
       a.posid,
       a.batchno,
       a.lotid,
       a.goodsqty,
       (nvl(a.busiqty,0) - nvl(a.outwaitqty,0))busiqty,
       a.posqty,
       a.goodsstatusid,
       c.goodsstatus,
       c.quantitystatus,
       b.opcode goodsopcode,
       b.goodsname,
       b.goodstype,
       b.prodarea,
       d.packname,
       d.packsize,
       b.poison_drug,
       i.posno,
       i.posname,
       i.areaid,
       i.areano,
       i.areaname,
       i.sectionid,
       i.sectionno,
       i.sectionname,
       f.lotno,
       decode(to_char(f.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              f.validdate) validdate,
       f.proddate,
       e.goodsownid,
       f.approvedocno,
       i.iwcs_flag
  from wms_st_qty_lst      a,
       tpl_goods           e,
       tpl_pub_goods       b,
       tpl_pub_goods_packs d,
       wms_goods_lot       f,
       wms_pos_def_v         i,
       wms_goodsstatus       c
 where a.goodsid = b.goodsid(+)
   and a.goodsstatusid = c.goodsstatusid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.posid = i.posid(+)
   and a.lotid = f.lotid(+)
   and a.ownergoodsid = e.ownergoodsid
"
"WMS_GO_BILL_COST_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GO_BILL_COST_DOC_V"" (""DOCID"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CREDATE"", ""BILLMODEL"", ""USEMM"", ""USEYEAR"", ""USEMONTH"") AS 
  select a.docid, --总单ID
       a.warehid, --物流中心ID
       c.warehname, --物流中心
       a.goodsownerid, --货主ID
       b.goodsownername, --货主名称
       a.credate, --创建日期
       a.billmodel, --类型
       a.usemm,--逻辑月
       a.useyear,--年
       a.usemonth --月
            from wms_go_bill_cost_doc a, tpl_goodsowner b, tpl_warehouse c
                 where a.goodsownerid = b.goodsownerid(+)
                 and a.warehid = c.warehid(+)
"
"WMS_GO_BILL_COST_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GO_BILL_COST_DTL_V"" (""DOCID"", ""DTLID"", ""JOBTYPEID"", ""OPERATIONTYPE"", ""COMEFROM"", ""POSTYPE"", ""UNITPRICE"", ""UNITTPYE"", ""QTY"", ""JOBCOST"", ""DTLMEMO"") AS 
  select a.docid, --总单ID
               a.dtlid, --细单ID
               a.jobtypeid, --计费项目
               a.operationtype, --业务类型
               a.comefrom, --计费依据
               a.postype, --货位类型
               a.unitprice, --服务单价
               a.unittpye, --计费单位
               a.qty, --数量
               a.jobcost, --计费项目费用
               a.dtlmemo --细单备注
          from wms_go_bill_cost_dtl a
"
"WMS_GO_BILL_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GO_BILL_DOC_V"" (""DOCID"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CREDATE"", ""INPUTMANID"", ""INPUTMAN"", ""MEMO"", ""BILLMODEL"") AS 
  select a.docid, --配置总单ID
       a.warehid, --物流中心ID
       c.warehname, --物流中心
       a.goodsownerid, --货主ID
       b.goodsownername, --货主名称
       a.credate, --创建日期
       a.inputmanid, --录入人ID
       d.employeename inputman, --录入人
       a.memo, --备注
       a.billmodel --类型
  from WMS_GO_BILL_DOC a, tpl_goodsowner b, tpl_warehouse c, pub_employee d
 where a.goodsownerid = b.goodsownerid(+)
   and a.warehid = c.warehid(+)
   and a.inputmanid = d.employeeid(+)
"
"WMS_GO_BILL_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GO_BILL_DTL_V"" (""DOCID"", ""DTLID"", ""DTLCREDATE"", ""DTLINPUTMANID"", ""DTLINPUTMAN"", ""DTLMEMO"", ""JOBTYPEID"", ""OPERATIONTYPE"", ""COMEFROM"", ""POSTYPE"", ""UNITPRICE"", ""UNITTPYE"") AS 
  select a.docid, --配置总单ID
       a.dtlid, --配置细单ID
       a.dtlcredate, --创建时间
       a.dtlinputmanid, --创建人ID
       b.employeename dtlinputman, --创建人
       a.dtlmemo, --细单备注
       a.jobtypeid, --计费项目
       a.operationtype, --业务类型
       a.comefrom, --计费依据
       a.postype, --货位类型
       a.unitprice, --服务单价
       a.unittpye --计费单位
  from WMS_GO_BILL_DTL a, pub_employee b
 where a.dtlinputmanid = b.employeeid(+)
"
"WMS_GROUP_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GROUP_DEF_V"" (""GROUPID"", ""GROUPNO"", ""GROUPNAME"", ""PACKSPERDAY"", ""MEMO"", ""WAREHID"", ""WAREHNAME"") AS 
  select a.groupid,
       a.groupno,
       a.groupname,
       a.packsperday,
       a.memo,
       a.warehid,
       b.warehname
  from wms_group_def a,
       tpl_warehouse b
 where a.warehid = b.warehid

 "
"WMS_GROUP_MAN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GROUP_MAN_V"" (""GROUPMANID"", ""GROUPID"", ""EMPLOYEEID"", ""OPCODE"", ""EMPLOYEENAME"", ""RF_NO"", ""USESTATUS"", ""MEMO"") AS 
  select a.groupmanid,
       a.groupid,
       a.employeeid,
       b.opcode,
       b.employeename,
       b.rf_no,
       b.usestatus,
       a.memo
  from wms_group_man     a,
       Wms_rf_operator_v b
 where a.employeeid = b.employeeid(+)

 "
"WMS_GSPCHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_GSPCHECK_V"" (""RECEIVEID"", ""RECEIVEDATE"", ""CHECKDATE"", ""INDTLID"", ""RECEIVEDETAILID"", ""WAREHID"", ""OWNERGOODSID"", ""OWNERGOODSNAME"", ""OWNERGOODSOPCODE"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""GOODSPACKID"", ""GOODSPACKNAME"", ""PACKSIZE"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSCUBAGE"", ""GOODSWEIGHT"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""PRODDATE"", ""PRODLICENSENO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""GOODSOWNID"", ""STORAGECONDITION"", ""RECMEMO"", ""FACEQUALITY"", ""PACKQUALITY"", ""TRANSTEMP"", ""IMPORTREPFLAG"", ""PASSGATEFLAG"", ""REGISTEFLAG"", ""MEDCHECKFLAG"", ""ELIGIBILITYFLAG"", ""APPROVEDOCNO"", ""REGISTNO"", ""RPTNO"", ""BACKWHYID"", ""CHECKMANID1"", ""CHECKMAN1"", ""CHECKMANID2"", ""CHECKMAN2"", ""CHECKDOCNO"", ""LQCCHECK"", ""PASSGATENO"", ""PIJIANNO"", ""QUCHECKID"", ""LPNCODE"", ""CONTAINERID"", ""CONTAINERNO"", ""TYPEID"", ""QUCHECKNAME"", ""INPUTMANID"", ""SORTTYPE"", ""TRAYSECTIONID"", ""TRAYSECTIONNO"", ""TRAYSECTIONNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""WHOLESECTIONID"", ""WHOLESECTIONNO"", ""WHOLESECTIONNAME"", ""SENDNO"", ""USESTATUS"", ""RULINGFLAG"", ""GSPFLAG"", ""RECEIVETYPE"", ""STATUSREASON"", ""L_PERIOD"", ""S_PERIODUNIT"", ""CHECKMEMO"", ""INID"", ""SOURCECOMPANYID"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""PORDERSTATUS"", ""ORDERSTATUS"", ""MUSESTATUS"", ""DUSESTATUS"", ""ORDERMEMO"", ""MINTRADNAME"") AS 
  select a.receiveid,
       a.receivedate,
       a.checkdate,
       a.indtlid,
       a.receivedetailid,
       a.warehid,
       a.ownergoodsid,
       h.goodsname ownergoodsname,
       h.opcode ownergoodsopcode,
       a.goodsid,
       c.opcode,
       c.goodsname,
       h.goodstype,
       h.prodarea,
       h.factname,
       a.goodspackid,
       a.goodspackname,
       a.packsize,
       a.goodslength,
       a.goodswidth,
       a.goodsheight,
       a.goodscubage,
       a.goodsweight,
       a.batchno,
       a.lotid,
       a.lotno,
       a.killlotno,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.proddate,
       a.prodlicenseno,
       a.goodsstatusid,
       e.goodsstatus,
       a.quantitystatus,
       a.goodsqty,
       a.wholeqty,
       a.scatterqty,
       h.goodsownid,
       h.storagecondition,
       a.recmemo,
       a.facequality,
       a.packquality,
       a.transtemp,
       a.importrepflag,
       a.passgateflag, -- 通关单
       a.registeflag, --  注册证
       a.medcheckflag, -- 药检证标志
       a.eligibilityflag, --  合格证标志
       a.approvedocno, --  批准文号
       a.registno, -- 进口注册证号
       a.rptno, --  岸检验报告编号
       a.backwhyid, -- 退货原因
       a.checkmanid1, --   验收员A
       a.checkman1,
       a.checkmanid2, --  验收员B
       a.checkman2,
       a.checkdocno, --检验单号
       a.lqccheck,--可见异物检验
       a.passgateno,--通关单号
       a.pijianno,--批件号
       a.qucheckid, --检查部门ID
       a.lpncode,
       a.containerid,
       s.containerno,
       s.typeid,
       o.companyname qucheckname,
       a.inputmanid,
       a.sorttype,
       a.traysectionid,
        t.sectionno traysectionno,
       t.sectionname traysectionname,
       a.sectionid,
       p.sectionno,
       p.sectionname,
       a.wholesectionid ,
       r.sectionno wholesectionno,
       r.sectionname wholesectionname,
       a.sendno,
       a.usestatus,
       a.rulingflag,
       a.gspflag,
       a.receivetype,
       a.statusreason,
       c.l_period,
       c.s_periodunit,
       a.checkmemo,
       i.inid,
       j.sourcecompanyid,
       q.companyname,
       j.operationtype,
       i.porderstatus,
       j.usestatus orderstatus,
       NULL musestatus,
       NULL dusestatus,
       j.memo ordermemo,
       t2.packname mintradname
  from wms_receive_dtl          a,
       wms_goods_lot            b,
       tpl_pub_goods            c,
       tpl_pub_company          f,
       tpl_pub_goods_packs      d,
       wms_goodsstatus          e,
       tpl_goods                h,
       pub_company              o,
       wms_st_section_def       p,
       wms_st_section_def       r,
       wms_container_def        s,
       wms_st_section_def       t,
       wms_in_order_dtl         i,
       wms_in_order             j,
       tpl_go_company           q,
       tpl_pub_goods_packs      t2
 where a.lotid = b.lotid(+)
   and a.goodsid = c.goodsid
   and a.goodspackid = d.goodspackid(+)
   and a.goodsstatusid = e.goodsstatusid(+)
   and a.ownergoodsid = h.ownergoodsid
   and a.qucheckid = o.companyid(+)
   and a.sectionid = p.sectionid(+)
   and a.wholesectionid = r.sectionid(+)
   and a.containerid = s.containerid(+)
   and c.factid = f.companyid(+)
   and a.traysectionid = t.sectionid(+)
   AND a.indtlid = i.indtlid
   AND i.inid = j.inid
   AND j.sourcecompanyid = q.companyid
   AND nvl(j.nowlflag,0)<>1
   and a.goodsid = t2.goodsid and t2.baseunitflag = 1  ---20110809 ltx增加基本包装单位

UNION ALL

select a.receiveid,
       a.receivedate,
       a.checkdate,
       a.indtlid,
       a.receivedetailid,
       a.warehid,
       a.ownergoodsid,
       h.goodsname ownergoodsname,
       h.opcode ownergoodsopcode,
       a.goodsid,
       c.opcode,
       c.goodsname,
       h.goodstype,
       h.prodarea,
       h.factname,
       a.goodspackid,
       a.goodspackname,
       a.packsize,
       a.goodslength,
       a.goodswidth,
       a.goodsheight,
       a.goodscubage,
       a.goodsweight,
       a.batchno,
       a.lotid,
       a.lotno,
       a.killlotno,
       a.validdate,
       a.proddate,
       a.prodlicenseno,
       a.goodsstatusid,
       e.goodsstatus,
       a.quantitystatus,
       a.goodsqty,
       a.wholeqty,
       a.scatterqty,
       h.goodsownid,
       h.storagecondition,
       a.recmemo,
       a.facequality,
       a.packquality,
       a.transtemp,
       a.importrepflag,
       a.passgateflag, -- 通关单
       a.registeflag, --  注册证
       a.medcheckflag, -- 药检证标志
       a.eligibilityflag, --  合格证标志
       a.approvedocno, --  批准文号
       a.registno, -- 进口注册证号
       a.rptno, --  岸检验报告编号
       a.backwhyid, -- 退货原因
       a.checkmanid1, --   验收员A
       a.checkman1,
       a.checkmanid2, --  验收员B
       a.checkman2,
       a.checkdocno, --检验单号
       a.lqccheck,--可见异物检验
       a.passgateno,--通关单号
       a.pijianno,--批件号
       a.qucheckid, --检查部门ID
       a.lpncode,
       a.containerid,
       s.containerno,
       s.typeid,
       o.companyname qucheckname,
       a.inputmanid,
       a.sorttype,
       a.traysectionid,
        t.sectionno traysectionno,
       t.sectionname traysectionname,
       a.sectionid,
       p.sectionno,
       p.sectionname,
       a.wholesectionid ,
       r.sectionno wholesectionno,
       r.sectionname wholesectionname,
       a.sendno,
       a.usestatus,
       a.rulingflag,
       a.gspflag,
       a.receivetype,
       a.statusreason,
       c.l_period,
       c.s_periodunit,
       a.checkmemo,
       x.receivedocid inid,
       y.gocompanyid sourcecompanyid,
       w.companyname,
       y.operationtype,
       NULL porderstatus,
       NULL orderstatus,
       y.usestatus musestatus,
       x.usestatus dusestatus,
       y.memo ordermemo,
       t2.packname mintradname
  from wms_receive_dtl          a,
       wms_goods_lot            b,
       tpl_pub_goods            c,
       tpl_pub_company          f,
       tpl_pub_goods_packs      d,
       wms_goodsstatus          e,
       tpl_goods                h,
       pub_company              o,
       wms_st_section_def       p,
       wms_st_section_def       r,
       wms_container_def        s,
       wms_st_section_def       t,
       wms_receive_detail       x,
       wms_receive_doc          y,
       tpl_go_company           w,
       tpl_pub_goods_packs      t2
 where a.lotid = b.lotid(+)
   and a.goodsid = c.goodsid
   and a.goodspackid = d.goodspackid(+)
   and a.goodsstatusid = e.goodsstatusid(+)
   and a.ownergoodsid = h.ownergoodsid
   and a.qucheckid = o.companyid(+)
   and a.sectionid = p.sectionid(+)
   and a.wholesectionid = r.sectionid(+)
   and a.containerid = s.containerid(+)
   and c.factid = f.companyid(+)
   and a.traysectionid = t.sectionid(+)
   AND a.receivedetailid = x.receivedetailid
   AND x.receivedocid = y.receivedocid
   AND y.gocompanyid = w.companyid
   and a.goodsid = t2.goodsid and t2.baseunitflag = 1  ---20110809 ltx增加基本包装单位
   and a.indtlid is null
"
"WMS_HIS_PATCH_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_HIS_PATCH_V"" (""CHOOSEFLAG"", ""INOUTID"", ""BARCODE"", ""COMPANYID"", ""COMPANYNAME"", ""DIFREASON"", ""RECTIME"", ""RECMANID"", ""RECMANNAME"", ""RFNO"", ""GOODSID"", ""GOODSNAME"", ""PRODAREA"", ""GOODSTYPE"", ""GOODSQTY"", ""RECQTY"", ""TRADEGOODSPACK"", ""PACKSIZE"", ""VALIDDATE"", ""APPROVENO"", ""LOTNO"", ""GOODSBARCODE"", ""FLAG"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""WAREHID"", ""WAREHNAME"", ""RFFINDATE"", ""TRANSID"", ""DISPATCHID"", ""VEHICLENO"", ""DISPATCHDATE"", ""INCEPTADDR"") AS 
  select 1 chooseflag,
       a.inoutid,
       a.barcode,
       a.companyid,
       c.companyname,
       a.difreason,
       a.rectime,
       a.recmanid,
       d.employeename recmanname,
       a.rfno,
       a.goodsid,
       a.goodsname,
       a.prodarea,
       a.goodstype,
       a.goodsqty,
       a.recqty,
       a.tradegoodspack,
       a.packsize,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.approveno,
       a.lotno,
       a.goodsbarcode,
       a.flag,
       a.goodsownerid,
       e.goodsownername,
       a.warehid,
       g.warehname,
       a.rffindate,
       a.TRANSID,
       a.dispatchid,
       a.vehicleno,
       a.dispatchdate,
       f.inceptaddr
  from wms_his_patch  a,
       tpl_go_company      c,
       pub_employee        d,
       tpl_goodsowner e,
       wms_transport_address f,
       tpl_warehouse g
 where a.companyid = c.companyid(+)
   and a.recmanid = d.employeeid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.transid = f.transid(+)
   and a.warehid = g.warehid(+)
"
"WMS_HOSPITAL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_HOSPITAL_V"" (""HOSPITALID"", ""COMPANYNAME"", ""COMPANYOPCODE"", ""COMPANYSHORTNAME"", ""SUPPLYER"", ""SUPPLYER_NAME"", ""SUPPLYER_LOOKUP"", ""IN_TYPE"", ""ZX_COLUMN1"", ""ZX_COLUMN2"", ""ZX_COLUMN3"", ""ZX_COLUMN4"", ""ZX_COLUMN5"") AS 
  select a.HOSPITALID,
       b.companyname,
       b.companyopcode,
       b.companyshortname,
       a.SUPPLYER,
       a.SUPPLYER_NAME,
       a.SUPPLYER_LOOKUP,
       a.IN_TYPE,
       a.ZX_COLUMN1,
       a.ZX_COLUMN2,
       a.ZX_COLUMN3,
       a.ZX_COLUMN4,
       a.ZX_COLUMN5
  from wms_hospital a,
  tpl_pub_company b
  where a.hospitalid=b.companyid
"
"WMS_HOSTDISTRICT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_HOSTDISTRICT_V"" (""CREDATE"", ""GOODSQTY"", ""OUTGOODSQTY"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""QUANTITYSTATUS"", ""GOODSSTATUSID"", ""GOODSPACK"", ""PAKESIZE"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""BATCHNO"", ""RSTORAGENAME"", ""GOODSOWNERNAME"", ""FIXFLAG"", ""RECCOMPANYNAME"", ""SALERNAME"", ""MEMO"", ""PICKDATE"", ""POSNO"", ""SECTIONNAME"", ""AREANAME"", ""AREAID"", ""SALERID"", ""RECCOMPANYID"", ""GSTORAGEID"", ""ORDERID"", ""ORDERDTLID"", ""INOUTID"", ""GOODSID"", ""STORAGEID"", ""OWNERGOODSID"", ""SOURCECOMPANYID"", ""WAREHID"", ""GOODSPACKID"", ""RSTORAGEID"", ""LOTID"", ""GOODSOWNID"", ""GOODSOWNERID"", ""DELIVERYMANID"", ""DELIVERYMANOPCODE"", ""DELIVERYMAN"", ""DELIVERYDATE"", ""DELIVERYMEMO"", ""OPERATIONTYPE"", ""DELIVERYUSESTATUS"") AS 
  select a.credate,
       a.goodsqty,
       a.outgoodsqty,
       a.goodsname,
       a.goodstype,
       a.prodarea,
       a.quantitystatus,
       a.goodsstatusid,
       a.goodspackid goodspack,
       '' pakesize,
       a.lotno,
       a.proddate,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.batchno,
       '' rstoragename,
       a. goodsownername,
       '' fixflag,
       '' reccompanyname,
       '' salername,
       a.memo,
       '' pickdate,
       a.posno,
       a.sectionname,
       a.areaname,
       a.areaid,
       '' salerid,
       '' reccompanyid,
       '' gstorageid,
       '' orderid,
       '' orderdtlid,
       a.inoutid,
       a.goodsid,
       '' storageid,
       a.ownergoodsid,
       a.companyid sourcecompanyid,
       a.warehid,
       a.goodspackid,
       '' rstorageid,
       a.lotid,
       a.goodsownid,
       a.goodsownerid,
       b.deliverymanid,
       c.opcode deliverymanopcode,
       c.employeename deliveryman,
       b.deliverydate,
       b.deliverymemo,
       a.operationtype,
       b.deliveryusestatus
  from wms_hostdistrict b, wms_st_io_doc_v a, pub_employee c
 where a.inoutid = b.inoutid
   and b.deliverymanid = c.employeeid(+)
"
"WMS_HOSTPITAL_REC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_HOSTPITAL_REC_V"" (""ORDERID"", ""ORDERDTLID"", ""COMPANYID"", ""OPERATIONTYPE"", ""COMPANY"", ""INOUTID"", ""GOODSID"", ""STORAGEID"", ""BATCHNO"", ""LOTNO"", ""VALIDDATE"", ""QUANTITYSTATUS"", ""GOODSQTY"", ""MEMO"", ""KEEPDATE"", ""PACKSIZE"", ""PACKNAME"", ""FACTNAME"", ""PRODAREA"", ""GOODSTYPE"", ""EXPECTATION"", ""APPROVENO"", ""GOODSNAME"", ""GOODSOPCODE"", ""WAREHID"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""GOODSPACKID"", ""INOUTFLAG"", ""GSTORAGEID"", ""WAREHOPCODE"", ""WAREHNAME"", ""DIFREASON"", ""DIFFLAG"", ""PRINTLINE"", ""PRINTNO"", ""PICKDATE"", ""ARRIVEQTY"", ""PICKQTY"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""LOTID"", ""OWNERGOODSID"", ""PRODDATE"", ""KEEPMANID"", ""GOODSSTATUSID"", ""SOURCECOMPANYID"", ""GOODSOWNERID"", ""RSTORAGEID"", ""APPROVEDOCNO"", ""GSPFLAG"", ""RFFLAG"", ""RETRECEPTFLAG"", ""RECTIME"", ""RECMANID"", ""RECMAN"", ""RFNO"", ""DIFFQTY"") AS 
  SELECT a.ORDERID,
       a.ORDERDTLID,
       a.reccompanyid companyid,
       a.operationtype,
       l.companyname company,
       a.INOUTID,
       a.GOODSID,
       a.STORAGEID,
       a.BATCHNO,
       a.LOTNO,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.QUANTITYSTATUS,
       a.GOODSQTY,
       a.MEMO,
       a.keepdate,
       h.packsize,
       h.packname,
       a.factname,
       k.prodarea,
       k.goodstype,
       a.expectation,
       a.approveno,
       b.goodsname,
       b.opcode goodsopcode,
       a.warehid,
       e.goopcode,
       e.goodsownername,
       a.goodspackid,
       a.inoutflag,
       a.gstorageid,
       i.warehopcode,
       i.warehname,
       a.difreason,
       a.difflag,
       a.printline,
       a.printno,
       a.pickdate,
       A.ARRIVEQTY,
       A.PICKQTY,
       A.INGOODSQTY,
       A.OUTGOODSQTY,
       a.lotid,
       A.ownergoodsid,
       a.proddate,
       a.keepmanid,
       a.goodsstatusid,
       a.sourcecompanyid,
       a.goodsownerid,
       a.rstorageid,
       a.approvedocno,
       a.gspflag,
       a.rfflag,
       nvl( a.Retreceptflag,0)Retreceptflag,
        a.rectime,
        a.recmanid,
        m.employeename  recman,
        a.rfno,
       nvl(a.goodsqty-a.arriveqty,0) diffqty
  from wms_tpl_st_io_doc       a,
       tpl_pub_goods       b,
       tpl_goodsowner      e,
       tpl_pub_goods_packs h,
       tpl_warehouse       i,
       TPL_GOODS           K,
       tpl_go_company      l,
       pub_employee        m
 where a.goodsid = b.goodsid(+)
   and a.goodsownerid = e.goodsownerid
   and a.goodspackid = h.goodspackid(+)
   and a.warehid = i.warehid(+)
   AND A.OWNERGOODSID = K.Ownergoodsid(+)
   and a.inoutflag = 1 --出库
   and a.comefrom = 2
   and a.reccompanyid = l.companyid(+)
   and a.recmanid = m.employeeid(+)
"
"WMS_INSTANS_MANGE_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_INSTANS_MANGE_DOC_V"" (""DOCID"", ""CREATEDATE"", ""CREATEMANID"", ""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""CREATEOPCODE"", ""CREATEMAN"", ""RECEIVEID"", ""RECEIVEOPCODE"", ""RECEIVEMAN"", ""RECEIVEDATE"", ""FROMCOMPANYID"", ""FROMCOMPANY"", ""FROMTRANSCOMPANYID"", ""FROMTRANSCOMPANY"", ""USESTATUS"", ""COMFIRMCMPID"", ""COMFIRMCMP"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""WHOLESECTIONID"", ""WHOLESECTIONNO"", ""WHOLESECTIONNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INSTANSTYPE"", ""COMEFROM"", ""GOOPCODE"", ""MEMO"", ""COMFIRMDATE"", ""COMFIRMMANID"", ""COMFIRMNAME"", ""SOURCEID"", ""CLAIMEDATE"", ""CLAIMEMANID"", ""CLAIMEMANNAME"") AS 
  select   a.docid,
         a.createdate,
         a.createmanid,
         a.warehid,
         h.warehopcode,
         h.warehname,
         e.opcode createopcode,
         e.employeename createman,
         a.receiveid,
         d.opcode receiveopcode,
         d.employeename receiveman,
         a.receivedate,
         a.fromcompanyid,
         a.fromcompany,
         a.fromtranscompanyid,
         a.fromtranscompany,
         a.usestatus,
         a.comfirmcmpid,
         a.comfirmcmp,
         a.sectionid,
         b.sectionno,
         b.sectionname,
         a.wholesectionid,
         c.sectionno wholesectionno,
         c.sectionname wholesectionname,
         a.goodsownerid,
         f.goodsownername,
         a.instanstype,
         a.comefrom,
         f.goopcode,
         a.memo,
         a.comfirmdate,
         a.comfirmmanid,
         g.employeename comfirmname,
         a.sourceid,
         a.claimedate,
         a.claimemanid,
         i.employeename claimemanname
    from wms_instans_mange_doc    a,
         tpl_warehouse            h,
         wms_st_section_def       b,
         wms_st_section_def       c,
         pub_employee             d,
         pub_employee             e,
         tpl_goodsowner           f,
         pub_employee             g,
         pub_employee             i
       where a.warehid = h.warehid
       and a.sectionid = b.sectionid(+)
       and a.wholesectionid = c.sectionid(+)
       and a.receiveid = d.employeeid(+)
       and a.createmanid = e.employeeid(+)
       and a.goodsownerid = f.goodsownerid(+)
       and a.comfirmmanid=g.employeeid(+)
       and a.claimemanid = i.employeeid(+)
"
"WMS_INSTANS_MANGE_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_INSTANS_MANGE_DTL_V"" (""DTLID"", ""DOCID"", ""MAYGOODSID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSWEIGHT"", ""WHOLETOTAL"", ""SECTOTAL"", ""POSID"", ""POSNO"", ""POSNAME"", ""MAYGOODSUNITID"", ""MAYGOODSUNIT"", ""COMFIRMDATE"", ""COMFIRMGOODSID"", ""COMFIRMGOODSPACKID"", ""ZHUANDATE"", ""ZHUANMETHOD"", ""ZHUANMANID"", ""ZHUANMANNAME"", ""ZHUANQTY"", ""USESTATUS"", ""MAYOWNERGOODSID"", ""ZONENO"", ""ZONENAME"", ""ZONEID"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""PRODATE"", ""VALIDEDATE"", ""TOTALQTY"", ""ZHUANWHOLEQTY"", ""GOODSOWNID"", ""FACTID"", ""FACTNAME"", ""APPROVEDOCNO"", ""OWNERGOODSIDVAL"", ""TPLORDERNO"", ""MEMO"", ""COMFIRMMEMO"", ""COMFIRMPACKSIZE"", ""COMFIRMPACKNAME"", ""COMFIRMGOODSNAME"", ""CANZHUANQTY"") AS 
  select  a.dtlid,
         a.docid,
         a.maygoodsid,
         a.goodsopcode,
         a.goodsname,
         a.goodstype,
         a.goodspackid,
         a.packname,
         a.packsize,
         a.goodslength,
         a.goodswidth,
         a.goodsheight,
         a.goodsweight,
         a.wholetotal,
         a.sectotal,
         a.posid,
         c.posno,
         c.posname,
         a.maygoodsunitid,
         a.maygoodsunit,
         a.comfirmdate,
         a.comfirmgoodsid,
         a.comfirmgoodspackid,
         a.zhuandate,
         a.zhuanmethod,
         a.zhuanmanid,
         d.employeename zhuanmanname,
         a.zhuanqty,
         a.usestatus,
         a.mayownergoodsid,
         b.zoneno,
         b.zonename,
         a.zoneid,
         a.prodarea,
         a.lotid,
         a.lotno,
         a.prodate,
         a.validedate,
         a.totalqty,
         a.zhuanwholeqty,
         f.goodsownid,
         a.factid,
         a.factname,
         a.approvedocno,
         a.ownergoodsidval,
         a.tplorderno,
         a.memo,
         a.comfirmmemo,
         a.comfirmpacksize,
         a.comfirmpackname,
         a.comfirmgoodsname,
         (NVL(a.totalqty,0) - nvl(e.zhuanqty,0)) canzhuanqty
    from wms_instans_mange_dtl a,
         wms_ship_zone_pos c,
         wms_ship_zone     b,
         pub_employee      d,
         tpl_goods         f,
         (SELECT dtlid, sum(nvl(zhuanqty,0)) zhuanqty FROM wms_instans_ref h group by dtlid) e
    WHERE  a.posid = c.shipposid(+)
    and    a.zoneid = b.zoneid(+)
    and    a.zhuanmanid = d.employeeid(+)
    and    a.dtlid = e.dtlid(+)
    and    a.mayownergoodsid = f.ownergoodsid(+)
"
"WMS_INSTANS_QTY_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_INSTANS_QTY_LST_V"" (""GOODSOWNERID"", ""GOODSOWNERNAME"", ""FROMCOMPANYID"", ""FROMCOMPANY"", ""FROMTRANSCOMPANYID"", ""FROMTRANSCOMPANY"", ""CREATEDATE"", ""COMFIRMDATE"", ""COMFIRMMANID"", ""COMFIRMAN"", ""GOODSID"", ""MAYOWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""MAYGOODSUNITID"", ""MAYGOODSUNIT"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""LOTID"", ""LOTNO"", ""PRODATE"", ""VALIDEDATE"", ""PRODAREA"", ""SECTOTAL"", ""WHOLETOTAL"", ""TOTALQTY"", ""ZHUANQTY"", ""YUQTY"", ""ZHUANDATE"", ""ZHUANMANID"", ""ZHUANMAN"", ""ZONEID"", ""ZONENO"", ""ZONENAME"", ""POSID"", ""POSNO"", ""POSNAME"", ""DOCID"", ""DTLID"", ""SEQID"", ""ZHUANMETHOD"", ""MEMO"") AS 
  select c.goodsownerid,
       d.goodsownername,
       c.fromcompanyid,
       c.fromcompany,
       c.fromtranscompanyid,
       c.fromtranscompany,
       c.createdate,
       c.comfirmdate,
       c.comfirmmanid,
       e.employeename comfirman,
       b.maygoodsid goodsid,
       b.mayownergoodsid,
       b.goodsname,
       b.goodstype,
       b.maygoodsunitid,
       b.maygoodsunit,
       b.goodspackid,
       b.packname,
       b.packsize,
       b.lotid,
       b.lotno,
       b.prodate,
       b.validedate,
       b.prodarea,
       b.sectotal,
       b.wholetotal,
       b.totalqty,
       a.zhuanqty,
       a.yuqty,
       a.zhuandate,
       a.zhuanmanid,
       f.employeename zhuanman,
       b.zoneid,
       g.zoneno,
       g.zonename,
       b.posid,
       h.posno,
       h.posname,
       c.docid,
       b.dtlid,
       a.seqid,
       a.zhuanmethod,
       a.memo
  from wms_instans_ref a,
       wms_instans_mange_dtl b,
       wms_instans_mange_doc c,
       tpl_goodsowner        d,
       pub_employee          e,
       pub_employee          f,
       wms_ship_zone         g,
       wms_ship_zone_pos     h
 where  a.dtlid=b.dtlid
   and b.docid= c.docid
   and c.goodsownerid = d.goodsownerid(+)
   and c.comfirmmanid=e.employeeid(+)
   and a.zhuanmanid=f.employeeid(+)
   and b.zoneid=g.zoneid(+)
   and b.posid=h.shipposid(+)
   and c.usestatus=2
   order by b.dtlid,a.seqid
"
"WMS_IN_ORDER_CHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_IN_ORDER_CHECK_V"" (""INID"", ""INDTLID"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""OPCODE"", ""FACTID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSENGNAME"", ""FACTNAME"", ""OWNERGOODSID"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""PORDERSTATUS"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""MEMO"", ""ARRIVEDATE"", ""CHECKDATE"", ""PUTUPDATE"", ""CANCELDATE"", ""SRCDTLNO"", ""LOTFLAG"", ""BATCHFLAG"", ""CUSTCANCELSTATUS"", ""KEEPFLAG"", ""GTRADEPACK"", ""ORIGINQTY"", ""PRICE"", ""RETAILPRICE"", ""AMT"", ""QTY"", ""QUADQTY"", ""UNQUADQTY"", ""TESTQTY"", ""STOCKQTY"", ""SADTLID"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""OLDDTLID"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""FIRSTFLAG"", ""OTHERID"", ""CANKEEP"", ""INMODE"", ""SORTTYPE"", ""WAITFORGOUDUI"", ""TPRICETICK"", ""TPRICEFLAG"", ""GOODSOWNID"", ""GOODSNO"", ""GOODSCLASS"", ""MATCHFLAG"", ""PRINTFLAG"", ""PRINTDATE"", ""PRINTMANID"", ""PRINTMANNAME"", ""FILEGROUPID"", ""BARCODE"", ""SRCNO"", ""SOURCECOMPANYID"", ""COMPANYNAME"", ""COMPANYOPCODE"", ""CREDATE"", ""OPERATIONTYPE"", ""BMSDOCID"", ""FINISHFLAG"", ""INPUTMANID"", ""NOWLFLAG"", ""TRANSCLASS"", ""TRANSMODEID"", ""TRANSID"", ""ZXCOLUMN2"", ""ERPSUCONID"", ""ERPMEMO"", ""CLFLAG"", ""DTLZXCOLUMN1"", ""DTLZXCOLUMN5"", ""GCOMPANYNAME"", ""ZXCOLUMN4"", ""UNITPRICE"", ""SUPPLYERNAME"", ""INVOICECODE"", ""INVOICENO"", ""INVOICEDATE"", ""SHTXL"", ""YJBG"", ""DRUGFORM"", ""MAH"", ""SHDATE"", ""DOCMEMO"", ""UDI_CODE"", ""UDI_FLAG"", ""UDI_PARSER_RULE_ID"", ""AUTOFLAG"", ""ECODEFLAG"", ""GCOMPANYID"", ""ISGSPCONTROL"", ""CHECKLICENSE"", ""BUSISCOPENAME"", ""WARECHECKLICENSE"", ""AUTOPASSFLAG"", ""TO_SOURCECOMPANYID"", ""TO_SOURCECOMPANYNAME"", ""RECALLFLAG"", ""RECALLGOODSSTATUS"", ""ZX_WDFW"", ""PRODLICENSENO"", ""ORDERNO"", ""SEQFLAG"") AS 
  Select a.Inid,
       a.Indtlid,
       a.Warehid,
       a.Goodsownerid,
       b.Goodsownername,
       a.Goodsid,
       f.opcode, --xyue 2015-11-05 验收管理总单货品操作码取货主货品信息表
       c.Factid,
       -- xyue 2014-05-08 验收管理总单货品基础数据取货主货品信息表
       f.goodsname,
       f.goodstype,
       f.prodarea,
       f.goodsengname, --xyue 2014-05-08 验收管理总单增加商品名
       a.factname,--取入库细单上的生产厂家
       a.Ownergoodsid,
       a.Goodspackid,
       decode(f.udi_flag, 1, nvl(d.packname, f.outpackname), d.packname) packname,
       decode(f.udi_flag, 1, nvl(d.packsize, f.packsize), d.packsize) packsize,
       a.Porderstatus,
       nvl(a.Batchno, 0) Batchno,
       a.Lotid,
       a.Lotno,
       a.Goodsqty,
       a.Tradegoodsqty,
       f.tradepackname Tradegoodspack, --change by xyue 2020-11-11 取货主货品信息上的交易单位
       decode(a.goodsownerid, 9102, doc.memo, a.memo) Memo,
       a.Arrivedate,
       a.Checkdate,
       a.Putupdate,
       a.Canceldate,
       a.Srcdtlno,
       a.Lotflag,
       a.Batchflag,
       a.Custcancelstatus,
       a.Keepflag,
       a.Gtradepack,
       a.Originqty,
       a.Price,
       a.Retailprice,
       a.Amt,
       a.Qty,
       a.Quadqty,
       a.Unquadqty,
       a.Testqty,
       a.Stockqty,
       a.Sadtlid,
       decode(a.recallflag,1,a.recallgoodsstatusid,a.Goodsstatusid) Goodsstatusid,
       e.Goodsstatus,
       e.Quantitystatus,
       a.Olddtlid,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.Proddate,
       a.approvedocno, --取入库细单上的批准文号
       a.Firstflag,
       a.Otherid,
       a.Cankeep,
       a.Inmode,
       a.Sorttype,
       a.waitforgoudui,
       a.Tpricetick,
       a.Tpriceflag,
       decode(a.goodsownerid,9142,f.goodsno,f.Goodsownid) as Goodsownid,
       f.Goodsno,
       (select t.goodsclass
          from Wms_Goods_Feature t
         where t.warehid = a.warehid
           and t.goodsid = a.goodsid) Goodsclass,
       Nvl(a.Matchflag, 0) Matchflag,
       decode(a.printflag, null, null, 1) printflag,
       a.Printdate,
       a.Printmanid,
       k.Employeename Printmanname,
       c.Filegroupid, --图片目录ID,
       c.Barcode,
       Doc.Srcno,
       Doc.Sourcecompanyid,
       Com.Companyname,
       com.Opcode Companyopcode,
       Doc.Credate,
       Doc.Operationtype,
       Doc.Bmsdocid,
       Doc.Finishflag,
       Doc.Inputmanid,
       Doc.Nowlflag,
       Doc.Transclass,
       Doc.Transmodeid,
       Doc.Transid,
       Doc.Zxcolumn2,
       pf_get_info(zxcolumn4, 'suconid') as erpsuconid,
       pf_get_info(zxcolumn4, 'memo') as erpmemo,
       nvl(a.clflag, 0) clflag,
       a.dtlzxcolumn1, --xyue 2014-11-27 增加erp销售退货申请细单上的采购意见
       a.dtlzxcolumn5, --add by weitangjing 20130927 ERP采购细单备注
       Doc.Gcompanyname, --add by weitangjing 20131102 货主原单位名称
       doc.zxcolumn4, --xyue 2014-05-09 增加ERP合同总单ID
       a.unitprice, --xyue 2014-05-20 在【验收管理】总单增加ERP合同细单含税进价
       a.supplyername, --xyue 2014-05-29 在【验收管理】总单增加采购员
       a.invoicecode, --发票代码 add by xyue 2016-08-27
       a.invoiceno, --发票号码 add by xyue 2016-08-27
       a.INVOICEDATE, --发票日期 add by xyue 2016-08-27
       a.shtxl,
       a.yjbg,
       f.drugform, --add by xyue 2017-05-05 剂型
       a.mah, --取入库细单上的上市许可持有人
       a.shdate, --by tl@200107 收货日期
       doc.memo docmemo, --by tl@200727 取物流入库订单总单备注
       a.udi_code,
       a.udi_flag,
       a.udi_parser_rule_id,
       decode(doc.goodsownerid, 6, doc.autoflag, null) autoflag,
       nvl(f.ecodeflag, 0) ecodeflag, --add by xyue 2022-08-30
       Com.Gcompanyid, --add by hts 2022-11-28
       f.isgspcontrol,
       b.checklicense,
       f.busiscopename,
       (select x.checklicense
          from tpl_goodsowner_to_warehouse x
         where x.warehid = a.warehid
           and x.goodsownerid = a.goodsownerid) warechecklicense,
       doc.autopassflag,
       doc.to_sourcecompanyid,
       g.companyname to_sourcecompanyname,
       a.recallflag,
       a.recallgoodsstatus,
       f.zx_wdfw, --温度范围
       a.prodlicenseno, --取入库细单上的生产许可证号
       doc.orderno, --雨诺单据编号
       f.seqflag
  From Wms_In_Order_Dtl_v  a,
       Wms_In_Order        Doc,
       Tpl_Go_Company      Com,
       Tpl_Goodsowner      b,
       Tpl_Pub_Goods       c,
       Tpl_Pub_Goods_Packs d,
       Wms_Goodsstatus     e,
       Tpl_Goods           f,
       tpl_go_company      g,
       Tpl_Pub_Company     h,
       Pub_Employee        k
 Where a.Goodsownerid = b.Goodsownerid
   and Doc.Sourcecompanyid = Com.Companyid(+)
   and a.Goodsid = c.Goodsid(+)
   and a.Goodspackid = d.Goodspackid(+)
   and a.Goodsstatusid = e.Goodsstatusid(+)
   and a.Ownergoodsid = f.Ownergoodsid
   and c.Factid = h.Companyid(+)
   and doc.to_sourcecompanyid = g.companyid(+)
   and a.Printmanid = k.Employeeid(+)
   and a.Inid = Doc.Inid
"
"WMS_IN_ORDER_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_IN_ORDER_DTL_V"" (""INID"", ""INDTLID"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTNAME"", ""OWNERGOODSID"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""PORDERSTATUS"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""MEMO"", ""ARRIVEDATE"", ""CHECKDATE"", ""PUTUPDATE"", ""SRCDTLNO"", ""LOTFLAG"", ""BATCHFLAG"", ""CUSTCANCELSTATUS"", ""KEEPFLAG"", ""GTRADEPACK"", ""ORIGINQTY"", ""PRICE"", ""RETAILPRICE"", ""AMT"", ""QTY"", ""QUADQTY"", ""UNQUADQTY"", ""TESTQTY"", ""STOCKQTY"", ""SADTLID"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""OLDDTLID"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""FIRSTFLAG"", ""OTHERID"", ""CANKEEP"", ""INMODE"", ""SORTTYPE"", ""TPRICETICK"", ""TPRICEFLAG"", ""GOODSOWNID"", ""GOODSNO"", ""GOODSCLASS"", ""MATCHFLAG"", ""PRINTFLAG"", ""PRINTDATE"", ""PRINTMANID"", ""PRINTMANNAME"", ""CANCELDATE"", ""CANCELMANID"", ""WAITFORGOUDUI"", ""CANCELMANNAME"", ""GETBACKTIME"", ""GETBACKMEMO"", ""DTLZXCOLUMN1"", ""DTLZXCOLUMN4"", ""DTLZXCOLUMN5"", ""UNITPRICE"", ""SUPPLYERNAME"", ""DHWD"", ""SHQK"", ""YCFLAG"", ""INVOICECODE"", ""INVOICENO"", ""INVOICEDATE"", ""SHTXL"", ""YJBG"", ""SHDATE"", ""CLFLAG"", ""CAMERAID"", ""MAH"", ""ECODEFLAG"", ""UDI_CODE"", ""UDI_FLAG"", ""UDI_PARSER_RULE_ID"", ""FROM_SALESDTLID"", ""RECALLFLAG"", ""RECALLGOODSSTATUSID"", ""RECALLGOODSSTATUS"", ""PRODLICENSENO"") AS 
  select a.inid,
       a.indtlid,
       a.warehid,
       a.goodsownerid,
       b.goodsownername,
       a.goodsid,
       f.opcode,
       f.goodsname,
       f.goodsengname,
       f.goodstype, ---修改为取货主货品信息里的规格  TONGXJ 2014.03.18 10:52
       f.prodarea,
       c.factid,
       --nvl(a.factname,f.factname) as factname,--取入库订单细单上的生产厂家
       (case
         when a.goodsownerid in (6, 244, 284, 304, 424, 444, 636, 658, 682) then
          nvl(a.factname, f.factname)
         else
          f.factname
       end) as factname,
       a.ownergoodsid,
       a.goodspackid,
       nvl(d.packname, f.outpackname) packname,
       nvl(d.packsize, f.packsize) packsize,
       a.porderstatus,
       a.batchno,
       a.lotid,
       a.lotno,
       a.goodsqty,
       a.tradegoodsqty,
       f.tradepackname tradegoodspack, --change by xyue 2020-11-11 取货主货品信息上的交易单位
       a.memo,
       a.arrivedate,
       a.checkdate,
       a.putupdate,
       a.srcdtlno,
       a.lotflag,
       a.batchflag,
       a.custcancelstatus,
       a.keepflag,
       a.gtradepack,
       a.originqty,
       a.price,
       a.retailprice,
       --a.amt,
       a.goodsqty*a.price as amt,
       a.qty,
       a.quadqty,
       a.unquadqty,
       a.testqty,
       a.stockqty,
       a.sadtlid,
       a.goodsstatusid,
       e.goodsstatus,
       e.quantitystatus,
       a.olddtlid,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.proddate,
       --nvl(a.approvedocno,f.approvedocno) approvedocno, --入库细单上的批准文号
       (case
         when a.goodsownerid in (6, 244, 284, 304, 424, 444, 636, 658, 682) then
          nvl(a.approvedocno, f.approvedocno)
         else
          f.approvedocno
       end) as approvedocno,
       a.firstflag,
       a.otherid,
       a.cankeep,
       a.inmode,
       a.sorttype,
       a.tpricetick,
       a.tpriceflag,
       f.goodsownid,
       f.goodsno,
       g.goodsclass,
       nvl(a.matchflag, 0) matchflag,
       decode(a.printflag, null, null, 1) printflag,
       a.printdate,
       a.printmanid,
       k.employeename printmanname,
       a.canceldate,
       a.cancelmanid,
       a.waitforgoudui,
       dd.employeename cancelmanname,
       nvl(a.getbacktime, sysdate) getbacktime, --取回时间 add by wanghuaiyu 20130614
       a.getbackmemo, --取回备注 add by wanghuaiyu 20130614
       a.dtlzxcolumn1, --xyue 2014-11-27 增加erp销售退货申请细单上的采购意见
       a.dtlzxcolumn4, --ERP细单ID add by wanghuaiyu 2013年8月7日 18:47:12
       a.dtlzxcolumn5, --add by weitangjing 20130927 ERP采购细单备注
       a.price unitprice, --change by xyue 2020-05-27 内部货主取erp合同细单单价
       (case
         when nvl(b.innerflag, 0) = 1 and doc.operationtype = 1 then
          (select bb.employeename
             from lyerp.bms_su_con_dtl aa, lyerp.pub_employee bb
            where aa.sucondtlid = a.dtlzxcolumn4
              and aa.supplyerid = bb.employeeid)
         when nvl(b.innerflag, 0) = 1 and doc.operationtype = 7 then
          (select bb.employeename
             from lyerp.bms_tr_fetch_dtl aa, lyerp.pub_employee bb
            where aa.fetchdtlid = a.dtlzxcolumn4
              and aa.supplyerid = bb.employeeid)
         when nvl(b.innerflag, 0) = 1 and doc.operationtype = 8 then
          (select bb.employeename
             from lyerp.bms_mv_dtl    aa,
                  lyerp.pub_employee  bb,
                  lyerp.bms_batch_def cc
            where aa.movedtlid = a.dtlzxcolumn4
              and aa.batchid = cc.batchid(+)
              and cc.empid = bb.employeeid)
         else
          null
       end) supplyername,
       --change by xyue 2020-05-27 内部货主取erp合同细单采购员; change by llq 2020-09-10 赠品入库单未关联致采购员错误，去掉赠品入库采购员

       a.dhwd, --到货温度 zyc 20151113
       a.shqk, --收货情况 zyc 20151113
       a.ycflag, --异常标志 zyc 20151113
       --nvl(a.clflag,0) clflag--处理标志 zyc 20151113
       a.invoicecode, --发票代码 add by xyue 2016-08-27
       a.invoiceno, --发票号码 add by xyue 2016-08-27
       a.INVOICEDATE, --发票日期 add by xyue 2016-08-27
       a.shtxl,
       a.yjbg,
       a.shdate, --收货日期 tl@190709
       a.clflag, -- xyue 2016-02-21 该标志全部置1，使得验收管理全部可以新增细单
       null          cameraid,
       --nvl(a.mah,f.mah) as mah, --入库订单细单上的上市许可持有人
       (case
         when a.goodsownerid in (6, 244, 284, 304, 424, 444, 636, 658, 682) then
          nvl(a.mah, f.mah)
         else
          f.mah
       end) as mah,
       f.ecodeflag,
       f.udi_code,
       f.udi_flag,
       f.udi_parser_rule_id,
       a.from_salesdtlid,
       (select 1
          from wms_recall_lot_reg x
         where x.ownergoodsid = a.ownergoodsid
           and x.lotid = a.lotid
           and x.usestatus = 1
           and doc.operationtype in (7, 42,44)) recallflag,
       (select y.goodsstatusid
          from wms_recall_lot_reg y
         where y.ownergoodsid = a.ownergoodsid
           and y.lotid = a.lotid
           and y.usestatus = 1
           and doc.operationtype in (7, 42,44)) recallgoodsstatusid,
       (select z1.goodsstatus
          from wms_recall_lot_reg z, Wms_Goodsstatus z1
         where z.ownergoodsid = a.ownergoodsid
           and z.lotid = a.lotid
           and z.usestatus = 1
           and z.goodsstatusid = z1.goodsstatusid
           and doc.operationtype in (7, 42,44)) recallgoodsstatus,
       a.prodlicenseno --入库细单上的生产许可证号
  from wms_in_order_dtl    a,
       wms_in_order        doc,
       tpl_goodsowner      b,
       tpl_pub_goods       c,
       tpl_pub_goods_packs d,
       wms_goodsstatus     e,
       tpl_goods           f,
       wms_goods_feature   g,
       pub_employee        k,
       pub_employee        dd
 where a.goodsownerid = b.goodsownerid
   and a.goodsid = c.goodsid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.goodsstatusid = e.goodsstatusid(+)
   and a.ownergoodsid = f.ownergoodsid
   and a.goodsid = g.goodsid(+)
   and a.warehid = g.warehid(+)
   and a.printmanid = k.employeeid(+)
   and a.cancelmanid = dd.employeeid(+)
   and doc.inid = a.inid
"
"WMS_IN_ORDER_PRINT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_IN_ORDER_PRINT_V"" (""INID"", ""CREDATE"", ""OPERATIONTYPE"", ""OPERTYPE"", ""WAREHID"", ""WAREHNAME"", ""SOURCECOMPANYID"", ""SRCCOMPANYNAME"", ""INDTLID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""TRADEGOODSPACK"", ""GOODSQTY"", ""FACTNAME"", ""APPROVEDOCNO"", ""SRCDTLNO"", ""GOODSCLASS"", ""PRINTFLAG"", ""PRINTDATE"", ""PRINTMANID"", ""PRINTMANNAME"", ""SADTLID"") AS 
  select t1.inid,
       t1.credate,
       t1.operationtype,
       t3.ddlname         opertype,
       t1.warehid,
       t1.warehname,
       t1.sourcecompanyid,
       t1.srccompanyname,
       t2.indtlid,
       t2.goodsid,
       t2.goodsname,
       t2.goodstype,
       t2.tradegoodspack,
       t2.goodsqty,
       t2.factname,
       t2.approvedocno,
       t2.srcdtlno,
       t4.ddlname         goodsclass,
       decode(t2.printflag,null,null,1) printflag,
       t2.printdate,
       t2.printmanid,
       t2.printmanname,
       t2.sadtlid
  from wms_in_order_v     t1,
       wms_in_order_dtl_v t2,
       sys_ddl_all_v      t3,
       sys_ddl_all_v      t4
 where t1.inid = t2.inid
   and t1.usestatus = 1
   and nvl(t1.nowlflag, 0) <> 1
   and t3.comefrom = '系统选项字典'
   and t1.operationtype = t3.ddlid
   and t3.keyword = 'TPL_OPERATIONTYPE'
   and t4.comefrom = '用户选项字典'
   and t2.goodsclass = t4.ddlid(+)
   and t4.keyword = 'WMS_GOODS_CLASS'
"
"WMS_IN_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_IN_ORDER_V"" (""INID"", ""PORDERNO"", ""COMEFROM"", ""CREDATE"", ""ARRIVEDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""SOURCECOMPANYID"", ""SRCCOMPANYNAME"", ""MEDICINECLASS"", ""IMPORTFLAG"", ""TAXFLAG"", ""JOBTYPE"", ""OPERATIONTYPE"", ""DTLLINES"", ""MEMO"", ""INPUTMANID"", ""INPUTMANNAME"", ""SRCNO"", ""TRANSID"", ""INCEPTADDR"", ""EXPORDERID"", ""BILLFROM"", ""CONFIRMMAN"", ""CONFIRMNAME"", ""CONFIRMDATE"", ""USESTATUS"", ""MULRECFLAG"", ""RECCOUNT"", ""INMODE"", ""VALIDDAYS"", ""INVALIDATE"", ""ORDERFLAG"", ""GENFLAG"", ""SABACKDATE"", ""SBREASONID"", ""BACKREASON"", ""CUSTOMTYPE"", ""FINISHFLAG"", ""OLDID"", ""OTHERID"", ""TPRICETICK"", ""TPRICEFLAG"", ""DEPTNO"", ""DEPTNAME"", ""GCOMPANYID"", ""GCOMPANYNO"", ""GCOMPANYOPCODE"", ""BMSDOCID"", ""NOWLFLAG"", ""TRANSMODEID"", ""TRANSMODE"", ""TRANSNAME"", ""TRANSCLASS"", ""ZXCOLUMN2"", ""CANCELDATE"", ""CANCELMANID"", ""CANCELMANNAME"", ""PRINTID"", ""BACKPRINTMANID"", ""BACKPRINTMAN"", ""BACKPRINTDATE"", ""BACKPRINTFLAG"", ""ZXCOLUMN4"", ""ZXCOLUMN5"", ""MDID"", ""PLACEPOINTNAME"", ""GCOMPANYNAME"", ""PCTIME"", ""CPHID"", ""JSYID"", ""YSSB"", ""QYWD"", ""QHRID"", ""PCUSESTATUS"", ""VEHICLENO"", ""DRIVERNAME"", ""QHR"", ""INVOICECODE"", ""INVOICENO"", ""INVOICEDATE"", ""FROM_SALESID"", ""AUTOFLAG"", ""ORDERNO"") AS 
  select a.inid,
       a.porderno,
       a.comefrom,
       a.credate,
       a.arrivedate,
       a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.sourcecompanyid,
       d.companyname srccompanyname,
       a.medicineclass,
       a.importflag,
       a.taxflag,
       a.jobtype,
       a.operationtype,
       a.dtllines,
       a.memo,
       a.inputmanid,
       e.employeename inputmanname,
       a.srcno,
       a.transid,
       h.inceptaddr,
       a.exporderid,
       a.billfrom,
       a.confirmman,
       f.employeename confirmname,
       a.confirmdate,
       a.usestatus,
       a.mulrecflag,
       a.reccount,
       a.inmode,
       a.validdays,
       a.invalidate,
       a.orderflag,
       a.genflag,
       a.sabackdate,
       a.sbreasonid,
       g.backreason,
       a.customtype,
       a.finishflag,
       a.oldid,
       a.otherid,
       a.tpricetick,
       a.tpriceflag,
       a.deptno,
       a.deptname,
       d.gcompanyid,
       d.gcompanyno,
       d.gcompanyopcode,
       a.bmsdocid,
       a.nowlflag,
       a.transmodeid,
       i.transmode,
       i.transname,
       a.transclass,
       a.zxcolumn2,
       a.canceldate,
       a.cancelmanid,
       dd.employeename cancelmanname,
       a.printid,
       a.backprintmanid,--回退业务打印人ID add by wanghuaiyu  20130618
       k.employeename backprintman,--回退业务打印人 add by wanghuaiyu  20130618
       a.backprintdate,--回退业务打印时间 add by wanghuaiyu  20130618
       decode(a.backprintflag,null,0,1) backprintflag,--回退业务打印次数 add by wanghuaiyu  20130618
       a.zxcolumn4,--ERP总单ID add by wanghuaiyu 2013年8月7日 18:46:25
       a.zxcolumn5,--add by weitangjing 20130922 ERP销退申请单业务员
       nvl(a.zxcolumn6,'0') mdid,-- xyue 2014-11-10 增加ERP门店ID
       md.placepointname,--xyue 2014-11-10 增加ERP门店名称
       a.gcompanyname, --add by weitangjing 20131102 原货主单位名称
       a.pctime, --派车日期 add by zyc 20160727
       a.cphid, --车辆ID add by zyc 20160727
       a.jsyid, --驾驶员ID add by zyc 20160727
       a.yssb,  --运输设备 add by zyc 20160727
       a.qywd,  --启运温度 add by zyc 20160727
       a.qhrid,   --取货人ID add by zyc 20160727
       nvl(a.pcusestatus,0) pcusestatus, --派车状态 add by zyc 20160727
       l.vehicleno, --车牌号 add by zyc 20160727
       m.drivername, --驾驶员 add by zyc 20160727
       n.employeename qhr, --取货人 add by zyc 20160727
       a.invoicecode,--发票代码 add by xyue 2016-08-27
       a.invoiceno,--发票号码 add by xyue 2016-08-27
       a.invoicedate,--发票日期 add by xyue 2016-08-27
       a.from_salesid,
       a.autoflag,
       a.orderno --雨诺单据编号
  from wms_in_order     a,
        tpl_warehouse   b,
        tpl_goodsowner  c,
        tpl_go_company  d,
        pub_employee    e,
        pub_employee    f,
        tpl_back_reason g,
        wms_transport_address h,
        wms_transport_mode i,
        pub_employee       dd,
        pub_employee     k,
        (select to_char(placepointid) placepointid,placepointname from lyerp.gpcs_placepoint) md, --xyue 2014-05-12 跨用户授权获取门店表
        Tms_vehicle l, --add by zyc 20160727
        TMS_DRIVER m, --add by zyc 20160727
        pub_employee n --add by zyc 20160727

  where a.warehid = b.warehid(+)
    and a.goodsownerid = c.goodsownerid(+)
    and a.sourcecompanyid = d.companyid(+)
    and a.inputmanid = e.employeeid(+)
    and a.confirmman = f.employeeid(+)
    and a.cancelmanid = dd.employeeid(+)
    and a.backprintmanid = k.employeeid(+)
    and a.transid = h.transid(+)
    and a.Sbreasonid=g.backid(+)
    and a.transmodeid = i.transmodeid(+)
    and a.zxcolumn6 = md.placepointid(+)
    and a.cphid=l.vehicleid(+)
    and a.jsyid=m.driverid(+)
    and a.qhrid=n.employeeid(+)
"
"WMS_IN_ORDER_V20171213","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_IN_ORDER_V20171213"" (""INID"", ""PORDERNO"", ""COMEFROM"", ""CREDATE"", ""ARRIVEDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""SOURCECOMPANYID"", ""SRCCOMPANYNAME"", ""MEDICINECLASS"", ""IMPORTFLAG"", ""TAXFLAG"", ""JOBTYPE"", ""OPERATIONTYPE"", ""DTLLINES"", ""MEMO"", ""INPUTMANID"", ""INPUTMANNAME"", ""SRCNO"", ""TRANSID"", ""INCEPTADDR"", ""EXPORDERID"", ""BILLFROM"", ""CONFIRMMAN"", ""CONFIRMNAME"", ""CONFIRMDATE"", ""USESTATUS"", ""MULRECFLAG"", ""RECCOUNT"", ""INMODE"", ""VALIDDAYS"", ""INVALIDATE"", ""ORDERFLAG"", ""GENFLAG"", ""SABACKDATE"", ""SBREASONID"", ""BACKREASON"", ""CUSTOMTYPE"", ""FINISHFLAG"", ""OLDID"", ""OTHERID"", ""TPRICETICK"", ""TPRICEFLAG"", ""DEPTNO"", ""DEPTNAME"", ""GCOMPANYID"", ""GCOMPANYNO"", ""GCOMPANYOPCODE"", ""BMSDOCID"", ""NOWLFLAG"", ""TRANSMODEID"", ""TRANSMODE"", ""TRANSNAME"", ""TRANSCLASS"", ""ZXCOLUMN2"", ""CANCELDATE"", ""CANCELMANID"", ""CANCELMANNAME"", ""PRINTID"", ""BACKPRINTMANID"", ""BACKPRINTMAN"", ""BACKPRINTDATE"", ""BACKPRINTFLAG"", ""ZXCOLUMN4"", ""ZXCOLUMN5"", ""MDID"", ""PLACEPOINTNAME"", ""GCOMPANYNAME"", ""CLFLAG"", ""PCTIME"", ""CPHID"", ""JSYID"", ""YSSB"", ""QYWD"", ""QHRID"", ""PCUSESTATUS"", ""VEHICLENO"", ""DRIVERNAME"", ""QHR"", ""INVOICECODE"", ""INVOICENO"", ""INVOICEDATE"") AS 
  select a.inid,
       a.porderno,
       a.comefrom,
       a.credate,
       a.arrivedate,
       a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.sourcecompanyid,
       d.companyname srccompanyname,
       a.medicineclass,
       a.importflag,
       a.taxflag,
       a.jobtype,
       a.operationtype,
       a.dtllines,
       a.memo,
       a.inputmanid,
       e.employeename inputmanname,
       a.srcno,
       a.transid,
       h.inceptaddr,
       a.exporderid,
       a.billfrom,
       a.confirmman,
       f.employeename confirmname,
       a.confirmdate,
       a.usestatus,
       a.mulrecflag,
       a.reccount,
       a.inmode,
       a.validdays,
       a.invalidate,
       a.orderflag,
       a.genflag,
       a.sabackdate,
       a.sbreasonid,
       g.backreason,
       a.customtype,
       a.finishflag,
       a.oldid,
       a.otherid,
       a.tpricetick,
       a.tpriceflag,
       a.deptno,
       a.deptname,
       d.gcompanyid,
       d.gcompanyno,
       d.gcompanyopcode,
       a.bmsdocid,
       a.nowlflag,
       a.transmodeid,
       i.transmode,
       i.transname,
       a.transclass,
       a.zxcolumn2,
       a.canceldate,
       a.cancelmanid,
       dd.employeename cancelmanname,
       a.printid,
       a.backprintmanid,--回退业务打印人ID add by wanghuaiyu  20130618
       k.employeename backprintman,--回退业务打印人 add by wanghuaiyu  20130618
       a.backprintdate,--回退业务打印时间 add by wanghuaiyu  20130618
       decode(a.backprintflag,null,0,1) backprintflag,--回退业务打印次数 add by wanghuaiyu  20130618
       a.zxcolumn4,--ERP总单ID add by wanghuaiyu 2013年8月7日 18:46:25
       a.zxcolumn5,--add by weitangjing 20130922 ERP销退申请单业务员
       nvl(a.zxcolumn6,'0') mdid,-- xyue 2014-11-10 增加ERP门店ID
       md.placepointname,--xyue 2014-11-10 增加ERP门店名称
       a.gcompanyname, --add by weitangjing 20131102 原货主单位名称
			 (SELECT aa.clflag
			 FROM wms_in_order_dtl  aa   WHERE aa.inid = a.inid  AND  Rownum=1)  clflag,
       a.pctime, --派车日期 add by zyc 20160727
       a.cphid, --车辆ID add by zyc 20160727
       a.jsyid, --驾驶员ID add by zyc 20160727
       a.yssb,  --运输设备 add by zyc 20160727
       a.qywd,  --启运温度 add by zyc 20160727
       a.qhrid,   --取货人ID add by zyc 20160727
       nvl(a.pcusestatus,0) pcusestatus, --派车状态 add by zyc 20160727
       l.vehicleno, --车牌号 add by zyc 20160727
       m.drivername, --驾驶员 add by zyc 20160727
       n.employeename qhr, --取货人 add by zyc 20160727
       a.invoicecode,--发票代码 add by xyue 2016-08-27
       a.invoiceno,--发票号码 add by xyue 2016-08-27
       a.invoicedate--发票日期 add by xyue 2016-08-27
  from wms_in_order     a,
        tpl_warehouse   b,
        tpl_goodsowner  c,
        tpl_go_company  d,
        pub_employee    e,
        pub_employee    f,
        tpl_back_reason g,
        wms_transport_address h,
        wms_transport_mode i,
        pub_employee       dd,
        pub_employee     k,
        (select to_char(placepointid) placepointid,placepointname from lyerp.gpcs_placepoint) md, --xyue 2014-05-12 跨用户授权获取门店表
        Tms_vehicle l, --add by zyc 20160727
        TMS_DRIVER m, --add by zyc 20160727
        pub_employee n --add by zyc 20160727

  where a.warehid = b.warehid(+)
    and a.goodsownerid = c.goodsownerid(+)
    and a.sourcecompanyid = d.companyid(+)
    and a.inputmanid = e.employeeid(+)
    and a.confirmman = f.employeeid(+)
    and a.cancelmanid = dd.employeeid(+)
    and a.backprintmanid = k.employeeid(+)
    and a.transid = h.transid(+)
    and a.Sbreasonid=g.backid(+)
    and a.transmodeid = i.transmodeid(+)
    and a.zxcolumn6 = md.placepointid(+)
"
"WMS_IN_RECINVE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_IN_RECINVE_V"" (""INID"", ""INDTLID"", ""ZD_USESTATUS"", ""CREDATE"", ""OPERATIONTYPE"", ""NOWLFLAG"", ""SOURCECOMPANYID"", ""SRCCOMPANYNAME"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""DD_QTY"", ""TRADEGOODSPACK"", ""APPROVEDOCNO"", ""GOODSPACKNAME"", ""PACKSIZE"", ""WHOLEQTY"", ""CONTAINERNO"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""SCATTERQTY"", ""RECMEMO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""RECEIVEDATE"", ""LPNCODE"", ""INPUTMANID"", ""INPUTMANNAME"", ""AREAID"", ""AREANAME"", ""SECTIONID"", ""SECTIONNAME"", ""POSID"", ""POSNO"", ""CHECKMAN1"", ""CHECKMAN2"", ""CHECKMEMO"", ""FACEQUALITY"", ""PACKQUALITY"", ""IMPORTREPFLAG"", ""PASSGATEFLAG"", ""REGISTEFLAG"", ""MEDCHECKFLAG"", ""ELIGIBILITYFLAG"", ""RPTNO"", ""SH_USESTATUS"") AS 
  select t1.inid,
       t2.indtlid,
       t1.usestatus zd_usestatus,
       t1.credate,
       t1.operationtype,
       nvl(t1.nowlflag, 0) nowlflag,
       t1.sourcecompanyid,
       t1.srccompanyname,
       t1.warehid,
       t1.warehname,
       t1.goodsownerid,
       t1.goodsownername,
       t2.goodsid,
       t2.goodsname,
       t2.goodstype,
       t2.prodarea,
       t2.factname,
       t2.goodsqty dd_qty,
       t2.tradegoodspack,
       t2.approvedocno,
       t3.goodspackname,
       t3.packsize,
       t3.wholeqty,
       t3.containerno,
       t3.goodsstatus,
       t3.quantitystatus,
       t3.scatterqty,
       t3.recmemo,
       t3.lotid,
       t3.lotno,
       decode(to_char(t3.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              t3.validdate) validdate,
       t3.proddate,
       t3.receivedate,
       t3.lpncode,
       t3.inputmanid,
       t4.employeename inputmanname,
       t5.areaid,
       t5.areaname,
       t5.sectionid,
       t5.sectionname,
       t5.posid,
       t5.posno,
       t3.checkman1,
       t3.checkman2,
       t3.checkmemo,
       t3.facequality,
       t3.packquality,
       t3.importrepflag,
       t3.passgateflag,
       t3.registeflag,
       t3.medcheckflag,
       t3.eligibilityflag,
       t3.rptno,t3.usestatus sh_usestatus
  from wms_in_order_v     t1,
       wms_in_order_dtl_v t2,
       wms_receive_dtl_v  t3,
       pub_employee       t4,
       wms_st_io_doc_v    t5
 where t1.inid = t2.inid
   and t2.indtlid = t3.indtlid(+)
   and t3.inputmanid = t4.employeeid(+)
   and t3.receiveid = t5.sourceid(+)
   and t5.inoutflag = 0
   and t5.comefrom = 1
"
"WMS_LOT_MODIFY_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_LOT_MODIFY_LST_V"" (""MODIFYID"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""LOTID"", ""TOLOTNO"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""PRODLICENSENO"", ""REGISTNO"", ""TOKILLLOTNO"", ""TOVALIDDATE"", ""TOPRODDATE"", ""TOAPPROVEDOCNO"", ""TOPRODLICENSENO"", ""TOREGISTNO"", ""USESTATUS"", ""MEMO"", ""MODIFYMANID"", ""EMPLOYEENAME"", ""MODIFYDATE"", ""MAH"", ""TOMAH"", ""PRINTMONTHFLAG"", ""TOPRINTMONTHFLAG"", ""LOTNOFACTNAME"", ""TOLOTNOFACTNAME"", ""PRINTEXPIREFLAG"", ""TOPRINTEXPIREFLAG"", ""PRODMONTHFLAG"", ""TOPRODMONTHFLAG"", ""CREDATE"", ""VALIDDATE2"", ""TOVALIDDATE2"") AS 
  select a.modifyid,
       a.goodsid,
       b.opcode,
       b.goodsname,
       b.goodstype,
       b.prodarea,
       a.lotid,
       a.tolotno,
       a.lotno,
       a.killlotno,
       a.validdate,
       a.proddate,
       a.approvedocno,
       a.prodlicenseno,
       a.registno,
       a.tokilllotno,
       decode(to_char(a.tovaliddate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.tovaliddate) tovaliddate,
       a.toproddate,
       a.toapprovedocno,
       a.Toprodlicenseno,
       a.toregistno,
       a.usestatus,
       a.memo,
       a.modifymanid,
       c.employeename,
       a.modifydate,
       a.mah,--add by xyue 2019-12-05 上市许可持有人
       a.tomah,--add by xyue 2019-12-05 上市许可持有人
       a.printmonthflag,--add by guzhiqi 2013-07-04
       a.toprintmonthflag，
       a.lotnofactname,--批号生产厂家add by wanghuaiyu 2013年7月25日 17:21:36
       a.tolotnofactname,--调整后批号生产厂家 add by wanghuaiyu 2013年7月25日 17:27:18
       a.printexpireflag,--add by xyue 2020-11-10
       a.toprintexpireflag,
       a.PRODMONTHFLAG,
       a.TOPRODMONTHFLAG,
       a.credate,
       a.validdate2,
       a.tovaliddate2
  from wms_lot_modify_lst a,
       tpl_pub_goods      b,
       pub_employee       c
 where a.goodsid = b.goodsid
 and a.modifymanid = c.employeeid(+)
"
"WMS_LOT_QTY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_LOT_QTY_V"" (""WAREHID"", ""GOODSOWNERID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSPACKID"", ""BATCHNO"", ""LOTID"", ""GOODSSTATUSID"", ""PACKSIZE"", ""VALIDDATE"", ""PRODDATE"", ""TPQTY"", ""TPPACKS"", ""WHOLEQTY"", ""WHOLEPACKS"", ""SCATTERQTY"", ""SCATTERPACKS"", ""GOODSQTY"", ""BUSIQTY"") AS 
  select a.warehid,
       a.goodsownerid,
       a.ownergoodsid,
       a.goodsid,
       a.goodspackid,
       a.batchno,
       a.lotid,
       a.goodsstatusid,
       c.packsize,
       decode(to_char(d.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              d.validdate) validdate,
       d.proddate,
       sum(decode(b.areaflag, 0, a.goodsqty, 0)) tpqty,
       sum(decode(b.areaflag, 0, a.goodsqty, 0) / c.packsize) tppacks,
       sum(decode(b.areaflag, 1, a.goodsqty, 0)) wholeqty,
       sum(decode(b.areaflag, 1, a.goodsqty, 0) / c.packsize) wholepacks,
       sum(decode(b.areaflag, 2, a.goodsqty, 0)) scatterqty,
       sum(floor(decode(b.areaflag, 2, a.goodsqty, 0) / c.packsize)) scatterpacks,
       sum(goodsqty) goodsqty,
       sum(nvl(a.busiqty, 0) + nvl(a.tradeinwaitqty, 0) -
           nvl(a.outwaitqty, 0)) busiqty
  from wms_st_qty_lst      a,
       wms_pos_def_v       b,
       tpl_pub_goods_packs c,
       wms_goods_lot       d
 where a.posid = b.posid
   and a.goodspackid = c.goodspackid
   and a.lotid = d.lotid
 group by a.warehid,
          a.goodsownerid,
          a.ownergoodsid,
          a.goodsid,
          a.goodspackid,
          a.batchno,
          a.lotid,
          a.goodsstatusid,
          c.packsize,
          d.validdate,
          d.proddate
"
"WMS_OPERATION_TO_SECTION_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_OPERATION_TO_SECTION_V"" (""RULEID"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""OPRATIONTYPE"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""PRIORITY"") AS 
  select A.""RULEID"",
       A.""WAREHID"",
       b.warehname,
       A.""GOODSOWNERID"",
       c.goopcode,
       c.goodsownername,
       A.""OPRATIONTYPE"",
       A.""SECTIONID"",
       d.sectionno,
       d.sectionname,
       A.""PRIORITY""
  from wms_operation_to_section A,
       tpl_warehouse            B,
       tpl_goodsowner           C,
       wms_st_section_def       D
       where a.warehid = b.warehid
       and a.goodsownerid = c.goodsownerid
       and a.sectionid = d.sectionid
"
"WMS_OUT_GATHER_LST_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_OUT_GATHER_LST_DTL_V"" (""GATHTERLSTDTLID"", ""GATHTERLSTID"", ""SOURCEID"", ""GATHERPOSID"", ""GATHERZONEID"", ""PACKS"", ""BOXCODE"", ""GATHERPOSNO"", ""GATHERPOS"", ""USESTATUS"", ""UPTIME"", ""DOWNTIME"", ""IWCS_SOURCEID"") AS 
  select a.gathterlstdtlid,
       a.gathterlstid,
       a.sourceid,
       a.gatherposid,
       b.gatherzoneid,
       a.packs,
       a.boxcode,
       b.gatherposno,
       b.gatherpos,
       a.usestatus,
       a.uptime,
       a.downtime,
       a.iwcs_sourceid
  from wms_out_gather_lst_dtl a,base_gather_zone_pos b
 where a.gatherposid = b.gatherposid
"
"WMS_OUT_GATHER_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_OUT_GATHER_LST_V"" (""GATHTERLSTID"", ""CREDATE"", ""INOUTID"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""WAVEID"", ""WAVEDTLID"", ""COMPANYID"", ""COMPANYNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""POSID"", ""POSNO"", ""POSNAME"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""OPERATIONTYPE"", ""COMEFROM"", ""OUTGOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""USESTATUS"", ""KEEPDATE"", ""RELEASEDATE"", ""FINISHDATE"", ""ROUTEID"", ""ROUTENAME"", ""TRANSID"", ""INCEPTADDR"", ""SENDPOS"") AS 
  select a.gathterlstid,
       a.credate,
       a.inoutid,
       a.warehid,
       d.warehname,
       a.goodsownerid,
       e.goodsownername,
       a.waveid,
       a.wavedtlid,
       a.companyid,
       j.companyname,
       b.ownergoodsid,
       f.waregoodsid goodsid,
       f.goodsname,
       f.goodstype,
       f.prodarea,
       f.factname,
       b.goodspackid,
       g.packname,
       g.packsize,
       b.lotid,
       i.lotno,
       i.proddate,
       i.validdate,
       i.approvedocno,
       b.sectionid,
       k.sectionno,
       k.sectionname,
       b.posid,
       l.posno,
       l.posname,
       b.goodsstatusid,
       m.goodsstatus,
       m.quantitystatus,
       b.operationtype,
       b.comefrom,
       b.outgoodsqty,
       b.wholeqty,
       b.scatterqty,
       a.usestatus,
       b.keepdate,
       a.releasedate,
       a.finishdate,
       c.routeid,
       n.routename,
       c.transid,
       o.inceptaddr,
       o.sendpos
  from wms_out_gather_lst    a,
       wms_st_io_doc         b,
       wms_wave_dtl          c,
       tpl_warehouse         d,
       tpl_goodsowner        e,
       tpl_goods             f,
       tpl_pub_goods_packs   g,
       wms_goods_lot         i,
       tpl_go_company        j,
       wms_st_section_def    k,
       wms_pos_def           l,
       wms_goodsstatus       m,
       wms_tr_route          n,
       wms_transport_address o
 where a.inoutid = b.inoutid
   and a.wavedtlid = c.wavedtlid
   and a.warehid = d.warehid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and b.ownergoodsid = f.ownergoodsid(+)
   and b.goodspackid = g.goodspackid(+)
   and b.lotid = i.lotid(+)
   and a.companyid = j.companyid(+)
   and b.sectionid = k.sectionid(+)
   and b.posid = l.posid(+)
   and b.goodsstatusid = m.goodsstatusid(+)
   and c.routeid = n.routeid(+)
   and c.transid = o.transid(+)
"
"WMS_OUT_ORDER_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_OUT_ORDER_DTL_V"" (""OUTID"", ""BMSINOUTID"", ""OUTDTLID"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTNAME"", ""OWNERGOODSID"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""PRICE"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""REALQTY"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""STOCKQTY"", ""CUSTCANCELSTATUS"", ""WMSCANCELSTATUS"", ""ADDMEDCHECKFLAG"", ""SRCEXPDTLNO"", ""USESTATUS"", ""PRINTFLAG"", ""PRINTERROR"", ""DISTRIBUTEID"", ""DISTRIBUTEDTLID"", ""RETAILPRICE"", ""AMT"", ""ALLOCATETIME"", ""FAILREASON"", ""EXPDTLMEMO"", ""PLACESUPPLYID"", ""PLACESUPPLYDTLID"", ""PLACEPRICE"", ""RESALEPRICE"", ""PLACEMONEY"", ""GOODSCLASSID"", ""OTCFLAG"", ""TRADEMARK"", ""APPROVEDOCNO"", ""REGISTNO"", ""JKHZFLAG"", ""PRODDATE"", ""QUALIFYDOCNO"", ""GOODSCLASSNAME"", ""OLDDTLID"", ""OTHERID"", ""EXPFLAG"", ""EXPDATE"", ""EXPFILENAME"", ""INVOICENO"", ""INVCODE"", ""INVOICELINE"", ""CANKEEP"", ""ZXCOLOR"", ""TPRICETICK"", ""TPRICEFLAG"", ""SORTTYPE"", ""LOTLIMIT"", ""PERIODLIMIT"", ""PERIODLIMITUNIT"", ""GOODSOWNID"", ""PRTORDERSET"", ""DTLMEMO"", ""GOODSCLASS"", ""GOODSNO"", ""PRINTNO"", ""WAVEGOODSDTLID"", ""CANCELDATE"", ""WAITFORCANCEL"", ""CANCELMANID"", ""LYDTLZXCOLUMN3"", ""LYDTLZXCOLUMN1"", ""LYDTLZXCOLUMN2"", ""LYDTLZXCOLUMN4"", ""LYDTLZXCOLUMN5"", ""LYDTLZXCOLUMN6"", ""LYDTLZXCOLUMN7"", ""PRINTMONTHFLAG"", ""CANCELMANNAME"", ""DTLZXCOLUMN4"", ""LYDTLZXCOLUMN8"", ""LYDTLZXCOLUMN9"", ""LYDTLZXCOLUMN10"", ""LYDTLZXCOLUMN11"", ""LYDTLZXCOLUMN12"", ""LYDTLZXCOLUMN13"", ""MAH"", ""PRINTEXPIREFLAG"", ""PRINTPRODFLAG"", ""FROM_SUDTLID"", ""ECODEFLAG"", ""TO_GOODSOWNERID"", ""TO_OWNERGOODSID"", ""TO_GOODSID"", ""TO_LOTID"", ""TO_GOODSPACKID"", ""TO_USESTATUS"", ""TO_ERRORMEMO"", ""SOURCEOUTDTLID"", ""AUTOTASKFLAG"", ""AUTOCREDATE"", ""TO_ERPINDTLID"", ""TO_ERPOUTDTLID"", ""TO_PRINTPRICE"", ""TO_PRINTAMT"", ""VALIDDATE2"", ""VALIDDATE3"", ""PRODMONTHFLAG"", ""PRODLICENSENO"", ""INVOADDRESS"", ""PRINT_GOODSNAME"", ""PRINT_GOODSTYPE"", ""DISCOUNT_FALG"", ""DISCOUNT_SADTLID"", ""DISCOUNT_GOODSID"", ""DISCOUNT_AMT"", ""DISCOUNT_TAXRATE"", ""DISCOUNT_DATE"", ""DISCOUNT_MSG"") AS 
  select a.outid,
       a.bmsinoutid,
       a.outdtlid,
       a.warehid,
       a.goodsownerid,
       a.goodsid,
       e.goodsname,
       e.goodsengname, --增加通用名字段,xyue 2013年10月28日 8:03:54
       e.goodstype,
       e.prodarea,
       b.factid,
       nvl(g.factname, e.factname) factname, --取批号上的生产厂家 zhaocl 2013年7月26日 17:21:46
       -- 取货主货品信息上的厂家信息 xyue 2017-04-10
       a.ownergoodsid,
       a.batchno,
       a.lotid,
       g.lotno,
       g.killlotno, --xyue 2014-06-02 批号信息上的灭菌批号，器械要求
       decode(to_char(g.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              g.validdate) validdate,
       a.goodsstatusid,
       d.goodsstatus,
       a.quantitystatus,
       a.price,
       a.goodsqty,
       a.goodspackid,
       c.packname,
       c.packsize,
       a.realqty,
       a.tradegoodsqty,
       a.tradegoodspack,
       a.stockqty,
       a.custcancelstatus,
       a.wmscancelstatus,
       a.addmedcheckflag,
       a.srcexpdtlno,
       a.usestatus,
       decode(a.printflag, null, null, 1) printflag,
       a.printerror,
       a.distributeid,
       a.distributedtlid,
       a.retailprice,
       a.amt,
       a.allocatetime,
       a.failreason,
       a.expdtlmemo,
       a.placesupplyid,
       a.placesupplydtlid,
       a.placeprice,
       a.resaleprice,
       a.placemoney,
       a.goodsclassid,
       a.otcflag,
       a.trademark,
       g.approvedocno,
       g.registno,
       b.jkhzflag,
       --g.proddate,
       decode(to_char(g.proddate, 'yyyy-mm-dd'),
              '1900-01-01',
              to_date(null, 'yyyy-mm-dd'),
              g.proddate) proddate,
       a.qualifydocno,
       a.goodsclassname,
       a.olddtlid,
       a.otherid,
       a.expflag,
       a.expdate,
       a.expfilename,
       a.invoiceno,
       a.invcode, --发票代码 add by xyue 2017-11-28
       a.invoiceline,
       a.cankeep,
       a.zxcolor,
       a.tpricetick,
       a.tpriceflag,
       a.sorttype,
       a.lotlimit,
       a.periodlimit,
       a.periodlimitunit,
       e.goodsownid,
       a.prtorderset,
       a.dtlmemo,
       f.goodsclass,
       e.goodsno,
       a.printno,
       a.wavegoodsdtlid,
       a.canceldate,
       a.waitforcancel,
       a.cancelmanid,
       a.Lydtlzxcolumn3, --原价 zhaocl 2013年7月22日 17:25:23
       a.Lydtlzxcolumn1, --折扣率 zhaocl 2013年7月22日 17:33:51
       a.Lydtlzxcolumn2, --价格类型 zhaocl 2013年7月22日 17:33:51
       a.Lydtlzxcolumn4, --标期 zhaocl 2013年7月22日 17:33:51
       a.Lydtlzxcolumn5, --打印单位 zhaocl 2013年7月22日 17:33:51
       a.Lydtlzxcolumn6, --换算比例 zhaocl 2013年7月22日 17:33:51
       a.lydtlzxcolumn7, --打印分类 add by wanghuaiyu 2013年7月30日 21:52:20
       g.printmonthflag, --打印精确到月 zhaocl 2013年7月22日 18:41:22
       dd.employeename cancelmanname,
       a.dtlzxcolumn4, --ERP细单ID add by wanghuaiyu 2013年8月7日 18:03:09
       a.lydtlzxcolumn8, --ERP细单税率 add by xyue 2013年9月16日 20:27:54
       a.lydtlzxcolumn9, --器械别名系统，ERP细单打印通用名 add by xyue 2013年10月05日 23:27:54
       a.lydtlzxcolumn10, --器械别名系统，ERP细单打印商品名 add by xyue 2013年10月05日 23:27:54
       a.lydtlzxcolumn11, --器械别名系统，ERP细单打印规格 add by xyue 2013年10月05日 23:27:54
       a.lydtlzxcolumn12, --器械别名系统，ERP细单打印产地 add by xyue 2013年10月05日 23:27:54
       a.lydtlzxcolumn13,--折扣实际金额，add by xyue 2024-02-26
       g.mah, --add by xyue 2019-12-05 上市许可持有人
       g.printexpireflag, --add by xyue 2020-11-13 打印失效期
       g.printprodflag, --add by xyue 2022-05-07
       a.from_sudtlid,
       nvl(e.ecodeflag, 0) ecodeflag, --add by xyue 2022-06-29
       a.to_goodsownerid,--转单目标货主ID
       a.to_ownergoodsid,--转单目标货主货品ID
       a.to_goodsid,--转单目标货品主档ID
       a.to_lotid,--转单目标批号ID
       a.to_goodspackid,--转单目标包装ID
       a.to_usestatus,--转单细单状态  1-基础数据转换完成 2-入库数据生成完成 3-出库数据生成完成
       a.to_errormemo,--转单异常信息
       a.sourceoutdtlid,--源物流出库细单ID
       a.autotaskflag,--系统自动生成标志
       a.autocredate, --转单自动生成时间
       a.to_erpindtlid,
       a.to_erpoutdtlid,
       a.to_printprice,
       a.to_printamt,
       decode(to_char(g.validdate2, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              g.validdate2) validdate2,
       g.validdate2   validdate3,
       g.prodmonthflag , --取批号上的生产日期到月标志tl@231110
       g.prodlicenseno,  --生产许可证号 tl@231207
       a.invoaddress,
       e.print_goodsname,--生僻字货品名称
       e.print_goodstype, --生僻字规格
       a.discount_falg, --折扣标志 单选框
       a.discount_sadtlid, --折扣货主细单ID
       a.discount_goodsid, --折扣货主原货品ID
       a.discount_amt, --折扣金额
       a.discount_taxrate, --折扣税率
       a.discount_date, --折扣更新时间
       a.discount_msg --折扣更新信息
    from wms_out_order_dtl   a,
       tpl_pub_goods       b,
       tpl_pub_goods_packs c,
       wms_goodsstatus     d,
       tpl_goods           e,
       wms_goods_feature   f,
       wms_goods_lot       g,
       tpl_pub_company     h,
       pub_employee        dd
 where a.goodsid = b.goodsid(+)
   and a.goodspackid = c.goodspackid(+)
   and a.goodsstatusid = d.goodsstatusid(+)
   and a.ownergoodsid = e.ownergoodsid
   and a.goodsid = f.goodsid(+)
   and a.warehid = f.warehid(+)
   and a.lotid = g.lotid(+)
   and b.factid = h.companyid(+)
   and a.cancelmanid = dd.employeeid(+)
"
"WMS_OUT_ORDER_LOT_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_OUT_ORDER_LOT_DTL_V"" (""OUTDTLID"", ""WAVEGOODSDTLID"", ""GOODSQTY"", ""OUTLOTID"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""PRODLICENSENO"") AS 
  select a.outdtlid,
       a.wavegoodsdtlid,
       a.realqty goodsqty,
       a.outlotid,
       a.lotid,
       b.lotno,
       decode(to_char(b.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              b.validdate) validdate,
       b.proddate,
       b.approvedocno,
       b.registno,
       b.prodlicenseno
  from wms_out_order_lot_dtl a, wms_goods_lot b
 where a.lotid = b.lotid(+)
"
"WMS_OUT_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_OUT_ORDER_V"" (""WAREHID"", ""GOODSOWNERID"", ""COMEFROM"", ""OUTID"", ""WAVEID"", ""WAVEDTLID"", ""EORDERNO"", ""LINENO"", ""CREDATE"", ""PREEXPDATE"", ""EXPDATE"", ""PREARRIVEDATE"", ""ARRIVEDATE"", ""PTRANSMODEID"", ""TRANSMODEID"", ""EARLYDATE"", ""COMPOSEINFO"", ""TRANSNO"", ""RECCOMPANYID"", ""COMPANYTYPE"", ""TAXFLAG"", ""INPUTMANID"", ""JOBTYPE"", ""OPERATIONTYPE"", ""MEDICINECLASS"", ""RECEIVEADDR"", ""RECEIVEHEAD"", ""REALRECADDR"", ""REALRECMAN"", ""RECEIVEMAN"", ""SIGNMAN"", ""PARTEXPFLAG"", ""SAMELOTFLAG"", ""URGENFLAG"", ""ADDINVOICEFLAG"", ""ARRIVEMEMO"", ""EXPORTMEMO"", ""DETAILLINES"", ""SRCEXPNO"", ""TRANSID"", ""PORDERID"", ""BILLFROM"", ""CONFIRMMAN"", ""CONFIRMDATE"", ""USESTATUS"", ""OUTMODE"", ""INVOICETYPE"", ""TRANSCLASS"", ""SCATTERPACKS"", ""SCATTERFINPACKS"", ""WHOLEPACKS"", ""WHOLEFINPACKS"", ""ALLOCATETIME"", ""FINISHFLAG"", ""FIXFLAG"", ""SALERID"", ""SALERNAME"", ""OLDID"", ""OTHERID"", ""TPRICETICK"", ""TPRICEFLAG"", ""DEPTNO"", ""DEPTNAME"", ""RECEIVEPHONE"", ""TRDTLID"", ""SASETTLEDTLID"", ""PRTCLASS"", ""PRTGROUPSET"", ""TIME1"", ""TIME2"", ""TIME3"", ""TIME4"", ""PRTINVFLAG"", ""WAREHNAME"", ""GOODSOWNERNAME"", ""GCOMPANYID"", ""GCOMPANYNO"", ""CUSTTYPE"", ""CONFIRMNAME"", ""EMPLOYEENAME"", ""PTRANSMODE"", ""PTRANSNAME"", ""RECCOMPANYNAME"", ""TRANSMODE"", ""TRANSNAME"", ""NOWLFLAG"", ""ROUTEID"", ""ROUTENAME"", ""INTOWNFLAG"", ""CONNECTOR"", ""CONNPHONE"", ""TELEPHONE"", ""EMPLOYEEID"", ""MANOPCODE"", ""MANNAME"", ""CANCELDATE"", ""WAITFORCANCEL"", ""CANCELMANID"", ""CANCELMANNAME"", ""SENDPOINTFLAG"", ""ZX_RETURNADDRESS"", ""ZX_RECEIVECOMPAY"", ""ZX_CONTACTMAN"", ""ZX_TELPHONE"", ""ZX_PICKMAN"", ""ZX_CARD"", ""ZX_PICKDEMAND"", ""ZX_FREIGHTASSUME"", ""ZX_MAILBOX"", ""ZX_DELIVERMETHOD"", ""ZX_TRANMETHOD"", ""ZX_PROTECTPRICE"", ""ZXCOLUMN4"", ""GCOMPANYNAME"", ""WMSMEMO"", ""IWCS_MSG"", ""IWCS_DATE"", ""IWCS_FLAG"", ""FROM_SUDOCID"", ""AUTOFLAG"", ""TO_RECCOMPANYID"", ""TO_TRANSID"", ""TO_USESTATUS"", ""TO_FINISHTIME"", ""TO_ERRORMEMO"", ""TO_COMPANYID"", ""SOURCEOUTID"", ""AUTOTASKFLAG"", ""AUTOCREDATE"", ""SOURCEWAVEDTLID"", ""PASSINGFLAG"", ""AUTOPASSFLAG"", ""TOGOODSOWNERID"", ""TOGOODSOWNERNAME"", ""TO_EXPCOMPANYID"", ""TO_ADDRESSID"", ""TO_ERPINID"", ""TO_ERPOUTID"", ""CHECKLICENSE"", ""APPROVEFLAG"", ""WARECHECKLICENSE"", ""ZX_DJFLAG"", ""YBPS"", ""ORDERNO"", ""YSORDERFLAG"", ""YSCREDATE"") AS 
  SELECT a.warehid,
       a.goodsownerid,
       a.comefrom,
       a.outid,
       a.waveid,
       a.wavedtlid,
       a.eorderno,
       a.lineno,
       a.credate,
       a.preexpdate,
       a.expdate,
       a.prearrivedate,
       a.arrivedate,
       a.ptransmodeid,
       a.transmodeid,
       a.earlydate,
       a.composeinfo,
       a.transno,
       a.reccompanyid,
       a.companytype,
       a.taxflag,
       a.inputmanid,
       a.jobtype,
       a.operationtype,
       a.medicineclass,
       a.receiveaddr,
       a.receivehead,
       a.realrecaddr,
       a.realrecman,
       a.receiveman,
       a.signman,
       a.partexpflag,
       a.samelotflag,
       nvl(a.urgenflag, 0) urgenflag,
       a.addinvoiceflag,
       a.arrivememo,
       --a.exportmemo,
       (case
         when a.goodsownerid = 682 and a.reccompanyid = 1791345 then
          e.sendpos
         else
          case
            when a.goodsownerid = 4 and a.reccompanyid = 29579 then
             e.sendpos
            else
            --case
            --when a.goodsownerid = 9102 then
            -- null
            --else
             a.exportmemo
          --end
          end
       end) exportmemo,
       a.detaillines,
       a.srcexpno,
       a.transid,
       a.porderid,
       a.billfrom,
       a.confirmman,
       a.confirmdate,
       a.usestatus,
       a.outmode,
       a.invoicetype,
       a.transclass,
       a.scatterpacks,
       a.scatterfinpacks,
       a.wholepacks,
       a.wholefinpacks,
       a.allocatetime,
       a.finishflag,
       a.fixflag,
       a.salerid,
       a.salername,
       a.oldid,
       a.otherid,
       a.tpricetick,
       a.tpriceflag,
       a.deptno,
       a.deptname,
       nvl(a.receivephone, e.connphone) receivephone,
       a.trdtlid,
       a.sasettledtlid,
       a.prtclass,
       a.prtgroupset,
       a.time1,
       a.time2,
       a.time3,
       a.time4,
       a.prtinvflag,
       c.warehname,
       d.goodsownername,
       f.gcompanyid,
       f.gcompanyno,
       substr(f.gcompanyno, 6, 1) custtype,
       j.employeename confirmname,
       g.employeename,
       h.transmode ptransmode,
       h.transname ptransname,
       f.companyname reccompanyname,
       b.transmode,
       b.transname,
       a.nowlflag,
       l.routeid,
       l.routename,
       l.intownflag,
       f.connector,
       f.connphone,
       f.telephone,
       a.employeeid,
       aa.opcode manopcode,
       aa.employeename manname,
       a.canceldate,
       a.waitforcancel,
       a.cancelmanid,
       dd.employeename cancelmanname,
       --用于处理合并发波策略，204货主所有订单不合并发波，业务类型是12-进货退出的不合并发波
       (case
         when a.goodsownerid = 204 then
          to_char(a.outid)
         when a.operationtype = 12 then
          to_char(a.outid)
         else
          a.zxcolumn1
       end) as sendpointflag,
       --decode(a.goodsownerid, 204, a.outid, a.zxcolumn1) sendpointflag, --是否送到门店  add by wanghuaiyu 20130619
       a.LYZXCOLUMN9  zx_returnaddress, --退货地址（文本）add by wanghuaiyu 2013年7月29日 23:12:37
       a.LYZXCOLUMN10 zx_receivecompay, --收货单位（文本）add by wanghuaiyu 2013年7月29日 23:12:37
       a.LYZXCOLUMN11 zx_contactman, --联系人（文本）add by wanghuaiyu 2013年7月29日 23:12:37
       a.LYZXCOLUMN12 zx_telphone, --联系电话（文本）add by wanghuaiyu 2013年7月29日 23:12:37
       a.LYZXCOLUMN13 zx_pickman, --提货人 add by wanghuaiyu 2013年7月29日 23:12:37
       a.LYZXCOLUMN14 Zx_Card, --身份证（文本）add by wanghuaiyu 2013年7月29日 23:12:37
       a.LYZXCOLUMN15 zx_pickdemand, --提货要求（文本）add by wanghuaiyu 2013年7月29日 23:12:37
       a.LYZXCOLUMN16 zx_freightassume, --运费承担（自定义下拉）add by wanghuaiyu 2013年7月29日 23:12:37
       a.LYZXCOLUMN17 zx_mailbox, --邮箱（文本）add by wanghuaiyu 2013年7月29日 23:12:37
       a.LYZXCOLUMN18 zx_delivermethod, --送货待遇（自提、送货）add by wanghuaiyu 2013年7月29日 23:12:37
       a.LYZXCOLUMN19 zx_tranmethod, --送货方式（同客户对应的送货方式，自定义下拉）add by wanghuaiyu 2013年7月29日 23:12:37
       a.LYZXCOLUMN20 zx_protectprice, --保价（文本）add by wanghuaiyu 2013年7月29日 23:12:37
       a.zxcolumn4, --ERP总单ID add by wanghuaiyu 2013年8月6日 17:54:54
       a.gcompanyname, --add by weitangjing 20131102 货主原单位名称
       -- t.printdate --xyue 2014-06-03 随货同行联打印时间
       a.wmsmemo, --add by zyc 2015-12-8 物流备注
       decode(a.iwcs_msg,
              '此单据已经处理完成，并且反馈成功，不可重复执行。',
              NULL,
              a.iwcs_msg) iwcs_msg,
       a.iwcs_date,
       decode(a.iwcs_msg,
              NULL,
              0,
              '此单据已经处理完成，并且反馈成功，不可重复执行。',
              0,
              1) iwcs_flag,
       a.from_sudocid,
       a.autoflag, --调拨标志
       a.autoflag to_reccompanyid, --自动转单目标货主的erp客户ID，大药房是门店ID
       a.to_transid, --自动转单目标货主的客户运输地址
       a.to_usestatus, --转单状态 1-基础数据转换完成 2-入库数据生成完成 3-出库数据生成完成
       a.to_finishtime, --转单时间
       a.to_errormemo, --转单异常信息
       a.to_companyid, --目标货主的客户单位ID
       a.sourceoutid, --源出库订单ID
       a.autotaskflag, --系统自动生成标志
       a.autocredate, --转单自动生成时间
       a.sourcewavedtlid, --源随货同行号
       nvl(a.passingflag, 0) passingflag, --转单标志
       nvl(a.autopassflag, 0) autopassflag, --自动转单
       a.togoodsownerid,
       (SELECT y.goodsownername
          FROM tpl_goodsowner y
         WHERE a.togoodsownerid = y.goodsownerid) togoodsownername,
       a.to_expcompanyid,
       a.to_addressid,
       a.to_erpinid,
       a.to_erpoutid,
       d.checklicense,
       d.approveflag,
       (SELECT x.checklicense
          FROM tpl_goodsowner_to_warehouse x
         WHERE x.warehid = a.warehid
           AND x.goodsownerid = a.goodsownerid) warechecklicense,
       nvl(a.zx_djflag, 0) zx_djflag,
       e.ybps,
       a.orderno, --雨诺系统的单据编号
       a.ysorderflag, --云商订单标志
       a.yscredate --云商订单下单时间
  FROM wms_out_order         a,
       wms_transport_mode    b,
       tpl_warehouse         c,
       tpl_goodsowner        d,
       tpl_go_company        f,
       pub_employee          g,
       wms_transport_mode    h,
       pub_employee          j,
       tms_route_pos         k,
       wms_tr_route          l,
       pub_employee          aa,
       pub_employee          dd,
       wms_transport_address e
 WHERE a.transmodeid = b.transmodeid(+)
   AND a.warehid = c.warehid(+)
   AND a.goodsownerid = d.goodsownerid(+)
   AND a.reccompanyid = f.companyid(+)
   AND a.inputmanid = g.employeeid(+)
   AND a.confirmman = j.employeeid(+)
   AND a.ptransmodeid = h.transmodeid(+)
   AND a.transid = k.transid(+)
   AND a.warehid = k.warehid(+)
   AND k.routeid = l.routeid(+)
   AND a.transid = e.transid(+)
   AND a.employeeid = aa.employeeid(+)
   AND a.cancelmanid = dd.employeeid(+)
"
"WMS_PACKING_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_PACKING_V"" (""INOUTID"", ""BOXDOCID"", ""CREDATE"", ""BINDDATE"", ""CONTAINERID"", ""CONTAINERNO"", ""KEEPMANID"", ""WAVEDTLID"", ""USESTATUS"", ""COMPANYID"", ""COMPANYNAME"", ""COMPANYSHORTNAME"", ""TASKID"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""TRANSID"", ""INCEPTADDR"", ""SCATTERQTY"", ""GOODSQTY"", ""RFFLAG"", ""RFMANID"", ""RFMAN"", ""CHECKSTATUS"", ""PACKINGFLAG"", ""BUSIQTY"", ""CHECKMANID"", ""WAREHID"", ""CHECKMANNAME"") AS 
  select b.inoutid,
       a.boxdocid,
       a.credate,
       a.binddate,
       a.containerid,
       i.containerno,
       b.keepmanid,
       a.wavedtlid,
       a.usestatus,
       a.companyid,
       c.companyname,
       c.companyshortname,
       b.taskid,
       b.goodsid,
       d.opcode,
       d.goodsname,
       d.goodstype,
       d.prodarea,
       b.goodspackid,
       e.packname,
       e.packsize,
       b.goodsstatusid,
       f.goodsstatus,
       b.quantitystatus,
       b.lotid,
       h.lotno,
       -- h.validdate,
       --h.proddate,
       decode(to_char(h.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              null,
              to_char(h.validdate, 'yyyy-mm-dd')) validdate,
       to_char(h.proddate, 'yyyy-mm-dd') proddate,
       k.transid,
       l.inceptaddr,
       b.Checkedqty scatterqty,
       b.Checkedqty goodsqty,
       b.rfflag,
       b.rfmanid,
       j.employeename rfman,
       b.checkstatus,
       nvl(b.packingflag, 0) packingflag,
       nvl(sum(g.goodsqty), 0) busiqty,
       b.checkmanid,
       b.warehid,
       m.employeename checkmanname
  from wms_turnbox_doc        a,
       wms_st_io_doc          b,
       tpl_pub_goods          d,
       tpl_go_company         c,
       tpl_pub_goods_packs    e,
       wms_goodsstatus        f,
       wms_turnbox_to_box_rel g,
       wms_goods_lot          h,
       wms_container_def      i,
       pub_employee           j,
       wms_wave_dtl           k,
       wms_transport_address  l,
       pub_employee           m
 where a.boxdocid = b.boxdocid
   and a.containerid = i.containerid
   and a.companyid = c.companyid
   and b.goodsid = d.goodsid
   and b.goodspackid = e.goodspackid
   and b.lotid = h.lotid
   and b.inoutid = g.inoutid(+)
   and a.usestatus in (2, 3)
   and b.rfmanid = j.employeeid(+)
   and b.checkstatus = 1
   and b.goodsstatusid = f.goodsstatusid
   and a.wavedtlid = k.wavedtlid
   AND k.transid = l.transid(+)
   AND b.checkmanid = m.employeeid(+)
 group by a.boxdocid,
          a.credate,
          a.binddate,
          a.containerid,
          i.containerno,
          b.keepmanid,
          a.wavedtlid,
          a.usestatus,
          a.companyid,
          c.companyname,
          c.companyshortname,
          b.inoutid,
          b.taskid,
          b.goodsid,
          d.opcode,
          d.goodsname,
          d.goodstype,
          d.prodarea,
          b.goodspackid,
          e.packname,
          e.packsize,
          b.goodsstatusid,
          f.goodsstatus,
          b.quantitystatus,
          b.lotid,
          h.lotno,
          h.validdate,
          h.proddate,
          b.Checkedqty,
          b.outgoodsqty,
          b.rfflag,
          b.rfmanid,
          j.employeename,
          b.checkstatus,
          packingflag,
          k.transid,
          l.inceptaddr,
          b.checkmanid,
          m.employeename,
          b.warehid
"
"WMS_PACKSEQ_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_PACKSEQ_LST_V"" (""SEQID"", ""INOUTID"", ""CREDATE"", ""QTY"", ""PACKSEQ"", ""CREMANID"", ""CREMAN"") AS 
  select t.seqid,
       t.inoutid,
       t.credate,
       t.qty,
       t.packseq,
       t.cremanid,
       a.employeename creman
  from wms_packseq_lst t,
  pub_employee a
  where t.cremanid = a.employeeid(+)

 "
"WMS_PACK_MODIFY_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_PACK_MODIFY_LST_V"" (""MODIFYID"", ""MODIFYDATE"", ""MODIFYMANID"", ""GOODSID"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSCUBAGE"", ""GOODSWEIGHT"", ""WEIGHTUNIT"", ""TOPACKNAME"", ""TOPACKSIZE"", ""TOGOODSLENGTH"", ""TOGOODSWIDTH"", ""TOGOODSHEIGHT"", ""TOGOODSCUBAGE"", ""TOGOODSWEIGHT"", ""TOWEIGHTUNIT"", ""USESTATUS"", ""MEMO"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""EMPLOYEENAME"") AS 
  select
        a.MODIFYID,
        a.MODIFYDATE,
        a.MODIFYMANID,
        a.GOODSID,
        a.GOODSPACKID,
        a.PACKNAME,
        a.PACKSIZE,
        a.goodsLENGTH,
        a.goodsWIDTH,
        a.goodsHEIGHT,
        a.goodsCUBAGE,
        a.goodsWEIGHT,
        a.WEIGHTUNIT,
        a.TOPACKNAME,
        a.TOPACKSIZE,
        a.TOgoodsLENGTH,
        a.TOgoodsWIDTH,
        a.TOgoodsHEIGHT,
        a.TOgoodsCUBAGE,
        a.TOgoodsWEIGHT,
        a.TOWEIGHTUNIT,
        a.USESTATUS,
        a.MEMO,
        b.opcode,
        b.goodsname,
        b.goodstype,
        b.prodarea,
        c.employeename
        from wms_pack_modify_lst a,
       tpl_pub_goods      b,
       pub_employee       c
 where a.goodsid = b.goodsid
 and a.modifymanid = c.employeeid(+)
"
"WMS_PACK_SHIP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_PACK_SHIP_V"" (""WAVEID"", ""WAVEDTLID"", ""RECCOMPANYID"", ""ORDERID"", ""SCATTERPACKS"", ""SCATTERFINPACKS"", ""WHOLEPACKS"", ""WHOLEFINPACKS"", ""USESTATUS"", ""TRANSID"", ""DEPTNO"", ""INVOICETYPE"", ""ORDERS_SET"", ""MEMO"", ""DEPTNAME"", ""FLOWLINENO"", ""PACKEDQTY"", ""OPERATIONTYPE"", ""OUTMODE"", ""PRINTFLAG"", ""PRINTDATE"", ""PRINTMANID"", ""ROUTEID"", ""PRTCLASS"", ""SENDFLAG"", ""GOODSOWNERID"", ""TRANSCLASS"", ""YJDPRINTFLAG"", ""YJDPRINTMANID"", ""YJDPRINTDATE"", ""SHIPZONEID"", ""SHIPZONEFLAG"", ""DOCID"", ""SHIPPOSFLAG"", ""SHIPPOSID"") AS 
  select b.waveid,
         b.wavedtlid,
         b.customid reccompanyid,
         b.orderid,
         b.scatterpacks,
         b.scatterfinpacks,
         b.wholepacks,
         b.wholefinpacks,
         b.usestatus,
         b.transid,
         b.deptno,
         b.invoicetype,
         b.orders_set,
         b.memo,
         b.deptname,
         b.flowlineno,
         b.packedqty,
         b.operationtype,
         b.outmode,
         decode(b.printflag,null,null,1) printflag,
         b.printdate,
         b.printmanid,
         b.routeid,
         b.prtclass,
         b.sendflag,
         b.goodsownerid,
         b.transclass,
         b.yjdprintflag,
         b.yjdprintmanid,
         b.yjdprintdate,
         b.shipzoneid,
         b.shipzoneflag,
         a.docid,
         a.shipposflag,
         a.shipposid
    from wms_box_doc a, wms_wave_dtl b
   where a.wavedtlid = b.wavedtlid
"
"WMS_PARTSOUT_CHECKED_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_PARTSOUT_CHECKED_V"" (""BOXDOCID"", ""CREDATE"", ""BINDDATE"", ""CONTAINERID"", ""CONTAINERNO"", ""PICKMANID"", ""WAVEDTLID"", ""USESTATUS"", ""COMPANYID"", ""COMPANYNAME"", ""COMPANYSHORTNAME"", ""INOUTID"", ""TASKID"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""SCATTERQTY"", ""OUTGOODSQTY"", ""GOODSQTY"", ""RFFLAG"", ""RFMANID"", ""RFMAN"", ""CHECKSTATUS"", ""INNERSEQ"", ""POSNO"", ""GOODSOWNERNAME"", ""DBCHECK"", ""TRADEPACKNAME"", ""GOODSOWNID"", ""OPERATIONTYPE"", ""SALERID"", ""SALERNAME"", ""PICKMAN"", ""CHECKMANID"", ""CHECKMANNAME"") AS 
  select a.boxdocid,
       a.credate,
       a.binddate,
       a.containerid,
       i.containerno,
       a.pickmanid,
       a.wavedtlid,
       a.usestatus,
       a.companyid,
       c.companyname,
       c.companyshortname,
       b.inoutid,
       b.taskid,
       b.goodsid,
       d.opcode,
       d.goodsname,
       d.goodstype,
       d.prodarea,
       b.goodspackid,
       e.packname,
       e.packsize,
       b.goodsstatusid,
       f.goodsstatus,
       g.ddlname quantitystatus,
       b.lotid,
       h.lotno,
       decode(to_char(h.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              null,
              to_char(h.validdate,'yyyy-mm-dd')) validdate,
       to_char(h.proddate,'yyyy-mm-dd')proddate,
       b.scatterqty,
       b.outgoodsqty,
       b.goodsqty,
       b.rfflag,
       b.rfmanid,
       j.employeename rfman,
       b.checkstatus,
       l.innerseq,
       l.posno,
       m.goodsownername,
       nvl(k.dbcheck,0) dbcheck,
       k.tradepackname,
       k.goodsownid,
       b.operationtype,
       aa.salerid,
       aa.salername,
       cc.employeename pickman,
       b.checkmanid,
       dd.employeename checkmanname
  from wms_turnbox_doc    a,
       wms_st_io_doc       b,
       tpl_pub_goods       d,
       tpl_go_company     c,
       tpl_pub_goods_packs e,
       wms_goodsstatus     f,
       sys_ddl_all_v       g,
       wms_goods_lot       h,
       wms_container_def   i,
       pub_employee        j,
       tpl_goods           k,
       wms_pos_def         l,
       tpl_goodsowner      m,
       wms_out_order aa,
       wms_wave_goods_dtl bb,
       pub_employee cc,
       pub_employee dd
 where a.boxdocid = b.boxdocid
   and a.containerid = i.containerid
   and a.companyid = c.companyid
   and b.goodsid = d.goodsid
   and b.goodspackid = e.goodspackid
    and b.goodsstatusid = f.goodsstatusid
   and b.lotid = h.lotid
   and b.ownergoodsid = k.ownergoodsid
   and f.quantitystatus = g.ddlid
   and g.keyword = 'TPL_QUANTITYSTATUS'
   and b.usestatus = 1
   and b.rfmanid = j.employeeid(+)
   and b.posid = l.posid
   and k.goodsownerid = m.goodsownerid
   AND b.sourceid = bb.wavegoodsdtlid(+)
   AND bb.wavedtlid = aa.wavedtlid(+)
   AND a.pickmanid = cc.employeeid(+)
   AND b.checkmanid=dd.employeeid(+)
"
"WMS_PARTSOUT_CHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_PARTSOUT_CHECK_V"" (""BOXDOCID"", ""WAREHID"", ""GOODSID"", ""OWNERGOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""BARCODE"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""CHECKSTATUS"", ""DBCHECK"", ""OUTGOODSQTY"", ""GOODSQTY"", ""CHECKEDQTY"", ""UNCHECKEDQTY"", ""POSNO"", ""PICKMAN"", ""INOUTID"", ""TRADEPACKNAME"", ""CHECKMANID"", ""UDI_CODE"", ""UDI_FLAG"", ""UDI_PARSER_RULE_ID"") AS 
  Select b.Boxdocid,
       a.Warehid,
       b.Goodsid,
       b.Ownergoodsid,
       k.Opcode,
       decode(k.goodsengname,
              null,
              k.goodsname,
              k.goodsname || '(' || k.goodsengname || ')') goodsname,
       --修改【散件出库复核】功能中货品名称的显示，若货品主档上没有商品名，就显示通用名；若有商品名就显示通用名（商品名字）
       --xyue 2014年1月15日 09:24:54
       k.Goodstype,
       --d.companyname prodarea,-- xyue 2014-05-11 修改产地字段显示厂家名称
       k.factname prodarea,
       --d.Prodarea,
       d.Barcode,
       b.Goodspackid,
       e.Packname,
       e.Packsize,
       b.Goodsstatusid,
       f.Goodsstatus,
       g.Ddlname Quantitystatus,
       b.Lotid,
       h.Lotno,
       decode(to_char(h.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              null,
              To_Char(h.Validdate, 'yyyy-mm-dd')) validdate,
       To_Char(h.Proddate, 'yyyy-mm-dd') Proddate,
       h.approvedocno,
       nvl(b.Checkstatus, 0) Checkstatus,
       nvl(k.Dbcheck, 0) Dbcheck,
       Sum(b.Goodsqty - b.Outgoodsqty) Outgoodsqty,
       Sum(b.Goodsqty) Goodsqty,
       Sum(nvl(b.checkedqty, 0)) checkedqty,
       Sum(b.Goodsqty - nvl(b.checkedqty, 0)) uncheckedqty,
       --'['||b.goodsid||']'||
       get_posnos(b.boxdocid,
                  b.Ownergoodsid,
                  b.lotid,
                  b.goodspackid,
                  b.goodsstatusid) posno,
       get_pickmans(b.boxdocid,
                    b.Ownergoodsid,
                    b.lotid,
                    b.goodspackid,
                    b.goodsstatusid) pickman,
       get_inoutids(b.boxdocid,
                    b.Ownergoodsid,
                    b.lotid,
                    b.goodspackid,
                    b.goodsstatusid) inoutid,
       m.Packname Tradepackname,
       Max(l.Checkmanid) Checkmanid,
       k.udi_code,
       k.udi_flag,
       k.udi_parser_rule_id
  From Wms_Turnbox_Doc     a,
       Wms_St_Io_Doc       b,
       Tpl_Pub_Goods_v      d,
       Tpl_Pub_Goods_Packs e,
       Wms_Goodsstatus     f,
       Sys_Ddl_All_v       g,
       Wms_Goods_Lot       h,
       Tpl_Goods           k,
       Gsp_St_Io_Record    l,
       Tpl_Goods_Packs     m
 Where a.Boxdocid = b.Boxdocid
   And m.Baseunitflag(+) = 1
   And b.Ownergoodsid = m.Ownergoodsid(+)
   And b.Inoutid = l.Inoutid(+)
   And b.Goodsid = d.Goodsid
   And b.Goodspackid = e.Goodspackid
   And b.Goodsstatusid = f.Goodsstatusid
   And b.Lotid = h.Lotid
   And b.Ownergoodsid = k.Ownergoodsid
   And f.Quantitystatus = g.Ddlid(+)
   And g.Keyword(+) = 'TPL_QUANTITYSTATUS'
   And b.Rfflag = 3
 Group By b.Boxdocid,
          a.Warehid,
          a.Usestatus,
          b.Goodsid,
          k.Opcode,
          decode(k.goodsengname,
                 null,
                 k.goodsname,
                 k.goodsname || '(' || k.goodsengname || ')'),
          --修改RF上【大货位上架】功能中货品名称的显示，若货品主档上没有商品名，就显示通用名；若有商品名就显示通用名（商品名字）
          --xyue 2014年1月15日 09:24:54
          k.Goodstype,
          k.factname,
          --d.companyname,
          --d.Prodarea,
          d.Barcode,
          b.Goodspackid,
          e.Packname,
          e.Packsize,
          b.Goodsstatusid,
          f.Goodsstatus,
          g.Ddlname,
          b.Lotid,
          h.Lotno,
          h.approvedocno,
          h.Validdate,
          h.Proddate,
          b.Checkstatus,
          b.Ownergoodsid,
          k.Dbcheck,
          m.Packname,
          k.udi_code,
          k.udi_flag,
          k.udi_parser_rule_id
"
"WMS_PDA_OUT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_PDA_OUT_V"" (""RECCOMPANYID"", ""COMPANYNAME"", ""TRANSID"", ""INCEPTADDR"", ""WARECID"", ""WAREHNAME"", ""RECMANID"", ""RECMANNAME"", ""RECTIME"", ""GOODSID"", ""COMMONT"", ""CHARGE_CODE"", ""SERIAL"", ""GROUP_NO"", ""DRUGNAME_LOOKUP"", ""SPECIFICATION"", ""MANUFACTURE"", ""ABBR_NAME"", ""UNIT_NAME"", ""DEPT_NAME"", ""DOSAGE_NAME"", ""MANUFACTORY"", ""MANU_NO"", ""PRODDATE"", ""EFF_DATE"", ""APPROVEDOCNO"", ""BUY_PRICE"", ""BUY_AMT"", ""BUY_AMOUNT"") AS 
  select s1.reccompanyid,
       s2.companyname,
       s1.transid,
       s5.inceptaddr,
       s1.warecid,
       s3.warehname,
       s1.recmanid,
       s4.employeename recmanname,
       s1.rectime,
       s1.goodsid,
       s1.commont,
       c.charge_code,
       c.serial,
       c.group_no,
       c.drugname drugname_LookUp,
       c.specification,
       c.manufacture,
       c.abbr_name,
       c.unit_name,
       c.dept_name,
       c.dosage_name,
       c.manufactory,
       s1.manu_no,
       s1.proddate,
       s1.eff_date,
       s1.approvedocno,
       s1.price * c.rate / c.hosrate buy_price,


       s1.price * c.rate / c.hosrate*sum(s1.arriveqty * c.hosrate / c.rate) buy_amt,
       sum(s1.arriveqty * c.hosrate / c.rate) buy_amount
  From (select a.reccompanyid,
               d.transid,
               e.warecid,
               a.warehid,
               a.goodsid,
             /*  b.supplyer,
               b.supplyer_name,
               b.supplyer_lookup,*/
               --f.gstorageid,
               (a.arriveqty - a.goodsqty) || h.ddlname commont,
               /*sum(a.arriveqty*c.hosrate/c.rate) buy_amount,*/
               a.arriveqty,
               a.lotno manu_no,
               a.proddate,
               decode(to_char(a.validdate, 'yyyy-mm-dd'),
                      '2099-01-01',
                      to_date(null, 'yyyy-mm-dd'),
                      a.validdate) eff_date,
               a.approvedocno,
               a.rectime,
               a.recmanid,
               a.price
          from wms_tpl_st_io_doc     a,
               wms_out_order     d,
               wms_out_order_dtl f,
               tpl_go_company    e,
               sys_ddl_all_v     h
         where a.inoutflag = 1
           and a.comefrom = 3
           and a.orderid=d.outid
           and a.orderdtlid=f.outdtlid
           and f.outid = d.outid
           and a.reccompanyid = e.companyid
           and a.retreceptflag = 1
           and h.keyword = 'ZX_RF_DIFREASON'
           and nvl(a.difreason, 0) = to_char(h.ddlid)) s1,
       wms_goodscode c,
       tpl_go_company s2,
       tpl_warehouse s3,
       pub_employee s4,
       wms_transport_address s5
 where s1.warecid = c.hospitalid(+)
   and s1.goodsid = c.goodsid(+)
   and s1.reccompanyid = s2.companyid(+)
   and s1.warehid = s3.warehid(+)
   and s1.recmanid = s4.employeeid(+)
   and s1.transid = s5.transid(+)
 group by s1.reccompanyid,
          s2.companyname,
          s1.transid,
          s5.inceptaddr,
          s1.warecid,
          s3.warehname,
          s1.recmanid,
          s4.employeename,
          s1.goodsid,
          c.charge_code,
          c.serial,
          c.group_no,
          c.drugname,
          c.specification,
          c.manufacture,
          c.abbr_name,
          c.unit_name,
          c.dept_name,
          c.dosage_name,
          c.manufactory,
          s1.manu_no,
          s1.proddate,
          s1.eff_date,
          s1.approvedocno,
          s1.price * c.rate / c.hosrate,


          s1.rectime,
          s1.commont
"
"WMS_PICKAREA_POS_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_PICKAREA_POS_DEF_V"" (""DEFID"", ""PICKAREAID"", ""PICKSEQ"", ""POSID"", ""POSNAME"", ""POSNO"", ""POSTYPE"", ""MEMO"") AS 
  select a.defid,
        a.pickareaid,
        a.pickseq,
        a.posid,
        b.posname,
        b.posno,
        b.postype,
        a.memo
 from wms_pickarea_pos_def a,
      wms_pos_def b
      where a.posid = b.posid

 "
"WMS_PICKAREA_TASK_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_PICKAREA_TASK_DTL_V"" (""CREDATE"", ""PICKAREAID"", ""PICKAREANAME"", ""TASKID"", ""TASKTYPE"", ""RFFLAG"", ""USESTATUS"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSQTY"", ""TRADEPACKNAME"", ""LOTNO"", ""PACKNAME"", ""PACKSIZE"", ""CUSTOMID"", ""CUSTOMNAME"", ""GCOMPANYID"", ""PRODAREA"", ""FACTNAME"", ""DRUGFORM"", ""DRUGFORMNO"", ""PICKFLOWID"", ""PICKFLOWNAME"", ""GROUPID"", ""GROUPNAME"", ""RFMANID"", ""RFMAN"", ""INOUTID"", ""WAREHID"", ""POSID"", ""WHOLEQTY"", ""SCATTERQTY"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""JS"", ""OPERATIONTYPE"", ""LSJS"") AS 
  select
--一个为拣货工作区下架任务明细，内容为任务状态、任务下达时间、拣货工作区、货品ID、货主原货品ID、
--名称、规格、单位、数量、批号、包装单位、包装大小、客户ID、货主原客户ID、客户名称。
--查询条件为：状态、客户ID（HOV）、拣货工作区ID（Hov）、货品ID（Hov）、任务下达时间（必填，缺省为当天）、
--业务类型（波次补货下架、闲时补货下架、报警补货下架、出库下架）
 b.credate,
 f.pickareaid,
 g.pickareaname,
 a.taskid,
 '出库下架' tasktype,
 b.rfflag,
 b.usestatus,
 b.goodsid,
 j.goodsownid,
 j.goodsname,
 j.goodstype,
 b.goodsqty,
 j.tradepackname,
 i.lotno,
 h.packname,
 h.packsize,
 d.customid,
 --d.customname, 2011-1-24 by ydhu
 k.companyname customname, --2011-1-24 by ydhu
 --d.gcompanyid  2011-1-24 by ydhu
 k.gcompanyid, --2011-1-24 by ydhu
 j.prodarea,
 j.factname,
 j.drugform, --l.drugform 改为 j.drugform zyc by 20160901
 l.drugformno,
 m.pickflowid,
 m.pickflowname,
 n.groupid,
 n.groupname,
 b.rfmanid,
 o.employeename rfman,
 b.inoutid,
 b.warehid,
 b.posid,
 b.wholeqty,
 b.scatterqty,
 j.goodsownerid, -- xyue 2014-06-06 拣货工作区下架任务明细增加货主字段
 j.goodsownername,
 decode(nvl(h.packsize,0),0,0,ceil(b.goodsqty/h.packsize)) js , --件数 向上取整 add by 20160705 zyc
 b.operationtype, --业务类型 by tl@180410
   (nvl(b.wholeqty,0)+(case when (nvl(b.scatterqty,0))>0 then 1 else 0 end))  lsjs--取出入库单上的件数  by tl 181121
  from wms_task_doc         a,
       wms_st_io_doc        b,
       wms_wave_goods_dtl   c,
       wms_wave_dtl         d,
       wms_wave_doc         e,
       wms_pickarea_pos_def f,
       wms_pickarea         g,
       tpl_pub_goods_packs  h,
       wms_goods_lot        i,
       tpl_goods_v            j,
       tpl_go_company       k, --2011-1-24 by ydhu
       tpl_drugform         l,
       wms_pickflow         m,
       wms_group_def        n,
       pub_employee         o
 where a.taskid = b.taskid
   and a.tasktype = 1 --拣货任务（波次生成）
   and b.comefrom = 3 --波次出库
   and b.sourceid = c.wavegoodsdtlid
   and c.wavedtlid = d.wavedtlid
   and d.waveid = e.wavedocid
   and b.posid = f.posid
   and f.pickareaid = g.pickareaid
   and b.goodspackid = h.goodspackid
   and b.lotid = i.lotid
   and b.ownergoodsid = j.ownergoodsid
   and d.customid = k.companyid(+) --2011-1-24 by ydhu
   and j.drugform = l.drugformno(+)
   and g.pickflowid = m.pickflowid
   and g.groupid = n.groupid
   and b.rfmanid = o.employeeid(+) --应该用外关联，不然查不出未执行的任务
union all
select b.credate,
       f.pickareaid,
       g.pickareaname,
       a.taskid,
       decode(e.subtype,
              1,
              '波次补货下架',
              5,
              '波次预补货下架',
              4,
              '手工补货下架',
              3,
              '闲时补货下架',
              '报警补货下架') tasktype,
       b.rfflag,
       b.usestatus,
       b.goodsid,
       j.goodsownid,
       j.goodsname,
       j.goodstype,
       b.goodsqty,
       j.tradepackname,
       i.lotno,
       h.packname,
       h.packsize,
       null customid,
       null customname,
       null gcompanyid,
       j.prodarea,
			 j.factname,
       l.drugform,
       l.drugformno,
       m.pickflowid,
       m.pickflowname,
       n.groupid,
       n.groupname,
       b.rfmanid,
       o.employeename rfman,
       b.inoutid,
       b.warehid,
       b.posid,
       b.wholeqty,
       b.scatterqty,
       j.goodsownerid, -- xyue 2014-06-06 拣货工作区下架任务明细增加货主字段
       j.goodsownername,
       decode(nvl(h.packsize,0),0,0,ceil(b.goodsqty/h.packsize)) js, --件数 向上取整 add by 20160705 zyc
        b.operationtype , --业务类型 by tl@180410
          (nvl(b.wholeqty,0)+(case when (nvl(b.scatterqty,0))>0 then 1 else 0 end))  lsjs--取出入库单上的件数  by tl 181121
  from wms_task_doc         a,
       wms_st_io_doc        b,
       --tpl_trade_dtl        d,
       --tpl_trade_order      e,
       wms_trade_dtl          d,
       wms_trade_order        e,
       wms_pickarea_pos_def f,
       wms_pickarea         g,
       tpl_pub_goods_packs  h,
       wms_goods_lot        i,
       tpl_goods_v            j,
       tpl_drugform         l,
       wms_pickflow         m,
       wms_group_def        n,
       pub_employee         o

 where a.taskid = b.taskid
   and a.tasktype = 2 --拣货任务（波次生成）
   and b.comefrom = 4 --库内变动
   and b.sourceid = d.tradedtlid
   and d.tradeid = e.tradeid
   and e.subtype in (1, 2, 3, 4, 5) -- 1 波次补货 2 报警补货 3 闲时补货  4手工补货 5波次预补货;
   and b.posid = f.posid
   and f.pickareaid = g.pickareaid
   and b.goodspackid = h.goodspackid
   and b.lotid = i.lotid
   and b.ownergoodsid = j.ownergoodsid
   and j.drugform = l.drugformno(+)
   and g.pickflowid = m.pickflowid
   and g.groupid = n.groupid
   and b.rfmanid = o.employeeid(+)
"
"WMS_PICKAREA_TASK_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_PICKAREA_TASK_LST_V"" (""PICKFLOWID"", ""PICKFLOWNAME"", ""PICKAREAID"", ""PICKAREANAME"", ""TASKTYPE"", ""TASKSUM"", ""TASKDONESUM"", ""DOINGSUM"", ""DONEPACKS"", ""DOINGPACKS"", ""DONEQTY"", ""DOINGQTY"") AS 
  select a.pickflowid, --拣货区名称、业务类型、总下架任务数、已下架任务数、已下架件数、已下架散件数、
       a.pickflowname, --待下架任务数、待下架件数、待下架散件数、分区ID
       a.pickareaid,
       a.pickareaname,
       '下架任务' tasktype, --类型
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, wms_pickarea_pos_def c
         where b.posid = c.posid
           and c.pickareaid = a.pickareaid
           and b.comefrom in (2, 3)
           and b.inoutflag = 1) tasksum, --总下架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, wms_pickarea_pos_def c
         where b.posid = c.posid
           and c.pickareaid = a.pickareaid
           and b.comefrom in (2, 3)
           and b.rfflag = 3
           and b.inoutflag = 1) taskdonesum, --已下架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, wms_pickarea_pos_def c
         where b.posid = c.posid
           and c.pickareaid = a.pickareaid
           and b.comefrom in (2, 3)
           and b.rfflag = 2
           and b.inoutflag = 1) doingsum, --待下架任务数
       nvl((select count(distinct(b.taskid))--sum(nvl(b.wholeqty, 0))
             from wms_st_io_doc b, wms_pickarea_pos_def c
            where b.posid = c.posid
              and c.pickareaid = a.pickareaid
              and b.comefrom in (2, 3)
              and b.rfflag = 3
              and b.wholeqty > 0
              and b.inoutflag = 1),
           0) donepacks, --已下架件数
       nvl((select count(distinct(b.taskid))--sum(nvl(b.wholeqty, 0))
             from wms_st_io_doc b, wms_pickarea_pos_def c
            where b.posid = c.posid
              and c.pickareaid = a.pickareaid
              and b.comefrom in (2, 3)
              and b.rfflag = 2
              and b.wholeqty > 0
              and b.inoutflag = 1),
           0) doingpacks, --待下架件数
       nvl((select count(distinct(b.taskid))--sum(nvl(b.scatterqty, 0))
             from wms_st_io_doc b, wms_pickarea_pos_def c
            where b.posid = c.posid
              and c.pickareaid = a.pickareaid
              and b.comefrom in (2, 3)
              and b.rfflag = 3
              and b.scatterqty > 0
              and b.inoutflag = 1),
           0) doneqty, --已下架散件数
       nvl((select count(distinct(b.taskid)) --sum(nvl(b.scatterqty, 0))
             from wms_st_io_doc b, wms_pickarea_pos_def c
            where b.posid = c.posid
              and c.pickareaid = a.pickareaid
              and b.comefrom in (2, 3)
              and b.rfflag = 2
              and b.scatterqty > 0
              and b.inoutflag = 1),
           0) doingqty --待下架散件数
  from wms_pickarea_v a
union
select a.pickflowid, --拣货区名称、业务类型、总下架任务数、已下架任务数、已下架件数、已下架散件数、
       a.pickflowname, --待下架任务数、待下架件数、待下架散件数、分区ID
       a.pickareaid,
       a.pickareaname,
       '波次补货' tasktype, --类型
       (select count(distinct(b.taskid))
          from wms_st_io_doc        b,
               tpl_trade_order      c,
               tpl_trade_dtl        d,
               wms_pickarea_pos_def e
         where b.posid = e.posid
           and e.pickareaid = a.pickareaid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and c.operationtype = 29 --29补货 subtype = 1波次补货
           and c.subtype = 1
           and b.inoutflag = 1) tasksum, --总下架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc        b,
               tpl_trade_order      c,
               tpl_trade_dtl        d,
               wms_pickarea_pos_def e
         where b.posid = e.posid
           and e.pickareaid = a.pickareaid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.rfflag = 3
           and c.operationtype = 29 --补货
           and c.subtype = 1
           and b.inoutflag = 1) taskdonesum, --已下架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc        b,
               tpl_trade_order      c,
               tpl_trade_dtl        d,
               wms_pickarea_pos_def e
         where b.posid = e.posid
           and e.pickareaid = a.pickareaid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.rfflag = 2
           and c.operationtype = 29 --补货
           and c.subtype = 1
           and b.inoutflag = 1) doingnum, --待下架任务数
       nvl((select count(distinct(b.taskid))--sum(b.wholeqty)
             from wms_st_io_doc        b,
                  tpl_trade_order      c,
                  tpl_trade_dtl        d,
                  wms_pickarea_pos_def e
            where b.posid = e.posid
              and e.pickareaid = a.pickareaid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.rfflag = 3
              and c.operationtype = 29 --补货
              and b.wholeqty > 0
              and c.subtype = 1
              and b.inoutflag = 1),
           0) donepacks, --已下架件数
       nvl((select count(distinct(b.taskid))--sum(b.wholeqty)
             from wms_st_io_doc        b,
                  tpl_trade_order      c,
                  tpl_trade_dtl        d,
                  wms_pickarea_pos_def e
            where b.posid = e.posid
              and e.pickareaid = a.pickareaid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.rfflag = 2
              and c.operationtype = 29 --补货
              and c.subtype = 1
              and b.wholeqty > 0
              and b.inoutflag = 1),
           0) doingpacks, --待下架件数
       0 doneqty, --已下架散件数
       0 doingqty --待下架散件数
  from wms_pickarea_v a
union
select a.pickflowid, --拣货区名称、业务类型、总下架任务数、已下架任务数、已下架件数、已下架散件数、
       a.pickflowname, --待下架任务数、待下架件数、待下架散件数、分区ID
       a.pickareaid,
       a.pickareaname,
       '闲时补货' tasktype, --类型
       (select count(distinct(b.taskid))
          from wms_st_io_doc        b,
               wms_trade_order      c,
               wms_trade_dtl        d,
               wms_pickarea_pos_def e
         where b.posid = e.posid
           and e.pickareaid = a.pickareaid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and c.operationtype = 29 --29补货 subtype = 3补货闲时
           and c.subtype = 3
           and b.inoutflag = 1) tasksum, --总下架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc        b,
               wms_trade_order      c,
               wms_trade_dtl        d,
               wms_pickarea_pos_def e
         where b.posid = e.posid
           and e.pickareaid = a.pickareaid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.rfflag = 3
           and c.operationtype = 29 --补货
           and c.subtype = 3
           and b.inoutflag = 1) taskdonesum, --已下架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc        b,
               tpl_trade_order      c,
               tpl_trade_dtl        d,
               wms_pickarea_pos_def e
         where b.posid = e.posid
           and e.pickareaid = a.pickareaid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.rfflag = 2
           and c.operationtype = 29 --补货
           and c.subtype = 3
           and b.inoutflag = 1) doingnum, --待下架任务数
       nvl((select count(distinct(b.taskid))--sum(b.wholeqty)
             from wms_st_io_doc        b,
                  wms_trade_order      c,
                  wms_trade_dtl        d,
                  wms_pickarea_pos_def e
            where b.posid = e.posid
              and e.pickareaid = a.pickareaid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.rfflag = 3
              and c.operationtype = 29 --补货
              and c.subtype = 3
              and b.wholeqty > 0
              and b.inoutflag = 1),
           0) donepacks, --已下架件数
       nvl((select count(distinct(b.taskid)) --sum(b.wholeqty)
             from wms_st_io_doc        b,
                  wms_trade_order      c,
                  wms_trade_dtl        d,
                  wms_pickarea_pos_def e
            where b.posid = e.posid
              and e.pickareaid = a.pickareaid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.rfflag = 2
              and c.operationtype = 29 --补货
              and c.subtype = 3
              and b.wholeqty > 0
              and b.inoutflag = 1),
           0) doingpacks, --待下架件数
       0 doneqty, --已下架散件数
       0 doingqty --待下架散件数
  from wms_pickarea_v a
union
select a.pickflowid, --拣货区名称、业务类型、总下架任务数、已下架任务数、已下架件数、已下架散件数、
       a.pickflowname, --待下架任务数、待下架件数、待下架散件数、分区ID
       a.pickareaid,
       a.pickareaname,
       '其他下架' tasktype, --类型
       (select count(distinct(b.taskid))
          from wms_st_io_doc        b,
               wms_trade_order      c,
               wms_trade_dtl        d,
               wms_pickarea_pos_def e
         where b.posid = e.posid
           and e.pickareaid = a.pickareaid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and c.operationtype = 29 --29补货 subtype = 3补货闲时
           and c.subtype not in (1, 3)
           and b.inoutflag = 1) tasksum, --总下架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc        b,
               wms_trade_order      c,
               wms_trade_dtl        d,
               wms_pickarea_pos_def e
         where b.posid = e.posid
           and e.pickareaid = a.pickareaid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.rfflag = 3
           and c.operationtype = 29 --补货
           and c.subtype not in (1, 3)
           and b.inoutflag = 1) taskdonesum, --已下架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc        b,
               wms_trade_order      c,
               wms_trade_dtl        d,
               wms_pickarea_pos_def e
         where b.posid = e.posid
           and e.pickareaid = a.pickareaid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.rfflag = 2
           and c.operationtype = 29 --补货
           and c.subtype not in (1, 3)
           and b.inoutflag = 1) doingnum, --待下架任务数
       nvl((select count(distinct(b.taskid)) --sum(b.wholeqty)
             from wms_st_io_doc        b,
                  wms_trade_order      c,
                  wms_trade_dtl        d,
                  wms_pickarea_pos_def e
            where b.posid = e.posid
              and e.pickareaid = a.pickareaid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.rfflag = 3
              and c.operationtype = 29 --补货
              and c.subtype not in (1, 3)
              and b.wholeqty > 0
              and b.inoutflag = 1),
           0) donepacks, --已下架整件任务数
       nvl((select count(distinct(b.taskid)) --sum(b.wholeqty)
             from wms_st_io_doc        b,
                  wms_trade_order      c,
                  wms_trade_dtl        d,
                  wms_pickarea_pos_def e
            where b.posid = e.posid
              and e.pickareaid = a.pickareaid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.rfflag = 2
              and c.operationtype = 29 --补货
              and c.subtype not in (1, 3)
              and b.wholeqty > 0
              and b.inoutflag = 1),
           0) doingpacks, --待下架件数
       nvl((select count(distinct(b.taskid)) --sum(b.scatterqty)
             from wms_st_io_doc        b,
                  wms_trade_order      c,
                  wms_trade_dtl        d,
                  wms_pickarea_pos_def e
            where b.posid = e.posid
              and e.pickareaid = a.pickareaid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.inoutflag = 1
              and b.rfflag = 3
              and b.scatterqty > 0
              and ((c.operationtype = 29 --29补货
                  and c.subtype not in (1, 3)) or c.operationtype <> 29)),
           0) doneqty, --已下架散件数
       nvl((select count(distinct(b.taskid)) --sum(b.scatterqty)
             from wms_st_io_doc        b,
                  wms_trade_order      c,
                  wms_trade_dtl        d,
                  wms_pickarea_pos_def e
            where b.posid = e.posid
              and e.pickareaid = a.pickareaid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.inoutflag = 1
              and b.rfflag = 2
              and b.scatterqty > 0
              and ((c.operationtype = 29 --29补货
                  and c.subtype not in (1, 3)) or c.operationtype <> 29)),
           0) doingqty --待下架散件数
  from wms_pickarea_v a
"
"WMS_PICKAREA_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_PICKAREA_V"" (""PICKAREAID"", ""PICKAREANO"", ""PICKAREANAME"", ""EQUA_FLAG"", ""EQUA_SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""PICKAREATYPE"", ""BOXFLAG"", ""GROUPID"", ""GROUPNO"", ""GROUPNAME"", ""PICKFLOWID"", ""PICKFLOWNO"", ""PICKFLOWNAME"", ""PICKORDER"", ""USESTATUS"", ""MEMO"", ""AREAID"", ""AREANO"", ""AREANAME"", ""AREATYPE"", ""AUTOPRTPARAM"", ""PRTPERPACKFLAG"", ""WAREHID"", ""WAREHNAME"", ""WHOLEOUTFLAG"", ""ZX_PICKOUTNO"", ""ZX_TRADEOUTNO"") AS 
  select a.pickareaid,
       a.pickareano,
       a.pickareaname,
       nvl(a.equa_flag,0)equa_flag,
       a.equa_sectionid,
       c.sectionno,
       c.sectionname,
       a.pickareatype,
       a.boxflag,
       a.groupid,
       d.groupno,
       d.groupname,
       a.pickflowid,
       e.pickflowno,
       e.pickflowname,
       a.pickorder,
       a.usestatus,
       a.memo,
       a.areaid,
       b.areano,
       b.areaname,
       b.areatype,
       a.autoprtparam,
       a.prtperpackflag,
       a.warehid,
       f.warehname,
       a.wholeoutflag,
       a.zx_pickoutno,--拣货弹出口 add by wanghuaiyu 2013年12月12日 17:51:34
       a.zx_tradeoutno--补货弹出口 add by wanghuaiyu 2013年12月12日 17:51:53
  from wms_pickarea       a,
       wms_st_area_def    b,
       wms_st_section_def c,
       wms_group_def      d,
       wms_pickflow       e,
       tpl_warehouse      f
 where a.equa_sectionid = c.sectionid(+)
   and a.groupid = d.groupid(+)
   and a.pickflowid = e.pickflowid(+)
   and a.areaid = b.areaid(+)
   and a.warehid = f.warehid(+)
"
"WMS_PICKFLOW_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_PICKFLOW_V"" (""PICKFLOWID"", ""PICKFLOWNO"", ""PICKFLOWNAME"", ""INFLUXFLAG"", ""USESTATUS"", ""WCSFLAG"", ""MEMO"", ""WAREHID"", ""WAREHNAME"", ""AUTOBOUNDBOX"") AS 
  select a.pickflowid,
       a.pickflowno,
       a.pickflowname,
       a.influxflag,
       a.usestatus,
       a.wcsflag,
       a.memo,
       a.warehid,
       b.warehname,
       a.autoboundbox--自动绑定周转箱 add by wanghuaiyu 2013年12月21日 14:55:18
  from wms_pickflow  a,
       tpl_warehouse b
 where a.warehid = b.warehid
"
"WMS_PICK_JIANSHU_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_PICK_JIANSHU_V"" (""AREAID"", ""AREANAME"", ""SECTIONID"", ""SECTIONNAME"", ""RFMANID"", ""EMPLOYEENAME"", ""JIANSHU"", ""RFFINDATE"") AS 
  select t1.areaid,
       t3.areaname,
       t1.sectionid,
       t4.sectionname,
       t1.rfmanid,
       t2.employeename,
       count(1) jianshu,
       t1.rffindate
  from wms_st_io_doc      t1,
       pub_employee       t2,
       wms_st_area_def    t3,
       wms_st_section_def t4
 where t1.comefrom = 3
   and t1.inoutflag = 1
   and t1.rfmanid = t2.employeeid
   and t1.areaid = t3.areaid
   and t1.sectionid = t4.sectionid
 group by t1.areaid,
          t3.areaname,
          t1.sectionid,
          t4.sectionname,
          t1.rfmanid,
          t2.employeename,
          t1.rffindate
"
"WMS_POS_COLLECT_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_POS_COLLECT_DEF_V"" (""COLLECTID"", ""DEFID"", ""ENUMERATE"", ""AREAID"", ""AREANO"", ""AREANAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""START_AISLE_NO"", ""START_BAY_NO"", ""START_LEVEL_NO"", ""END_AISLE_NO"", ""END_BAY_NO"", ""END_LEVEL_NO"", ""SUBCOLLECTIONID"", ""SUBCOLLECTNO"", ""SUBCOLLECTNAME"") AS 
  select t.COLLECTID,
       t.DEFID,
       t.ENUMERATE,
       t.AREAID,
       a.areano,
       a.areaname,
       t.SECTIONID,
       b.sectionno,
       b.sectionname,
       t.START_AISLE_NO,
       t.START_BAY_NO,
       t.START_LEVEL_NO,
       t.END_AISLE_NO,
       t.END_BAY_NO,
       t.END_LEVEL_NO,
       t.SUBCOLLECTIONID,
       c.collectno subcollectno,
       c.collectname subcollectname
  from wms_pos_collect_def t,
        wms_st_area_def     a,
        wms_st_section_def  b,
        wms_pos_collect c
  where t.areaid = a.areaid(+)
  and t.sectionid = b.sectionid(+)
  and t.subcollectionid = c.collectid(+)

 "
"WMS_POS_COLLECT_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_POS_COLLECT_DTL_V"" (""DTLID"", ""COLLECTID"", ""POSID"", ""AREAID"", ""SECTIONID"", ""POSNO"", ""POSNAME"", ""POSTYPE"", ""TYPENAME"", ""STORELEVEL"", ""TRAYNUM"", ""AISLE_NO"", ""BAY_NO"", ""LEVEL_NO"", ""USESTATUS"", ""MEMO"", ""LENGTH"", ""WIDTH"", ""HEIGHT"", ""WEIGHT"", ""GOODSNUM"", ""LOTNUM"", ""DEPTH_NO"", ""INNERSEQ"", ""POSFLAG"", ""SECTIONNO"", ""SECTIONNAME"", ""AREANO"", ""AREANAME"", ""AREAFLAG"") AS 
  select t.DTLID,
       t.COLLECTID,
       t.POSID,
       a.areaid,
       a.sectionid,
       a.posno,
       a.posname,
       a.postype,
       f.typename,
       f.storelevel,
       f.traynum,
       a.aisle_no,
       a.bay_no,
       a.level_no,
       a.usestatus,
       a.memo,
       a.length,
       a.width,
       a.height,
       a.weight,
       a.goodsnum,
       a.lotnum,
       a.depth_no,
       a.innerseq,
       a.posflag,
       b.sectionno,
       b.sectionname,
       c.areano,
       c.areaname,
       c.areaflag
  from wms_pos_collect_dtl t,
       wms_pos_def         a,
       wms_st_section_def  b,
       wms_st_area_def     c,
       wms_pos_type        f
 where t.posid=a.posid
   and a.areaid = c.areaid(+)
   and a.sectionid = b.sectionid(+)
   and a.postype = f.typeid(+)

 "
"WMS_POS_COLLECT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_POS_COLLECT_V"" (""WAREHID"", ""COLLECTID"", ""COLLECTNO"", ""COLLECTNAME"", ""USESTATUS"", ""MEMO"", ""WAREHNAME"") AS 
  select t.warehid,
       t.collectid,
       t.collectno,
       t.collectname,
       t.usestatus,
       t.memo,
       a.warehname
  from wms_pos_collect t,
       tpl_warehouse   a
 where t.warehid = a.warehid

 "
"WMS_POS_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_POS_DEF_V"" (""POSID"", ""AREAID"", ""SECTIONID"", ""POSNO"", ""POSNAME"", ""POSTYPE"", ""TYPENAME"", ""STORELEVEL"", ""TRAYNUM"", ""AISLE_NO"", ""BAY_NO"", ""LEVEL_NO"", ""USESTATUS"", ""MEMO"", ""LAST_TURNOVER"", ""TURNOVERCNT"", ""LENGTH"", ""WIDTH"", ""HEIGHT"", ""WEIGHT"", ""GOODSNUM"", ""LOTNUM"", ""DEPTH_NO"", ""INNERSEQ"", ""EXISTSGOODSCOUNT"", ""EXISTSLOTCOUNT"", ""EXISTSCUBAGE"", ""EXISTSWEIGHT"", ""EXISTSPERCENT"", ""POSFLAG"", ""SECTIONNO"", ""SECTIONNAME"", ""AREANO"", ""AREANAME"", ""AREAFLAG"", ""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""GROUPID"", ""GROUPNAME"", ""GROUPNO"", ""AREATYPE"", ""PICKRATEFLAG"", ""SORTTYPE"", ""ZX_TUNNELNO"", ""IWCS_FLAG"") AS 
  select a.posid,
       a.areaid,
       a.sectionid,
       a.posno,
       a.posname,
       a.postype,
       f.typename,
       f.storelevel,
       f.traynum,
       a.aisle_no,
       a.bay_no,
       a.level_no,
       a.usestatus,
       a.memo,
       a.last_turnover,
       a.turnovercnt,
       a.length,
       a.width,
       a.height,
       a.weight,
       a.goodsnum,
       a.lotnum,
       a.depth_no,
       a.innerseq,
       a.existsgoodscount,
       a.existslotcount,
       a.existscubage,
       a.existsweight,
       a.existspercent,
       a.posflag,
       b.sectionno,
       b.sectionname,
       c.areano,
       c.areaname,
       c.areaflag,
       e.warehid,
       e.warehopcode,
       e.warehname,
       b.groupid,
       d.groupname,
       d.groupno,
       c.areatype,
       b.pickrateflag,
       b.sorttype,
       a.zx_tunnelno,--巷道号 add by wanghuaiyu 2013年12月10日 14:10:03
       nvl(b.iwcs_flag,0) iwcs_flag
  from wms_pos_def        a,
       wms_st_section_def b,
       wms_st_area_def    c,
       wms_group_def      d,
       tpl_warehouse      e,
       wms_pos_type       f
 where a.areaid = c.areaid(+)
   and a.sectionid = b.sectionid(+)
   and b.groupid = d.groupid(+)
   and c.warehid = e.warehid(+)
   and a.postype  = f.typeid(+)
"
"WMS_POS_TYPE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_POS_TYPE_V"" (""TYPEID"", ""TYPENAME"", ""STORELEVEL"", ""TRAYNUM"", ""LENGTH"", ""WIDTH"", ""HEIGHT"", ""WEIGHT"", ""CFSL"") AS 
  select typeid,typename,storelevel,traynum,length,width,height,weight,CFSL from wms_pos_type
"
"WMS_PREPARE_IN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_PREPARE_IN_V"" (""RECEIVEID"", ""RECEIVEDATE"", ""CHECKDATE"", ""INDTLID"", ""WAREHID"", ""OWNERGOODSID"", ""OWNERGOODSNAME"", ""OWNERGOODSOPCODE"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""GOODSPACKID"", ""GOODSPACKNAME"", ""PACKSIZE"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSCUBAGE"", ""GOODSWEIGHT"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""PRODDATE"", ""PRODLICENSENO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""GOODSOWNID"", ""STORAGECONDITION"", ""RECMEMO"", ""FACEQUALITY"", ""PACKQUALITY"", ""TRANSTEMP"", ""IMPORTREPFLAG"", ""PASSGATEFLAG"", ""REGISTEFLAG"", ""MEDCHECKFLAG"", ""ELIGIBILITYFLAG"", ""APPROVEDOCNO"", ""REGISTNO"", ""RPTNO"", ""BACKWHYID"", ""CHECKMANID1"", ""CHECKMAN1"", ""CHECKMANID2"", ""CHECKMAN2"", ""CHECKDOCNO"", ""LQCCHECK"", ""PASSGATENO"", ""PIJIANNO"", ""QUCHECKID"", ""LPNCODE"", ""CONTAINERID"", ""CONTAINERNO"", ""TYPEID"", ""QUCHECKNAME"", ""INPUTMANID"", ""SORTTYPE"", ""TRAYSECTIONID"", ""TRAYSECTIONNO"", ""TRAYSECTIONNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""WHOLESECTIONID"", ""WHOLESECTIONNO"", ""WHOLESECTIONNAME"", ""SENDNO"", ""USESTATUS"", ""RULINGFLAG"", ""GSPFLAG"", ""RECEIVETYPE"", ""STATUSREASON"", ""RECEIVEDETAILID"", ""L_PERIOD"", ""S_PERIODUNIT"", ""CHECKMEMO"", ""MATCHFLAG"", ""GOODSOWNERID"", ""TRADEGOODSPACK"", ""PACKNAME"", ""GOODSOWNERNAME"", ""OPERATIONTYPE"", ""SOURCECOMPANYID"", ""SRCCOMPANYNAME"", ""COMEFROM"") AS 
  select a.receiveid,
       a.receivedate,
       a.checkdate,
       a.indtlid,
       a.warehid,
       a.ownergoodsid,
       a.ownergoodsname,
       a.ownergoodsopcode,
       a.goodsid,
       a.opcode,
       a.goodsname,
       a.goodstype,
       a.prodarea,
       a.factname,
       a.goodspackid,
       a.goodspackname,
       a.packsize,
       a.goodslength,
       a.goodswidth,
       a.goodsheight,
       a.goodscubage,
       a.goodsweight,
       a.batchno,
       a.lotid,
       a.lotno,
       a.killlotno,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.proddate,
       a.prodlicenseno,
       a.goodsstatusid,
       a.goodsstatus,
       a.quantitystatus,
       a.goodsqty,
       a.wholeqty,
       a.scatterqty,
       a.goodsownid,
       a.storagecondition,
       a.recmemo,
       a.facequality,
       a.packquality,
       a.transtemp,
       a.importrepflag,
       a.passgateflag,
       a.registeflag,
       a.medcheckflag,
       a.eligibilityflag,
       a.approvedocno,
       a.registno,
       a.rptno,
       a.backwhyid,
       a.checkmanid1,
       a.checkman1,
       a.checkmanid2,
       a.checkman2,
       a.checkdocno,
       a.lqccheck,
       a.passgateno,
       a.pijianno,
       a.qucheckid,
       a.lpncode,
       a.containerid,
       a.containerno,
       a.typeid,
       a.qucheckname,
       a.inputmanid,
       a.sorttype,
       a.traysectionid,
       a.traysectionno,
       a.traysectionname,
       a.sectionid,
       a.sectionno,
       a.sectionname,
       a.wholesectionid,
       a.wholesectionno,
       a.wholesectionname,
       a.sendno,
       a.usestatus,
       a.rulingflag,
       a.gspflag,
       a.receivetype,
       a.statusreason,
       a.receivedetailid,
       a.l_period,
       a.s_periodunit,
       a.checkmemo,
       a.matchflag,
       c.goodsownerid,
       b.tradegoodspack,
       b.packname,
       c.goodsownername,
       c.operationtype,
       c.sourcecompanyid,
       c.srccompanyname,
       '1' comefrom
  from wms_receive_dtl_v a, wms_in_order_dtl_v b, wms_in_order_v c
 where a.indtlid = b.indtlid
   and b.inid = c.inid
   and a.usestatus = 2
   and nvl(a.gspflag, 1) <> 1
   and nvl(c.nowlflag, 0) <> 1
union all
select a.receiveid,
       a.receivedate,
       a.checkdate,
       a.indtlid,
       a.warehid,
       a.ownergoodsid,
       a.ownergoodsname,
       a.ownergoodsopcode,
       a.goodsid,
       a.opcode,
       a.goodsname,
       a.goodstype,
       a.prodarea,
       a.factname,
       a.goodspackid,
       a.goodspackname,
       a.packsize,
       a.goodslength,
       a.goodswidth,
       a.goodsheight,
       a.goodscubage,
       a.goodsweight,
       a.batchno,
       a.lotid,
       a.lotno,
       a.killlotno,
       a.validdate,
       a.proddate,
       a.prodlicenseno,
       a.goodsstatusid,
       a.goodsstatus,
       a.quantitystatus,
       a.goodsqty,
       a.wholeqty,
       a.scatterqty,
       a.goodsownid,
       a.storagecondition,
       a.recmemo,
       a.facequality,
       a.packquality,
       a.transtemp,
       a.importrepflag,
       a.passgateflag,
       a.registeflag,
       a.medcheckflag,
       a.eligibilityflag,
       a.approvedocno,
       a.registno,
       a.rptno,
       a.backwhyid,
       a.checkmanid1,
       a.checkman1,
       a.checkmanid2,
       a.checkman2,
       a.checkdocno,
       a.lqccheck,
       a.passgateno,
       a.pijianno,
       a.qucheckid,
       a.lpncode,
       a.containerid,
       a.containerno,
       a.typeid,
       a.qucheckname,
       a.inputmanid,
       a.sorttype,
       a.traysectionid,
       a.traysectionno,
       a.traysectionname,
       a.sectionid,
       a.sectionno,
       a.sectionname,
       a.wholesectionid,
       a.wholesectionno,
       a.wholesectionname,
       a.sendno,
       a.usestatus,
       a.rulingflag,
       a.gspflag,
       a.receivetype,
       a.statusreason,
       a.receivedetailid,
       a.l_period,
       a.s_periodunit,
       a.checkmemo,
       a.matchflag,
       c.goodsownerid,
       '' tradegoodspack,
       a.goodspackname packname,
       c.goodsownername,
       c.operationtype,
       c.gocompanyid sourcecompanyid,
       c.companyname srccompanyname,
       '0' comefrom
  from wms_receive_dtl_v a, wms_receive_detail b, wms_receive_doc_v c
 where a.receivedetailid = b.receivedetailid
   and b.receivedocid = c.receivedocid
   and nvl(a.usestatus, 0) = 2
   and nvl(a.gspflag, 1) <> 1
"
"WMS_PROC_QTY_CUT_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_PROC_QTY_CUT_DTL_V"" (""CUTID"", ""CUTDTLID"", ""PROCTINYID"", ""PROCTYPE"", ""PROCQTY"", ""TRADEFLAG"", ""TRADEDTLID"", ""INPUTMANID"", ""EMPLOYEENAME"") AS 
  SELECT a.CUTID,
       a.CUTDTLID,
       a.PROCTINYID,
       a.PROCTYPE,
       a.PROCQTY,
       a.TRADEFLAG,
       a.TRADEDTLID,
       a.INPUTMANID,
       b.EMPLOYEENAME
  from wms_proc_qty_cut_dtl a, pub_employee b
 where a.INPUTMANID = b.EMPLOYEEID(+)

 "
"WMS_QTY_CUT_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_QTY_CUT_DTL_V"" (""CUTID"", ""CUTDTLID"", ""WMSNO"", ""WMSDTLNO"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""PRODAREA"", ""DRUGFORM"", ""PRODAREA1"", ""STORAGECONDITION"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""POSID"", ""POSNO"", ""POSNAME"", ""SECTIONNO"", ""SECTIONNAME"", ""AREANO"", ""AREANAME"", ""GOQTY"", ""STOCKQTY"", ""REALQTY"", ""GODIFFQTY"", ""WMSDIFFQTY"", ""GOODSPACKID"", ""PROCFLAG"", ""GOPROCQTY"", ""WMSPROCQTY"", ""MEMO"", ""AUDITSTATUS"", ""GOODSOWNID"", ""PLANDTLID"", ""CUTTYPE"", ""CUTDATE"", ""CUTMANID"", ""CUTMANNAME"", ""SCATTERPICKRATE"", ""WHOLEPICKRATE"", ""REALQTY2"", ""CUTMANID2"", ""CUTDATE2"", ""USESTATUS"", ""CUTMAN2NAME"") AS 
  select a.cutid,
       a.cutdtlid,
       a.wmsno,
       a.wmsdtlno,
       a.warehid,
       a.goodsownerid,
       b.goodsownername,
       a.ownergoodsid,
       a.goodsid,
       e.goodsname||decode(e.goodsengname,null,null,'('||e.goodsengname||')') goodsname,
       e.goodsengname,--add by xyue 2019-06-12 商品名
       e.goodstype,
       e.tradepackname,--add by xyue 2019-06-12 单位
       e.factname prodarea,
       e.drugform,--add by xyue 2019-06-12 剂型
       e.prodarea prodarea1,--add by xyue 2019-06-12 产地
       e.storagecondition,--add by xyue 2019-06-12 存储条件
       f.packname,
       f.packsize,
       a.batchno,
       a.lotid,
       c.lotno,
       decode(to_char(c.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              c.validdate) validdate,
       c.proddate,
       c.approvedocno,
       a.goodsstatusid,
       h.goodsstatus,
       h.quantitystatus,
       a.posid,
       g.posno,
       g.posname,
       g.sectionno,
       g.sectionname,
       g.areano,
       g.areaname,
       a.goqty,
       a.stockqty,
       a.realqty,
       a.godiffqty,
       a.wmsdiffqty,
       a.goodspackid,
       a.procflag,
       a.goprocqty,
       a.wmsprocqty,
       a.memo,
       a.auditstatus,
       e.goodsownid,
       a.plandtlid,
       i.cuttype,
       a.cutdate,
       a.cutmanid,
       j.employeename cutmanname,
       gtr.scatterpickrate,
       gtr.wholepickrate,
       a.realqty2,
       a.cutmanid2,
       a.cutdate2,
       a.usestatus,
       m.employeename cutman2name
  from wms_qty_cut_dtl     a,
       tpl_goodsowner      b,
       wms_goods_lot       c,
       tpl_goods           e,
       tpl_pub_goods_packs f,
       wms_pos_def_v       g,
       wms_goodsstatus     h,
       wms_qty_cut         i,
       pub_employee        j,
       wms_goods_feature   gtr,
       pub_employee        m
 where a.goodsownerid = b.goodsownerid(+)
   and a.goodspackid = f.goodspackid(+)
   and a.goodsstatusid = h.Goodsstatusid(+)
   and a.lotid = c.lotid(+)
   and a.posid = g.posid(+)
   and a.ownergoodsid = e.ownergoodsid
   and a.cutid = i.cutid
   and a.cutmanid = j.employeeid(+)
   and a.goodsid=gtr.goodsid(+)
   and gtr.warehid(+)=a.warehid
   and a.cutmanid2 = m.employeeid(+)
"
"WMS_QTY_CUT_PLAN_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_QTY_CUT_PLAN_DTL_V"" (""PLANID"", ""PLANDTLID"", ""POSID"", ""POSNO"", ""CUTDATE"", ""CUTMANID"", ""CUTMANNAME"") AS 
  select PLANID,
       a.PLANDTLID,
       a.POSID,
       b.posno,
       a.CUTDATE,
       a.CUTMANID,
       c.employeename cutmanname
  from WMS_QTY_CUT_PLAN_DTL a,
       wms_pos_def          b,
       pub_employee         c
 where a.posid = b.posid(+)
   and a.cutmanid = c.employeeid(+)

 "
"WMS_QTY_CUT_PLAN_REPORT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_QTY_CUT_PLAN_REPORT_V"" (""PLANID"", ""PLANDATE"", ""PLANNAME"", ""WAREHID"", ""WAREHNAME"", ""BEGINCUTDATE"", ""ENDCUTDATE"", ""POSNUM"", ""CUTMANID"", ""CUTMANNAME"") AS 
  select a.planid,
         a.plandate,
         a.planname,
         a.warehid,
         d.warehname,
         min(b.cutdate) begincutdate,
         max(b.cutdate) endcutdate,
         count(b.posid) posnum,
         b.cutmanid,
         e.employeename cutmanname
    from wms_qty_cut_plan a,
         wms_qty_cut_plan_dtl b,
         tpl_warehouse d,
         pub_employee  e
   where a.planid = b.planid
     and a.warehid = d.warehid
     and b.cutmanid = e.employeeid(+)
     group by b.cutmanid,e.employeename,a.planid,
         a.plandate,
         a.planname,
         a.warehid,
         d.warehname
"
"WMS_QTY_CUT_PLAN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_QTY_CUT_PLAN_V"" (""PLANID"", ""PLANNAME"", ""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""PLANDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""USESTATUS"", ""MEMO"", ""CUTMETHOD"") AS 
  select a.PLANID,
       a.planname,
       a.CREDATE,
       a.WAREHID,
       b.warehname,
       a.PLANDATE,
       a.INPUTMANID,
       c.employeename INPUTMANname,
       a.USESTATUS,
       a.MEMO,
       a.cutmethod
  from WMS_QTY_CUT_PLAN a,
       tpl_warehouse    b,
       pub_employee     c
 where a.inputmanid = c.employeeid(+)
   and a.warehid = b.warehid
"
"WMS_QTY_CUT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_QTY_CUT_V"" (""CUTID"", ""WAREHID"", ""DTLLINES"", ""USESTATUS"", ""PLANID"", ""PLANDATE"", ""CUTTYPE"", ""MEMO"", ""WAREHNAME"", ""CUTDATE"", ""GOODSOWNERID"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""INPUTMANID"", ""TOWCSFLAG"", ""INPUTMAN"", ""CUTMETHOD"", ""ZX_TOASRSFLAG"", ""IWCS_DATE"", ""IWCS_MANID"", ""IWCS_STATUS"", ""IWCS_FLAG"") AS 
  SELECT a.CUTID,
       a.WAREHID,
       a.DTLLINES,
       a.usestatus,
       a.planid,
       e.plandate,
       a.cuttype,
       a.MEMO,
       b.warehname,
       a.Cutdate,
       a.goodsownerid,
       c.goopcode,
       c.goodsownername,
       a.inputmanid,
       a.towcsflag,
       d.employeename inputman,
       a.cutmethod,
       a.zx_toasrsflag,--发送立库标记 add by wanghuaiyu 2013年12月17日 18:55:23
       a.iwcs_date,
       a.iwcs_manid,
       a.iwcs_status,
       a.iwcs_flag
  from wms_qty_cut    a,
       tpl_warehouse  b,
       tpl_goodsowner c,
       pub_employee   d,
       wms_qty_cut_plan e
 where a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.inputmanid = d.employeeid(+)
   and a.planid = e.planid(+)
"
"WMS_QUERY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_QUERY_V"" (""WAVEID"", ""WAVEDTLID"", ""RECCOMPANYID"", ""ORDERID"", ""SCATTERPACKS"", ""SCATTERFINPACKS"", ""WHOLEPACKS"", ""WHOLEFINPACKS"", ""USESTATUS"", ""TRANSID"", ""DEPTNO"", ""INVOICETYPE"", ""ORDERS_SET"", ""MEMO"", ""DEPTNAME"", ""FLOWLINENO"", ""PACKEDQTY"", ""OPERATIONTYPE"", ""OUTMODE"", ""PRINTFLAG"", ""PRINTDATE"", ""PRINTMANID"", ""ROUTEID"", ""PRTCLASS"", ""SENDFLAG"", ""GOODSOWNERID"", ""TRANSCLASS"", ""YJDPRINTFLAG"", ""YJDPRINTMANID"", ""YJDPRINTDATE"", ""SHIPZONEID"", ""SHIPZONEFLAG"", ""SOURCEID"", ""WHOLESHIPPOSID"", ""SHIPPOSFLAG"") AS 
  select c.waveid,
         c.wavedtlid,
         c.customid reccompanyid,
         c.orderid,
         c.scatterpacks,
         c.scatterfinpacks,
         c.wholepacks,
         c.wholefinpacks,
         c.usestatus,
         c.transid,
         c.deptno,
         c.invoicetype,
         c.orders_set,
         c.memo,
         c.deptname,
         c.flowlineno,
         c.packedqty,
         c.operationtype,
         c.outmode,
         c.printflag,
         c.printdate,
         c.printmanid,
         c.routeid,
         c.prtclass,
         c.sendflag,
         c.goodsownerid,
         c.transclass,
         decode(c.yjdprintflag,null,null,1) yjdprintflag,
         c.yjdprintmanid,
         c.yjdprintdate,
         c.shipzoneid,
         c.shipzoneflag,
         a.sourceid,
         a.wholeshipposid,
         a.shipposflag
    from wms_st_io_doc a, wms_wave_goods_dtl b, wms_wave_dtl c
   where a.inoutflag = 1
     and a.comefrom = 3
     and a.wholeshipposid is not null
     and nvl(a.shipposflag, 0) = 0
     and a.sourceid = b.wavegoodsdtlid
     and b.wavedtlid = c.wavedtlid
"
"WMS_RECALL_LOT_REG_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_RECALL_LOT_REG_V"" (""REGID"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""FACTNAME"", ""PRODAREA"", ""TRADEPACKNAME"", ""DRUGFORM"", ""APPROVEDOCNO"", ""MAH"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""USESTATUS"", ""INPUTMANID"", ""INPUTMAN"", ""LOTGOODSID"", ""GOODSOWNERID1"") AS 
  select a.regid,
       a.credate,
       a.goodsownerid,
       b.goodsownername,
       a.ownergoodsid,
       c.waregoodsid    goodsid,
       c.goodsownid,
       c.goodsname,
       c.goodsengname,
       c.goodstype,
       c.factname,
       c.prodarea,
       c.tradepackname,
       c.drugform,
       c.approvedocno,
       c.mah,
       a.lotid,
       d.lotno,
       d.validdate,
       d.proddate,
       a.goodsstatusid,
       f.goodsstatus,
       a.usestatus,
       a.inputmanid,
       e.employeename   inputman,
       d.goodsid        lotgoodsid,
       c.goodsownerid   goodsownerid1
  from wms_recall_lot_reg a,
       tpl_goodsowner     b,
       tpl_goods          c,
       wms_goods_lot      d,
       pub_employee       e,
       wms_goodsstatus    f
 where a.goodsownerid = b.goodsownerid(+)
   and a.ownergoodsid = c.ownergoodsid(+)
   and a.lotid = d.lotid(+)
   and a.inputmanid = e.employeeid(+)
   and a.goodsstatusid = f.goodsstatusid(+)
"
"WMS_RECEIVE_DETAIL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_RECEIVE_DETAIL_V"" (""RECEIVEDETAILID"", ""RECEIVEDATE"", ""WAREHID"", ""OWNERGOODSID"", ""OWNERGOODSNAME"", ""OWNERGOODSOPCODE"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""GOODSPACKID"", ""GOODSPACKNAME"", ""PACKSIZE"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSCUBAGE"", ""GOODSWEIGHT"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""PRODDATE"", ""PRODLICENSENO"", ""REGISTNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""GOODSOWNID"", ""STORAGECONDITION"", ""RECMEMO"", ""INPUTMANID"", ""BACKWHYID"", ""APPROVEDOCNO"", ""RULINGFLAG"", ""USESTATUS"", ""RECEIVEDOCID"", ""L_PERIOD"", ""S_PERIODUNIT"", ""STATUSREASON"", ""MATCHFLAG"", ""PRINTMONTHFLAG"", ""LOTNOFACTNAME"") AS 
  select a.receivedetailid,
       a.receivedate,
       a.warehid,
       a.ownergoodsid,
       h.goodsname ownergoodsname,
       h.opcode ownergoodsopcode,
       a.goodsid,
       c.opcode,
       c.goodsname,
       h.goodstype,
       h.prodarea,
       --f.companyname factname,
       h.factname,
       a.goodspackid,
       a.goodspackname,
       a.packsize,
       a.goodslength,
       a.goodswidth,
       a.goodsheight,
       a.goodscubage,
       a.goodsweight,
       a.batchno,
       a.lotid,
       a.lotno,
       a.killlotno,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.proddate,
       a.prodlicenseno,
       a.registno,
       a.goodsstatusid,
       e.goodsstatus,
       a.quantitystatus,
       a.goodsqty,
       a.wholeqty,
       a.scatterqty,
       h.goodsownid,
       h.storagecondition,
       a.recmemo,a.inputmanid,
       a.backwhyid,
       a.approvedocno,
       a.rulingflag,
       a.usestatus,
       a.receivedocid,
       c.l_period,
       c.s_periodunit,
       a.statusreason,
       a.matchflag,
       a.printmonthflag,--add by wanghuaiyu 打印精确到月 2013年7月20日 10:53:13
       a.lotnofactname--add by wanghuaiyu 批号生产厂家 2013年7月31日 20:19:53
  from wms_receive_detail      a,
       wms_goods_lot            b,
       tpl_pub_goods            c,
       tpl_pub_goods_packs      d,
       wms_goodsstatus          e,
       tpl_goods                h
 where a.lotid = b.lotid(+)
   and a.goodsid = c.goodsid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.goodsstatusid = e.goodsstatusid(+)
   and a.ownergoodsid = h.ownergoodsid(+)
"
"WMS_RECEIVE_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_RECEIVE_DOC_V"" (""RECEIVEDOCID"", ""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""GOCOMPANYID"", ""GOCOMPANYOPCODE"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""RECEIVEMANID"", ""RECEIVEMANOPCODE"", ""EMPLOYEENAME"", ""USESTATUS"", ""CREDATE"", ""MEMO"") AS 
  SELECT a.receivedocid,
         a.warehid,
         c.warehopcode,
         c.warehname,
         a.goodsownerid,
         e.goopcode,
         e.goodsownername,
         a.gocompanyid,
         d.opcode gocompanyopcode,
         d.companyname,
         a.operationtype,
         a.receivemanid,
         b.opcode receivemanopcode,
         b.employeename,
         a.usestatus,
         a.credate,
         a.memo
  FROM wms_receive_doc a,
       pub_employee b,
       tpl_warehouse c,
       tpl_go_company d,
       tpl_goodsowner e
  WHERE a.receivemanid = b.employeeid(+)
  AND   a.warehid = c.warehid(+)
  AND   a.goodsownerid = e.goodsownerid(+)
  AND   a.gocompanyid = d.companyid(+)
"
"WMS_RECEIVE_DTL_AUTO_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_RECEIVE_DTL_AUTO_V"" (""INDTLID"", ""OUTDTLID"", ""GOODSOWNERID"", ""WAREHID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSPACKID"", ""GOODSNAME"", ""OWNERGOODSNAME"", ""GOODSOWNID"", ""GOODSTYPE"", ""PRODAREA"", ""BATCHNO"", ""LOTID"", ""POSID"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""WAVEDTLID"", ""PRINTLINE"", ""PRINTNO"", ""RECMEMO"", ""FACEQUALITY"", ""PACKQUALITY"", ""IMPORTREPFLAG"", ""PASSGATEFLAG"", ""REGISTEFLAG"", ""MEDCHECKFLAG"", ""ELIGIBLITYFLAG"", ""APPROVEDOCNO"", ""REGISTNO"", ""RPTNO"", ""BACKWHYID"", ""CHECKMANID1"", ""CHECKMANID2"", ""CHECKDOCNO"", ""QUCHECKID"", ""LQCCHECK"", ""PASSGATENO"", ""PIJIANNO"", ""INPUTMANID"", ""RECEIVEDATE"", ""SORTTYPE"", ""CHECKDATE"", ""WHOLESECTIONID"", ""SECTIONID"", ""SENDNO"", ""LPNCODE"", ""CONTAINERID"", ""CONTAINERNO"", ""CHECKMAN1"", ""CHECKMAN2"", ""RULINGFLAG"", ""GOODSPACKNAME"", ""PACKSIZE"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSCUBAGE"", ""GOODSWEIGHT"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""PRODDATE"", ""USESTATUS"", ""GSPFLAG"", ""RECEIVETYPE"", ""TRAYSECTIONID"", ""PRODLICENSENO"", ""STATUSREASON"", ""PRINTFLAG"", ""PRINTDATE"", ""PRINTMANID"", ""RECEIVEDOCID"", ""MATCHDATE"", ""MATCHMANID"", ""CHECKMEMO"", ""RECEIVEDETAILID"", ""MATCHFLAG"", ""PLANQUALIFIEDREASON"", ""PRINTMONTHFLAG"", ""LOTNOFACTNAME"", ""STORAGECONDITION"", ""TRANSTEMP"", ""INVOICECODE"", ""INVOICENO"", ""INVOICEDATE"", ""YJBG"", ""SHTXL"", ""UNQUALIFIEDMEMO"", ""CHECKMEMO1"", ""MAH"", ""PRINTEXPIREFLAG"") AS 
  select a.indtlid,
       b.outdtlid,
       a.goodsownerid,
       a.warehid,
       a.ownergoodsid,
       a.goodsid,
       a.goodspackid,
       h.goodsname,
       h.goodsname ownergoodsname,
       h.goodsownid,
       h.goodstype,
       h.prodarea,
       b.batchno,
       b.lotid,
       null posid,
       9 goodsstatusid, --调剂状态
       '合格.' goodsstatus,--调剂状态
       1 quantitystatus,
       b.goodsqty,
       0 wholeqty, --全部按散件上架
       b.goodsqty scatterqty,
       c.wavedtlid,
       null printline,
       null printno,
       null recmemo,
       1 facequality,
       1 packquality,
       1 importrepflag,
       null passgateflag,
       1 registeflag,
       1 medcheckflag,
       1 eligiblityflag,
       b.approvedocno,
       d.registno,
       null rptno,
       null backwhyid,
       null checkmanid1, --总单上的制单人ID
       null checkmanid2,
       null checkdocno,
       1 qucheckid,
       null lqccheck,
       null passgateno,
       null pijianno,
       null inputmanid, --总单上的制单人ID,
       sysdate receivedate, --保存时候的系统时间
       1 sorttype,
       sysdate checkdate, --保存时候的系统时间
       null wholesectionid,
       null sectionid,
       null sendno,
       null lpncode, --这个不知道前端代码怎么生成的
       0 containerid, --系统建了个缺省虚拟容器ID=0
       'XNRQ0000' containerno,
       null checkman1, --总单上的人员名字
       null checkman2,
       1 rulingflag,
       e.packname goodspackname,
       e.packsize,

       null goodslength,
       null goodswidth,
       null goodsheight,
       null goodscubage,
       null goodsweight,
       d.lotno,
       d.killlotno,
       d.validdate,
       d.proddate,
       1 usestatus,--临时状态
       1 gspflag,
       1 receivetype,
       null traysectionid,
       null prodlicenseno,
       null statusreason,
       null printflag,
       null printdate,
       null printmanid,
       null receivedocid,
       null matchdate,
       null matchmanid,
       null checkmemo,
       null receivedetailid,
       null matchflag,
       null planqualifiedreason,
       nvl(d.printmonthflag,0) printmonthflag,
       d.factname lotnofactname,
       1 storagecondition,
       0 transtemp,
       null invoicecode,--发票信息，取总单值
       null invoiceno,--发票信息，取总单值
       null invoicedate,--发票信息，取总单值
       null yjbg,
       null shtxl,
       null unqualifiedmemo,
       null checkmemo1,
       d.mah,
       nvl(d.printexpireflag,0) printexpireflag
  from wms_in_order_dtl    a,
       wms_out_order_dtl   b,
       wms_out_order       c,
       wms_goods_lot       d,
       tpl_pub_goods_packs e,
       wms_in_order        g,
       tpl_goods           h,
       tpl_goods           i,
       tpl_pub_goods_packs j
 where to_char(a.from_salesdtlid) = b.dtlzxcolumn4
   and b.outid = c.outid
   and a.inid=g.inid
   and g.operationtype=1 --进货
   and c.operationtype=11 --销售
   and c.usestatus = 4 --已出货
   and nvl(a.clflag,0)=1 --入库细单已经收货完成
   and b.lotid = d.lotid(+)
   and a.ownergoodsid=h.ownergoodsid
   and b.ownergoodsid=i.ownergoodsid
   and nvl(g.autoflag,0)=1
   and to_char(g.from_salesid)=c.zxcolumn4
   and h.goodsownid=i.goodsownid
   and a.goodsqty=b.goodsqty
   and a.goodspackid=e.goodspackid(+)
   and b.goodspackid=j.goodspackid(+)
   and e.packname=j.packname
   and e.packsize=j.packsize
   and not exists (select 1 from wms_receive_dtl t where t.indtlid=a.indtlid)
"
"WMS_RECEIVE_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_RECEIVE_DTL_V"" (""RECEIVEID"", ""RECEIVEDATE"", ""CHECKDATE"", ""INDTLID"", ""WAREHID"", ""OWNERGOODSID"", ""OWNERGOODSNAME"", ""OWNERGOODSOPCODE"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""DRUGFORM"", ""GOODSPACKID"", ""GOODSPACKNAME"", ""PACKSIZE"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSCUBAGE"", ""GOODSWEIGHT"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""REALVALIDDATE"", ""PRODDATE"", ""PRODLICENSENO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""WMSSTATUS"", ""QUANTITYSTATUS"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""GOODSOWNID"", ""STORAGECONDITION"", ""RECMEMO"", ""FACEQUALITY"", ""PACKQUALITY"", ""TRANSTEMP"", ""IMPORTREPFLAG"", ""PASSGATEFLAG"", ""REGISTEFLAG"", ""MEDCHECKFLAG"", ""ELIGIBILITYFLAG"", ""APPROVEDOCNO"", ""REGISTNO"", ""RPTNO"", ""BACKWHYID"", ""CHECKMANID1"", ""CHECKMAN1"", ""CHECKMANID2"", ""CHECKMAN2"", ""CHECKDOCNO"", ""LQCCHECK"", ""PASSGATENO"", ""PIJIANNO"", ""QUCHECKID"", ""LPNCODE"", ""CONTAINERID"", ""CONTAINERNO"", ""TYPEID"", ""QUCHECKNAME"", ""INPUTMANID"", ""INPUTMAN"", ""SORTTYPE"", ""TRAYSECTIONID"", ""TRAYSECTIONNO"", ""TRAYSECTIONNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""WHOLESECTIONID"", ""WHOLESECTIONNO"", ""WHOLESECTIONNAME"", ""SENDNO"", ""USESTATUS"", ""RULINGFLAG"", ""GSPFLAG"", ""RECEIVETYPE"", ""STATUSREASON"", ""RECEIVEDETAILID"", ""L_PERIOD"", ""S_PERIODUNIT"", ""CHECKMEMO"", ""MATCHFLAG"", ""ECODEFLAG"", ""DBINCHECK"", ""PRINTMONTHFLAG"", ""PLANQUALIFIEDREASON"", ""LOTNOFACTNAME"", ""INVOICECODE"", ""INVOICENO"", ""INVOICEDATE"", ""YJBG"", ""SHTXL"", ""UNQUALIFIEDMEMO"", ""SEQFLAG"", ""CHECKMEMO1"", ""MAH"", ""IWCS_FLAG"", ""IWCS_STATUS"", ""IWCS_MSG"", ""IWCS_DATE"", ""PRINTEXPIREFLAG"", ""UDI_CODE"", ""OUTGENID"", ""OUTDTLID"", ""YJDFLAG"", ""PRODMONTHFLAG"", ""VALIDDATE2"", ""IWCS_ERR"", ""ZX_WDFW"") AS 
  select a.receiveid,
       a.receivedate,
       a.checkdate,
       a.indtlid,
       a.warehid,
       a.ownergoodsid,
       h.goodsname ownergoodsname,
       h.opcode ownergoodsopcode,
       a.goodsid,
       c.opcode,
       h.goodsname,
       h.goodstype,
       h.prodarea,
       --f.companyname factname,
       h.factname,
       h.drugform, -- 【收货验收】细单新增剂型字段，xyue 2014年1月22日 12:58:54
       a.goodspackid,
       a.goodspackname,
       a.packsize,
       a.goodslength,
       a.goodswidth,
       a.goodsheight,
       a.goodscubage,
       a.goodsweight,
       a.batchno,
       a.lotid,
       a.lotno,
       a.killlotno,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.validdate realvaliddate, --add by tang 2017-01-05
       a.proddate,
       a.prodlicenseno,
       a.goodsstatusid,
       e.goodsstatus,
       e.wmsstatus, --add by xyue 2015-01-07 增加物流状态
       a.quantitystatus,
       a.goodsqty,
       a.wholeqty,
       a.scatterqty,
       h.goodsownid,
       h.storagecondition,
       a.recmemo,
       a.facequality,
       a.packquality,
       a.transtemp,
       a.importrepflag,
       a.passgateflag, -- 通关单
       a.registeflag, --  注册证
       a.medcheckflag, -- 药检证标志
       a.eligibilityflag, --  合格证标志
       a.approvedocno, --  批准文号
       --h.approvedocno, --取货主货品信息上的批准文号 xyue 2014-03-21 15:54:54
       a.registno, -- 进口注册证号
       a.rptno, --  岸检验报告编号
       a.backwhyid, -- 退货原因
       a.checkmanid1, --   验收员A
       a.checkman1,
       a.checkmanid2, --  验收员B
       a.checkman2,
       a.checkdocno, --检验单号
       a.lqccheck, --可见异物检验
       a.passgateno, --通关单号
       a.pijianno, --批件号
       a.qucheckid, --检查部门ID
       a.lpncode,
       a.containerid,
       s.containerno,
       s.typeid,
       o.companyname qucheckname,
       a.inputmanid,
       i.employeename inputman, --收货人 add by wanghuaiyu 2013年7月23日 16:32:07
       a.sorttype,
       a.traysectionid,
       t.sectionno traysectionno,
       t.sectionname traysectionname,
       a.sectionid,
       p.sectionno,
       p.sectionname,
       a.wholesectionid,
       r.sectionno wholesectionno,
       r.sectionname wholesectionname,
       a.sendno,
       a.usestatus,
       a.rulingflag,
       a.gspflag,
       a.receivetype,
       a.statusreason,
       a.receivedetailid,
       c.l_period,
       c.s_periodunit,
       a.checkmemo,
       a.matchflag,
       h.ecodeflag,
       h.dbincheck, --add by weitangjing 20131029 双验标志
       a.printmonthflag,
       a.planqualifiedreason, --拟合格原因 add by wanghuaiyu 20130617
       a.lotnofactname, --批号表上的生产厂家 add by wanghuaiyu 2013年7月24日 17:02:21
       a.invoicecode, --发票代码 add by xyue 2016-08-27
       a.invoiceno, --发票号码 add by xyue 2016-08-27
       a.INVOICEDATE, --发票日期 add by xyue 2016-08-27
       a.yjbg,
       a.shtxl,
       a.unqualifiedmemo, --add by xyue 2016-09-20 增加不合格处理措施
       nvl(h.seqflag, 0) seqflag, --add by xyue 2018-01-16 用于判断是否采集器械骨科产品编码
       a.checkmemo1, --add by xyue 2019-04-26 用于处理验收备注的判断为空
       a.mah, --add by xyue 2021-07-14 上市许可持有人,此处不取批号的，防止多条新单时不会被代出来
       a.iwcs_flag, --add by jsl 2020-06-06 iwcs标志
       a.iwcs_status,
       a.iwcs_msg,
       a.iwcs_date,
       a.printexpireflag, --add by xyue 2020-11-10
       a.udi_code,
       a.outgenid,
       a.outdtlid,
       (select nvl(max(tt.yjdflag),0)
          from wms_goods_lot_yjdflag tt
         where tt.goodsownerid = h.goodsownerid
           and tt.lotid = a.lotid) yjdflag, --add by xyue 2022-01-12 药检单上传情况标志
       a.prodmonthflag,
       a.validdate2,
       (case when a.iwcs_status=1 and a.iwcs_msg is not null then 1 else 0 end) iwcs_err,
       h.zx_wdfw --温度范围
  from wms_receive_dtl     a,
       wms_goods_lot       b,
       tpl_pub_goods       c,
       tpl_pub_company     f,
       tpl_pub_goods_packs d,
       wms_goodsstatus     e,
       tpl_goods           h,
       pub_company         o,
       wms_st_section_def  p,
       wms_st_section_def  r,
       wms_container_def   s,
       wms_st_section_def  t,
       pub_employee        i --add by wanghuaiyu 2013年7月23日 16:30:46
 where a.lotid = b.lotid(+)
   and a.goodsid = c.goodsid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.goodsstatusid = e.goodsstatusid(+)
   and a.ownergoodsid = h.ownergoodsid(+)
   and a.qucheckid = o.companyid(+)
   and a.sectionid = p.sectionid(+)
   and a.wholesectionid = r.sectionid(+)
   and a.containerid = s.containerid(+)
   and c.factid = f.companyid(+)
   and a.traysectionid = t.sectionid(+)
   and a.inputmanid = i.employeeid(+)
"
"WMS_RECEIVE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_RECEIVE_V"" (""RECEIVEID"", ""RECEIVEDETAILID"", ""RECEIVEDATE"", ""CHECKDATE"", ""INDTLID"", ""WAREHID"", ""OWNERGOODSID"", ""OWNERGOODSNAME"", ""OWNERGOODSOPCODE"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""GOODSPACKID"", ""GOODSPACKNAME"", ""PACKSIZE"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSCUBAGE"", ""GOODSWEIGHT"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""PRODDATE"", ""PRODLICENSENO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""GOODSOWNID"", ""STORAGECONDITION"", ""RECMEMO"", ""FACEQUALITY"", ""PACKQUALITY"", ""TRANSTEMP"", ""IMPORTREPFLAG"", ""PASSGATEFLAG"", ""REGISTEFLAG"", ""MEDCHECKFLAG"", ""ELIGIBILITYFLAG"", ""APPROVEDOCNO"", ""REGISTNO"", ""RPTNO"", ""BACKWHYID"", ""CHECKMANID1"", ""CHECKMAN1"", ""CHECKMANID2"", ""CHECKMAN2"", ""CHECKDOCNO"", ""LQCCHECK"", ""PASSGATENO"", ""PIJIANNO"", ""QUCHECKID"", ""LPNCODE"", ""CONTAINERID"", ""CONTAINERNO"", ""TYPEID"", ""QUCHECKNAME"", ""INPUTMANID"", ""SORTTYPE"", ""TRAYSECTIONID"", ""TRAYSECTIONNO"", ""TRAYSECTIONNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""WHOLESECTIONID"", ""WHOLESECTIONNO"", ""WHOLESECTIONNAME"", ""SENDNO"", ""USESTATUS"", ""RULINGFLAG"", ""GSPFLAG"", ""RECEIVETYPE"", ""STATUSREASON"", ""GOCOMPANYID"", ""COMPANYNAME"", ""GOODSOWNERID"", ""RECEIVEMANID"") AS 
  select a.receiveid,
       a.receivedetailid,
       a.receivedate,
       a.checkdate,
       a.indtlid,
       a.warehid,
       a.ownergoodsid,
       h.goodsname ownergoodsname,
       h.opcode ownergoodsopcode,
       a.goodsid,
       c.opcode,
       c.goodsname,
       h.goodstype,
       h.prodarea,
       --f.companyname factname,
       h.factname,
       a.goodspackid,
       a.goodspackname,
       a.packsize,
       a.goodslength,
       a.goodswidth,
       a.goodsheight,
       a.goodscubage,
       a.goodsweight,
       a.batchno,
       a.lotid,
       a.lotno,
       a.killlotno,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.proddate,
       a.prodlicenseno,
       a.goodsstatusid,
       e.goodsstatus,
       a.quantitystatus,
       a.goodsqty,
       a.wholeqty,
       a.scatterqty,
       h.goodsownid,
       h.storagecondition,
       a.recmemo,
       a.facequality,
       a.packquality,
       a.transtemp,
       a.importrepflag,
       a.passgateflag, -- 通关单
       a.registeflag, --  注册证
       a.medcheckflag, -- 药检证标志
       a.eligibilityflag, --  合格证标志
       a.approvedocno, --  批准文号
       a.registno, -- 进口注册证号
       a.rptno, --  岸检验报告编号
       a.backwhyid, -- 退货原因
       a.checkmanid1, --   验收员A
       a.checkman1,
       a.checkmanid2, --  验收员B
       a.checkman2,
       a.checkdocno, --检验单号
       a.lqccheck,--可见异物检验
       a.passgateno,--通关单号
       a.pijianno,--批件号
       a.qucheckid, --检查部门ID
       a.lpncode,
       a.containerid,
       s.containerno,
       s.typeid,
       o.companyname qucheckname,
       a.inputmanid,
       a.sorttype,
       a.traysectionid,
       t.sectionno traysectionno,
       t.sectionname traysectionname,
       a.sectionid,
       p.sectionno,
       p.sectionname,
       a.wholesectionid ,
       r.sectionno wholesectionno,
       r.sectionname wholesectionname,
       a.sendno,
       a.usestatus,
       a.rulingflag,
       a.gspflag,
       a.receivetype,
       a.statusreason,
       g.gocompanyid,
       i.companyname,
       g.goodsownerid,
       g.receivemanid
  from wms_receive_dtl          a,
       wms_receive_doc          g,
       wms_goods_lot            b,
       tpl_pub_goods            c,
       tpl_pub_company          f,
       tpl_pub_goods_packs      d,
       wms_goodsstatus          e,
       tpl_goods                h,
       pub_company              o,
       wms_st_section_def       p,
       wms_st_section_def       r,
       wms_container_def        s,
       wms_st_section_def       t,
       tpl_go_company           i,
       wms_receive_detail       j
 where a.lotid = b.lotid(+)
   and a.goodsid = c.goodsid
   and a.goodspackid = d.goodspackid
   and a.goodsstatusid = e.goodsstatusid
   and a.ownergoodsid = h.ownergoodsid
   and a.qucheckid = o.companyid(+)
   and a.sectionid = p.sectionid(+)
   and a.wholesectionid = r.sectionid(+)
   and a.containerid = s.containerid(+)
   and c.factid = f.companyid(+)
   and a.traysectionid = t.sectionid(+)
   and j.receivedocid = g.receivedocid
   and g.gocompanyid = i.companyid(+)
   AND a.receivedetailid = j.receivedetailid
   and nvl(a.indtlid,0) = 0
"
"WMS_RESOURCE_POS_USE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_RESOURCE_POS_USE_V"" (""SECTIONID"", ""USESTATUS"", ""NUM"") AS 
  select  sectionid, usestatus, sum(1) num
  from wms_pos_def_v
 group by  sectionid, usestatus
"
"WMS_RF_MAC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_RF_MAC_V"" (""MACID"", ""MACADDR"", ""REGID"", ""REGNAME"", ""APPID"", ""APPNAME"", ""USESTATUS"", ""REGDATE"", ""APPDATE"") AS 
  select a.macid,
       a.macaddr,
       a.regid,
       b.employeename as regname,
       a.appid,
       c.employeename as appname,
       a.usestatus,
       a.regdate,
       a.appdate
  from wms_rf_mac     a,
        pub_employee    b,
        pub_employee    c
  where a.regid = b.employeeid(+)
    and a.appid = c.employeeid(+)
"
"WMS_RF_OPERATOR_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_RF_OPERATOR_V"" (""EMPLOYEEID"", ""WAREHID"", ""RF_NO"", ""RF_PASSWORD"", ""OPCODE"", ""EMPLOYEENAME"", ""USESTATUS"", ""WAREHNAME"", ""WAREHOPCODE"") AS 
  SELECT a.employeeid,
       a.warehid,
       a.rf_no,
       '******' rf_password,
       b.opcode,
       b.employeename,
       b.usestatus,
       c.warehname,
       c.warehopcode
  from Wms_rf_operator a, Pub_employee b, tpl_warehouse c
 where a.employeeid = b.employeeid
   and a.warehid = c.warehid

 "
"WMS_RF_REG_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_RF_REG_V"" (""WAREHID"", ""RF_MAC"", ""REGDATE"", ""REGID"", ""DEVICEID"") AS 
  select a.WAREHID,a.RF_MAC,a.REGDATE,a.REGID,a.DEVICEID
  from WMS_RF_REG a

 "
"WMS_ROMENS_ST_QTY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ROMENS_ST_QTY_V"" (""GOODSOWNERID"", ""GOODSOWNID"", ""LOTNO"", ""GOODSQTY"", ""GOODSSTATUSID"") AS 
  select t.goodsownerid,
       a.goodsownid,
       trim(b.lotno) as lotno,
       sum(t.goodsqty) as goodsqty,
       t.goodsstatusid
  from (
        --库存表数据
        select a0.warehid,
                a0.goodsownerid,
                a0.ownergoodsid,
                a0.lotid,
                a0.goodsstatusid,
                a0.goodsqty
          from wms_St_qty_lst a0
         where a0.goodsownerid in
               (6, 682, 244, 304, 636, 658, 424, 404, 444, 284)

        union all
        --入库订单部分上架数据
        select c1.warehid,
                c1.goodsownerid,
                c1.ownergoodsid,
                c1.lotid,
                c1.goodsstatusid,
                c1.goodsqty * -1 as goodsqty
          from wms_in_order_dtl a1, wms_receive_dtl b1, wms_st_io_doc c1
         where a1.indtlid = b1.indtlid
           and b1.receiveid = c1.sourceid
           and c1.comefrom = 1
           and c1.goodsownerid in
               (6, 682, 244, 304, 636, 658, 424, 404, 444, 284)
           and a1.porderstatus in (1, 2) -- 下单和处理中
           and c1.rfflag = 3 --任务状态：3-执行完毕
           and c1.usestatus = 1 --状态：1-正式

        union all
        --出库订单未全部完成，部分出库已拣货出库完成
        select d2.warehid,
                d2.goodsownerid,
                d2.ownergoodsid,
                d2.lotid,
                d2.goodsstatusid,
                d2.goodsqty
          from  --wms_out_order      a2,
                wms_wave_dtl       b2,
                wms_wave_goods_dtl c2,
                wms_st_io_doc      d2
         where --a2.wavedtlid = b2.wavedtlid
           --and
           b2.wavedtlid = c2.wavedtlid
           and c2.wavegoodsdtlid = d2.sourceid
           and d2.comefrom in (2, 3)
           and d2.goodsownerid in
               (6, 682, 244, 304, 636, 658, 424, 404, 444, 284)
           --and a2.usestatus in (2, 3) --出库订单状态：2-待拣货 3-待复核
           and b2.usestatus in (2, 4) --波次分配状态：2-处理中 4-补货中
           and d2.rfflag = 3 --任务状态：3-执行完毕
           and d2.usestatus = 1 --状态：1-正式
        ) t,
       tpl_goods a,
       wms_goods_lot b
 where t.ownergoodsid = a.ownergoodsid
   and t.lotid = b.lotid
   and t.goodsqty <> 0
 group by t.goodsownerid, a.goodsownid, trim(b.lotno), t.goodsstatusid
"
"WMS_RULING_LST_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_RULING_LST_DTL_V"" (""DTLID"", ""LSTID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""OPCODE"", ""WAREGOODSID"", ""WAREGOODSNAME"", ""WAREGOODSOPCODE"", ""WAREGOODSQTYPE"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""GOODSQTY"", ""PRICE"", ""REASON"", ""EXPFLAG"", ""EXPDATE"", ""EXPFILENAME"", ""SOURCEID"") AS 
  select    a.dtlid,
          a.lstid,
          a.ownergoodsid,
          b.goodsname,
          b.goodstype,
          b.opcode,
          b.waregoodsid,
          c.goodsname waregoodsname,
          c.opcode waregoodsopcode,
          c.goodsqtype waregoodsqtype,
          a.lotno,
          a.killlotno,
           decode(to_char(a.validdate, 'yyyy-mm-dd'),
                  '2099-01-01',
                  to_date(null, 'yyyy-mm-dd'),
                  a.validdate) validdate,
          a.proddate,
          a.approvedocno,
          a.registno,
          a.goodsqty,
          a.price,
          a.reason,
          a.expflag,
          a.expdate,
          a.expfilename,
          a.sourceid
    from wms_ruling_lst_dtl a,
         tpl_goods b,
         tpl_pub_goods c
    WHERE a.ownergoodsid = b.ownergoodsid
    AND b.waregoodsid = c.goodsid
"
"WMS_RULING_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_RULING_LST_V"" (""LSTID"", ""CREDATE"", ""INPUTMANID"", ""IPUTMANNAME"", ""RECEIVEMANID"", ""RECEIVEMAN"", ""APPLYTYPE"", ""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOOPCODE"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""SOURCEID"", ""DESCRIP"", ""DEALING"", ""CONCLUSION"", ""CONCLUSIONMAN"", ""EXPFLAG_000"", ""EXPDATE_000"", ""EXPFILENAME"", ""USESTATUS"") AS 
  select
    a.lstid,
    a.credate,
    a.inputmanid,
    e.employeename iputmanname,
    a.receivemanid,
    f.employeename receiveman,
    a.applytype,
    a.warehid,
    b.warehopcode,
    b.warehname,
    a.goodsownerid,
    d.goopcode,
    d.goodsownername,
    a.companyid,
    c.opcode companyopcode,
    c.companyname,
    a.operationtype,
    a.sourceid,
    a.descrip,
    a.dealing,
    a.conclusion,
    a.conclusionman,
    a.expflag_000,
    a.expdate_000,
    a.expfilename,
    a.usestatus
  from wms_ruling_lst a,
  tpl_warehouse b,
  tpl_go_company c,
  tpl_goodsowner d,
  pub_employee   e,
  pub_employee   f
  where a.warehid = b.warehid
  and a.companyid = c.companyid(+)
  and a.goodsownerid = d.goodsownerid
  and a.inputmanid = e.employeeid(+)
 and a.receivemanid = f.employeeid(+)

 "
"WMS_SAMPLING_ADDRESS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_SAMPLING_ADDRESS_V"" (""LADDRESSID"", ""POINTID"", ""DEVICEID"", ""LADDRESS"", ""DESCR"", ""DELAY"") AS 
  select a.LADDRESSID,
       a.POINTID,
       a.DEVICEID,
       a.LADDRESS,
       b.descr,
       b.delay
  from WMS_SAMPLING_ADDRESS a,
  wms_sampling_point b
  where a.pointid = b.pointid

 "
"WMS_SAMPLING_POINT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_SAMPLING_POINT_V"" (""POINTID"", ""DESCR"", ""DELAY"", ""MEMO"") AS 
  select ""POINTID"",""DESCR"",""DELAY"",""MEMO""
  from WMS_SAMPLING_POINT

 "
"WMS_SECTION_TASK_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_SECTION_TASK_DTL_V"" (""CREDATE"", ""SECTIONID"", ""SECTIONNAME"", ""TASKID"", ""TASKTYPE"", ""RFFLAG"", ""USESTATUS"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""GOODSQTY"", ""TRADEPACKNAME"", ""LOTNO"", ""PACKNAME"", ""PACKSIZE"", ""SOURCECOMPANYID"", ""SRCCOMPANYNAME"", ""GCOMPANYID"", ""INOUTID"", ""PRODAREA"", ""COMEFROM"", ""DRUGFORM"", ""DRUGFORMNO"", ""LPNCODE"", ""CHECKMAN1"", ""CHECKMAN2"", ""CONTAINERID"", ""OPERATIONTYPE"", ""CONTAINERNO"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""AREAFLAG"", ""JS"", ""LSJS"", ""KEEPDATE"", ""POSID"", ""POSNAME"") AS 
  select
--一个为分区上架任务明细，内容为任务状态、任务下达时间、分区名称、货品ID、货主原货品ID、
--名称、规格、单位、数量、批号、包装单位、包装大小、客户ID、货主原客户ID、客户名称。
--查询条件为：状态、客户ID（HOV）、分区ID（Hov）、货品ID（Hov）、任务下达时间（必填，缺省为当天）、
--业务类型（波次补货上架、闲时补货上架、报警补货上架、入库上架）、业务来源（各种业务类型：进货、销退、还入等）
 b.credate,
 b.sectionid,
 j.sectionname,
 a.taskid,
 '入库上架' tasktype,
 b.rfflag,
 b.usestatus,
 b.goodsid,
 g.goodsownid,
 g.goodsname,
 g.goodstype,
 g.factname,
 b.goodsqty,
 g.tradepackname,
 i.lotno,
 h.packname,
 h.packsize,
 e.sourcecompanyid,
 f.companyname srccompanyname,
 f.gcompanyid,
 b.inoutid,
 g.prodarea,
 b.comefrom,
 g.drugform, --k.drugform 改为 g.drugform zyc by 20160901
 k.drugformno,
 c.lpncode,
 c.checkman1,
 c.checkman2,
 b.containerid,
 b.operationtype,
 t.containerno,
 a.warehid,
 g.goodsownerid,
 g.goodsownername,
 o.areaflag,
 decode(nvl(h.packsize, 0), 0, 0, ceil(b.goodsqty / h.packsize)) js, --件数 向上取整 add by 20160705 zyc
 (nvl(b.wholeqty, 0) + (case
   when (nvl(b.scatterqty, 0)) > 0 then
    1
   else
    0
 end)) lsjs, --取出入库单上的件数  by tl 181121
 b.keepdate,
 b.posid,
 l.posname
  from wms_task_doc        a,
       wms_st_io_doc       b,
       wms_receive_dtl     c,
       wms_in_order_dtl    d,
       wms_in_order        e,
       tpl_go_company      f,
       tpl_goods_v         g,
       tpl_pub_goods_packs h,
       wms_goods_lot       i,
       wms_st_section_def  j,
       tpl_drugform        k,
       wms_container_def   t,
       wms_st_area_def     o,
       wms_pos_def         l
 where a.taskid = b.taskid
   and a.tasktype = 3 --上架任务
   and b.comefrom = 1 --入库
   and b.sourceid = c.receiveid
   and c.indtlid = d.indtlid
   and d.inid = e.inid
   and b.containerid = t.containerid
   and j.areaid = o.areaid(+)
   and e.sourcecompanyid = f.companyid(+)
   and b.ownergoodsid = g.ownergoodsid
   and b.goodspackid = h.goodspackid(+)
   and b.lotid = i.lotid(+)
   and b.sectionid = j.sectionid(+)
   and g.drugform = k.drugformno(+)
   and b.posid = l.posid(+)
   and not exists
 (select 1
          from wms_receive_detail t2
         where c.receivedetailid = t2.receivedetailid)
union all
select b.credate,
       b.sectionid,
       j.sectionname,
       a.taskid,
       decode(e.subtype,
              1,
              '波次补货上架',
              5,
              '波次预补货上架',
              4,
              '手工补货上架',
              3,
              '闲时补货上架',
              '报警补货上架') tasktype,
       b.rfflag,
       b.usestatus,
       b.goodsid,
       g.goodsownid,
       g.goodsname,
       g.goodstype,
       g.factname,
       b.goodsqty,
       g.tradepackname,
       i.lotno,
       h.packname,
       h.packsize,
       null sourcecompanyid,
       null srccompanyname,
       null gcompanyid,
       b.inoutid,
       g.prodarea,
       b.comefrom,
       k.drugform,
       k.drugformno,
       null lpncode,
       NULL checkman1,
       NULL checkman2,
       b.containerid,
       b.operationtype,
       t.containerno,
       a.warehid,
       g.goodsownerid,
       g.goodsownername,
       o.areaflag,
       decode(nvl(h.packsize, 0), 0, 0, ceil(b.goodsqty / h.packsize)) js, --件数 向上取整 add by 20160705 zyc
       (nvl(b.wholeqty, 0) + (case
         when (nvl(b.scatterqty, 0)) > 0 then
          1
         else
          0
       end)) lsjs, --取出入库单上的件数  by tl 181121
       b.keepdate,
       b.posid,
       l.posname
  from wms_task_doc        a,
       wms_st_io_doc       b,
       wms_trade_dtl       d,
       wms_trade_order     e,
       tpl_goods_v         g,
       tpl_pub_goods_packs h,
       wms_goods_lot       i,
       wms_st_section_def  j,
       tpl_drugform        k,
       wms_container_def   t,
       wms_st_area_def     o,
       wms_pos_def         l
 where a.taskid = b.taskid
   and a.tasktype = 3 --上架
   and b.comefrom = 4 --库内下架任务（指库内变动单生成的下架任务）
   and b.sourceid = d.tradedtlid
   and d.tradeid = e.tradeid
   and b.containerid = t.containerid(+) --xyue 2015-07-08 增加外关联，否则查不出数据
   and e.subtype in (1, 2, 3, 4, 5) -- 1 波次补货 2 报警补货 3 闲时补货 4手工补货 5波次预补货;
   and b.ownergoodsid = g.ownergoodsid(+)
   and b.goodspackid = h.goodspackid(+)
   and b.lotid = i.lotid(+)
   and j.areaid = o.areaid(+)
   and b.sectionid = j.sectionid(+)
   and g.drugform = k.drugformno(+)
   and b.posid = l.posid(+)
union
select b.credate,
       b.sectionid,
       j.sectionname,
       a.taskid,
       '无订单入库' tasktype,
       b.rfflag,
       b.usestatus,
       b.goodsid,
       g.goodsownid,
       g.goodsname,
       g.goodstype,
       g.factname,
       b.goodsqty,
       g.tradepackname,
       i.lotno,
       h.packname,
       h.packsize,
       e.GOCOMPANYID,
       f.companyname srccompanyname,
       f.gcompanyid,
       b.inoutid,
       g.prodarea,
       b.comefrom,
       k.drugform,
       k.drugformno,
       c.lpncode,
       c.checkman1,
       c.checkman2,
       b.containerid,
       b.operationtype,
       t.containerno,
       a.warehid,
       g.goodsownerid,
       g.goodsownername,
       o.areaflag,
       decode(nvl(h.packsize, 0), 0, 0, ceil(b.goodsqty / h.packsize)) js, --件数 向上取整 add by 20160705 zyc
       (nvl(b.wholeqty, 0) + (case
         when (nvl(b.scatterqty, 0)) > 0 then
          1
         else
          0
       end)) lsjs, --取出入库单上的件数  by tl 181121
       b.keepdate,
       b.posid,
       l.posname
  from wms_task_doc        a,
       wms_st_io_doc       b,
       wms_receive_dtl     c,
       wms_receive_doc     e,
       tpl_go_company      f,
       tpl_goods_v         g,
       tpl_pub_goods_packs h,
       wms_goods_lot       i,
       wms_st_section_def  j,
       tpl_drugform        k,
       wms_container_def   t,
       wms_receive_detail  t2,
       wms_st_area_def     o,
       wms_pos_def         l
 where a.taskid = b.taskid
   and a.tasktype = 3 --上架任务
   and b.comefrom = 1 --入库
   and b.containerid = t.containerid(+) --xyue 2015-07-08 增加外关联，否则查不出数据
   and b.sourceid = c.receiveid
   and e.receivedocid = t2.receivedocid
   and t2.receivedetailid = c.receivedetailid
   and e.GOCOMPANYID = f.companyid(+)
   and b.ownergoodsid = g.ownergoodsid
   and j.areaid = o.areaid(+)
   and b.goodspackid = h.goodspackid(+)
   and b.lotid = i.lotid(+)
   and b.sectionid = j.sectionid(+)
   and g.drugform = k.drugformno(+)
   and b.posid = l.posid(+)
"
"WMS_SECTION_TASK_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_SECTION_TASK_LST_V"" (""AREAID"", ""AREANAME"", ""SECTIONID"", ""SECTIONNAME"", ""SORTTYPE"", ""TASKTYPE"", ""TASKSUM"", ""TASKDONESUM"", ""DOINGSUM"", ""DONEPACKS"", ""DOINGPACKS"", ""DONEQTY"", ""DOINGQTY"") AS 
  select a.areaid, --分区名称、业务类型、总上架任务数、已上架任务数、已上架件数、已上架散件数（即订单明细数）、
       a.areaname, --待上架任务数、待上架件数、待上架散件数、分区ID
       a.sectionid, --类型（进货、波次补货、安全补货、其他库内业务）
       a.sectionname,
       a.sorttype,
       '进货' tasktype, --类型
       (select count(distinct(b.taskid))
          from wms_st_io_doc b
         where b.sectionid = a.sectionid
           and b.comefrom = 1 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
           and b.inoutflag = 0) tasksum, --总上架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b
         where b.sectionid = a.sectionid
           and b.comefrom = 1
           and b.rfflag = 3 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
           and b.inoutflag = 0) taskdonesum, --已上架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b
         where b.sectionid = a.sectionid
           and b.comefrom = 1
           and b.rfflag = 2 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
           and b.inoutflag = 0) doingsum, --待上架任务数
       nvl((select count(distinct(b.taskid))--sum(nvl(b.wholeqty, 0))
             from wms_st_io_doc b
            where b.sectionid = a.sectionid
              and b.comefrom = 1
              and b.rfflag = 3 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
              and b.wholeqty > 0
              and b.inoutflag = 0),
           0) donepacks, --已上架件数
       nvl((select count(distinct(b.taskid))--sum(nvl(b.wholeqty, 0))
             from wms_st_io_doc b
            where b.sectionid = a.sectionid
              and b.comefrom = 1
              and b.rfflag = 2 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
              and b.wholeqty > 0
              and b.inoutflag = 0),
           0) doingpacks, --待上架件数
       nvl((select count(distinct(b.taskid))--sum(nvl(b.scatterqty, 0))
             from wms_st_io_doc b
            where b.sectionid = a.sectionid
              and b.comefrom = 1
              and b.rfflag = 3 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
              and b.scatterqty > 0
              and b.inoutflag = 0),
           0) doneqty, --已上架散件数
       nvl((select count(distinct(b.taskid))--sum(nvl(b.scatterqty, 0))
             from wms_st_io_doc b
            where b.sectionid = a.sectionid
              and b.comefrom = 1
              and b.rfflag = 2 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
              and b.scatterqty  > 0
              and b.inoutflag = 0),
           0) doingqty --待上架散件数
  from wms_st_section_def_v a
union
select a.areaid,
       a.areaname,
       a.sectionid,
       a.sectionname,
       a.sorttype,
       '波次补货' tasktype, --类型
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and c.operationtype = 29 --29补货 subtype = 1波次补货
           and c.subtype = 1 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
           and b.inoutflag = 0) tasksum, --总上架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.rfflag = 3 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
           and c.operationtype = 29 --补货
           and c.subtype = 1 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
           and b.inoutflag = 0) taskdonesum, --已上架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.rfflag = 2 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
           and c.operationtype = 29 --补货
           and c.subtype = 1
           and b.inoutflag = 0) doingnum, --待上架任务数
       nvl((select count(distinct(b.taskid))--sum(b.wholeqty)
             from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
            where b.sectionid = a.sectionid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.rfflag = 3 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
              and b.wholeqty> 0
              and c.operationtype = 29 --补货
              and c.subtype = 1
              and b.inoutflag = 0),
           0) donepacks, --已上架件数
       nvl((select count(distinct(b.taskid))--sum(b.wholeqty)
             from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
            where b.sectionid = a.sectionid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.rfflag = 2 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
              and b.wholeqty > 0
              and c.operationtype = 29 --补货
              and c.subtype = 1
              and b.inoutflag = 0),
           0) doingpacks, --待上架件数
       0 doneqty, --已上架散件数
       0 doingqty --待上架散件数
  from wms_st_section_def_v a
union
select a.areaid,
       a.areaname,
       a.sectionid,
       a.sectionname,
       a.sorttype,
       '闲时补货' tasktype, --类型
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and c.operationtype = 29 --29补货 subtype = 3安全补货
           and c.subtype = 3 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
           and b.inoutflag = 0) tasksum, --总上架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.rfflag = 3 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
           and c.operationtype = 29 --补货
           and c.subtype = 3
           and b.inoutflag = 0) taskdonesum, --已上架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.rfflag = 2 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
           and c.operationtype = 29 --补货
           and c.subtype = 3
           and b.inoutflag = 0) doingnum, --待上架任务数
       nvl((select count(distinct(b.taskid))--sum(b.wholeqty)
             from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
            where b.sectionid = a.sectionid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.rfflag = 3 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
              and b.wholeqty > 0
              and c.operationtype = 29 --补货
              and c.subtype = 3
              and b.inoutflag = 0),
           0) donepacks, --已上架件数
       nvl((select count(distinct(b.taskid))--sum(b.wholeqty)
             from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
            where b.sectionid = a.sectionid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.rfflag = 2 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
              and b.wholeqty > 0
              and c.operationtype = 29 --补货
              and c.subtype = 3
              and b.inoutflag = 0),
           0) doingpacks, --待上架件数
       0 doneqty, --已上架散件数
       0 doingqty --待上架散件数*/
  from wms_st_section_def_v a
union
select a.areaid,
       a.areaname,
       a.sectionid,
       a.sectionname,
       a.sorttype,
       '其他库内业务' tasktype, --类型
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.inoutflag = 0 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
           and ((c.operationtype = 29 --29补货
               and c.subtype not in (1, 3)) or c.operationtype <> 29)) tasksum, --总上架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.inoutflag = 0
           and b.rfflag = 3 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
           and ((c.operationtype = 29 --29补货
               and c.subtype not in (1, 3)) or c.operationtype <> 29)) taskdonesum, --已上架任务数
       (select count(distinct(b.taskid))
          from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
         where b.sectionid = a.sectionid
           and b.comefrom = 4 --库内变动
           and b.sourceid = d.tradedtlid
           and d.tradeid = c.tradeid
           and b.inoutflag = 0 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
           and b.rfflag = 2
           and ((c.operationtype = 29 --29补货
               and c.subtype not in (1, 3)) or c.operationtype <> 29)) doingnum, --待上架任务数
       nvl((select count(distinct(b.taskid))--sum(b.wholeqty)
             from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
            where b.sectionid = a.sectionid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.inoutflag = 0
              and b.wholeqty > 0 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
              and b.rfflag = 3
              and ((c.operationtype = 29 --29补货
                  and c.subtype not in (1, 3)) or c.operationtype <> 29)),
           0) donepacks, --已上架件数
       nvl((select count(distinct(b.taskid))--sum(b.wholeqty)
             from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
            where b.sectionid = a.sectionid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.inoutflag = 0 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
              and b.wholeqty > 0
              and b.rfflag = 2
              and ((c.operationtype = 29 --29补货
                  and c.subtype not in (1, 3)) or c.operationtype <> 29)),
           0) doingpacks, --待上架件数
       nvl((select count(distinct(b.taskid))--sum(b.scatterqty)
             from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
            where b.sectionid = a.sectionid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.inoutflag = 0 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
              and b.scatterqty > 0
              and b.rfflag = 3
              and ((c.operationtype = 29 --29补货
                  and c.subtype not in (1, 3)) or c.operationtype <> 29)),
           0) doneqty, --已上架散件数
       nvl((select count(distinct(b.taskid))--sum(b.scatterqty)
             from wms_st_io_doc b, tpl_trade_order c, tpl_trade_dtl d
            where b.sectionid = a.sectionid
              and b.comefrom = 4 --库内变动
              and b.sourceid = d.tradedtlid
              and d.tradeid = c.tradeid
              and b.inoutflag = 0 and b.credate > to_date(to_char(sysdate,'yyyymmdd'),'yyyymmdd')
              and b.scatterqty > 0
              and b.rfflag = 2
              and ((c.operationtype = 29 --29补货
                  and c.subtype not in (1, 3)) or c.operationtype <> 29)),
           0) doingqty --待上架散件数*/
  from wms_st_section_def_v a
"
"WMS_SHIPPOS_FIXED_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_SHIPPOS_FIXED_V"" (""WAVEDTLID"", ""RECCOMPANYID"", ""ROUTEID"", ""DEPTNO"", ""SALERID"", ""TRANSID"", ""INVOICETYPE"", ""DEPTNAME"", ""PRTCLASS"", ""TRANSCLASS"", ""GOODSOWNERID"", ""FLAG"", ""SRCID"", ""SHIPPOSID"", ""SHIPPOSFLAG"") AS 
  Select c.Wavedtlid,
       c.Customid reccompanyid,
       c.Routeid,
       c.Deptno,
       c.Salerid,
       c.Transid,
       c.invoicetype,
       c.deptname,
       c.prtclass,
       c.transclass,
       c.goodsownerid,
       0 Flag,
       a.Inoutid Srcid,
       a.Wholeshipposid Shipposid,
       a.Shipposflag
  From Wms_Wave_Goods_Dtl b,
       Wms_Wave_Dtl       c,
       Wms_St_Io_Doc      a,
       Wms_St_Area_Def    d
 Where b.Wavedtlid = c.Wavedtlid
   And a.Sourceid = b.Wavegoodsdtlid
   And a.Comefrom = 3
   And a.Areaid = d.Areaid
   And d.Areaflag In (0, 1)
    And nvl(a.shipposflag,0) <>2
Union All
Select c.Wavedtlid,
       c.Customid reccompanyid,
       c.Routeid,
       c.Deptno,
       c.Salerid,
       c.Transid,
       c.invoicetype,
       c.deptname,
       c.prtclass,
       c.transclass,
       c.goodsownerid,
       1 Flag,
       b.Boxdocid Srcid,
       b.Shipposid,
       0 Shipposflag
  From Wms_Turnbox_Doc b, Wms_Wave_Dtl c,wms_box_doc a
 Where b.Wavedtlid = c.Wavedtlid
 And b.boxdocid = a.docid(+)
 And nvl(a.shipposflag,0) <>2
"
"WMS_SHIPPOS_FIX_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_SHIPPOS_FIX_V"" (""RECCOMPANYID"", ""INOUTID"", ""TASKID"", ""BOXDOCID"", ""INOUTFLAG"", ""COMEFROM"", ""SOURCEID"", ""WAREHID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSPACKID"", ""BATCHNO"", ""LOTID"", ""POSID"", ""GOODSSTATUSID"", ""QUANTITYSTATUS"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""PRINTLINE"", ""PRINTNO"", ""KEEPDATE"", ""KEEPMANID"", ""OTHERID"", ""RFFLAG"", ""RFFINDATE"", ""RFMANID"", ""PRINTFLAG"", ""PRINTMANID"", ""PRINTDATE"", ""STOCKTEMPERATURE"", ""RETRECEPTFLAG"", ""CHECKSTATUS"", ""USESTATUS"", ""EXPFLAG"", ""EXPDATE"", ""EXPFILENAME"", ""MEMO"", ""PACKINGFLAG"", ""SECTIONID"", ""AREAID"", ""REALQTY"", ""CREDATE"", ""PICKAREAID"", ""PICKFLOWID"", ""GOODSOWNERID"", ""OPERATIONTYPE"", ""COMPANYID"", ""CONTAINERID"", ""RFMANID2"", ""CHECKMAN2ID"", ""CHECKMANID"", ""DOWNSTATUS"", ""PRINT2DATE"", ""PRINT2FLAG"", ""PRINT2MANID"", ""SHIPPOSFLAG"", ""TASKDTLID"", ""SHIPPOSID"", ""TOTALWHOLEPACK"", ""PRINTMOTHED"", ""STARTBOXNUM"", ""RECEIVEQTY"", ""SHIPPOSDATE"", ""SHIPPOSDOWNDATE"", ""WHOLESHIPPOSID"", ""WAVEDTLID"", ""ZONEID"", ""TRANSID"") AS 
  select a.companyid reccompanyid,
       a.INOUTID,
       a.TASKID,
       a.BOXDOCID,
       a.INOUTFLAG,
       a.COMEFROM,
       a.SOURCEID,
       a.WAREHID,
       a.OWNERGOODSID,
       a.GOODSID,
       a.GOODSPACKID,
       a.BATCHNO,
       a.LOTID,
       a.POSID,
       a.GOODSSTATUSID,
       a.QUANTITYSTATUS,
       a.INGOODSQTY,
       a.OUTGOODSQTY,
       a.GOODSQTY,
       a.WHOLEQTY,
       a.SCATTERQTY,
       a.PRINTLINE,
       a.PRINTNO,
       a.KEEPDATE,
       a.KEEPMANID,
       a.OTHERID,
       a.RFFLAG,
       a.RFFINDATE,
       a.RFMANID,
       decode(a.printflag,null,null,1) printflag,
       a.PRINTMANID,
       a.PRINTDATE,
       a.STOCKTEMPERATURE,
       a.RETRECEPTFLAG,
       a.CHECKSTATUS,
       a.USESTATUS,
       a.EXPFLAG,
       a.EXPDATE,
       a.EXPFILENAME,
       a.MEMO,
       a.PACKINGFLAG,
       a.SECTIONID,
       a.AREAID,
       a.REALQTY,
       a.CREDATE,
       a.PICKAREAID,
       a.PICKFLOWID,
       a.GOODSOWNERID,
       a.OPERATIONTYPE,
       a.COMPANYID,
       a.CONTAINERID,
       a.RFMANID2,
       a.CHECKMAN2ID,
       a.CHECKMANID,
       a.DOWNSTATUS,
       a.PRINT2DATE,
       a.PRINT2FLAG,
       a.PRINT2MANID,
       a.SHIPPOSFLAG,
       a.TASKDTLID,
       a.SHIPPOSID,
       a.TOTALWHOLEPACK,
       a.PRINTMOTHED,
       a.STARTBOXNUM,
       a.RECEIVEQTY,
       a.SHIPPOSDATE,
       a.SHIPPOSDOWNDATE,
       a.WHOLESHIPPOSID,
       b.wavedtlid,
       A.ZONEID,
       c.transid
  from wms_st_io_doc a, wms_wave_goods_dtl b,wms_wave_dtl c
 where a.sourceid = b.wavegoodsdtlid
   and b.wavedtlid = c.wavedtlid
   and nvl(a.shipposflag, 0) <> 2
   and a.comefrom = 3
   and a.inoutflag = 1
"
"WMS_SHIP_ZONE_OF_RULE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_SHIP_ZONE_OF_RULE_V"" (""RULEID"", ""ZONEID"", ""OFZONEID"", ""ZONENO"", ""ZONENAME"", ""PRIORITY"", ""MEMO"") AS 
  select a.ruleid,
         a.zoneid,
         a.ofzoneid,
         b.zoneno,
         b.zonename,
         a.priority,
         a.memo
    from wms_ship_zone_of_rule a,wms_ship_zone b
 where a.ofzoneid = b.zoneid(+)
"
"WMS_SHIP_ZONE_POS_RULE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_SHIP_ZONE_POS_RULE_V"" (""WAREHID"", ""RULEID"", ""ZONEID"", ""DESCR"", ""COLNAME"", ""COLSEQ"", ""MEMO"", ""WAREHNAME"", ""ZONENO"", ""ZONENAME"") AS 
  select a.warehid,
       a.ruleid,
       a.zoneid,
       a.descr,
       a.colname,
       a.colseq,
       a.memo,
       b.warehname,
       c.zoneno,
       c.zonename
  from wms_ship_zone_pos_rule a, tpl_warehouse b, wms_ship_zone c
 where a.warehid = b.warehid
   and a.zoneid = c.zoneid(+)
"
"WMS_SHIP_ZONE_POS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_SHIP_ZONE_POS_V"" (""WAREHID"", ""ZONEID"", ""SHIPPOSID"", ""POSNO"", ""POSNAME"", ""LENGTH"", ""WIDTH"", ""HEIGHT"", ""WEIGHT"", ""PACKS"", ""EXISTSPACKS"", ""EXISTSVOLUMN"", ""USESTATUS"", ""MEMO"", ""RECCOMPANYID"", ""COMPANYNAME"", ""OPCODE"", ""SEQ"", ""CHECKCONDITION"", ""POSTYPE"") AS 
  select a.warehid,
          a.zoneid,
          a.shipposid,
          a.posno,
          a.posname,
          a.length,
          a.width,
          a.height,
          a.weight,
          a.packs,
          a.existspacks,
          a.existsvolumn,
          a.usestatus,
          a.memo,
          a.reccompanyid,
          b.companyname,
          b.opcode,
          a.seq,
          a.checkcondition,
          a.postype
    from  wms_ship_zone_pos a,tpl_go_company b
    where a.reccompanyid = b.companyid(+)
"
"WMS_SHIP_ZONE_RULE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_SHIP_ZONE_RULE_V"" (""WAREHID"", ""RULEID"", ""ZONEID"", ""DESCR"", ""COLNAME"", ""COLSEQ"", ""MEMO"", ""WAREHNAME"", ""ZONENO"", ""ZONENAME"") AS 
  select a.WAREHID,
       a.RULEID,
       a.ZONEID,
       a.DESCR,
       a.COLNAME,
       a.COLSEQ,
       a.MEMO,
       b.warehname,
       c.zoneno,
       c.zonename
  from WMS_SHIP_ZONE_RULE a, tpl_warehouse b, wms_ship_zone c
 where a.warehid = b.warehid
   and a.zoneid = c.zoneid(+)
"
"WMS_SHIP_ZONE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_SHIP_ZONE_V"" (""WAREHID"", ""WAREHNAME"", ""ZONEID"", ""ZONENO"", ""ZONENAME"", ""USESTATUS"", ""CHECKCONDITION"", ""ZONETYPE"", ""MINPACKS"", ""MAXPACKS"", ""SORTPORT"", ""MEMO"", ""SEQ"") AS 
  select a.warehid,
       b.warehname,
       a.zoneid,
       a.zoneno,
       a.zonename,
       a.usestatus,
       a.checkcondition,
       a.zonetype,
       a.minpacks,
       a.maxpacks,
       a.SORTPORT,
       a.memo,
       a.seq
  from wms_ship_zone a, tpl_warehouse b
 where a.warehid = b.warehid
"
"WMS_STATE_SECTION_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_STATE_SECTION_V"" (""STATEID"", ""STATENO"", ""STATENAME"", ""CITYID"", ""PROVINCEID"", ""CITYOPCODE"", ""CITYNAME"", ""PROVINCEOPCODE"", ""PROVINCENAME"") AS 
  select a.stateid,
       a.stateno,
       a.statename,
       a.cityid,
       a.provinceid,
       b.cityopcode,
       b.cityname,
       c.provinceopcode,
       c.provincename
  from wms_state_section a, tpl_city b, tpl_province c
 where a.cityid = b.cityid(+)
   and a.provinceid = c.provinceid(+)

 "
"WMS_ST_AREA_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_AREA_DEF_V"" (""WAREHID"", ""AREAID"", ""AREANO"", ""AREANAME"", ""AREATYPE"", ""PROCESSTYPE"", ""FIXPOSFLAG"", ""FIXGOODSFLAG"", ""AREAFLAG"", ""QUANTYPE"", ""TEMPLOW"", ""TEMPHIGH"", ""HUMIDITYLOW"", ""HUMIDITYHIGH"", ""USEABLERATE"", ""USESTATUS"", ""MEMO"", ""WAREHOPCODE"", ""WAREHNAME"") AS 
  select a.""WAREHID"",
       a.""AREAID"",
       a.""AREANO"",
       a.""AREANAME"",
       a.""AREATYPE"",
       a.""PROCESSTYPE"",
       a.""FIXPOSFLAG"",
       a.""FIXGOODSFLAG"",
       a.""AREAFLAG"",
       a.""QUANTYPE"",
       a.""TEMPLOW"",
       a.""TEMPHIGH"",
       a.""HUMIDITYLOW"",
       a.""HUMIDITYHIGH"",
       a.""USEABLERATE"",
       a.""USESTATUS"",
       a.""MEMO"",
       b.warehopcode,
       b.warehname
  from wms_st_area_def a, tpl_warehouse b
 where a.warehid = b.warehid(+)
"
"WMS_ST_AREA_HOV_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_AREA_HOV_V"" (""WAREHID"", ""AREAID"", ""AREANO"", ""AREANAME"", ""AREATYPE"", ""PROCESSTYPE"", ""FIXPOSFLAG"", ""FIXGOODSFLAG"", ""AREAFLAG"", ""QUANTYPE"", ""TEMPLOW"", ""TEMPHIGH"", ""HUMIDITYLOW"", ""HUMIDITYHIGH"", ""USEABLERATE"", ""USESTATUS"", ""MEMO"", ""WAREHOPCODE"", ""WAREHNAME"") AS 
  select a.warehid,
       a.areaid,
       a.areano,
       a.areaname,
       a.areatype,
       a.processtype,
       a.fixposflag,
       a.fixgoodsflag,
       a.areaflag,
       a.quantype,
       a.templow,
       a.temphigh,
       a.humiditylow,
       a.humidityhigh,
       a.useablerate,
       a.usestatus,
       a.memo,
        b.warehopcode,
       b.warehname
  from wms_st_area_def a,
  tpl_warehouse b
  where a.warehid=b.warehid

 "
"WMS_ST_GOODS_LOT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_GOODS_LOT_V"" (""GOODSQTY"", ""WAREHID"", ""GOODSPACKID"", ""BATCHNO"", ""GOODSSTATUSID"", ""LOTID"", ""LOTNO"", ""OWNERGOODSID"", ""GOODSID"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""PRODLICENSENO"") AS 
  select sum(nvl(a.busiqty, 0) - nvl(a.outwaitqty, 0) +
           nvl(a.tradeinwaitqty, 0)) goodsqty,
       a.warehid,
       a.goodspackid,
       a.batchno,
       a.goodsstatusid,
       a.lotid,
       b.lotno,
       a.ownergoodsid,
       a.goodsid,
       decode(to_char(b.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              b.validdate) validdate,
       b.proddate,
       b.approvedocno,
       b.registno,
       b.prodlicenseno
  from wms_st_qty_lst a, wms_goods_lot b
 where a.lotid = b.lotid
 group by a.lotid,
          a.warehid,
          a.goodspackid,
          a.batchno,
          a.goodsstatusid,
          b.lotno,
          b.validdate,
          b.proddate,
          b.approvedocno,
          a.ownergoodsid,
          a.goodsid,
          b.registno,
          b.prodlicenseno
"
"WMS_ST_IO_DOC_HIS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_IO_DOC_HIS_V"" (""INOUTID"", ""TASKID"", ""BOXDOCID"", ""INOUTFLAG"", ""COMEFROM"", ""SOURCEID"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTORYNAME"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""POSID"", ""POSNO"", ""POSNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""INGROUPID"", ""INGROUPNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""AREAFLAG"", ""AREATYPE"", ""PICKAREAID"", ""PICKAREANAME"", ""PICKORDER"", ""PICKGROUPID"", ""PICKGROUPNAME"", ""PICKFLOWID"", ""PICKFLOWNO"", ""PICKFLOWNAME"", ""WCSFLAG"", ""INFLUXFLAG"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""REALQTY"", ""GOODSQTY"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""PRINTLINE"", ""PRINTNO"", ""KEEPDATE"", ""KEEPMANID"", ""KEEPMANNAME"", ""OTHERID"", ""PACKINGFLAG"", ""RFFLAG"", ""RFFINDATE"", ""RFMANID"", ""TRADEPACKNAME"", ""RFMANNAME"", ""RFMANID2"", ""RFMAN2NAME"", ""PRINTFLAG"", ""PRINTMANID"", ""PRINTMANNAME"", ""PRINTDATE"", ""RETRECEPTFLAG"", ""CHECKSTATUS"", ""USESTATUS"", ""CHECKMANID"", ""CHECKMAN2ID"", ""CHECKMANNAME"", ""CHECKMAN2NAME"", ""GOODSOWNID"", ""GOODSNO"", ""CREDATE"", ""MEMO"", ""OPERATIONTYPE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""CONTAINERID"", ""CONTAINERNO"", ""PICKSEQ"", ""INNERSEQ"", ""POSWAIQTY"", ""ECODEFLAG"", ""GOODSENGNAME"", ""DOWNSTATUS"", ""SALERID"", ""SALERNAME"", ""PRINT2FLAG"", ""PRINT2MANID"", ""PRINT2MANNAME"", ""PRINT2DATE"", ""OUTID"", ""OUTDTLID"", ""ZXCOLUMN2"") AS 
  select a.inoutid,
       a.taskid,
       a.boxdocid,
       a.inoutflag,
       a.comefrom,
       a.sourceid,
       a.warehid,
       b.warehname,
       a.ownergoodsid,
       a.goodsid,
       c.goodsname,
       c.goodstype,
       c.prodarea,
       c.factid,
       l.companyname factoryname,
       a.goodspackid,
       d.packname,
       d.packsize,
       a.batchno,
       a.lotid,
       e.lotno,
       e.proddate,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,
       e.approvedocno,
       a.posid,
       f.posno,
       f.posname,
       a.sectionid,
       n.sectionno,
       n.sectionname,
       n.groupid ingroupid,--上架小组ID
       w.groupname ingroupname,
       a.areaid,
       m.areano,
       m.areaname,
       m.areaflag,
       m.areatype,
       a.pickareaid,
       r.pickareaname,
       r.pickorder,
       r.groupid pickgroupid, --下架小组ID
       x.groupname pickgroupname,
       a.pickflowid,
       s.pickflowno,
       s.pickflowname,
       s.wcsflag,
       s.influxflag,
       a.goodsstatusid,
       g.goodsstatus,
       g.quantitystatus,
       a.realqty,
       a.goodsqty,
       a.ingoodsqty,
       a.outgoodsqty,
       a.wholeqty,
       a.scatterqty,
       a.printline,
       a.printno,
       a.keepdate,
       a.keepmanid,
       h.employeename keepmanname,
       a.otherid,
       a.packingflag,
       a.rfflag,
       a.rffindate,
       a.rfmanid,
       p.tradepackname,
       i.employeename rfmanname,
       a.rfmanid2,
       v.employeename rfman2name,
       a.printflag,
       a.printmanid,
       j.employeename printmanname,
       a.printdate,
       a.retreceptflag,
       nvl(a.checkstatus,0)checkstatus,
       nvl(a.usestatus, 0) usestatus,
       a.checkmanid,
       a.checkman2id,
       k.employeename checkmanname,
       y.employeename checkman2name,
       p.goodsownid,
       p.goodsno,
       a.credate,
       a.memo,
       a.operationtype,
       a.GOODSOWNERID,
       o.goodsownername,
       a.companyid,
       decode(nvl(t2.sendpos,''),'', q.companyname ,t2.sendpos) companyname,
       a.containerid,
       t.containerno,
       u.pickseq,
       f.innerseq,
       Null POSWAIQTY,
       p.ecodeflag,
       p.goodsengname,
       nvl(a.downstatus,0) downstatus,
       aa.salerid,
       aa.salername,
       nvl(a.print2flag,0) print2flag,
       a.print2manid,
       p1.employeename print2manname,
       a.print2date,aa.outid,bb.outdtlid,aa.zxcolumn2
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_pub_goods       c,
       tpl_pub_goods_packs d,
       wms_goods_lot       e,
       wms_pos_def         f,
       wms_goodsstatus     g,
       pub_employee        h,
       pub_employee        i,
       pub_employee        j,
       tpl_pub_company     l,
       wms_st_area_def     m,
       wms_st_section_def  n,
       tpl_goods           p,
       tpl_goodsowner      o,
       tpl_go_company      q,
       wms_pickarea        r,
       wms_pickflow        s,
       wms_container_def   t,
       wms_pickarea_pos_def u,
       pub_employee v,
       wms_group_def w,
       wms_group_def x,
       pub_employee k,
       pub_employee y,
       wms_out_order aa,
       wms_out_order_dtl bb,
       wms_transport_address t2,
       pub_employee p1
 where a.warehid = b.warehid(+)
   and a.goodsid = c.goodsid(+)
   and c.factid = l.companyid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.lotid = e.lotid(+)
   and a.posid = f.posid(+)
   and a.areaid = m.areaid(+)
   and a.sectionid = n.sectionid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.keepmanid = h.employeeid(+)
   and a.rfmanid = i.employeeid(+)
   and a.printmanid = j.employeeid(+)
   and a.ownergoodsid = p.ownergoodsid(+)
   and a.goodsownerid = o.goodsownerid(+)
   and a.companyid = q.companyid(+)
   and a.pickareaid = r.pickareaid(+)
   and a.pickflowid = s.pickflowid(+)
   and a.containerid = t.containerid(+)
   and a.posid = u.posid(+)
   And a.rfmanid2 = v.employeeid(+)
   AND n.groupid = w.groupid(+)
   AND r.groupid = x.groupid(+)
   AND a.checkmanid = k.employeeid(+)
   AND a.checkman2id = y.employeeid(+)
   AND a.sourceid = bb.wavegoodsdtlid(+)
   and bb.outid  = aa.outid(+)
   and aa.transid = t2.transid(+)
   AND a.print2manid = p1.employeeid(+)
"
"WMS_ST_IO_DOC_INIT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_IO_DOC_INIT_V"" (""INOUTID"", ""INOUTFLAG"", ""COMEFROM"", ""SOURCEID"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""OWNERGOODSID"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""POSID"", ""POSNO"", ""POSNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""AREAFLAG"", ""AREATYPE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""PRINTLINE"", ""PRINTNO"", ""KEEPDATE"", ""KEEPMANID"", ""KEEPMANNAME"", ""OTHERID"", ""RFFLAG"", ""RFFINDATE"", ""RFMANID"", ""PRINTDATE"", ""RETRECEPTFLAG"", ""CHECKSTATUS"", ""USESTATUS"", ""MEMO"", ""CONTAINERID"", ""CONTAINERNO"", ""CREDATE"") AS 
  select a.inoutid,
       a.inoutflag,
       a.comefrom,
       a.sourceid,
       a.warehid,
       b.warehname,
       a.goodsownerid,
       a.ownergoodsid,
       a.goodsid,
       c.opcode,
       c.goodsname,
       c.goodstype,
       c.prodarea,
       a.goodspackid,
       d.packname,
       d.packsize,
       a.batchno,
       a.lotid,
       e.lotno,
       e.proddate,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,
       e.approvedocno,
       a.posid,
       f.posno,
       f.posname,
       a.sectionid,
       n.sectionno,
       n.sectionname,
       a.areaid,
       m.areano,
       m.areaname,
       m.areaflag,
       m.areatype,
       a.goodsstatusid,
       g.goodsstatus,
       g.quantitystatus,
       a.ingoodsqty,
       a.outgoodsqty,
       a.goodsqty,
       a.wholeqty,
       a.scatterqty,
       a.printline,
       a.printno,
       a.keepdate,
       a.keepmanid,
       h.employeename keepmanname,
       a.otherid,
       a.rfflag,
       a.rffindate,
       a.rfmanid,
       a.printdate,
       a.retreceptflag,
       nvl(a.checkstatus,0)checkstatus,
       nvl(a.usestatus, 0) usestatus,
       a.memo,
       a.containerid,
       o.containerno,
       a.credate
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_goods           c,
       tpl_pub_goods_packs d,
       wms_goods_lot       e,
       wms_goodsstatus     g,
       pub_employee        h,
       wms_pos_def         f,
       wms_st_area_def     m,
       wms_st_section_def  n,
       wms_container_def   o
 where a.warehid = b.warehid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.lotid = e.lotid(+)
   and a.posid = f.posid(+)
   and a.areaid = m.areaid(+)
   and a.sectionid = n.sectionid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.keepmanid = h.employeeid(+)
   and a.ownergoodsid = c.ownergoodsid(+)
   and a.comefrom=0
   and a.containerid = o.containerid(+)
"
"WMS_ST_IO_DOC_OUT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_IO_DOC_OUT_V"" (""INOUTID"", ""TASKID"", ""BOXDOCID"", ""INOUTFLAG"", ""COMEFROM"", ""SOURCEID"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTORYNAME"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""POSID"", ""POSNO"", ""POSNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""AREAFLAG"", ""AREATYPE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""PRINTLINE"", ""PRINTNO"", ""KEEPDATE"", ""KEEPMANID"", ""KEEPMANNAME"", ""OTHERID"", ""RFFLAG"", ""RFFINDATE"", ""RFMANID"", ""RFMANNAME"", ""PRINTFLAG"", ""PRINTMANID"", ""PRINTMANNAME"", ""PRINTDATE"", ""RETRECEPTFLAG"", ""CHECKSTATUS"", ""USESTATUS"", ""GOODSOWNID"", ""GOODSNO"", ""TRADEPACKNAME"", ""CREDATE"", ""MEMO"", ""REALQTY"", ""OPERATIONTYPE"", ""COMPANYID"", ""COMPANYNAME"") AS 
  select a.inoutid,
       a.taskid,
       a.boxdocid,
       a.inoutflag,
       a.comefrom,
       a.sourceid,
       a.warehid,
       b.warehname,
       a.ownergoodsid,
       a.goodsid,
       c.goodsname,
       c.goodstype,
       c.prodarea,
       c.factid,
       l.companyname factoryname,
       a.goodspackid,
       d.packname,
       d.packsize,
       a.batchno,
       a.lotid,
       e.lotno,
       e.proddate,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,
       e.approvedocno,
       a.posid,
       f.posno,
       f.posname,
       a.sectionid,
       n.sectionno,
       n.sectionname,
       a.areaid,
       m.areano,
       m.areaname,
       m.areaflag,
       m.areatype,
       a.goodsstatusid,
       g.goodsstatus,
       g.quantitystatus,
       a.ingoodsqty,
       a.outgoodsqty,
       a.goodsqty,
       a.wholeqty,
       a.scatterqty,
       a.printline,
       a.printno,
       a.keepdate,
       a.keepmanid,
       h.employeename keepmanname,
       a.otherid,
       a.rfflag,
       a.rffindate,
       a.rfmanid,
       i.employeename rfmanname,
       decode(a.printflag,null,null,1) printflag,
       a.printmanid,
       j.employeename printmanname,
       a.printdate,
       a.retreceptflag,
       nvl(a.checkstatus,0)checkstatus,
       nvl(a.usestatus, 0) usestatus,
       p.goodsownid,
       p.goodsno,
       p.tradepackname,
       q.credate,
       a.memo,
       a.realqty,
       r.operationtype,
       o.companyid,
       o.companyname
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_pub_goods       c,
       tpl_pub_goods_packs d,
       wms_goods_lot       e,
       wms_goodsstatus     g,
       pub_employee        h,
       pub_employee        i,
       pub_employee        j,
       wms_wave_goods_dtl  k,
       wms_wave_dtl        r,
       tpl_pub_company     l,
       wms_pos_def         f,
       wms_st_area_def     m,
       wms_st_section_def  n,
       tpl_goods           p,
       wms_task_doc        q,
       tpl_go_company o
 where a.warehid = b.warehid(+)
   and a.goodsid = c.goodsid(+)
   and c.factid = l.companyid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.lotid = e.lotid(+)
   and a.posid = f.posid(+)
   and a.areaid = m.areaid(+)
   and a.sectionid = n.sectionid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.keepmanid = h.employeeid(+)
   and a.rfmanid = i.employeeid(+)
   and a.printmanid = j.employeeid(+)
   and a.comefrom = 3
   and a.sourceid = k.wavegoodsdtlid(+)
   and k.wavedtlid = r.wavedtlid
   and p.ownergoodsid = a.ownergoodsid
   and q.taskid(+) = a.taskid
   and r.customid=o.companyid
"
"WMS_ST_IO_DOC_QUERY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_IO_DOC_QUERY_V"" (""INOUTID"", ""TASKID"", ""BOXDOCID"", ""INOUTFLAG"", ""COMEFROM"", ""SOURCEID"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTORYNAME"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""POSID"", ""POSNO"", ""POSNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""INGROUPID"", ""INGROUPNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""AREAFLAG"", ""AREATYPE"", ""PICKAREAID"", ""PICKAREANAME"", ""PICKORDER"", ""PICKGROUPID"", ""PICKGROUPNAME"", ""PICKFLOWID"", ""PICKFLOWNO"", ""PICKFLOWNAME"", ""WCSFLAG"", ""INFLUXFLAG"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""REALQTY"", ""GOODSQTY"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""PRINTLINE"", ""PRINTNO"", ""KEEPDATE"", ""KEEPMANID"", ""KEEPMANNAME"", ""OTHERID"", ""PACKINGFLAG"", ""RFFLAG"", ""RFFINDATE"", ""RFMANID"", ""TRADEPACKNAME"", ""RFMANNAME"", ""RFMANID2"", ""RFMAN2NAME"", ""PRINTFLAG"", ""PRINTMANID"", ""PRINTMANNAME"", ""PRINTDATE"", ""RETRECEPTFLAG"", ""CHECKSTATUS"", ""USESTATUS"", ""CHECKMANID"", ""CHECKMAN2ID"", ""CHECKMAN1"", ""CHECKMAN2"", ""CHECKMANNAME"", ""CHECKMAN2NAME"", ""GOODSOWNID"", ""GOODSNO"", ""CREDATE"", ""MEMO"", ""OPERATIONTYPE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""CONTAINERID"", ""CONTAINERNO"", ""PICKSEQ"", ""INNERSEQ"", ""POSWAIQTY"", ""ECODEFLAG"", ""GOODSENGNAME"", ""DOWNSTATUS"", ""SALERID"", ""SALERNAME"", ""BOXCODE"", ""BOXMAN"", ""BOXMANID"", ""BOXCREDATE"", ""WHOLESHIPPOSID"", ""SHIPPOSFLAG"", ""CHECKEDQTY"", ""MAH"", ""PRINTEXPIREFLAG"", ""WAVEDTLID"", ""UDI_FLAG"") AS 
  select a.inoutid,
       a.taskid,
       a.boxdocid,
       a.inoutflag,
       a.comefrom,
       a.sourceid,
       a.warehid,
       b.warehname,
       a.ownergoodsid,
       a.goodsid,
       p.goodsname,
       p.goodstype,
       p.prodarea,
       c.factid,
       nvl(e.factname,p.factname) as factoryname,--change by xyue 2025-03-11
       a.goodspackid,
       d.packname,
       d.packsize,
       a.batchno,
       a.lotid,
       e.lotno,
       e.proddate,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,
       e.approvedocno,
       a.posid,
       f.posno,
       f.posname,
       a.sectionid,
       n.sectionno,
       n.sectionname,
       n.groupid ingroupid, --上架小组ID
       w.groupname ingroupname,
       a.areaid,
       m.areano,
       m.areaname,
       m.areaflag,
       m.areatype,
       a.pickareaid,
       r.pickareaname,
       r.pickorder,
       r.groupid pickgroupid, --下架小组ID
       x.groupname pickgroupname,
       a.pickflowid,
       s.pickflowno,
       s.pickflowname,
       s.wcsflag,
       s.influxflag,
       a.goodsstatusid,
       g.goodsstatus,
       g.quantitystatus,
       a.realqty,
       a.goodsqty,
       a.ingoodsqty,
       a.outgoodsqty,
       a.wholeqty,
       a.scatterqty,
       a.printline,
       a.printno,
       a.keepdate,
       a.keepmanid,
       h.employeename keepmanname,
       a.otherid,
       a.packingflag,
       a.rfflag,
       a.rffindate,
       a.rfmanid,
       p.tradepackname,
       i.employeename rfmanname,
       a.rfmanid2,
       v.employeename rfman2name,
       a.printflag,
       a.printmanid,
       j.employeename printmanname,
       a.printdate,
       a.retreceptflag,
       nvl(a.checkstatus, 0) checkstatus,
       nvl(a.usestatus, 0) usestatus,
       --a.checkmanid,
       --a.checkman2id,
       decode(a.comefrom, 1, t4.inputmanid, null) checkmanid, --来源类型是入库的才显示验收人1id xyue 2019-01-03,验收员A为录入人id
       decode(a.comefrom, 1, t4.checkmanid2, null) checkman2id, --来源类型是入库的才显示验收人2id xyue 2018-08-30
       decode(a.comefrom, 1, t4.inputman, null) checkman1, --来源类型是入库的才显示验收人1 xyue 2019-01-03,验收员A为录入人
       decode(a.comefrom, 1, t4.checkman2, null) checkman2, --来源类型是入库的才显示验收人2 xyue 2018-08-30
       k.employeename checkmanname,
       y.employeename checkman2name,
       p.goodsownid,
       decode(a.goodsownerid,9126,p.barcode,p.goodsno) as goodsno,--9126货主合富取货主货品条形码 2024-09-14
       a.credate,
       a.memo,
       a.operationtype,
       a.GOODSOWNERID,
       o.goodsownername,
       a.companyid,
       q.companyname,
       a.containerid,
       t.containerno,
       u.pickseq,
       f.innerseq,
       Null POSWAIQTY,
       nvl(p.ecodeflag,0) ecodeflag,
       p.goodsengname,
       nvl(a.downstatus, 0) downstatus,
       aa.salerid,
       aa.salername,
       (select to_char(wm_concat(t3.boxcode))
          from wms_turnbox_to_box_rel t1, wms_box_dtl t2, wms_box_doc_v t3
         where a.inoutid = t1.inoutid
           and t1.boxdtlid = t2.dtlid
           and t2.docid = t3.docid) boxcode,
       (select to_char(wm_concat(t3.boxman))
          from wms_turnbox_to_box_rel t1, wms_box_dtl t2, wms_box_doc_v t3
         where a.inoutid = t1.inoutid
           and t1.boxdtlid = t2.dtlid
           and t2.docid = t3.docid) boxman,
       (select to_char(wm_concat(t3.boxmanid))
          from wms_turnbox_to_box_rel t1, wms_box_dtl t2, wms_box_doc_v t3
         where a.inoutid = t1.inoutid
           and t1.boxdtlid = t2.dtlid
           and t2.docid = t3.docid) boxmanid,
       (select to_char(wm_concat(to_char(t3.credate, 'yyyy-mm-dd')))
          from wms_turnbox_to_box_rel t1, wms_box_dtl t2, wms_box_doc_v t3
         where a.inoutid = t1.inoutid
           and t1.boxdtlid = t2.dtlid
           and t2.docid = t3.docid) boxcredate,
       a.wholeshipposid,
       a.shipposflag,
       a.checkedqty,
       e.mah, --add by xyue 2019-12-05 上市许可持有人
       e.printexpireflag, --add by llq 2020-12-31 打印失效期标志
       (select x.wavedtlid
          from wms_wave_goods_dtl x
         where x.wavegoodsdtlid = a.sourceid) wavedtlid,
       p.udi_flag
  from wms_st_io_doc        a,
       tpl_warehouse        b,
       tpl_pub_goods        c,
       tpl_pub_goods_packs  d,
       wms_goods_lot        e,
       wms_pos_def          f,
       wms_goodsstatus      g,
       pub_employee         h,
       pub_employee         i,
       pub_employee         j,
       tpl_pub_company      l,
       wms_st_area_def      m,
       wms_st_section_def   n,
       tpl_goods            p,
       tpl_goodsowner       o,
       tpl_go_company       q,
       wms_pickarea         r,
       wms_pickflow         s,
       wms_container_def    t,
       wms_pickarea_pos_def u,
       pub_employee         v,
       wms_group_def        w,
       wms_group_def        x,
       pub_employee         k,
       pub_employee         y,
       wms_out_order        aa,
       wms_out_order_dtl    cc,
       wms_wave_goods_dtl   bb,
       wms_receive_dtl_v    t4
 where a.warehid = b.warehid(+)
   and a.goodsid = c.goodsid(+)
   and c.factid = l.companyid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.lotid = e.lotid(+)
   and a.posid = f.posid(+)
   and a.areaid = m.areaid(+)
   and a.sectionid = n.sectionid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.keepmanid = h.employeeid(+)
   and a.rfmanid = i.employeeid(+)
   and a.printmanid = j.employeeid(+)
   and a.ownergoodsid = p.ownergoodsid(+)
   and a.goodsownerid = o.goodsownerid(+)
   and a.companyid = q.companyid(+)
   and a.pickareaid = r.pickareaid(+)
   and a.pickflowid = s.pickflowid(+)
   and a.containerid = t.containerid(+)
   and a.posid = u.posid(+)
   and a.rfmanid2 = v.employeeid(+)
   and n.groupid = w.groupid(+)
   and r.groupid = x.groupid(+)
   and a.checkmanid = k.employeeid(+)
   and a.checkman2id = y.employeeid(+)
   and a.sourceid = bb.wavegoodsdtlid(+)
   and a.goodsid = bb.goodsid(+)
   and bb.wavegoodsdtlid = cc.wavegoodsdtlid(+)
   and cc.outid = aa.outid(+)
   and a.sourceid = t4.receiveid(+)
"
"WMS_ST_IO_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_IO_DOC_V"" (""INOUTID"", ""TASKID"", ""BOXDOCID"", ""INOUTFLAG"", ""COMEFROM"", ""SOURCEID"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTORYNAME"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""POSID"", ""POSNO"", ""POSNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""INGROUPID"", ""INGROUPNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""AREAFLAG"", ""AREATYPE"", ""PICKAREAID"", ""PICKAREANAME"", ""PICKORDER"", ""PICKGROUPID"", ""PICKAREANO"", ""PICKAREATYPE"", ""PICKGROUPNAME"", ""PICKFLOWID"", ""PICKFLOWNO"", ""PICKFLOWNAME"", ""WCSFLAG"", ""INFLUXFLAG"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""REALQTY"", ""GOODSQTY"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""PRINTLINE"", ""PRINTNO"", ""KEEPDATE"", ""KEEPMANID"", ""KEEPMANNAME"", ""OTHERID"", ""PACKINGFLAG"", ""RFFLAG"", ""RFFINDATE"", ""RFMANID"", ""TRADEPACKNAME"", ""RFMANNAME"", ""RFMANID2"", ""RFMAN2NAME"", ""PRINTFLAG"", ""PRINTMANID"", ""PRINTMANNAME"", ""PRINTDATE"", ""RETRECEPTFLAG"", ""CHECKSTATUS"", ""USESTATUS"", ""CHECKMANID"", ""CHECKMAN2ID"", ""CHECKMANNAME"", ""CHECKMAN2NAME"", ""GOODSOWNID"", ""GOODSNO"", ""CREDATE"", ""MEMO"", ""OPERATIONTYPE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""CONTAINERID"", ""CONTAINERNO"", ""PICKSEQ"", ""INNERSEQ"", ""POSWAIQTY"", ""ECODEFLAG"", ""GOODSENGNAME"", ""DOWNSTATUS"", ""SALERID"", ""SALERNAME"", ""PRINT2FLAG"", ""PRINT2MANID"", ""PRINT2MANNAME"", ""PRINT2DATE"", ""STARTBOXNUM"", ""TOTALWHOLEPACK"", ""PRINTMOTHED"", ""INCEPTADDR"", ""TASKDTLID"", ""WHOLEOUTFLAG"", ""CHECKEDQTY"", ""WAVEDTLID"", ""INVOICENO"", ""SENDPOS"", ""MAH"", ""IWCS_CASE_NBR"") AS 
  select a.inoutid,
       --aa.srcexpno,--货主原始出库订单号
       --bb.srcexpdtlno, -- 货主原始出库细单号
       a.taskid,
       a.boxdocid,
       a.inoutflag,
       a.comefrom,
       a.sourceid,
       a.warehid,
       b.warehname,
       a.ownergoodsid,
       a.goodsid,
       p.goodsname,
       p.goodstype,
       p.prodarea,
       c.factid,
       p.factname factoryname,
       a.goodspackid,
       d.packname,
       d.packsize,
       a.batchno,
       a.lotid,
       e.lotno,
       e.proddate,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,
       e.approvedocno,
       a.posid,
       f.posno,
       f.posname,
       a.sectionid,
       n.sectionno,
       n.sectionname,
       n.groupid ingroupid,--上架小组ID
       w.groupname ingroupname,
       a.areaid,
       m.areano,
       m.areaname,
       m.areaflag,
       m.areatype,
       a.pickareaid,
       r.pickareaname,
       r.pickorder,
       r.groupid pickgroupid, --下架小组ID
       r.pickareano, -- add by gzq
       r.pickareatype,-- add by gzq
       x.groupname pickgroupname,
       a.pickflowid,
       s.pickflowno,
       s.pickflowname,
       s.wcsflag,
       s.influxflag,
       a.goodsstatusid,
       g.goodsstatus,
       g.quantitystatus,
       a.realqty,
       a.goodsqty,
       a.ingoodsqty,
       a.outgoodsqty,
       a.wholeqty,
       a.scatterqty,
       a.printline,
       a.printno,
       a.keepdate,
       a.keepmanid,
       h.employeename keepmanname,
       a.otherid,
       a.packingflag,
       a.rfflag,
       a.rffindate,
       a.rfmanid,
       p.tradepackname,
       i.employeename rfmanname,
       a.rfmanid2,
       v.employeename rfman2name,
       a.printflag,
       a.printmanid,
       j.employeename printmanname,
       a.printdate,
       a.retreceptflag,
       nvl(a.checkstatus,0)checkstatus,
       nvl(a.usestatus, 0) usestatus,
       a.checkmanid,
       a.checkman2id,
       k.employeename checkmanname,
       y.employeename checkman2name,
       p.goodsownid,
       p.goodsno,
       a.credate,
       a.memo,
       a.operationtype,
       a.GOODSOWNERID,
       o.goodsownername,
       a.companyid,
       --decode(nvl(t2.sendpos,''),'', q.companyname ,t2.sendpos) companyname,
       q.companyname,
       a.containerid,
       t.containerno,
       u.pickseq,
       f.innerseq,
       Null POSWAIQTY,
       p.ecodeflag,
       p.goodsengname,
       nvl(a.downstatus,0) downstatus,
       aa.salerid,
       aa.salername,
       nvl(a.print2flag,0) print2flag,
       a.print2manid,
       p1.employeename print2manname,
       a.print2date,
       a.startboxnum,
       a.totalwholepack,
       a.printmothed,
       t2.inceptaddr,
       a.taskdtlid,
       a.wholeoutflag,
       a.checkedqty,
       --aa.wavedtlid,
       cc.wavedtlid,--add by xyue 2017-05-03
       bb.invoiceno, --发票号码，xyue 2014-05-03
       t2.sendpos,
       e.mah, --add by xyue 2019-12-05
       a.iwcs_case_nbr-- add by xyue IWCS箱号
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_pub_goods       c,
       tpl_pub_goods_packs d,
       wms_goods_lot       e,
       wms_pos_def         f,
       wms_goodsstatus     g,
       pub_employee        h,
       pub_employee        i,
       pub_employee        j,
       tpl_pub_company     l,
       wms_st_area_def     m,
       wms_st_section_def  n,
       tpl_goods           p,
       tpl_goodsowner      o,
       tpl_go_company      q,
       wms_pickarea        r,
       wms_pickflow        s,
       wms_container_def   t,
       wms_pickarea_pos_def u,
       pub_employee v,
       wms_group_def w,
       wms_group_def x,
       pub_employee k,
       pub_employee y,
       wms_out_order aa,
       wms_out_order_dtl bb,
       --wms_out_order_lot_dtl cc,-- add by xyue 2016-05-18
       wms_wave_goods_dtl cc, --add by xyue 2017-05-03
       wms_transport_address t2,
       pub_employee p1
 where a.warehid = b.warehid(+)
   and a.goodsid = c.goodsid(+)
   and c.factid = l.companyid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.lotid = e.lotid(+)
   and a.posid = f.posid(+)
   and a.areaid = m.areaid(+)
   and a.sectionid = n.sectionid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.keepmanid = h.employeeid(+)
   and a.rfmanid = i.employeeid(+)
   and a.printmanid = j.employeeid(+)
   and a.ownergoodsid = p.ownergoodsid(+)
   and a.goodsownerid = o.goodsownerid(+)
   and a.companyid = q.companyid(+)
   and a.pickareaid = r.pickareaid(+)
   and a.pickflowid = s.pickflowid(+)
   and a.containerid = t.containerid(+)
   and a.posid = u.posid(+)
   And a.rfmanid2 = v.employeeid(+)
   AND n.groupid = w.groupid(+)
   AND r.groupid = x.groupid(+)
   AND a.checkmanid = k.employeeid(+)
   AND a.checkman2id = y.employeeid(+)
   AND a.sourceid = bb.wavegoodsdtlid(+)
   and bb.outid  = aa.outid(+)
   and aa.transid = t2.transid(+)
   AND a.print2manid = p1.employeeid(+)
   and a.sourceid = cc.wavegoodsdtlid(+)
"
"WMS_ST_IO_DOC_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_IO_DOC_V1"" (""INOUTID"", ""SRCEXPNO"", ""SRCEXPDTLNO"", ""TASKID"", ""BOXDOCID"", ""INOUTFLAG"", ""COMEFROM"", ""SOURCEID"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTORYNAME"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""POSID"", ""POSNO"", ""POSNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""INGROUPID"", ""INGROUPNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""AREAFLAG"", ""AREATYPE"", ""PICKAREAID"", ""PICKAREANAME"", ""PICKORDER"", ""PICKGROUPID"", ""PICKAREANO"", ""PICKAREATYPE"", ""PICKGROUPNAME"", ""PICKFLOWID"", ""PICKFLOWNO"", ""PICKFLOWNAME"", ""WCSFLAG"", ""INFLUXFLAG"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""REALQTY"", ""GOODSQTY"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""PRINTLINE"", ""PRINTNO"", ""KEEPDATE"", ""KEEPMANID"", ""KEEPMANNAME"", ""OTHERID"", ""PACKINGFLAG"", ""RFFLAG"", ""RFFINDATE"", ""RFMANID"", ""TRADEPACKNAME"", ""RFMANNAME"", ""RFMANID2"", ""RFMAN2NAME"", ""PRINTFLAG"", ""PRINTMANID"", ""PRINTMANNAME"", ""PRINTDATE"", ""RETRECEPTFLAG"", ""CHECKSTATUS"", ""USESTATUS"", ""CHECKMANID"", ""CHECKMAN2ID"", ""CHECKMANNAME"", ""CHECKMAN2NAME"", ""GOODSOWNID"", ""GOODSNO"", ""CREDATE"", ""MEMO"", ""OPERATIONTYPE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""CONTAINERID"", ""CONTAINERNO"", ""PICKSEQ"", ""INNERSEQ"", ""POSWAIQTY"", ""ECODEFLAG"", ""GOODSENGNAME"", ""DOWNSTATUS"", ""SALERID"", ""SALERNAME"", ""PRINT2FLAG"", ""PRINT2MANID"", ""PRINT2MANNAME"", ""PRINT2DATE"", ""STARTBOXNUM"", ""TOTALWHOLEPACK"", ""PRINTMOTHED"", ""INCEPTADDR"", ""TASKDTLID"", ""WHOLEOUTFLAG"", ""CHECKEDQTY"", ""WAVEDTLID"", ""INVOICENO"", ""SENDPOS"") AS 
  select a.inoutid,
       aa.srcexpno,--货主原始出库订单号
       bb.srcexpdtlno, -- 货主原始出库细单号
       a.taskid,
       a.boxdocid,
       a.inoutflag,
       a.comefrom,
       a.sourceid,
       a.warehid,
       b.warehname,
       a.ownergoodsid,
       a.goodsid,
       c.goodsname,
       c.goodstype,
       c.prodarea,
       c.factid,
       l.companyname factoryname,
       a.goodspackid,
       d.packname,
       d.packsize,
       a.batchno,
       a.lotid,
       e.lotno,
       e.proddate,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,
       e.approvedocno,
       a.posid,
       f.posno,
       f.posname,
       a.sectionid,
       n.sectionno,
       n.sectionname,
       n.groupid ingroupid,--上架小组ID
       w.groupname ingroupname,
       a.areaid,
       m.areano,
       m.areaname,
       m.areaflag,
       m.areatype,
       a.pickareaid,
       r.pickareaname,
       r.pickorder,
       r.groupid pickgroupid, --下架小组ID
       r.pickareano, -- add by gzq
       r.pickareatype,-- add by gzq
       x.groupname pickgroupname,
       a.pickflowid,
       s.pickflowno,
       s.pickflowname,
       s.wcsflag,
       s.influxflag,
       a.goodsstatusid,
       g.goodsstatus,
       g.quantitystatus,
       a.realqty,
       a.goodsqty,
       a.ingoodsqty,
       a.outgoodsqty,
       a.wholeqty,
       a.scatterqty,
       a.printline,
       a.printno,
       a.keepdate,
       a.keepmanid,
       h.employeename keepmanname,
       a.otherid,
       a.packingflag,
       a.rfflag,
       a.rffindate,
       a.rfmanid,
       p.tradepackname,
       i.employeename rfmanname,
       a.rfmanid2,
       v.employeename rfman2name,
       a.printflag,
       a.printmanid,
       j.employeename printmanname,
       a.printdate,
       a.retreceptflag,
       nvl(a.checkstatus,0)checkstatus,
       nvl(a.usestatus, 0) usestatus,
       a.checkmanid,
       a.checkman2id,
       k.employeename checkmanname,
       y.employeename checkman2name,
       p.goodsownid,
       p.goodsno,
       a.credate,
       a.memo,
       a.operationtype,
       a.GOODSOWNERID,
       o.goodsownername,
       a.companyid,
       --decode(nvl(t2.sendpos,''),'', q.companyname ,t2.sendpos) companyname,
       q.companyname,
       a.containerid,
       t.containerno,
       u.pickseq,
       f.innerseq,
       Null POSWAIQTY,
       p.ecodeflag,
       p.goodsengname,
       nvl(a.downstatus,0) downstatus,
       aa.salerid,
       aa.salername,
       nvl(a.print2flag,0) print2flag,
       a.print2manid,
       p1.employeename print2manname,
       a.print2date,
       a.startboxnum,
       a.totalwholepack,
       a.printmothed,
       t2.inceptaddr,
       a.taskdtlid,
       a.wholeoutflag,
       a.checkedqty,
       aa.wavedtlid,
       bb.invoiceno, --发票号码，xyue 2014-05-03
       t2.sendpos

  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_pub_goods       c,
       tpl_pub_goods_packs d,
       wms_goods_lot       e,
       wms_pos_def         f,
       wms_goodsstatus     g,
       pub_employee        h,
       pub_employee        i,
       pub_employee        j,
       tpl_pub_company     l,
       wms_st_area_def     m,
       wms_st_section_def  n,
       tpl_goods           p,
       tpl_goodsowner      o,
       tpl_go_company      q,
       wms_pickarea        r,
       wms_pickflow        s,
       wms_container_def   t,
       wms_pickarea_pos_def u,
       pub_employee v,
       wms_group_def w,
       wms_group_def x,
       pub_employee k,
       pub_employee y,
       wms_out_order aa,
       wms_out_order_dtl bb,
       wms_out_order_lot_dtl cc,-- add by xyue 2016-05-18
       wms_transport_address t2,
       pub_employee p1
 where a.warehid = b.warehid(+)
   and a.goodsid = c.goodsid(+)
   and c.factid = l.companyid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.lotid = e.lotid(+)
   and a.posid = f.posid(+)
   and a.areaid = m.areaid(+)
   and a.sectionid = n.sectionid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.keepmanid = h.employeeid(+)
   and a.rfmanid = i.employeeid(+)
   and a.printmanid = j.employeeid(+)
   and a.ownergoodsid = p.ownergoodsid(+)
   and a.goodsownerid = o.goodsownerid(+)
   and a.companyid = q.companyid(+)
   and a.pickareaid = r.pickareaid(+)
   and a.pickflowid = s.pickflowid(+)
   and a.containerid = t.containerid(+)
   and a.posid = u.posid(+)
   And a.rfmanid2 = v.employeeid(+)
   AND n.groupid = w.groupid(+)
   AND r.groupid = x.groupid(+)
   AND a.checkmanid = k.employeeid(+)
   AND a.checkman2id = y.employeeid(+)
   AND a.sourceid = cc.wavegoodsdtlid(+) -- change by xyue 2016-05-18
   and cc.outdtlid = bb.outdtlid(+) --add by xyue 2016-05-18
   and bb.outid  = aa.outid(+)
   and aa.transid = t2.transid(+)
   AND a.print2manid = p1.employeeid(+)
"
"WMS_ST_IO_DOC_V20240402","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_IO_DOC_V20240402"" (""INOUTID"", ""TASKID"", ""BOXDOCID"", ""INOUTFLAG"", ""COMEFROM"", ""SOURCEID"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTORYNAME"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""POSID"", ""POSNO"", ""POSNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""INGROUPID"", ""INGROUPNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""AREAFLAG"", ""AREATYPE"", ""PICKAREAID"", ""PICKAREANAME"", ""PICKORDER"", ""PICKGROUPID"", ""PICKAREANO"", ""PICKAREATYPE"", ""PICKGROUPNAME"", ""PICKFLOWID"", ""PICKFLOWNO"", ""PICKFLOWNAME"", ""WCSFLAG"", ""INFLUXFLAG"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""REALQTY"", ""GOODSQTY"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""PRINTLINE"", ""PRINTNO"", ""KEEPDATE"", ""KEEPMANID"", ""KEEPMANNAME"", ""OTHERID"", ""PACKINGFLAG"", ""RFFLAG"", ""RFFINDATE"", ""RFMANID"", ""TRADEPACKNAME"", ""RFMANNAME"", ""RFMANID2"", ""RFMAN2NAME"", ""PRINTFLAG"", ""PRINTMANID"", ""PRINTMANNAME"", ""PRINTDATE"", ""RETRECEPTFLAG"", ""CHECKSTATUS"", ""USESTATUS"", ""CHECKMANID"", ""CHECKMAN2ID"", ""CHECKMANNAME"", ""CHECKMAN2NAME"", ""GOODSOWNID"", ""GOODSNO"", ""CREDATE"", ""MEMO"", ""OPERATIONTYPE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""CONTAINERID"", ""CONTAINERNO"", ""PICKSEQ"", ""INNERSEQ"", ""POSWAIQTY"", ""ECODEFLAG"", ""GOODSENGNAME"", ""DOWNSTATUS"", ""SALERID"", ""SALERNAME"", ""PRINT2FLAG"", ""PRINT2MANID"", ""PRINT2MANNAME"", ""PRINT2DATE"", ""STARTBOXNUM"", ""TOTALWHOLEPACK"", ""PRINTMOTHED"", ""INCEPTADDR"", ""TASKDTLID"", ""WHOLEOUTFLAG"", ""CHECKEDQTY"", ""WAVEDTLID"", ""INVOICENO"", ""SENDPOS"", ""MAH"", ""IWCS_CASE_NBR"") AS 
  select a.inoutid,
       a.taskid,
       a.boxdocid,
       a.inoutflag,
       a.comefrom,
       a.sourceid,
       a.warehid,
       b.warehname,
       a.ownergoodsid,
       a.goodsid,
       p.goodsname,
       p.goodstype,
       p.prodarea,
       c.factid,
       p.factname factoryname,
       a.goodspackid,
       d.packname,
       d.packsize,
       a.batchno,
       a.lotid,
       e.lotno,
       e.proddate,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,
       e.approvedocno,
       a.posid,
       f.posno,
       f.posname,
       a.sectionid,
       n.sectionno,
       n.sectionname,
       n.groupid ingroupid, --上架小组ID
       w.groupname ingroupname,
       a.areaid,
       m.areano,
       m.areaname,
       m.areaflag,
       m.areatype,
       a.pickareaid,
       r.pickareaname,
       r.pickorder,
       r.groupid pickgroupid, --下架小组ID
       r.pickareano, -- add by gzq
       r.pickareatype, -- add by gzq
       x.groupname pickgroupname,
       a.pickflowid,
       s.pickflowno,
       s.pickflowname,
       s.wcsflag,
       s.influxflag,
       a.goodsstatusid,
       g.goodsstatus,
       g.quantitystatus,
       a.realqty,
       a.goodsqty,
       a.ingoodsqty,
       a.outgoodsqty,
       a.wholeqty,
       a.scatterqty,
       a.printline,
       a.printno,
       a.keepdate,
       a.keepmanid,
       h.employeename keepmanname,
       a.otherid,
       a.packingflag,
       a.rfflag,
       a.rffindate,
       a.rfmanid,
       p.tradepackname,
       i.employeename rfmanname,
       a.rfmanid2,
       v.employeename rfman2name,
       a.printflag,
       a.printmanid,
       j.employeename printmanname,
       a.printdate,
       a.retreceptflag,
       nvl(a.checkstatus, 0) checkstatus,
       nvl(a.usestatus, 0) usestatus,
       a.checkmanid,
       a.checkman2id,
       k.employeename checkmanname,
       y.employeename checkman2name,
       p.goodsownid,
       p.goodsno,
       a.credate,
       a.memo,
       a.operationtype,
       a.GOODSOWNERID,
       o.goodsownername,
       a.companyid,
       q.companyname,
       a.containerid,
       t.containerno,
       u.pickseq,
       f.innerseq,
       Null POSWAIQTY,
       p.ecodeflag,
       p.goodsengname,
       nvl(a.downstatus, 0) downstatus,
       (select aa.salerid
          from wms_out_order         aa,
               wms_out_order_dtl     bb,
               wms_out_order_lot_dtl cc
         where aa.outid = bb.outid
           and bb.outdtlid = cc.outdtlid
           and cc.wavegoodsdtlid = a.sourceid
           and a.comefrom in (2, 3)
           --and rownum=1
           ) as salerid,
       (select aa.salername
          from wms_out_order         aa,
               wms_out_order_dtl     bb,
               wms_out_order_lot_dtl cc
         where aa.outid = bb.outid
           and bb.outdtlid = cc.outdtlid
           and cc.wavegoodsdtlid = a.sourceid
           and a.comefrom in (2, 3)
           --and rownum=1
           ) as salername,
       nvl(a.print2flag, 0) print2flag,
       a.print2manid,
       p1.employeename print2manname,
       a.print2date,
       a.startboxnum,
       a.totalwholepack,
       a.printmothed,
       (select dd.inceptaddr
          from wms_out_order         aa,
               wms_out_order_dtl     bb,
               wms_out_order_lot_dtl cc,
               wms_transport_address dd
         where aa.outid = bb.outid
           and bb.outdtlid = cc.outdtlid
           and cc.wavegoodsdtlid = a.sourceid
           and a.comefrom in (2, 3)
           and aa.transid = dd.transid
           --and rownum=1
           ) as inceptaddr,
       a.taskdtlid,
       a.wholeoutflag,
       a.checkedqty,
       (select aa.wavedtlid
          from wms_out_order         aa,
               wms_out_order_dtl     bb,
               wms_out_order_lot_dtl cc
         where aa.outid = bb.outid
           and bb.outdtlid = cc.outdtlid
           and cc.wavegoodsdtlid = a.sourceid
           and a.comefrom in (2, 3)
           --and rownum=1
           ) as wavedtlid, --add by xyue 2017-05-03
       (select bb.invoiceno
          from wms_out_order         aa,
               wms_out_order_dtl     bb,
               wms_out_order_lot_dtl cc
         where aa.outid = bb.outid
           and bb.outdtlid = cc.outdtlid
           and cc.wavegoodsdtlid = a.sourceid
           and a.comefrom in (2, 3)
           --and rownum=1
           ) as invoiceno, --发票号码，xyue 2014-05-03
       (select dd.sendpos
          from wms_out_order         aa,
               wms_out_order_dtl     bb,
               wms_out_order_lot_dtl cc,
               wms_transport_address dd
         where aa.outid = bb.outid
           and bb.outdtlid = cc.outdtlid
           and cc.wavegoodsdtlid = a.sourceid
           and a.comefrom in (2, 3)
           and aa.transid = dd.transid
           --and rownum=1
           ) as sendpos,
       e.mah, --add by xyue 2019-12-05
       a.iwcs_case_nbr -- add by xyue IWCS箱号
  from wms_st_io_doc        a,
       tpl_warehouse        b,
       tpl_pub_goods        c,
       tpl_pub_goods_packs  d,
       wms_goods_lot        e,
       wms_pos_def          f,
       wms_goodsstatus      g,
       pub_employee         h,
       pub_employee         i,
       pub_employee         j,
       tpl_pub_company      l,
       wms_st_area_def      m,
       wms_st_section_def   n,
       tpl_goods            p,
       tpl_goodsowner       o,
       tpl_go_company       q,
       wms_pickarea         r,
       wms_pickflow         s,
       wms_container_def    t,
       wms_pickarea_pos_def u,
       pub_employee         v,
       wms_group_def        w,
       wms_group_def        x,
       pub_employee         k,
       pub_employee         y,
       pub_employee         p1
 where a.warehid = b.warehid(+)
   and a.goodsid = c.goodsid(+)
   and c.factid = l.companyid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.lotid = e.lotid(+)
   and a.posid = f.posid(+)
   and a.areaid = m.areaid(+)
   and a.sectionid = n.sectionid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.keepmanid = h.employeeid(+)
   and a.rfmanid = i.employeeid(+)
   and a.printmanid = j.employeeid(+)
   and a.ownergoodsid = p.ownergoodsid(+)
   and a.goodsownerid = o.goodsownerid(+)
   and a.companyid = q.companyid(+)
   and a.pickareaid = r.pickareaid(+)
   and a.pickflowid = s.pickflowid(+)
   and a.containerid = t.containerid(+)
   and a.posid = u.posid(+)
   and a.rfmanid2 = v.employeeid(+)
   and n.groupid = w.groupid(+)
   and r.groupid = x.groupid(+)
   and a.checkmanid = k.employeeid(+)
   and a.checkman2id = y.employeeid(+)
   and a.print2manid = p1.employeeid(+)
"
"WMS_ST_IO_DOC_V_240402_1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_IO_DOC_V_240402_1"" (""INOUTID"", ""TASKID"", ""BOXDOCID"", ""INOUTFLAG"", ""COMEFROM"", ""SOURCEID"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTORYNAME"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""POSID"", ""POSNO"", ""POSNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""INGROUPID"", ""INGROUPNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""AREAFLAG"", ""AREATYPE"", ""PICKAREAID"", ""PICKAREANAME"", ""PICKORDER"", ""PICKGROUPID"", ""PICKAREANO"", ""PICKAREATYPE"", ""PICKGROUPNAME"", ""PICKFLOWID"", ""PICKFLOWNO"", ""PICKFLOWNAME"", ""WCSFLAG"", ""INFLUXFLAG"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""REALQTY"", ""GOODSQTY"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""PRINTLINE"", ""PRINTNO"", ""KEEPDATE"", ""KEEPMANID"", ""KEEPMANNAME"", ""OTHERID"", ""PACKINGFLAG"", ""RFFLAG"", ""RFFINDATE"", ""RFMANID"", ""TRADEPACKNAME"", ""RFMANNAME"", ""RFMANID2"", ""RFMAN2NAME"", ""PRINTFLAG"", ""PRINTMANID"", ""PRINTMANNAME"", ""PRINTDATE"", ""RETRECEPTFLAG"", ""CHECKSTATUS"", ""USESTATUS"", ""CHECKMANID"", ""CHECKMAN2ID"", ""CHECKMANNAME"", ""CHECKMAN2NAME"", ""GOODSOWNID"", ""GOODSNO"", ""CREDATE"", ""MEMO"", ""OPERATIONTYPE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""CONTAINERID"", ""CONTAINERNO"", ""PICKSEQ"", ""INNERSEQ"", ""POSWAIQTY"", ""ECODEFLAG"", ""GOODSENGNAME"", ""DOWNSTATUS"", ""SALERID"", ""SALERNAME"", ""PRINT2FLAG"", ""PRINT2MANID"", ""PRINT2MANNAME"", ""PRINT2DATE"", ""STARTBOXNUM"", ""TOTALWHOLEPACK"", ""PRINTMOTHED"", ""INCEPTADDR"", ""TASKDTLID"", ""WHOLEOUTFLAG"", ""CHECKEDQTY"", ""WAVEDTLID"", ""INVOICENO"", ""SENDPOS"", ""MAH"", ""IWCS_CASE_NBR"") AS 
  select a.inoutid,
       --aa.srcexpno,--货主原始出库订单号
       --bb.srcexpdtlno, -- 货主原始出库细单号
       a.taskid,
       a.boxdocid,
       a.inoutflag,
       a.comefrom,
       a.sourceid,
       a.warehid,
       b.warehname,
       a.ownergoodsid,
       a.goodsid,
       p.goodsname,
       p.goodstype,
       p.prodarea,
       c.factid,
       p.factname factoryname,
       a.goodspackid,
       d.packname,
       d.packsize,
       a.batchno,
       a.lotid,
       e.lotno,
       e.proddate,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,
       e.approvedocno,
       a.posid,
       f.posno,
       f.posname,
       a.sectionid,
       n.sectionno,
       n.sectionname,
       n.groupid ingroupid,--上架小组ID
       w.groupname ingroupname,
       a.areaid,
       m.areano,
       m.areaname,
       m.areaflag,
       m.areatype,
       a.pickareaid,
       r.pickareaname,
       r.pickorder,
       r.groupid pickgroupid, --下架小组ID
       r.pickareano, -- add by gzq
       r.pickareatype,-- add by gzq
       x.groupname pickgroupname,
       a.pickflowid,
       s.pickflowno,
       s.pickflowname,
       s.wcsflag,
       s.influxflag,
       a.goodsstatusid,
       g.goodsstatus,
       g.quantitystatus,
       a.realqty,
       a.goodsqty,
       a.ingoodsqty,
       a.outgoodsqty,
       a.wholeqty,
       a.scatterqty,
       a.printline,
       a.printno,
       a.keepdate,
       a.keepmanid,
       h.employeename keepmanname,
       a.otherid,
       a.packingflag,
       a.rfflag,
       a.rffindate,
       a.rfmanid,
       p.tradepackname,
       i.employeename rfmanname,
       a.rfmanid2,
       v.employeename rfman2name,
       a.printflag,
       a.printmanid,
       j.employeename printmanname,
       a.printdate,
       a.retreceptflag,
       nvl(a.checkstatus,0)checkstatus,
       nvl(a.usestatus, 0) usestatus,
       a.checkmanid,
       a.checkman2id,
       k.employeename checkmanname,
       y.employeename checkman2name,
       p.goodsownid,
       p.goodsno,
       a.credate,
       a.memo,
       a.operationtype,
       a.GOODSOWNERID,
       o.goodsownername,
       a.companyid,
       --decode(nvl(t2.sendpos,''),'', q.companyname ,t2.sendpos) companyname,
       q.companyname,
       a.containerid,
       t.containerno,
       u.pickseq,
       f.innerseq,
       Null POSWAIQTY,
       p.ecodeflag,
       p.goodsengname,
       nvl(a.downstatus,0) downstatus,
       aa.salerid,
       aa.salername,
       nvl(a.print2flag,0) print2flag,
       a.print2manid,
       p1.employeename print2manname,
       a.print2date,
       a.startboxnum,
       a.totalwholepack,
       a.printmothed,
       t2.inceptaddr,
       a.taskdtlid,
       a.wholeoutflag,
       a.checkedqty,
       --aa.wavedtlid,
       cc.wavedtlid,--add by xyue 2017-05-03
       bb.invoiceno, --发票号码，xyue 2014-05-03
       t2.sendpos,
       e.mah, --add by xyue 2019-12-05
       a.iwcs_case_nbr-- add by xyue IWCS箱号
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_pub_goods       c,
       tpl_pub_goods_packs d,
       wms_goods_lot       e,
       wms_pos_def         f,
       wms_goodsstatus     g,
       pub_employee        h,
       pub_employee        i,
       pub_employee        j,
       tpl_pub_company     l,
       wms_st_area_def     m,
       wms_st_section_def  n,
       tpl_goods           p,
       tpl_goodsowner      o,
       tpl_go_company      q,
       wms_pickarea        r,
       wms_pickflow        s,
       wms_container_def   t,
       wms_pickarea_pos_def u,
       pub_employee v,
       wms_group_def w,
       wms_group_def x,
       pub_employee k,
       pub_employee y,
       wms_out_order aa,
       wms_out_order_dtl bb,
       --wms_out_order_lot_dtl cc,-- add by xyue 2016-05-18
       wms_wave_goods_dtl cc, --add by xyue 2017-05-03
       wms_transport_address t2,
       pub_employee p1
 where a.warehid = b.warehid(+)
   and a.goodsid = c.goodsid(+)
   and c.factid = l.companyid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.lotid = e.lotid(+)
   and a.posid = f.posid(+)
   and a.areaid = m.areaid(+)
   and a.sectionid = n.sectionid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.keepmanid = h.employeeid(+)
   and a.rfmanid = i.employeeid(+)
   and a.printmanid = j.employeeid(+)
   and a.ownergoodsid = p.ownergoodsid(+)
   and a.goodsownerid = o.goodsownerid(+)
   and a.companyid = q.companyid(+)
   and a.pickareaid = r.pickareaid(+)
   and a.pickflowid = s.pickflowid(+)
   and a.containerid = t.containerid(+)
   and a.posid = u.posid(+)
   And a.rfmanid2 = v.employeeid(+)
   AND n.groupid = w.groupid(+)
   AND r.groupid = x.groupid(+)
   AND a.checkmanid = k.employeeid(+)
   AND a.checkman2id = y.employeeid(+)
   AND a.sourceid = bb.wavegoodsdtlid(+)
   and bb.outid  = aa.outid(+)
   and aa.transid = t2.transid(+)
   AND a.print2manid = p1.employeeid(+)
   and a.sourceid = cc.wavegoodsdtlid(+) --add by xyue 2017-05-03
"
"WMS_ST_IO_DOC_XYUE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_IO_DOC_XYUE_V"" (""CREDATE"", ""WAREHID"", ""GOODSOWNERID"", ""WHOLEQTY"", ""SCATTERQTY"", ""COMEFROM"", ""RFFLAG"", ""GOODSSTATUSID"", ""MEMO"") AS 
  select t.credate,
       t.warehid,
       t.goodsownerid,
       t.wholeqty,
       t.scatterqty,
       t.comefrom,
       t.rfflag,
       t.goodsstatusid,
       a.memo
  from wms_st_io_doc    t,
       wms_in_order     a,
       wms_in_order_dtl b,
       wms_receive_dtl  c
 where t.comefrom = 1
   and a.inid = b.inid
   and b.indtlid = c.indtlid
   and t.sourceid = c.receiveid

union all

select t.credate,
       t.warehid,
       t.goodsownerid,
       t.wholeqty,
       t.scatterqty,
       t.comefrom,
       t.rfflag,
       t.goodsstatusid,
       a.exportmemo memo
  from wms_st_io_doc         t,
       wms_out_order         a,
       wms_out_order_dtl     b,
       wms_out_order_lot_dtl c,
       wms_wave_goods_dtl    d
 where t.comefrom in (2, 3)
   and a.outid = b.outid
   and b.outdtlid = c.outdtlid
   and c.wavegoodsdtlid = d.wavegoodsdtlid
   and t.sourceid = d.wavegoodsdtlid
"
"WMS_ST_MV_CFG_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_MV_CFG_V"" (""SEQID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""OPPOSTYPE"") AS 
  select a.seqid,
       a.goodsownerid,
       b.goodsownername,
       b.goopcode,
       a.sectionid,
       c.sectionno,
       c.sectionname,
       a.oppostype
  from WMS_ST_MV_CFG a,
       tpl_goodsowner b,
       wms_st_section_def c
 where a.goodsownerid = b.goodsownerid
   and a.sectionid = c.sectionid

 "
"WMS_ST_QTY_LST_CONSERVE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_QTY_LST_CONSERVE_V"" (""WAREHID"", ""GOODSOWNERID"", ""GOODSID"", ""LOTID"", ""GOODSPACKID"", ""OWNERGOODSID"", ""GOODSQTY"") AS 
  select a.warehid,
       a.goodsownerid,
       a.goodsid,
       a.lotid,
       a.goodspackid,
       a.ownergoodsid,
       sum(a.posqty) goodsqty
  from wms_st_qty_lst      a
 where a.goodsstatusid not in (3,10) --add by xyue 2017-12-11 不合格状态的不生成养护计划 到货不足不生成 2023-03-08
   and a.posqty<>0 --add by xyue 2017-12-11 货位库存为0的不生成养护计划;
  group by a.warehid,
       a.goodsownerid,
       a.goodsid,
       a.lotid,
       a.goodspackid,
       a.ownergoodsid
"
"WMS_ST_QTY_LST_CONSERVE_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_QTY_LST_CONSERVE_V1"" (""WAREHID"", ""GOODSOWNERID"", ""GOODSID"", ""LOTID"", ""GOODSPACKID"", ""OWNERGOODSID"", ""GOODSSTATUSID"", ""POSID"", ""POSQTY"", ""GOODSQTY"") AS 
  select a.warehid,
       a.goodsownerid,
       a.goodsid,
       a.lotid,
       a.goodspackid,
       a.ownergoodsid,
       a.goodsstatusid,
       a.posid,
       sum(a.posqty) posqty,
       sum(a.posqty) goodsqty
  from wms_st_qty_lst a
 where a.goodsstatusid not in (3,10) --add by xyue 2017-12-11 不合格状态的不生成养护计划 到后不足不生成 2023-03-08
   and a.posqty<>0 --add by xyue 2017-12-11 货位库存为0的不生成养护计划;
  group by a.warehid,
       a.goodsownerid,
       a.goodsid,
       a.lotid,
       a.goodspackid,
       a.ownergoodsid,
       a.goodsstatusid,
       a.posid
"
"WMS_ST_QTY_LST_HIS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_QTY_LST_HIS_V"" (""INVDATE"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""OWNERGOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""FACTNAME"", ""TRADEPACKNAME"", ""DRUGFORM"", ""APPROVEDOCNO"", ""LOTID"", ""LOTNO"", ""GOODSSTATUSID"", ""GOODSPACKID"", ""POSID"", ""GOODSQTY"") AS 
  select a.invdate,
       a.warehid,
       a.goodsownerid,
       b.goodsownername,
       a.goodsid,
       a.ownergoodsid,
       c.goodsownid,
       c.goodsname,
       c.goodsengname,
       c.goodstype,
       c.factname,
       c.tradepackname,
       c.drugform,
       c.approvedocno,
       a.lotid,
       d.lotno,
       a.goodsstatusid,
       a.goodspackid,
       a.posid,
       a.goodsqty
  from wms_st_qty_lst_his a,
       tpl_goodsowner     b,
       tpl_goods          c,
       wms_goods_lot      d,
       wms_goods_feature  e
 where a.goodsownerid = b.goodsownerid(+)
   and a.ownergoodsid = c.ownergoodsid
   and a.lotid = d.lotid(+)
   and a.ownergoodsid not in
       (1582655, 16011, 16013, 16016, 16017, 16019, 16021, 16028, 16042,
        16046, 16159, 17616, 1874548, 1897654, 1908626, 1924585, 1993582,
        2021746, 2035662, 2043900, 2087054, 2087139, 2152257, 2642321,
        2769480, 3044943, 3169544, 3188234, 3913645, 3913646, 4194447,
        4194448, 54873, 56325, 57003, 578807, 58070, 58071) --赠品及无成本价品种
   and a.goodsid=e.goodsid
   and e.warehid=1
   and e.goodsclass not in (10, 11, 12, 19, 22, 28, 29, 32, 36, 29, 13, 14, 15, 16, 20) --不包含冷藏、特管、中药
   and a.goodsstatusid in (1,7)--合格、业务停销
"
"WMS_ST_QTY_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_QTY_LST_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSOPCODE"", ""BARCODE"", ""GOODSPINYIN"", ""DRUGFORM"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTNAME"", ""TRADEPACKNAME"", ""LOTFACTNAME"", ""GOODSQTY"", ""BUSIQTY"", ""POSQTY"", ""POSWAITQTY"", ""TRADEINWAITQTY"", ""OUTWAITQTY"", ""OWNERGOODSID"", ""BATCHNO"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""POSID"", ""POSNO"", ""POSNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""SORTTYPE"", ""AREATYPE"", ""AREAFLAG"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSOWNID"", ""GOODSNO"", ""VARIETYDESCID"", ""VARIETYNAME"", ""VARIETYNO"", ""CONTAINERID"", ""CONTAINERNO"", ""TYPEID"", ""PCS"", ""FILEGROUPIDC"", ""GOODSCLASS"", ""SCATTERPICKRATE"", ""WHOLEPICKRATE"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""PRINTEXPIREFLAG"", ""MAH"", ""LENGTH"", ""WIDTH"", ""HEIGHT"", ""GOODSCUBAGE"", ""UDI_CODE"", ""OWNERGOODSLENGTH"", ""OWNERGOODSWIDTH"", ""OWNERGOODSHEIGHT"", ""OWNERGOODSCUBAGE"", ""OWNERPACKLENGTH"", ""OWNERPACKWIDTH"", ""OWNERPACKHEIGHT"", ""OWNERPACKCUBAGE"", ""PRODLICENSENO"") AS 
  select a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.goodsid,
       h.opcode goodsopcode,
       h.barcode,--获取的是货主货品上的EAN条形码
       f.goodspinyin,
       f.drugform,
       h.goodsname,
       h.goodsengname,
       h.goodstype,
       h.prodarea,
       f.factid,
       h.factname factname, -- xyue 2017-03-27 取货主货品信息上的厂家
       h.tradepackname, --xyue 2014-05-23 物流中心库存查询增加基本单位字段
       l.factname lotfactname,
       a.goodsqty,
       a.busiqty,
       a.posqty,
       a.poswaitqty,
       a.tradeinwaitqty,
       a.outwaitqty,
       a.ownergoodsid,
       a.batchno,
       a.goodspackid,
       i.packname,
       i.packsize,
       a.posid,
       j.posno,
       j.posname,
       j.areaid,
       j.areano,
       j.areaname,
       j.sectionid,
       j.sectionno,
       j.sectionname,
       j.sorttype,
       j.areatype,
       j.areaflag,
       a.lotid,
       l.lotno,
       decode(to_char(l.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              l.validdate) validdate,
       l.proddate,
       l.approvedocno,
       a.goodsstatusid,
       m.goodsstatus,
       m.quantitystatus,
       m.useflag,
       h.goodsownid,
       h.goodsno,
       -- h.supplyername, --change by llq 2021-1-20
       h.varietydescid,
       h.varietyname,
       h.varietyno,
       a.containerid,
       n.containerno,
       n.typeid,
       decode(i.packsize, 0, 0, round(a.goodsqty / i.packsize, 6)) pcs,
       nvl(f.filegroupid, 0) * 1 filegroupidc, -- xyue 增加货品主档图片附录ID
       o.goodsclass, --xyue 增加WMS货品分类字段 2015-10-27
       o.scatterpickrate, --add by xyue 2019-05-28
       o.wholepickrate, --add by xyue 2019-05-28
       i.goodslength,
       i.goodswidth,
       i.goodsheight,
       l.printexpireflag, --打印失效期标志 by tl@20210107
       l.mah, --add by xyue 2019-12-05 上市许可持有人
       (select t.goodslength
          from tpl_pub_goods_packs t
         where t.baseunitflag = 1
           and t.goodsid = a.goodsid) length,
       (select t.goodswidth
          from tpl_pub_goods_packs t
         where t.baseunitflag = 1
           and t.goodsid = a.goodsid) width,
       (select t.goodsheight
          from tpl_pub_goods_packs t
         where t.baseunitflag = 1
           and t.goodsid = a.goodsid) height,
       (select t.goodscubage
          from tpl_pub_goods_packs t
         where t.baseunitflag = 1
           and t.goodsid = a.goodsid) goodscubage,
       h.udi_code, --add by xyue 2022-05-09
       (select x.goodslength
          from tpl_goods_packs x
         where x.baseunitflag = 1
           and x.ownergoodsid = a.ownergoodsid) ownergoodslength,
       (select x.goodswidth
          from tpl_goods_packs x
         where x.baseunitflag = 1
           and x.ownergoodsid = a.ownergoodsid) ownergoodswidth,
       (select x.goodsheight
          from tpl_goods_packs x
         where x.baseunitflag = 1
           and x.ownergoodsid = a.ownergoodsid) ownergoodsheight,
       (select x.goodscubage
          from tpl_goods_packs x
         where x.baseunitflag = 1
           and x.ownergoodsid = a.ownergoodsid) ownergoodscubage,
       (select y.goodslength
          from tpl_goods_packs y
         where y.baseunitflag = 2
           and y.ownergoodsid = a.ownergoodsid
           and y.goodspackid = a.goodspackid) ownerpacklength,
       (select y.goodswidth
          from tpl_goods_packs y
         where y.baseunitflag = 2
           and y.ownergoodsid = a.ownergoodsid
           and y.goodspackid = a.goodspackid) ownerpackwidth,
       (select y.goodsheight
          from tpl_goods_packs y
         where y.baseunitflag = 2
           and y.ownergoodsid = a.ownergoodsid
           and y.goodspackid = a.goodspackid) ownerpackheight,
       (select y.goodscubage
          from tpl_goods_packs y
         where y.baseunitflag = 2
           and y.ownergoodsid = a.ownergoodsid
           and y.goodspackid = a.goodspackid) ownerpackcubage,
       h.prodlicenseno --生产许可证号 xyue 2024-08-16
  from wms_st_qty_lst      a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_pub_company     d,
       tpl_pub_goods       f,
       tpl_goods           h,
       tpl_pub_goods_packs i,
       wms_pos_def_v       j,
       wms_goods_lot       l,
       wms_goodsstatus     m,
       wms_container_def   n,
       wms_goods_feature   o
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.goodsid = f.goodsid
   and f.factid = d.companyid(+)
   and a.ownergoodsid = h.ownergoodsid(+)
   and a.goodspackid = i.goodspackid(+)
   and a.posid = j.posid
   and a.lotid = l.lotid(+)
   and a.goodsstatusid = m.goodsstatusid(+)
   and a.containerid = n.containerid(+)
   and a.warehid = o.warehid(+)
   and a.goodsid = o.goodsid(+)
"
"WMS_ST_SECTION_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_SECTION_DEF_V"" (""SECTIONID"", ""AREAID"", ""SECTIONNO"", ""SECTIONNAME"", ""SECTIONTYPE"", ""GROUPID"", ""USESTATUS"", ""MEMO"", ""PICKRATEFLAG"", ""GROUPNO"", ""GROUPNAME"", ""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""AREANO"", ""AREANAME"", ""AREAFLAG"", ""SORTTYPE"", ""ZX_CHANGESTATUS"", ""ZX_TOSTATUS"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""TRADEFLAG"", ""FIXGOODSFLAG"", ""FIXPOSFLAG"", ""FIXSEQUNCE"", ""ALLOWTPUP"", ""AUTOUPFLAG"", ""SCATTERPACKFLAG"", ""TRADEUPFLAG"", ""WHOLEYPRIORITY"", ""IWCS_FLAG"", ""SECTIONCLASS"") AS 
  select a.sectionid,
       a.areaid,
       a.sectionno,
       a.sectionname,
       a.sectiontype,
       a.groupid,
       a.usestatus,
       a.memo,
       a.pickrateflag,
       b.groupno,
       b.groupname,
       d.warehid,
       d.warehopcode,
       d.warehname,
       c.areano,
       c.areaname,
       c.areaflag,
       a.sorttype,
       a.zx_changestatus,
       a.zx_tostatus,
       e.goodsstatus,
       e.quantitystatus,
       a.TRADEFLAG,
       c.fixgoodsflag,
       c.fixposflag,
       a.fixsequnce,
       a.allowtpup,
       a.autoupflag,--是否自动上架
       a.scatterpackflag,--属否允许散箱出库
       a.tradeupflag,
       a.wholeypriority,--散件分区分配周转箱时优先出整件，尽量不拆箱
       a.iwcs_flag,
       a.sectionclass
  from wms_st_section_def a,
       wms_group_def      b,
       wms_st_area_def    c,
       tpl_warehouse      d,
      wms_goodsstatus    e
 where a.groupid = b.groupid(+)
   and c.warehid = d.warehid(+)
   and a.areaid = c.areaid(+)
    and a.zx_tostatus = e.goodsstatusid(+)
"
"WMS_ST_SECTION_HOV_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ST_SECTION_HOV_V"" (""SECTIONID"", ""AREAID"", ""SECTIONNO"", ""SECTIONNAME"", ""SECTIONTYPE"", ""SORTTYPE"", ""GROUPID"", ""USESTATUS"", ""MEMO"", ""PICKRATEFLAG"", ""GROUPNO"", ""GROUPNAME"", ""AREANO"", ""AREANAME"", ""AREAFLAG"", ""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""ALLOWTPUP"", ""IWCS_FLAG"") AS 
  select a.sectionid,
       a.areaid,
       a.sectionno,
       a.sectionname,
       a.sectiontype,
       a.sorttype,
       a.groupid,
       a.usestatus,
       a.memo,
       a.pickrateflag,
       b.groupno,
       b.groupname,
       c.areano,
       c.areaname,
       c.areaflag,
       d.warehid,
       d.warehopcode,
       d.warehname,
       a.allowtpup,
       nvl(a.iwcs_flag,0) iwcs_flag
  from wms_st_section_def a,
       wms_group_def      b,
       wms_st_area_def    c,
       tpl_warehouse      d
 where a.groupid = b.groupid(+)
   and a.areaid = c.areaid(+)
   and c.warehid = d.warehid(+)
"
"WMS_TASK_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_TASK_DOC_V"" (""TASKID"", ""TASKTYPE"", ""PICKFLOWID"", ""PICKFLOWNO"", ""PICKFLOWNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""SRCORDERTYPE"", ""WAVEID"", ""CONTENTS"", ""COMPANYID"", ""COMPANYNAME"", ""ORDERID"", ""CREDATE"", ""SCATTERPACKS"", ""WHOLEPACKS"", ""OPMANID"", ""EMPLOYEENAME"", ""FINISHDATE"", ""SCATTERFINPACKS"", ""WHOLEFINPACKS"", ""USESTATUS"", ""MEMO"", ""GCOMPANYID"", ""GCOMPANYNO"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.taskid,
       a.tasktype,
       a.pickflowid,
       c.pickflowno,
       c.pickflowname,
       a.sectionid,
       b.sectionno,
       b.sectionname,
       a.srcordertype,
       a.waveid,
       d.contents,
       a.companyid,
       e.companyname,
       a.orderid,
       a.credate,
       a.scatterpacks,
       a.wholepacks,
       a.opmanid,
       f.employeename,
       a.finishdate,
       a.scatterfinpacks,
       a.wholefinpacks,
       a.usestatus,
       a.memo,
       e.gcompanyid,
       e.gcompanyno,
       a.warehid,
       g.warehname,
       --a.containerid,
       --h.containerno,
       e.goodsownerid,
       k.goodsownername --by tl@191025取货主名称
  from wms_task_doc       a,
       wms_st_section_def b,
       wms_pickflow       c,
       wms_wave_doc       d,
       tpl_go_company     e,
       pub_employee       f,
       tpl_warehouse      g,
       --wms_container_def  h,
       tpl_goodsowner k
  where a.pickflowid = c.pickflowid(+)
    and a.sectionid = b.sectionid(+)
    and a.waveid = d.wavedocid(+)
    and a.companyid = e.companyid(+)
    and a.opmanid = f.employeeid(+)
    and a.warehid = g.warehid(+)
    --and a.containerid = h.containerid(+)
    and e.goodsownerid = k.goodsownerid(+)
    --and e.goodsownerid=f.goodsownerid
"
"WMS_TASK_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_TASK_DTL_V"" (""INOUTID"", ""TASKID"", ""BOXDOCID"", ""INOUTFLAG"", ""COMEFROM"", ""SOURCEID"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTORYNAME"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""POSID"", ""POSNO"", ""POSNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""AREAFLAG"", ""AREATYPE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""PRINTLINE"", ""PRINTNO"", ""KEEPDATE"", ""KEEPMANID"", ""KEEPMANNAME"", ""OTHERID"", ""RFFLAG"", ""RFFINDATE"", ""RFMANID"", ""RFMANNAME"", ""PRINTFLAG"", ""PRINTMANID"", ""PRINTMANNAME"", ""PRINTDATE"", ""RETRECEPTFLAG"", ""CHECKSTATUS"", ""USESTATUS"", ""GOODSOWNID"", ""GOODSNO"", ""PICKAREAID"", ""PICKAREANO"", ""PICKAREANAME"", ""GROUPID"", ""PICKFLOWID"", ""PICKFLOWNO"", ""PICKFLOWNAME"", ""MEMO"") AS 
  select a.inoutid,
       a.taskid,
       a.boxdocid,
       a.inoutflag,
       a.comefrom,
       a.sourceid,
       a.warehid,
       b.warehname,
       a.ownergoodsid,
       a.goodsid,
       c.goodsname,
       c.goodstype,
       c.prodarea,
       c.factid,
       l.companyname factoryname,
       a.goodspackid,
       d.packname,
       d.packsize,
       a.batchno,
       a.lotid,
       e.lotno,
       e.proddate,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,
       e.approvedocno,
       a.posid,
       f.posno,
       f.posname,
       a.sectionid,
       n.sectionno,
       n.sectionname,
       a.areaid,
       m.areano,
       m.areaname,
       m.areaflag,
       m.areatype,
       a.goodsstatusid,
       g.goodsstatus,
       g.quantitystatus,
       a.ingoodsqty,
       a.outgoodsqty,
       a.goodsqty,
       a.wholeqty,
       a.scatterqty,
       a.printline,
       a.printno,
       a.keepdate,
       a.keepmanid,
       h.employeename keepmanname,
       a.otherid,
       a.rfflag,
       a.rffindate,
       a.rfmanid,
       i.employeename rfmanname,
       decode(a.printflag,null,null,1) printflag,
       a.printmanid,
       j.employeename printmanname,
       a.printdate,
       a.retreceptflag,
       a.checkstatus,
       nvl(a.usestatus, 0) usestatus,
       p.goodsownid,
       p.goodsno,
       q.pickareaid,
       q.pickareano,
       q.pickareaname,
       q.groupid,
       r.pickflowid,
       r.pickflowno,
       r.pickflowname,
       a.memo
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_pub_goods       c,
       tpl_pub_goods_packs d,
       wms_goods_lot       e,
       wms_goodsstatus     g,
       pub_employee        h,
       pub_employee        i,
       pub_employee        j,
       tpl_pub_company     l,
       wms_pos_def         f,
       wms_st_area_def     m,
       wms_st_section_def  n,
       tpl_goods           p,
       wms_pickarea_pos_def o,
       wms_pickarea         q,
       wms_pickflow         r
 where a.warehid = b.warehid(+)
   and a.goodsid = c.goodsid(+)
   and c.factid = l.companyid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.lotid = e.lotid(+)
   and a.posid = f.posid(+)
   and a.areaid = m.areaid(+)
   and a.sectionid = n.sectionid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.keepmanid = h.employeeid(+)
   and a.rfmanid = i.employeeid(+)
   and a.printmanid = j.employeeid(+)
   and p.ownergoodsid = a.ownergoodsid
   and a.posid = o.posid(+)
   and o.pickareaid = q.pickareaid(+)
   and q.pickflowid = r.pickflowid(+)
"
"WMS_TO_YJD_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_TO_YJD_ORDER_V"" (""ORDERNO"", ""SOURCEID"", ""TRADEDATE"", ""COMEFROM"", ""ORDERTYPE"", ""CUSTOMERNO"", ""CUSTOMERNAME"", ""CUSTOMERTYPE"", ""GOODSID"", ""GOODSNO"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""FILEGROUPID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.wavedtlid as orderno,
       b.outdtlid as sourceid,
       a.credate as tradedate,
       2 as comefrom,
       3 as ordertype,
       c.gcompanyid as customerno,
       c.companyname as customername,
       1 as customertype, --默认1
       d.goodsownid as goodsid,
       d.goodsownid as goodsno,
       d.goodsname as goodsname,
       d.goodstype as goodstype,
       d.prodarea as prodarea,
       nvl(e.factname, d.factname) as factname,
       b.lotid as lotid,
       e.lotno as lotno,
       e.proddate as proddate,
       e.validdate as validdate,
       null filegroupid,
       a.goodsownerid as goodsownerid,
       f.goodsownername as goodsownername
  from wms_out_order     a,
       wms_out_order_dtl b,
       tpl_go_company    c,
       tpl_goods         d,
       wms_goods_lot     e,
       tpl_goodsowner    f
 where a.outid = b.outid
   and a.reccompanyid = c.companyid(+)
   and b.ownergoodsid = d.ownergoodsid
   and b.lotid = e.lotid(+)
   and a.goodsownerid = f.goodsownerid(+)
   and a.usestatus = 4 --已出货状态
   and a.goodsownerid <> 64 --去掉燕来福数据
   and exists (select 1
          from tpl_goodsowner x
         where x.innerflag = 1
           and a.goodsownerid = x.goodsownerid) --内部货主
   and not exists (select 1
              from wms_out_order y
             where y.wavedtlid = a.wavedtlid
               and y.goodsownerid = 4
               and y.exportmemo like '%订单%')
   and a.credate > sysdate-90
"
"WMS_TRADEREPORT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_TRADEREPORT_V"" (""AREAID"", ""AREANAME"", ""SECTIONID"", ""SECTIONNAME"", ""INOUTFLAG"", ""TASKID"", ""TASKTYPE"", ""POSNAME"", ""LOTNO"", ""GOODSQTY"", ""PACKNAME"", ""PACKSIZE"", ""TRADEID"", ""TRADEDATE"", ""OPERATIONTYPE"", ""SUBTYPE"", ""TRADEDTLID"", ""GOODSID"", ""OWNERGOODSID"", ""INOUTID"", ""COMEFROM"", ""SOURCEID"", ""GOODSPACKID"", ""LOTID"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""PICKFLOWID"", ""PICKFLOWNAME"", ""RFFLAG"", ""RFFINDATE"", ""RFMANNAME"", ""WAVEDTLID"", ""WAVEID"", ""CONTENTS"") AS 
  select c.areaid,
       m.areaname,
       c.sectionid,
       m.sectionname,
       c.inoutflag,
       d.taskid,
       d.tasktype,
       m.posname,
       l.lotno,
       c.goodsqty,
       k.packname,
       k.packsize,
       a.tradeid,
       a.tradedate,
       a.operationtype,
       a.subtype,
       b.tradedtlid,
       b.goodsid,
       b.ownergoodsid,
       c.inoutid,
       c.comefrom,
       c.sourceid,
       c.goodspackid,
       c.lotid,
       c.goodsstatusid,
       j.goodsstatus,
       d.pickflowid,
       h.pickflowname,
       c.rfflag,
       c.rffindate,
       i.employeename rfmanname,
       f.wavedtlid,
       f.waveid,
       g.contents
  from wms_trade_order     a,
       wms_trade_dtl       b,
       wms_st_io_doc       c,
       wms_task_doc        d,
       wms_wave_goods_dtl  e,
       wms_wave_dtl        f,
       wms_wave_doc        g,
       wms_pickflow        h,
       pub_employee        i,
       wms_goodsstatus     j,
       tpl_pub_goods_packs k,
       wms_goods_lot       l,
       wms_pos_def_v       m
 where a.tradeid = b.tradeid(+)
   and b.tradedtlid = c.sourceid(+)
   and c.comefrom(+) = 4
   and c.taskid = d.taskid(+)
   and a.sourceid = e.wavegoodsdtlid(+)
   and e.wavedtlid = f.wavedtlid(+)
   and f.waveid = g.wavedocid(+)
   and d.pickflowid = h.pickflowid(+)
   and c.rfmanid = i.employeeid(+)
   and c.goodsstatusid = j.goodsstatusid(+)
   and c.goodspackid = k.goodspackid(+)
   and c.lotid = l.lotid(+)
   and c.posid = m.posid(+)
   and a.operationtype = 29
 order by a.tradeid, b.tradedtlid

 "
"WMS_TRADE_DTLQRY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_TRADE_DTLQRY_V"" (""TRADEID"", ""TRADEDTLID"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""TRADEDATE"", ""USESTATUS"", ""CONFIRMMAN"", ""CONFIRMMANNAME"", ""CONFIRMDATE"", ""MEMO"", ""INPUTMANID"", ""INPUTMANNAME"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""PRODAREA"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""FROMLOTID"", ""FROMLOTNO"", ""FROMVALIDDATE"", ""FROMPRODDATE"", ""TOLOTID"", ""TOLOTNO"", ""TOVALIDDATE"", ""TOPRODDATE"", ""FROMSECTIONID"", ""FROMSECTIONNO"", ""FROMSECTIONNAME"", ""TOSECTIONID"", ""TOSECTIONNO"", ""TOSECTIONNAME"", ""FROMPOSID"", ""FROMPOSNAME"", ""TOPOSID"", ""TOPOSNAME"", ""FROMGOODSSTATUSID"", ""FROMGOODSSTATUS"", ""TOGOODSSTATUSID"", ""TOGOODSSTATUS"", ""FROMQUANSTATUS"", ""TOQUANSTATUS"") AS 
  select t.TRADEID,
       tt.tradedtlid,
       t.warehid,
       t.warehname,
       t.GOODSOWNERID,
       t.goodsownername,
       t.tradedate,
       t.usestatus,
       t.confirmman,
       t.confirmmanname,
       t.confirmdate,
       t.memo, --总单备注
       t.inputmanid,
       t.inputmanname,
       tt.goodsid,
       tt.goodsownid,
       tt.goodsname,
       tt.goodstype,
       tt.factname,
       tt.prodarea,
       tt.goodspackid,
       tt.packname,
       tt.packsize,
       tt.qty tradegoodsqty,
       tt.tradegoodspack,
       tt.fromlotid,
       tt.fromlotno,
       tt.fromvaliddate,
       tt.fromproddate,
       tt.tolotid,
       tt.tolotno,
       tt.tovaliddate,
       tt.toproddate,
       tt.fromsectionid,
       tt.fromsectionno,
       tt.fromsectionname,
       tt.tosectionid,
       tt.tosectionno,
       tt.tosectionname,
       tt.fromposid,
       tt.fromposname,
       tt.toposid,
       tt.toposname,
       tt.fromgoodsstatusid,
       tt.fromgoodsstatus,
       tt.togoodsstatusid,
       tt.togoodsstatus,
       tt.fromquanstatus,
       tt.toquanstatus

  from wms_trade_order_v t , wms_trade_dtl_v tt
 where t.TRADEID = tt.tradeid
   and t.usestatus in (3)
   and t.operationtype in (24, 31)  --业务类型
"
"WMS_TRADE_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_TRADE_DTL_V"" (""TRADEID"", ""TRADEDTLID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""PRODAREA"", ""FROMLOTID"", ""FROMLOTNO"", ""FROMVALIDDATE"", ""FROMPRODDATE"", ""TOLOTID"", ""TOLOTNO"", ""TOVALIDDATE"", ""TOPRODDATE"", ""FROMBATCHNO"", ""TOBATCHNO"", ""FROMSECTIONID"", ""FROMSECTIONNO"", ""FROMSECTIONNAME"", ""TOSECTIONID"", ""TOSECTIONNO"", ""TOSECTIONNAME"", ""FROMPOSID"", ""FROMPOSNO"", ""FROMPOSNAME"", ""TOPOSID"", ""TOPOSNO"", ""TOPOSNAME"", ""FROMGOODSSTATUSID"", ""FROMGOODSSTATUS"", ""FROMQUANSTATUS"", ""TOGOODSSTATUSID"", ""TOGOODSSTATUS"", ""TOQUANSTATUS"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""PRINTLINE"", ""PRINTNO"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""QTY"", ""PRINTFLAG"", ""SRCPROCDTLID"", ""PROCFLAG"", ""USESTATUS"", ""DTLUSESTATUS"", ""DTLMEMO"", ""GOODSOWNID"", ""DTLMEMO1"", ""MAH"", ""CONTAINERNO"", ""SOURCERECEIVEID"", ""TOGOODSPACKID"", ""TOPACKNAME"", ""TOPACKSIZE"") AS 
  select a.tradeid,
       a.tradedtlid,
       a.ownergoodsid,
       a.goodsid,
       b.opcode goodsopcode,
       b.goodsname,
       b.goodstype,
       b.factname,
       b.prodarea,
       a.fromlotid,
       d.lotno fromlotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) fromvaliddate,
       d.proddate fromproddate,
       a.tolotid,
       e.lotno tolotno,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) tovaliddate,
       e.proddate toproddate,
       a.frombatchno,
       a.tobatchno,
       a.fromsectionid,
       k.sectionno fromsectionno,
       k.sectionname fromsectionname,
       a.tosectionid,
       l.sectionno tosectionno,
       l.sectionname tosectionname,
       a.fromposid,
       f.posno fromposno,
       f.posname fromposname,
       a.toposid,
       g.posno toposno,
       g.posname toposname,
       a.fromgoodsstatusid,
       h.goodsstatus fromgoodsstatus,
       a.fromquanstatus,
       a.togoodsstatusid,
       i.goodsstatus togoodsstatus,
       a.toquanstatus,
       a.tradegoodsqty,
       a.tradegoodspack,
       a.printline,
       a.printno,
       a.goodspackid,
       j.packname,
       j.packsize,
       a.qty,
       decode(a.printflag, null, null, 1) printflag,
       a.srcprocdtlid,
       a.procflag,
       a.usestatus,
       a.usestatus dtlusestatus,
       a.dtlmemo,
       b.goodsownid,
       a.dtlmemo1, --add by xyue 2019-04-26 用于判断不合格时备注必填使用
       d.mah, --add by xyue 2019-12-05 上市许可持有人
       a.CONTAINERNO,--add by jsl 2020-06-23 容器编码
       a.sourcereceiveid,
       a.togoodspackid,
       n.packname topackname,
       n.packsize topacksize
  from wms_trade_dtl       a,
       tpl_pub_goods       c,
       wms_goods_lot       d,
       wms_goods_lot       e,
       wms_pos_def         f,
       wms_pos_def         g,
       wms_goodsstatus     h,
       wms_goodsstatus     i,
       tpl_pub_goods_packs j,
       wms_st_section_def  k,
       wms_st_section_def  l,
       tpl_goods           b,
       tpl_pub_goods_packs n
 where a.goodsid = c.goodsid
   and a.fromlotid = d.lotid(+)
   and a.tolotid = e.lotid(+)
   and a.fromposid = f.posid(+)
   and a.toposid = g.posid(+)
   and a.fromgoodsstatusid = h.goodsstatusid(+)
   and a.togoodsstatusid = i.goodsstatusid(+)
   and a.goodspackid = j.goodspackid(+)
   and a.fromsectionid = k.sectionid(+)
   and a.tosectionid = l.sectionid(+)
   and a.ownergoodsid = b.ownergoodsid(+)
   and a.togoodspackid = n.goodspackid(+)
"
"WMS_TRADE_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_TRADE_ORDER_V"" (""TRADEID"", ""WAREHID"", ""TRADEDATE"", ""OPERATIONTYPE"", ""GOODSOWNERID"", ""BILLFROM"", ""EXECUTETYPE"", ""SUBTYPE"", ""DTLLINES"", ""USESTATUS"", ""SOURCEID"", ""MEMO"", ""WAREHNAME"", ""WAREHOPCODE"", ""WAREHNO"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""CONFIRMMAN"", ""CONFIRMMANNAME"", ""CONFIRMDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""IWCS_FLAG"", ""IWCS_MSG"", ""IWCS_STATUS"", ""IWCS_DATE"", ""IWCS_MANID"", ""IWCS_MAN"", ""SOURCEINID"", ""SOURCEINOUTID"") AS 
  SELECT a.TRADEID,
       a.WAREHID,
       a.TRADEDATE,
       a.operationtype,
       a.GOODSOWNERID,
       a.billfrom,
       a.executetype,
       a.subtype,
       a.DTLLINES,
       a.usestatus,
       a.sourceid,
       decode(a.goodsownerid,
              9113,
              (select t.execmsg
                 from taide_wms2sap_kczy t
                where t.tradeid=a.tradeid),
              a.memo) memo,
       b.warehname,
       b.warehopcode,
       b.warehno,
       c.goodsownername,
       c.goopcode,
       a.confirmman,
       e.employeename confirmmanname,
       a.confirmdate,
       a.inputmanid,
       d.employeename inputmanname,
       a.iwcs_flag,
       a.iwcs_msg,
       a.iwcs_status,
       a.iwcs_date,
       a.iwcs_manid,
       f.employeename iwcs_man,
       a.sourceinid,
       a.sourceinoutid
  from wms_trade_order a,
       tpl_warehouse   b,
       tpl_goodsowner  c,
       pub_employee    d,
       pub_employee    e,
       pub_employee    f
 where a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.inputmanid = d.employeeid(+)
   and a.confirmman = e.employeeid(+)
   and a.iwcs_manid = f.employeeid(+)
"
"WMS_TRADE_POS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_TRADE_POS_V"" (""TRADEID"", ""WAREHID"", ""TRADEDATE"", ""TRADEDTLID"", ""SUBTYPE"", ""USESTATUS"", ""GOODSOWNERID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSPACKID"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""PACKNAME"", ""PACKSIZE"", ""QTY"", ""FROMSECTIONID"", ""FROMSECTIONNO"", ""FROMSECTIONNAME"", ""SORTTYPE"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""POSID"", ""POSNO"", ""GOODSQTY"", ""RFFLAG"", ""RFMANID"", ""RFMANNAME"", ""GOODSOWNERNAME"", ""RFFINDATE"") AS 
  select b.tradeid,
       a.warehid,
       a.tradedate,
       b.tradedtlid,
       a.subtype,
       a.usestatus,
       a.goodsownerid,
       b.ownergoodsid,
       b.goodsid,
       d.goodsownid,
       e.goodsname,
       e.goodstype,
       e.prodarea,
       g.lotid,
       g.lotno,
       decode(to_char(g.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              g.validdate) validdate,
       g.proddate,
       g.approvedocno,
       b.goodspackid,
       k.goodsstatusid,
       k.goodsstatus,
       k.quantitystatus,
       k.useflag,
       f.packname,
       f.packsize,
       b.qty,

       b.fromsectionid,
       c.sectionno fromsectionno,
       c.sectionname fromsectionname,
       c.sorttype,
       i.sectionid,
       j.sectionno,
       j.sectionname,
       h.posid,
       i.posno,
       h.goodsqty,
       h.rfflag,
       h.rfmanid,
       m.employeename rfmanname,
       l.goodsownername,
       h.rffindate
  from wms_trade_dtl      b,
       wms_trade_order    a,
       wms_st_section_def c,
       tpl_goods          d,
       tpl_pub_goods      e,
       tpl_pub_goods_packs f,
       wms_goods_lot       g,
       wms_goodsstatus     k,
       wms_st_io_doc      h,
       wms_pos_def        i,
       wms_st_section_def j,
       tpl_goodsowner     l,
       pub_employee       m
 where  b.tradeid =a.tradeid
   and b.fromsectionid = c.sectionid
   and b.goodsid = e.goodsid
   and b.fromlotid = g.lotid
   and a.goodsownerid = l.goodsownerid
   and b.goodspackid = f.goodspackid
   and b.fromgoodsstatusid = k.goodsstatusid
   and b.ownergoodsid = d.ownergoodsid
   and h.comefrom = 4
   and  b.tradedtlid = h.sourceid
   and h.inoutflag = 0
   and h.posid = i.posid(+)
   and h.sectionid = j.sectionid
   and a.usestatus in (2, 3)
   and h.rfmanid = m.employeeid(+)
"
"WMS_TRANSPORT_ADDRESS_TMS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_TRANSPORT_ADDRESS_TMS_V"" (""COMPANYID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""TRANSID"", ""SENDPOS"", ""INCEPTADDR"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""TOWNSHIP"", ""POINAME"", ""LONGITUDE"", ""LATITUDE"", ""CONNECTOR"", ""CONNPHONE"") AS 
  select t.gocompanyid companyid,
       t.goodsownerid,
       tt.goodsownername,
       t.transid ,
       t.sendpos ,
       t.inceptaddr,
       t.province,
       t.city,
       t.district,
       t.township,
       t.poiname,
       t.longitude,
       t.latitude,
       t.connector,
       t.connphone
  from wms_transport_address t,tpl_goodsowner tt
  where  t.goodsownerid=tt.goodsownerid(+)
"
"WMS_TRANSPORT_ADDRESS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_TRANSPORT_ADDRESS_V"" (""GOCOMPANYID"", ""GOCOMPANYNAME"", ""TRANSID"", ""INCEPTADDR"", ""GOODSOWNERID"", ""SENDPOS"", ""CONNECTOR"", ""CONNPHONE"", ""TELEFAX"", ""POSTCODE"", ""GTRANSID"", ""USESTATUS"", ""MEMO"", ""AREAID"", ""AREACODE"", ""AREANAME"", ""EQUTRANSID"", ""EQUADDR"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""ADDRESS"", ""EXPFLAG"", ""GOODSOWNERNAME"", ""POINAME"", ""LONGITUDE"", ""LATITUDE"", ""MEMO1"", ""COMPANYSTYLE"", ""YBPS"") AS 
  SELECT A.GOCOMPANYID,
       d.companyname gocompanyname,
       A.TRANSID,
       A.INCEPTADDR,
       A.GOODSOWNERID,
       A.SENDPOS,
       A.CONNECTOR,
       A.CONNPHONE,
       A.TELEFAX,
       A.POSTCODE,
       A.GTRANSID,
       A.USESTATUS,
       A.MEMO,
       a.areaid,
       c.areacode,
       c.areaname,
       A.EQUTRANSID,
       b.inceptaddr equaddr,
       a.province,
       a.city,
       a.district,
       a.address,
       a.expflag,
       e.goodsownername,
       a.poiname,
       a.longitude,
       a.latitude,
       a.memo1,
       d.companystyle, --tl@20220505判断是客户还是供应商
       a.ybps
  FROM WMS_TRANSPORT_ADDRESS A,
       WMS_TRANSPORT_ADDRESS b,
       tms_area_code         c,
       tpl_go_company        d,
       tpl_goodsowner        e
 where a.equtransid = b.transid(+)
   AND a.areaid = c.areaid(+)
   AND a.gocompanyid = d.companyid(+)
   and a.goodsownerid=e.goodsownerid(+)
"
"WMS_TRANSPORT_MODE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_TRANSPORT_MODE_V"" (""TRANSMODEID"", ""TRANSMODE"", ""TRANSNAME"", ""MEMO"", ""USESTATUS"", ""TRANSTYPEID"", ""TRANSTYPENAME"") AS 
  select a.transmodeid,
       a.transmode,
       a.transname,
       a.memo,
       a.usestatus,
       a.transtypeid,
       b.transtypename
  from wms_transport_mode a,
  Tprice_trans_type b
  where a.transtypeid=b.transtypeid(+)

 "
"WMS_TRANS_ROUTE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_TRANS_ROUTE_V"" (""ROUTENAME"", ""ROUTEID"", ""WAREHID"", ""GOCOMPANYID"", ""TRANSID"", ""INCEPTADDR"", ""GOODSOWNERID"", ""SENDPOS"", ""CONNECTOR"", ""CONNPHONE"", ""TELEFAX"", ""POSTCODE"", ""GTRANSID"", ""PROVINCE"", ""CITY"", ""USESTATUS"", ""MEMO"", ""AREACODE"", ""AREANAME"", ""EQUTRANSID"") AS 
  select c.routename,
         c.routeid,
         b.warehid,
         a.gocompanyid,
         a.transid,
         a.inceptaddr,
         a.goodsownerid,
         a.sendpos,
         a.connector,
         a.connphone,
         a.telefax,
         a.postcode,
         a.gtransid,
         a.province,
         a.city,
         a.usestatus,
         a.memo,
         a.areacode,
         a.areaname,
         a.equtransid
  from wms_transport_address a,
       tms_route_pos b,
       wms_tr_route c
 where a.transid = b.transid(+)
   and b.routeid = c.routeid(+)
"
"WMS_TRDOC_REPORT_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_TRDOC_REPORT_DTL_V"" (""CREDATE"", ""TRCOMPANYID"", ""COMPANYNAME"", ""ROUTEID"", ""ROUTENAME"", ""INTOWNFLAG"", ""WAREHID"", ""WAREHNAME"", ""TOTALDOCNUM"", ""READYDOCNUM"", ""NOREADYDOCNUM"", ""READYRATE"", ""COMPANYNUM"", ""TOTALPACKS"") AS 
  select aa.credate,
       aa.trcompanyid,
       tpl_pub_company.companyname,
       aa.routeid,
       wms_tr_route.routename,
       wms_tr_route.intownflag,
       aa.warehid,
       tpl_warehouse.warehname,
       aa.totaldocnum,
       aa.readydocnum,
       aa.totaldocnum - aa.readydocnum noreadydocnum,
       round(aa.readydocnum / totaldocnum * 100, 2) || '%' readyrate,
       aa.companynum,
       aa.totalpacks
  from tpl_warehouse,
       tpl_pub_company,
       wms_tr_route,
       (select distinct t.trcompanyid, --承运商
                        t.routeid, --线路
                        t.warehid,
                        trunc(t.CREDATE) credate,
                        count(*) totaldocnum,
                        nvl(cc.readydocnum,0)readydocnum,
                        count(distinct t.gcompanyid) companynum,
                        sum(t.totalpacks) totalpacks
          from TMS_TR_DOC_v t,
               (select count(*) readydocnum,
                       trunc(a.CREDATE) credate,
                       nvl(a.trcompanyid,0)trcompanyid,
                       nvl(a.routeid,0)routeid,
                       nvl(a.warehid,0)warehid
                  from TMS_TR_DOC a
                 where a.usestatus = 2
                 group by trunc(a.CREDATE),
                          a.trcompanyid,
                          a.routeid,
                          a.warehid) cc
         where t.usestatus in (1, 2)
           and cc.credate(+) = trunc(t.CREDATE)
           and cc.trcompanyid(+) = nvl(t.trcompanyid, 0)
           and cc.routeid (+)= nvl(t.routeid, 0)
           and cc.warehid(+)= nvl(t.warehid, 0)
         group by t.trcompanyid, --承运商
                  t.routeid,
                  t.warehid,
                  trunc(t.CREDATE),
                  cc.readydocnum) aa
 where aa.trcompanyid = tpl_pub_company.companyid(+)
   and aa.warehid = tpl_warehouse.warehid(+)
   and aa.routeid = wms_tr_route.routeid(+)
"
"WMS_TR_ROUTE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_TR_ROUTE_V"" (""ROUTEID"", ""ROUTENAME"", ""USESTATUS"", ""MEMO"", ""INTOWNFLAG"", ""WAREHID"", ""WAREHNAME"", ""ZONEID"", ""ZONENO"", ""ZONENAME"", ""TRANSFLAG"", ""TRANSMODEID"", ""TRCOMPANYID"", ""COMPANYNAME"", ""TRANSMODE"", ""TRANSNAME"", ""CLASSESID"") AS 
  select a.routeid,
       a.routename,
       a.usestatus,
       a.memo,
       a.intownflag,
       a.warehid,
       b.warehname,
       a.zoneid,
       c.zoneno,
       c.zonename,
       a.transflag,
       a.transmodeid,
       a.trcompanyid,
       e.companyname,
       d.transmode,
       d.transname,
       a.classesid
  from wms_tr_route       a,
       tpl_warehouse      b,
       wms_ship_zone      c,
       wms_transport_mode d,
       tpl_pub_company e
 where a.warehid = b.warehid
   and a.zoneid = c.zoneid(+)
   and a.transmodeid = d.transmodeid(+)
   and a.trcompanyid = e.companyid(+)
"
"WMS_TURNBOX_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_TURNBOX_DOC_V"" (""BOXDOCID"", ""CREDATE"", ""BINDDATE"", ""CONTAINERID"", ""CONTAINERNO"", ""PICKMANID"", ""PICKMAN"", ""COMPANYID"", ""COMPANYNAME"", ""GCOMPANYID"", ""GCOMPANYNO"", ""WAVEDTLID"", ""DTLLINES"", ""FINISHLINES"", ""WAVEID"", ""ROUTENAME"", ""OPERATIONTYPE"", ""OPERATIONTYPE1"", ""URGENFLAG"", ""USESTATUS"", ""PICKFLOWID"", ""PICKFLOWNO"", ""PICKFLOWNAME"", ""WAREHID"", ""WAREHNAME"", ""SENDTOWCSFLAG"", ""TRANSID"", ""INCEPTADDR"", ""DPSFLAG"", ""GOODSOWNERNAME"", ""GOODSOWNERID"", ""ROUTEID"", ""ROUTENAME1"") AS 
  select a.boxdocid,
       a.CREDATE,
       a.Binddate,
       a.containerid,
       e.containerno,
       a.PICKMANID,
       b.employeename pickman,
       a.COMPANYID,
       (case
         when a.warehid in (12, 9) and l.salername is not null then
          l.salername || '-' || d.companyname
         when a.warehid = 1 and f.goodsownerid = 682 and
              a.companyid = 1791345 then
          d.companyname || '(' || g.sendpos || ')'
         else
          d.companyname
       end) as companyname, --add by xyue 20170508(三明鹭燕需求)、20211213(厦门鹭燕需求)、20220507(莆田鹭燕需求)
       --d.companyname,
       d.gcompanyid,
       d.gcompanyno,
       a.wavedtlid,
       a.dtllines,
       a.finishlines,
       a.waveid,
       f.flowlineno     routename,
       f.operationtype,
       i.ddlname        operationtype1, --add by wanghuaiyu 2013年7月19日 23:03:35 散件出库复核时业务类型显示为汉字
       a.urgenflag,
       a.USESTATUS,
       a.PICKFLOWID,
       h.pickflowno,
       h.pickflowname,
       a.warehid,
       c.warehname,
       a.sendtowcsflag,
       f.transid,
       g.inceptaddr,
       a.dpsflag,
       k.goodsownername,
       f.goodsownerid,
       f.routeid,
       j.routename routename1
  from Wms_Turnbox_Doc a,
       pub_employee b,
       tpl_warehouse c,
       tpl_go_company d,
       wms_container_def e,
       wms_wave_dtl f,
       wms_transport_address g,
       wms_pickflow h,
       sys_ddl_all_v i,
       wms_tr_route j,
       tpl_goodsowner k,
       (select distinct wavedtlid, salername
          from wms_out_order t
         where t.goodsownerid in (204, 104)) l --add by xyue 20170508
 where a.pickmanid = b.employeeid(+)
   and a.companyid = d.companyid(+)
   and a.containerid = e.containerid(+)
   and a.wavedtlid = f.wavedtlid(+)
   And a.pickflowid = h.pickflowid(+)
   and a.warehid = c.warehid(+)
   AND f.transid = g.transid(+)
   and f.operationtype = i.ddlid
   and i.keyword = 'TPL_OPERATIONTYPE'
   and d.goodsownerid = k.goodsownerid(+)
   and f.routeid=j.routeid(+)
   and a.wavedtlid = l.wavedtlid(+) --add by xyue 20170508 三明鹭燕需求：【散件出库复核】客户名称+业务员
"
"WMS_TURNBOX_IO_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_TURNBOX_IO_V"" (""INOUTID"", ""TASKID"", ""BOXDOCID"", ""INOUTFLAG"", ""COMEFROM"", ""SOURCEID"", ""WAREHID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSPACKID"", ""BATCHNO"", ""LOTID"", ""POSID"", ""GOODSSTATUSID"", ""QUANTITYSTATUS"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""PRINTLINE"", ""PRINTNO"", ""KEEPDATE"", ""KEEPMANID"", ""OTHERID"", ""RFFLAG"", ""RFFINDATE"", ""RFMANID"", ""PRINTFLAG"", ""PRINTMANID"", ""PRINTDATE"", ""STOCKTEMPERATURE"", ""RETRECEPTFLAG"", ""CHECKSTATUS"", ""USESTATUS"", ""EXPFLAG"", ""EXPDATE"", ""EXPFILENAME"", ""MEMO"") AS 
  select inoutid,
       taskid,
       boxdocid,
       inoutflag,
       comefrom,
       sourceid,
       warehid,
       ownergoodsid,
       goodsid,
       goodspackid,
       batchno,
       lotid,
       posid,
       goodsstatusid,
       quantitystatus,
       ingoodsqty,
       outgoodsqty,
       goodsqty,
       wholeqty,
       scatterqty,
       printline,
       printno,
       keepdate,
       keepmanid,
       otherid,
       rfflag,
       rffindate,
       rfmanid,
       decode(printflag,null,null,1) printflag,
       printmanid,
       printdate,
       stocktemperature,
       retreceptflag,
       checkstatus,
       usestatus,
       expflag,
       expdate,
       expfilename,
       memo
  from wms_st_io_doc
"
"WMS_TURNOVER_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_TURNOVER_LST_V"" (""LSTID"", ""WAREHID"", ""POSID"", ""CREDATE"", ""INPUTMANID"", ""MEMO"", ""INPUTMANOPCODE"", ""INPUTMAN"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""WAREHOPCODE"", ""WAREHNAME"", ""POSNO"", ""POSNAME"") AS 
  select a.""LSTID"",a.""WAREHID"",a.""POSID"",a.""CREDATE"",a.""INPUTMANID"",a.""MEMO"",
       g.opcode inputmanopcode,
       g.employeename inputman,
       b.sectionid,
       b.sectionno,
       b.sectionname,
       c.areaid,
       c.areano,
       c.areaname,
       e.warehopcode,
       e.warehname,
       f.posno,
       f.posname
  from Wms_turnover_lst   a,
       wms_st_section_def b,
       wms_st_area_def    c,
       WMS_GROUP_DEF      d,
       tpl_warehouse      e,
       wms_pos_def        f,
       pub_employee       g
 where f.sectionid = b.sectionid(+)
   and b.groupid = d.groupid(+)
   and a.warehid = e.warehid(+)
   and b.areaid = c.areaid(+)
   and a.posid = f.posid(+)
   and a.inputmanid = g.employeeid

 "
"WMS_UDI_CODE_RECORD_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_UDI_CODE_RECORD_V"" (""RECORDID"", ""INOUTID"", ""UDICODE"", ""CREDATE"", ""EXPFLAG"", ""QTY"", ""SOURCEID"", ""INOUTFLAG"", ""INPUTMANID"", ""EXPDATE"", ""EXPMANID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTID"", ""FACTNAME"", ""COMEFROM"", ""SPECIALFLAG"", ""OWNERGOODSID"", ""GOODSOWNERNAME"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""OPERATIONTYPE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""COMPANYID"", ""COMPANYNAME"", ""INPUTMAN"") AS 
  select a.recordid,
       a.inoutid,
       a.udicode,
       a.credate,
       a.expflag,
       a.qty,
       a.sourceid,
       a.inoutflag,
       a.inputmanid,
       a.expdate,
       a.expmanid,
       a.goodsid,
       d.goodsname,
       d.goodstype,
       d.factid,
       e.companyname factname,
       a.comefrom,
       a.specialflag,
       a.ownergoodsid,
       c.goodsownername,
       a.lotid,
       f.lotno,
       f.proddate,
       f.validdate,
       a.operationtype,
       a.warehid,
       b.warehname,
       a.goodsownerid,
       a.companyid,
       g.companyname,
       h.employeename inputman
  from wms_udi_code_record a,
       tpl_warehouse       b,
       Tpl_Goodsowner      c,
       tpl_pub_goods       d,
       tpl_pub_company     e,
       wms_goods_lot       f,
       tpl_go_company      g,
       pub_employee        h
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.goodsid = d.goodsid
   and d.factid = e.companyid(+)
   and a.lotid = f.lotid(+)
   and a.companyid = g.companyid
   and a.inputmanid=h.employeeid(+)
"
"WMS_WAVEREPORT_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_WAVEREPORT_DOC_V"" (""WAVEDOCID"", ""WAREHID"", ""URGENFLAG"", ""CONTENTS"", ""EXECUTETIME"", ""SCATTERPACKS"", ""SCATTERFINPACKS"", ""PACKEDQTY"", ""SCATTERTAX"", ""WHOLEPACKS"", ""WHOLEFINPACKS"", ""WHOLETAX"", ""CUSTOMNUM"", ""FINISHCUSTOMNUM"", ""CUSTOMTAX"") AS 
  select a.wavedocid, --:1:2ID
       a.warehid,
       nvl(a.urgenflag, 0) urgenflag, --:3:4
       a.contents, --:5:6:7:8
       a.executetime, --:9:10:11:12:13:14
       nvl(a.SCATTERPACKS, 0) scatterpacks, --:15:16:17:18:19:20
       nvl(a.scatterfinpacks, 0) scatterfinpacks, --:21:22:23:24:25:26
       nvl(a.packedqty, 0) packedqty, --:27:28:29:30:31:32
       decode(nvl(a.scatterpacks, 0),
              0,0,
              round(nvl(a.scatterfinpacks, 0) / a.scatterpacks * 100, 2)) scattertax, --:33:34:35:36:37,
       nvl(a.wholepacks, 0) wholepacks, --:38:39:40:41:42
       nvl(a.wholefinpacks, 0) wholefinpacks, --:43:44:45:46:47
       decode(nvl(a.wholepacks, 0),
              0,0,
              round(nvl(a.wholefinpacks, 0) / a.wholepacks * 100, 2)) wholetax, --:48:49:50:51:52
       nvl(c.customnum, 0) customnum, --:53:54:55:56:57:58
       nvl(d.finishcustomnum, 0) finishcustomnum, --:59:60:61:62:63:64:65:66
       decode(nvl(c.customnum, 0),
              0,0,
              round(nvl(d.finishcustomnum, 0) / c.customnum * 100, 2)) customtax --:67:68:69:70:71
  from wms_wave_doc a,
       (select count(distinct customid) customnum, waveid
          from wms_wave_dtl
         where usestatus <> 0
         group by waveid) c,
       (select count(distinct customid) finishcustomnum, waveid
          from wms_wave_dtl
         where usestatus = 3
         group by waveid) d
 where a.wavedocid = c.waveid(+)
   and a.wavedocid = d.waveid(+)
"
"WMS_WAVEREPORT_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_WAVEREPORT_DTL_V"" (""WAVEID"", ""WAREHID"", ""WAVEDTLID"", ""OPERATIONTYPE"", ""SENDFLAG"", ""URGENFLAG"", ""ROADDOCID"", ""ROUTENAME"", ""CUSTOMID"", ""COMPANYNAME"", ""ROUTEID"", ""FLOWLINENO"", ""USESTATUS"", ""PRTCLASS"", ""WAVEDTLPRINT"", ""INTOWNFLAG"", ""TRDTLIDS"", ""SALESIDS"", ""EXPORTMEMO"", ""COMPANYTYPE"", ""INCEPTADDR"", ""ORDERS_SET"", ""EXECUTETIME"", ""SCATTERPACKS"", ""SCATTERFINPACKS"", ""PACKEDQTY"", ""CNT"", ""SCATTERTAX"", ""WHOLEPACKS"", ""WHOLEFINPACKS"", ""WHOLETAX"") AS 
  select a.waveid, --波次ID
       e.warehid,
       a.wavedtlid, --波次分配号
       a.operationtype, --业务类型 20100518
       nvl(a.sendflag, 0) sendflag, --发出标志
       nvl(e.urgenflag, 0) urgenflag, --加急
       80000000 + a.wavedtlid roaddocid, --路单ID
       d.routename, --线路
       a.customid, --客户ID
       b.companyname, --客户名称
       d.routeid,
       a.flowlineno,
       a.usestatus,
       a.prtclass, --打印分类
       decode(a.printflag, 1, 1, 0) wavedtlprint,
       --zx_hyd.getprtclass(a.prtclass) specialflag, --特药标志，20100916修改_不同角色查看数据不同，CH
       --zx_hyd.get_color(a.usestatus,a.prtclass,b.companyname) color,--记录颜色标识，20100916修改，HYD
       d.intownflag, --市内外
       --pf_gettrdtlid(a.wavedtlid) trdtlids,
       '' trdtlids,
       '' salesids, --pf_getsalesid(a.wavedtlid) salesids,
       --ZX_HYD.getexportmemo(a.wavedtlid) exportmemo, --出货备注
       '' exportmemo,
       decode(substr(b.gcompanyno, 6, 1),
              '2',
              '二级客户',
              '3',
              '三级客户',
              '其他') companytype, --二、三级客户
       c.inceptaddr,
       a.orders_set,
       e.executetime,
       nvl(a.scatterpacks, 0) scatterpacks, --散件预计装箱
       nvl(a.scatterfinpacks, 0) scatterfinpacks, --散件完成箱数
       --  nvl(a.packedqty, 0) - nvl(i.cnt,0) packedqty, --散件已经装箱
       --  nvl(i.cnt,0) cnt, --散件装袋数
       nvl(a.packedqty, 0) - pf_get_scatter(a.wavedtlid) packedqty, --散件已经装箱
       --pf_get_scatter(a.wavedtlid) cnt, --散件装袋数
       0 cnt,
       --PF_GET_SCATTER_RATION(a.wavedtlid) scattertax, --散件完成率,
       0 scattertax,
       nvl(a.wholepacks, 0) wholepacks, --预计整件数
       nvl(a.wholefinpacks, 0) wholefinpacks, --整件完工数
       decode(nvL(a.wholepacks, 0),
              0,
              0,
              round(nvl(a.wholefinpacks, 0) / a.wholepacks * 100, 2)) wholetax --整件完工率
  from wms_wave_dtl          a,
       tpl_go_company        b,
       wms_transport_address c,
       wms_tr_route          d,
       wms_wave_doc          e
 where a.customid = b.companyid(+)
   and a.transid = c.transid(+)
   and a.routeid = d.routeid(+)
   and a.waveid = e.wavedocid
   and a.usestatus <> 0
"
"WMS_WAVETASKREPORT_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_WAVETASKREPORT_DTL_V"" (""WAVEID"", ""URGENFLAG"", ""CONTENTS"", ""EXECUTETIME"", ""PICKFLOWNAME"", ""PICKFLOWID"", ""PICKAREAID"", ""PICKAREANAME"", ""WAREHID"", ""SCATTERPACKS"", ""SCATTERFINPACKS"", ""SCATTERTAX"", ""WHOLEPACKS"", ""WHOLEFINPACKS"", ""WHOLETAX"") AS 
  select b.waveid, --:1:2ID
       nvl(d.urgenflag, 0) urgenflag, --:3:4
       d.contents, --:5:6:7:8
       d.executetime, --:9:10:11:12:13:14
       c.pickflowname, --:15:16:17:18:19
       c.pickflowid,
       a.pickareaid,
       a.pickareaname,
       d.warehid,
       nvl(sum(b.scatterpacks), 0) scatterpacks, --:20:21:22:23:24:25
       nvl(sum(b.scatterfinpacks), 0) scatterfinpacks, --:26:27:28:29:30:31
       round(nvl(sum(b.scatterfinpacks) /
               decode(nvl(sum(b.scatterpacks), 0),
                      0,
                      1,
                      sum(b.scatterpacks)) * 100,
               0),
           2) scattertax, --:32:33:34:35:36,
       nvl(sum(b.wholepacks), 0) wholepacks, --:37:38:39:40:41
       nvl(sum(b.wholefinpacks), 0) wholefinpacks, --:42:43:44:45:46
       round(nvl(sum(b.wholefinpacks) /
                 decode(sum(b.wholepacks), 0, 1, sum(b.wholepacks)) * 100,
                 0),
             2) wholetax --:47:48:49:50:51
  from wms_wave_doc d, wms_task_doc b, wms_pickflow c, wms_pickarea a
 where d.wavedocid = b.waveid
   and b.pickflowid = c.pickflowid
   and c.pickflowid = a.pickflowid
   and b.waveid is not null
 group by b.waveid,
          d.urgenflag,
          d.contents, --:52:53:54:55
          d.executetime, --:56:57:58:59:60:61
          c.pickflowname,
          c.pickflowid,
          a.pickareaid,
          a.pickareaname,
          d.warehid
"
"WMS_WAVE_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_WAVE_DOC_V"" (""WAVEDOCID"", ""CONTENTS"", ""CREDATE"", ""INPUTMANID"", ""INPUTMAN"", ""WAVEMODELID"", ""WAVEMODELNAME"", ""SELECTRULE"", ""ORDERRULE"", ""PLANTIME"", ""EXECUTETIME"", ""EXECUTEMANID"", ""EXECUTEMAN"", ""SCATTERPACKS"", ""SCATTERFINPACKS"", ""WHOLEPACKS"", ""WHOLEFINPACKS"", ""REALPACKS"", ""UNORDERFLAG"", ""URGENFLAG"", ""USESTATUS"", ""PRINTFLAG"", ""MEMO"", ""WAREHID"", ""WAREHOPCODE"", ""WAREHNAME"", ""PRINTMEMO"", ""REPLENISHNUM"", ""WAVEGOODSDTLNUM"", ""IWCS_MSG"", ""TRADEWAVEFLAG"") AS 
  select WAVEDOCID,
       a.CONTENTS,
       a.CREDATE,
       a.INPUTMANID,
       c.employeename inputman,
       a.WAVEMODELID,
       b.wavemodelname,
       b.selectrule,
       b.orderrule,
       a.PLANTIME,
       a.EXECUTETIME,
       a.EXECUTEMANID,
       d.employeename executeman,
       a.SCATTERPACKS,
       a.SCATTERFINPACKS,
       a.WHOLEPACKS,
       a.WHOLEFINPACKS,
       a.REALPACKS,
       a.UNORDERFLAG,
       a.urgenflag,
       a.USESTATUS,
       decode(a.printflag,null,null,1) printflag,
       a.MEMO,
       a.warehid,
       e.warehopcode,
       e.warehname,
       --ZX_HYD.getprintmemo(a.wavedocid) printmemo  --by ydhu20110503
       '' printmemo,
       decode(zx_get_replenishnum(a.wavedocid),0,'无补货任务',to_char(zx_get_replenishnum(a.wavedocid))||'条补货任务未完成') replenishnum,
       zx_get_wavegoodsdtlnum(a.wavedocid) wavegoodsdtlnum,
       a.iwcs_msg,
       a.TRADEWAVEFLAG
  from wms_wave_doc a,
       wms_wave_model_def b,
       pub_employee c,
       pub_employee d,
       tpl_warehouse e
  where a.wavemodelid = b.wavemodelid(+)
    and a.inputmanid = c.employeeid(+)
    and a.executemanid = d.employeeid(+)
    AND a.warehid = e.warehid(+)
"
"WMS_WAVE_DTL_710005_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_WAVE_DTL_710005_V"" (""WAVEID"", ""WAVEDTLID"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CUSTOMID"", ""CUSTOMNAME"", ""COMPANYSTYLE"", ""GCOMPANYID"", ""GCOMPANYNO"", ""ORDERID"", ""TRANSID"", ""INCEPTADDR"", ""ROUTEID"", ""ROUTENAME"", ""DEPTNO"", ""DEPTNAME"", ""INVOICETYPE"", ""ORDERS_SET"", ""FLOWLINENO"", ""PRTCLASS"", ""OPERATIONTYPE"", ""OUTMODE"", ""MEMO"", ""SCATTERPACKS"", ""SCATTERFINPACKS"", ""WHOLEPACKS"", ""WHOLEFINPACKS"", ""USESTATUS"", ""PRINTFLAG"", ""PRINTDATE"", ""PRINTMANID"", ""PRINTMAN"", ""TRANSCLASS"", ""WAREHID"", ""SHIPZONEID"", ""ZONENO"", ""ZONENAME"", ""URGENFLAG"", ""SHIPZONEFLAG"", ""SALERID"", ""VARIETYDESCID"", ""REPTYPE"", ""TRID"", ""SENDPOS"", ""TRADEGOODSPACK"", ""CANPRINTFLAG"", ""SOURCEWAVEDTLID"", ""AUTOFINISHFLAG"", ""AUTOFINISHDATE"") AS 
  select a.waveid,
       a.wavedtlid wavedtlid,
       decode(g.wavedocid,0,a.autofinishdate,g.credate) credate,
       a.goodsownerid,
       e.goodsownername,
       a.customid,
       b.companyname customname,
       b.companystyle,
       b.gcompanyid,
       b.gcompanyno,
       a.orderid,
       a.transid,
       c.inceptaddr,
       a.routeid,
       d.routename,
       a.deptno,
       a.deptname,
       a.invoicetype,
       a.orders_set,
       a.flowlineno,
       a.prtclass,
       a.operationtype,
       a.outmode,
       a.memo,
       a.scatterpacks,
       decode(g.warehid,1,zx_get_boxno(a.wavedtlid),17,zx_get_boxno(a.wavedtlid),a.scatterfinpacks) scatterfinpacks,
       --a.scatterfinpacks,
       a.wholepacks,
       decode(g.warehid,1,zx_get_wholeqty(a.wavedtlid),17,zx_get_wholeqty(a.wavedtlid),a.wholefinpacks) wholefinpacks,
       --a.wholefinpacks,
       a.usestatus,
       decode(a.printflag,null,null,1) printflag,
       a.printdate,
       a.printmanid,
       f.employeename printman,
       a.transclass,
       g.warehid,
       a.shipzoneid,
       h.zoneno,
       h.zonename,
       g.urgenflag,
       a.shipzoneflag,
       a.salerid,
       '' varietydescid,
       '' reptype,
       '' trid,
       '' sendpos,
       '' tradegoodspack,
       nvl(a.canprintflag,0) canprintflag,
       a.sourcewavedtlid,
       a.autofinishflag,
       a.autofinishdate
  from wms_wave_dtl    a,
       tpl_go_company b,
       wms_transport_address c,
       pub_employee f,
       wms_tr_route d,
       tpl_goodsowner e,
       wms_wave_doc g,
       wms_ship_zone h
  where a.customid = b.companyid(+)
    and a.transid = c.transid(+)
    and a.printmanid = f.employeeid(+)
    and a.routeid = d.routeid(+)
    and a.goodsownerid =e.goodsownerid(+)
    AND a.waveid = g.wavedocid
    and a.shipzoneid = h.zoneid(+)
"
"WMS_WAVE_DTL_HOV_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_WAVE_DTL_HOV_V"" (""WAVEID"", ""WAVEDTLID"", ""CUSTOMID"", ""CUSTOMNAME"", ""GCOMPANYID"", ""GCOMPANYNO"", ""COMPANYSTYLE"", ""ORDERID"", ""SCATTERPACKS"", ""SCATTERFINPACKS"", ""WHOLEPACKS"", ""WHOLEFINPACKS"", ""USESTATUS"", ""TRANSID"", ""ROUTEID"", ""ROUTENAME"", ""INTOWNFLAG"", ""URGENFLAG"", ""INCEPTADDR"", ""DEPTNO"", ""DEPTNAME"", ""INVOICETYPE"", ""ORDERS_SET"", ""FLOWLINENO"", ""OPERATIONTYPE"", ""ROADDOCID"", ""EXECUTETIME"", ""OUTMODE"", ""MEMO"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""PACKEDQTY"") AS 
  select a.waveid,
       a.wavedtlid,
       a.customid,
       b.companyname customname,
       b.gcompanyid,
       b.gcompanyno,
       b.companystyle,
       a.orderid,
       a.scatterpacks,
       a.scatterfinpacks,
       a.wholepacks,
       a.wholefinpacks,
       a.usestatus,
       a.transid,
       a.routeid,
       d.routename,
       d.intownflag,
       e.urgenflag,
       c.inceptaddr,
       a.deptno,
       a.deptname,
       a.invoicetype,
       a.orders_set,
       a.flowlineno,
       a.operationtype,
       80000000+a.wavedtlid roaddocid,
       e.executetime,
       a.outmode,
       a.memo,
       f.goodsownerid,
       f.goodsownername,
       a.packedqty
  from wms_wave_dtl    a,
       tpl_go_company b,
       wms_transport_address c,
       wms_tr_route d,
       wms_wave_doc e,
       tpl_goodsowner        f
  where a.customid = b.companyid(+)
    and a.transid = c.transid(+)
    and a.routeid = d.routeid(+)
    and a.waveid = e.wavedocid
    and b.goodsownerid = f.goodsownerid

 "
"WMS_WAVE_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_WAVE_DTL_V"" (""WAVEID"", ""WAVEDTLID"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CUSTOMID"", ""CUSTOMNAME"", ""COMPANYSTYLE"", ""GCOMPANYID"", ""GCOMPANYNO"", ""ORDERID"", ""TRANSID"", ""INCEPTADDR"", ""ROUTEID"", ""ROUTENAME"", ""DEPTNO"", ""DEPTNAME"", ""INVOICETYPE"", ""ORDERS_SET"", ""FLOWLINENO"", ""PRTCLASS"", ""OPERATIONTYPE"", ""OUTMODE"", ""MEMO"", ""SCATTERPACKS"", ""SCATTERFINPACKS"", ""WHOLEPACKS"", ""WHOLEFINPACKS"", ""USESTATUS"", ""PRINTFLAG"", ""PRINTDATE"", ""PRINTMANID"", ""PRINTMAN"", ""TRANSCLASS"", ""WAREHID"", ""SHIPZONEID"", ""ZONENO"", ""ZONENAME"", ""URGENFLAG"", ""SHIPZONEFLAG"", ""SALERID"", ""VARIETYDESCID"", ""REPTYPE"", ""TRID"", ""SENDPOS"", ""TRADEGOODSPACK"") AS 
  select a.waveid,
       a.wavedtlid,
       g.credate,
       a.goodsownerid,
       e.goodsownername,
       a.customid,
       b.companyname customname,
       b.companystyle,
       b.gcompanyid,
       b.gcompanyno,
       a.orderid,
       a.transid,
       c.inceptaddr,
       a.routeid,
       d.routename,
       a.deptno,
       a.deptname,
       a.invoicetype,
       a.orders_set,
       a.flowlineno,
       a.prtclass,
       a.operationtype,
       a.outmode,
       a.memo,
       a.scatterpacks,
       a.scatterfinpacks,
       a.wholepacks,
       a.wholefinpacks,
       a.usestatus,
       decode(a.printflag,null,null,1) printflag,
       a.printdate,
       a.printmanid,
       f.employeename printman,
       a.transclass,
       g.warehid,
       a.shipzoneid,
       h.zoneno,
       h.zonename,
       g.urgenflag,
       a.shipzoneflag,
       a.salerid,
       '' varietydescid,
       '' reptype,
       '' trid,
       '' sendpos,
       '' tradegoodspack
  from wms_wave_dtl    a,
       tpl_go_company b,
       wms_transport_address c,
       pub_employee f,
       wms_tr_route d,
       tpl_goodsowner e,
       wms_wave_doc g,
       wms_ship_zone h
  where a.customid = b.companyid(+)
    and a.transid = c.transid(+)
    and a.printmanid = f.employeeid(+)
    and a.routeid = d.routeid(+)
    and a.goodsownerid =e.goodsownerid(+)
    AND a.waveid = g.wavedocid
    and a.shipzoneid = h.zoneid(+)
"
"WMS_WAVE_DTL_YJD_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_WAVE_DTL_YJD_V"" (""WAVEID"", ""WAVEDTLID"", ""CUSTOMID"", ""CUSTOMNAME"", ""GCOMPANYID"", ""GCOMPANYNO"", ""COMPANYSTYLE"", ""ORDERID"", ""SCATTERPACKS"", ""SCATTERFINPACKS"", ""WHOLEPACKS"", ""WHOLEFINPACKS"", ""USESTATUS"", ""TRANSID"", ""ROUTEID"", ""ROUTENAME"", ""INTOWNFLAG"", ""DEPTNO"", ""DEPTNAME"", ""INVOICETYPE"", ""ORDERS_SET"", ""FLOWLINENO"", ""SENDFLAG"", ""OPERATIONTYPE"", ""TRROADDOCID"", ""EXECUTETIME"", ""PRTCLASS"", ""OUTMODE"", ""MEMO"", ""PRINTFLAG"", ""PRINTDATE"", ""PRINTMANID"", ""PRINTMAN"", ""YJDPRINTFLAG"", ""YJDPRINTMANID"", ""YJDPRINTMAN"", ""YJDPRINTDATE"", ""WAREHID"", ""WAVEGOODSDTLID"", ""ADDMEDCHECKFLAG"", ""LOTID"", ""GOODSID"", ""GOODSOWNERNAME"", ""GOODSOWNERID"", ""GOODSNAME"", ""GOODSTYPE"", ""LOTNO"", ""PACKNAME"", ""PACKSIZE"", ""PRODAREA"", ""GOODSQTY"", ""GOODSSTATUS"", ""COMPANYNAME"", ""GOODSOWNID"", ""COMPANYID"") AS 
  select a.waveid,
       a.wavedtlid,
       a.customid,
       b.companyname customname,
       b.gcompanyid,
       b.gcompanyno,
       b.companystyle,
       a.orderid,
       a.scatterpacks,
       a.scatterfinpacks,
       a.wholepacks,
       a.wholefinpacks,
       a.usestatus,
       a.transid, d.routeid,d.routename, d.intownflag,
       a.deptno,
       a.deptname,
       a.invoicetype,
       a.orders_set,
       a.flowlineno,
       a.sendflag,
       a.operationtype,
       80000000+a.wavedtlid trroaddocid,
       e.executetime,
       a.prtclass,
       a.outmode,
       a.memo,
       decode(a.printflag,null,null,1) printflag,
       a.printdate,
       a.printmanid,
       f.employeename printman,
       a.yjdprintflag,
       a.yjdprintmanid,
       g.employeename yjdprintman,
       a.yjdprintdate,
       e.warehid,
       h.wavegoodsdtlid,--xyue 该视图中增加合并明细ID，存在一个波次分配ID中部分需要打印产检
      -- h.addmedcheckflag,--xyue 该视图中增加合并明细ID对应的产检打印标志
       case when a.goodsownerid = 264 and a.operationtype = 25
         then 1
           else h.addmedcheckflag
             end     addmedcheckflag,--福州器械赠品出库打印厂检tl@230529
       h.lotid，
       h.goodsid,
       h.goodsownername,
       h.goodsownerid,
       h.goodsname,
       h.goodstype,
       h.lotno,
       h.packname,
       h.packsize,
       h.prodarea，
       h.goodsqty,
       h.goodsstatus,
       h.companyname,
       h.goodsownid, --货主原货品ID
       b.companyid
  from wms_wave_dtl    a,
       tpl_go_company b,
       wms_tr_route d,
       wms_wave_doc e,
       pub_employee f,
       pub_employee g,
       wms_wave_goods_dtl_v h
  where a.customid = b.companyid(+)
    and a.routeid = d.routeid(+)
    and a.waveid = e.wavedocid
    and a.printmanid = f.employeeid(+)
    and a.yjdprintmanid = g.employeeid(+)
    and h.wavedtlid = a.wavedtlid
"
"WMS_WAVE_GOODS_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_WAVE_GOODS_DTL_V"" (""WAVEDTLID"", ""WAVEGOODSDTLID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""COMPANYNAME"", ""JKHZFLAG"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""BMSLOTID"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""SORTTYPE"", ""ADDMEDCHECKFLAG"", ""GOODSOWNID"", ""GOODSNO"", ""USESTATUS"", ""PRINTFLAG"", ""PRINTDATE"", ""PRINTMANID"", ""SALERID"", ""SALERNAME"", ""FLAG"") AS 
  select a.wavedtlid,
       a.wavegoodsdtlid,
       a.goodsownerid,
       g.goodsownername,
       a.ownergoodsid,
       a.goodsid,
       f.opcode,
       f.goodsname,
       f.goodstype,
       f.prodarea,
       f.factname as companyname,
       null as jkhzflag,
       a.goodspackid,
       c.packname,
       c.packsize,
       a.batchno,
       a.lotid,
       d.lotno,
       decode(to_char(d.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              d.validdate) validdate,
       d.proddate,
       d.approvedocno,
       d.registno,
       d.memo bmslotid,
       a.goodsstatusid,
       e.goodsstatus,
       a.quantitystatus,
       a.goodsqty,
       a.wholeqty,
       a.scatterqty,
       a.sorttype,
       a.addmedcheckflag,
       f.goodsownid,
       f.goodsno,
       a.usestatus,
       decode(a.printflag, null, null, 1) printflag,
       a.printdate,
       a.printmanid,
       null as salerid,
       null as salername,
       a.flag
  from wms_wave_goods_dtl  a,
       --tpl_pub_goods_v     b, -- xyue 修改货品主档表为视图，目的是取生产厂家，2014-04-15
       tpl_pub_goods_packs c,
       wms_goods_lot       d,
       wms_goodsstatus     e,
       tpl_goods           f,
       tpl_goodsowner      g
 where a.ownergoodsid = f.ownergoodsid(+)
   and a.goodspackid = c.goodspackid(+)
   and a.lotid = d.lotid(+)
   and a.goodsstatusid = e.goodsstatusid(+)
   --and a.goodsid = b.goodsid(+)
   and a.goodsownerid = g.goodsownerid(+)
"
"WMS_WAVE_MODEL_DEF_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_WAVE_MODEL_DEF_V"" (""WAVEMODELID"", ""WAVEMODELNAME"", ""SELECTRULE"", ""ORDERRULE"", ""MEMO"") AS 
  select wavemodelid, wavemodelname, selectrule, orderrule, memo
  from wms_wave_model_def

 "
"WMS_WAVE_RELEASE_PLAN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_WAVE_RELEASE_PLAN_V"" (""SEQID"", ""WAREHID"", ""WAVEMODELID"", ""PLANDATE"", ""PLANTIME"", ""MEMO"", ""WAVEMODELNAME"") AS 
  select
p.seqid,
p.warehid,
p.wavemodelid,
p.plandate,
p.plantime,
p.memo,
m.wavemodelname
from
WMS_WAVE_RELEASE_PLAN p ,
WMS_WAVE_MODEL_DEF m
where p.wavemodelid = m.wavemodelid(+)
"
"WMS_WHOLECHECK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_WHOLECHECK_V"" (""INOUTID"", ""TASKID"", ""BOXDOCID"", ""INOUTFLAG"", ""COMEFROM"", ""SOURCEID"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTORYNAME"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""POSID"", ""POSNO"", ""POSNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""AREAFLAG"", ""AREATYPE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""PRINTLINE"", ""PRINTNO"", ""KEEPDATE"", ""KEEPMANID"", ""KEEPMANNAME"", ""OTHERID"", ""RFFLAG"", ""RFFINDATE"", ""RFMANID"", ""RFMANNAME"", ""PRINTFLAG"", ""PRINTMANID"", ""PRINTMANNAME"", ""PRINTDATE"", ""RETRECEPTFLAG"", ""CHECKSTATUS"", ""USESTATUS"", ""GOODSOWNID"", ""GOODSNO"", ""TRADEPACKNAME"", ""CREDATE"", ""CUSTOMID"", ""CUSTOMNAME"", ""FLOWLINENO"", ""MEMO"", ""WHOLEOUTFLAG"", ""FACTNAME"", ""GOODSENGNAME"", ""UDI_FLAG"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.inoutid,
       a.taskid,
       a.boxdocid,
       a.inoutflag,
       a.comefrom,
       a.sourceid,
       a.warehid,
       b.warehname,
       a.ownergoodsid,
       a.goodsid,
       c.goodsname,
       c.goodstype,
       c.prodarea,
       c.factid,
       l.companyname factoryname,
       a.goodspackid,
       d.packname,
       d.packsize,
       a.batchno,
       a.lotid,
       e.lotno,
       e.proddate,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,
       e.approvedocno,
       a.posid,
       f.posno,
       f.posname,
       a.sectionid,
       n.sectionno,
       n.sectionname,
       a.areaid,
       m.areano,
       m.areaname,
       m.areaflag,
       m.areatype,
       a.goodsstatusid,
       g.goodsstatus,
       g.quantitystatus,
       a.ingoodsqty,
       a.outgoodsqty,
       a.goodsqty,
       a.wholeqty,
       a.scatterqty,
       a.printline,
       a.printno,
       a.keepdate,
       a.keepmanid,
       h.employeename keepmanname,
       a.otherid,
       a.rfflag,
       a.rffindate,
       a.rfmanid,
       i.employeename rfmanname,
       decode(a.printflag, null, null, 1) printflag,
       a.printmanid,
       j.employeename printmanname,
       a.printdate,
       a.retreceptflag,
       nvl(a.checkstatus, 0) checkstatus,
       nvl(a.usestatus, 0) usestatus,
       p.goodsownid,
       p.goodsno,
       p.tradepackname,
       q.credate,
       r.customid,
       s.companyname customname,
       r.flowlineno,
       a.memo,
       a.wholeoutflag,
       p.factname, --厂家 add by wanghuaiyu 2013年8月5日 15:54:57
       p.goodsengname, --通用名 add by wanghuaiyu 2013年8月5日 15:55:23
       nvl(p.udi_flag, 0) udi_flag,
       a.goodsownerid,
       o.goodsownername
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_pub_goods       c,
       tpl_pub_goods_packs d,
       wms_goods_lot       e,
       wms_goodsstatus     g,
       pub_employee        h,
       pub_employee        i,
       pub_employee        j,
       wms_wave_goods_dtl  k,
       tpl_pub_company     l,
       wms_pos_def         f,
       wms_st_area_def     m,
       wms_st_section_def  n,
       tpl_goods           p,
       wms_task_doc        q,
       wms_wave_dtl        r,
       tpl_go_company      s,
       tpl_goodsowner      o
 where a.warehid = b.warehid(+)
   and a.goodsid = c.goodsid(+)
   and c.factid = l.companyid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.lotid = e.lotid(+)
   and a.posid = f.posid(+)
   and a.areaid = m.areaid(+)
   and a.sectionid = n.sectionid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.keepmanid = h.employeeid(+)
   and a.rfmanid = i.employeeid(+)
   and a.printmanid = j.employeeid(+)
   and a.comefrom = 3
   and a.sourceid = k.wavegoodsdtlid(+)
   and p.ownergoodsid = a.ownergoodsid
   and q.taskid(+) = a.taskid
   and k.wavedtlid = r.wavedtlid
   and r.customid = s.companyid
   and a.goodsownerid = o.goodsownerid(+)
"
"WMS_WHOLE_PACK_SHIP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_WHOLE_PACK_SHIP_V"" (""INOUTID"", ""SOURCEID"", ""COMPANYID"", ""CUSTOMNAME"", ""COMEFROM"", ""BOXCODE"", ""PACKS"", ""GATHERPOSID"", ""POSNO"", ""OPERATIONTYPE"", ""CONTAINERNO"", ""SHIPPOSFLAG"") AS 
  select a.inoutid,
       b.sourceid,
       a.companyid,
       g.companyname customname,
       b.comefrom,
       decode(b.comefrom, 1, a.inoutid, b.boxcode) boxcode,
       decode(b.comefrom, 1, b.packs, 1) packs,
       c.gatherposid,
       c.gatherposno posno,
       e.ddlname operationtype,
       f.containerno,
       case
         when b.usestatus = 2 then
          0
         when b.usestatus = 3 then
          1
         else
          null
       end shipposflag
  from wms_out_gather_lst     a,
       wms_out_gather_lst_dtl b,
       base_gather_zone_pos   c,
       wms_st_io_doc          d,
       sys_ddl_all_v          e,
       wms_container_def      f,
       tpl_go_company         g
 where a.gathterlstid = b.gathterlstid
   and b.gatherposid = c.gatherposid
   and a.inoutid = d.inoutid
   and (d.operationtype = e.ddlid(+) and e.keyword(+) = 'TPL_OPERATIONTYPE')
   and d.containerid = f.containerid(+)
   and a.companyid = g.companyid
"
"WMS_WHOLE_SHIP_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_WHOLE_SHIP_V"" (""WAVEDOCID"", ""WAVEDTLID"", ""RECCOMPANYID"", ""ORDERID"", ""SCATTERPACKS"", ""SCATTERFINPACKS"", ""WHOLEPACKS"", ""WHOLEFINPACKS"", ""USESTATUS"", ""TRANSID"", ""DEPTNO"", ""INVOICETYPE"", ""ORDERS_SET"", ""MEMO"", ""DEPTNAME"", ""FLOWLINENO"", ""PACKEDQTY"", ""OPERATIONTYPE"", ""OUTMODE"", ""PRINTFLAG"", ""PRINTDATE"", ""PRINTMANID"", ""ROUTEID"", ""PRTCLASS"", ""SENDFLAG"", ""GOODSOWNERID"", ""TRANSCLASS"", ""YJDPRINTFLAG"", ""YJDPRINTMANID"", ""YJDPRINTDATE"", ""SHIPZONEID"", ""SHIPZONEFLAG"", ""WAVEGOODSDTLID"", ""SALERID"") AS 
  select c.waveid wavedocid,
         c.wavedtlid,
         c.customid reccompanyid,
         c.orderid,
         c.scatterpacks,
         c.scatterfinpacks,
         c.wholepacks,
         c.wholefinpacks,
         c.usestatus,
         c.transid,
         c.deptno,
         c.invoicetype,
         c.orders_set,
         c.memo,
         c.deptname,
         c.flowlineno,
         c.packedqty,
         c.operationtype,
         c.outmode,
         decode(c.printflag,null,null,1) printflag,
         c.printdate,
         c.printmanid,
         c.routeid,
         c.prtclass,
         c.sendflag,
         c.goodsownerid,
         c.transclass,
         c.yjdprintflag,
         c.yjdprintmanid,
         c.yjdprintdate,
         c.shipzoneid,
         c.shipzoneflag,
         b.wavegoodsdtlid,
         c.salerid
    from  wms_wave_goods_dtl b, wms_wave_dtl c
   where b.wavedtlid = c.wavedtlid
"
"WMS_YJD_WAVE_GOODS_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_YJD_WAVE_GOODS_DTL_V"" (""WAVEDTLID"", ""WAVEGOODSDTLID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""JKHZFLAG"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""REGISTNO"", ""BMSLOTID"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""SORTTYPE"", ""ADDMEDCHECKFLAG"", ""GOODSOWNID"", ""GOODSNO"", ""USESTATUS"", ""PRINTFLAG"", ""PRINTDATE"", ""PRINTMANID"", ""SALERID"", ""SALERNAME"", ""FLAG"", ""FACTNAMNE"", ""FACTID"", ""CREDATE"", ""CUSTOMERNO"", ""CUSTOMERNAME"", ""YJDEXPFLAG"") AS 
  select a.wavedtlid,
       a.wavegoodsdtlid,
       a.goodsownerid,
       g.goodsownername,
       a.ownergoodsid,
       a.goodsid,
       b.opcode,
       b.goodsname,
       b.goodstype,
       b.prodarea,
       b.jkhzflag,
       a.goodspackid,
       c.packname,
       c.packsize,
       a.batchno,
       a.lotid,
       d.lotno,
       d.validdate,
       d.proddate,
       d.approvedocno,
       d.registno,
       d.memo bmslotid,
       a.goodsstatusid,
       e.goodsstatus,
       a.quantitystatus,
       a.goodsqty,
       a.wholeqty,
       a.scatterqty,
       a.sorttype,
       a.addmedcheckflag,
       --1 addmedcheckflag,
       f.goodsownid,
       f.goodsno,
       a.usestatus,
       a.printflag,
       a.printdate,
       a.printmanid,
       i.salerid,
       i.salername,
       a.flag,
        k.companyname factnamne,
       b.factid,
       m.credate,
       n.gcompanyid Customerno,--xyue 2015-05-07 修改为取wms货主原单位ID，即ERP上的客户ID
       n.companyname  Customername,
       a.yjdexpflag
  from wms_wave_goods_dtl  a,
       tpl_pub_goods       b,
       tpl_pub_goods_packs c,
       wms_goods_lot       d,
       wms_goodsstatus     e,
       tpl_goods           f,
       tpl_goodsowner      g,
       wms_out_order_dtl   h,
       wms_out_order       i,
       tpl_pub_company     k,
       wms_wave_dtl l,
       wms_wave_doc m,
       tpl_go_company n
 where a.goodsid = b.goodsid(+)
   and a.goodspackid = c.goodspackid(+)
   and a.lotid = d.lotid(+)
   and a.goodsstatusid = e.goodsstatusid(+)
   and a.ownergoodsid = f.ownergoodsid(+)
   and a.goodsownerid = g.goodsownerid(+)
   AND a.wavegoodsdtlid = h.wavegoodsdtlid(+)
   AND h.outid = i.outid(+)
   and b.factid = k.companyid(+)
   and a.wavedtlid = l.wavedtlid(+)
   and l.waveid = m.wavedocid(+)
   and l.customid = n.companyid(+)
"
"WMS_ZSPT_IN_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ZSPT_IN_V"" (""BILLNO"", ""BILLDATE"", ""BILLDTLNO"", ""CAMERANO"", ""BILLTYPE"", ""COMPANYID"", ""GOODSID"", ""GOODSQTY"", ""STORENAME"", ""STOREADDRESS"", ""SEQID"", ""LOTNO"", ""INVALIDDATE"", ""PRODDATE"", ""PRODAREA"", ""UPPERBILLTYPE"", ""UPPERNUM"") AS 
  select a.billno,
       a.billdate,
       a.billdtlno,
       a.camerano,
       a.billtype,
       --a.supplyid,--供应商ID
       a.companyid,
       a.goodsid,
       a.goodsqty,
       a.storename,--仓库名称
       a.storeaddress,--仓库地址

       a.seqid,

       a.lotno,

       a.invaliddate,
       a.proddate,
       a.prodarea,--产地
       a.upperbilltype,--上级业务类型
       a.uppernum --上级单号

  from wms_zspt_in a
"
"WMS_ZSPT_OUT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""WMS_ZSPT_OUT_V"" (""BILLNO"", ""BILLDTLNO"", ""SEQID"", ""BILLDATE"", ""CAMERANO"", ""BILLTYPE"", ""COMPANYID"", ""GOODSID"", ""GOODSQTY"", ""STORENAME"", ""STOREADDRESS"", ""LOTNO"", ""PRODDATE"", ""INVALIDDATE"", ""PRODAREA"", ""UPPERBILLTYPE"", ""UPPERNUM"") AS 
  select a.billno,
       a.billdtlno,
       a.seqid,
       a.billdate,
       a.camerano,
       a.billtype,
       --a.customid,--客户id
       a.companyid,
       a.goodsid,
       a.goodsqty,
       a.storename,
      a.storeaddress,
       a.lotno,
       a.proddate,
       a.invaliddate,
       a.prodarea,
       a.upperbilltype,
       a.uppernum
  from wms_zspt_out a
"
"XMLY_WMS_YJD_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""XMLY_WMS_YJD_ORDER_V"" (""ORDERNO"", ""SOURCEID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSNO"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""ADDMEDCHECKFLAG"", ""FACTNAME"", ""TRADEDATE"", ""CUSTOMERNO"", ""CUSTOMERNAME"", ""CUSTOMERTYPE"") AS 
  select wavedtlid orderno, --订单编号
       wavegoodsdtlid sourceid, --来源单据ID
       goodsownerid, --货主ID
       goodsownername, --货主名称
       goodsid, --货品ID
       goodsid goodsno, --药品编号,xyue 取WMS的货品主档，该字段展示在网页上
       goodsname, --药品名称
       goodstype, --规格型号
       prodarea, --产地
       lotid, --批号ID
       lotno, --批号
       validdate, --有效期
       proddate, --生产日期
       addmedcheckflag, --附药简单标志
       factnamne factname, -- 生产厂商
       credate tradedate,
       Customerno,
       Customername,
       1 Customertype
  from wms_yjd_wave_goods_dtl_v
 where credate >= sysdate - 60
      --and addmedcheckflag=1
   and goodsownerid<>64 --屏蔽燕来福数据
   and nvl(yjdexpflag, 0) = 0
 order by credate desc
"
"XMLY_WMS_YJD_ORDER_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""XMLY_WMS_YJD_ORDER_V1"" (""ORDERNO"", ""SOURCEID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSNO"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""ADDMEDCHECKFLAG"", ""FACTNAME"", ""TRADEDATE"", ""CUSTOMERNO"", ""CUSTOMERNAME"", ""CUSTOMERTYPE"") AS 
  select  	   wavedtlid orderno,--订单编号
      wavegoodsdtlid sourceid,--来源单据ID
      goodsownerid,--货主ID
      goodsownername,--货主名称
      goodsid,--货品ID
      goodsid  goodsno ,--药品编号,xyue 取WMS的货品主档，该字段展示在网页上
      goodsname,--药品名称
      goodstype,--规格型号
      prodarea,--产地
      lotid,--批号ID
      lotno,--批号
      validdate,--有效期
      proddate,--生产日期
      addmedcheckflag,--附药简单标志
      factnamne factname, -- 生产厂商
      credate tradedate ,
      Customerno  ,
      Customername ,
      1 Customertype
 from   wms_yjd_wave_goods_dtl_v
 where credate < sysdate -5
 --and addmedcheckflag=1
 and nvl(yjdexpflag,0) =0
 order by credate desc
"
"XYUE","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""XYUE"" (""GOODSID"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""USESTATUS"", ""GOODSLENGTH"", ""GOODSWIDTH"", ""GOODSHEIGHT"", ""GOODSWEIGHT"", ""WEIGHTUNIT"", ""BASEUNITFLAG"", ""GOODSPACKLAYER"", ""GOODSCUBAGE"", ""ZXDLFLAG"", ""MEMO"", ""USEDFLAG"", ""PACKID"") AS 
  select ""GOODSID"",""GOODSPACKID"",""PACKNAME"",""PACKSIZE"",""USESTATUS"",""GOODSLENGTH"",""GOODSWIDTH"",""GOODSHEIGHT"",""GOODSWEIGHT"",""WEIGHTUNIT"",""BASEUNITFLAG"",""GOODSPACKLAYER"",""GOODSCUBAGE"",""ZXDLFLAG"",""MEMO"",""USEDFLAG"",""PACKID"" from tpl_pub_goods_packs
"
"XYUE_ECODE_TEST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""XYUE_ECODE_TEST_V"" (""RECORDID"", ""SOURCEIDBAK"", ""ECODE"", ""CREDATE"", ""EXPFLAG"", ""QTY"", ""INOUTFLAG"", ""INPUTMANID"", ""INPUTMANNAME"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""TRADEPACKNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""WARECID"", ""TRADETIME"", ""TRADENO"", ""EXPDATE"", ""EXPMANID"", ""EXPMANNAME"", ""SPECIALFLAG"", ""SIGNATURE"", ""BILLTYPE"", ""COMEFROM"") AS 
  select a.recordid,
       a.sourceid as sourceidbak,
       --zx_get_srcexpno(b.inoutid) as sourceid,
       a.ecode,
       trunc(a.credate) as credate, --创建时间,为了导出的XML可用,时分秒都为00:00:00
       nvl(a.expflag, 0) as expflag,
       a.qty,
       a.inoutflag,
       a.inputmanid,
       c.employeename as inputmanname, --采集人
       a.warehid,
       d.warehname,
       a.ownergoodsid,
       a.goodsid,
       e.goodsname,
       e.goodstype,
       e.prodarea,
       e.factname factname,
       --b.goodspackid,
       --g.packname,
       --g.packsize,
       --b.batchno,
       a.lotid,
       h.lotno,
       h.proddate,
       h.validdate,
       h.approvedocno,
       --b.goodsstatusid,
       --i.goodsstatus,
       --i.quantitystatus,
       e.tradepackname,
       --decode(b.operationtype, 43, 11, 25, 21, 18, 11, b.operationtype) operationtype,
       a.goodsownerid,
       j.goodsownername,
       a.companyid,
       f.companyname,
       f.warecid,
       a.credate        as tradetime, --交易日期
       a.sourceid       as tradeno, --交易单号
       a.expdate,
       a.expmanid,
       k.employeename   expmanname,
       null             as specialflag,
       null             as signature,
       /*       decode(b.goodsownerid,
       8100,
       (select nvl(max(t1.gcompanyid), 0)
          from tpl_go_company t1
         where t1.goodsownerid = 8100
           and t1.companyname = o.receivehead),
       nvl(f.corpid, f.gcompanyid)) corpid, --辰欣 by tl@230825*/
       null billtype,
       nvl(a.comefrom, 0) comefrom -- add by xyue 2015-12-01 区分数据来源是外部导入还是系统内部生成
--zx_get_srcexpno(b.inoutid) as srcexpno
  from wms_ecode_record a,
       --wms_st_io_doc         b,
       pub_employee   c,
       tpl_warehouse  d,
       tpl_goods      e,
       tpl_go_company f,
       --tpl_pub_goods_packs   g,
       wms_goods_lot h,
       --wms_goodsstatus       i,
       tpl_goodsowner j,
       pub_employee   k
 where --a.sourceid = b.inoutid
--and
 nvl(a.comefrom, 0) = 0
 and a.inoutflag = 1
--and b.comefrom in (2,3)
 and a.inputmanid = c.employeeid(+)
 and a.warehid = d.warehid
 and a.goodsownerid = j.goodsownerid
 and a.ownergoodsid = e.ownergoodsid
--and b.goodspackid = g.goodspackid(+)
 and a.lotid = h.lotid(+)
--and b.goodsstatusid = i.goodsstatusid(+)
 and a.companyid = f.companyid
 and a.expmanid = k.employeeid(+)
 and a.credate > to_Date('2024-06-01', 'yyyy-mm-dd')
"
"XYUE_TMP_TDPRINT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""XYUE_TMP_TDPRINT_V"" (""ERPDOCID"", ""ERPDTLID"", ""VBELN"", ""WGBEZ"", ""MAKTXCUR"", ""MAKTX"", ""WRKST"", ""GROES"", ""CHARG"", ""HSDAT"", ""MBDAT"", ""MSEHL"", ""LFIMG"", ""ZDJ"", ""ZJE"", ""ZZKE"", ""ZZHJE"", ""ZFBDW"", ""OUTID"", ""MARANORMT"") AS 
  select t.erpdocid,
       replace(t.erpdtlid, '00' || t.erpdocid, null) erpdtlid,
       t.vbeln,
       t.wgbez,
       t.maktxcur,
       t.maktx,
       t.wrkst,
       t.groes,
       t.charg,
       decode(t.hsdat,
              '00000000',
              null,
              to_char(to_date(t.hsdat, 'yyyymmdd'), 'yyyy-mm-dd')) HSDAT,
       (case
         when length(t.mbdat) = 6 then
          decode(t.mbdat,
                 '000000',
                 null,
                 substr(t.mbdat, 0, 4) || '-' || substr(t.mbdat, -2))
         else
          decode(t.mbdat,
                 '00000000',
                 null,
                 to_char(to_date(t.mbdat, 'yyyymmdd'), 'yyyy-mm-dd'))
       end) MBDAT,
       t.msehl,
       t.lfimg,
       t.zdj,
       t.zje,
       t.zzke,
       t.zzhje,
       t.zfbdw,
       t.outid,
       t.normt as MARANORMT
  from TAIDE_WMS2SAP_SHTXD t
--where t.outid = 8472489
"
"XYUE_TMP_WMS_ROBO_DIFFQTY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""XYUE_TMP_WMS_ROBO_DIFFQTY_V"" (""OWNERGOODSID"", ""LOTID"", ""GOODSPACKID"", ""WMSGOODSQTY"", ""ROBOQTY"", ""DIFFQTY"") AS 
  select total.ownergoodsid,
       total.lotid,
       total.goodspackid,
       total.wmsgoodsqty,
       total.roboqty,
       (nvl(total.wmsgoodsqty,0) - nvl(total.roboqty,0)) diffqty
  from (select pk,
               max(ownergoodsid) ownergoodsid,
               max(lotid) lotid,
               max(goodspackid) goodspackid,
               max(goodsqty) wmsgoodsqty,
               max(roboqty) roboqty
          from (select a.ownergoodsid || '-' || a.lotid || '-' ||
                       a.goodspackid PK,
                       a.ownergoodsid,
                       a.lotid,
                       a.goodspackid,
                       a.goodsqty,
                       null roboqty
                  from (select t.ownergoodsid,
                               t.lotid,
                               t.goodspackid,
                               sum(t.goodsqty) goodsqty
                          from Wms_St_Qty_Lst t
                         where t.goodsownerid = 6
                           and t.posid = 133707
                      group by t.ownergoodsid,t.lotid,t.goodspackid) a
                union all
                select b.ownergoodsid || '-' || b.lotid || '-' ||
                       b.goodspackid PK,
                       b.ownergoodsid,
                       b.lotid,
                       b.goodspackid,
                       null goodsqty,
                       b.goodsqty roboqty
                  from (select t.com_goods_id ownergoodsid,
                               t.com_lot_id lotid,
                               tt.goodspackid goodspackid,
                               sum(t.onavailable) goodsqty
                          from com_inv_fact@iwcs t ,tpl_goods_packs tt
                         where t.onavailable<>0
                           and t.package_id=tt.ownerpackid(+)
                         group by t.com_goods_id,t.com_lot_id,tt.goodspackid) b)
         group by pk) total
"
"XYUE_TMP_WMS_ROBO_DIFFQTY_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""XYUE_TMP_WMS_ROBO_DIFFQTY_V1"" (""OWNERGOODSID"", ""货品名称"", ""商品名"", ""规格"", ""基本单位"", ""厂家"", ""批号ID"", ""批号名称"", ""WMS包装ID"", ""ROBO使用包装ID"", ""包装名称"", ""包装大小"", ""WMS库存数量"", ""ROBO盘点数量"", ""差异数量"") AS 
  select a.ownergoodsid,
       b.goodsname 货品名称,
       b.goodsengname 商品名,
       b.goodstype 规格,
       b.tradepackname 基本单位,
       b.factname 厂家,
       a.lotid 批号ID,
       c.lotno 批号名称,
       a.goodspackid WMS包装ID,
       d.ownerpackid ROBO使用包装ID,
       d.packname 包装名称,
       d.packsize 包装大小,
       a.wmsgoodsqty WMS库存数量,
       a.roboqty ROBO盘点数量,
       a.diffqty 差异数量
  from xyue_tmp_wms_robo_diffqty_v a,
       tpl_goods                   b,
       wms_goods_lot               c,
       tpl_goods_packs             d
where  a.ownergoodsid=b.ownergoodsid(+)
and    a.ownergoodsid=d.ownergoodsid(+)
and    a.lotid=c.lotid(+)
and    a.goodspackid=d.goodspackid(+)
order by a.ownergoodsid,a.lotid,a.goodspackid
"
"XYUE_TMP_WMS_ROBO_DIFFQTY_V2","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""XYUE_TMP_WMS_ROBO_DIFFQTY_V2"" (""OWNERGOODSID"", ""LOTID"", ""GOODSPACKID"", ""WMSGOODSQTY"", ""ROBOQTY"", ""DIFFQTY"") AS 
  select total.ownergoodsid,
       total.lotid,
       total.goodspackid,
       total.wmsgoodsqty,
       total.roboqty,
       (nvl(total.wmsgoodsqty,0) - nvl(total.roboqty,0)) diffqty
  from (select pk,
               max(ownergoodsid) ownergoodsid,
               max(lotid) lotid,
               max(goodspackid) goodspackid,
               max(goodsqty) wmsgoodsqty,
               max(roboqty) roboqty
          from (select a.ownergoodsid || '-' || a.lotid || '-' ||
                       a.goodspackid PK,
                       a.ownergoodsid,
                       a.lotid,
                       a.goodspackid,
                       a.goodsqty,
                       null roboqty
                  from (select t.ownergoodsid,
                               t.lotid,
                               t.goodspackid,
                               sum(t.goodsqty) goodsqty
                          from Wms_St_Qty_Lst t
                         where t.goodsownerid = 6
                           and t.posid = 137772
                      group by t.ownergoodsid,t.lotid,t.goodspackid) a
                union all
                select b.ownergoodsid || '-' || b.lotid || '-' ||
                       b.goodspackid PK,
                       b.ownergoodsid,
                       b.lotid,
                       b.goodspackid,
                       null goodsqty,
                       b.goodsqty roboqty
                  from (select t.ownergoodsid,
                               t.lotid,
                               t.goodspackid goodspackid,
                               t.diffqty*-1 goodsqty
                          from xyue_tmp_wms_robo_diffqty_v t
                         where t.diffqty<0) b)
         group by pk) total
"
"ZONE_PICKFLOW_RULE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZONE_PICKFLOW_RULE_V"" (""RULEID"", ""ZONEID"", ""PICKFLOWID"", ""PICKFLOWNO"", ""PICKFLOWNAME"", ""WCSFLAG"", ""MEMO"") AS 
  select a.ruleid,
         a.zoneid,
         a.pickflowid,
         b.pickflowno,
         b.pickflowname,
         b.wcsflag,
         a.memo
    from wms_ship_zone_pickflow_rule a,wms_pickflow b
 where a.pickflowid = b.pickflowid(+)
"
"ZX_18001_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_18001_V"" (""INOUTID"", ""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""APPROVEDOCNO"", ""DRUGFORM"", ""GOODSOWNID"", ""LOTID"", ""LOTNO"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""COMPANYID"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""GOODSQTY"", ""OUTGOODSQTY"", ""INGOODSQTY"", ""SCATTERQTY"", ""WHOLEQTY"", ""USEMM"") AS 
  select a.inoutid, --出入库ID
       a.credate, --创建时间
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.ownergoodsid, --货主货品ID
       d.goodsname, --货品名称
       d.goodsengname, --商品名
       d.goodstype, --规格
       d.tradepackname, --单位
       d.factname, --生产厂家
       d.prodarea, --产地
       d.approvedocno, --批准文号
       d.drugform, --剂型
       d.goodsownid, --货主原货品ID
       a.lotid, --批号ID
       e.lotno, --批号
       a.goodspackid, --货品主档包装ID
       f.packname, --包装单位
       f.packsize, --包装大小
       a.companyid, --货主单位ID
       g.companyname, --货主单位名称
       a.operationtype, --业务类型
       a.goodsqty, --实际业务数量
       a.outgoodsqty, --出库数量
       a.ingoodsqty, --入库数量
       a.scatterqty, --散件数量
       a.wholeqty, --整件数量
       (EXTRACT(year FROM a.credate))*12+(EXTRACT(month FROM a.credate)) as usemm
  From wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       wms_goods_lot       e,
       tpl_pub_goods_packs f,
       tpl_go_company      g
 where a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.ownergoodsid = d.ownergoodsid(+)
   and a.lotid = e.lotid(+)
   and a.goodspackid = f.goodspackid(+)
   and a.companyid = g.companyid(+)
   and exists (select 1
          from tpl_goodsowner x
         where x.goodsownerid = a.goodsownerid
           and nvl(x.innerflag, 0) = 0)
   and a.comefrom in (1,2,3)
"
"ZX_18002_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_18002_V"" (""KCRQ"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""APPROVEDOCNO"", ""DRUGFORM"", ""GOODSOWNID"", ""STORAGECONDITION"", ""LOTID"", ""LOTNO"", ""GOODSID"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""POSID"", ""POSTYPE"", ""AREAFLAG"", ""GOODSQTY"", ""USEMM"") AS 
  select a.kcrq, --库存日期
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.ownergoodsid, --货主货品ID
       d.goodsname, --货主货品名称
       d.goodstype, --货品规格
       d.tradepackname, --基本单位
       d.factname, --生产厂家
       d.prodarea, --产地
       d.approvedocno, --批准文号
       d.drugform, --剂型
       d.goodsownid, --货主原货品ID
       d.storagecondition, --存储条件
       a.lotid, --批号ID
       e.lotno, --批号
       a.goodsid, --货品主档ID
       a.goodspackid, --包装ID
       f.packname, --包装单位
       f.packsize, --包装大小
       a.posid, --货位ID
       (case
         when h.areaflag = 2 and d.storagecondition in (1, 2) then
          1
         when h.areaflag = 2 and d.storagecondition in (3, 4) then
          3
         when h.areaflag = 1 and d.storagecondition in (1, 2) then
          2
         when h.areaflag = 1 and d.storagecondition in (3, 4) then
          4
         else
          null
       end) as postype, --g.postype,--货位类型
       h.areaflag, --存放类型
       a.goodsqty, --库存数量
       (EXTRACT(year FROM a.kcrq))*12+(EXTRACT(month FROM a.kcrq)) as usemm
  from wms_st_qty_lst_bak  a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       wms_goods_lot       e,
       tpl_pub_goods_packs f,
       wms_pos_def         g,
       wms_st_area_def     h
 where a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.ownergoodsid = d.ownergoodsid(+)
   and a.lotid = e.lotid(+)
   and a.goodspackid = f.goodspackid(+)
   and a.posid = g.posid(+)
   and a.areaid = h.areaid(+)
   and exists (select 1
          from tpl_goodsowner x
         where a.goodsownerid = x.goodsownerid(+)
           and nvl(x.innerflag, 0) = 0)
"
"ZX_18003_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_18003_V"" (""RECORDID"", ""ECODE"", ""CREDATE"", ""INPUTMANID"", ""INOUTFLAG"", ""SOURCEID"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""TRADEPACKNAME"", ""GOODSENGNAME"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""COMPANYID"", ""COMPANYNAME"", ""USEMM"", ""SOURCETABLE"") AS 
  select
       aa.recordid,--电子监管码ID
       aa.ecode,--电子监管码
       aa.credate,--创建时间
       aa.inputmanid,--录入人ID
       aa.inoutflag,--出入库类型
       aa.sourceid,--来源ID
       aa.warehid,--物流中心ID
       aa.warehname,--物流中心
       aa.goodsownerid,--货主ID
       aa.goodsownername,--货主
       aa.ownergoodsid,--货主货品ID
       aa.goodsid,--货品主档ID
       aa.goodsname,--货主货品名称
       aa.goodstype,--货品规格
       aa.prodarea,--产地
       aa.factname,--生产厂家
       aa.tradepackname,--单位
       aa.goodsengname,--商品名
       aa.lotid,--批号ID
       aa.lotno,--批号
       aa.proddate,--生产日期
       aa.validdate,--有效期至
       aa.approvedocno,--批准文号
       aa.companyid,--货主单位ID
       aa.companyname,--货主单位
       aa.usemm,
       aa.sourcetable
       from (select a.recordid,--电子监管码ID
       a.ecode,--电子监管码
       a.credate,--创建时间
       a.inputmanid,--录入人ID
       a.inoutflag,--出入库类型
       a.sourceid,--来源ID
       b.warehid,--物流中心ID
       d.warehname,--物流中心
       b.goodsownerid,--货主ID
       f.goodsownername,--货主
       c.ownergoodsid,--货主货品ID
       h.waregoodsid goodsid,--货品主档ID
       h.goodsname,--货主货品名称
       h.goodstype,--货品规格
       h.prodarea,--产地
       h.factname factname,--生产厂家
       h.tradepackname,--单位
       h.goodsengname,--商品名
       null lotid,--批号ID
       null lotno,--批号
       null proddate,--生产日期
       null validdate,--有效期至
       null approvedocno,--批准文号
       b.sourcecompanyid companyid,--货主单位ID
       e.companyname,--货主单位
       (EXTRACT(year FROM a.credate))*12+(EXTRACT(month FROM a.credate)) as usemm,
       '收货采集' sourcetable
       from wms_ecode_record a,
            wms_in_order     b,
            wms_in_order_dtl c,
            tpl_warehouse d,
            tpl_go_company   e,
            tpl_goodsowner f,
            --wms_goods_lot g,
            tpl_goods h

       where a.sourceid = c.indtlid
             and b.inid=c.inid
             and b.warehid=d.warehid(+)
             and b.sourcecompanyid = e.companyid(+)
             and b.goodsownerid=f.goodsownerid(+)
             and c.ownergoodsid = h.ownergoodsid(+)
             and a.inoutflag = 0
             and a.comefrom = 1
union all
select a.recordid,--电子监管码ID
       a.ecode,--电子监管码
       a.credate,--创建时间
       a.inputmanid,--录入人ID
       a.inoutflag,--出入库类型
       a.sourceid,--来源ID
       b.warehid,--物流中心ID
       c.warehname,--物流中心
       b.goodsownerid,--货主ID
       d.goodsownername,--货主
       b.ownergoodsid,--货主货品ID
       e.waregoodsid goodsid,--货品主档ID
       e.goodsname,--货主货品名称
       e.goodstype,--货品规格
       e.prodarea,--产地
       e.factname factname,--生产厂家
       e.tradepackname,--单位
       e.goodsengname,--商品名
       b.lotid,--批号ID
       f.lotno,--批号
       f.proddate,--生产日期
       f.validdate,--有效期至
       f.approvedocno,--批准文号
       b.companyid,--货主单位ID
       g.companyname,--货主单位
       /*case a.inoutflag
            when 0 then '验收采集'
            when 1 then '出库复核'
              else null end*/
       (EXTRACT(year FROM a.credate))*12+(EXTRACT(month FROM a.credate)) as usemm,
       '验收采集' sourcetable
       from wms_ecode_record a,
            wms_st_io_doc b,
            tpl_warehouse c,
            tpl_goodsowner d,
            tpl_goods e,
            wms_goods_lot f,
            tpl_go_company g
       where a.sourceid = b.sourceid
            --((a.sourceid = b.sourceid and a.inoutflag = 0 and b.comefrom =1)
               --or (a.sourceid = b.inoutid and a.inoutflag = 1 and b.comefrom =3))
             and b.warehid = c.warehid(+)
             and b.goodsownerid = d.goodsownerid(+)
             and b.ownergoodsid = e.ownergoodsid(+)
             and b.lotid = f.lotid(+)
             and b.companyid = g.companyid(+)
             and a.inoutflag=0 --上架
             and nvl(a.comefrom,0)=0
             and b.comefrom =1

union all
select a.recordid,--电子监管码ID
       a.ecode,--电子监管码
       a.credate,--创建时间
       a.inputmanid,--录入人ID
       a.inoutflag,--出入库类型
       a.sourceid,--来源ID
       b.warehid,--物流中心ID
       c.warehname,--物流中心
       b.goodsownerid,--货主ID
       d.goodsownername,--货主
       b.ownergoodsid,--货主货品ID
       e.waregoodsid goodsid,--货品主档ID
       e.goodsname,--货主货品名称
       e.goodstype,--货品规格
       e.prodarea,--产地
       e.factname factname,--生产厂家
       e.tradepackname,--单位
       e.goodsengname,--商品名
       b.lotid,--批号ID
       f.lotno,--批号
       f.proddate,--生产日期
       f.validdate,--有效期至
       f.approvedocno,--批准文号
       b.companyid,--货主单位ID
       g.companyname,--货主单位
       (EXTRACT(year FROM a.credate))*12+(EXTRACT(month FROM a.credate)) as usemm,
       '出库复核' sourcetable
       from wms_ecode_record a,
            wms_st_io_doc b,
            tpl_warehouse c,
            tpl_goodsowner d,
            tpl_goods e,
            wms_goods_lot f,
            tpl_go_company g
       where a.sourceid = b.inoutid
             and b.warehid = c.warehid(+)
             and b.goodsownerid = d.goodsownerid(+)
             and b.ownergoodsid = e.ownergoodsid(+)
             and b.lotid = f.lotid(+)
             and b.companyid = g.companyid(+)
             and a.inoutflag=1--下架
             and nvl(a.comefrom,0)=0
             and b.comefrom = 3 --b.comefrom in(2,3)来源类型
)aa
"
"ZX_19000_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19000_V"" (""EMPLOYEENAME"", ""WMS_IN_SCATTERCOUNT"", ""WMS_IN_WHOLECOUNT"", ""WMS_IN_WHOLEQTY"", ""IWCS_IN_SCATTERCOUNT"", ""IWCS_IN_WHOLECOUNT"", ""IWCS_IN_WHOLEQTY"", ""WMS_OUT_SCATTERCOUNT"", ""WMS_OUT_WHOLECOUNT"", ""WMS_OUT_WHOLEQTY"", ""IWCS_OUT_SCATTERCOUNT"", ""IWCS_OUT_WHOLECOUNT"", ""IWCS_OUT_WHOLEQTY"", ""WMS_CHECK_SCOUNT"", ""WMS_CHECK_WCOUNT"", ""WMS_CHECK_WQTY"", ""IWCS_CHECK_SCOUNT"", ""IWCS_CHECK_WCOUNT"", ""IWCS_CHECK_WQTY"", ""WMS_REPLENISH_UP"", ""WMS_REPLENISH_DOWN"", ""WMS_MV_UP"", ""WMS_MV_DOWN"", ""IWCS_TRANSFER_SCOUNT"", ""IWCS_TRANSFER_WCOUNT"", ""IWCS_TRANSFER_WQTY"", ""IWCS_BOXTRANSFER_COUNT"", ""IWCS_GROUNDUP_COUNT"", ""IWCS_GROUNDUP_WQTY"", ""IWCS_MVOUT_SCOUNT"", ""IWCS_MVOUT_WCOUNT"", ""IWCS_MVOUT_WQTY"", ""TCM_IN_SCATTERCOUNT"", ""TCM_IN_KGQTY"", ""TCM_OUT_SCATTERCOUNT"", ""TCM_OUT_KGQTY"", ""TCM_CHECK_SQTY"", ""TCM_CHECK_KGQTY"", ""TCM_MV_UP"", ""TCM_MV_DOWN"", ""ECODEQTY"", ""TCM_MV_UP_KGQTY"", ""TCM_MV_DOWN_KGQTY"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""ISRESTDAY"") AS 
  select a.employeename, --操作人
       sum(a.wms_in_scattercount) as wms_in_scattercount, --平库上架散件条数
       sum(a.wms_in_wholecount) as wms_in_wholecount, --平库上架整件条数
       sum(a.wms_in_wholeqty) as wms_in_wholeqty, --平库上架整件件数
       sum(a.iwcs_in_scattercount) as iwcs_in_scattercount, --自动库上架散件条数
       sum(a.iwcs_in_wholecount) as iwcs_in_wholecount, --自动库上架整件条数
       sum(a.iwcs_in_wholeqty) as iwcs_in_wholeqty, --自动库上架整件件数
       sum(a.wms_out_scattercount) as wms_out_scattercount, --平库拣货散件条数
       sum(a.wms_out_wholecount) as wms_out_wholecount, --平库拣货整件条数
       sum(a.wms_out_wholeqty) as wms_out_wholeqty, --平库拣货整件件数
       sum(a.iwcs_out_scattercount) as iwcs_out_scattercount, --自动库拣货散件条数
       sum(a.iwcs_out_wholecount) as iwcs_out_wholecount, --自动库拣货整件条数
       sum(a.iwcs_out_wholeqty) as iwcs_out_wholeqty, --自动库拣货整件件数
       sum(a.wms_check_scount) as wms_check_scount, --平库复核散件条数
       sum(a.wms_check_wcount) as wms_check_wcount, --平库复核整件条数
       sum(a.wms_check_wqty) as wms_check_wqty, --平库复核整件件数
       sum(a.iwcs_check_scount) as iwcs_check_scount, --自动库复核散件条数
       sum(a.iwcs_check_wcount) as iwcs_check_wcount, --自动库复核整件条数
       sum(a.iwcs_check_wqty) as iwcs_check_wqty, --自动库复核整件件数
       sum(a.wms_replenish_up) as wms_replenish_up, --平库补货上架条数
       sum(a.wms_replenish_down) as wms_replenish_down, --平库补货下架条数
       sum(a.wms_mv_up) as wms_mv_up, --平库移位上架条数
       sum(a.wms_mv_down) as wms_mv_down, --平库移位下架条数
       sum(a.iwcs_transfer_scount) as iwcs_transfer_scount, --自动库补货移位上架散件条数
       sum(a.iwcs_transfer_wcount) as iwcs_transfer_wcount, --自动库补货移位上架整件条数
       sum(a.iwcs_transfer_wqty) as iwcs_transfer_wqty, --自动库补货移位上架整件件数
       sum(a.iwcs_boxtransfer_count) as iwcs_boxtransfer_count, --自动库倒箱条数
       sum(a.iwcs_groundup_count) as iwcs_groundup_count, --自动库地堆上架条数
       sum(a.iwcs_groundup_wqty) as iwcs_groundup_wqty, --自动库地堆上架整件件数
       sum(a.iwcs_mvout_scount) as iwcs_mvout_scount, --自动库移位出散件条数
       sum(a.iwcs_mvout_wcount) as iwcs_mvout_wcount, --自动库移位出整件条数
       sum(a.iwcs_mvout_wqty) as iwcs_mvout_wqty, --自动库移位出整件件数
       sum(a.tcm_in_scattercount) as tcm_in_scattercount, --中药上架条数
       sum(a.tcm_in_kgqty) as tcm_in_kgqty, --中药上架公斤数
       sum(a.tcm_out_scattercount) as tcm_out_scattercount, --中药拣货条数
       sum(a.tcm_out_kgqty) as tcm_out_kgqty, --中药拣货公斤数
       sum(a.tcm_check_sqty) as tcm_check_sqty, --中药复核条数
       sum(a.tcm_check_kgqty) as tcm_check_kgqty, --中药复核公斤数
       sum(a.tcm_mv_up) as tcm_mv_up, --中药移位上架条数
       sum(a.tcm_mv_down) as tcm_mv_down, --中药移位下架条数
       sum(a.ecodeqty) as ecodeqty, --电子监管码采集数
       sum(a.tcm_mv_up_kgqty) as tcm_mv_up_kgqty, --中药移位上架公斤数
       sum(a.tcm_mv_down_kgqty) as tcm_mv_down_kgqty, --中药移位下架公斤数
       (EXTRACT(year FROM a.credate)) * 12 +
       (EXTRACT(month FROM a.credate)) as usemm, --逻辑月
       EXTRACT(year FROM a.credate) as useyear, --年
       EXTRACT(month FROM a.credate) as usemonth, --月
       b.isrestday
  from wms_workload_dtl a, wms_work_calendar b
 where trunc(a.credate) = trunc(b.calendardate)
 group by a.employeename,
          EXTRACT(year FROM a.credate),
          EXTRACT(month FROM a.credate),
          b.isrestday
"
"ZX_19001_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19001_V"" (""RFFINDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INOUTID"", ""COMEFROM"", ""OPERATIONTYPE"", ""COMPANYID"", ""COMPANYNAME"", ""RFMANID"", ""RFMAN"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SECTIONID"", ""SECTIONNAME"", ""SCATTERCOUNT"", ""WHOLECOUNT"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.rffindate, --任务完成时间
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.inoutid, --出入库ID
       a.comefrom, --来源类型
       a.operationtype, --业务类型
       a.companyid, --来货单位ID
       i.companyname, --来货单位
       a.rfmanid, --任务执行人ID
       e.employeename rfman, --任务执行人
       a.ownergoodsid, --货主货品ID
       d.waregoodsid goodsid, --货品主档ID
       d.goodsownid, --货主原货品ID
       d.goodsname, --货品名称
       d.goodsengname, --商品名
       d.goodstype, --规格
       d.tradepackname, --单位
       d.factname, --生产厂家
       d.prodarea, --产地
       a.lotid, --批号ID
       f.lotno, --批号
       a.goodsqty, --数量
       a.goodspackid, --主档包装ID
       g.packname, --包装名称
       g.packsize, --包装大小
       a.sectionid, --分区ID
       h.sectionname, --分区名称
       decode(nvl(a.scatterqty, 0), 0, 0, 1) scattercount, --散件条数
       decode(nvl(a.wholeqty, 0), 0, 0, 1) wholecount, --整件条数
       a.wholeqty, --整件件数
       extract(year from a.rffindate) * 12 +
       extract(month from a.rffindate) usermm, --逻辑月
       extract(day from a.rffindate) as useday, --日
       extract(month from a.rffindate) as usemonth, --月
       extract(year from a.rffindate) as useyear --年
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       pub_employee        e,
       wms_goods_lot       f,
       tpl_pub_goods_packs g,
       wms_st_section_def  h,
       tpl_go_company      i
 where a.warehid = 1
   and a.goodsownerid not in (64, 550) --去掉海峡和燕来福货主
   and a.comefrom = 1
   and a.rfflag = 3
   and not exists (select 1
          from wms_st_section_def x
         where x.iwcs_flag = 1
           and x.sectionid = a.sectionid)
   and a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.rfmanid = e.employeeid(+)
   and a.lotid = f.lotid(+)
   and a.goodspackid = g.goodspackid(+)
   and a.sectionid = h.sectionid(+)
   and a.companyid = i.companyid
"
"ZX_19002_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19002_V"" (""RFFINDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INOUTID"", ""COMEFROM"", ""OPERATIONTYPE"", ""COMPANYID"", ""COMPANYNAME"", ""RFMANID"", ""RFMAN"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SECTIONID"", ""SECTIONNAME"", ""SCATTERCOUNT"", ""WHOLECOUNT"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.rffindate, --任务完成时间
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.inoutid, --出入库ID
       a.comefrom, --来源类型
       a.operationtype, --业务类型
       a.companyid,--出库单位ID
       i.companyname,--出库单位
       a.rfmanid, --任务执行人ID
       e.employeename rfman, --任务执行人
       a.ownergoodsid, --货主货品ID
       d.waregoodsid goodsid, --货品主档ID
       d.goodsownid, --货主原货品ID
       d.goodsname, --货品名称
       d.goodsengname, --商品名
       d.goodstype, --规格
       d.tradepackname, --单位
       d.factname, --生产厂家
       d.prodarea, --产地
       a.lotid, --批号ID
       f.lotno, --批号
       a.goodsqty, --数量
       a.goodspackid, --主档包装ID
       g.packname, --包装名称
       g.packsize, --包装大小
       a.sectionid, --分区ID
       h.sectionname, --分区名称
       decode(nvl(a.scatterqty, 0), 0, 0, 1) scattercount, --散件条数
       decode(nvl(a.wholeqty, 0), 0, 0, 1) wholecount, --整件条数
       a.wholeqty, --整件件数
       extract(year from a.rffindate) * 12 +
       extract(month from a.rffindate) usermm, --逻辑月
       extract(day from a.rffindate) as useday, --日
       extract(month from a.rffindate) as usemonth, --月
       extract(year from a.rffindate) as useyear --年
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       pub_employee        e,
       wms_goods_lot       f,
       tpl_pub_goods_packs g,
       wms_st_section_def  h,
       tpl_go_company      i
 where a.warehid = 1
   and a.goodsownerid not in (64, 550) --去掉海峡和燕来福货主
   and a.comefrom in (2,3)
   and a.rfflag = 3
   and not exists (select 1
          from wms_st_section_def x
         where x.iwcs_flag = 1
           and x.sectionid = a.sectionid)
   and a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.rfmanid = e.employeeid(+)
   and a.lotid = f.lotid(+)
   and a.goodspackid = g.goodspackid(+)
   and a.sectionid = h.sectionid(+)
   and a.companyid=i.companyid
"
"ZX_19003_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19003_V"" (""KEEPDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INOUTID"", ""COMEFROM"", ""OPERATIONTYPE"", ""COMPANYID"", ""COMPANYNAME"", ""CHECKMANID"", ""CHECKMAN"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SECTIONID"", ""SECTIONNAME"", ""SCATTERCOUNT"", ""WHOLECOUNT"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.keepdate, --复核时间
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.inoutid, --出入库ID
       a.comefrom, --来源类型
       a.operationtype, --业务类型
       a.companyid,--出库单位ID
       j.companyname,--出库单位
       a.checkmanid, --复核人ID
       e.employeename checkman, --复核人
       a.ownergoodsid, --货主货品ID
       d.waregoodsid goodsid, --货品主档ID
       d.goodsownid, --货主原货品ID
       d.goodsname, --货品名称
       d.goodsengname, --商品名
       d.goodstype, --规格
       d.tradepackname, --单位
       d.factname, --生产厂家
       d.prodarea, --产地
       a.lotid, --批号ID
       f.lotno, --批号
       a.goodsqty, --数量
       a.goodspackid, --主档包装ID
       g.packname, --包装名称
       g.packsize, --包装大小
       i.sectionid, --分区ID
       h.sectionname, --分区名称
       decode(nvl(i.scatterqty, 0), 0, 0, 1) scattercount, --散件条数
       decode(nvl(i.wholeqty, 0), 0, 0, 1) wholecount, --整件条数
       i.wholeqty, --整件件数
       extract(year from a.keepdate) * 12 +
       extract(month from a.keepdate) usermm, --逻辑月
       extract(day from a.keepdate) as useday, --月
       extract(month from a.keepdate) as usemonth, --月
       extract(year from a.keepdate) as useyear --年
  from gsp_st_io_record    a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       pub_employee        e,
       wms_goods_lot       f,
       tpl_pub_goods_packs g,
       wms_st_section_def  h,
       wms_st_io_doc       i,
       tpl_go_company      j
 where a.warehid = 1
   and a.goodsownerid not in (64, 550) --去掉海峡和燕来福货主
   and a.inoutid=i.inoutid
   and not exists (select 1
          from wms_st_section_def x
         where x.iwcs_flag = 1
           and x.sectionid = i.sectionid)
   and a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.checkmanid = e.employeeid(+)
   and a.lotid = f.lotid(+)
   and a.goodspackid = g.goodspackid(+)
   and i.sectionid = h.sectionid(+)
   and a.companyid=j.companyid
"
"ZX_19004_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19004_V"" (""RFFINDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INOUTID"", ""COMEFROM"", ""OPERATIONTYPE"", ""INOUTFLAG"", ""RFMANID"", ""RFMAN"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SECTIONID"", ""SECTIONNAME"", ""UPCOUNT"", ""DOWNCOUNT"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.rffindate, --任务完成时间
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.inoutid, --出入库ID
       a.comefrom, --来源类型
       a.operationtype,--业务类型
       a.inoutflag,--出入库类型
       a.rfmanid, --任务执行人ID
       e.employeename rfman, --任务执行人
       a.ownergoodsid, --货主货品ID
       d.waregoodsid goodsid, --货品主档ID
       d.goodsownid, --货主原货品ID
       d.goodsname, --货品名称
       d.goodsengname, --商品名
       d.goodstype, --规格
       d.tradepackname, --单位
       d.factname, --生产厂家
       d.prodarea, --产地
       a.lotid, --批号ID
       f.lotno, --批号
       a.goodsqty, --数量
       a.goodspackid, --主档包装ID
       g.packname, --包装名称
       g.packsize, --包装大小
       a.sectionid, --分区ID
       h.sectionname, --分区名称
       decode(a.inoutflag,0,1,0) upcount,--补货上架条数
       decode(a.inoutflag,1,1,0) downcount,--补货下架条数
       extract(year from a.rffindate) * 12 +
       extract(month from a.rffindate) usermm, --逻辑月
       extract(day from a.rffindate) as useday, --月
       extract(month from a.rffindate) as usemonth, --月
       extract(year from a.rffindate) as useyear --年
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       pub_employee        e,
       wms_goods_lot       f,
       tpl_pub_goods_packs g,
       wms_st_section_def  h
 where a.warehid = 1
   and a.goodsownerid not in (64, 550) --去掉海峡和燕来福货主
   and a.comefrom=4
   and a.rfflag = 3
   and not exists (select 1
          from wms_st_section_def x
         where x.iwcs_flag = 1
           and x.sectionid = a.sectionid)
   and a.operationtype=29
   and a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.rfmanid = e.employeeid(+)
   and a.lotid = f.lotid(+)
   and a.goodspackid = g.goodspackid(+)
   and a.sectionid = h.sectionid(+)
"
"ZX_19005_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19005_V"" (""RFFINDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INOUTID"", ""COMEFROM"", ""OPERATIONTYPE"", ""INOUTFLAG"", ""RFMANID"", ""RFMAN"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SECTIONID"", ""SECTIONNAME"", ""UPCOUNT"", ""DOWNCOUNT"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.rffindate, --任务完成时间
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.inoutid, --出入库ID
       a.comefrom, --来源类型
       a.operationtype,--业务类型
       a.inoutflag,--出入库类型
       a.rfmanid, --任务执行人ID
       e.employeename rfman, --任务执行人
       a.ownergoodsid, --货主货品ID
       d.waregoodsid goodsid, --货品主档ID
       d.goodsownid, --货主原货品ID
       d.goodsname, --货品名称
       d.goodsengname, --商品名
       d.goodstype, --规格
       d.tradepackname, --单位
       d.factname, --生产厂家
       d.prodarea, --产地
       a.lotid, --批号ID
       f.lotno, --批号
       a.goodsqty, --数量
       a.goodspackid, --主档包装ID
       g.packname, --包装名称
       g.packsize, --包装大小
       a.sectionid, --分区ID
       h.sectionname, --分区名称
       decode(a.inoutflag,0,1,0) upcount,--移位上架条数
       decode(a.inoutflag,1,1,0) downcount,--移位下架条数
       extract(year from a.rffindate) * 12 +
       extract(month from a.rffindate) usermm, --逻辑月
       extract(day from a.rffindate) as useday, --月
       extract(month from a.rffindate) as usemonth, --月
       extract(year from a.rffindate) as useyear --年
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       pub_employee        e,
       wms_goods_lot       f,
       tpl_pub_goods_packs g,
       wms_st_section_def  h
 where a.warehid = 1
   and a.goodsownerid not in (64, 550) --去掉海峡和燕来福货主
   and a.comefrom=4
   and a.rfflag = 3
   and not exists (select 1
          from wms_st_section_def x
         where x.iwcs_flag = 1
           and x.sectionid = a.sectionid)
   and a.operationtype=28
   and a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.rfmanid = e.employeeid(+)
   and a.lotid = f.lotid(+)
   and a.goodspackid = g.goodspackid(+)
   and a.sectionid = h.sectionid(+)
"
"ZX_19006_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19006_V"" (""RECORDID"", ""ECODE"", ""CREDATE"", ""INPUTMANID"", ""INPUTMAN"", ""INOUTFLAG"", ""SOURCEID"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""TRADEPACKNAME"", ""GOODSENGNAME"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""COMPANYID"", ""COMPANYNAME"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""USEDAY"", ""SOURCETABLE"") AS 
  select a.recordid, --电子监管码ID
       a.ecode, --电子监管码
       a.credate, --创建时间
       a.inputmanid, --录入人ID
       g.employeename inputman, --录入人
       a.inoutflag, --出入库类型
       a.sourceid, --来源ID
       b.warehid, --物流中心ID
       d.warehname, --物流中心
       b.goodsownerid, --货主ID
       f.goodsownername, --货主
       c.ownergoodsid, --货主货品ID
       h.waregoodsid goodsid, --货品主档ID
       h.goodsname, --货品名称
       h.goodstype, --货品规格
       h.prodarea, --产地
       h.factname factname, --生产厂家
       h.tradepackname, --单位
       h.goodsengname, --商品名
       null lotid, --批号ID
       null lotno, --批号
       null proddate, --生产日期
       null validdate, --有效期至
       null approvedocno, --批准文号
       b.sourcecompanyid companyid, --货主单位ID
       e.companyname, --货主单位
       (EXTRACT(year FROM a.credate)) * 12 +
       (EXTRACT(month FROM a.credate)) as usemm,--逻辑月
       EXTRACT(year FROM a.credate) as useyear,--年
       EXTRACT(month FROM a.credate) as usemonth,--月
       EXTRACT(day FROM a.credate) as useday,--日
       '收货采集' sourcetable --数据来源
  from wms_ecode_record a,
       wms_in_order     b,
       wms_in_order_dtl c,
       tpl_warehouse    d,
       tpl_go_company   e,
       tpl_goodsowner   f,
       pub_employee     g,
       tpl_goods        h
 where a.sourceid = c.indtlid
   and b.inid = c.inid
   and b.warehid = d.warehid(+)
   and b.sourcecompanyid = e.companyid(+)
   and b.goodsownerid = f.goodsownerid(+)
   and c.ownergoodsid = h.ownergoodsid(+)
   and a.inputmanid = g.employeeid(+)
   and a.inoutflag = 0
   and a.comefrom = 1
   and b.warehid = 1
union all
select a.recordid, --电子监管码ID
       a.ecode, --电子监管码
       a.credate, --创建时间
       a.inputmanid, --录入人ID
       h.employeename inputman, --录入人
       a.inoutflag, --出入库类型
       a.sourceid, --来源ID
       b.warehid, --物流中心ID
       c.warehname, --物流中心
       b.goodsownerid, --货主ID
       d.goodsownername, --货主
       b.ownergoodsid, --货主货品ID
       e.waregoodsid goodsid, --货品主档ID
       e.goodsname, --货主货品名称
       e.goodstype, --货品规格
       e.prodarea, --产地
       e.factname factname, --生产厂家
       e.tradepackname, --单位
       e.goodsengname, --商品名
       b.lotid, --批号ID
       f.lotno, --批号
       f.proddate, --生产日期
       f.validdate, --有效期至
       f.approvedocno, --批准文号
       b.companyid, --货主单位ID
       g.companyname, --货主单位
       (EXTRACT(year FROM a.credate)) * 12 +
       (EXTRACT(month FROM a.credate)) as usemm,
       EXTRACT(year FROM a.credate) as useyear,--年
       EXTRACT(month FROM a.credate) as usemonth,--月
       EXTRACT(day FROM a.credate) as useday,--日
       '验收采集' sourcetable
  from wms_ecode_record a,
       wms_st_io_doc    b,
       tpl_warehouse    c,
       tpl_goodsowner   d,
       tpl_goods        e,
       wms_goods_lot    f,
       tpl_go_company   g,
       pub_employee     h
 where a.sourceid = b.sourceid
   and b.warehid = c.warehid(+)
   and b.goodsownerid = d.goodsownerid(+)
   and b.ownergoodsid = e.ownergoodsid(+)
   and b.lotid = f.lotid(+)
   and b.companyid = g.companyid(+)
   and a.inoutflag = 0 --上架
   and nvl(a.comefrom, 0) = 0
   and b.comefrom = 1
   and a.inputmanid = h.employeeid(+)
   and b.warehid = 1
union all
select a.recordid, --电子监管码ID
       a.ecode, --电子监管码
       a.credate, --创建时间
       a.inputmanid, --录入人ID
       h.employeename inputman, --录入人
       a.inoutflag, --出入库类型
       a.sourceid, --来源ID
       b.warehid, --物流中心ID
       c.warehname, --物流中心
       b.goodsownerid, --货主ID
       d.goodsownername, --货主
       b.ownergoodsid, --货主货品ID
       e.waregoodsid goodsid, --货品主档ID
       e.goodsname, --货主货品名称
       e.goodstype, --货品规格
       e.prodarea, --产地
       e.factname factname, --生产厂家
       e.tradepackname, --单位
       e.goodsengname, --商品名
       b.lotid, --批号ID
       f.lotno, --批号
       f.proddate, --生产日期
       f.validdate, --有效期至
       f.approvedocno, --批准文号
       b.companyid, --货主单位ID
       g.companyname, --货主单位
       (EXTRACT(year FROM a.credate)) * 12 +
       (EXTRACT(month FROM a.credate)) as usemm,
       EXTRACT(year FROM a.credate) as useyear,--年
       EXTRACT(month FROM a.credate) as usemonth,--月
       EXTRACT(day FROM a.credate) as useday,--日
       '出库复核' sourcetable
  from wms_ecode_record a,
       wms_st_io_doc    b,
       tpl_warehouse    c,
       tpl_goodsowner   d,
       tpl_goods        e,
       wms_goods_lot    f,
       tpl_go_company   g,
       pub_employee     h
 where a.sourceid = b.inoutid
   and b.warehid = c.warehid(+)
   and b.goodsownerid = d.goodsownerid(+)
   and b.ownergoodsid = e.ownergoodsid(+)
   and b.lotid = f.lotid(+)
   and b.companyid = g.companyid(+)
   and a.inoutflag = 1 --下架
   and nvl(a.comefrom, 0) = 0
   and b.comefrom = 3 --b.comefrom in(2,3)来源类型
   and a.inputmanid = h.employeeid(+)
   and b.warehid = 1
   and not exists (select 1
          from wms_st_section_def x
         where x.sectionid = b.sectionid
           and x.iwcs_flag = 1)
"
"ZX_19006_WMSECODE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19006_WMSECODE_V"" (""RECORDID"", ""ECODE"", ""CREDATE"", ""INPUTMANID"", ""INPUTMAN"", ""INOUTFLAG"", ""SOURCEID"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""USEDAY"", ""SOURCETABLE"") AS 
  select a.recordid, --电子监管码ID
       a.ecode, --电子监管码
       a.credate, --创建时间
       a.inputmanid, --录入人ID
       g.employeename inputman, --录入人
       a.inoutflag, --出入库类型
       a.sourceid, --来源ID
       b.warehid, --物流中心ID
       d.warehname, --物流中心
       b.goodsownerid, --货主ID
       f.goodsownername, --货主
       b.sourcecompanyid companyid, --货主单位ID
       e.companyname, --货主单位
       (EXTRACT(year FROM a.credate)) * 12 +
       (EXTRACT(month FROM a.credate)) as usemm,--逻辑月
       EXTRACT(year FROM a.credate) as useyear,--年
       EXTRACT(month FROM a.credate) as usemonth,--月
       EXTRACT(day FROM a.credate) as useday,--日
       '收货采集' sourcetable --数据来源
  from wms_ecode_record a,
       wms_in_order     b,
       wms_in_order_dtl c,
       tpl_warehouse    d,
       tpl_go_company   e,
       tpl_goodsowner   f,
       pub_employee     g
 where a.sourceid = c.indtlid
   and b.inid = c.inid
   and b.warehid = d.warehid(+)
   and b.sourcecompanyid = e.companyid(+)
   and b.goodsownerid = f.goodsownerid(+)
   and a.inputmanid = g.employeeid(+)
   and a.inoutflag = 0
   and a.comefrom = 1
   and b.warehid = 1
union all
select a.recordid, --电子监管码ID
       a.ecode, --电子监管码
       a.credate, --创建时间
       a.inputmanid, --录入人ID
       h.employeename inputman, --录入人
       a.inoutflag, --出入库类型
       a.sourceid, --来源ID
       b.warehid, --物流中心ID
       c.warehname, --物流中心
       b.goodsownerid, --货主ID
       d.goodsownername, --货主
       b.companyid, --货主单位ID
       g.companyname, --货主单位
       (EXTRACT(year FROM a.credate)) * 12 +
       (EXTRACT(month FROM a.credate)) as usemm,
       EXTRACT(year FROM a.credate) as useyear,--年
       EXTRACT(month FROM a.credate) as usemonth,--月
       EXTRACT(day FROM a.credate) as useday,--日
       '验收采集' sourcetable
  from wms_ecode_record a,
       wms_st_io_doc    b,
       tpl_warehouse    c,
       tpl_goodsowner   d,
       wms_goods_lot    f,
       tpl_go_company   g,
       pub_employee     h
 where a.sourceid = b.sourceid
   and b.warehid = c.warehid(+)
   and b.goodsownerid = d.goodsownerid(+)
   and b.lotid = f.lotid(+)
   and b.companyid = g.companyid(+)
   and a.inoutflag = 0 --上架
   and nvl(a.comefrom, 0) = 0
   and b.comefrom = 2
   and a.inputmanid = h.employeeid(+)
   and b.warehid = 1
union all
select a.recordid, --电子监管码ID
       a.ecode, --电子监管码
       a.credate, --创建时间
       a.inputmanid, --录入人ID
       h.employeename inputman, --录入人
       a.inoutflag, --出入库类型
       a.sourceid, --来源ID
       b.warehid, --物流中心ID
       c.warehname, --物流中心
       b.goodsownerid, --货主ID
       d.goodsownername, --货主
       b.companyid, --货主单位ID
       g.companyname, --货主单位
       (EXTRACT(year FROM a.credate)) * 12 +
       (EXTRACT(month FROM a.credate)) as usemm,
       EXTRACT(year FROM a.credate) as useyear,--年
       EXTRACT(month FROM a.credate) as usemonth,--月
       EXTRACT(day FROM a.credate) as useday,--日
       '出库复核' sourcetable
  from wms_ecode_record a,
       wms_st_io_doc    b,
       tpl_warehouse    c,
       tpl_goodsowner   d,
       wms_goods_lot    f,
       tpl_go_company   g,
       pub_employee     h
 where a.sourceid = b.inoutid
   and b.warehid = c.warehid(+)
   and b.goodsownerid = d.goodsownerid(+)
   and b.lotid = f.lotid(+)
   and b.companyid = g.companyid(+)
   and a.inoutflag = 1 --下架
   and nvl(a.comefrom, 0) = 3
   and b.comefrom = 3 --b.comefrom in(2,3)来源类型
   and a.inputmanid = h.employeeid(+)
   and b.warehid = 1
   and not exists (select 1
          from wms_st_section_def x
         where x.sectionid = b.sectionid
           and x.iwcs_flag = 1)
"
"ZX_19007_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19007_V"" (""CREDATE"", ""SSC_RECEIVE_GOODS_LOCATE_ID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""INDTLID"", ""RECEIVEID"", ""SCANERID"", ""SCANER"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""OWNERPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""DTLGOODSQTY"", ""DEPOT_NAME"", ""SCATTERCOUNT"", ""WHOLECOUNT"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select c.create_timestamp as credate, --入库时间
       c.ssc_receive_goods_locate_id, --入库仓位分配ID
       a.inv_owner as goodsownerid, --货主ID
       (select aa.party_name
          from com_party@iwcs aa
         where aa.com_party_type_id = 1
           and aa.com_party_id = a.inv_owner) as goodsownername, --货主名称
       a.send_party_id as companyid, --来货单位ID
       (select dd.party_name
          from com_party@iwcs dd
         where dd.com_party_id = a.send_party_id
           and dd.com_party_type_id <> 1) as companyname, --来货单位
       b.external_bill_id as indtlid, --入库细单ID(WMS系统)
       b.external_bill_lines_id as receiveid, --验收细单ID(WMS系统)
       g.scaner as scanerid, --绑定人ID
       i.employeecode as scaner, --绑定人
       b.com_goods_id as ownergoodsid, --货主货品ID
       f.goods_name as goodsname, --货品名称
       f.english_name as goodsengname, --商品名
       f.goods_desc as goodstype, --规格
       (select cc.package_name
          from com_goods_package@iwcs cc
         where cc.com_goods_id = b.com_goods_id
           and cc.package_type = 'UNIT') as tradepackname, --单位
       (select bb.party_name
          from com_party@iwcs bb
         where bb.com_party_type_id = 4
           and bb.com_party_id = f.factory_id) as factname, --生产厂家
       f.product_location as prodarea,
       b.com_lot_id as lotid, --批号ID
       h.lot_no as lotno,--批号
       b.package_id as ownerpackid, --货主货品包装ID
       b.package_name as packname, --包装名称
       b.package_num as packsize, --包装大小
       c.locate_qty as goodsqty, --放置数量
       g.rec_qty as dtlgoodsqty, --放置明细数量
       e.depot_name, --入库区域
       decode(e.com_depot_id, 100, 0, 1) as scattercount, --散件条数
       decode(e.com_depot_id, 100, 1, 0) as wholecount, --整件条数
       decode(e.com_depot_id, 100, g.rec_qty / g.package_num, 0) as wholeqty, --整件件数
       extract(year from c.create_timestamp) * 12 +
       extract(month from c.create_timestamp) usermm, --逻辑月
       extract(day from c.create_timestamp) as useday, --月
       extract(month from c.create_timestamp) as usemonth, --月
       extract(year from c.create_timestamp) as useyear --年
  from ssc_receive_goods@iwcs a, --入库总单表
       ssc_receive_goods_lines@iwcs b, --入库细单表
       ssc_receive_goods_locate@iwcs c, --入库商品分配表
       com_stock_pos@iwcs d, --仓房货位表
       com_depot@iwcs e, --仓间资料
       com_goods@iwcs f, --货品表
       iwcs_com_inv_case_v@iwcs g,
       com_lot@iwcs h,
       sys_userlist@iwcs i
 where a.ssc_receive_goods_id = b.ssc_receive_goods_id
   and a.receive_bill_type in ('PURCHASE', 'SALE_RTN', 'TRANSFER')
   and b.ssc_receive_goods_lines_id = c.ssc_receive_goods_lines_id
   and c.stock_pos_id = d.stock_pos_id(+)
   and d.depot_id = e.com_depot_id(+)
   and b.com_goods_id = f.com_goods_id
   and c.case_nbr = g.case_nbr
   and b.com_lot_id=h.com_lot_id(+)
   and g.scaner=i.userid(+)
"
"ZX_19008_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19008_V"" (""CREDATE"", ""SSC_PICKING_CARTON_ID"", ""INOUTID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""PICKERID"", ""PICKER"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""OWNERPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""DEPOT_NAME"", ""CARTON_TYPE"", ""SCATTERCOUNT"", ""WHOLECOUNT"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.pick_time as credate, --任务完成时间
       a.ssc_picking_carton_id, --IWCS任务明细ID
       a.wms_inout_id as inoutid, --WMS出入库ID
       a.party_id as goodsownerid, --货主ID
       (select aa.party_name
          from com_party@iwcs aa
         where aa.com_party_type_id = 1
           and aa.com_party_id = a.party_id) as goodsownername, --货主名称
       a.spc_client_id as companyid, --出库单位ID
       (select bb.party_name
          from com_party@iwcs bb
         where bb.com_party_id = a.spc_client_id
           and bb.com_party_type_id <> 1) as companyname, --出库单位
       a.picker as pickerid, --拣货人ID
       c.employeecode as picker, --拣货人
       a.com_goods_id as ownergoodsid, --货主货品ID
       b.goods_name as goodsname, --货品名称
       b.english_name as goodsengname, --商品名
       b.goods_desc as goodstype, --规格
       (select cc.package_name
          from com_goods_package@iwcs cc
         where cc.com_goods_id = a.com_goods_id
           and cc.package_type = 'UNIT') as tradepackname, --单位
       (select dd.party_name
          from com_party@iwcs dd
         where dd.com_party_type_id = 4
           and dd.com_party_id = b.factory_id) as factname, --生产厂家
       b.product_location as prodarea, --产地
       a.com_lot_id as lotid, --批号ID
       d.lot_no as lotno, --批号
       a.package_id as ownerpackid, --货主货品包装ID
       a.package_name as packname, --包装名称
       a.package_num as packsize, --包装大小
       a.allocate_qty as goodsqty, --拣货数量
       f.depot_name, --出库区域
       decode(a.carton_type,
              'A',
              '零散出库',
              'C',
              '整箱出库',
              'P',
              '托盘出库',
              0) carton_type, --IWCS任务类型
       decode(a.carton_type, 'A', 1, 0) as scattercount, --散件条数
       decode(a.carton_type, 'A', 0, 1) as wholecount, --整件条数
       decode(a.carton_type, 'A', 0, a.allocate_qty / a.package_num) as wholeqty, --整件件数
       extract(year from a.pick_time) * 12 +
       extract(month from a.pick_time) usermm, --逻辑月
       extract(day from a.pick_time) as useday, --日
       extract(month from a.pick_time) as usemonth, --月
       extract(year from a.pick_time) as useyear --年
  from ssc_picking_carton@iwcs a,
       com_goods@iwcs          b,
       sys_userlist@iwcs       c,
       com_lot@iwcs            d,
       com_stock_pos@iwcs      e,
       com_depot@iwcs          f
 where a.pick_status = 'TRUE'
   and a.picker = c.userid(+)
   and a.com_goods_id = b.com_goods_id
   and a.com_lot_id = d.com_lot_id(+)
   and a.stock_pos_id = e.stock_pos_id(+)
   and e.depot_id = f.com_depot_id(+)
"
"ZX_19009_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19009_V"" (""CHECKDATE"", ""SSC_PICKING_CARTON_ID"", ""INOUTID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""CHECKERID"", ""CHECKER"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""OWNERPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""DEPOT_NAME"", ""CARTON_TYPE"", ""SCATTERCOUNT"", ""WHOLECOUNT"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.check_time as checkdate, --复核时间
       a.ssc_picking_carton_id, --IWCS任务明细ID
       a.wms_inout_id as inoutid, --WMS出入库ID
       a.party_id as goodsownerid, --货主ID
       (select aa.party_name
          from com_party@iwcs aa
         where aa.com_party_type_id = 1
           and aa.com_party_id = a.party_id) as goodsownername, --货主名称
       a.spc_client_id as companyid, --出库单位ID
       (select bb.party_name
          from com_party@iwcs bb
         where bb.com_party_id = a.spc_client_id
           and bb.com_party_type_id <> 1) as companyname, --出库单位
       a.checker as checkerid, --复核人ID
       c.employeecode as checker, --复核人
       a.com_goods_id as ownergoodsid, --货主货品ID
       b.goods_name as goodsname, --货品名称
       b.english_name as goodsengname, --商品名
       b.goods_desc as goodstype, --规格
       (select cc.package_name
          from com_goods_package@iwcs cc
         where cc.com_goods_id = a.com_goods_id
           and cc.package_type = 'UNIT') as tradepackname, --单位
       (select dd.party_name
          from com_party@iwcs dd
         where dd.com_party_type_id = 4
           and dd.com_party_id = b.factory_id) as factname, --生产厂家
       b.product_location as prodarea, --产地
       a.com_lot_id as lotid, --批号ID
       d.lot_no as lotno, --批号
       a.package_id as ownerpackid, --货主货品包装ID
       a.package_name as packname, --包装名称
       a.package_num as packsize, --包装大小
       a.allocate_qty as goodsqty, --拣货数量
       f.depot_name, --出库区域
       decode(a.carton_type,
              'A',
              '零散出库',
              'C',
              '整箱出库',
              'P',
              '托盘出库',
              0) carton_type, --IWCS任务类型
       decode(a.carton_type, 'A', 1, 0) as scattercount, --散件条数
       decode(a.carton_type, 'A', 0, 1) as wholecount, --整件条数
       decode(a.carton_type, 'A', 0, a.allocate_qty / a.package_num) as wholeqty, --整件件数
       extract(year from a.check_time) * 12 +
       extract(month from a.check_time) usermm, --逻辑月
       extract(day from a.check_time) as useday, --日
       extract(month from a.check_time) as usemonth, --月
       extract(year from a.check_time) as useyear --年
  from ssc_picking_carton@iwcs a,
       com_goods@iwcs          b,
       sys_userlist@iwcs       c,
       com_lot@iwcs            d,
       com_stock_pos@iwcs      e,
       com_depot@iwcs          f
 where a.check_status = 'TRUE'
   and a.checker = c.userid(+)
   and a.com_goods_id = b.com_goods_id
   and a.com_lot_id = d.com_lot_id(+)
   and a.stock_pos_id = e.stock_pos_id(+)
   and e.depot_id = f.com_depot_id(+)
"
"ZX_19009_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19009_V1"" (""CHECKDATE"", ""SSC_PICKING_CARTON_ID"", ""INOUTID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""CHECKERID"", ""CHECKER"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""OWNERPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""DEPOT_NAME"", ""CARTON_TYPE"", ""SCATTERCOUNT"", ""WHOLECOUNT"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.check_time as checkdate, --复核时间
       a.ssc_picking_carton_id, --IWCS任务明细ID
       a.wms_inout_id as inoutid, --WMS出入库ID
       a.party_id as goodsownerid, --货主ID
       (select aa.party_name
          from com_party@iwcs aa
         where aa.com_party_type_id = 1
           and aa.com_party_id = a.party_id) as goodsownername, --货主名称
       a.spc_client_id as companyid, --出库单位ID
       (select bb.party_name
          from com_party@iwcs bb
         where bb.com_party_id = a.spc_client_id
           and bb.com_party_type_id <> 1) as companyname, --出库单位
       a.checker as checkerid, --复核人ID
       c.employeecode as checker, --复核人
       a.com_goods_id as ownergoodsid, --货主货品ID
       b.goods_name as goodsname, --货品名称
       b.english_name as goodsengname, --商品名
       b.goods_desc as goodstype, --规格
       (select cc.package_name
          from com_goods_package@iwcs cc
         where cc.com_goods_id = a.com_goods_id
           and cc.package_type = 'UNIT') as tradepackname, --单位
       (select dd.party_name
          from com_party@iwcs dd
         where dd.com_party_type_id = 4
           and dd.com_party_id = b.factory_id) as factname, --生产厂家
       b.product_location as prodarea, --产地
       a.com_lot_id as lotid, --批号ID
       d.lot_no as lotno, --批号
       a.package_id as ownerpackid, --货主货品包装ID
       a.package_name as packname, --包装名称
       a.package_num as packsize, --包装大小
       a.allocate_qty as goodsqty, --拣货数量
       f.depot_name, --出库区域
       decode(a.carton_type,
              'A',
              '零散出库',
              'C',
              '整箱出库',
              'P',
              '托盘出库',
              0) carton_type, --IWCS任务类型
       decode(a.carton_type, 'A', 1, 0) as scattercount, --散件条数
       decode(a.carton_type, 'A', 0, 1) as wholecount, --整件条数
       decode(a.carton_type, 'A', 0, a.allocate_qty / a.package_num) as wholeqty, --整件件数
       extract(year from a.check_time) * 12 +
       extract(month from a.check_time) usermm, --逻辑月
       extract(day from a.check_time) as useday, --日
       extract(month from a.check_time) as usemonth, --月
       extract(year from a.check_time) as useyear --年
  from ssc_picking_carton_bak@iwcs a,
       com_goods@iwcs              b,
       sys_userlist@iwcs           c,
       com_lot@iwcs                d,
       com_stock_pos@iwcs          e,
       com_depot@iwcs              f
 where a.check_status = 'TRUE'
   and a.checker = c.userid(+)
   and a.com_goods_id = b.com_goods_id
   and a.com_lot_id = d.com_lot_id(+)
   and a.stock_pos_id = e.stock_pos_id(+)
   and e.depot_id = f.com_depot_id(+)
"
"ZX_19010_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19010_V"" (""CREDATE"", ""SSC_RECEIVE_GOODS_LOCATE_ID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""TRADEID"", ""TRADEDTLID"", ""SCANERID"", ""SCANER"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""OWNERPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""DEPOT_NAME"", ""SCATTERCOUNT"", ""WHOLECOUNT"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select c.create_timestamp as credate, --入库时间
       c.ssc_receive_goods_locate_id, --入库仓位分配ID
       a.inv_owner as goodsownerid, --货主ID
       (select aa.party_name
          from com_party@iwcs aa
         where aa.com_party_type_id = 1
           and aa.com_party_id = a.inv_owner) as goodsownername, --货主名称
       b.external_bill_id as tradeid, --移位总单ID(WMS系统)
       b.external_bill_lines_id as tradedtlid, --移位细单ID(WMS系统)
       g.scaner as scanerid, --绑定人ID
       i.employeecode as scaner, --绑定人
       b.com_goods_id as ownergoodsid, --货主货品ID
       f.goods_name as goodsname, --货品名称
       f.english_name as goodsengname, --商品名
       f.goods_desc as goodstype, --规格
       (select cc.package_name
          from com_goods_package@iwcs cc
         where cc.com_goods_id = b.com_goods_id
           and cc.package_type = 'UNIT') as tradepackname, --单位
       (select bb.party_name
          from com_party@iwcs bb
         where bb.com_party_type_id = 4
           and bb.com_party_id = f.factory_id) as factname, --生产厂家
       f.product_location as prodarea,
       b.com_lot_id as lotid, --批号ID
       h.lot_no as lotno,--批号
       b.package_id as ownerpackid, --货主货品包装ID
       b.package_name as packname, --包装名称
       b.package_num as packsize, --包装大小
       c.locate_qty as goodsqty, --放置数量
       e.depot_name, --入库区域
       decode(e.com_depot_id, 100, 0, 1) as scattercount, --散件移库上架条数
       decode(e.com_depot_id, 100, 1, 0) as wholecount, --整件移库上架条数
       decode(e.com_depot_id, 100, c.locate_qty / c.unit_num, 0) as wholeqty, --整件件数
       extract(year from c.create_timestamp) * 12 +
       extract(month from c.create_timestamp) usermm, --逻辑月
       extract(day from c.create_timestamp) as useday, --日
       extract(month from c.create_timestamp) as usemonth, --月
       extract(year from c.create_timestamp) as useyear --年
  from ssc_receive_goods@iwcs a,
       ssc_receive_goods_lines@iwcs b,
       ssc_receive_goods_locate@iwcs c,
       com_stock_pos@iwcs d,
       com_depot@iwcs e,
       com_goods@iwcs f,
       iwcs_com_inv_case_v@iwcs g,
       com_lot@iwcs h,
       sys_userlist@iwcs i
 where a.ssc_receive_goods_id = b.ssc_receive_goods_id
   and a.receive_bill_type in ('TRANSFERLINES')
   and b.ssc_receive_goods_lines_id = c.ssc_receive_goods_lines_id
   and c.stock_pos_id = d.stock_pos_id(+)
   and d.depot_id = e.com_depot_id(+)
   and b.com_goods_id = f.com_goods_id
   and c.case_nbr = g.case_nbr
   and b.com_lot_id=h.com_lot_id(+)
   and g.scaner=i.userid(+)
"
"ZX_19011_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19011_V"" (""TASK_ID"", ""CASE_NBR"", ""TASK_NAME"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""SCANERID"", ""SCANER"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""OWNERPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""DTLGOODSQTY"", ""COUNTQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.task_id, --任务ID
       a.case_nbr, --箱号
       b.task_name, --任务类型
       i.scan_time as credate, --任务完成时间
       c.inv_owner as goodsownerid, --货主ID
       (select aa.party_name
          from com_party@iwcs aa
         where aa.com_party_type_id = 1
           and aa.com_party_id = c.inv_owner) as goodsownername, --货主名称
       i.scaner as scanerid, --执行人ID
       d.employeecode as scaner, --执行人
       c.com_goods_id as ownergoodsid, --货主货品ID
       e.goods_name as goodsname, --货品名称
       e.english_name as goodsengname, --商品名
       e.goods_desc as goodstype, --规格
       (select bb.package_name
          from com_goods_package@iwcs bb
         where bb.com_goods_id = c.com_goods_id
           and bb.package_type = 'UNIT') as tradepackname, --单位
       (select cc.party_name
          from com_party@iwcs cc
         where cc.com_party_type_id = 4
           and cc.com_party_id = e.factory_id) as factname, --生产厂家
       e.product_location as prodarea, --产地
       c.com_lot_id as lotid, --批号ID
       f.lot_no as lotno, --批号
       c.package_id as ownerpackid, --货主货品包装ID
       c.package_name as packname, --包装名称
       c.package_num as packsize, --包装大小
       c.rec_qty as goodsqty, --倒箱数量
       i.rec_qty as dtlgoodsqty,--倒箱明细数量
       1 as countqty, --条目数
       extract(year from i.scan_time) * 12 +
       extract(month from i.scan_time) usermm, --逻辑月
       extract(day from i.scan_time) as useday, --月
       extract(month from i.scan_time) as usemonth, --月
       extract(year from i.scan_time) as useyear --年
  from wcs_task_bak@iwcs        a,
       sys_task_route@iwcs      b,
       iwcs_com_inv_case_v@iwcs c,
       sys_userlist@iwcs        d,
       com_goods@iwcs           e,
       com_lot@iwcs             f,
       com_stock_pos@iwcs       g,
       com_depot@iwcs           h,
       iwcs_com_inv_case_v@iwcs i
 where a.task_type in (2122, 2133, 2143)
   and a.task_type = b.task_type
   and b.item_no = 1
   and nvl(a.source_type,'A')<>'AutoToPlat'
   and a.case_nbr = c.case_nbr
   and i.scaner = d.userid(+)
   and c.com_goods_id = e.com_goods_id
   and c.com_lot_id = f.com_lot_id(+)
   and c.stock_pos_id = g.stock_pos_id(+)
   and g.depot_id = h.com_depot_id(+)
   and c.com_inv_case_id = i.ref_inv_case_id
   and i.ref_inv_case_id is not null
"
"ZX_19012_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19012_V"" (""TASK_ID"", ""CASE_NBR"", ""TASK_NAME"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""SCANERID"", ""SCANER"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""OWNERPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""COUNTQTY"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.task_id, --任务ID
       a.case_nbr, --箱号
       b.task_name, --任务类型
       c.upload_time as credate, --上架时间
       c.inv_owner as goodsownerid, --货主ID
       (select aa.party_name
          from com_party@iwcs aa
         where aa.com_party_type_id = 1
           and aa.com_party_id = c.inv_owner) as goodsownername, --货主名称
       c.scaner as scanerid, --执行人ID
       d.employeecode as scaner, --执行人
       c.com_goods_id as ownergoodsid, --货主货品ID
       e.goods_name as goodsname, --货品名称
       e.english_name as goodsengname, --商品名
       e.goods_desc as goodstype, --规格
       (select bb.package_name
          from com_goods_package@iwcs bb
         where bb.com_goods_id = c.com_goods_id
           and bb.package_type = 'UNIT') as tradepackname, --单位
       (select cc.party_name
          from com_party@iwcs cc
         where cc.com_party_type_id = 4
           and cc.com_party_id = e.factory_id) as factname, --生产厂家
       e.product_location as prodarea, --产地
       c.com_lot_id as lotid, --批号ID
       f.lot_no as lotno, --批号
       c.package_id as ownerpackid, --货主货品包装ID
       c.package_name as packname, --包装名称
       c.package_num as packsize, --包装大小
       c.rec_qty as goodsqty, --倒箱数量
       1 as countqty, --条目数
       c.rec_qty/c.package_num as wholeqty,--整件件数
       extract(year from c.upload_time) * 12 +
       extract(month from c.upload_time) usermm, --逻辑月
       extract(day from c.upload_time) as useday, --月
       extract(month from c.upload_time) as usemonth, --月
       extract(year from c.upload_time) as useyear --年
  from wcs_task_bak@iwcs        a,
       sys_task_route @iwcs     b,
       iwcs_com_inv_case_v@iwcs c,
       sys_userlist@iwcs        d,
       com_goods@iwcs           e,
       com_lot@iwcs             f,
       com_stock_pos@iwcs       g,
       com_depot @iwcs          h
 where a.task_type in (3212)
   and a.task_type = b.task_type
   and b.item_no = 1
   and a.case_nbr = c.case_nbr
   and c.scaner = d.userid(+)
   and c.com_goods_id = e.com_goods_id
   and c.com_lot_id = f.com_lot_id(+)
   and c.stock_pos_id = g.stock_pos_id(+)
   and g.depot_id = h.com_depot_id(+)
"
"ZX_19013_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19013_V"" (""CREDATE"", ""SSC_PICKING_CARTON_ID"", ""TRADEDTLID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CHECKERID"", ""CHECKER"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""OWNERPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""DEPOT_NAME"", ""CARTON_TYPE"", ""SCATTERCOUNT"", ""WHOLECOUNT"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.check_time as credate, --任务完成时间
       a.ssc_picking_carton_id, --IWCS任务明细ID
       a.wms_inout_id as tradedtlid, --WMS移库细单ID
       b.inv_owner_id as goodsownerid, --货主ID
       (select aa.party_name
          from com_party@iwcs aa
         where aa.com_party_type_id = 1
           and aa.com_party_id = b.inv_owner_id) as goodsownername, --货主名称
       a.checker as checkerid, --复核人ID
       c.employeecode as checker, --复核人
       a.com_goods_id as ownergoodsid, --货主货品ID
       b.goods_name as goodsname, --货品名称
       b.english_name as goodsengname, --商品名
       b.goods_desc as goodstype, --规格
       (select cc.package_name
          from com_goods_package@iwcs cc
         where cc.com_goods_id = a.com_goods_id
           and cc.package_type = 'UNIT') as tradepackname, --单位
       (select dd.party_name
          from com_party@iwcs dd
         where dd.com_party_type_id = 4
           and dd.com_party_id = b.factory_id) as factname, --生产厂家
       b.product_location as prodarea, --产地
       a.com_lot_id as lotid, --批号ID
       d.lot_no as lotno, --批号
       a.package_id as ownerpackid, --货主货品包装ID
       a.package_name as packname, --包装名称
       a.package_num as packsize, --包装大小
       a.allocate_qty as goodsqty, --拣货数量
       f.depot_name, --出库区域
       decode(a.carton_type,
              'A',
              '零散出库',
              'C',
              '整箱出库',
              'P',
              '托盘出库',
              0) carton_type, --IWCS任务类型
       decode(a.carton_type, 'A', 1, 0) as scattercount, --散件条数
       decode(a.carton_type, 'A', 0, 1) as wholecount, --整件条数
       decode(a.carton_type, 'A', 0, a.allocate_qty / a.package_num) as wholeqty, --整件件数
       extract(year from a.check_time) * 12 +
       extract(month from a.check_time) usermm, --逻辑月
       extract(day from a.check_time) as useday, --月
       extract(month from a.check_time) as usemonth, --月
       extract(year from a.check_time) as useyear --年
  from ssc_autotoplat_picking@iwcs a,
       com_goods@iwcs              b,
       sys_userlist                @iwcs c,
       com_lot@iwcs                d,
       com_stock_pos@iwcs          e,
       com_depot@iwcs              f
 where a.check_status = 'TRUE'
   and a.checker = c.userid(+)
   and a.com_goods_id = b.com_goods_id
   and a.com_lot_id = d.com_lot_id(+)
   and a.stock_pos_id = e.stock_pos_id(+)
   and e.depot_id = f.com_depot_id(+)
"
"ZX_19014_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19014_V"" (""RFFINDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INOUTID"", ""COMEFROM"", ""OPERATIONTYPE"", ""COMPANYID"", ""COMPANYNAME"", ""RFMANID"", ""RFMAN"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SECTIONID"", ""SECTIONNAME"", ""SCATTERCOUNT"", ""KGQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.rffindate, --任务完成时间
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.inoutid, --出入库ID
       a.comefrom, --来源类型
       a.operationtype, --业务类型
       a.companyid, --来货单位ID
       i.companyname, --来货单位
       a.rfmanid, --任务执行人ID
       e.employeename rfman, --任务执行人
       a.ownergoodsid, --货主货品ID
       d.waregoodsid goodsid, --货品主档ID
       d.goodsownid, --货主原货品ID
       d.goodsname, --货品名称
       d.goodsengname, --商品名
       d.goodstype, --规格
       d.tradepackname, --单位
       d.factname, --生产厂家
       d.prodarea, --产地
       a.lotid, --批号ID
       f.lotno, --批号
       a.goodsqty, --数量
       a.goodspackid, --主档包装ID
       g.packname, --包装名称
       g.packsize, --包装大小
       a.sectionid, --分区ID
       h.sectionname, --分区名称
       decode(nvl(a.scatterqty, 0), 0, 0, 1) scattercount, --散件条数
       decode(d.tradepackname,'kg',a.goodsqty,'KG',a.goodsqty,'Kg',a.goodsqty,'g',a.goodsqty/1000,0) kgqty, --公斤数
       extract(year from a.rffindate) * 12 +
       extract(month from a.rffindate) usermm, --逻辑月
       extract(day from a.rffindate) as useday, --月
       extract(month from a.rffindate) as usemonth, --月
       extract(year from a.rffindate) as useyear --年
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       pub_employee        e,
       wms_goods_lot       f,
       tpl_pub_goods_packs g,
       wms_st_section_def  h,
       tpl_go_company      i
 where a.warehid = 1
   and a.goodsownerid in (64, 550) --海峡和燕来福货主
   and a.comefrom = 1
   and a.rfflag = 3
   and not exists (select 1
          from wms_st_section_def x
         where x.iwcs_flag = 1
           and x.sectionid = a.sectionid)
   and a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.rfmanid = e.employeeid(+)
   and a.lotid = f.lotid(+)
   and a.goodspackid = g.goodspackid(+)
   and a.sectionid = h.sectionid(+)
   and a.companyid = i.companyid
"
"ZX_19015_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19015_V"" (""RFFINDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INOUTID"", ""COMEFROM"", ""OPERATIONTYPE"", ""COMPANYID"", ""COMPANYNAME"", ""RFMANID"", ""RFMAN"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SECTIONID"", ""SECTIONNAME"", ""SCATTERCOUNT"", ""KGQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.rffindate, --任务完成时间
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.inoutid, --出入库ID
       a.comefrom, --来源类型
       a.operationtype, --业务类型
       a.companyid,--出库单位ID
       i.companyname,--出库单位
       a.rfmanid, --任务执行人ID
       e.employeename rfman, --任务执行人
       a.ownergoodsid, --货主货品ID
       d.waregoodsid goodsid, --货品主档ID
       d.goodsownid, --货主原货品ID
       d.goodsname, --货品名称
       d.goodsengname, --商品名
       d.goodstype, --规格
       d.tradepackname, --单位
       d.factname, --生产厂家
       d.prodarea, --产地
       a.lotid, --批号ID
       f.lotno, --批号
       a.goodsqty, --数量
       a.goodspackid, --主档包装ID
       g.packname, --包装名称
       g.packsize, --包装大小
       a.sectionid, --分区ID
       h.sectionname, --分区名称
       decode(nvl(a.scatterqty, 0), 0, 0, 1) scattercount, --散件条数
       decode(d.tradepackname,'kg',a.goodsqty,'KG',a.goodsqty,'Kg',a.goodsqty,'g',a.goodsqty/1000,0) kgqty, --公斤数
       extract(year from a.rffindate) * 12 +
       extract(month from a.rffindate) usermm, --逻辑月
       extract(day from a.rffindate) as useday, --日
       extract(month from a.rffindate) as usemonth, --月
       extract(year from a.rffindate) as useyear --年
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       pub_employee        e,
       wms_goods_lot       f,
       tpl_pub_goods_packs g,
       wms_st_section_def  h,
       tpl_go_company      i
 where a.warehid = 1
   and a.goodsownerid in (64, 550) --海峡和燕来福货主
   and a.comefrom in (2,3)
   and a.rfflag = 3
   and not exists (select 1
          from wms_st_section_def x
         where x.iwcs_flag = 1
           and x.sectionid = a.sectionid)
   and a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.rfmanid = e.employeeid(+)
   and a.lotid = f.lotid(+)
   and a.goodspackid = g.goodspackid(+)
   and a.sectionid = h.sectionid(+)
   and a.companyid=i.companyid
"
"ZX_19016_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19016_V"" (""KEEPDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INOUTID"", ""COMEFROM"", ""OPERATIONTYPE"", ""COMPANYID"", ""COMPANYNAME"", ""CHECKMANID"", ""CHECKMAN"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SECTIONID"", ""SECTIONNAME"", ""SCATTERCOUNT"", ""KGQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.keepdate, --复核时间
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.inoutid, --出入库ID
       a.comefrom, --来源类型
       a.operationtype, --业务类型
       a.companyid,--出库单位ID
       j.companyname,--出库单位
       a.checkmanid, --复核人ID
       e.employeename checkman, --复核人
       a.ownergoodsid, --货主货品ID
       d.waregoodsid goodsid, --货品主档ID
       d.goodsownid, --货主原货品ID
       d.goodsname, --货品名称
       d.goodsengname, --商品名
       d.goodstype, --规格
       d.tradepackname, --单位
       d.factname, --生产厂家
       d.prodarea, --产地
       a.lotid, --批号ID
       f.lotno, --批号
       a.goodsqty, --数量
       a.goodspackid, --主档包装ID
       g.packname, --包装名称
       g.packsize, --包装大小
       i.sectionid, --分区ID
       h.sectionname, --分区名称
       decode(nvl(i.scatterqty, 0), 0, 0, 1) scattercount, --散件条数
       decode(d.tradepackname,'kg',a.goodsqty,'KG',a.goodsqty,'Kg',a.goodsqty,'g',a.goodsqty/1000,0) kgqty, --公斤数
       extract(year from a.keepdate) * 12 +
       extract(month from a.keepdate) usermm, --逻辑月
       extract(day from a.keepdate) as useday, --日
       extract(month from a.keepdate) as usemonth, --月
       extract(year from a.keepdate) as useyear --年
  from gsp_st_io_record    a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       pub_employee        e,
       wms_goods_lot       f,
       tpl_pub_goods_packs g,
       wms_st_section_def  h,
       wms_st_io_doc       i,
       tpl_go_company      j
 where a.warehid = 1
   and a.goodsownerid in (64, 550) --海峡和燕来福货主
   and a.inoutid=i.inoutid
   and not exists (select 1
          from wms_st_section_def x
         where x.iwcs_flag = 1
           and x.sectionid = i.sectionid)
   and a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.checkmanid = e.employeeid(+)
   and a.lotid = f.lotid(+)
   and a.goodspackid = g.goodspackid(+)
   and i.sectionid = h.sectionid(+)
   and a.companyid=j.companyid
"
"ZX_19017_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19017_V"" (""RFFINDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INOUTID"", ""COMEFROM"", ""OPERATIONTYPE"", ""INOUTFLAG"", ""RFMANID"", ""RFMAN"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SECTIONID"", ""SECTIONNAME"", ""UPCOUNT"", ""DOWNCOUNT"", ""KGQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.rffindate, --任务完成时间
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.inoutid, --出入库ID
       a.comefrom, --来源类型
       a.operationtype,--业务类型
       a.inoutflag,--出入库类型
       a.rfmanid, --任务执行人ID
       e.employeename rfman, --任务执行人
       a.ownergoodsid, --货主货品ID
       d.waregoodsid goodsid, --货品主档ID
       d.goodsownid, --货主原货品ID
       d.goodsname, --货品名称
       d.goodsengname, --商品名
       d.goodstype, --规格
       d.tradepackname, --单位
       d.factname, --生产厂家
       d.prodarea, --产地
       a.lotid, --批号ID
       f.lotno, --批号
       a.goodsqty, --数量
       a.goodspackid, --主档包装ID
       g.packname, --包装名称
       g.packsize, --包装大小
       a.sectionid, --分区ID
       h.sectionname, --分区名称
       decode(a.inoutflag,0,1,0) upcount,--移位上架条数
       decode(a.inoutflag,1,1,0) downcount,--移位下架条数
       decode(d.tradepackname,'kg',a.goodsqty,'KG',a.goodsqty,'Kg',a.goodsqty,'g',a.goodsqty/1000,0) kgqty, --公斤数
       extract(year from a.rffindate) * 12 +
       extract(month from a.rffindate) usermm, --逻辑月
       extract(day from a.rffindate) as useday, --日
       extract(month from a.rffindate) as usemonth, --月
       extract(year from a.rffindate) as useyear --年
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       pub_employee        e,
       wms_goods_lot       f,
       tpl_pub_goods_packs g,
       wms_st_section_def  h
 where a.warehid = 1
   and a.goodsownerid in (64, 550) --去掉海峡和燕来福货主
   and a.comefrom=4
   and a.rfflag = 3
   and not exists (select 1
          from wms_st_section_def x
         where x.iwcs_flag = 1
           and x.sectionid = a.sectionid)
   and a.operationtype=28
   and a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.rfmanid = e.employeeid(+)
   and a.lotid = f.lotid(+)
   and a.goodspackid = g.goodspackid(+)
   and a.sectionid = h.sectionid(+)
"
"ZX_19018_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19018_V"" (""CREDATE"", ""RECORDID"", ""DACODE"", ""INOUTID"", ""SCANERID"", ""SCANER"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""TRADEPACKNAME"", ""GOODSENGNAME"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""COMPANYID"", ""COMPANYNAME"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""USEDAY"") AS 
  select a.rffindate     as credate,--创建时间
       t.ssc_picking_carton_detail_id as recordid,--电子监管码ID
       t.dacode,--电子监管码
       t.wms_inout_id as inoutid,--出入库ID
       t.scaner        as scanerid,--录入人ID
       tt.employeecode as scaner,--录入人
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主
       a.ownergoodsid, --货主货品ID
       d.waregoodsid goodsid, --货品主档ID
       d.goodsname, --货品名称
       d.goodstype, --货品规格
       d.prodarea, --产地
       d.factname, --生产厂家
       d.tradepackname, --单位
       d.goodsengname, --商品名
       a.lotid, --批号ID
       e.lotno, --批号
       e.proddate, --生产日期
       e.validdate, --有效期至
       d.approvedocno, --批准文号
       a.companyid, --货主单位ID
       f.companyname, --货主单位
       (EXTRACT(year FROM a.rffindate)) * 12 +
       (EXTRACT(month FROM a.rffindate)) as usemm,--逻辑月
       EXTRACT(year FROM a.rffindate) as useyear,--年
       EXTRACT(month FROM a.rffindate) as usemonth,--月
       EXTRACT(day FROM a.rffindate) as useday --日
  from ssc_picking_carton_detail@iwcs t,
       sys_userlist@iwcs              tt,
       wms_st_io_doc                  a,
       tpl_warehouse                  b,
       tpl_goodsowner                 c,
       tpl_goods                      d,
       wms_goods_lot                  e,
       tpl_go_company                 f
 where t.scaner = tt.userid
   and a.inoutid = t.wms_inout_id
   and a.warehid = 1
   and a.warehid=b.warehid(+)
   and a.goodsownerid=c.goodsownerid(+)
   and a.ownergoodsid=d.ownergoodsid
   and a.lotid=e.lotid(+)
   and a.companyid=f.companyid(+)
"
"ZX_19019_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19019_V"" (""DTLID"", ""CREDATE"", ""EXECDATE"", ""EMPLOYEENAME"", ""WMS_IN_SCATTERCOUNT"", ""WMS_IN_WHOLECOUNT"", ""WMS_IN_WHOLEQTY"", ""IWCS_IN_SCATTERCOUNT"", ""IWCS_IN_WHOLECOUNT"", ""IWCS_IN_WHOLEQTY"", ""WMS_OUT_SCATTERCOUNT"", ""WMS_OUT_WHOLECOUNT"", ""WMS_OUT_WHOLEQTY"", ""IWCS_OUT_SCATTERCOUNT"", ""IWCS_OUT_WHOLECOUNT"", ""IWCS_OUT_WHOLEQTY"", ""WMS_CHECK_SCOUNT"", ""WMS_CHECK_WCOUNT"", ""WMS_CHECK_WQTY"", ""IWCS_CHECK_SCOUNT"", ""IWCS_CHECK_WCOUNT"", ""IWCS_CHECK_WQTY"", ""WMS_REPLENISH_UP"", ""WMS_REPLENISH_DOWN"", ""WMS_MV_UP"", ""WMS_MV_DOWN"", ""IWCS_TRANSFER_SCOUNT"", ""IWCS_TRANSFER_WCOUNT"", ""IWCS_TRANSFER_WQTY"", ""IWCS_BOXTRANSFER_COUNT"", ""IWCS_GROUNDUP_COUNT"", ""IWCS_GROUNDUP_WQTY"", ""IWCS_MVOUT_SCOUNT"", ""IWCS_MVOUT_WCOUNT"", ""IWCS_MVOUT_WQTY"", ""TCM_IN_SCATTERCOUNT"", ""TCM_IN_KGQTY"", ""TCM_OUT_SCATTERCOUNT"", ""TCM_OUT_KGQTY"", ""TCM_CHECK_SQTY"", ""TCM_CHECK_KGQTY"", ""TCM_MV_UP"", ""TCM_MV_DOWN"", ""ECODEQTY"", ""TCM_MV_UP_KGQTY"", ""TCM_MV_DOWN_KGQTY"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""USEDAY"", ""ISRESTDAY"") AS 
  select a.dtlid,--明细ID
       a.credate,--作业日期
       a.execdate,--生成日期
       a.employeename,--操作人
       a.wms_in_scattercount,--平库上架散件条数
       a.wms_in_wholecount,--平库上架整件条数
       a.wms_in_wholeqty,--平库上架整件件数
       a.iwcs_in_scattercount,--自动库上架散件条数
       a.iwcs_in_wholecount,--自动库上架整件条数
       a.iwcs_in_wholeqty,--自动库上架整件件数
       a.wms_out_scattercount,--平库拣货散件条数
       a.wms_out_wholecount,--平库拣货整件条数
       a.wms_out_wholeqty,--平库拣货整件件数
       a.iwcs_out_scattercount,--自动库拣货散件条数
       a.iwcs_out_wholecount,--自动库拣货整件条数
       a.iwcs_out_wholeqty,--自动库拣货整件件数
       a.wms_check_scount,--平库复核散件条数
       a.wms_check_wcount,--平库复核整件条数
       a.wms_check_wqty,--平库复核整件件数
       a.iwcs_check_scount,--自动库复核散件条数
       a.iwcs_check_wcount,--自动库复核整件条数
       a.iwcs_check_wqty,--自动库复核整件件数
       a.wms_replenish_up,--平库补货上架条数
       a.wms_replenish_down,--平库补货下架条数
       a.wms_mv_up,--平库移位上架条数
       a.wms_mv_down,--平库移位下架条数
       a.iwcs_transfer_scount,--自动库补货移位上架散件条数
       a.iwcs_transfer_wcount,--自动库补货移位上架整件条数
       a.iwcs_transfer_wqty,--自动库补货移位上架整件件数
       a.iwcs_boxtransfer_count,--自动库倒箱条数
       a.iwcs_groundup_count,--自动库地堆上架条数
       a.iwcs_groundup_wqty,--自动库地堆上架整件件数
       a.iwcs_mvout_scount,--自动库移位出散件条数
       a.iwcs_mvout_wcount,--自动库移位出整件条数
       a.iwcs_mvout_wqty,--自动库移位出整件件数
       a.tcm_in_scattercount,--中药上架条数
       a.tcm_in_kgqty,--中药上架公斤数
       a.tcm_out_scattercount,--中药拣货条数
       a.tcm_out_kgqty,--中药拣货公斤数
       a.tcm_check_sqty,--中药复核条数
       a.tcm_check_kgqty,--中药复核公斤数
       a.tcm_mv_up,--中药移位上架条数
       a.tcm_mv_down,--中药移位下架条数
       a.ecodeqty,--电子监管码采集数,
       a.tcm_mv_up_kgqty,--中药移位上架公斤数
       a.tcm_mv_down_kgqty,--中药移位下架公斤数
       (EXTRACT(year FROM a.credate)) * 12 +
       (EXTRACT(month FROM a.credate)) as usemm,--逻辑月
       EXTRACT(year FROM a.credate) as useyear,--年
       EXTRACT(month FROM a.credate) as usemonth,--月
       EXTRACT(day FROM a.credate) as useday, --日
       (select x.isrestday from wms_work_calendar x where trunc(x.calendardate)=trunc(a.credate)) as isrestday --是否休息日
  from wms_workload_dtl a
"
"ZX_19020_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19020_V"" (""CALENDARDATE"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"", ""ISWEEKEND"", ""ISRESTDAY"") AS 
  select t.calendardate, --日期
       extract(year from t.calendardate) * 12 +
       extract(month from t.calendardate) usermm, --逻辑月
       extract(day from t.calendardate) as useday, --日
       extract(month from t.calendardate) as usemonth, --月
       extract(year from t.calendardate) as useyear, --年
       t.isweekend, --是否周末
       t.isrestday --是否休息日
  from wms_work_calendar t
"
"ZX_19023_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19023_V"" (""INOUTID"", ""WAREHID"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INDTLID"", ""RECEIVEDATE"", ""CHECKDATE"", ""RFFINDATE"", ""时效"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""PACKSIZE"", ""GOODSPACKNAME"", ""LOTNO"", ""LOTID"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""STORAGECONDITION"", ""GOODSSTATUS"") AS 
  SELECT A.INOUTID, --出入库ID
       A.WAREHID, --物流中心ID
       G.CREDATE, --时间
       A.GOODSOWNERID, --货主ID
       C.GOODSOWNERNAME,
       B.INDTLID, --入库细单ID
       e.shdate as RECEIVEDATE , --收货完成时间
       B.CHECKDATE, --验收时间
       A.RFFINDATE, --上架完成时间
       TRUNC(TO_NUMBER((A.RFFINDATE - e.shdate) * 24)) 时效, --验收时间与上架完成时间之差
       B.GOODSID, --货品ID
       B.GOODSNAME, --货品名称
       B.GOODSTYPE, --规格
       B.PRODAREA, --产地
       B.PACKSIZE, --包装大小
       B.GOODSPACKNAME, --包装名称
       B.LOTNO, --批号
       B.LOTID, --批号ID
       B.GOODSQTY, --货品数量
       B.WHOLEQTY, --整件数量
       B.SCATTERQTY, --散件数量
       B.STORAGECONDITION, --存储条件
       B.GOODSSTATUS --货品状态
  FROM WMS_ST_IO_DOC     A,
       WMS_RECEIVE_DTL_V B,
       TPL_GOODSOWNER    C,
       WMS_IN_ORDER      D,
       WMS_IN_ORDER_DTL  E,
       WMS_ST_IO_DOC     G
 WHERE A.INOUTFLAG = 0 --入库
   AND A.RFFLAG = 3 --任务状态为执行完毕
   AND A.COMEFROM = 1
   AND A.AUTOTASKFLAG IS NULL
   AND A.SOURCEID = B.RECEIVEID
   AND A.GOODSOWNERID = C.GOODSOWNERID
   AND B.INDTLID = E.INDTLID
   AND D.INID = E.INID
   AND A.INOUTID=G.INOUTID
   --AND A.WAREHID = 1
"
"ZX_19024_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19024_V"" (""OUTID"", ""WAREHID"", ""TIME1"", ""CREDATE"", ""OUTDTLID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""TIME4"", ""EXPDATE"", ""时效"", ""GOODSID"", ""GOODSNAME"", ""GOODSQTY"", ""GOODSTYPE"", ""LOTID"", ""LOTNO"", ""GOODSSTATUS"", ""PACKNAME"", ""PACKSIZE"", ""GOODSCLASSNAME"") AS 
  SELECT A.OUTID, --出库订单ID
       A.WAREHID, --物流中心ID
       A.TIME1, --进入波次时间
       C.CREDATE,
       B.OUTDTLID, --细单ID
       A.GOODSOWNERID, --货主ID
       D.GOODSOWNERNAME,
       A.TIME4, --复核时间
       A.EXPDATE, --出货时间
       TRUNC(TO_NUMBER((A.TIME4 - A.CREDATE) * 24)) 时效, --订单接收时间与复核完成时间之差
       B.GOODSID,--货品ID
       B.GOODSNAME,--货品名称
       B.GOODSQTY,--出货数量
       B.GOODSTYPE,--规格
       B.LOTID,
       B.LOTNO,--批号
       B.GOODSSTATUS,--货品状态
       B.PACKNAME,--包装
       B.PACKSIZE,--包装大小
       B.GOODSCLASSNAME--货品分类
  FROM WMS_OUT_ORDER A, WMS_OUT_ORDER_DTL_V B, WMS_OUT_ORDER_V C, TPL_GOODSOWNER D
 WHERE A.OUTID = B.OUTID
   AND A.OUTID = C.OUTID
   AND A.GOODSOWNERID=D.GOODSOWNERID
   AND A.USESTATUS = 4
   --AND A.WAREHID = 1
   AND A.AUTOTASKFLAG IS NULL
   AND B.GOODSNAME NOT LIKE '%折扣%'
"
"ZX_19025_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19025_V"" (""USEYEAR"", ""USEMONTH"", ""WMS_IN_WHOLEQTY"", ""WMS_IN_WHOLECOUNT"", ""SCATTER_IN_COUNT"", ""SCATTER_IN_COUNT_EXCL_TCM_COLD"", ""TCM_IN_SCATTERCOUNT"", ""LK_IN_SCATTERCOUNT"", ""ZJ_OUT_WHOLEQTY"", ""SCOUNT"", ""SCATTER_OUT_COUNT"", ""ZY_OUT_SCATTERPACKS"", ""SCATTERPACKS"", ""TOTAL_OUT_COUNT"") AS 
  select a.useyear, --as 年,
       a.usemonth, --as 月,
       a.wms_in_wholeqty, --as 整件入库件数,
       --b.lk_in_scatterqty as 散件冷库入库件数,
       a.wms_in_wholecount, --as 整件入库条目数,
       (nvl(a.wms_in_scattercount, 0) + nvl(a.tcm_in_scattercount, 0)) as scatter_in_count, --as 散件入库条目数,
       (nvl(wms_tcm_count,0) -
       b.lk_in_scattercount - nvl(a.tcm_in_scattercount, 0) ) as scatter_in_count_excl_tcm_cold, --as 散件入库条目数不含中冷,
       a.tcm_in_scattercount, --as 中药条目数,
       b.lk_in_scattercount, --as 冷库散件入库条目数,
       f.zj_out_wholeqty, --as 整件出库件数,
       d.scount, --as 平库散件出库总件数,
       (nvl(d.scount, 0) - nvl(e.zy_out_scatterpacks, 0) -
       nvl(c.scatterpacks, 0)) as scatter_out_count, --as 散件出库件数不含中冷,
       e.zy_out_scatterpacks, --as 中药出库件数,
       c.scatterpacks, --as 冷库散件出库件数,
       (a.tcm_out_scattercount + a.wms_out_scattercount +
       a.wms_out_wholecount) as total_out_count --as 出库条目数
  From (select sum(a.wms_in_scattercount) as wms_in_scattercount, --平库上架散件条数
               sum(a.wms_in_scattercount) + sum(a.tcm_in_scattercount) as wms_tcm_count, --3
               sum(a.wms_in_wholecount) as wms_in_wholecount, --平库上架整件条数2
               sum(a.wms_in_wholeqty) as wms_in_wholeqty, --平库上架整件件数1
               sum(a.wms_out_scattercount) as wms_out_scattercount, --平库拣货散件条数
               sum(a.wms_out_wholecount) as wms_out_wholecount, --平库拣货整件条数
               sum(a.wms_out_wholeqty) as wms_out_wholeqty, --平库拣货整件件数
               sum(a.wms_check_scount) as wms_check_scount, --平库复核散件条数
               sum(a.wms_check_wcount) as wms_check_wcount, --平库复核整件条数
               sum(a.wms_check_wqty) as wms_check_wqty, --平库复核整件件数
               sum(a.tcm_in_scattercount) as tcm_in_scattercount, --中药上架条数
               sum(a.tcm_out_scattercount) as tcm_out_scattercount, --中药拣货条数
               sum(a.tcm_check_sqty) as tcm_check_sqty, --中药复核条数4
               (EXTRACT(year FROM a.credate)) * 12 +
               (EXTRACT(month FROM a.credate)) as usemm, --逻辑月
               EXTRACT(year FROM a.credate) as useyear, --年
               EXTRACT(month FROM a.credate) as usemonth --月
          from wms_workload_dtl a
         where a.EMPLOYEENAME <> '系统管理员'
           and EXTRACT(year FROM a.credate) >= EXTRACT(year FROM sysdate) -1
         group by EXTRACT(year FROM a.credate),
                  EXTRACT(month FROM a.credate)) a,
       (select count(1) as lk_in_scattercount,sum(nvl(scatterqty,0)) as lk_in_scatterqty,
               EXTRACT(year FROM a.rffindate) as get_year,
               EXTRACT(month FROM a.rffindate) as get_month
          From wms_st_io_doc_query_v a,
               wms_goods_feature_v   b,
               wms_st_section_def_v  c
         where a.goodsid = b.goodsid
           and (a.areaid <> c.areaid and a.sectionid <> c.sectionid and
               c.iwcs_flag <> 1)
           and b.GOODSCLASS in
               (39, 22, 10, 11, 12, 36, 38, 19, 32, 28, 29, 45, 49)
           and a.warehid = 1
           and b.warehid = 1
           and a.keepmanname <> '系统管理员'
           and a.comefrom = 1
           and EXTRACT(year FROM a.rffindate) >= EXTRACT(year FROM sysdate) - 1
         group by EXTRACT(year FROM a.rffindate),
                  EXTRACT(month FROM a.rffindate)) b,
       ( select sum(totalpacks) as scatterpacks, EXTRACT(year FROM a.credate) as get_year,
               EXTRACT(month FROM a.credate) as get_month
             From Tms_tr_doc_v a
        where EXTRACT(year FROM a.credate) >= EXTRACT(year FROM sysdate) -1
              and a.usestatus in(1,2,3,4,5,8)
              and nvl(a.chainflag,0) = 1
              and a.WAREHID = 1
              group by EXTRACT(year FROM a.credate),EXTRACT(month FROM a.credate)) c,
       (select count(1) as scount,
               EXTRACT(year FROM a.credate) as get_year,
               EXTRACT(month FROM a.credate) as get_month
          From Wms_box_doc_v a
         where a.boxmanopcode <> 'SYSTEM'
           and EXTRACT(year FROM a.credate) >= EXTRACT(year FROM sysdate) -1
           and a.warehid = 1
         group by EXTRACT(year FROM a.credate),
                  EXTRACT(month FROM a.credate)) d,
         ( select sum(totalpacks) as zy_out_scatterpacks , EXTRACT(year FROM a.credate) as get_year,
               EXTRACT(month FROM a.credate) as get_month
             From Tms_tr_doc_v a
        where EXTRACT(year FROM a.credate) >= EXTRACT(year FROM sysdate) -1
              --and exists(select 1 from Wms_box_doc_v b where a.sourceid = b.wavedtlid and  b.boxmanopcode <> 'SYSTEM' and b.warehid = 1) --筛选掉装箱是系统管理员
              and a.WAREHID = 1
              and a.usestatus in(1,2,3,4,5,8)
              and a.GOODSOWNERID in(550,64)
              group by EXTRACT(year FROM a.credate),EXTRACT(month FROM a.credate)) e,
       (select sum(nvl(wholeqty,0)) as zj_out_wholeqty,
         EXTRACT(year FROM a.credate) as get_year,
         EXTRACT(month FROM a.credate) as get_month
    from wms_st_io_doc_v a
   where EXTRACT(year FROM a.credate) >= EXTRACT(year FROM sysdate) -1
     and a.WAREHID = 1
     and (areaflag in (1, 0) or wholeoutflag = 1)
     and inoutflag = 1
     and comefrom in (2, 3)
     and a.sectionname not like '待验整件分区%'
   group by EXTRACT(year FROM a.credate), EXTRACT(month FROM a.credate))f
 where a.useyear = b.get_year
   and a.usemonth = b.get_month
   and a.useyear = c.get_year
   and a.usemonth = c.get_month
   and a.useyear = d.get_year
   and a.usemonth = d.get_month
   and a.useyear = e.get_year
   and a.usemonth = e.get_month
   and a.useyear = f.get_year
   and a.usemonth = f.get_month
 order by a.useyear,a.usemonth
"
"ZX_19026_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19026_DOC_V"" (""INVID"", ""CREDATE"", ""INOUTID"", ""INOUTCREADATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""MAH"", ""PRODAREA"", ""GOODSID"", ""LOTID"", ""LOTNO"", ""APPROVEDOCNO"", ""PRODDATE"", ""VALIDDATE"", ""POSID"", ""POSNO"", ""SECTIONNAME"", ""AREANAME"", ""GOODSQTY"", ""AMT"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""GOODSCLASS"", ""DDLNAME"", ""FLAG"", ""MEMO"", ""TYPES"") AS 
  select a.invid,--总单ID
       a.creadate as credate,--创建时间
       a.inoutid,--出入库ID
       a.inoutcreadate,--销售时间
       a.warehid,--物流中心ID
       d.warehname,--物流中心名称
       a.goodsownerid,--货主ID
       k.goodsownername,--货主名称
       b.ownergoodsid,--货主货品ID
       b.goodsname,--货主货品名称
       b.goodstype,--货品规格
       b.factname,--生产厂家
       b.mah,--上市持有人
       b.prodarea,--产地
       a.goodsid,--货品ID
       a.lotid,--批号ID
       e.lotno,--批号
       e.approvedocno,--批准文号
       e.proddate,--生产日期
       e.validdate,--有效期
       a.posid,--货位ID
       h.posno,--货位编码
       f.sectionname,--分区名称
       i.areaname,--库区名称
       a.goodsqty,--数量
       a.amt,--价格
       a.goodsstatusid,--货品状态ID
       wg.goodsstatus,--货品状态
       l.goodsclass,--货品分类ID
       pdd.ddlname,--货品分类
       a.flag,--0代表未处理 1代表处理
       a.memo,
       a.types--0代表在库 1代表出库
        /*CASE WHEN a.types = 0 THEN
                     '在库货品'  -- 向上取整
                WHEN a.types = 1 THEN
                     '出库货品'  -- 向上取整
              END as types*/
       from INTO_INV_DAYS_DOC a,
            Tpl_goods         b,
            tpl_pub_goods     c,
            Tpl_warehouse     d,
            wms_goods_lot     e,
            wms_pos_def       h,
            wms_st_section_def f,
            wms_st_area_def    i,
            wms_st_io_doc      g,
            Tpl_goodsowner     k,
            wms_goods_feature  L,
            pub_ddl_dtl        pdd,
            pub_ddl            pd,
            wms_goodsstatus    wg
       where a.ownergoodsid = b.ownergoodsid
             and a.goodsid = c.goodsid
             and a.warehid = d.warehid
             and a.lotid   = e.lotid
             and a.posid   = h.posid
             and h.sectionid = f.sectionid(+)
             and f.areaid = i.areaid(+)
             and a.inoutid = g.inoutid(+)
             and a.warehid = g.warehid(+)
             and a.goodsownerid = g.goodsownerid(+)
             and a.goodsownerid = k.goodsownerid
             and a.goodsid = L.Goodsid(+)
             and a.warehid = L.Warehid(+)
             and pd.keyword = 'WMS_GOODS_CLASS'
             and pd.sysid = pdd.sysid
             and l.goodsclass = pdd.ddlid
             and a.goodsstatusid = wg.goodsstatusid
"
"ZX_19026_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19026_DTL_V"" (""INVDTLID"", ""INVID"", ""GOODSOWNERID"", ""WAREHID"", ""SYGOODSQTY"", ""SAGOODSQTY"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""INVDAY"", ""CREDATE"", ""OUTBOUND_DATE"", ""INOUTTYPE"", ""INOUTID"", ""SOURCEID_INOUTID"", ""TASKID"", ""BOXDOCID"", ""INOUTFLAG"", ""COMEFROM"", ""SOURCEID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""TRADEPACKNAME"", ""PRODAREA"", ""FACTID"", ""FACTORYNAME"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""POSID"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""REALQTY"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""PRINTLINE"", ""PRINTNO"", ""KEEPDATE"", ""KEEPMANID"", ""OTHERID"", ""PACKINGFLAG"", ""RFFLAG"", ""RFFINDATE"", ""RFMANID"", ""RFMANID2"", ""PRINTFLAG"", ""PRINTMANID"", ""PRINTDATE"", ""RETRECEPTFLAG"", ""CHECKSTATUS"", ""USESTATUS"", ""CHECKMANID"", ""CHECKMAN2ID"", ""GOODSOWNID"", ""GOODSNO"", ""INOUTCREDATE"", ""MEMO"", ""OPERATIONTYPE"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""POSWAIQTY"", ""ECODEFLAG"", ""GOODSENGNAME"", ""DOWNSTATUS"", ""SALERID"", ""SALERNAME"", ""PRINT2FLAG"", ""PRINT2MANID"", ""PRINT2DATE"", ""STARTBOXNUM"", ""TOTALWHOLEPACK"", ""PRINTMOTHED"", ""INCEPTADDR"", ""TASKDTLID"", ""WHOLEOUTFLAG"", ""CHECKEDQTY"", ""WAVEDTLID"", ""INVOICENO"", ""SENDPOS"", ""MAH"", ""IWCS_CASE_NBR"") AS 
  select  a1.invdtlid,--细单ID
           a1.invid,--总单ID
           a1.goodsownerid,--货主ID
           a1.warehid,--物流中心ID
           a1.ingoodsqty as sygoodsqty,--剩余数量
           a1.outgoodsqty as sagoodsqty,--销售数量
           a.ingoodsqty,--入库数量
           a.outgoodsqty,
           /*CASE WHEN inouttype = 0 THEN
                     CEIL(a1.credate - a.keepdate)  -- 向上取整
                WHEN inouttype = 1 THEN
                     CEIL(a1.outbound_date - a.keepdate)+1  -- 向上取整
              END invday,*/--在库天数,不足一天按一天计算
           CASE
              WHEN inouttype = 0 THEN
                   TRUNC(a1.credate) - TRUNC(a.keepdate)+1  -- 入库天数（按自然日计算）
              WHEN inouttype = 1 THEN
                   TRUNC(a1.outbound_date) - TRUNC(a.keepdate)  -- 出库天数（按自然日计算）
           END invday,
           a1.credate,--创建时间
             CASE WHEN inouttype = 0 THEN
                     null  -- 向上取整
                WHEN inouttype = 1 THEN
                     a1.outbound_date  -- 向上取整
              END as outbound_date,--销售时间
           a1.inouttype,--0代表在库，1代表出库
           a1.inoutid,--出入库ID
           a1.sourceid_inoutid,--来源ID
           a.taskid,
           a.boxdocid,
           a.inoutflag,
           a.comefrom,
           a.sourceid,
           b.warehname,
           a.ownergoodsid,
           a.goodsid,
           p.goodsname,
           p.goodstype,
           a.goodspackid,
           d.packname,
           d.packsize,
           p.tradepackname,
           p.prodarea,
           c.factid,
           p.factname factoryname,
           a.batchno,
           a.lotid,
           e.lotno,
           e.proddate,
           decode(to_char(e.validdate, 'yyyy-mm-dd'),
                  '2099-01-01',
                  to_date(null, 'yyyy-mm-dd'),
                  e.validdate) validdate,
           e.approvedocno,
           a.posid,
           a.goodsstatusid,
           g.goodsstatus,
           g.quantitystatus,
           a.realqty,
           a.goodsqty,
           a.wholeqty,
           a.scatterqty,
           a.printline,
           a.printno,
           a.keepdate,
           a.keepmanid,
           a.otherid,
           a.packingflag,
           a.rfflag,
           a.rffindate,
           a.rfmanid,
           a.rfmanid2,
           a.printflag,
           a.printmanid,
           a.printdate,
           a.retreceptflag,
           nvl(a.checkstatus,0)checkstatus,
           nvl(a.usestatus, 0) usestatus,
           a.checkmanid,
           a.checkman2id,
           p.goodsownid,
           p.goodsno,
           a.credate as inoutcredate,
           a.memo,
           a.operationtype,
           o.goodsownername,
           a.companyid,
           q.companyname,
           Null POSWAIQTY,
           p.ecodeflag,
           p.goodsengname,
           nvl(a.downstatus,0) downstatus,
           aa.salerid,
           aa.salername,
           nvl(a.print2flag,0) print2flag,
           a.print2manid,
           a.print2date,
           a.startboxnum,
           a.totalwholepack,
           a.printmothed,
           t2.inceptaddr,
           a.taskdtlid,
           a.wholeoutflag,
           a.checkedqty,
           cc.wavedtlid,--add by xyue 2017-05-03
           bb.invoiceno, --发票号码，xyue 2014-05-03
           t2.sendpos,
           e.mah, --add by xyue 2019-12-05
           a.iwcs_case_nbr-- add by xyue IWCS箱号
       from  INTO_INV_DAYS_DTL a1,
             wms_st_io_doc       a,
             tpl_warehouse       b,
             tpl_pub_goods_packs d,
             tpl_pub_goods       c,
             wms_goods_lot       e,
             wms_goodsstatus     g,
             tpl_pub_company     l,
             tpl_goods           p,
             tpl_goodsowner      o,
             tpl_go_company      q,
             wms_out_order aa,
             wms_out_order_dtl bb,
             wms_wave_goods_dtl cc, --add by xyue 2017-05-03
             wms_transport_address t2
       where a1.inoutid = a.inoutid
         and a1.warehid = a.warehid
         and a1.goodsownerid = a.goodsownerid
         and a.warehid = b.warehid(+)
         and a.goodspackid = d.goodspackid(+)
         and a.goodsid = c.goodsid(+)
         and c.factid = l.companyid(+)
         and a.lotid = e.lotid(+)
         and a.goodsstatusid = g.goodsstatusid(+)
         and a.ownergoodsid = p.ownergoodsid(+)
         and a.goodsownerid = o.goodsownerid(+)
         and a.companyid = q.companyid(+)
         AND a.sourceid = bb.wavegoodsdtlid(+)
         and bb.outid  = aa.outid(+)
         and aa.transid = t2.transid(+)
         and a.sourceid = cc.wavegoodsdtlid(+)
"
"ZX_19101_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19101_V"" (""CREDATE"", ""KEEPDATE"", ""SOURCECOMPANYID"", ""SRCCOMPANYNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INDTLID"", ""OWNERGOODSID"", ""ELECTRONIC_LEDGER_NO"", ""DECLARATION_NO"", ""VERIFIED_LIST_NO"", ""TRADE_MODE"", ""POSNO"", ""GOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""FACTNAME"", ""PRODAREA"", ""APPROVEDOCNO"", ""MAH"", ""ORIGIN_COUNTRY"", ""TRADEGOODSPACK"", ""TRADEGOODSQTY"", ""PRICE"", ""TOTAL"", ""CURRENCY"", ""INID"", ""LOTNO"", ""LOTID"", ""PRODDATE"", ""VALIDDATE"", ""TRANSMODEID"", ""TRANSMODE"") AS 
  select a.credate,--订单时间
       f.keepdate, --记账时间
       b.gcompanyid as sourcecompanyid, --供货（提货）企业ID,
       b.companyname srccompanyname, --供货（提货）企业名称
       c.goodsownerid,--货主id
       j.goodsownername,--货主名称
       c.indtlid, --货物自然序号
       d.goodsno as ownergoodsid, --商品料号
       a.srcno as electronic_ledger_no, -- '电子账册项号',
       a.zxcolumn4 as declaration_no, -- 报关单号,
       a.porderno as verified_list_no, -- 核注清单号,
       a.trademode as trade_mode, --贸易方式
       g.posno, --仓位号
       d.goodsownid as goodsid, --商品编码,
       d.goodsname, --商品名称,
       d.goodsengname,--商品名
       d.goodstype, --规格,
       d.factname,--生产厂家
       d.prodarea,--产地
       d.approvedocno,--批准文号
       d.mah,--上市许可持有人
       d.prodarea as origin_country, --原产国
       d.tradepackname tradegoodspack, --计量单位
       f.ingoodsqty tradegoodsqty, --交易数量
       c.price, --单价
       nvl(c.price, 0) * nvl(f.ingoodsqty, 0) total, --总价
       c.currency, --币种
       a.inid, --入库id
       c.lotno, --批号
       c.lotid, --批号ID
       to_char(c.proddate,'yyyy-mm-dd') as  proddate,--生产日期
       to_char(c.validdate,'yyyy-mm-dd') as validdate, --有效期
       a.transtoolno as transmodeid, --运输方式ID
       a.transtool as transmode --运输方式
  from wms_in_order       a, --总单
       tpl_go_company     b, --货主单位信息
       wms_in_order_dtl   c, --细单
       tpl_goods          d, --货品表
       wms_receive_dtl    e, --验收细单
       wms_st_io_doc      f, --出入库表
       wms_pos_def        g,
       tpl_pub_goods      h,
       tpl_goodsowner     j,--货主表
       wms_transport_mode i --运输方式
 where a.inid = c.inid
   and c.goodsownerid = j.goodsownerid
   and a.sourcecompanyid = b.companyid(+)
   and c.ownergoodsid = d.ownergoodsid
   and c.indtlid = e.indtlid(+)
   and e.receiveid = f.sourceid(+)
   and f.posid = g.posid(+)
   and a.transmodeid = i.transmodeid(+)
   and d.Waregoodsid = h.goodsid(+)
   and a.warehid = 1
   and f.comefrom = 1
   and a.goodsownerid = 9149
"
"ZX_19102_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19102_V"" (""CREDATE"", ""KEEPDATE"", ""WAVEID"", ""RECCOMPANYID"", ""RECCOMPANYNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OUTDTLID"", ""OWNERGOODSID"", ""ELECTRONIC_LEDGER_NO"", ""DECLARATION_NO"", ""VERIFIED_LIST_NO"", ""TRADE_MODE"", ""POSNO"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""ORIGIN_COUNTRY"", ""TRADEGOODSPACK"", ""TRADEGOODSQTY"", ""PRICE"", ""TOTAL"", ""CURRENCY"", ""OUTID"", ""LOTNO"", ""LOTID"", ""APPROVEDOCNO"", ""PRODDATE"", ""L_PERIOD"", ""MAH"", ""TRANSMODEID"", ""TRANSMODE"") AS 
  select
       a.credate,--订单时间
       e.keepdate, --记账时间
       a.warehid waveid,
       a.reccompanyid, --'供货（提货）企业ID',
       b.companyname  reccompanyname, --'供货（提货）企业名称'
       a.goodsownerid,
       j.goodsownername,
       c.outdtlid, --货物自然序号
       c.ownergoodsid, --商品料号
       null           as electronic_ledger_no, -- '电子账册项号',
       null           as declaration_no, -- 报关单号,
       null           as verified_list_no, -- 核注清单号,
       null           as trade_mode, --贸易方式
       k.posno, --仓位号
       c.goodsid, --商品编码
       d.goodsname, --商品名称
       d.goodstype, --规格
       null           as origin_country, --原产国
       --d.factname as '生产厂家'
       c.tradegoodspack, --计量单位
       e.outgoodsqty tradegoodsqty, --交易数量
       c.price, --单价
       nvl(c.price, 0) * nvl(e.outgoodsqty, 0) total, --总价
       null as Currency, --币种
       a.outid, --出库id
       c.lotno, --批号
       c.lotid, --批号ID
       d.approvedocno, --批准文号
      decode(to_char(l.proddate, 'yyyy-mm-dd'),
              '1900-01-01',
              to_date(null, 'yyyy-mm-dd'),
              l.proddate) proddate, --生产日期
       h.l_period, --有效期
       d.mah, --上市持有人
       a.transmodeid, --运输工具ID
       i.transmode --运输工具
          from wms_out_order         a, --总单
               tpl_go_company        b, --货主单位信息
               wms_out_order_dtl     c, --细单
               tpl_goods             d, --货品表
               wms_st_io_doc         e, --出入库表
               wms_wave_goods_dtl    f, --波次分配细单
               wms_out_order_lot_dtl g,
               tpl_pub_goods         h,
               wms_pos_def           k,
               tpl_goodsowner        j,
               wms_goods_lot         l,
               wms_transport_mode    i --运输方式
         where a.outid = c.outid
           and a.goodsownerid = j.goodsownerid
           and a.reccompanyid = b.companyid(+)
           and c.ownergoodsid = d.ownergoodsid
           and a.transmodeid = i.transmodeid(+)
           and c.outdtlid = g.outdtlid(+)
           and c.lotid = l.lotid(+)
           and g.wavegoodsdtlid = f.wavegoodsdtlid(+)
           and f.wavegoodsdtlid = e.sourceid(+)
           and d.Waregoodsid = h.goodsid(+)
           and e.posid = k.posid(+)
           and e.comefrom in (2, 3)
           and a.warehid = 1
           and a.goodsownerid = 9149
"
"ZX_19103_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19103_V"" (""INOUTID"", ""INOUTFLAG"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""FACTNAME"", ""TRADEPACKNAME"", ""PRODAREA"", ""APPROVEDOCNO"", ""MAH"", ""UDI_CODE"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""GOODSQTY"", ""CREDATE"", ""KEEPDATE"", ""RFFINDATE"", ""ORDERDTLID"", ""ELECTRONIC_LEDGER_NO"", ""DECLARATION_NO"", ""VERIFIED_LIST_NO"", ""TRADE_MODE"", ""ORIGIN_COUNTRY"") AS 
  select a.inoutid,
       decode(a.inoutflag,0,'入库','出库') inoutflag, --出入库标志
       a.warehid,
       b.warehname,
       a.goodsownerid,
       f.goodsownername,
       a.companyid, --供货（提货）企业ID
       h.companyname, --供货（提货）企业名称
       a.ownergoodsid, --商品料号
       c.waregoodsid as goodsid, --商品编号
       c.goodsownid,
       c.goodsname, --商品名称
       c.goodsengname,
       c.goodstype, --规格
       c.factname,
       c.tradepackname,
       c.prodarea,
       c.approvedocno,
       c.mah,
       c.udi_code,
       a.goodspackid,
       d.packname,
       d.packsize,
       a.lotid,
       e.lotno,
        case when a.comefrom = 1     then j.proddate
            when a.comefrom in(2,3) then decode(to_char(e.proddate, 'yyyy-mm-dd'),
              '1900-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.proddate) end as proddate,
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              null,
              to_char(e.validdate, 'yyyy-mm-dd')) as validdate,
       a.goodsstatusid,
       g.goodsstatus,
       g.quantitystatus,
       a.goodsqty,
       a.credate,
       a.keepdate, --出入库时间
       a.rffindate,
       case when a.comefrom = 1     then j.indtlid
            when a.comefrom in(2,3) then n.outdtlid end as orderdtlid, --货物自然序号
       k.srcno as electronic_ledger_no, -- '电子账册项号',
       k.zxcolumn4 as declaration_no, -- 报关单号,
       k.porderno as verified_list_no, -- 核注清单号,
       k.trademode as trade_mode, --贸易方式
       l.prodarea as origin_country --原产国
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_goods           c,
       tpl_pub_goods_packs d,
       wms_goods_lot       e,
       tpl_goodsowner      f,
       wms_goodsstatus     g,
       tpl_go_company      h,
       wms_receive_dtl     i,
       wms_in_order_dtl    j,
       wms_in_order        k,
       tpl_goods           l,
       wms_out_order_lot_dtl m,
       wms_out_order_dtl n
 where a.warehid = b.warehid(+)
   and a.ownergoodsid = c.ownergoodsid
   and a.goodspackid = d.goodspackid
   and a.lotid = e.lotid(+)
   and a.goodsownerid = f.goodsownerid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.companyid = h.companyid(+)
   and a.sourceid = i.receiveid(+)
   and i.indtlid = j.indtlid(+)
   and j.inid = k.inid(+)
   and j.ownergoodsid = l.ownergoodsid(+)
   and a.sourceid = m.wavegoodsdtlid(+)
   and m.outdtlid = n.outdtlid(+)
   and a.warehid = 1
   and a.goodsownerid = 9149
   and a.comefrom in (1,2,3)
"
"ZX_19104_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19104_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""APPROVEDOCNO"", ""MAH"", ""UDI_CODE"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""POSID"", ""POSNO"", ""AREAID"", ""AREANAME"", ""SECTIONID"", ""SECTIONNAME"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""DIFFDA"") AS 
  select a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.ownergoodsid,
       d.waregoodsid as goodsid,
       d.goodsownid,
       d.goodsname,
       d.goodsengname,
       d.goodstype,
       d.tradepackname,
       d.factname,
       d.prodarea,
       d.approvedocno,
       d.mah,
       d.udi_code,
       a.goodsqty,
       a.goodspackid,
       e.packname,
       e.packsize,
       a.posid,
       h.posno,
       j.areaid,
       j.areaname,
       i.sectionid,
       i.sectionname,
       a.lotid,
       f.lotno,
       decode(to_char(f.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              f.validdate) validdate,
       f.proddate,
       a.goodsstatusid,
       g.goodsstatus,
       g.quantitystatus,
       pf_process_bsc_data(a.ownergoodsid,a.posid,a.lotid) as diffda
  from wms_st_qty_lst      a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       tpl_pub_goods_packs e,
       wms_goods_lot       f,
       wms_goodsstatus     g,
       wms_pos_def         h,
       wms_st_section_def  i,
       wms_st_area_def     j
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.goodspackid = e.goodspackid(+)
   and a.posid = h.posid
   and h.sectionid = i.sectionid
   and h.areaid = j.areaid
   and a.lotid = f.lotid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.warehid = 1
   and a.goodsownerid = 9149
"
"ZX_19105_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19105_V"" (""SEQID"", ""CREDATE"", ""INPUTMANID"", ""CONFIRMMANID"", ""CONFIRMDATE"", ""REBACKMANID"", ""REBACKDATE"", ""USESTATUS"", ""PRE_ENTRY_UNIFIED_NO"", ""LIST_NO"", ""LIST_TYPE"", ""MANUAL_ACCOUNT_BOOK_NO"", ""OPERATING_UNIT_CODE"", ""JYDWSHXY_CODE"", ""OPERATING_UNIT_NAME"", ""PROCESSING_UNIT_CODE"", ""JGDWSHXY_CODE"", ""PROCESSING_UNIT_NAME"", ""DECLARING_UNIT_CODE"", ""SBDWSHXY_CODE"", ""SBDW_NAME"", ""ENTRY_UNIT_CODE"", ""LRDWSHXY_CODE"", ""ENTRY_UNIT_NAME"", ""ENTRY_DATE"", ""LIST_DECLARATION_DATE"", ""LIST_ENTRY_EXIT_GATE_STATUS"", ""DEDUCTION_FLAG"", ""ENTERPRISE_INTERNAL_NO"", ""ENTRY_CUSTOMS_TYPE"", ""COMPETENT_CUSTOMS"", ""SHIPMENT_COUNTRY_REGION"", ""MATERIALS_FINISHED_FLAG"", ""SUPERVISION_MODE"", ""TRANSPORTATION_MODE"", ""DECLARATION_FORM_NO"", ""CIRCULATION_TYPE"", ""CUSTOMS_DECLARATION_INDICATOR"", ""CUSTOMS_DECLARATION_TYPE"", ""CUSTOMS_DECLARATION_FORM_TYPE"", ""ASSOCIATED_LIST_ID"", ""GLSCBA_NO"", ""DYBGD_ID"", ""DYBGSBDW_CODE"", ""DYBGSBDWSHXY_CODE"", ""DYBGSBDW_NAME"", ""GLBGDSB_DATE"", ""GLBGDJNSFHR_CODE"", ""GLBGDJNSFHRSHXY_CODE"", ""GLBGDJNSFHR_NAME"", ""GLBGDSCXSDW_CODE"", ""GLBGDSCXSSHXY_CODE"", ""GLBGDSCXSDW_NAME"", ""GLBGDSBDW_CODE"", ""OPERATOR_CARD_NO"", ""MEMO"", ""SEQDTLID"", ""CUSTOMS_DECLARATION_CODE"", ""PRODUCT_SERIAL_NUMBER"", ""CUSTOMS_PRODUCT_SERIAL_NUMBER"", ""RECORD_NUMBER"", ""PRODUCT_PART_NUMBER"", ""PRODUCT_CODE"", ""PRODUCT_NAME"", ""SPECIFICATION_MODEL"", ""ORIGIN_COUNTRY"", ""FINAL_DESTINATION_COUNTRY"", ""DECLARED_MEASUREMENT_UNIT"", ""DECLARED_QUANTITY"", ""DECLARED_TOTAL_PRICE"", ""DECLARED_PRICE"", ""CURRENCY"", ""LEGAL_QUANTITY"", ""LEGAL_MEASUREMENT_UNIT"", ""SECOND_LEGAL_QUANTITY"", ""SECOND_LEGAL_MEASUREMENT_UNIT"", ""LEVY_EXEMPTION_METHOD"", ""UNIT_VERSION"", ""AUTOMATIC_RECORD_NUMBER"", ""HAZARDOUS_CHEMICALS_FLAG"", ""KEY_PRODUCT_FLAG"") AS 
  select
      a.SEQID,--总单ID
      a.CREDATE,--制单日期
      a.INPUTMANID,--录入人ID
      a.CONFIRMMANID,--确认人ID
      a.CONFIRMDATE,--确定日期
      a.REBACKMANID,--回退人ID
      a.REBACKDATE,--回退日期
      a.USESTATUS,--状态
      a.PRE_ENTRY_UNIFIED_NO,--预录入统一编号
      a.LIST_NO,--清单编号
      a.LIST_TYPE,--清单类型
      a.MANUAL_ACCOUNT_BOOK_NO,--手（账）册编号
      a.OPERATING_UNIT_CODE,--经营单位编码
      a.JYDWSHXY_CODE,--经营单位社会信用代码
      a.OPERATING_UNIT_NAME,--经营单位名称
      a.PROCESSING_UNIT_CODE,--加工单位编码
      a.JGDWSHXY_CODE,--加工单位社会信用代码
      a.PROCESSING_UNIT_NAME,--加工单位名称
      a.DECLARING_UNIT_CODE,--申报单位编码
      a.SBDWSHXY_CODE,--申报单位社会信用代码
      a.SBDW_NAME,--申报单位名称
      a.ENTRY_UNIT_CODE,--录入单位编码
      a.LRDWSHXY_CODE,--录入单位社会信用代码
      a.ENTRY_UNIT_NAME,--录入单位名称
      a.ENTRY_DATE,--录入日期
      a.LIST_DECLARATION_DATE,--清单申报日期
      a.LIST_ENTRY_EXIT_GATE_STATUS,--清单进出卡口状态
      a.DEDUCTION_FLAG,--核扣标志
      a.ENTERPRISE_INTERNAL_NO,--企业内部编号
      a.ENTRY_CUSTOMS_TYPE,--进境关别
      a.COMPETENT_CUSTOMS,--主管海关
      a.SHIPMENT_COUNTRY_REGION,--启运国（地区）
      a.MATERIALS_FINISHED_FLAG,--料件、成品标志
      a.SUPERVISION_MODE,--监管方式
      a.TRANSPORTATION_MODE,--运输方式
      a.DECLARATION_FORM_NO,--申报表编号
      a.CIRCULATION_TYPE,--流转类型
      a.CUSTOMS_DECLARATION_INDICATOR,--报关标志
      a.CUSTOMS_DECLARATION_TYPE,--报关类型
      a.CUSTOMS_DECLARATION_FORM_TYPE,--报关单类型
      a.ASSOCIATED_LIST_ID,--关联清单编号
      a.GLSCBA_NO,--关联手（账）册备案号
      a.DYBGD_ID,--对应报关单编号
      a.DYBGSBDW_CODE,--对应报关申报单位代码
      a.DYBGSBDWSHXY_CODE,--对应报关申报单位社会信用代码
      a.DYBGSBDW_NAME,--对应报关申报单位名称
      a.GLBGDSB_DATE,--关联报关单申报日期
      a.GLBGDJNSFHR_CODE,--关联报关单境内收发货人编码
      a.GLBGDJNSFHRSHXY_CODE,--关联报关单境内手法货人社会信用代码
      a.GLBGDJNSFHR_NAME,--关联报关单境内收发货人名称
      a.GLBGDSCXSDW_CODE,--关联报关单生产销售（消费使用）单位编码
      a.GLBGDSCXSSHXY_CODE,--关联报关单生产销售（消费使用）社会信用代码
      a.GLBGDSCXSDW_NAME,--关联报关单生产销售（消费使用）单位名称
      a.GLBGDSBDW_CODE,--关联报关单申报单位编码
      a.OPERATOR_CARD_NO,--操作员卡号
      a.memo,   --备注
      b.SEQDTLID,--细单ID
      b.CUSTOMS_DECLARATION_CODE,--报关单统一编码
      b.PRODUCT_SERIAL_NUMBER,--商品序号
      b.CUSTOMS_PRODUCT_SERIAL_NUMBER,--报关单商品序号
      b.RECORD_NUMBER,--备案序号
      b.PRODUCT_PART_NUMBER,--商品料号
      b.PRODUCT_CODE,--商品编码
      b.PRODUCT_NAME,--商品名称
      b.SPECIFICATION_MODEL,--规格型号
      b.ORIGIN_COUNTRY,--原产国（地区）
      b.FINAL_DESTINATION_COUNTRY,--最终目的国（地区）
      b.DECLARED_MEASUREMENT_UNIT,--申报计量单位
      b.DECLARED_QUANTITY,--申报数量
      b.DECLARED_TOTAL_PRICE,--申报总价
      b.DECLARED_PRICE,--申报单价
      b.CURRENCY,--币制
      b.LEGAL_QUANTITY,--法定数量
      b.LEGAL_MEASUREMENT_UNIT,--法定计量单位
      b.SECOND_LEGAL_QUANTITY,--第二法定数量
      b.SECOND_LEGAL_MEASUREMENT_UNIT,--法定第二计量单位
      b.LEVY_EXEMPTION_METHOD,--征免方式
      b.UNIT_VERSION,--单耗版本号
      b.AUTOMATIC_RECORD_NUMBER,--自动备案序号
      b.HAZARDOUS_CHEMICALS_FLAG,--危化品标识
      b.KEY_PRODUCT_FLAG --重点商品标志
      from bond_warehouse_inorder a,bond_warehouse_inorderdtl b
           where a.seqid = b.seqid
            and a.usestatus = 1
"
"ZX_19106_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19106_V"" (""OUTSEQDTLID"", ""OUTSEQID"", ""SEQDTLID"", ""GOODSQTY"", ""SEQID"", ""CUSTOMS_DECLARATION_CODE"", ""PRODUCT_SERIAL_NUMBER"", ""CUSTOMS_PRODUCT_SERIAL_NUMBER"", ""RECORD_NUMBER"", ""PRODUCT_PART_NUMBER"", ""PRODUCT_CODE"", ""PRODUCT_NAME"", ""SPECIFICATION_MODEL"", ""ORIGIN_COUNTRY"", ""FINAL_DESTINATION_COUNTRY"", ""DECLARED_MEASUREMENT_UNIT"", ""DECLARED_TOTAL_PRICE"", ""DECLARED_PRICE"", ""CURRENCY"", ""LEGAL_MEASUREMENT_UNIT"", ""SECOND_LEGAL_MEASUREMENT_UNIT"", ""LEVY_EXEMPTION_METHOD"", ""UNIT_VERSION"", ""AUTOMATIC_RECORD_NUMBER"", ""HAZARDOUS_CHEMICALS_FLAG"", ""KEY_PRODUCT_FLAG"", ""CREDATE"", ""INPUTMANID"", ""INPUTMAN"", ""CONFIRMMANID"", ""CONFIRMDATE"", ""REBACKMANID"", ""REBACKDATE"", ""USESTATUS"", ""PRE_ENTRY_UNIFIED_NO"", ""LIST_NO"", ""LIST_TYPE"", ""MANUAL_ACCOUNT_BOOK_NO"", ""OPERATING_UNIT_CODE"", ""JYDWSHXY_CODE"", ""OPERATING_UNIT_NAME"", ""PROCESSING_UNIT_CODE"", ""JGDWSHXY_CODE"", ""PROCESSING_UNIT_NAME"", ""DECLARING_UNIT_CODE"", ""SBDWSHXY_CODE"", ""SBDW_NAME"", ""ENTRY_UNIT_CODE"", ""LRDWSHXY_CODE"", ""ENTRY_UNIT_NAME"", ""ENTRY_DATE"", ""LIST_DECLARATION_DATE"", ""LIST_ENTRY_EXIT_GATE_STATUS"", ""DEDUCTION_FLAG"", ""ENTERPRISE_INTERNAL_NO"", ""ENTRY_CUSTOMS_TYPE"", ""COMPETENT_CUSTOMS"", ""SHIPMENT_COUNTRY_REGION"", ""MATERIALS_FINISHED_FLAG"", ""SUPERVISION_MODE"", ""TRANSPORTATION_MODE"", ""DECLARATION_FORM_NO"", ""CIRCULATION_TYPE"", ""CUSTOMS_DECLARATION_INDICATOR"", ""CUSTOMS_DECLARATION_TYPE"", ""CUSTOMS_DECLARATION_FORM_TYPE"", ""ASSOCIATED_LIST_ID"", ""GLSCBA_NO"", ""GLBGD_ID"", ""GLBGDSB_DATE"", ""GLBGDJNSFHR_CODE"", ""GLBGDJNSFHRSHXY_CODE"", ""GLBGDJNSFHR_NAME"", ""GLBGDSCXSDW_CODE"", ""GLBGDSCXSSHXY_CODE"", ""GLBGDSCXSDW_NAME"", ""GLBGDSBDW_CODE"", ""GLBGDSBDWSHXY_CODE"", ""GLBGDSBDWMC"", ""OPERATOR_CARD_NO"", ""MEMO"") AS 
  select
    a.outseqdtlid,--出库细单ID
    a.outseqid,--出库总单ID
    a.seqdtlid,--库存来源ID
    a.goodsqty,--出库数量
    c.seqid,--总单ID
    d.CUSTOMS_DECLARATION_CODE,--报关单统一编码
    d.PRODUCT_SERIAL_NUMBER,--商品序号
    d.CUSTOMS_PRODUCT_SERIAL_NUMBER,--报关单商品序号
    d.RECORD_NUMBER,--备案序号
    d.PRODUCT_PART_NUMBER,--商品料号
    d.PRODUCT_CODE,--商品编码
    d.PRODUCT_NAME,--商品名称
    d.SPECIFICATION_MODEL,--规格型号
    d.ORIGIN_COUNTRY,--原产国（地区）
    d.FINAL_DESTINATION_COUNTRY,--最终目的国（地区）
    d.DECLARED_MEASUREMENT_UNIT,--申报计量单位
    d.DECLARED_TOTAL_PRICE,--申报总价
    d.DECLARED_PRICE,--申报单价
    d.CURRENCY,--币制
    d.LEGAL_MEASUREMENT_UNIT,--法定计量单位
    d.SECOND_LEGAL_MEASUREMENT_UNIT,--法定第二计量单位
    d.LEVY_EXEMPTION_METHOD,--征免方式
    d.UNIT_VERSION,--单耗版本号
    d.AUTOMATIC_RECORD_NUMBER,--自动备案序号
    d.HAZARDOUS_CHEMICALS_FLAG,--危化品标识
    d.KEY_PRODUCT_FLAG,--重点商品标志
    f.CREDATE,--制单日期
    f.INPUTMANID,--录入人ID
    e.employeename inputman,--录入人
    f.CONFIRMMANID,--确认人ID
    f.CONFIRMDATE,--确定日期
    f.REBACKMANID,--回退人ID
    f.REBACKDATE,--回退日期
    nvl(f.USESTATUS,0) USESTATUS,--状态
    f.PRE_ENTRY_UNIFIED_NO,--预录入统一编号
    f.LIST_NO,--清单编号
    f.LIST_TYPE,--清单类型
    f.MANUAL_ACCOUNT_BOOK_NO,--手（账）册编号
    f.OPERATING_UNIT_CODE,--经营单位编码
    f.JYDWSHXY_CODE,--经营单位社会信用代码
    f.OPERATING_UNIT_NAME,--经营单位名称
    f.PROCESSING_UNIT_CODE,--加工单位编码
    f.JGDWSHXY_CODE,--加工单位社会信用代码
    f.PROCESSING_UNIT_NAME,--加工单位名称
    f.DECLARING_UNIT_CODE,--申报单位编码
    f.SBDWSHXY_CODE,--申报单位社会信用代码
    f.SBDW_NAME,--申报单位名称
    f.ENTRY_UNIT_CODE,--录入单位编码
    f.LRDWSHXY_CODE,--录入单位社会信用代码
    f.ENTRY_UNIT_NAME,--录入单位名称
    f.ENTRY_DATE,--录入日期
    f.LIST_DECLARATION_DATE,--清单申报日期
    f.LIST_ENTRY_EXIT_GATE_STATUS,--清单进出卡口状态
    f.DEDUCTION_FLAG,--核扣标志
    f.ENTERPRISE_INTERNAL_NO,--企业内部编号
    f.ENTRY_CUSTOMS_TYPE,--进境关别
    f.COMPETENT_CUSTOMS,--主管海关
    f.SHIPMENT_COUNTRY_REGION,--启运国（地区）
    f.MATERIALS_FINISHED_FLAG,--料件、成品标志
    f.SUPERVISION_MODE,--监管方式
    f.TRANSPORTATION_MODE,--运输方式
    f.DECLARATION_FORM_NO,--申报表编号
    f.CIRCULATION_TYPE,--流转类型
    f.CUSTOMS_DECLARATION_INDICATOR,--报关标志
    f.CUSTOMS_DECLARATION_TYPE,--报关类型
    f.CUSTOMS_DECLARATION_FORM_TYPE,--报关单类型
    f.ASSOCIATED_LIST_ID,--关联清单编号
    f.GLSCBA_NO,--关联手（账）册备案号
    f.glbgd_id,--关联报关单编号
    f.glbgdsb_date,--关联报关单申报日期
    f.glbgdjnsfhr_code,--关联报关单境内收发货人编码
    f.glbgdjnsfhrshxy_code,--关联报关单境收发货人社会信用―代码
    f.glbgdjnsfhr_name,--关联报关单境内收发货人名称
    f.GLBGDSCXSDW_CODE,--关联报关单生产销售（消费使用）单位编码
    f.GLBGDSCXSSHXY_CODE,--关联报关单生产销售（消费使用）社会信用代码
    f.GLBGDSCXSDW_NAME,--关联报关单生产销售（消费使用）单位名称
    f.GLBGDSBDW_CODE,--关联报关单申报单位编码
    f.glbgdsbdwshxy_code,--关联报关单申报单位社会信用代码
    f.glbgdsbdwmc,--关联报关单申报单位名称
    f.OPERATOR_CARD_NO,--操作员卡号
    f.memo --备注
   from bond_warehouse_outorderdtl a,bond_warehouse_inorderdtl d,bond_warehouse_inorder c,bond_warehouse_outorder f,pub_employee e
        where a.seqdtlid = d.seqdtlid
              and d.seqid = c.seqid
              and a.outseqid = f.outseqid
              and f.inputmanid = e.employeeid(+)
              and f.USESTATUS = 1
"
"ZX_19108_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19108_V"" (""SEQDTLID"", ""SEQID"", ""CREDATE"", ""GOODSQTY"", ""POSNO"", ""LIBRARYDURATION"", ""OPERATING_UNIT_CODE"", ""OPERATING_UNIT_NAME"", ""CUSTOMS_DECLARATION_CODE"", ""PRODUCT_SERIAL_NUMBER"", ""CUSTOMS_PRODUCT_SERIAL_NUMBER"", ""RECORD_NUMBER"", ""PRODUCT_PART_NUMBER"", ""PRODUCT_CODE"", ""PRODUCT_NAME"", ""SPECIFICATION_MODEL"", ""ORIGIN_COUNTRY"", ""FINAL_DESTINATION_COUNTRY"", ""DECLARED_MEASUREMENT_UNIT"", ""DECLARED_QUANTITY"", ""DECLARED_TOTAL_PRICE"", ""DECLARED_PRICE"", ""CURRENCY"", ""LEGAL_QUANTITY"", ""LEGAL_MEASUREMENT_UNIT"", ""SECOND_LEGAL_QUANTITY"", ""SECOND_LEGAL_MEASUREMENT_UNIT"", ""LEVY_EXEMPTION_METHOD"", ""UNIT_VERSION"", ""AUTOMATIC_RECORD_NUMBER"", ""HAZARDOUS_CHEMICALS_FLAG"", ""KEY_PRODUCT_FLAG"") AS 
  select
        a.seqdtlid,--细单ID
        a.seqid,--总单ID
        a.credate,--入库时间
        a.goodsqty,--库存数量
        a.posno,--仓位号
        ceil(nvl((sysdate - a.credate),0)) as libraryDuration ,--在库时长
        b.OPERATING_UNIT_CODE,--经营单位编码
        b.OPERATING_UNIT_NAME,--经营单位名称
        c.CUSTOMS_DECLARATION_CODE,--报关单统一编码
        c.PRODUCT_SERIAL_NUMBER,--商品序号
        c.CUSTOMS_PRODUCT_SERIAL_NUMBER,--报关单商品序号
        c.RECORD_NUMBER,--备案序号
        c.PRODUCT_PART_NUMBER,--商品料号
        c.PRODUCT_CODE,--商品编码
        c.PRODUCT_NAME,--商品名称
        c.SPECIFICATION_MODEL,--规格型号
        c.ORIGIN_COUNTRY,--原产国（地区）
        c.FINAL_DESTINATION_COUNTRY,--最终目的国（地区）
        c.DECLARED_MEASUREMENT_UNIT,--申报计量单位
        c.DECLARED_QUANTITY,--申报数量
        c.DECLARED_TOTAL_PRICE,--申报总价
        c.DECLARED_PRICE,--申报单价
        c.CURRENCY,--币制
        c.LEGAL_QUANTITY,--法定数量
        c.LEGAL_MEASUREMENT_UNIT,--法定计量单位
        c.SECOND_LEGAL_QUANTITY,--第二法定数量
        c.SECOND_LEGAL_MEASUREMENT_UNIT,--法定第二计量单位
        c.LEVY_EXEMPTION_METHOD,--征免方式
        c.UNIT_VERSION,--单耗版本号
        c.AUTOMATIC_RECORD_NUMBER,--自动备案序号
        c.HAZARDOUS_CHEMICALS_FLAG,--危化品标识
        c.KEY_PRODUCT_FLAG--重点商品标志
       from bond_warehouse_qty_lst a,bond_warehouse_inorder b,bond_warehouse_inorderdtl c
            where a.seqid = b.seqid
                  and a.seqdtlid = c.seqdtlid
                  and a.goodsqty > 0
"
"ZX_19109_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_19109_V"" (""SKUID"", ""HSID"", ""CREDATE"", ""GOODSNAME"", ""GOODSTYPE"", ""ZYCF"", ""ORIGINCOUNTRY"", ""FACTNAME"", ""BRANDNAME"", ""SUPPLYER"", ""GOODSBARCODE"", ""GOODSGROUP"", ""PRICE"", ""USESTATUS"") AS 
  select
        a.skuid,--金二料号
        a.hsid,--HS编码
        a.credate,--创建时间
        a.goodsname,--货品名称
        a.goodstype,--货品规格
        a.zycf,--货品主要成分
        a.origincountry,-- 生产国
        a.factname,--生产企业
        a.brandname,--品牌名称
        a.supplyer,--供应商
        a.goodsbarcode,--商品条形码
        a.goodsgroup,--商品类别
        a.price,--价格
        nvl(a.usestatus,4) as usestatus--审核状态
      from BOND_GOODS a
"
"ZX_20000_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_20000_V"" (""EMPLOYEENAME"", ""WMS_IN_SCATTERCOUNT"", ""WMS_IN_WHOLECOUNT"", ""WMS_IN_WHOLEQTY"", ""IWCS_IN_SCATTERCOUNT"", ""IWCS_IN_WHOLECOUNT"", ""IWCS_IN_WHOLEQTY"", ""WMS_OUT_SCATTERCOUNT"", ""WMS_OUT_WHOLECOUNT"", ""WMS_OUT_WHOLEQTY"", ""IWCS_OUT_SCATTERCOUNT"", ""IWCS_OUT_WHOLECOUNT"", ""IWCS_OUT_WHOLEQTY"", ""WMS_CHECK_SCOUNT"", ""WMS_CHECK_WCOUNT"", ""WMS_CHECK_WQTY"", ""IWCS_CHECK_SCOUNT"", ""IWCS_CHECK_WCOUNT"", ""IWCS_CHECK_WQTY"", ""WMS_REPLENISH_UP"", ""WMS_REPLENISH_DOWN"", ""WMS_MV_UP"", ""WMS_MV_DOWN"", ""IWCS_TRANSFER_SCOUNT"", ""IWCS_TRANSFER_WCOUNT"", ""IWCS_TRANSFER_WQTY"", ""IWCS_BOXTRANSFER_COUNT"", ""IWCS_GROUNDUP_COUNT"", ""IWCS_GROUNDUP_WQTY"", ""IWCS_MVOUT_SCOUNT"", ""IWCS_MVOUT_WCOUNT"", ""IWCS_MVOUT_WQTY"", ""TCM_IN_SCATTERCOUNT"", ""TCM_IN_KGQTY"", ""TCM_OUT_SCATTERCOUNT"", ""TCM_OUT_KGQTY"", ""TCM_CHECK_SQTY"", ""TCM_CHECK_KGQTY"", ""TCM_MV_UP"", ""TCM_MV_DOWN"", ""ECODEQTY"", ""TCM_MV_UP_KGQTY"", ""TCM_MV_DOWN_KGQTY"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""ISRESTDAY"") AS 
  select a.employeename, --操作人
       sum(a.wms_in_scattercount) as wms_in_scattercount, --平库上架散件条数
       sum(a.wms_in_wholecount) as wms_in_wholecount, --平库上架整件条数
       sum(a.wms_in_wholeqty) as wms_in_wholeqty, --平库上架整件件数
       sum(a.iwcs_in_scattercount) as iwcs_in_scattercount, --自动库上架散件条数
       sum(a.iwcs_in_wholecount) as iwcs_in_wholecount, --自动库上架整件条数
       sum(a.iwcs_in_wholeqty) as iwcs_in_wholeqty, --自动库上架整件件数
       sum(a.wms_out_scattercount) as wms_out_scattercount, --平库拣货散件条数
       sum(a.wms_out_wholecount) as wms_out_wholecount, --平库拣货整件条数
       sum(a.wms_out_wholeqty) as wms_out_wholeqty, --平库拣货整件件数
       sum(a.iwcs_out_scattercount) as iwcs_out_scattercount, --自动库拣货散件条数
       sum(a.iwcs_out_wholecount) as iwcs_out_wholecount, --自动库拣货整件条数
       sum(a.iwcs_out_wholeqty) as iwcs_out_wholeqty, --自动库拣货整件件数
       sum(a.wms_check_scount) as wms_check_scount, --平库复核散件条数
       sum(a.wms_check_wcount) as wms_check_wcount, --平库复核整件条数
       sum(a.wms_check_wqty) as wms_check_wqty, --平库复核整件件数
       sum(a.iwcs_check_scount) as iwcs_check_scount, --自动库复核散件条数
       sum(a.iwcs_check_wcount) as iwcs_check_wcount, --自动库复核整件条数
       sum(a.iwcs_check_wqty) as iwcs_check_wqty, --自动库复核整件件数
       sum(a.wms_replenish_up) as wms_replenish_up, --平库补货上架条数
       sum(a.wms_replenish_down) as wms_replenish_down, --平库补货下架条数
       sum(a.wms_mv_up) as wms_mv_up, --平库移位上架条数
       sum(a.wms_mv_down) as wms_mv_down, --平库移位下架条数
       sum(a.iwcs_transfer_scount) as iwcs_transfer_scount, --自动库补货移位上架散件条数
       sum(a.iwcs_transfer_wcount) as iwcs_transfer_wcount, --自动库补货移位上架整件条数
       sum(a.iwcs_transfer_wqty) as iwcs_transfer_wqty, --自动库补货移位上架整件件数
       sum(a.iwcs_boxtransfer_count) as iwcs_boxtransfer_count, --自动库倒箱条数
       sum(a.iwcs_groundup_count) as iwcs_groundup_count, --自动库地堆上架条数
       sum(a.iwcs_groundup_wqty) as iwcs_groundup_wqty, --自动库地堆上架整件件数
       sum(a.iwcs_mvout_scount) as iwcs_mvout_scount, --自动库移位出散件条数
       sum(a.iwcs_mvout_wcount) as iwcs_mvout_wcount, --自动库移位出整件条数
       sum(a.iwcs_mvout_wqty) as iwcs_mvout_wqty, --自动库移位出整件件数
       sum(a.tcm_in_scattercount) as tcm_in_scattercount, --中药上架条数
       sum(a.tcm_in_kgqty) as tcm_in_kgqty, --中药上架公斤数
       sum(a.tcm_out_scattercount) as tcm_out_scattercount, --中药拣货条数
       sum(a.tcm_out_kgqty) as tcm_out_kgqty, --中药拣货公斤数
       sum(a.tcm_check_sqty) as tcm_check_sqty, --中药复核条数
       sum(a.tcm_check_kgqty) as tcm_check_kgqty, --中药复核公斤数
       sum(a.tcm_mv_up) as tcm_mv_up, --中药移位上架条数
       sum(a.tcm_mv_down) as tcm_mv_down, --中药移位下架条数
       sum(a.ecodeqty) as ecodeqty, --电子监管码采集数
       sum(a.tcm_mv_up_kgqty) as tcm_mv_up_kgqty, --中药移位上架公斤数
       sum(a.tcm_mv_down_kgqty) as tcm_mv_down_kgqty, --中药移位下架公斤数
       (EXTRACT(year FROM a.credate)) * 12 +
       (EXTRACT(month FROM a.credate)) as usemm, --逻辑月
       EXTRACT(year FROM a.credate) as useyear, --年
       EXTRACT(month FROM a.credate) as usemonth, --月
       b.isrestday
  from wms_workload_dtl_sc a, wms_work_calendar b
 where trunc(a.credate) = trunc(b.calendardate)
 group by a.employeename,
          EXTRACT(year FROM a.credate),
          EXTRACT(month FROM a.credate),
          b.isrestday
"
"ZX_20001_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_20001_V"" (""RFFINDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INOUTID"", ""COMEFROM"", ""OPERATIONTYPE"", ""COMPANYID"", ""COMPANYNAME"", ""RFMANID"", ""RFMAN"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SECTIONID"", ""SECTIONNAME"", ""SCATTERCOUNT"", ""WHOLECOUNT"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.rffindate, --任务完成时间
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.inoutid, --出入库ID
       a.comefrom, --来源类型
       a.operationtype, --业务类型
       a.companyid, --来货单位ID
       i.companyname, --来货单位
       a.rfmanid, --任务执行人ID
       e.employeename rfman, --任务执行人
       a.ownergoodsid, --货主货品ID
       d.waregoodsid goodsid, --货品主档ID
       d.goodsownid, --货主原货品ID
       d.goodsname, --货品名称
       d.goodsengname, --商品名
       d.goodstype, --规格
       d.tradepackname, --单位
       d.factname, --生产厂家
       d.prodarea, --产地
       a.lotid, --批号ID
       f.lotno, --批号
       a.goodsqty, --数量
       a.goodspackid, --主档包装ID
       g.packname, --包装名称
       g.packsize, --包装大小
       a.sectionid, --分区ID
       h.sectionname, --分区名称
       decode(nvl(a.scatterqty, 0), 0, 0, 1) scattercount, --散件条数
       decode(nvl(a.wholeqty, 0), 0, 0, 1) wholecount, --整件条数
       a.wholeqty, --整件件数
       extract(year from a.rffindate) * 12 +
       extract(month from a.rffindate) usermm, --逻辑月
       extract(day from a.rffindate) as useday, --日
       extract(month from a.rffindate) as usemonth, --月
       extract(year from a.rffindate) as useyear --年
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       pub_employee        e,
       wms_goods_lot       f,
       tpl_pub_goods_packs g,
       wms_st_section_def  h,
       tpl_go_company      i
 where a.warehid = 17
   and a.goodsownerid not in (64, 550) --去掉海峡和燕来福货主
   and a.comefrom = 1
   and a.rfflag = 3
   and not exists (select 1
          from wms_st_section_def x
         where x.iwcs_flag = 1
           and x.sectionid = a.sectionid)
   and a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.rfmanid = e.employeeid(+)
   and a.lotid = f.lotid(+)
   and a.goodspackid = g.goodspackid(+)
   and a.sectionid = h.sectionid(+)
   and a.companyid = i.companyid
"
"ZX_20002_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_20002_V"" (""RFFINDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INOUTID"", ""COMEFROM"", ""OPERATIONTYPE"", ""COMPANYID"", ""COMPANYNAME"", ""RFMANID"", ""RFMAN"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SECTIONID"", ""SECTIONNAME"", ""SCATTERCOUNT"", ""WHOLECOUNT"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.rffindate, --任务完成时间
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.inoutid, --出入库ID
       a.comefrom, --来源类型
       a.operationtype, --业务类型
       a.companyid,--出库单位ID
       i.companyname,--出库单位
       a.rfmanid, --任务执行人ID
       e.employeename rfman, --任务执行人
       a.ownergoodsid, --货主货品ID
       d.waregoodsid goodsid, --货品主档ID
       d.goodsownid, --货主原货品ID
       d.goodsname, --货品名称
       d.goodsengname, --商品名
       d.goodstype, --规格
       d.tradepackname, --单位
       d.factname, --生产厂家
       d.prodarea, --产地
       a.lotid, --批号ID
       f.lotno, --批号
       a.goodsqty, --数量
       a.goodspackid, --主档包装ID
       g.packname, --包装名称
       g.packsize, --包装大小
       a.sectionid, --分区ID
       h.sectionname, --分区名称
       decode(nvl(a.scatterqty, 0), 0, 0, 1) scattercount, --散件条数
       decode(nvl(a.wholeqty, 0), 0, 0, 1) wholecount, --整件条数
       a.wholeqty, --整件件数
       extract(year from a.rffindate) * 12 +
       extract(month from a.rffindate) usermm, --逻辑月
       extract(day from a.rffindate) as useday, --日
       extract(month from a.rffindate) as usemonth, --月
       extract(year from a.rffindate) as useyear --年
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       pub_employee        e,
       wms_goods_lot       f,
       tpl_pub_goods_packs g,
       wms_st_section_def  h,
       tpl_go_company      i
 where a.warehid = 17
   and a.goodsownerid not in (64, 550) --去掉海峡和燕来福货主
   and a.comefrom in (2,3)
   and a.rfflag = 3
   and not exists (select 1
          from wms_st_section_def x
         where x.iwcs_flag = 1
           and x.sectionid = a.sectionid)
   and a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.rfmanid = e.employeeid(+)
   and a.lotid = f.lotid(+)
   and a.goodspackid = g.goodspackid(+)
   and a.sectionid = h.sectionid(+)
   and a.companyid=i.companyid
"
"ZX_20003_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_20003_V"" (""KEEPDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INOUTID"", ""COMEFROM"", ""OPERATIONTYPE"", ""COMPANYID"", ""COMPANYNAME"", ""CHECKMANID"", ""CHECKMAN"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SECTIONID"", ""SECTIONNAME"", ""SCATTERCOUNT"", ""WHOLECOUNT"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.keepdate, --复核时间
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.inoutid, --出入库ID
       a.comefrom, --来源类型
       a.operationtype, --业务类型
       a.companyid,--出库单位ID
       j.companyname,--出库单位
       a.checkmanid, --复核人ID
       e.employeename checkman, --复核人
       a.ownergoodsid, --货主货品ID
       d.waregoodsid goodsid, --货品主档ID
       d.goodsownid, --货主原货品ID
       d.goodsname, --货品名称
       d.goodsengname, --商品名
       d.goodstype, --规格
       d.tradepackname, --单位
       d.factname, --生产厂家
       d.prodarea, --产地
       a.lotid, --批号ID
       f.lotno, --批号
       a.goodsqty, --数量
       a.goodspackid, --主档包装ID
       g.packname, --包装名称
       g.packsize, --包装大小
       i.sectionid, --分区ID
       h.sectionname, --分区名称
       decode(nvl(i.scatterqty, 0), 0, 0, 1) scattercount, --散件条数
       decode(nvl(i.wholeqty, 0), 0, 0, 1) wholecount, --整件条数
       i.wholeqty, --整件件数
       extract(year from a.keepdate) * 12 +
       extract(month from a.keepdate) usermm, --逻辑月
       extract(day from a.keepdate) as useday, --月
       extract(month from a.keepdate) as usemonth, --月
       extract(year from a.keepdate) as useyear --年
  from gsp_st_io_record    a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       pub_employee        e,
       wms_goods_lot       f,
       tpl_pub_goods_packs g,
       wms_st_section_def  h,
       wms_st_io_doc       i,
       tpl_go_company      j
 where a.warehid = 17
   and a.goodsownerid not in (64, 550) --去掉海峡和燕来福货主
   and a.inoutid=i.inoutid
   and not exists (select 1
          from wms_st_section_def x
         where x.iwcs_flag = 1
           and x.sectionid = i.sectionid)
   and a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.checkmanid = e.employeeid(+)
   and a.lotid = f.lotid(+)
   and a.goodspackid = g.goodspackid(+)
   and i.sectionid = h.sectionid(+)
   and a.companyid=j.companyid
"
"ZX_20004_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_20004_V"" (""RFFINDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INOUTID"", ""COMEFROM"", ""OPERATIONTYPE"", ""INOUTFLAG"", ""RFMANID"", ""RFMAN"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SECTIONID"", ""SECTIONNAME"", ""UPCOUNT"", ""DOWNCOUNT"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.rffindate, --任务完成时间
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.inoutid, --出入库ID
       a.comefrom, --来源类型
       a.operationtype,--业务类型
       a.inoutflag,--出入库类型
       a.rfmanid, --任务执行人ID
       e.employeename rfman, --任务执行人
       a.ownergoodsid, --货主货品ID
       d.waregoodsid goodsid, --货品主档ID
       d.goodsownid, --货主原货品ID
       d.goodsname, --货品名称
       d.goodsengname, --商品名
       d.goodstype, --规格
       d.tradepackname, --单位
       d.factname, --生产厂家
       d.prodarea, --产地
       a.lotid, --批号ID
       f.lotno, --批号
       a.goodsqty, --数量
       a.goodspackid, --主档包装ID
       g.packname, --包装名称
       g.packsize, --包装大小
       a.sectionid, --分区ID
       h.sectionname, --分区名称
       decode(a.inoutflag,0,1,0) upcount,--补货上架条数
       decode(a.inoutflag,1,1,0) downcount,--补货下架条数
       extract(year from a.rffindate) * 12 +
       extract(month from a.rffindate) usermm, --逻辑月
       extract(day from a.rffindate) as useday, --月
       extract(month from a.rffindate) as usemonth, --月
       extract(year from a.rffindate) as useyear --年
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       pub_employee        e,
       wms_goods_lot       f,
       tpl_pub_goods_packs g,
       wms_st_section_def  h
 where a.warehid = 17
   and a.goodsownerid not in (64, 550) --去掉海峡和燕来福货主
   and a.comefrom=4
   and a.rfflag = 3
   and not exists (select 1
          from wms_st_section_def x
         where x.iwcs_flag = 1
           and x.sectionid = a.sectionid)
   and a.operationtype=29
   and a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.rfmanid = e.employeeid(+)
   and a.lotid = f.lotid(+)
   and a.goodspackid = g.goodspackid(+)
   and a.sectionid = h.sectionid(+)
"
"ZX_20005_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_20005_V"" (""RFFINDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""INOUTID"", ""COMEFROM"", ""OPERATIONTYPE"", ""INOUTFLAG"", ""RFMANID"", ""RFMAN"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""SECTIONID"", ""SECTIONNAME"", ""UPCOUNT"", ""DOWNCOUNT"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.rffindate, --任务完成时间
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.inoutid, --出入库ID
       a.comefrom, --来源类型
       a.operationtype,--业务类型
       a.inoutflag,--出入库类型
       a.rfmanid, --任务执行人ID
       e.employeename rfman, --任务执行人
       a.ownergoodsid, --货主货品ID
       d.waregoodsid goodsid, --货品主档ID
       d.goodsownid, --货主原货品ID
       d.goodsname, --货品名称
       d.goodsengname, --商品名
       d.goodstype, --规格
       d.tradepackname, --单位
       d.factname, --生产厂家
       d.prodarea, --产地
       a.lotid, --批号ID
       f.lotno, --批号
       a.goodsqty, --数量
       a.goodspackid, --主档包装ID
       g.packname, --包装名称
       g.packsize, --包装大小
       a.sectionid, --分区ID
       h.sectionname, --分区名称
       decode(a.inoutflag,0,1,0) upcount,--移位上架条数
       decode(a.inoutflag,1,1,0) downcount,--移位下架条数
       extract(year from a.rffindate) * 12 +
       extract(month from a.rffindate) usermm, --逻辑月
       extract(day from a.rffindate) as useday, --月
       extract(month from a.rffindate) as usemonth, --月
       extract(year from a.rffindate) as useyear --年
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       pub_employee        e,
       wms_goods_lot       f,
       tpl_pub_goods_packs g,
       wms_st_section_def  h
 where a.warehid = 17
   and a.goodsownerid not in (64, 550) --去掉海峡和燕来福货主
   and a.comefrom=4
   and a.rfflag = 3
   and not exists (select 1
          from wms_st_section_def x
         where x.iwcs_flag = 1
           and x.sectionid = a.sectionid)
   and a.operationtype=28
   and a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.rfmanid = e.employeeid(+)
   and a.lotid = f.lotid(+)
   and a.goodspackid = g.goodspackid(+)
   and a.sectionid = h.sectionid(+)
"
"ZX_20006_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_20006_V"" (""RECORDID"", ""ECODE"", ""CREDATE"", ""INPUTMANID"", ""INPUTMAN"", ""INOUTFLAG"", ""SOURCEID"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""TRADEPACKNAME"", ""GOODSENGNAME"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""COMPANYID"", ""COMPANYNAME"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""USEDAY"", ""SOURCETABLE"") AS 
  select a.recordid, --电子监管码ID
       a.ecode, --电子监管码
       a.credate, --创建时间
       a.inputmanid, --录入人ID
       g.employeename inputman, --录入人
       a.inoutflag, --出入库类型
       a.sourceid, --来源ID
       b.warehid, --物流中心ID
       d.warehname, --物流中心
       b.goodsownerid, --货主ID
       f.goodsownername, --货主
       c.ownergoodsid, --货主货品ID
       h.waregoodsid goodsid, --货品主档ID
       h.goodsname, --货品名称
       h.goodstype, --货品规格
       h.prodarea, --产地
       h.factname factname, --生产厂家
       h.tradepackname, --单位
       h.goodsengname, --商品名
       null lotid, --批号ID
       null lotno, --批号
       null proddate, --生产日期
       null validdate, --有效期至
       null approvedocno, --批准文号
       b.sourcecompanyid companyid, --货主单位ID
       e.companyname, --货主单位
       (EXTRACT(year FROM a.credate)) * 12 +
       (EXTRACT(month FROM a.credate)) as usemm,--逻辑月
       EXTRACT(year FROM a.credate) as useyear,--年
       EXTRACT(month FROM a.credate) as usemonth,--月
       EXTRACT(day FROM a.credate) as useday,--日
       '收货采集' sourcetable --数据来源
  from wms_ecode_record a,
       wms_in_order     b,
       wms_in_order_dtl c,
       tpl_warehouse    d,
       tpl_go_company   e,
       tpl_goodsowner   f,
       pub_employee     g,
       tpl_goods        h
 where a.sourceid = c.indtlid
   and b.inid = c.inid
   and b.warehid = d.warehid(+)
   and b.sourcecompanyid = e.companyid(+)
   and b.goodsownerid = f.goodsownerid(+)
   and c.ownergoodsid = h.ownergoodsid(+)
   and a.inputmanid = g.employeeid(+)
   and a.inoutflag = 0
   and a.comefrom = 1
   and b.warehid = 17
union all
select a.recordid, --电子监管码ID
       a.ecode, --电子监管码
       a.credate, --创建时间
       a.inputmanid, --录入人ID
       h.employeename inputman, --录入人
       a.inoutflag, --出入库类型
       a.sourceid, --来源ID
       b.warehid, --物流中心ID
       c.warehname, --物流中心
       b.goodsownerid, --货主ID
       d.goodsownername, --货主
       b.ownergoodsid, --货主货品ID
       e.waregoodsid goodsid, --货品主档ID
       e.goodsname, --货主货品名称
       e.goodstype, --货品规格
       e.prodarea, --产地
       e.factname factname, --生产厂家
       e.tradepackname, --单位
       e.goodsengname, --商品名
       b.lotid, --批号ID
       f.lotno, --批号
       f.proddate, --生产日期
       f.validdate, --有效期至
       f.approvedocno, --批准文号
       b.companyid, --货主单位ID
       g.companyname, --货主单位
       (EXTRACT(year FROM a.credate)) * 12 +
       (EXTRACT(month FROM a.credate)) as usemm,
       EXTRACT(year FROM a.credate) as useyear,--年
       EXTRACT(month FROM a.credate) as usemonth,--月
       EXTRACT(day FROM a.credate) as useday,--日
       '验收采集' sourcetable
  from wms_ecode_record a,
       wms_st_io_doc    b,
       tpl_warehouse    c,
       tpl_goodsowner   d,
       tpl_goods        e,
       wms_goods_lot    f,
       tpl_go_company   g,
       pub_employee     h
 where a.sourceid = b.sourceid
   and b.warehid = c.warehid(+)
   and b.goodsownerid = d.goodsownerid(+)
   and b.ownergoodsid = e.ownergoodsid(+)
   and b.lotid = f.lotid(+)
   and b.companyid = g.companyid(+)
   and a.inoutflag = 0 --上架
   and nvl(a.comefrom, 0) = 0
   and b.comefrom = 1
   and a.inputmanid = h.employeeid(+)
   and b.warehid = 17
union all
select a.recordid, --电子监管码ID
       a.ecode, --电子监管码
       a.credate, --创建时间
       a.inputmanid, --录入人ID
       h.employeename inputman, --录入人
       a.inoutflag, --出入库类型
       a.sourceid, --来源ID
       b.warehid, --物流中心ID
       c.warehname, --物流中心
       b.goodsownerid, --货主ID
       d.goodsownername, --货主
       b.ownergoodsid, --货主货品ID
       e.waregoodsid goodsid, --货品主档ID
       e.goodsname, --货主货品名称
       e.goodstype, --货品规格
       e.prodarea, --产地
       e.factname factname, --生产厂家
       e.tradepackname, --单位
       e.goodsengname, --商品名
       b.lotid, --批号ID
       f.lotno, --批号
       f.proddate, --生产日期
       f.validdate, --有效期至
       f.approvedocno, --批准文号
       b.companyid, --货主单位ID
       g.companyname, --货主单位
       (EXTRACT(year FROM a.credate)) * 12 +
       (EXTRACT(month FROM a.credate)) as usemm,
       EXTRACT(year FROM a.credate) as useyear,--年
       EXTRACT(month FROM a.credate) as usemonth,--月
       EXTRACT(day FROM a.credate) as useday,--日
       '出库复核' sourcetable
  from wms_ecode_record a,
       wms_st_io_doc    b,
       tpl_warehouse    c,
       tpl_goodsowner   d,
       tpl_goods        e,
       wms_goods_lot    f,
       tpl_go_company   g,
       pub_employee     h
 where a.sourceid = b.inoutid
   and b.warehid = c.warehid(+)
   and b.goodsownerid = d.goodsownerid(+)
   and b.ownergoodsid = e.ownergoodsid(+)
   and b.lotid = f.lotid(+)
   and b.companyid = g.companyid(+)
   and a.inoutflag = 1 --下架
   and nvl(a.comefrom, 0) = 0
   and b.comefrom = 3 --b.comefrom in(2,3)来源类型
   and a.inputmanid = h.employeeid(+)
   and b.warehid = 17
   and not exists (select 1
          from wms_st_section_def x
         where x.sectionid = b.sectionid
           and x.iwcs_flag = 1)
"
"ZX_20007_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_20007_V"" (""CREDATE"", ""SSC_RECEIVE_GOODS_LOCATE_ID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""INDTLID"", ""RECEIVEID"", ""SCANERID"", ""SCANER"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""OWNERPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""DTLGOODSQTY"", ""DEPOT_NAME"", ""SCATTERCOUNT"", ""WHOLECOUNT"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select c.create_timestamp as credate, --入库时间
       c.ssc_receive_goods_locate_id, --入库仓位分配ID
       a.inv_owner as goodsownerid, --货主ID
       (select aa.party_name
          from com_party@cdiwcs.ly.com aa
         where aa.com_party_type_id = 1
           and aa.com_party_id = a.inv_owner) as goodsownername, --货主名称
       a.send_party_id as companyid, --来货单位ID
       (select dd.party_name
          from com_party@cdiwcs.ly.com dd
         where dd.com_party_id = a.send_party_id
           and dd.com_party_type_id <> 1) as companyname, --来货单位
       b.external_bill_id as indtlid, --入库细单ID(WMS系统)
       b.external_bill_lines_id as receiveid, --验收细单ID(WMS系统)
       g.scaner as scanerid, --绑定人ID
       i.employeecode as scaner, --绑定人
       b.com_goods_id as ownergoodsid, --货主货品ID
       f.goods_name as goodsname, --货品名称
       f.english_name as goodsengname, --商品名
       f.goods_desc as goodstype, --规格
       (select cc.package_name
          from com_goods_package@cdiwcs.ly.com cc
         where cc.com_goods_id = b.com_goods_id
           and cc.package_type = 'UNIT') as tradepackname, --单位
       (select bb.party_name
          from com_party@cdiwcs.ly.com bb
         where bb.com_party_type_id = 4
           and bb.com_party_id = f.factory_id) as factname, --生产厂家
       f.product_location as prodarea,
       b.com_lot_id as lotid, --批号ID
       h.lot_no as lotno,--批号
       b.package_id as ownerpackid, --货主货品包装ID
       b.package_name as packname, --包装名称
       b.package_num as packsize, --包装大小
       c.locate_qty as goodsqty, --放置数量
       g.rec_qty as dtlgoodsqty, --放置明细数量
       e.depot_name, --入库区域
       decode(e.com_depot_id, 100, 0, 1) as scattercount, --散件条数
       decode(e.com_depot_id, 100, 1, 0) as wholecount, --整件条数
       decode(e.com_depot_id, 100, g.rec_qty / g.package_num, 0) as wholeqty, --整件件数
       extract(year from c.create_timestamp) * 12 +
       extract(month from c.create_timestamp) usermm, --逻辑月
       extract(day from c.create_timestamp) as useday, --月
       extract(month from c.create_timestamp) as usemonth, --月
       extract(year from c.create_timestamp) as useyear --年
  from ssc_receive_goods@cdiwcs.ly.com a, --入库总单表
       ssc_receive_goods_lines@cdiwcs.ly.com b, --入库细单表
       ssc_receive_goods_locate@cdiwcs.ly.com c, --入库商品分配表
       com_stock_pos@cdiwcs.ly.com d, --仓房货位表
       com_depot@cdiwcs.ly.com e, --仓间资料
       com_goods@cdiwcs.ly.com f, --货品表
       iwcs_com_inv_case_v@cdiwcs.ly.com g,
       com_lot@cdiwcs.ly.com h,
       sys_userlist@cdiwcs.ly.com i
 where a.ssc_receive_goods_id = b.ssc_receive_goods_id
   and a.receive_bill_type in ('PURCHASE', 'SALE_RTN', 'TRANSFER')
   and b.ssc_receive_goods_lines_id = c.ssc_receive_goods_lines_id
   and c.stock_pos_id = d.stock_pos_id(+)
   and d.depot_id = e.com_depot_id(+)
   and b.com_goods_id = f.com_goods_id
   and c.case_nbr = g.case_nbr
   and b.com_lot_id=h.com_lot_id(+)
   and g.scaner=i.userid(+)
"
"ZX_20008_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_20008_V"" (""CREDATE"", ""SSC_PICKING_CARTON_ID"", ""INOUTID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""PICKERID"", ""PICKER"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""OWNERPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""DEPOT_NAME"", ""CARTON_TYPE"", ""SCATTERCOUNT"", ""WHOLECOUNT"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.pick_time as credate, --任务完成时间
       a.ssc_picking_carton_id, --IWCS任务明细ID
       a.wms_inout_id as inoutid, --WMS出入库ID
       a.party_id as goodsownerid, --货主ID
       (select aa.party_name
          from com_party@cdiwcs.ly.com aa
         where aa.com_party_type_id = 1
           and aa.com_party_id = a.party_id) as goodsownername, --货主名称
       a.spc_client_id as companyid, --出库单位ID
       (select bb.party_name
          from com_party@cdiwcs.ly.com bb
         where bb.com_party_id = a.spc_client_id
           and bb.com_party_type_id <> 1) as companyname, --出库单位
       a.picker as pickerid, --拣货人ID
       c.employeecode as picker, --拣货人
       a.com_goods_id as ownergoodsid, --货主货品ID
       b.goods_name as goodsname, --货品名称
       b.english_name as goodsengname, --商品名
       b.goods_desc as goodstype, --规格
       (select cc.package_name
          from com_goods_package@cdiwcs.ly.com cc
         where cc.com_goods_id = a.com_goods_id
           and cc.package_type = 'UNIT') as tradepackname, --单位
       (select dd.party_name
          from com_party@cdiwcs.ly.com dd
         where dd.com_party_type_id = 4
           and dd.com_party_id = b.factory_id) as factname, --生产厂家
       b.product_location as prodarea, --产地
       a.com_lot_id as lotid, --批号ID
       d.lot_no as lotno, --批号
       a.package_id as ownerpackid, --货主货品包装ID
       a.package_name as packname, --包装名称
       a.package_num as packsize, --包装大小
       a.allocate_qty as goodsqty, --拣货数量
       f.depot_name, --出库区域
       decode(a.carton_type,
              'A',
              '零散出库',
              'C',
              '整箱出库',
              'P',
              '托盘出库',
              0) carton_type, --IWCS任务类型
       decode(a.carton_type, 'A', 1, 0) as scattercount, --散件条数
       decode(a.carton_type, 'A', 0, 1) as wholecount, --整件条数
       decode(a.carton_type, 'A', 0, a.allocate_qty / a.package_num) as wholeqty, --整件件数
       extract(year from a.pick_time) * 12 +
       extract(month from a.pick_time) usermm, --逻辑月
       extract(day from a.pick_time) as useday, --日
       extract(month from a.pick_time) as usemonth, --月
       extract(year from a.pick_time) as useyear --年
  from ssc_picking_carton@cdiwcs.ly.com a,
       com_goods@cdiwcs.ly.com          b,
       sys_userlist@cdiwcs.ly.com       c,
       com_lot@cdiwcs.ly.com            d,
       com_stock_pos@cdiwcs.ly.com      e,
       com_depot@cdiwcs.ly.com          f
 where a.pick_status = 'TRUE'
   and a.picker = c.userid(+)
   and a.com_goods_id = b.com_goods_id
   and a.com_lot_id = d.com_lot_id(+)
   and a.stock_pos_id = e.stock_pos_id(+)
   and e.depot_id = f.com_depot_id(+)
"
"ZX_20009_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_20009_V"" (""CHECKDATE"", ""SSC_PICKING_CARTON_ID"", ""INOUTID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""CHECKERID"", ""CHECKER"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""OWNERPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""DEPOT_NAME"", ""CARTON_TYPE"", ""SCATTERCOUNT"", ""WHOLECOUNT"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.check_time as checkdate, --复核时间
       a.ssc_picking_carton_id, --IWCS任务明细ID
       a.wms_inout_id as inoutid, --WMS出入库ID
       a.party_id as goodsownerid, --货主ID
       (select aa.party_name
          from com_party@cdiwcs.ly.com aa
         where aa.com_party_type_id = 1
           and aa.com_party_id = a.party_id) as goodsownername, --货主名称
       a.spc_client_id as companyid, --出库单位ID
       (select bb.party_name
          from com_party@cdiwcs.ly.com bb
         where bb.com_party_id = a.spc_client_id
           and bb.com_party_type_id <> 1) as companyname, --出库单位
       a.checker as checkerid, --复核人ID
       c.employeecode as checker, --复核人
       a.com_goods_id as ownergoodsid, --货主货品ID
       b.goods_name as goodsname, --货品名称
       b.english_name as goodsengname, --商品名
       b.goods_desc as goodstype, --规格
       (select cc.package_name
          from com_goods_package@cdiwcs.ly.com cc
         where cc.com_goods_id = a.com_goods_id
           and cc.package_type = 'UNIT') as tradepackname, --单位
       (select dd.party_name
          from com_party@cdiwcs.ly.com dd
         where dd.com_party_type_id = 4
           and dd.com_party_id = b.factory_id) as factname, --生产厂家
       b.product_location as prodarea, --产地
       a.com_lot_id as lotid, --批号ID
       d.lot_no as lotno, --批号
       a.package_id as ownerpackid, --货主货品包装ID
       a.package_name as packname, --包装名称
       a.package_num as packsize, --包装大小
       a.allocate_qty as goodsqty, --拣货数量
       f.depot_name, --出库区域
       decode(a.carton_type,
              'A',
              '零散出库',
              'C',
              '整箱出库',
              'P',
              '托盘出库',
              0) carton_type, --IWCS任务类型
       decode(a.carton_type, 'A', 1, 0) as scattercount, --散件条数
       decode(a.carton_type, 'A', 0, 1) as wholecount, --整件条数
       decode(a.carton_type, 'A', 0, a.allocate_qty / a.package_num) as wholeqty, --整件件数
       extract(year from a.check_time) * 12 +
       extract(month from a.check_time) usermm, --逻辑月
       extract(day from a.check_time) as useday, --日
       extract(month from a.check_time) as usemonth, --月
       extract(year from a.check_time) as useyear --年
  from ssc_picking_carton@cdiwcs.ly.com a,
       com_goods@cdiwcs.ly.com          b,
       sys_userlist@cdiwcs.ly.com       c,
       com_lot@cdiwcs.ly.com            d,
       com_stock_pos@cdiwcs.ly.com      e,
       com_depot@cdiwcs.ly.com          f
 where a.check_status = 'TRUE'
   and a.checker = c.userid(+)
   and a.com_goods_id = b.com_goods_id
   and a.com_lot_id = d.com_lot_id(+)
   and a.stock_pos_id = e.stock_pos_id(+)
   and e.depot_id = f.com_depot_id(+)
"
"ZX_20010_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_20010_V"" (""CREDATE"", ""SSC_RECEIVE_GOODS_LOCATE_ID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""TRADEID"", ""TRADEDTLID"", ""SCANERID"", ""SCANER"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""OWNERPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""DEPOT_NAME"", ""SCATTERCOUNT"", ""WHOLECOUNT"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select c.create_timestamp as credate, --入库时间
       c.ssc_receive_goods_locate_id, --入库仓位分配ID
       a.inv_owner as goodsownerid, --货主ID
       (select aa.party_name
          from com_party@cdiwcs.ly.com aa
         where aa.com_party_type_id = 1
           and aa.com_party_id = a.inv_owner) as goodsownername, --货主名称
       b.external_bill_id as tradeid, --移位总单ID(WMS系统)
       b.external_bill_lines_id as tradedtlid, --移位细单ID(WMS系统)
       g.scaner as scanerid, --绑定人ID
       i.employeecode as scaner, --绑定人
       b.com_goods_id as ownergoodsid, --货主货品ID
       f.goods_name as goodsname, --货品名称
       f.english_name as goodsengname, --商品名
       f.goods_desc as goodstype, --规格
       (select cc.package_name
          from com_goods_package@cdiwcs.ly.com cc
         where cc.com_goods_id = b.com_goods_id
           and cc.package_type = 'UNIT') as tradepackname, --单位
       (select bb.party_name
          from com_party@cdiwcs.ly.com bb
         where bb.com_party_type_id = 4
           and bb.com_party_id = f.factory_id) as factname, --生产厂家
       f.product_location as prodarea,
       b.com_lot_id as lotid, --批号ID
       h.lot_no as lotno,--批号
       b.package_id as ownerpackid, --货主货品包装ID
       b.package_name as packname, --包装名称
       b.package_num as packsize, --包装大小
       c.locate_qty as goodsqty, --放置数量
       e.depot_name, --入库区域
       decode(e.com_depot_id, 100, 0, 1) as scattercount, --散件移库上架条数
       decode(e.com_depot_id, 100, 1, 0) as wholecount, --整件移库上架条数
       decode(e.com_depot_id, 100, c.locate_qty / c.unit_num, 0) as wholeqty, --整件件数
       extract(year from c.create_timestamp) * 12 +
       extract(month from c.create_timestamp) usermm, --逻辑月
       extract(day from c.create_timestamp) as useday, --日
       extract(month from c.create_timestamp) as usemonth, --月
       extract(year from c.create_timestamp) as useyear --年
  from ssc_receive_goods@cdiwcs.ly.com a,
       ssc_receive_goods_lines@cdiwcs.ly.com b,
       ssc_receive_goods_locate@cdiwcs.ly.com c,
       com_stock_pos@cdiwcs.ly.com d,
       com_depot@cdiwcs.ly.com e,
       com_goods@cdiwcs.ly.com f,
       iwcs_com_inv_case_v@cdiwcs.ly.com g,
       com_lot@cdiwcs.ly.com h,
       sys_userlist@cdiwcs.ly.com i
 where a.ssc_receive_goods_id = b.ssc_receive_goods_id
   and a.receive_bill_type in ('TRANSFERLINES')
   and b.ssc_receive_goods_lines_id = c.ssc_receive_goods_lines_id
   and c.stock_pos_id = d.stock_pos_id(+)
   and d.depot_id = e.com_depot_id(+)
   and b.com_goods_id = f.com_goods_id
   and c.case_nbr = g.case_nbr
   and b.com_lot_id=h.com_lot_id(+)
   and g.scaner=i.userid(+)
"
"ZX_20011_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_20011_V"" (""TASK_ID"", ""CASE_NBR"", ""TASK_NAME"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""SCANERID"", ""SCANER"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""OWNERPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""DTLGOODSQTY"", ""COUNTQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.task_id, --任务ID
       a.case_nbr, --箱号
       b.task_name, --任务类型
       i.scan_time as credate, --任务完成时间
       c.inv_owner as goodsownerid, --货主ID
       (select aa.party_name
          from com_party@cdiwcs.ly.com aa
         where aa.com_party_type_id = 1
           and aa.com_party_id = c.inv_owner) as goodsownername, --货主名称
       i.scaner as scanerid, --执行人ID
       d.employeecode as scaner, --执行人
       c.com_goods_id as ownergoodsid, --货主货品ID
       e.goods_name as goodsname, --货品名称
       e.english_name as goodsengname, --商品名
       e.goods_desc as goodstype, --规格
       (select bb.package_name
          from com_goods_package@cdiwcs.ly.com bb
         where bb.com_goods_id = c.com_goods_id
           and bb.package_type = 'UNIT') as tradepackname, --单位
       (select cc.party_name
          from com_party@cdiwcs.ly.com cc
         where cc.com_party_type_id = 4
           and cc.com_party_id = e.factory_id) as factname, --生产厂家
       e.product_location as prodarea, --产地
       c.com_lot_id as lotid, --批号ID
       f.lot_no as lotno, --批号
       c.package_id as ownerpackid, --货主货品包装ID
       c.package_name as packname, --包装名称
       c.package_num as packsize, --包装大小
       c.rec_qty as goodsqty, --倒箱数量
       i.rec_qty as dtlgoodsqty,--倒箱明细数量
       1 as countqty, --条目数
       extract(year from i.scan_time) * 12 +
       extract(month from i.scan_time) usermm, --逻辑月
       extract(day from i.scan_time) as useday, --月
       extract(month from i.scan_time) as usemonth, --月
       extract(year from i.scan_time) as useyear --年
  from wcs_task_bak@cdiwcs.ly.com        a,
       sys_task_route@cdiwcs.ly.com      b,
       iwcs_com_inv_case_v@cdiwcs.ly.com c,
       sys_userlist@cdiwcs.ly.com        d,
       com_goods@cdiwcs.ly.com           e,
       com_lot@cdiwcs.ly.com             f,
       com_stock_pos@cdiwcs.ly.com       g,
       com_depot@cdiwcs.ly.com           h,
       iwcs_com_inv_case_v@cdiwcs.ly.com i
 where a.task_type in (2122, 2133, 2143)
   and a.task_type = b.task_type
   and b.item_no = 1
   and nvl(a.source_type,'A')<>'AutoToPlat'
   and a.case_nbr = c.case_nbr
   and i.scaner = d.userid(+)
   and c.com_goods_id = e.com_goods_id
   and c.com_lot_id = f.com_lot_id(+)
   and c.stock_pos_id = g.stock_pos_id(+)
   and g.depot_id = h.com_depot_id(+)
   and c.com_inv_case_id = i.ref_inv_case_id
   and i.ref_inv_case_id is not null
"
"ZX_20012_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_20012_V"" (""TASK_ID"", ""CASE_NBR"", ""TASK_NAME"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""SCANERID"", ""SCANER"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""OWNERPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""COUNTQTY"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.task_id, --任务ID
       a.case_nbr, --箱号
       b.task_name, --任务类型
       c.upload_time as credate, --上架时间
       c.inv_owner as goodsownerid, --货主ID
       (select aa.party_name
          from com_party@cdiwcs.ly.com aa
         where aa.com_party_type_id = 1
           and aa.com_party_id = c.inv_owner) as goodsownername, --货主名称
       c.scaner as scanerid, --执行人ID
       d.employeecode as scaner, --执行人
       c.com_goods_id as ownergoodsid, --货主货品ID
       e.goods_name as goodsname, --货品名称
       e.english_name as goodsengname, --商品名
       e.goods_desc as goodstype, --规格
       (select bb.package_name
          from com_goods_package@cdiwcs.ly.com bb
         where bb.com_goods_id = c.com_goods_id
           and bb.package_type = 'UNIT') as tradepackname, --单位
       (select cc.party_name
          from com_party@cdiwcs.ly.com cc
         where cc.com_party_type_id = 4
           and cc.com_party_id = e.factory_id) as factname, --生产厂家
       e.product_location as prodarea, --产地
       c.com_lot_id as lotid, --批号ID
       f.lot_no as lotno, --批号
       c.package_id as ownerpackid, --货主货品包装ID
       c.package_name as packname, --包装名称
       c.package_num as packsize, --包装大小
       c.rec_qty as goodsqty, --倒箱数量
       1 as countqty, --条目数
       c.rec_qty/c.package_num as wholeqty,--整件件数
       extract(year from c.upload_time) * 12 +
       extract(month from c.upload_time) usermm, --逻辑月
       extract(day from c.upload_time) as useday, --月
       extract(month from c.upload_time) as usemonth, --月
       extract(year from c.upload_time) as useyear --年
  from wcs_task_bak@cdiwcs.ly.com        a,
       sys_task_route @cdiwcs.ly.com     b,
       iwcs_com_inv_case_v@cdiwcs.ly.com c,
       sys_userlist@cdiwcs.ly.com        d,
       com_goods@cdiwcs.ly.com           e,
       com_lot@cdiwcs.ly.com             f,
       com_stock_pos@cdiwcs.ly.com       g,
       com_depot @cdiwcs.ly.com          h
 where a.task_type in (3212)
   and a.task_type = b.task_type
   and b.item_no = 1
   and a.case_nbr = c.case_nbr
   and c.scaner = d.userid(+)
   and c.com_goods_id = e.com_goods_id
   and c.com_lot_id = f.com_lot_id(+)
   and c.stock_pos_id = g.stock_pos_id(+)
   and g.depot_id = h.com_depot_id(+)
"
"ZX_20013_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_20013_V"" (""CREDATE"", ""SSC_PICKING_CARTON_ID"", ""TRADEDTLID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CHECKERID"", ""CHECKER"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""OWNERPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""DEPOT_NAME"", ""CARTON_TYPE"", ""SCATTERCOUNT"", ""WHOLECOUNT"", ""WHOLEQTY"", ""USERMM"", ""USEDAY"", ""USEMONTH"", ""USEYEAR"") AS 
  select a.check_time as credate, --任务完成时间
       a.ssc_picking_carton_id, --IWCS任务明细ID
       a.wms_inout_id as tradedtlid, --WMS移库细单ID
       b.inv_owner_id as goodsownerid, --货主ID
       (select aa.party_name
          from com_party@cdiwcs.ly.com aa
         where aa.com_party_type_id = 1
           and aa.com_party_id = b.inv_owner_id) as goodsownername, --货主名称
       a.checker as checkerid, --复核人ID
       c.employeecode as checker, --复核人
       a.com_goods_id as ownergoodsid, --货主货品ID
       b.goods_name as goodsname, --货品名称
       b.english_name as goodsengname, --商品名
       b.goods_desc as goodstype, --规格
       (select cc.package_name
          from com_goods_package@cdiwcs.ly.com cc
         where cc.com_goods_id = a.com_goods_id
           and cc.package_type = 'UNIT') as tradepackname, --单位
       (select dd.party_name
          from com_party@cdiwcs.ly.com dd
         where dd.com_party_type_id = 4
           and dd.com_party_id = b.factory_id) as factname, --生产厂家
       b.product_location as prodarea, --产地
       a.com_lot_id as lotid, --批号ID
       d.lot_no as lotno, --批号
       a.package_id as ownerpackid, --货主货品包装ID
       a.package_name as packname, --包装名称
       a.package_num as packsize, --包装大小
       a.allocate_qty as goodsqty, --拣货数量
       f.depot_name, --出库区域
       decode(a.carton_type,
              'A',
              '零散出库',
              'C',
              '整箱出库',
              'P',
              '托盘出库',
              0) carton_type, --IWCS任务类型
       decode(a.carton_type, 'A', 1, 0) as scattercount, --散件条数
       decode(a.carton_type, 'A', 0, 1) as wholecount, --整件条数
       decode(a.carton_type, 'A', 0, a.allocate_qty / a.package_num) as wholeqty, --整件件数
       extract(year from a.check_time) * 12 +
       extract(month from a.check_time) usermm, --逻辑月
       extract(day from a.check_time) as useday, --月
       extract(month from a.check_time) as usemonth, --月
       extract(year from a.check_time) as useyear --年
  from ssc_autotoplat_picking@cdiwcs.ly.com a,
       com_goods@cdiwcs.ly.com              b,
       sys_userlist                @cdiwcs.ly.com c,
       com_lot@cdiwcs.ly.com                d,
       com_stock_pos@cdiwcs.ly.com          e,
       com_depot@cdiwcs.ly.com              f
 where a.check_status = 'TRUE'
   and a.checker = c.userid(+)
   and a.com_goods_id = b.com_goods_id
   and a.com_lot_id = d.com_lot_id(+)
   and a.stock_pos_id = e.stock_pos_id(+)
   and e.depot_id = f.com_depot_id(+)
"
"ZX_20018_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_20018_V"" (""CREDATE"", ""RECORDID"", ""DACODE"", ""INOUTID"", ""SCANERID"", ""SCANER"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""TRADEPACKNAME"", ""GOODSENGNAME"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""COMPANYID"", ""COMPANYNAME"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""USEDAY"") AS 
  select a.rffindate     as credate,--创建时间
       t.ssc_picking_carton_detail_id as recordid,--电子监管码ID
       t.dacode,--电子监管码
       t.wms_inout_id as inoutid,--出入库ID
       t.scaner        as scanerid,--录入人ID
       tt.employeecode as scaner,--录入人
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主
       a.ownergoodsid, --货主货品ID
       d.waregoodsid goodsid, --货品主档ID
       d.goodsname, --货品名称
       d.goodstype, --货品规格
       d.prodarea, --产地
       d.factname, --生产厂家
       d.tradepackname, --单位
       d.goodsengname, --商品名
       a.lotid, --批号ID
       e.lotno, --批号
       e.proddate, --生产日期
       e.validdate, --有效期至
       d.approvedocno, --批准文号
       a.companyid, --货主单位ID
       f.companyname, --货主单位
       (EXTRACT(year FROM a.rffindate)) * 12 +
       (EXTRACT(month FROM a.rffindate)) as usemm,--逻辑月
       EXTRACT(year FROM a.rffindate) as useyear,--年
       EXTRACT(month FROM a.rffindate) as usemonth,--月
       EXTRACT(day FROM a.rffindate) as useday --日
  from ssc_picking_carton_detail@cdiwcs.ly.com t,
       sys_userlist@cdiwcs.ly.com              tt,
       wms_st_io_doc                  a,
       tpl_warehouse                  b,
       tpl_goodsowner                 c,
       tpl_goods                      d,
       wms_goods_lot                  e,
       tpl_go_company                 f
 where t.scaner = tt.userid
   and a.inoutid = t.wms_inout_id
   and a.warehid = 17
   and a.warehid=b.warehid(+)
   and a.goodsownerid=c.goodsownerid(+)
   and a.ownergoodsid=d.ownergoodsid
   and a.lotid=e.lotid(+)
   and a.companyid=f.companyid(+)
"
"ZX_20019_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_20019_V"" (""DTLID"", ""CREDATE"", ""EXECDATE"", ""EMPLOYEENAME"", ""WMS_IN_SCATTERCOUNT"", ""WMS_IN_WHOLECOUNT"", ""WMS_IN_WHOLEQTY"", ""IWCS_IN_SCATTERCOUNT"", ""IWCS_IN_WHOLECOUNT"", ""IWCS_IN_WHOLEQTY"", ""WMS_OUT_SCATTERCOUNT"", ""WMS_OUT_WHOLECOUNT"", ""WMS_OUT_WHOLEQTY"", ""IWCS_OUT_SCATTERCOUNT"", ""IWCS_OUT_WHOLECOUNT"", ""IWCS_OUT_WHOLEQTY"", ""WMS_CHECK_SCOUNT"", ""WMS_CHECK_WCOUNT"", ""WMS_CHECK_WQTY"", ""IWCS_CHECK_SCOUNT"", ""IWCS_CHECK_WCOUNT"", ""IWCS_CHECK_WQTY"", ""WMS_REPLENISH_UP"", ""WMS_REPLENISH_DOWN"", ""WMS_MV_UP"", ""WMS_MV_DOWN"", ""IWCS_TRANSFER_SCOUNT"", ""IWCS_TRANSFER_WCOUNT"", ""IWCS_TRANSFER_WQTY"", ""IWCS_BOXTRANSFER_COUNT"", ""IWCS_GROUNDUP_COUNT"", ""IWCS_GROUNDUP_WQTY"", ""IWCS_MVOUT_SCOUNT"", ""IWCS_MVOUT_WCOUNT"", ""IWCS_MVOUT_WQTY"", ""TCM_IN_SCATTERCOUNT"", ""TCM_IN_KGQTY"", ""TCM_OUT_SCATTERCOUNT"", ""TCM_OUT_KGQTY"", ""TCM_CHECK_SQTY"", ""TCM_CHECK_KGQTY"", ""TCM_MV_UP"", ""TCM_MV_DOWN"", ""ECODEQTY"", ""TCM_MV_UP_KGQTY"", ""TCM_MV_DOWN_KGQTY"", ""USEMM"", ""USEYEAR"", ""USEMONTH"", ""USEDAY"", ""ISRESTDAY"") AS 
  select a.dtlid,--明细ID
       a.credate,--作业日期
       a.execdate,--生成日期
       a.employeename,--操作人
       a.wms_in_scattercount,--平库上架散件条数
       a.wms_in_wholecount,--平库上架整件条数
       a.wms_in_wholeqty,--平库上架整件件数
       a.iwcs_in_scattercount,--自动库上架散件条数
       a.iwcs_in_wholecount,--自动库上架整件条数
       a.iwcs_in_wholeqty,--自动库上架整件件数
       a.wms_out_scattercount,--平库拣货散件条数
       a.wms_out_wholecount,--平库拣货整件条数
       a.wms_out_wholeqty,--平库拣货整件件数
       a.iwcs_out_scattercount,--自动库拣货散件条数
       a.iwcs_out_wholecount,--自动库拣货整件条数
       a.iwcs_out_wholeqty,--自动库拣货整件件数
       a.wms_check_scount,--平库复核散件条数
       a.wms_check_wcount,--平库复核整件条数
       a.wms_check_wqty,--平库复核整件件数
       a.iwcs_check_scount,--自动库复核散件条数
       a.iwcs_check_wcount,--自动库复核整件条数
       a.iwcs_check_wqty,--自动库复核整件件数
       a.wms_replenish_up,--平库补货上架条数
       a.wms_replenish_down,--平库补货下架条数
       a.wms_mv_up,--平库移位上架条数
       a.wms_mv_down,--平库移位下架条数
       a.iwcs_transfer_scount,--自动库补货移位上架散件条数
       a.iwcs_transfer_wcount,--自动库补货移位上架整件条数
       a.iwcs_transfer_wqty,--自动库补货移位上架整件件数
       a.iwcs_boxtransfer_count,--自动库倒箱条数
       a.iwcs_groundup_count,--自动库地堆上架条数
       a.iwcs_groundup_wqty,--自动库地堆上架整件件数
       a.iwcs_mvout_scount,--自动库移位出散件条数
       a.iwcs_mvout_wcount,--自动库移位出整件条数
       a.iwcs_mvout_wqty,--自动库移位出整件件数
       a.tcm_in_scattercount,--中药上架条数
       a.tcm_in_kgqty,--中药上架公斤数
       a.tcm_out_scattercount,--中药拣货条数
       a.tcm_out_kgqty,--中药拣货公斤数
       a.tcm_check_sqty,--中药复核条数
       a.tcm_check_kgqty,--中药复核公斤数
       a.tcm_mv_up,--中药移位上架条数
       a.tcm_mv_down,--中药移位下架条数
       a.ecodeqty,--电子监管码采集数,
       a.tcm_mv_up_kgqty,--中药移位上架公斤数
       a.tcm_mv_down_kgqty,--中药移位下架公斤数
       (EXTRACT(year FROM a.credate)) * 12 +
       (EXTRACT(month FROM a.credate)) as usemm,--逻辑月
       EXTRACT(year FROM a.credate) as useyear,--年
       EXTRACT(month FROM a.credate) as usemonth,--月
       EXTRACT(day FROM a.credate) as useday, --日
       (select x.isrestday from wms_work_calendar x where trunc(x.calendardate)=trunc(a.credate)) as isrestday --是否休息日
  from wms_workload_dtl_sc a
"
"ZX_21001_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_21001_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CHECKDATE"", ""CREDATE"", ""OPERATIONTYPE"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""COMPANYID"", ""COMPANYNAME"", ""SUPPLYERADDRESS"", ""SUPPLYERCONNPHONE"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""APPROVEDOCNO"", ""LOTID"", ""LOTNO"", ""PRODLICENSENO"", ""PRODDATE"", ""VALIDDATE"", ""UDI_CODE"", ""GOODSQTY"", ""TRADEPACKNAME"", ""TRANSCONDITION"", ""STORAGECONDITION"", ""DECISIONFLAG"", ""QUALIFIEDQTY"", ""UNQUALIFIEDMEMO"", ""CHECKMEMO"", ""CHECKMANID"", ""CHECKMAN"", ""CHECKID"") AS 
  select a.warehid, --物流中心ID
       c.warehname, --物流中心
       a.goodsownerid, --货主ID
       d.goodsownername, --货主名称
       b.checkdate, --验收日期
       i.credate, --购货日期
       i.operationtype, --业务类型
       b.ownergoodsid,--货主货品ID
       b.goodsid, --货品主档ID
       f.goodsownid,--货主原货品ID
       a.companyid,--来货单位ID
       e.companyname, --供货者名称
       e.supplyeraddress, --供货者地址
       e.supplyerconnphone, --供货者联系方式
       f.goodsname, --医疗器械名称
       f.mah, --医疗器械注册人/备案人
       f.factname, --受托生产企业名称
       f.goodstype, --规格/型号
       f.approvedocno, --医疗器械注册证编号/备案编号
       a.lotid,--批号ID
       g.lotno, --医疗器械的生产批号/序列号
       f.prodlicenseno, --生产许可证号
       g.proddate, --生产日期
       decode(to_char(g.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              g.validdate) validdate, --使用期限/失效日期
       f.udi_code, --医疗器械唯一标识
       a.goodsqty, --数量
       f.tradepackname, --单位
       (select t.transclass
          from wms_goods_feature t
         where t.warehid = a.warehid
           and t.goodsid = a.goodsid) transcondition, --运输条件
       f.storagecondition, --贮存条件
       decode(a.quanstatus, 1, 1, 2, 3, 3, 2, 4) decisionflag, --验收结论
       decode(a.goodsstatusid, 1, a.goodsqty, 9, a.goodsqty, 0) qualifiedqty, --验收合格数量
       b.unqualifiedmemo, -- 处置措施
       decode(b.unqualifiedmemo, null, null, b.checkmemo) as checkmemo, --不合格事项
       a.inputmanid checkmanid,--验收员ID
       h.employeename checkman, --验收人员
       a.checkid--验收记录ID
  from gsp_physic_quality_check a,
       wms_receive_dtl          b,
       tpl_warehouse            c,
       tpl_goodsowner           d,
       tpl_go_company           e,
       tpl_goods                f,
       wms_goods_lot            g,
       pub_employee             h,
       wms_in_order             i,
       wms_in_order_dtl         j
 where a.receiveid = b.receiveid
   and j.indtlid = b.indtlid
   and i.inid = j.inid
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.companyid = e.companyid(+)
   and b.ownergoodsid = f.ownergoodsid(+)
   and a.lotid = g.lotid(+)
   and a.inputmanid = h.employeeid(+)
   and exists (select 1
          from tpl_goodsowner x1
         where x1.goodsownerid = a.goodsownerid
           and x1.innerflag = 1) --内部货主
   and exists (select 1
          from wms_goods_feature x, pub_ddl_dtl y
         where x.goodsclass = y.ddlid
           and y.sysid = 9
           and nvl(y.qxflag, 0) = 1
           and a.warehid = x.warehid
           and a.goodsid = x.goodsid) --器械WMS货品分类
--医疗器械进货检查记录明细查询
"
"ZX_21002_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_21002_V"" (""INOUTID"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CREDATE"", ""RFFINDATE"", ""KEEPDATE"", ""COMPANYID"", ""COMPANYNAME"", ""SOURCEID"", ""OPERATIONTYPE"", ""USESTATUS"", ""RFFLAG"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""APPROVEDOCNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""UDI_CODE"", ""GOODSQTY"", ""TRADEPACKNAME"", ""INGOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""AREAID"", ""AREANAME"", ""AREATYPE"", ""AREAFLAG"", ""SECTIONID"", ""SECTIONNAME"", ""POSID"", ""POSNO"", ""POSNAME"", ""RFMANID"", ""RFMAN"", ""KEEPMANID"", ""KEEPMAN"", ""PRODLICENSENO"", ""FINISHDATE"", ""INCHECKMANID"", ""INCHECKMAN"") AS 
  select a.inoutid, --出入库ID
       a.warehid, --物流中心ID
       b.warehname, --物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.credate, --创建时间
       a.rffindate, --任务完成时间
       a.keepdate, --记账日期
       g.companyid, --来货单位ID
       g.companyname, --来货单位
       a.sourceid, --来源单据ID
       a.operationtype, --业务类型
       a.usestatus, --状态
       a.rfflag, --任务状态
       a.ownergoodsid, --货主货品ID
       a.goodsid, --货品主档ID
       d.goodsownid, --货主原货品ID
       d.goodsname, --医疗器械名称
       d.mah, --医疗器械注册人/备案人
       d.factname, --受托生产企业名称
       d.goodstype, --规格/型号
       d.approvedocno, --医疗器械注册证编号/备案编号
       a.lotid, --批号ID
       e.lotno, --医疗器械的生产批号/序列号
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate, --使用期限/失效日期
       d.udi_code, --医疗器械唯一标识
       a.goodsqty, --数量
       d.tradepackname, --单位
       a.ingoodsqty, --入库数量
       a.wholeqty, --整件数量
       a.scatterqty, --散件数量
       a.goodsstatusid, --货品状态ID
       h.goodsstatus, --货品状态
       h.quantitystatus, --质量状态
       a.goodspackid, --包装单位ID
       i.packname, --包装单位
       i.packsize, --包装大小
       j.areaid, --库区ID
       l.areaname, --库区名称
       l.areatype, --库区类型
       l.areaflag, --存放类型
       j.sectionid, --分区ID
       k.sectionname, --分区名称,
       a.posid, --货位ID
       j.posno, --货位编号
       j.posname, --货位名称
       a.rfmanid, --任务执行人ID
       f.employeename as rfman, --任务执行人
       a.keepmanid, --记账人ID
       m.employeename as keepman, --记账人
       d.prodlicenseno, --生产许可证号/备案编号
       n.finishdate, --入库时间（任务完成时间）
       (select x.inputmanid
          from wms_receive_dtl x
         where x.receiveid = a.sourceid
           and a.comefrom = 1) as incheckmanid, --验收员ID
       (select y.employeename
          from wms_receive_dtl x, pub_employee y
         where x.receiveid = a.sourceid
           and a.comefrom = 1
           and x.inputmanid = y.employeeid(+)) as incheckman --验收员
  from wms_st_io_doc       a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       wms_goods_lot       e,
       pub_employee        f,
       tpl_go_company      g,
       wms_goodsstatus     h,
       tpl_pub_goods_packs i,
       wms_pos_def         j,
       wms_st_section_def  k,
       wms_st_area_def     l,
       pub_employee        m,
       wms_task_doc        n
 where a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.ownergoodsid = d.ownergoodsid(+)
   and a.lotid = e.lotid(+)
   and a.rfmanid = f.employeeid(+)
   and a.companyid = g.companyid(+)
   and a.goodsstatusid = h.goodsstatusid(+)
   and a.goodspackid = i.goodspackid
   and a.posid = j.posid(+)
   and j.sectionid = k.sectionid(+)
   and j.areaid = l.areaid(+)
   and a.keepmanid = m.employeeid(+)
   and a.comefrom = 1 --入库
   and a.taskid = n.taskid(+)
   and exists (select 1
          from tpl_goodsowner x1
         where x1.goodsownerid = a.goodsownerid
           and x1.innerflag = 1)
   and exists (select 1
          from wms_goods_feature x, pub_ddl_dtl y
         where x.goodsclass = y.ddlid
           and y.sysid = 9
           and nvl(y.qxflag, 0) = 1
           and a.warehid = x.warehid
           and a.goodsid = x.goodsid) --器械WMS货品分类
--医疗器械入库记录明细查询
"
"ZX_21003_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_21003_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""KEEPDATE"", ""OUTDATE"", ""COMPANYID"", ""BUYER"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""APPROVEDOCNO"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""UDI_CODE"", ""GOODSQTY"", ""TRADEPACKNAME"", ""TRANSCONDITION"", ""STORAGECONDITION"", ""QUANSTATUS"", ""CHECKMANID"", ""CHECKMAN"", ""INOUTID"") AS 
  select a.warehid,--物流中心ID
       b.warehname,--物流中心
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.keepdate, --复核日期
       a.keepdate as outdate, --出库日期
       g.companyid,--客户单位ID
       g.companyname as buyer,--客户
       a.ownergoodsid,--货主货品ID
       a.goodsid, --货品主档ID
       d.goodsownid,--货主原货品ID
       d.goodsname, --医疗器械名称
       d.mah, --医疗器械注册人/备案人
       d.factname, --受托生产企业名称
       d.goodstype, --规格/型号
       d.approvedocno, --医疗器械注册证编号/备案编号
       a.lotid,--批号ID
       e.lotno, --医疗器械的生产批号/序列号
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate, --使用期限/失效日期
       d.udi_code, --医疗器械唯一标识
       a.goodsqty, --复核数量
       d.tradepackname, --单位
       (select t.transclass from wms_goods_feature t where t.warehid=a.warehid and t.goodsid=a.goodsid) transcondition, --运输条件
       d.storagecondition, --贮存条件
       a.quanstatus, --复核质量状况
       a.checkmanid,--复核人员ID
       f.employeename checkman, --复核人员
       a.inoutid--出入库ID
  from gsp_st_io_record a,
       tpl_warehouse    b,
       tpl_goodsowner   c,
       tpl_goods        d,
       wms_goods_lot    e,
       pub_employee     f,
       tpl_go_company   g
 where a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.ownergoodsid = d.ownergoodsid(+)
   and a.lotid = e.lotid(+)
   and a.checkmanid = f.employeeid(+)
   and a.companyid=g.companyid(+)
   and exists (select 1 from tpl_goodsowner x1 where x1.goodsownerid=a.goodsownerid and x1.innerflag=1) --内部货主
   and exists (select 1
          from wms_goods_feature x, pub_ddl_dtl y
         where x.goodsclass = y.ddlid
           and y.sysid = 9
           and nvl(y.qxflag, 0) = 1
           and a.warehid = x.warehid
           and a.goodsid = x.goodsid) --器械WMS货品分类
--医疗器械出库复核记录明细查询
"
"ZX_21004_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_21004_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""WAREHADDRESS"", ""REALDISPATCHDATE"", ""GCOMPANYID"", ""COMPANYNAME"", ""TRANSID"", ""INCEPTADDR"", ""CONNPHONE"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""MAH"", ""GOODSTYPE"", ""FACTNAME"", ""APPROVEDOCNO"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""TRADEPACKNAME"", ""SOURCEID"", ""EXCARRIER"", ""DISPATCHID"", ""VEHICLEID"", ""VEHICLENO"", ""TRANSMODEL"", ""DRIVERID"", ""DRIVERNAME"", ""TRID"") AS 
  select a.warehid, --物流中心ID
       c.warehname, --物流中心
       a.goodsownerid, --货主ID
       d.goodsownername, --货主名称
       c.warehaddress,--发货地址
       i.realdispatchdate, --发货时间
       a.gcompanyid,--收货单位ID
       e.companyname, --收货单位名称
       a.transid,--收货地址ID
       f.inceptaddr, --收货地址
       f.connphone, --收货单位联系方式
       b.ownergoodsid,--货主货品ID
       b.goodsid, --货品主档ID
       g.goodsownid,--货主原货品ID
       g.goodsname, --医疗器械名称
       g.mah, --医疗器械注册人/备案人
       g.goodstype, --规格/型号
       g.factname, --受托生产企业名称
       g.approvedocno, --医疗器械注册证编号/备案编号
       b.lotid,--批号ID
       h.lotno, --生产批号/序列号
       b.goodsqty, --数量
       g.tradepackname, --单位
       a.sourceid, --货单号
       /*(select t.transclass
          from wms_goods_feature t
         where t.warehid = a.warehid
           and t.goodsid = b.goodsid) transcondition, --运输条件
       g.storagecondition, --贮存条件*/
       /*nvl(a.signdate, a.enddate) signdate, --到货时间*/
       /*decode(nvl(a.excarrier, 0), 0, 1, 2) selftranstype, --自外运标志 1-自运 2-外运*/
       a.excarrier, --承运单位名称
       a.dispatchid, --运单号
       i.vehicleid,--车辆ID
       i.vehicleno, --车牌号
       i.transmodel, --运输方式
       i.driverid,--运输人ID
       i.drivername, --运输人员
       a.trid
  from tms_tr_doc a,
       tms_luyan_tr_dtl b,
       tpl_warehouse c,
       tpl_goodsowner d,
       tpl_go_company e,
       wms_transport_address f,
       tpl_goods g,
       wms_goods_lot h,
       (select t1.realdispatchdate,
               t1.dispatchid,
               t1.vehicleid,
               t2.vehicleno,
               t1.driverid,
               t3.drivername,
               t1.transmodel
          from tms_dispatch_doc t1, tms_vehicle t2, tms_driver t3
         where t1.usestatus in (0, 4, 5) --派车单状态在途、运输完成、撤单
           and t1.vehicleid = t2.vehicleid(+)
           and t1.driverid = t3.driverid(+)
        union all
        select tt1.credate    realdispatchdate,
               tt1.dispatchid,
               tt1.vehicleid,
               tt2.vehicleno,
               tt1.driverid,
               tt3.drivername,
               26             transmodel
          from tms_luyan_dispatch_doc tt1, tms_vehicle tt2, tms_driver tt3
         where tt1.vehicleid = tt2.vehicleid(+)
           and tt1.driverid = tt3.driverid(+)) i
 where a.trid = b.trid
   and a.dispatchid = i.dispatchid
   and a.sourcetable = 1 --波次释放
   and a.comefrom = 1 --WMS转入
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.gcompanyid = e.companyid(+)
   and a.transid = f.transid(+)
   and b.ownergoodsid = g.ownergoodsid(+)
   and b.lotid = h.lotid(+)
   and exists (select 1
          from tpl_goodsowner x1
         where x1.goodsownerid = a.goodsownerid
           and x1.innerflag = 1)
   and exists (select 1
          from wms_goods_feature x, pub_ddl_dtl y
         where x.goodsclass = y.ddlid
           and y.sysid = 9
           and nvl(y.qxflag, 0) = 1
           and a.warehid = x.warehid
           and b.goodsid = x.goodsid) --器械WMS货品分类
--医疗器械运输记录明细查询
"
"ZX_21005_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_21005_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CHECKDATE"", ""COMPANYID"", ""COMPANYNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""MAH"", ""GOODSTYPE"", ""FACTNAME"", ""APPROVEDOCNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""UDI_CODE"", ""GOODSQTY"", ""TRADEPACKNAME"", ""TRANSCONDITION"", ""STORAGECONDITION"", ""QUANSTATUS"", ""UNQUALIFIEDMEMO"", ""CHECKMEMO"", ""SBREASON"", ""SHRID"", ""SHRMAN"", ""CHECKMANID"", ""CHECKMAN"", ""DHWD"", ""YSFS"", ""TRANSNAME"", ""BMSDOCID"", ""CHECKID"") AS 
  select a.warehid, --物流中心ID
       c.warehname, --物流中心
       a.goodsownerid, --货主ID
       d.goodsownername, --货主名称
       b.checkdate, --退货日期
       a.companyid, --退货单位ID
       e.companyname, --退货单位名称
       b.ownergoodsid, --货主货品ID
       b.goodsid, --货品主档ID
       f.goodsownid, --货主原货品ID
       f.goodsname, --医疗器械名称
       f.mah, --医疗器械注册人/备案人
       f.goodstype, --规格/型号
       f.factname, --受托生产企业名称
       f.approvedocno, --医疗器械注册证编号/备案编号
       a.lotid, --批号ID
       g.lotno, --医疗器械的生产批号/序列号
       g.proddate, --生产日期
       decode(to_char(g.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              g.validdate) validdate, --使用期限/失效日期
       f.udi_code, --医疗器械唯一标识
       a.goodsqty, --退货数量
       f.tradepackname, --单位
       (select t.transclass
          from wms_goods_feature t
         where t.warehid = a.warehid
           and t.goodsid = a.goodsid) transcondition, --运输条件
       f.storagecondition, --贮存条件
       a.quanstatus, --质量状态
       b.unqualifiedmemo, -- 处置措施
       b.checkmemo, --不合格事项
       j.memo as sbreason, --退货原因
       j.shrid, --收货人员ID
       k.employeename shrman, --收货人员
       a.inputmanid checkmanid, --验收人员ID
       h.employeename checkman, --验收人员
       j.dhwd, --到货温度
       j.ysfs, --运输方式ID
       l.transname, --运输方式
       i.bmsdocid, --原出库单号
       a.checkid --验收记录ID
  from gsp_physic_quality_check a,
       wms_receive_dtl          b,
       tpl_warehouse            c,
       tpl_goodsowner           d,
       tpl_go_company           e,
       tpl_goods                f,
       wms_goods_lot            g,
       pub_employee             h,
       wms_in_order             i,
       wms_in_order_dtl         j,
       pub_employee             k,
       wms_transport_mode       l
 where a.receiveid = b.receiveid
   and j.indtlid = b.indtlid
   and i.inid = j.inid
   and a.operationtype in (7, 42) --销退,收配退
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.companyid = e.companyid(+)
   and b.ownergoodsid = f.ownergoodsid(+)
   and a.lotid = g.lotid(+)
   and a.inputmanid = h.employeeid(+)
   and j.shrid = k.employeeid(+)
   and j.ysfs = l.transmodeid(+)
   and exists (select 1
          from tpl_goodsowner x1
         where x1.goodsownerid = a.goodsownerid
           and x1.innerflag = 1)
   and exists (select 1
          from wms_goods_feature x, pub_ddl_dtl y
         where x.goodsclass = y.ddlid
           and y.sysid = 9
           and nvl(y.qxflag, 0) = 1
           and a.warehid = x.warehid
           and a.goodsid = x.goodsid) --器械WMS货品分类
--医疗器械退货记录明细查询
"
"ZX_30001_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_30001_V"" (""INOUTID"", ""GOODSOWNID"", ""GOODSID"", ""CREDATE"", ""RFFINDATE"", ""KEEPDATE"", ""COMPANYID"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""DRUGFORM"", ""FACTID"", ""FACTORYNAME"", ""MAH"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""CHECKMANID"", ""CHECKMAN2ID"", ""CHECKMAN1"", ""CHECKMAN2"", ""RFMANID"", ""RFMANNAME"", ""CHECKMANA"", ""CHECKMANB"", ""CHECKMANNAME"", ""CHECKMAN2NAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""INOUTFLAG"", ""PRODAREA"", ""WHOLEQTY"", ""SCATTERQTY"", ""TRADEPACKNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""POSID"", ""POSNO"", ""POSNAME"", ""MEMO"", ""SOURCEID"", ""GOODSPACKID"", ""WAREHID"", ""WAREHNAME"") AS 
  select a.inoutid,--记录ID
       p.goodsownid,--货主原货品ID
       a.goodsid,--货品主档ID
       a.credate,--创建时间
       a.rffindate, --上架/拣货完成时间
       a.keepdate,--记账时间
       a.companyid,--供应商/客户ID
       q.companyname,--供应商/客户
       a.operationtype,--业务类型
       a.ownergoodsid,--货主货品ID
       p.goodsname,--货品名称
       p.goodstype,--规格
       p.drugform,--剂型
        c.factid,--厂家ID
       nvl(e.factname,p.factname) as factoryname,--厂家
       e.mah,--上市许可持有人
       a.lotid,--批号ID
       e.lotno,--批号
       e.proddate,--生产日期
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,--有效期至
       a.ingoodsqty,--入库数量
       a.outgoodsqty,--出库数量
       --结存数量
       decode(a.comefrom, 1, t4.inputmanid, null) checkmanid, --来源类型是入库的才显示验收人1id xyue 2019-01-03,验收员A为录入人id
       decode(a.comefrom, 1, t4.checkmanid2, null) checkman2id, --来源类型是入库的才显示验收人2id xyue 2018-08-30
       decode(a.comefrom, 1, t4.inputman, null) checkman1, --来源类型是入库的才显示验收人1 xyue 2019-01-03,验收员A为录入人
       decode(a.comefrom, 1, t4.checkman2, null) checkman2, --来源类型是入库的才显示验收人2 xyue 2018-08-30
       a.rfmanid,--上架人/拣货人ID
       i.employeename rfmanname,--上架人/拣货人
       k.employeeid checkmanA,--复核人AID
       y.employeeid checkmanB,--复核人BID
       k.employeename checkmanname,--复核人A
       y.employeename checkman2name,--复核人B
       a.GOODSOWNERID,--货主ID
       o.goodsownername,--货主
       e.approvedocno,--批准文号
       a.goodsstatusid,--货品状态ID
       g.goodsstatus,--货品状态
       g.quantitystatus,--质量状态
       a.inoutflag,--出入库类型
       p.prodarea,--产地
       a.wholeqty,--整件数量
       a.scatterqty,--散件数量
       p.tradepackname,--基本包装单位
       a.sectionid,--分区ID
       n.sectionno,--分区编码
       n.sectionname,--分区名称
       a.areaid,--库区ID
       m.areano,--库区编码
       m.areaname,--库区名称
       a.posid,--货位ID
       f.posno,--货位编码
       f.posname,--货位名称
       a.memo,--备注
       a.sourceid,--来源单据ID
       a.goodspackid,--货品包装单位ID
       a.warehid,--物流中心ID
       b.warehname--物流中心名称
       from  wms_st_io_doc        a,
             tpl_warehouse        b,
             tpl_pub_goods        c,
             tpl_pub_goods_packs  d,
             wms_goods_lot        e,
             wms_pos_def          f,
             wms_goodsstatus      g,
             pub_employee         i,
             wms_st_area_def      m,
             wms_st_section_def   n,
             tpl_goods            p,
             tpl_goodsowner       o,
             tpl_go_company       q,
             pub_employee         k,
             pub_employee         y,
             BS_BUSCOPE h,
             wms_receive_dtl_v    t4
       where a.warehid = b.warehid(+)
         and a.goodsid = c.goodsid(+)
         and a.goodspackid = d.goodspackid(+)
         and a.lotid = e.lotid(+)
         and a.posid = f.posid(+)
         and a.areaid = m.areaid(+)
         and a.sectionid = n.sectionid(+)
         and a.goodsstatusid = g.goodsstatusid(+)
         and a.rfmanid = i.employeeid(+)
         and a.ownergoodsid = p.ownergoodsid(+)
         and a.goodsownerid = o.goodsownerid(+)
         and a.companyid = q.companyid(+)
         and a.checkmanid = k.employeeid(+)
         and a.checkman2id = y.employeeid(+)
         and a.sourceid = t4.receiveid(+)
         and p.busiscopename = h.buscopename
         and a.comefrom in(1,2,3)
         and h.buscopeid in(7,296,8,297)
         and a.rfflag = 3
         and a.warehid = 1
         and o.innerflag = 1 --内部货主
"
"ZX_30002_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_30002_V"" (""INOUTID"", ""GOODSOWNID"", ""GOODSID"", ""CREDATE"", ""RFFINDATE"", ""KEEPDATE"", ""COMPANYID"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""DRUGFORM"", ""FACTID"", ""FACTORYNAME"", ""MAH"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""CHECKMANID"", ""CHECKMAN2ID"", ""CHECKMAN1"", ""CHECKMAN2"", ""RFMANID"", ""RFMANNAME"", ""CHECKMANA"", ""CHECKMANB"", ""CHECKMANNAME"", ""CHECKMAN2NAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""INOUTFLAG"", ""PRODAREA"", ""WHOLEQTY"", ""SCATTERQTY"", ""TRADEPACKNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""POSID"", ""POSNO"", ""POSNAME"", ""MEMO"", ""SOURCEID"", ""GOODSPACKID"", ""WAREHID"", ""WAREHNAME"") AS 
  select a.inoutid,--记录ID
       p.goodsownid,--货主原货品ID
       a.goodsid,--货品主档ID
       a.credate,--创建时间
       a.rffindate, --上架/拣货完成时间
       a.keepdate,--记账时间
       a.companyid,--供应商/客户ID
       q.companyname,--供应商/客户
       a.operationtype,--业务类型
       a.ownergoodsid,--货主货品ID
       p.goodsname,--货品名称
       p.goodstype,--规格
       p.drugform,--剂型
        c.factid,--厂家ID
       nvl(e.factname,p.factname) as factoryname,--厂家
       e.mah,--上市许可持有人
       a.lotid,--批号ID
       e.lotno,--批号
       e.proddate,--生产日期
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,--有效期至
       a.ingoodsqty,--入库数量
       a.outgoodsqty,--出库数量
       --结存数量
       decode(a.comefrom, 1, t4.inputmanid, null) checkmanid, --来源类型是入库的才显示验收人1id xyue 2019-01-03,验收员A为录入人id
       decode(a.comefrom, 1, t4.checkmanid2, null) checkman2id, --来源类型是入库的才显示验收人2id xyue 2018-08-30
       decode(a.comefrom, 1, t4.inputman, null) checkman1, --来源类型是入库的才显示验收人1 xyue 2019-01-03,验收员A为录入人
       decode(a.comefrom, 1, t4.checkman2, null) checkman2, --来源类型是入库的才显示验收人2 xyue 2018-08-30
       a.rfmanid,--上架人/拣货人ID
       i.employeename rfmanname,--上架人/拣货人
       k.employeeid checkmanA,--复核人AID
       y.employeeid checkmanB,--复核人BID
       k.employeename checkmanname,--复核人A
       y.employeename checkman2name,--复核人B
       a.GOODSOWNERID,--货主ID
       o.goodsownername,--货主
       e.approvedocno,--批准文号
       a.goodsstatusid,--货品状态ID
       g.goodsstatus,--货品状态
       g.quantitystatus,--质量状态
       a.inoutflag,--出入库类型
       p.prodarea,--产地
       a.wholeqty,--整件数量
       a.scatterqty,--散件数量
       p.tradepackname,--基本包装单位
       a.sectionid,--分区ID
       n.sectionno,--分区编码
       n.sectionname,--分区名称
       a.areaid,--库区ID
       m.areano,--库区编码
       m.areaname,--库区名称
       a.posid,--货位ID
       f.posno,--货位编码
       f.posname,--货位名称
       a.memo,--备注
       a.sourceid,--来源单据ID
       a.goodspackid,--货品包装单位ID
       a.warehid,--物流中心ID
       b.warehname--物流中心名称
       from  wms_st_io_doc        a,
             tpl_warehouse        b,
             tpl_pub_goods        c,
             tpl_pub_goods_packs  d,
             wms_goods_lot        e,
             wms_pos_def          f,
             wms_goodsstatus      g,
             pub_employee         i,
             wms_st_area_def      m,
             wms_st_section_def   n,
             tpl_goods            p,
             tpl_goodsowner       o,
             tpl_go_company       q,
             pub_employee         k,
             pub_employee         y,
             BS_BUSCOPE h,
             wms_receive_dtl_v    t4
       where a.warehid = b.warehid(+)
         and a.goodsid = c.goodsid(+)
         and a.goodspackid = d.goodspackid(+)
         and a.lotid = e.lotid(+)
         and a.posid = f.posid(+)
         and a.areaid = m.areaid(+)
         and a.sectionid = n.sectionid(+)
         and a.goodsstatusid = g.goodsstatusid(+)
         and a.rfmanid = i.employeeid(+)
         and a.ownergoodsid = p.ownergoodsid(+)
         and a.goodsownerid = o.goodsownerid(+)
         and a.companyid = q.companyid(+)
         and a.checkmanid = k.employeeid(+)
         and a.checkman2id = y.employeeid(+)
         and a.sourceid = t4.receiveid(+)
         and p.busiscopename = h.buscopename
         and a.comefrom in(1,2,3)
         and h.buscopeid in(298,9)
         and a.rfflag = 3
         and a.warehid = 1
         and o.innerflag = 1 --内部货主
"
"ZX_30003_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_30003_V"" (""INOUTID"", ""GOODSOWNID"", ""GOODSID"", ""CREDATE"", ""RFFINDATE"", ""KEEPDATE"", ""COMPANYID"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""DRUGFORM"", ""FACTID"", ""FACTORYNAME"", ""MAH"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""CHECKMANID"", ""CHECKMAN2ID"", ""CHECKMAN1"", ""CHECKMAN2"", ""RFMANID"", ""RFMANNAME"", ""CHECKMANA"", ""CHECKMANB"", ""CHECKMANNAME"", ""CHECKMAN2NAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""INOUTFLAG"", ""PRODAREA"", ""WHOLEQTY"", ""SCATTERQTY"", ""TRADEPACKNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""POSID"", ""POSNO"", ""POSNAME"", ""MEMO"", ""SOURCEID"", ""GOODSPACKID"", ""WAREHID"", ""WAREHNAME"") AS 
  select a.inoutid,--记录ID
       p.goodsownid,--货主原货品ID
       a.goodsid,--货品主档ID
       a.credate,--创建时间
       a.rffindate, --上架/拣货完成时间
       a.keepdate,--记账时间
       a.companyid,--供应商/客户ID
       q.companyname,--供应商/客户
       a.operationtype,--业务类型
       a.ownergoodsid,--货主货品ID
       p.goodsname,--货品名称
       p.goodstype,--规格
       p.drugform,--剂型
        c.factid,--厂家ID
       nvl(e.factname,p.factname) as factoryname,--厂家
       e.mah,--上市许可持有人
       a.lotid,--批号ID
       e.lotno,--批号
       e.proddate,--生产日期
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,--有效期至
       a.ingoodsqty,--入库数量
       a.outgoodsqty,--出库数量
       --结存数量
       decode(a.comefrom, 1, t4.inputmanid, null) checkmanid, --来源类型是入库的才显示验收人1id xyue 2019-01-03,验收员A为录入人id
       decode(a.comefrom, 1, t4.checkmanid2, null) checkman2id, --来源类型是入库的才显示验收人2id xyue 2018-08-30
       decode(a.comefrom, 1, t4.inputman, null) checkman1, --来源类型是入库的才显示验收人1 xyue 2019-01-03,验收员A为录入人
       decode(a.comefrom, 1, t4.checkman2, null) checkman2, --来源类型是入库的才显示验收人2 xyue 2018-08-30
       a.rfmanid,--上架人/拣货人ID
       i.employeename rfmanname,--上架人/拣货人
       k.employeeid checkmanA,--复核人AID
       y.employeeid checkmanB,--复核人BID
       k.employeename checkmanname,--复核人A
       y.employeename checkman2name,--复核人B
       a.GOODSOWNERID,--货主ID
       o.goodsownername,--货主
       e.approvedocno,--批准文号
       a.goodsstatusid,--货品状态ID
       g.goodsstatus,--货品状态
       g.quantitystatus,--质量状态
       a.inoutflag,--出入库类型
       p.prodarea,--产地
       a.wholeqty,--整件数量
       a.scatterqty,--散件数量
       p.tradepackname,--基本包装单位
       a.sectionid,--分区ID
       n.sectionno,--分区编码
       n.sectionname,--分区名称
       a.areaid,--库区ID
       m.areano,--库区编码
       m.areaname,--库区名称
       a.posid,--货位ID
       f.posno,--货位编码
       f.posname,--货位名称
       a.memo,--备注
       a.sourceid,--来源单据ID
       a.goodspackid,--货品包装单位ID
       a.warehid,--物流中心ID
       b.warehname--物流中心名称
       from  wms_st_io_doc        a,
             tpl_warehouse        b,
             tpl_pub_goods        c,
             tpl_pub_goods_packs  d,
             wms_goods_lot        e,
             wms_pos_def          f,
             wms_goodsstatus      g,
             pub_employee         i,
             wms_st_area_def      m,
             wms_st_section_def   n,
             tpl_goods            p,
             tpl_goodsowner       o,
             tpl_go_company       q,
             pub_employee         k,
             pub_employee         y,
             BS_BUSCOPE h,
             wms_receive_dtl_v    t4
       where a.warehid = b.warehid(+)
         and a.goodsid = c.goodsid(+)
         and a.goodspackid = d.goodspackid(+)
         and a.lotid = e.lotid(+)
         and a.posid = f.posid(+)
         and a.areaid = m.areaid(+)
         and a.sectionid = n.sectionid(+)
         and a.goodsstatusid = g.goodsstatusid(+)
         and a.rfmanid = i.employeeid(+)
         and a.ownergoodsid = p.ownergoodsid(+)
         and a.goodsownerid = o.goodsownerid(+)
         and a.companyid = q.companyid(+)
         and a.checkmanid = k.employeeid(+)
         and a.checkman2id = y.employeeid(+)
         and a.sourceid = t4.receiveid(+)
         and p.busiscopename = h.buscopename
         and a.comefrom in(1,2,3)
         and h.buscopeid in(11,299)
         and a.rfflag = 3
         and a.warehid = 1
         and o.innerflag = 1 --内部货主
"
"ZX_30004_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_30004_V"" (""INOUTID"", ""GOODSOWNID"", ""GOODSID"", ""CREDATE"", ""RFFINDATE"", ""KEEPDATE"", ""COMPANYID"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""DRUGFORM"", ""FACTID"", ""FACTORYNAME"", ""MAH"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""CHECKMANID"", ""CHECKMAN2ID"", ""CHECKMAN1"", ""CHECKMAN2"", ""RFMANID"", ""RFMANNAME"", ""CHECKMANA"", ""CHECKMANB"", ""CHECKMANNAME"", ""CHECKMAN2NAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""INOUTFLAG"", ""PRODAREA"", ""WHOLEQTY"", ""SCATTERQTY"", ""TRADEPACKNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""POSID"", ""POSNO"", ""POSNAME"", ""MEMO"", ""SOURCEID"", ""GOODSPACKID"", ""WAREHID"", ""WAREHNAME"") AS 
  select a.inoutid,--记录ID
       p.goodsownid,--货主原货品ID
       a.goodsid,--货品主档ID
       a.credate,--创建时间
       a.rffindate, --上架/拣货完成时间
       a.keepdate,--记账时间
       a.companyid,--供应商/客户ID
       q.companyname,--供应商/客户
       a.operationtype,--业务类型
       a.ownergoodsid,--货主货品ID
       p.goodsname,--货品名称
       p.goodstype,--规格
       p.drugform,--剂型
        c.factid,--厂家ID
       nvl(e.factname,p.factname) as factoryname,--厂家
       e.mah,--上市许可持有人
       a.lotid,--批号ID
       e.lotno,--批号
       e.proddate,--生产日期
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,--有效期至
       a.ingoodsqty,--入库数量
       a.outgoodsqty,--出库数量
       --结存数量
       decode(a.comefrom, 1, t4.inputmanid, null) checkmanid, --来源类型是入库的才显示验收人1id xyue 2019-01-03,验收员A为录入人id
       decode(a.comefrom, 1, t4.checkmanid2, null) checkman2id, --来源类型是入库的才显示验收人2id xyue 2018-08-30
       decode(a.comefrom, 1, t4.inputman, null) checkman1, --来源类型是入库的才显示验收人1 xyue 2019-01-03,验收员A为录入人
       decode(a.comefrom, 1, t4.checkman2, null) checkman2, --来源类型是入库的才显示验收人2 xyue 2018-08-30
       a.rfmanid,--上架人/拣货人ID
       i.employeename rfmanname,--上架人/拣货人
       k.employeeid checkmanA,--复核人AID
       y.employeeid checkmanB,--复核人BID
       k.employeename checkmanname,--复核人A
       y.employeename checkman2name,--复核人B
       a.GOODSOWNERID,--货主ID
       o.goodsownername,--货主
       e.approvedocno,--批准文号
       a.goodsstatusid,--货品状态ID
       g.goodsstatus,--货品状态
       g.quantitystatus,--质量状态
       a.inoutflag,--出入库类型
       p.prodarea,--产地
       a.wholeqty,--整件数量
       a.scatterqty,--散件数量
       p.tradepackname,--基本包装单位
       a.sectionid,--分区ID
       n.sectionno,--分区编码
       n.sectionname,--分区名称
       a.areaid,--库区ID
       m.areano,--库区编码
       m.areaname,--库区名称
       a.posid,--货位ID
       f.posno,--货位编码
       f.posname,--货位名称
       a.memo,--备注
       a.sourceid,--来源单据ID
       a.goodspackid,--货品包装单位ID
       a.warehid,--物流中心ID
       b.warehname--物流中心名称
       from  wms_st_io_doc        a,
             tpl_warehouse        b,
             tpl_pub_goods        c,
             tpl_pub_goods_packs  d,
             wms_goods_lot        e,
             wms_pos_def          f,
             wms_goodsstatus      g,
             pub_employee         i,
             wms_st_area_def      m,
             wms_st_section_def   n,
             tpl_goods            p,
             tpl_goodsowner       o,
             tpl_go_company       q,
             pub_employee         k,
             pub_employee         y,
             BS_BUSCOPE h,
             wms_receive_dtl_v    t4
       where a.warehid = b.warehid(+)
         and a.goodsid = c.goodsid(+)
         and a.goodspackid = d.goodspackid(+)
         and a.lotid = e.lotid(+)
         and a.posid = f.posid(+)
         and a.areaid = m.areaid(+)
         and a.sectionid = n.sectionid(+)
         and a.goodsstatusid = g.goodsstatusid(+)
         and a.rfmanid = i.employeeid(+)
         and a.ownergoodsid = p.ownergoodsid(+)
         and a.goodsownerid = o.goodsownerid(+)
         and a.companyid = q.companyid(+)
         and a.checkmanid = k.employeeid(+)
         and a.checkman2id = y.employeeid(+)
         and a.sourceid = t4.receiveid(+)
         and p.busiscopename = h.buscopename
         and a.comefrom in(1,2,3)
         and h.buscopeid in(10)
         and a.rfflag = 3
         and a.warehid = 1
         and o.innerflag = 1 --内部货主
"
"ZX_30005_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_30005_V"" (""INOUTID"", ""GOODSOWNID"", ""GOODSID"", ""CREDATE"", ""RFFINDATE"", ""KEEPDATE"", ""COMPANYID"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""DRUGFORM"", ""FACTID"", ""FACTORYNAME"", ""MAH"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""CHECKMANID"", ""CHECKMAN2ID"", ""CHECKMAN1"", ""CHECKMAN2"", ""RFMANID"", ""RFMANNAME"", ""CHECKMANA"", ""CHECKMANB"", ""CHECKMANNAME"", ""CHECKMAN2NAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""INOUTFLAG"", ""PRODAREA"", ""WHOLEQTY"", ""SCATTERQTY"", ""TRADEPACKNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""POSID"", ""POSNO"", ""POSNAME"", ""MEMO"", ""SOURCEID"", ""GOODSPACKID"", ""WAREHID"", ""WAREHNAME"") AS 
  select a.inoutid,--记录ID
       p.goodsownid,--货主原货品ID
       a.goodsid,--货品主档ID
       a.credate,--创建时间
       a.rffindate, --上架/拣货完成时间
       a.keepdate,--记账时间
       a.companyid,--供应商/客户ID
       q.companyname,--供应商/客户
       a.operationtype,--业务类型
       a.ownergoodsid,--货主货品ID
       p.goodsname,--货品名称
       p.goodstype,--规格
       p.drugform,--剂型
        c.factid,--厂家ID
       nvl(e.factname,p.factname) as factoryname,--厂家
       e.mah,--上市许可持有人
       a.lotid,--批号ID
       e.lotno,--批号
       e.proddate,--生产日期
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,--有效期至
       a.ingoodsqty,--入库数量
       a.outgoodsqty,--出库数量
       --结存数量
       decode(a.comefrom, 1, t4.inputmanid, null) checkmanid, --来源类型是入库的才显示验收人1id xyue 2019-01-03,验收员A为录入人id
       decode(a.comefrom, 1, t4.checkmanid2, null) checkman2id, --来源类型是入库的才显示验收人2id xyue 2018-08-30
       decode(a.comefrom, 1, t4.inputman, null) checkman1, --来源类型是入库的才显示验收人1 xyue 2019-01-03,验收员A为录入人
       decode(a.comefrom, 1, t4.checkman2, null) checkman2, --来源类型是入库的才显示验收人2 xyue 2018-08-30
       a.rfmanid,--上架人/拣货人ID
       i.employeename rfmanname,--上架人/拣货人
       k.employeeid checkmanA,--复核人AID
       y.employeeid checkmanB,--复核人BID
       k.employeename checkmanname,--复核人A
       y.employeename checkman2name,--复核人B
       a.GOODSOWNERID,--货主ID
       o.goodsownername,--货主
       e.approvedocno,--批准文号
       a.goodsstatusid,--货品状态ID
       g.goodsstatus,--货品状态
       g.quantitystatus,--质量状态
       a.inoutflag,--出入库类型
       p.prodarea,--产地
       a.wholeqty,--整件数量
       a.scatterqty,--散件数量
       p.tradepackname,--基本包装单位
       a.sectionid,--分区ID
       n.sectionno,--分区编码
       n.sectionname,--分区名称
       a.areaid,--库区ID
       m.areano,--库区编码
       m.areaname,--库区名称
       a.posid,--货位ID
       f.posno,--货位编码
       f.posname,--货位名称
       a.memo,--备注
       a.sourceid,--来源单据ID
       a.goodspackid,--货品包装单位ID
       a.warehid,--物流中心ID
       b.warehname--物流中心名称
       from  wms_st_io_doc        a,
             tpl_warehouse        b,
             tpl_pub_goods        c,
             tpl_pub_goods_packs  d,
             wms_goods_lot        e,
             wms_pos_def          f,
             wms_goodsstatus      g,
             pub_employee         i,
             wms_st_area_def      m,
             wms_st_section_def   n,
             tpl_goods            p,
             tpl_goodsowner       o,
             tpl_go_company       q,
             pub_employee         k,
             pub_employee         y,
             BS_BUSCOPE h,
             wms_receive_dtl_v    t4
       where a.warehid = b.warehid(+)
         and a.goodsid = c.goodsid(+)
         and a.goodspackid = d.goodspackid(+)
         and a.lotid = e.lotid(+)
         and a.posid = f.posid(+)
         and a.areaid = m.areaid(+)
         and a.sectionid = n.sectionid(+)
         and a.goodsstatusid = g.goodsstatusid(+)
         and a.rfmanid = i.employeeid(+)
         and a.ownergoodsid = p.ownergoodsid(+)
         and a.goodsownerid = o.goodsownerid(+)
         and a.companyid = q.companyid(+)
         and a.checkmanid = k.employeeid(+)
         and a.checkman2id = y.employeeid(+)
         and a.sourceid = t4.receiveid(+)
         and p.busiscopename = h.buscopename
         and a.comefrom in(1,2,3)
         and h.buscopeid in(14,15,16)
         and a.rfflag = 3
         and a.warehid = 1
         and o.innerflag = 1 --内部货主
"
"ZX_30006_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_30006_V"" (""INOUTID"", ""GOODSOWNID"", ""GOODSID"", ""CREDATE"", ""RFFINDATE"", ""KEEPDATE"", ""COMPANYID"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""DRUGFORM"", ""FACTID"", ""FACTORYNAME"", ""MAH"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""INGOODSQTY"", ""OUTGOODSQTY"", ""CHECKMANID"", ""CHECKMAN2ID"", ""CHECKMAN1"", ""CHECKMAN2"", ""RFMANID"", ""RFMANNAME"", ""CHECKMANA"", ""CHECKMANB"", ""CHECKMANNAME"", ""CHECKMAN2NAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""INOUTFLAG"", ""PRODAREA"", ""WHOLEQTY"", ""SCATTERQTY"", ""TRADEPACKNAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""POSID"", ""POSNO"", ""POSNAME"", ""MEMO"", ""SOURCEID"", ""GOODSPACKID"", ""WAREHID"", ""WAREHNAME"") AS 
  select a.inoutid,--记录ID
       p.goodsownid,--货主原货品ID
       a.goodsid,--货品主档ID
       a.credate,--创建时间
       a.rffindate, --上架/拣货完成时间
       a.keepdate,--记账时间
       a.companyid,--供应商/客户ID
       q.companyname,--供应商/客户
       a.operationtype,--业务类型
       a.ownergoodsid,--货主货品ID
       p.goodsname,--货品名称
       p.goodstype,--规格
       p.drugform,--剂型
        c.factid,--厂家ID
       nvl(e.factname,p.factname) as factoryname,--厂家
       e.mah,--上市许可持有人
       a.lotid,--批号ID
       e.lotno,--批号
       e.proddate,--生产日期
       decode(to_char(e.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              e.validdate) validdate,--有效期至
       a.ingoodsqty,--入库数量
       a.outgoodsqty,--出库数量
       --结存数量
       decode(a.comefrom, 1, t4.inputmanid, null) checkmanid, --来源类型是入库的才显示验收人1id xyue 2019-01-03,验收员A为录入人id
       decode(a.comefrom, 1, t4.checkmanid2, null) checkman2id, --来源类型是入库的才显示验收人2id xyue 2018-08-30
       decode(a.comefrom, 1, t4.inputman, null) checkman1, --来源类型是入库的才显示验收人1 xyue 2019-01-03,验收员A为录入人
       decode(a.comefrom, 1, t4.checkman2, null) checkman2, --来源类型是入库的才显示验收人2 xyue 2018-08-30
       a.rfmanid,--上架人/拣货人ID
       i.employeename rfmanname,--上架人/拣货人
       k.employeeid checkmanA,--复核人AID
       y.employeeid checkmanB,--复核人BID
       k.employeename checkmanname,--复核人A
       y.employeename checkman2name,--复核人B
       a.GOODSOWNERID,--货主ID
       o.goodsownername,--货主
       e.approvedocno,--批准文号
       a.goodsstatusid,--货品状态ID
       g.goodsstatus,--货品状态
       g.quantitystatus,--质量状态
       a.inoutflag,--出入库类型
       p.prodarea,--产地
       a.wholeqty,--整件数量
       a.scatterqty,--散件数量
       p.tradepackname,--基本包装单位
       a.sectionid,--分区ID
       n.sectionno,--分区编码
       n.sectionname,--分区名称
       a.areaid,--库区ID
       m.areano,--库区编码
       m.areaname,--库区名称
       a.posid,--货位ID
       f.posno,--货位编码
       f.posname,--货位名称
       a.memo,--备注
       a.sourceid,--来源单据ID
       a.goodspackid,--货品包装单位ID
       a.warehid,--物流中心ID
       b.warehname--物流中心名称
       from  wms_st_io_doc        a,
             tpl_warehouse        b,
             tpl_pub_goods        c,
             tpl_pub_goods_packs  d,
             wms_goods_lot        e,
             wms_pos_def          f,
             wms_goodsstatus      g,
             pub_employee         i,
             wms_st_area_def      m,
             wms_st_section_def   n,
             tpl_goods            p,
             tpl_goodsowner       o,
             tpl_go_company       q,
             pub_employee         k,
             pub_employee         y,
             BS_BUSCOPE h,
             wms_receive_dtl_v    t4
       where a.warehid = b.warehid(+)
         and a.goodsid = c.goodsid(+)
         and a.goodspackid = d.goodspackid(+)
         and a.lotid = e.lotid(+)
         and a.posid = f.posid(+)
         and a.areaid = m.areaid(+)
         and a.sectionid = n.sectionid(+)
         and a.goodsstatusid = g.goodsstatusid(+)
         and a.rfmanid = i.employeeid(+)
         and a.ownergoodsid = p.ownergoodsid(+)
         and a.goodsownerid = o.goodsownerid(+)
         and a.companyid = q.companyid(+)
         and a.checkmanid = k.employeeid(+)
         and a.checkman2id = y.employeeid(+)
         and a.sourceid = t4.receiveid(+)
         and p.busiscopename = h.buscopename
         and a.comefrom in(1,2,3)
         and h.buscopeid in(13)
         and a.rfflag = 3
         and a.warehid = 1
         and o.innerflag = 1 --内部货主
"
"ZX_500008_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500008_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""SHDATE"", ""CREDATE"", ""OPERATIONTYPE"", ""SOURCECOMPANYID"", ""COMPANYNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""APPROVEDOCNO"", ""DRUGFORM"", ""TRADEPACKNAME"", ""QTY"", ""TRANSCONDITION"", ""YSFS"", ""TRANSNAME"", ""DHWD"", ""DHDATE"", ""SHRID"", ""SHR"", ""INID"", ""INDTLID"", ""QYDATE"") AS 
  select a.warehid,
       c.warehname, --物流中心
       a.goodsownerid, --货主ID
       d.goodsownername, --货主名称
       b.shdate, --收货日期
       a.credate,--订单日期
       a.operationtype,--业务类型
       a.sourcecompanyid,
       e.companyname, --来货单位
       b.ownergoodsid,
       b.goodsid, --货品主档ID
       f.goodsownid,
       f.goodsname, --货品名称
       f.mah, --上市许可持有人
       f.factname, --生产厂商
       f.goodstype, --规格/型号
       f.approvedocno, --批准文号
       f.drugform ,--剂型
       f.tradepackname, --包装单位
       b.qty, --数量(收货数量)
       (select t.transclass from wms_goods_feature t where t.warehid=a.warehid and t.goodsid=b.goodsid) transcondition, --运输条件
     --  f.storagecondition, --贮存条件
       b.ysfs, --运输方式ID
       h.transname, --运输方式
       b.dhwd, --到货温度
       b.dhdate,--到货时间
       b.shrid,
       g.employeename shr, --收货人员
       a.inid,
       b.indtlid,
       b.qydate
     --  a.zxcolumn4,
     --  b.dtlzxcolumn4
  from wms_in_order       a,
       wms_in_order_dtl   b,
       tpl_warehouse      c,
       tpl_goodsowner     d,
       tpl_go_company     e,
       tpl_goods          f,
       pub_employee       g,
       wms_transport_mode h
 where a.inid = b.inid
   and nvl(a.usestatus, 0) <> 0 --去掉取消状态的物流入库订单
   and nvl(b.clflag, 0) = 1 --收货完成
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.sourcecompanyid = e.companyid(+)
   and b.ownergoodsid = f.ownergoodsid(+)
   and b.shrid = g.employeeid(+)
   and b.ysfs = h.transmodeid(+)
   /*and exists (select 1
          from tpl_goodsowner t1
         where t1.goodsownerid = a.goodsownerid
           and t1.bacterinflag=1);*/
   and f.buscopeid = 18  --疫苗经营类别
"
"ZX_500009_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500009_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OPERATIONTYPE"", ""CHECKDATE"", ""OWNERGOODSID"", ""GOODSID"", ""COMPANYID"", ""COMPANYNAME"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""DRUGFORM"", ""APPROVEDOCNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSQTY"", ""TRADEPACKNAME"", ""DECISIONFLAG"", ""QUANSTATUS"", ""QUALIFIEDQTY"", ""UNQUALIFIEDMEMO"", ""CHECKMEMO"", ""CHECKMANID"", ""CHECKMAN"", ""CHECKID"", ""SHDATE"", ""DHDATE"", ""INID"") AS 
  select a.warehid,
       c.warehname,
       a.goodsownerid, --货主ID
       d.goodsownername, --货主名称
       a.operationtype,
       b.checkdate, --验收日期
       b.ownergoodsid,
       b.goodsid, --货品主档ID
      -- f.goodsownid,
       a.companyid,
       e.companyname, --来货单位
    --   e.supplyeraddress, --供货者地址
      -- e.supplyerconnphone, --供货者联系方式
       f.goodsname, --货品名称
       f.mah, --上市许可持有人
       f.factname, --生产厂商
       f.goodstype, --规格/型号
       f.drugform ,--剂型
       f.approvedocno, --批准文号
       a.lotid,
       g.lotno, --批号
       g.proddate,--生产日期
       decode(to_char(g.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              g.validdate) validdate, --有效期
     --  f.udi_code, --医疗器械唯一标识
       a.goodsqty, --数量
       f.tradepackname, --单位
     --  (select t.transclass from wms_goods_feature t where t.warehid=a.warehid and t.goodsid=a.goodsid) transcondition, --运输条件
     --  f.storagecondition, --贮存条件
       decode(a.quanstatus, 1, 1, 2, 3, 3, 2, 4) decisionflag, --验收结论
       a.quanstatus ,--质量状态
       decode(a.goodsstatusid, 1, a.goodsqty, 9, a.goodsqty, 0) qualifiedqty, --验收合格数量
       b.unqualifiedmemo, -- 不合格处置措施
       b.checkmemo,--验收备注
       a.inputmanid checkmanid,
       h.employeename checkman, --验收人员
       a.checkid,
       i.shdate,-- 收货日期
       i.dhdate, --到货时间
       i.inid --入库订单ID
  from gsp_physic_quality_check a,
       wms_receive_dtl          b,
       tpl_warehouse            c,
       tpl_goodsowner           d,
       tpl_go_company           e,
       tpl_goods                f,
       wms_goods_lot            g,
       pub_employee             h,
       wms_in_order_dtl         i
 where a.receiveid = b.receiveid
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.companyid = e.companyid(+)
   and b.ownergoodsid = f.ownergoodsid(+)
   and a.lotid = g.lotid(+)
   and a.inputmanid = h.employeeid(+)
   and b.indtlid = i.indtlid(+)
  /* and exists (select 1
          from tpl_goodsowner t1
         where t1.goodsownerid = a.goodsownerid
           and t1.bacterinflag=1);*/
   and f.buscopeid = 18 --疫苗经营类别
"
"ZX_500010_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500010_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""DRUGFORM"", ""GOODSNAME"", ""GOODSTYPE"", ""MAH"", ""TRADEPACKNAME"", ""LOTFACTNAME"", ""GOODSQTY"", ""OWNERGOODSID"", ""POSID"", ""POSNO"", ""AREAID"", ""AREANO"", ""AREANAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"") AS 
  select a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.goodsid,
       f.drugform,
       h.goodsname,
       h.goodstype,
       l.mah,
      -- h.prodarea,
      -- f.factid,
     --  h.factname factname, -- xyue 2017-03-27 取货主货品信息上的厂家
       h.tradepackname, --xyue 2014-05-23 物流中心库存查询增加基本单位字段
       l.factname lotfactname,
       a.goodsqty,--货品库存
     --  a.busiqty,--货品业务库存
      -- a.posqty,
      -- a.poswaitqty,
       --a.tradeinwaitqty,
      -- a.outwaitqty,
       a.ownergoodsid,
     --  a.batchno,
       --a.goodspackid,
      -- i.packname,
      -- i.packsize,
       a.posid,
       j.posno,--货位编号
      -- j.posname,
       j.areaid,
       j.areano,
       j.areaname,
       j.sectionid,
       j.sectionno,
       j.sectionname,
      -- j.sorttype,
      -- j.areatype,
       --j.areaflag,
       a.lotid,
       l.lotno,
       decode(to_char(l.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              l.validdate) validdate,
       l.proddate,
       l.approvedocno,
       a.goodsstatusid,
       m.goodsstatus,
       m.quantitystatus,
       m.useflag--业务状态
     --  h.goodsownid,
      -- h.goodsno,
       -- h.supplyername, --change by llq 2021-1-20

  from wms_st_qty_lst      a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_pub_company     d,
       tpl_pub_goods       f,
       tpl_goods           h,
       tpl_pub_goods_packs i,
       wms_pos_def_v       j,
       wms_goods_lot       l,
       wms_goodsstatus     m,
       wms_container_def   n,
       wms_goods_feature   o
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.goodsid = f.goodsid
   and f.factid = d.companyid(+)
   and a.ownergoodsid = h.ownergoodsid(+)
   and a.goodspackid = i.goodspackid(+)
   and a.posid = j.posid
   and a.lotid = l.lotid(+)
   and a.goodsstatusid = m.goodsstatusid(+)
   and a.containerid = n.containerid(+)
   and a.warehid = o.warehid(+)
   and a.goodsid = o.goodsid(+)
   /*and exists (select 1
          from tpl_goodsowner t1
         where t1.goodsownerid = a.goodsownerid
           and t1.bacterinflag=1);*/
   and h.buscopeid = 18  --疫苗经营类别
"
"ZX_500011_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500011_V"" (""WAREHNAME"", ""CONSERVEID"", ""WAREHID"", ""GOODSID"", ""GOODSNAME"", ""COMPANYNAME"", ""DRUGFORM"", ""GOODSQTYPE"", ""LOTID"", ""LOTNO"", ""LOTVALIDDATE"", ""APPROVEDOCNO"", ""PRODDATE"", ""POSID"", ""SECTIONID"", ""SECTIONNAME"", ""POSNO"", ""GOODSQTY"", ""GOODSUNIT"", ""PACKAGE"", ""RESULT"", ""CHECKMANID"", ""CHECKMAN"", ""EMFLAG"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""QUANSTANDARD"", ""CONSERVEDATE"", ""MAH"") AS 
  select tpl_warehouse.warehname,
       gsp_conserve.conserveid,
       gsp_conserve.warehid,
       gsp_conserve.goodsid,
       d.goodsname,
     --  d.goodsformalname,
     --  d.prodarea,
      -- tpl_pub_goods.factid,
       d.factname companyname,
      -- tpl_pub_company.companyopcode,
       tpl_drugform.drugform,
      -- tpl_drugform.drugformno,
       d.goodstype GOODSQTYPE,
       gsp_conserve.lotid,
       wms_goods_lot.lotno,
       decode(to_char(wms_goods_lot.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              wms_goods_lot.validdate) lotvaliddate,
       wms_goods_lot.approvedocno,
       wms_goods_lot.proddate,
      gsp_conserve.posid,
      -- wms_pos_def.areaid,
      -- wms_st_area_def.areano,
     --  wms_st_area_def.areaname,
         wms_pos_def.sectionid,
     --  wms_st_section_def.sectionno,
       wms_st_section_def.sectionname,
     --  wms_pos_def.posname,
       wms_pos_def.posno,
       gsp_conserve.goodsqty,
       gsp_conserve.goodsunit,
        gsp_conserve.package,--包装情况
        gsp_conserve.result,--处理意见
        gsp_conserve.checkmanid,
        a.employeename checkman,
        gsp_conserve.emflag,
        gsp_conserve.goodsownerid,
       f.goodsownername,
        gsp_conserve.quanstandard,--质量状况
        gsp_conserve.conservedate, -- add by xyue 2017-12-11
       wms_goods_lot.mah --add by xyue 2019-12-05 上市许可持有人

     /*  gsp_conserve.matter,
       gsp_conserve.contents,
       gsp_conserve.lastconservedate,
       gsp_conserve.usestatus,
       gsp_conserve.validdate,
       gsp_conserve.memo,

       d.storagecondition, -- add by xyue 2017-12-11
       gsp_conserve.properties,

       gsp_conserve.checkqty,
       gsp_conserve.checkresult,
       gsp_conserve.recheckqty,
       gsp_conserve.recheckresult,


       gsp_conserve.quilityqty,
       gsp_conserve.unquilityqty,
       a.opcode checkmanopcode,

       gsp_conserve.checkmemo,
       gsp_conserve.equipmentid,
       b.equipmentopcode,
       b.equipmentname,
       gsp_conserve.usereason,
       gsp_conserve.checkgoods,
       gsp_conserve.useman,
       gsp_conserve.equipmentmemo,
       gsp_conserve.whitestocknum,
       gsp_conserve.whitepointnum,
       gsp_conserve.xianweinum,
       gsp_conserve.boxienum,
       gsp_conserve.jinshuxienum,
       gsp_conserve.othernum,
       tpl_pub_goods.jkhzflag,
       gsp_conserve.sourceid,
       gsp_conserve.rewhitestocknum,
       gsp_conserve.rewhitepointnum,
       gsp_conserve.rexianweinum,
       gsp_conserve.reboxienum,
       gsp_conserve.rejinshuxienum,
       gsp_conserve.reothernum,

       gsp_conserve.printflag,
       gsp_conserve.printdate,
       gsp_conserve.printmanid,
       c.employeename printman,

       d.goodsownid, -- add by xyue 2017-12-11
       e.goodsqty plangoodsqty, -- add by xyue 2017-12-11

       wms_goods_Lot.Printexpireflag, --add by llq 2020-12-31 打印失效期标志
       wms_goods_lot.printmonthflag, -- by tl@210820打印精确到月
       d.ownergoodsid, --tl@211231
       wms_st_section_def.iwcs_flag,
       (select max(y.employeecode)
          from ssc_gsp_maintain_goods@iwcs x, sys_userlist@iwcs y
         where x.maintainer = y.userid(+)
           and x.mntn_bill_no = gsp_conserve.conserveid) iwcs_checkman*/
  from gsp_conserve,
       tpl_warehouse,
       tpl_pub_goods,
       tpl_pub_company,
       wms_goods_lot,
       wms_st_area_def,
       wms_st_section_def,
       wms_pos_def,
       tpl_drugform,
       pub_employee          a,
       gsp_equipment         b,
       pub_employee          c,
       tpl_goodsowner        f,
       gsp_conserve_plan_dtl e, --add by xyue 2017-12-11
       tpl_goods             d --add by xyue 2017-12-11
 where gsp_conserve.warehid = tpl_warehouse.warehid(+)
   and gsp_conserve.goodsid = tpl_pub_goods.goodsid(+)
   and tpl_pub_goods.factid = tpl_pub_company.companyid(+)
   and gsp_conserve.lotid = wms_goods_lot.lotid(+)
   and gsp_conserve.posid = wms_pos_def.posid(+)
   and wms_pos_def.areaid = wms_st_area_def.areaid(+)
   and wms_pos_def.sectionid = wms_st_section_def.sectionid(+)
   and gsp_conserve.checkmanid = a.employeeid(+)
   and gsp_conserve.equipmentid = b.equipmentid(+)
   and tpl_drugform.drugformno(+) = tpl_pub_goods.drugform
   AND gsp_conserve.printmanid = c.employeeid(+)
   And gsp_conserve.goodsownerid = f.goodsownerid(+)
   and gsp_conserve.sourceid = e.conservedtlid(+) --add by xyue 2017-12-11
   and gsp_conserve.ownergoodsid = d.ownergoodsid(+) --add by xyue 2017-12-11;
   /*and exists (select 1
          from tpl_goodsowner t1
         where t1.goodsownerid = f.goodsownerid
           and t1.bacterinflag=1);*/
   and d.buscopeid = 18  --疫苗经营类别
"
"ZX_500012_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500012_V"" (""WAREHID"", ""WAREHNAME"", ""OPERATIONTYPE"", ""KEEPDATE"", ""KEEPMANID"", ""KEEPMANNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSTYPE"", ""GOODSNAME"", ""DRUGFORM"", ""APPROVEDOCNO"", ""FACTNAME"", ""MAH"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSQTY"", ""TRADEPACKNAME"", ""COMPANYID"", ""COMPANYNAME"", ""QUANTITYSTATUS"") AS 
  select a.warehid,
       p.warehname,
       a.operationtype,
       a.keepdate,
       a.keepmanid,
      -- k.opcode keepmanopcode,
       k.employeename keepmanname,
       a.goodsownerid,
       e.goodsownername,
       a.goodsid,
       n.goodstype,
       n.goodsname,
       n.drugform,
       i.approvedocno,
       i.factname factname, --修改货品出库复核记录的生产厂家取批号信息上的生产厂家，xyue 2014年1月6日 17:22:54
       i.mah, --add by xyue 2019-08-22 上市许可持有人
       a.lotid,
       i.lotno,
       decode(to_char(i.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              i.validdate) validdate,
       i.proddate,
       a.goodsqty,
       n.tradepackname,
       a.companyid,
       f.companyname,
       g.quantitystatus


      /* a.inoutid,
       a.credate,
       a.inputmanid,
       c.opcode inputcode,
       c.employeename inputname,
       a.checkmanid,
       d.opcode checkmanopcode,
       d.employeename checkmanname,
       a.comefrom,
       f.opcode companyopcode,
       n.prodarea,
       a.batchno,
       a.goodspackid,
       j.packname,
       j.packsize,
       a.posid,
       a.goodsstatusid,
       g.goodsstatus,
       a.memo,
       b.posno,
       b.posname,
       b.areano,
       b.areaname,
       b.sectionno,
       b.sectionname,
       b.areaid,
       b.sectionid,
       a.checkman2id,
       l.opcode checkman2opcode,
       l.employeename checkman2name,
       a.ownergoodsid,
       n.storagecondition,
       a.gcompanyname, --add by weitangjing 20131104 原货主单位名称
       n.goodsownid, -- add by tl  180206 货主原货品ID
       o.goodsclass,
       nvl(n.ecodeflag,0) ecodeflag, --add by xyue 2022-08-29 电子监管码标志
       (select t.sourceid from wms_st_io_doc t where t.inoutid=a.inoutid and t.comefrom in (2,3)) sourceid,
       nvl(b.iwcs_flag,0) iwcs_flag*/
  from Gsp_st_io_record a,
       wms_pos_def_v b,
       pub_employee c,
       pub_employee d,
       tpl_goodsowner e,
       tpl_go_company f,
       wms_goodsstatus g,
       tpl_pub_goods h,
       tpl_pub_company m,
       wms_goods_lot i,
       tpl_pub_goods_packs j,
       pub_employee k,
       pub_employee l,
       tpl_goods n,
       tpl_drugform,
       wms_goods_feature o,
       tpl_warehouse p
 where a.posid = b.posid(+)
   and a.inputmanid = c.employeeid(+)
   and a.checkmanid = d.employeeid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.companyid = f.companyid(+)
   and a.goodsid = h.goodsid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.lotid = i.lotid(+)
   and a.goodspackid = j.goodspackid(+)
   and a.keepmanid = k.employeeid(+)
   and a.checkman2id = l.employeeid(+)
   and h.factid = m.companyid(+)
   and a.ownergoodsid = n.ownergoodsid(+)
   and h.drugform = tpl_drugform.drugformno(+)
   and a.warehid = o.warehid(+)
   and a.goodsid = o.goodsid(+)
   and a.warehid = p.warehid(+)
   /*and exists (select 1
          from tpl_goodsowner t1
         where t1.goodsownerid = a.goodsownerid
           and t1.bacterinflag=1);*/
   and n.buscopeid = 18  --疫苗经营类别
"
"ZX_500013_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500013_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GCOMPANYID"", ""COMPANYNAME"", ""TRANSID"", ""INCEPTADDR"", ""GOODSID"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""TRADEPACKNAME"", ""SOURCEID"", ""SELFTRANSTYPE"", ""EXCARRIER"", ""DISPATCHID"", ""VEHICLEID"", ""VEHICLENO"", ""TRANSMODEL"", ""DRIVERID"", ""DRIVERNAME"", ""TRID"", ""STARTDATE"", ""ENDDATE"", ""WAREHADDRESS"") AS 
  select a.warehid,
       c.warehname,
       a.goodsownerid, --货主ID
       d.goodsownername, --委托方名称
      -- i.realdispatchdate, --发货时间
       a.gcompanyid,
       e.companyname, --收货单位名称
       a.transid,
       f.inceptaddr, --地址
     --  f.connphone, --联系方式
     --  b.ownergoodsid,
       b.goodsid, --货品主档ID
      -- g.goodsownid,
       g.goodsname, --
       g.mah, --上市许可持有人
       g.factname, --受托生产企业名称
       g.goodstype, --规格/型号
     --  g.approvedocno, --医疗器械注册证编号/备案编号
       b.lotid,
       h.lotno, --生产批号/序列号
       b.goodsqty, --数量
       g.tradepackname, --单位
       a.sourceid, --随货同行单号
     --  (select t.transclass from wms_goods_feature t where t.warehid=a.warehid and t.goodsid=b.goodsid) transcondition, --运输条件
      -- g.storagecondition, --贮存条件
      -- nvl(a.signdate, a.enddate) signdate, --到货时间
       decode(nvl(a.excarrier,0),0,1,2) selftranstype,--自外运标志 1-自运 2-外运
       a.excarrier, --承运单位名称
       a.dispatchid, --派车单ID
       i.vehicleid,
       i.vehicleno, --车牌号
       i.transmodel,--运输方式
       i.driverid,
       i.drivername, --运输人员
       a.trid,
      ( select t2.startdate from tms_dispatch_dtl t2  where t2.trid = a.trid   and t2.usestatus <> 1 )  startdate ,--启运时间
      ( select t2.enddate from tms_dispatch_dtl t2  where t2.trid = a.trid   and t2.usestatus <> 1)  enddate, --到达时间
       c.warehaddress
  from tms_tr_doc a,
       tms_luyan_tr_dtl b,
       tpl_warehouse c,
       tpl_goodsowner d,
       tpl_go_company e,
       wms_transport_address f,
       tpl_goods g,
       wms_goods_lot h,
       (select t1.realdispatchdate,
               t1.dispatchid,
               t1.vehicleid,
               t2.vehicleno,
               t1.driverid,
               t3.drivername,
               t1.transmodel
          from tms_dispatch_doc t1, tms_vehicle t2, tms_driver t3
         where t1.usestatus in (0, 4, 5) --派车单状态在途、运输完成、撤单
           and t1.vehicleid = t2.vehicleid(+)
           and t1.driverid = t3.driverid(+)
        union all
        select tt1.credate realdispatchdate,
               tt1.dispatchid,
               tt1.vehicleid,
               tt2.vehicleno,
               tt1.driverid,
               tt3.drivername,
               26 transmodel
          from tms_luyan_dispatch_doc tt1, tms_vehicle tt2, tms_driver tt3
         where tt1.vehicleid = tt2.vehicleid(+)
           and tt1.driverid = tt3.driverid(+)) i
 where a.trid = b.trid
   and a.dispatchid = i.dispatchid
   and a.sourcetable = 1 --波次释放
   and a.comefrom = 1 --WMS转入
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.gcompanyid = e.companyid(+)
   and a.transid = f.transid(+)
   and b.ownergoodsid = g.ownergoodsid(+)
   and b.lotid = h.lotid(+)
   /*and exists (select 1
          from tpl_goodsowner t1
         where t1.goodsownerid = a.goodsownerid
           and t1.bacterinflag=1);*/
   and g.buscopeid = 18  --疫苗经营类别
"
"ZX_500014_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500014_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""SHDATE"", ""CREDATE"", ""OPERATIONTYPE"", ""SOURCECOMPANYID"", ""COMPANYNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""APPROVEDOCNO"", ""DRUGFORM"", ""TRADEPACKNAME"", ""QTY"", ""TRANSCONDITION"", ""YSFS"", ""TRANSNAME"", ""DHWD"", ""DHDATE"", ""SHRID"", ""SHR"", ""INID"", ""INDTLID"", ""QYDATE"") AS 
  select a.warehid,
       c.warehname, --物流中心
       a.goodsownerid, --货主ID
       d.goodsownername, --货主名称
       b.shdate, --收货日期
       a.credate,--订单日期
       a.operationtype,--业务类型
       a.sourcecompanyid,
       e.companyname, --来货单位
       b.ownergoodsid,
       b.goodsid, --货品主档ID
       f.goodsownid,
       f.goodsname, --货品名称
       f.mah, --上市许可持有人
       f.factname, --生产厂商
       f.goodstype, --规格/型号
       f.approvedocno, --批准文号
       f.drugform ,--剂型
       f.tradepackname, --包装单位
       b.qty, --数量(收货数量)
       (select t.transclass from wms_goods_feature t where t.warehid=a.warehid and t.goodsid=b.goodsid) transcondition, --运输条件
     --  f.storagecondition, --贮存条件
       b.ysfs, --运输方式ID
       h.transname, --运输方式
       b.dhwd, --到货温度
       b.dhdate,--到货时间
       b.shrid,
       g.employeename shr, --收货人员
       a.inid,
       b.indtlid,
       b.qydate
     --  a.zxcolumn4,
     --  b.dtlzxcolumn4
  from wms_in_order       a,
       wms_in_order_dtl   b,
       tpl_warehouse      c,
       tpl_goodsowner     d,
       tpl_go_company     e,
       tpl_goods          f,
       pub_employee       g,
       wms_transport_mode h
 where a.inid = b.inid
   and nvl(a.usestatus, 0) <> 0 --去掉取消状态的物流入库订单
   and nvl(b.clflag, 0) = 1 --收货完成
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.sourcecompanyid = e.companyid(+)
   and b.ownergoodsid = f.ownergoodsid(+)
   and b.shrid = g.employeeid(+)
   and b.ysfs = h.transmodeid(+)
   and exists (select 1
          from wms_goods_feature t1
         where t1.goodsclass = 43
           and a.warehid = t1.warehid
           and b.goodsid = t1.goodsid) --二类WMS货品分类
"
"ZX_500015_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500015_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OPERATIONTYPE"", ""CHECKDATE"", ""OWNERGOODSID"", ""GOODSID"", ""COMPANYID"", ""COMPANYNAME"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""DRUGFORM"", ""APPROVEDOCNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSQTY"", ""TRADEPACKNAME"", ""DECISIONFLAG"", ""QUANSTATUS"", ""QUALIFIEDQTY"", ""UNQUALIFIEDMEMO"", ""CHECKMEMO"", ""CHECKMANID"", ""CHECKMAN"", ""CHECKID"", ""SHDATE"", ""DHDATE"", ""INID"", ""CHECKMANID2"", ""CHECKMAN2"") AS 
  select a.warehid,
       c.warehname,
       a.goodsownerid, --货主ID
       d.goodsownername, --货主名称
       a.operationtype,
       b.checkdate, --验收日期
       b.ownergoodsid,
       b.goodsid, --货品主档ID
      -- f.goodsownid,
       a.companyid,
       e.companyname, --来货单位
    --   e.supplyeraddress, --供货者地址
      -- e.supplyerconnphone, --供货者联系方式
       f.goodsname, --货品名称
       f.mah, --上市许可持有人
       f.factname, --生产厂商
       f.goodstype, --规格/型号
       f.drugform ,--剂型
       f.approvedocno, --批准文号
       a.lotid,
       g.lotno, --批号
       g.proddate,--生产日期
       decode(to_char(g.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              g.validdate) validdate, --有效期
     --  f.udi_code, --医疗器械唯一标识
       a.goodsqty, --数量
       f.tradepackname, --单位
     --  (select t.transclass from wms_goods_feature t where t.warehid=a.warehid and t.goodsid=a.goodsid) transcondition, --运输条件
     --  f.storagecondition, --贮存条件
       decode(a.quanstatus, 1, 1, 2, 3, 3, 2, 4) decisionflag, --验收结论
       a.quanstatus ,--质量状态
       decode(a.goodsstatusid, 1, a.goodsqty, 9, a.goodsqty, 0) qualifiedqty, --验收合格数量
       b.unqualifiedmemo, -- 不合格处置措施
       b.checkmemo,--验收备注
       a.inputmanid checkmanid,
       h.employeename checkman, --验收人员
       a.checkid,
       i.shdate,-- 收货日期
       i.dhdate, --到货时间
       i.inid, --入库订单ID
       a.checkmanid2,
       j.employeename  checkman2--验收员B
  from gsp_physic_quality_check a,
       wms_receive_dtl          b,
       tpl_warehouse            c,
       tpl_goodsowner           d,
       tpl_go_company           e,
       tpl_goods                f,
       wms_goods_lot            g,
       pub_employee             h,
       wms_in_order_dtl         i,
       pub_employee             j
 where a.receiveid = b.receiveid
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.companyid = e.companyid(+)
   and b.ownergoodsid = f.ownergoodsid(+)
   and a.lotid = g.lotid(+)
   and a.inputmanid = h.employeeid(+)
   and a.checkmanid2 = j.employeeid(+)
   and b.indtlid = i.indtlid(+)
   and exists (select 1
          from wms_goods_feature t1
         where t1.goodsclass = 43
           and a.warehid = t1.warehid
           and a.goodsid = t1.goodsid) --二类WMS货品分类
"
"ZX_500016_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500016_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""DRUGFORM"", ""GOODSNAME"", ""GOODSTYPE"", ""MAH"", ""TRADEPACKNAME"", ""LOTFACTNAME"", ""GOODSQTY"", ""OWNERGOODSID"", ""POSID"", ""POSNO"", ""AREAID"", ""AREANO"", ""AREANAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"") AS 
  select a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.goodsid,
       f.drugform,
       h.goodsname,
       h.goodstype,
       l.mah,
      -- h.prodarea,
      -- f.factid,
     --  h.factname factname, -- xyue 2017-03-27 取货主货品信息上的厂家
       h.tradepackname, --xyue 2014-05-23 物流中心库存查询增加基本单位字段
       l.factname lotfactname,
       a.goodsqty,--货品库存
     --  a.busiqty,--货品业务库存
      -- a.posqty,
      -- a.poswaitqty,
       --a.tradeinwaitqty,
      -- a.outwaitqty,
       a.ownergoodsid,
     --  a.batchno,
       --a.goodspackid,
      -- i.packname,
      -- i.packsize,
       a.posid,
       j.posno,--货位编号
      -- j.posname,
       j.areaid,
       j.areano,
       j.areaname,
       j.sectionid,
       j.sectionno,
       j.sectionname,
      -- j.sorttype,
      -- j.areatype,
       --j.areaflag,
       a.lotid,
       l.lotno,
       decode(to_char(l.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              l.validdate) validdate,
       l.proddate,
       l.approvedocno,
       a.goodsstatusid,
       m.goodsstatus,
       m.quantitystatus,
       m.useflag--业务状态
     --  h.goodsownid,
      -- h.goodsno,
       -- h.supplyername, --change by llq 2021-1-20

  from wms_st_qty_lst      a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_pub_company     d,
       tpl_pub_goods       f,
       tpl_goods           h,
       tpl_pub_goods_packs i,
       wms_pos_def_v       j,
       wms_goods_lot       l,
       wms_goodsstatus     m,
       wms_container_def   n,
       wms_goods_feature   o
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.goodsid = f.goodsid
   and f.factid = d.companyid(+)
   and a.ownergoodsid = h.ownergoodsid(+)
   and a.goodspackid = i.goodspackid(+)
   and a.posid = j.posid
   and a.lotid = l.lotid(+)
   and a.goodsstatusid = m.goodsstatusid(+)
   and a.containerid = n.containerid(+)
   and a.warehid = o.warehid(+)
   and a.goodsid = o.goodsid(+)
   and exists (select 1
          from wms_goods_feature t1
         where t1.goodsclass = 43
           and a.warehid = t1.warehid
           and a.goodsid = t1.goodsid) --二类WMS货品分类
"
"ZX_500017_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500017_V"" (""WAREHNAME"", ""CONSERVEID"", ""WAREHID"", ""GOODSID"", ""GOODSNAME"", ""COMPANYNAME"", ""DRUGFORM"", ""GOODSQTYPE"", ""LOTID"", ""LOTNO"", ""LOTVALIDDATE"", ""APPROVEDOCNO"", ""PRODDATE"", ""POSID"", ""SECTIONID"", ""SECTIONNAME"", ""POSNO"", ""GOODSQTY"", ""GOODSUNIT"", ""PACKAGE"", ""RESULT"", ""CHECKMANID"", ""CHECKMAN"", ""EMFLAG"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""QUANSTANDARD"", ""CONSERVEDATE"", ""MAH"") AS 
  select tpl_warehouse.warehname,
       gsp_conserve.conserveid,
       gsp_conserve.warehid,
       gsp_conserve.goodsid,
       d.goodsname,
     --  d.goodsformalname,
     --  d.prodarea,
      -- tpl_pub_goods.factid,
       d.factname companyname,
      -- tpl_pub_company.companyopcode,
       tpl_drugform.drugform,
      -- tpl_drugform.drugformno,
       d.goodstype GOODSQTYPE,
       gsp_conserve.lotid,
       wms_goods_lot.lotno,
       decode(to_char(wms_goods_lot.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              wms_goods_lot.validdate) lotvaliddate,
       wms_goods_lot.approvedocno,
       wms_goods_lot.proddate,
      gsp_conserve.posid,
      -- wms_pos_def.areaid,
      -- wms_st_area_def.areano,
     --  wms_st_area_def.areaname,
         wms_pos_def.sectionid,
     --  wms_st_section_def.sectionno,
       wms_st_section_def.sectionname,
     --  wms_pos_def.posname,
       wms_pos_def.posno,
       gsp_conserve.goodsqty,
       gsp_conserve.goodsunit,
        gsp_conserve.package,--包装情况
        gsp_conserve.result,--处理意见
        gsp_conserve.checkmanid,
        a.employeename checkman,
        gsp_conserve.emflag,
        gsp_conserve.goodsownerid,
       f.goodsownername,
        gsp_conserve.quanstandard,--质量状况
        gsp_conserve.conservedate, -- add by xyue 2017-12-11
       wms_goods_lot.mah --add by xyue 2019-12-05 上市许可持有人

     /*  gsp_conserve.matter,
       gsp_conserve.contents,
       gsp_conserve.lastconservedate,
       gsp_conserve.usestatus,
       gsp_conserve.validdate,
       gsp_conserve.memo,

       d.storagecondition, -- add by xyue 2017-12-11
       gsp_conserve.properties,

       gsp_conserve.checkqty,
       gsp_conserve.checkresult,
       gsp_conserve.recheckqty,
       gsp_conserve.recheckresult,


       gsp_conserve.quilityqty,
       gsp_conserve.unquilityqty,
       a.opcode checkmanopcode,

       gsp_conserve.checkmemo,
       gsp_conserve.equipmentid,
       b.equipmentopcode,
       b.equipmentname,
       gsp_conserve.usereason,
       gsp_conserve.checkgoods,
       gsp_conserve.useman,
       gsp_conserve.equipmentmemo,
       gsp_conserve.whitestocknum,
       gsp_conserve.whitepointnum,
       gsp_conserve.xianweinum,
       gsp_conserve.boxienum,
       gsp_conserve.jinshuxienum,
       gsp_conserve.othernum,
       tpl_pub_goods.jkhzflag,
       gsp_conserve.sourceid,
       gsp_conserve.rewhitestocknum,
       gsp_conserve.rewhitepointnum,
       gsp_conserve.rexianweinum,
       gsp_conserve.reboxienum,
       gsp_conserve.rejinshuxienum,
       gsp_conserve.reothernum,

       gsp_conserve.printflag,
       gsp_conserve.printdate,
       gsp_conserve.printmanid,
       c.employeename printman,

       d.goodsownid, -- add by xyue 2017-12-11
       e.goodsqty plangoodsqty, -- add by xyue 2017-12-11

       wms_goods_Lot.Printexpireflag, --add by llq 2020-12-31 打印失效期标志
       wms_goods_lot.printmonthflag, -- by tl@210820打印精确到月
       d.ownergoodsid, --tl@211231
       wms_st_section_def.iwcs_flag,
       (select max(y.employeecode)
          from ssc_gsp_maintain_goods@iwcs x, sys_userlist@iwcs y
         where x.maintainer = y.userid(+)
           and x.mntn_bill_no = gsp_conserve.conserveid) iwcs_checkman*/
  from gsp_conserve,
       tpl_warehouse,
       tpl_pub_goods,
       tpl_pub_company,
       wms_goods_lot,
       wms_st_area_def,
       wms_st_section_def,
       wms_pos_def,
       tpl_drugform,
       pub_employee          a,
       gsp_equipment         b,
       pub_employee          c,
       tpl_goodsowner        f,
       gsp_conserve_plan_dtl e, --add by xyue 2017-12-11
       tpl_goods             d --add by xyue 2017-12-11
 where gsp_conserve.warehid = tpl_warehouse.warehid(+)
   and gsp_conserve.goodsid = tpl_pub_goods.goodsid(+)
   and tpl_pub_goods.factid = tpl_pub_company.companyid(+)
   and gsp_conserve.lotid = wms_goods_lot.lotid(+)
   and gsp_conserve.posid = wms_pos_def.posid(+)
   and wms_pos_def.areaid = wms_st_area_def.areaid(+)
   and wms_pos_def.sectionid = wms_st_section_def.sectionid(+)
   and gsp_conserve.checkmanid = a.employeeid(+)
   and gsp_conserve.equipmentid = b.equipmentid(+)
   and tpl_drugform.drugformno(+) = tpl_pub_goods.drugform
   AND gsp_conserve.printmanid = c.employeeid(+)
   And gsp_conserve.goodsownerid = f.goodsownerid(+)
   and gsp_conserve.sourceid = e.conservedtlid(+) --add by xyue 2017-12-11
   and gsp_conserve.ownergoodsid = d.ownergoodsid(+) --add by xyue 2017-12-11;
   and exists (select 1
          from wms_goods_feature t1
         where t1.goodsclass = 43
           and gsp_conserve.warehid = t1.warehid
           and gsp_conserve.goodsid = t1.goodsid) --二类WMS货品分类
"
"ZX_500018_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500018_V"" (""WAREHID"", ""WAREHNAME"", ""OPERATIONTYPE"", ""KEEPDATE"", ""KEEPMANID"", ""KEEPMANNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSTYPE"", ""GOODSNAME"", ""DRUGFORM"", ""APPROVEDOCNO"", ""FACTNAME"", ""MAH"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSQTY"", ""TRADEPACKNAME"", ""COMPANYID"", ""COMPANYNAME"", ""QUANTITYSTATUS"") AS 
  select a.warehid,
       p.warehname,
       a.operationtype,
       a.keepdate,
       a.keepmanid,
      -- k.opcode keepmanopcode,
       k.employeename keepmanname,
       a.goodsownerid,
       e.goodsownername,
       a.goodsid,
       n.goodstype,
       n.goodsname,
       n.drugform,
       i.approvedocno,
       i.factname factname, --修改货品出库复核记录的生产厂家取批号信息上的生产厂家，xyue 2014年1月6日 17:22:54
       i.mah, --add by xyue 2019-08-22 上市许可持有人
       a.lotid,
       i.lotno,
       decode(to_char(i.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              i.validdate) validdate,
       i.proddate,
       a.goodsqty,
       n.tradepackname,
       a.companyid,
       f.companyname,
       g.quantitystatus


      /* a.inoutid,
       a.credate,
       a.inputmanid,
       c.opcode inputcode,
       c.employeename inputname,
       a.checkmanid,
       d.opcode checkmanopcode,
       d.employeename checkmanname,
       a.comefrom,
       f.opcode companyopcode,
       n.prodarea,
       a.batchno,
       a.goodspackid,
       j.packname,
       j.packsize,
       a.posid,
       a.goodsstatusid,
       g.goodsstatus,
       a.memo,
       b.posno,
       b.posname,
       b.areano,
       b.areaname,
       b.sectionno,
       b.sectionname,
       b.areaid,
       b.sectionid,
       a.checkman2id,
       l.opcode checkman2opcode,
       l.employeename checkman2name,
       a.ownergoodsid,
       n.storagecondition,
       a.gcompanyname, --add by weitangjing 20131104 原货主单位名称
       n.goodsownid, -- add by tl  180206 货主原货品ID
       o.goodsclass,
       nvl(n.ecodeflag,0) ecodeflag, --add by xyue 2022-08-29 电子监管码标志
       (select t.sourceid from wms_st_io_doc t where t.inoutid=a.inoutid and t.comefrom in (2,3)) sourceid,
       nvl(b.iwcs_flag,0) iwcs_flag*/
  from Gsp_st_io_record a,
       wms_pos_def_v b,
       pub_employee c,
       pub_employee d,
       tpl_goodsowner e,
       tpl_go_company f,
       wms_goodsstatus g,
       tpl_pub_goods h,
       tpl_pub_company m,
       wms_goods_lot i,
       tpl_pub_goods_packs j,
       pub_employee k,
       pub_employee l,
       tpl_goods n,
       tpl_drugform,
       wms_goods_feature o,
       tpl_warehouse p
 where a.posid = b.posid(+)
   and a.inputmanid = c.employeeid(+)
   and a.checkmanid = d.employeeid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.companyid = f.companyid(+)
   and a.goodsid = h.goodsid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.lotid = i.lotid(+)
   and a.goodspackid = j.goodspackid(+)
   and a.keepmanid = k.employeeid(+)
   and a.checkman2id = l.employeeid(+)
   and h.factid = m.companyid(+)
   and a.ownergoodsid = n.ownergoodsid(+)
   and h.drugform = tpl_drugform.drugformno(+)
   and a.warehid = o.warehid(+)
   and a.goodsid = o.goodsid(+)
   and a.warehid = p.warehid(+)
   and exists (select 1
          from wms_goods_feature t1
         where t1.goodsclass = 43
           and a.warehid = t1.warehid
           and a.goodsid = t1.goodsid) --二类WMS货品分类
"
"ZX_500019_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500019_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GCOMPANYID"", ""COMPANYNAME"", ""TRANSID"", ""INCEPTADDR"", ""GOODSID"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""TRADEPACKNAME"", ""SOURCEID"", ""SELFTRANSTYPE"", ""EXCARRIER"", ""DISPATCHID"", ""VEHICLEID"", ""VEHICLENO"", ""TRANSMODEL"", ""DRIVERID"", ""DRIVERNAME"", ""TRID"", ""DISPATCHDATE"", ""USESTATUS"", ""STARTDATE"", ""ENDDATE"", ""WAREHADDRESS"") AS 
  select a.warehid,
       c.warehname,
       a.goodsownerid, --货主ID
       d.goodsownername, --委托方名称
      -- i.realdispatchdate, --发货时间
       a.gcompanyid,
       e.companyname, --收货单位名称
       a.transid,
       f.inceptaddr, --地址
     --  f.connphone, --联系方式
     --  b.ownergoodsid,
       b.goodsid, --货品主档ID
      -- g.goodsownid,
       g.goodsname, --
       g.mah, --上市许可持有人
       g.factname, --受托生产企业名称
       g.goodstype, --规格/型号
     --  g.approvedocno, --医疗器械注册证编号/备案编号
       b.lotid,
       h.lotno, --生产批号/序列号
       b.goodsqty, --数量
       g.tradepackname, --单位
       a.sourceid, --随货同行单号
     --  (select t.transclass from wms_goods_feature t where t.warehid=a.warehid and t.goodsid=b.goodsid) transcondition, --运输条件
      -- g.storagecondition, --贮存条件
      -- nvl(a.signdate, a.enddate) signdate, --到货时间
       decode(nvl(a.excarrier,0),0,1,2) selftranstype,--自外运标志 1-自运 2-外运
       a.excarrier, --承运单位名称
       a.dispatchid, --派车单ID
       i.vehicleid,
       i.vehicleno, --车牌号
       i.transmodel,--运输方式
       i.driverid,
       i.drivername, --运输人员
       a.trid,
        i.dispatchdate, --发车时间
        i.usestatus,-- 使用状态
      ( select t2.startdate from tms_dispatch_dtl t2  where t2.trid = a.trid   and t2.usestatus <> 1 )  startdate ,--启运时间
      ( select t2.enddate from tms_dispatch_dtl t2  where t2.trid = a.trid   and t2.usestatus <> 1)  enddate ,--到达时间
      c.warehaddress

  from tms_tr_doc a,
       tms_luyan_tr_dtl b,
       tpl_warehouse c,
       tpl_goodsowner d,
       tpl_go_company e,
       wms_transport_address f,
       tpl_goods g,
       wms_goods_lot h,
       (select t1.realdispatchdate,
               t1.dispatchdate,
               t1.dispatchid,
               t1.vehicleid,
               t2.vehicleno,
               t1.driverid,
               t3.drivername,
               t1.transmodel,
               t1.usestatus
          from tms_dispatch_doc t1, tms_vehicle t2, tms_driver t3
         where t1.usestatus in (0, 4, 5) --派车单状态在途、运输完成、撤单
           and t1.vehicleid = t2.vehicleid(+)
           and t1.driverid = t3.driverid(+)
        union all
        select tt1.credate realdispatchdate,
               tt1.dispatchdate,
               tt1.dispatchid,
               tt1.vehicleid,
               tt2.vehicleno,
               tt1.driverid,
               tt3.drivername,
               26 transmodel,
               tt1.usestatus
          from tms_luyan_dispatch_doc tt1, tms_vehicle tt2, tms_driver tt3
         where tt1.vehicleid = tt2.vehicleid(+)
           and tt1.driverid = tt3.driverid(+)) i
 where a.trid = b.trid
   and a.dispatchid = i.dispatchid
   and a.sourcetable = 1 --波次释放
   and a.comefrom = 1 --WMS转入
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.gcompanyid = e.companyid(+)
   and a.transid = f.transid(+)
   and b.ownergoodsid = g.ownergoodsid(+)
   and b.lotid = h.lotid(+)
   and exists (select 1
          from wms_goods_feature t1
         where t1.goodsclass = 43
           and a.warehid = t1.warehid
           and b.goodsid = t1.goodsid) --二类WMS货品分类
"
"ZX_500020_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500020_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""SHDATE"", ""CREDATE"", ""OPERATIONTYPE"", ""SOURCECOMPANYID"", ""COMPANYNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""APPROVEDOCNO"", ""DRUGFORM"", ""TRADEPACKNAME"", ""QTY"", ""TRANSCONDITION"", ""YSFS"", ""TRANSNAME"", ""DHWD"", ""DHDATE"", ""SHRID"", ""SHR"", ""INID"", ""INDTLID"", ""QYDATE"") AS 
  select a.warehid,
       c.warehname, --物流中心
       a.goodsownerid, --货主ID
       d.goodsownername, --货主名称
       b.shdate, --收货日期
       a.credate,--订单日期
       a.operationtype,--业务类型
       a.sourcecompanyid,
       e.companyname, --来货单位
       b.ownergoodsid,
       b.goodsid, --货品主档ID
       f.goodsownid,
       f.goodsname, --货品名称
       f.mah, --上市许可持有人
       f.factname, --生产厂商
       f.goodstype, --规格/型号
       f.approvedocno, --批准文号
       f.drugform ,--剂型
       f.tradepackname, --包装单位
       b.qty, --数量(收货数量)
       (select t.transclass from wms_goods_feature t where t.warehid=a.warehid and t.goodsid=b.goodsid) transcondition, --运输条件
     --  f.storagecondition, --贮存条件
       b.ysfs, --运输方式ID
       h.transname, --运输方式
       b.dhwd, --到货温度
       b.dhdate,--到货时间
       b.shrid,
       g.employeename shr, --收货人员
       a.inid,
       b.indtlid,
       b.qydate --启运时间
     --  a.zxcolumn4,
     --  b.dtlzxcolumn4
  from wms_in_order       a,
       wms_in_order_dtl   b,
       tpl_warehouse      c,
       tpl_goodsowner     d,
       tpl_go_company     e,
       tpl_goods          f,
       pub_employee       g,
       wms_transport_mode h
 where a.inid = b.inid
   and nvl(a.usestatus, 0) <> 0 --去掉取消状态的物流入库订单
   and nvl(b.clflag, 0) = 1 --收货完成
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.sourcecompanyid = e.companyid(+)
   and b.ownergoodsid = f.ownergoodsid(+)
   and b.shrid = g.employeeid(+)
   and b.ysfs = h.transmodeid(+)
   and exists (select 1
          from wms_goods_feature t1
         where t1.goodsclass in( 11,13,24,25)
           and a.warehid = t1.warehid
           and b.goodsid = t1.goodsid) --蛋白同化制剂肽类激素WMS货品分类
"
"ZX_500021_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500021_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OPERATIONTYPE"", ""CHECKDATE"", ""OWNERGOODSID"", ""GOODSID"", ""COMPANYID"", ""COMPANYNAME"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""DRUGFORM"", ""APPROVEDOCNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSQTY"", ""TRADEPACKNAME"", ""DECISIONFLAG"", ""QUANSTATUS"", ""QUALIFIEDQTY"", ""UNQUALIFIEDMEMO"", ""CHECKMEMO"", ""CHECKMANID"", ""CHECKMAN"", ""CHECKID"", ""SHDATE"", ""DHDATE"", ""INID"") AS 
  select a.warehid,
       c.warehname,
       a.goodsownerid, --货主ID
       d.goodsownername, --货主名称
       a.operationtype,
       b.checkdate, --验收日期
       b.ownergoodsid,
       b.goodsid, --货品主档ID
      -- f.goodsownid,
       a.companyid,
       e.companyname, --来货单位
    --   e.supplyeraddress, --供货者地址
      -- e.supplyerconnphone, --供货者联系方式
       f.goodsname, --货品名称
       f.mah, --上市许可持有人
       f.factname, --生产厂商
       f.goodstype, --规格/型号
       f.drugform ,--剂型
       f.approvedocno, --批准文号
       a.lotid,
       g.lotno, --批号
       g.proddate,--生产日期
       decode(to_char(g.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              g.validdate) validdate, --有效期
     --  f.udi_code, --医疗器械唯一标识
       a.goodsqty, --数量
       f.tradepackname, --单位
     --  (select t.transclass from wms_goods_feature t where t.warehid=a.warehid and t.goodsid=a.goodsid) transcondition, --运输条件
     --  f.storagecondition, --贮存条件
       decode(a.quanstatus, 1, 1, 2, 3, 3, 2, 4) decisionflag, --验收结论
       a.quanstatus ,--质量状态
       decode(a.goodsstatusid, 1, a.goodsqty, 9, a.goodsqty, 0) qualifiedqty, --验收合格数量
       b.unqualifiedmemo, -- 不合格处置措施
       b.checkmemo,--验收备注
       a.inputmanid checkmanid,
       h.employeename checkman, --验收人员
       a.checkid,
       i.shdate,-- 收货日期
       i.dhdate, --到货时间
       i.inid --入库订单ID
  from gsp_physic_quality_check a,
       wms_receive_dtl          b,
       tpl_warehouse            c,
       tpl_goodsowner           d,
       tpl_go_company           e,
       tpl_goods                f,
       wms_goods_lot            g,
       pub_employee             h,
       wms_in_order_dtl         i
 where a.receiveid = b.receiveid
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.companyid = e.companyid(+)
   and b.ownergoodsid = f.ownergoodsid(+)
   and a.lotid = g.lotid(+)
   and a.inputmanid = h.employeeid(+)
   and b.indtlid = i.indtlid(+)
   and exists (select 1
          from wms_goods_feature t1
         where t1.goodsclass in( 11,13,24,25)
           and a.warehid = t1.warehid
           and a.goodsid = t1.goodsid) --蛋白同化制剂肽类激素WMS货品分类
"
"ZX_500022_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500022_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""DRUGFORM"", ""GOODSNAME"", ""GOODSTYPE"", ""MAH"", ""TRADEPACKNAME"", ""LOTFACTNAME"", ""GOODSQTY"", ""OWNERGOODSID"", ""POSID"", ""POSNO"", ""AREAID"", ""AREANO"", ""AREANAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"") AS 
  select a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.goodsid,
       f.drugform,
       h.goodsname,
       h.goodstype,
       l.mah,
      -- h.prodarea,
      -- f.factid,
     --  h.factname factname, -- xyue 2017-03-27 取货主货品信息上的厂家
       h.tradepackname, --xyue 2014-05-23 物流中心库存查询增加基本单位字段
       l.factname lotfactname,
       a.goodsqty,--货品库存
     --  a.busiqty,--货品业务库存
      -- a.posqty,
      -- a.poswaitqty,
       --a.tradeinwaitqty,
      -- a.outwaitqty,
       a.ownergoodsid,
     --  a.batchno,
       --a.goodspackid,
      -- i.packname,
      -- i.packsize,
       a.posid,
       j.posno,--货位编号
      -- j.posname,
       j.areaid,
       j.areano,
       j.areaname,
       j.sectionid,
       j.sectionno,
       j.sectionname,
      -- j.sorttype,
      -- j.areatype,
       --j.areaflag,
       a.lotid,
       l.lotno,
       decode(to_char(l.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              l.validdate) validdate,
       l.proddate,
       l.approvedocno,
       a.goodsstatusid,
       m.goodsstatus,
       m.quantitystatus,
       m.useflag--业务状态
     --  h.goodsownid,
      -- h.goodsno,
       -- h.supplyername, --change by llq 2021-1-20

  from wms_st_qty_lst      a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_pub_company     d,
       tpl_pub_goods       f,
       tpl_goods           h,
       tpl_pub_goods_packs i,
       wms_pos_def_v       j,
       wms_goods_lot       l,
       wms_goodsstatus     m,
       wms_container_def   n,
       wms_goods_feature   o
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.goodsid = f.goodsid
   and f.factid = d.companyid(+)
   and a.ownergoodsid = h.ownergoodsid(+)
   and a.goodspackid = i.goodspackid(+)
   and a.posid = j.posid
   and a.lotid = l.lotid(+)
   and a.goodsstatusid = m.goodsstatusid(+)
   and a.containerid = n.containerid(+)
   and a.warehid = o.warehid(+)
   and a.goodsid = o.goodsid(+)
   and exists (select 1
          from wms_goods_feature t1
         where t1.goodsclass in( 11,13,24,25)
           and a.warehid = t1.warehid
           and a.goodsid = t1.goodsid) --蛋白同化制剂肽类激素WMS货品分类
"
"ZX_500023_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500023_V"" (""WAREHNAME"", ""CONSERVEID"", ""WAREHID"", ""GOODSID"", ""GOODSNAME"", ""COMPANYNAME"", ""DRUGFORM"", ""GOODSQTYPE"", ""LOTID"", ""LOTNO"", ""LOTVALIDDATE"", ""APPROVEDOCNO"", ""PRODDATE"", ""POSID"", ""SECTIONID"", ""SECTIONNAME"", ""POSNO"", ""GOODSQTY"", ""GOODSUNIT"", ""PACKAGE"", ""RESULT"", ""CHECKMANID"", ""CHECKMAN"", ""EMFLAG"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""QUANSTANDARD"", ""CONSERVEDATE"", ""MAH"") AS 
  select tpl_warehouse.warehname,
       gsp_conserve.conserveid,
       gsp_conserve.warehid,
       gsp_conserve.goodsid,
       d.goodsname,
     --  d.goodsformalname,
     --  d.prodarea,
      -- tpl_pub_goods.factid,
       d.factname companyname,
      -- tpl_pub_company.companyopcode,
       tpl_drugform.drugform,
      -- tpl_drugform.drugformno,
       d.goodstype GOODSQTYPE,
       gsp_conserve.lotid,
       wms_goods_lot.lotno,
       decode(to_char(wms_goods_lot.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              wms_goods_lot.validdate) lotvaliddate,
       wms_goods_lot.approvedocno,
       wms_goods_lot.proddate,
      gsp_conserve.posid,
      -- wms_pos_def.areaid,
      -- wms_st_area_def.areano,
     --  wms_st_area_def.areaname,
         wms_pos_def.sectionid,
     --  wms_st_section_def.sectionno,
       wms_st_section_def.sectionname,
     --  wms_pos_def.posname,
       wms_pos_def.posno,
       gsp_conserve.goodsqty,
       gsp_conserve.goodsunit,
        gsp_conserve.package,--包装情况
        gsp_conserve.result,--处理意见
        gsp_conserve.checkmanid,
        a.employeename checkman,
        gsp_conserve.emflag,
        gsp_conserve.goodsownerid,
       f.goodsownername,
        gsp_conserve.quanstandard,--质量状况
        gsp_conserve.conservedate, -- add by xyue 2017-12-11
       wms_goods_lot.mah --add by xyue 2019-12-05 上市许可持有人

     /*  gsp_conserve.matter,
       gsp_conserve.contents,
       gsp_conserve.lastconservedate,
       gsp_conserve.usestatus,
       gsp_conserve.validdate,
       gsp_conserve.memo,

       d.storagecondition, -- add by xyue 2017-12-11
       gsp_conserve.properties,

       gsp_conserve.checkqty,
       gsp_conserve.checkresult,
       gsp_conserve.recheckqty,
       gsp_conserve.recheckresult,


       gsp_conserve.quilityqty,
       gsp_conserve.unquilityqty,
       a.opcode checkmanopcode,

       gsp_conserve.checkmemo,
       gsp_conserve.equipmentid,
       b.equipmentopcode,
       b.equipmentname,
       gsp_conserve.usereason,
       gsp_conserve.checkgoods,
       gsp_conserve.useman,
       gsp_conserve.equipmentmemo,
       gsp_conserve.whitestocknum,
       gsp_conserve.whitepointnum,
       gsp_conserve.xianweinum,
       gsp_conserve.boxienum,
       gsp_conserve.jinshuxienum,
       gsp_conserve.othernum,
       tpl_pub_goods.jkhzflag,
       gsp_conserve.sourceid,
       gsp_conserve.rewhitestocknum,
       gsp_conserve.rewhitepointnum,
       gsp_conserve.rexianweinum,
       gsp_conserve.reboxienum,
       gsp_conserve.rejinshuxienum,
       gsp_conserve.reothernum,

       gsp_conserve.printflag,
       gsp_conserve.printdate,
       gsp_conserve.printmanid,
       c.employeename printman,

       d.goodsownid, -- add by xyue 2017-12-11
       e.goodsqty plangoodsqty, -- add by xyue 2017-12-11

       wms_goods_Lot.Printexpireflag, --add by llq 2020-12-31 打印失效期标志
       wms_goods_lot.printmonthflag, -- by tl@210820打印精确到月
       d.ownergoodsid, --tl@211231
       wms_st_section_def.iwcs_flag,
       (select max(y.employeecode)
          from ssc_gsp_maintain_goods@iwcs x, sys_userlist@iwcs y
         where x.maintainer = y.userid(+)
           and x.mntn_bill_no = gsp_conserve.conserveid) iwcs_checkman*/
  from gsp_conserve,
       tpl_warehouse,
       tpl_pub_goods,
       tpl_pub_company,
       wms_goods_lot,
       wms_st_area_def,
       wms_st_section_def,
       wms_pos_def,
       tpl_drugform,
       pub_employee          a,
       gsp_equipment         b,
       pub_employee          c,
       tpl_goodsowner        f,
       gsp_conserve_plan_dtl e, --add by xyue 2017-12-11
       tpl_goods             d --add by xyue 2017-12-11
 where gsp_conserve.warehid = tpl_warehouse.warehid(+)
   and gsp_conserve.goodsid = tpl_pub_goods.goodsid(+)
   and tpl_pub_goods.factid = tpl_pub_company.companyid(+)
   and gsp_conserve.lotid = wms_goods_lot.lotid(+)
   and gsp_conserve.posid = wms_pos_def.posid(+)
   and wms_pos_def.areaid = wms_st_area_def.areaid(+)
   and wms_pos_def.sectionid = wms_st_section_def.sectionid(+)
   and gsp_conserve.checkmanid = a.employeeid(+)
   and gsp_conserve.equipmentid = b.equipmentid(+)
   and tpl_drugform.drugformno(+) = tpl_pub_goods.drugform
   AND gsp_conserve.printmanid = c.employeeid(+)
   And gsp_conserve.goodsownerid = f.goodsownerid(+)
   and gsp_conserve.sourceid = e.conservedtlid(+) --add by xyue 2017-12-11
   and gsp_conserve.ownergoodsid = d.ownergoodsid(+) --add by xyue 2017-12-11;
   and exists (select 1
          from wms_goods_feature t1
         where t1.goodsclass in( 11,13,24,25)
           and gsp_conserve.warehid = t1.warehid
           and gsp_conserve.goodsid = t1.goodsid) --蛋白同化制剂肽类激素WMS货品分类
"
"ZX_500024_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500024_V"" (""WAREHID"", ""WAREHNAME"", ""OPERATIONTYPE"", ""KEEPDATE"", ""KEEPMANID"", ""KEEPMANNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSTYPE"", ""GOODSNAME"", ""DRUGFORM"", ""APPROVEDOCNO"", ""FACTNAME"", ""MAH"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSQTY"", ""TRADEPACKNAME"", ""COMPANYID"", ""COMPANYNAME"", ""QUANTITYSTATUS"") AS 
  select a.warehid,
       p.warehname,
       a.operationtype,
       a.keepdate,
       a.keepmanid,
      -- k.opcode keepmanopcode,
       k.employeename keepmanname,
       a.goodsownerid,
       e.goodsownername,
       a.goodsid,
       n.goodstype,
       n.goodsname,
       n.drugform,
       i.approvedocno,
       i.factname factname, --修改货品出库复核记录的生产厂家取批号信息上的生产厂家，xyue 2014年1月6日 17:22:54
       i.mah, --add by xyue 2019-08-22 上市许可持有人
       a.lotid,
       i.lotno,
       decode(to_char(i.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              i.validdate) validdate,
       i.proddate,
       a.goodsqty,
       n.tradepackname,
       a.companyid,
       f.companyname,
       g.quantitystatus


      /* a.inoutid,
       a.credate,
       a.inputmanid,
       c.opcode inputcode,
       c.employeename inputname,
       a.checkmanid,
       d.opcode checkmanopcode,
       d.employeename checkmanname,
       a.comefrom,
       f.opcode companyopcode,
       n.prodarea,
       a.batchno,
       a.goodspackid,
       j.packname,
       j.packsize,
       a.posid,
       a.goodsstatusid,
       g.goodsstatus,
       a.memo,
       b.posno,
       b.posname,
       b.areano,
       b.areaname,
       b.sectionno,
       b.sectionname,
       b.areaid,
       b.sectionid,
       a.checkman2id,
       l.opcode checkman2opcode,
       l.employeename checkman2name,
       a.ownergoodsid,
       n.storagecondition,
       a.gcompanyname, --add by weitangjing 20131104 原货主单位名称
       n.goodsownid, -- add by tl  180206 货主原货品ID
       o.goodsclass,
       nvl(n.ecodeflag,0) ecodeflag, --add by xyue 2022-08-29 电子监管码标志
       (select t.sourceid from wms_st_io_doc t where t.inoutid=a.inoutid and t.comefrom in (2,3)) sourceid,
       nvl(b.iwcs_flag,0) iwcs_flag*/
  from Gsp_st_io_record a,
       wms_pos_def_v b,
       pub_employee c,
       pub_employee d,
       tpl_goodsowner e,
       tpl_go_company f,
       wms_goodsstatus g,
       tpl_pub_goods h,
       tpl_pub_company m,
       wms_goods_lot i,
       tpl_pub_goods_packs j,
       pub_employee k,
       pub_employee l,
       tpl_goods n,
       tpl_drugform,
       wms_goods_feature o,
       tpl_warehouse p
 where a.posid = b.posid(+)
   and a.inputmanid = c.employeeid(+)
   and a.checkmanid = d.employeeid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.companyid = f.companyid(+)
   and a.goodsid = h.goodsid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.lotid = i.lotid(+)
   and a.goodspackid = j.goodspackid(+)
   and a.keepmanid = k.employeeid(+)
   and a.checkman2id = l.employeeid(+)
   and h.factid = m.companyid(+)
   and a.ownergoodsid = n.ownergoodsid(+)
   and h.drugform = tpl_drugform.drugformno(+)
   and a.warehid = o.warehid(+)
   and a.goodsid = o.goodsid(+)
   and a.warehid = p.warehid(+)
   and exists (select 1
          from wms_goods_feature t1
         where t1.goodsclass in( 11,13,24,25)
           and a.warehid = t1.warehid
           and a.goodsid = t1.goodsid) --蛋白同化制剂肽类激素WMS货品分类
"
"ZX_500025_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_500025_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GCOMPANYID"", ""COMPANYNAME"", ""TRANSID"", ""INCEPTADDR"", ""GOODSID"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""TRADEPACKNAME"", ""SOURCEID"", ""SELFTRANSTYPE"", ""EXCARRIER"", ""DISPATCHID"", ""VEHICLEID"", ""VEHICLENO"", ""TRANSMODEL"", ""DRIVERID"", ""DRIVERNAME"", ""TRID"", ""DISPATCHDATE"", ""USESTATUS"", ""STARTDATE"", ""ENDDATE"", ""WAREHADDRESS"") AS 
  select a.warehid,
       c.warehname,
       a.goodsownerid, --货主ID
       d.goodsownername, --委托方名称
      -- i.realdispatchdate, --发货时间
       a.gcompanyid,
       e.companyname, --收货单位名称
       a.transid,
       f.inceptaddr, --地址
     --  f.connphone, --联系方式
     --  b.ownergoodsid,
       b.goodsid, --货品主档ID
      -- g.goodsownid,
       g.goodsname, --
       g.mah, --上市许可持有人
       g.factname, --受托生产企业名称
       g.goodstype, --规格/型号
     --  g.approvedocno, --医疗器械注册证编号/备案编号
       b.lotid,
       h.lotno, --生产批号/序列号
       b.goodsqty, --数量
       g.tradepackname, --单位
       a.sourceid, --随货同行单号
     --  (select t.transclass from wms_goods_feature t where t.warehid=a.warehid and t.goodsid=b.goodsid) transcondition, --运输条件
      -- g.storagecondition, --贮存条件
      -- nvl(a.signdate, a.enddate) signdate, --到货时间
       decode(nvl(a.excarrier,0),0,1,2) selftranstype,--自外运标志 1-自运 2-外运
       a.excarrier, --承运单位名称
       a.dispatchid, --派车单ID
       i.vehicleid,
       i.vehicleno, --车牌号
       i.transmodel,--运输方式
       i.driverid,
       i.drivername, --运输人员
       a.trid,
        i.dispatchdate, --发车时间
        i.usestatus,-- 使用状态
      ( select t2.startdate from tms_dispatch_dtl t2  where t2.trid = a.trid   and t2.usestatus <> 1 )  startdate ,--启运时间
      ( select t2.enddate from tms_dispatch_dtl t2  where t2.trid = a.trid   and t2.usestatus <> 1)  enddate, --到达时间
      c.warehaddress

  from tms_tr_doc a,
       tms_luyan_tr_dtl b,
       tpl_warehouse c,
       tpl_goodsowner d,
       tpl_go_company e,
       wms_transport_address f,
       tpl_goods g,
       wms_goods_lot h,
       (select t1.realdispatchdate,
               t1.dispatchdate,
               t1.dispatchid,
               t1.vehicleid,
               t2.vehicleno,
               t1.driverid,
               t3.drivername,
               t1.transmodel,
               t1.usestatus
          from tms_dispatch_doc t1, tms_vehicle t2, tms_driver t3
         where t1.usestatus in (0, 4, 5) --派车单状态在途、运输完成、撤单
           and t1.vehicleid = t2.vehicleid(+)
           and t1.driverid = t3.driverid(+)
        union all
        select tt1.credate realdispatchdate,
               tt1.dispatchdate,
               tt1.dispatchid,
               tt1.vehicleid,
               tt2.vehicleno,
               tt1.driverid,
               tt3.drivername,
               26 transmodel,
               tt1.usestatus
          from tms_luyan_dispatch_doc tt1, tms_vehicle tt2, tms_driver tt3
         where tt1.vehicleid = tt2.vehicleid(+)
           and tt1.driverid = tt3.driverid(+)) i
 where a.trid = b.trid
   and a.dispatchid = i.dispatchid
   and a.sourcetable = 1 --波次释放
   and a.comefrom = 1 --WMS转入
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.gcompanyid = e.companyid(+)
   and a.transid = f.transid(+)
   and b.ownergoodsid = g.ownergoodsid(+)
   and b.lotid = h.lotid(+)
   and exists (select 1
          from wms_goods_feature t1
         where t1.goodsclass in( 11,13,24,25)
           and a.warehid = t1.warehid
           and b.goodsid = t1.goodsid) --蛋白同化制剂肽类激素WMS货品分类
"
"ZX_6303_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_6303_V"" (""PORDERID"", ""PORDERDTLID"", ""ORDERNO"", ""ZXCOLUMN4"", ""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""SOURCECOMPANYID"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""MEMO"", ""FEEDBACKSTATUS"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""DRUGFORM"", ""FACTNAME"", ""MAH"", ""APPROVEDOCNO"", ""PRODAREA"", ""GOODSQTY"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""FEEDBACKMANID"", ""FEEDBACKMAN"", ""FEEDBACKMSG"", ""FEEDBACKDATE"") AS 
  select a.porderid,
       b.porderdtlid,
       a.orderno,
       a.zxcolumn4,
       a.credate,
       a.warehid,
       c.warehname,
       a.goodsownerid,
       d.goodsownername,
       a.sourcecompanyid,
       e.companyname,
       a.operationtype,
       a.memo,
       a.feedbackstatus,
       b.ownergoodsid,
       f.waregoodsid as goodsid, --货品主档ID
       f.goodsownid, --货主原货品ID
       f.goodsname,
       f.goodsengname,
       f.goodstype,
       f.tradepackname,
       f.drugform,
       nvl(b.factname, f.factname) as factname,
       nvl(b.mah, f.mah) as mah,
       nvl(b.approvedocno, f.approvedocno) as approvedocno,
       f.prodarea,
       b.goodsqty,
       b.lotid,
       b.lotno,
       b.proddate,
       b.validdate,
       b.goodsstatusid,
       g.goodsstatus,
       a.feedbackmanid,
       h.employeename as feedbackman,
       a.feedbackmsg,
       a.feedbackdate
  from tpl_purchase_order     a,
       tpl_purchase_order_dtl b,
       tpl_warehouse          c,
       tpl_goodsowner         d,
       tpl_go_company         e,
       tpl_goods              f,
       wms_goodsstatus        g,
       pub_employee           h
 where a.porderid = b.porderid
   and a.operationtype in (42,44)
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.sourcecompanyid = e.companyid(+)
   and b.ownergoodsid = f.ownergoodsid
   and b.goodsstatusid = g.goodsstatusid(+)
   and a.feedbackmanid = h.employeeid(+)
   and a.credate>to_date('2025-01-01','yyyy-mm-dd')
"
"ZX_700006_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_700006_DOC_V"" (""CREDATE"", ""TIME2"", ""TIME3"", ""TIME4"", ""DISPATCHID"", ""REALDISPATCHDATE"", ""BACKTIME"", ""WAREHID"", ""GOODSOWNERID"", ""COMEFROM"", ""OUTID"", ""WAVEID"", ""WAVEDTLID"", ""EORDERNO"", ""LINENO"", ""ERPID"", ""USESTATUS"", ""EXPORTMEMO"", ""SALERNAME"", ""DEPTNAME"", ""ARRIVEDATE"", ""TRANSMODEID"", ""COMPOSEINFO"", ""TRANSNO"", ""COMPANYTYPE"", ""INPUTMANID"", ""OPERATIONTYPE"", ""MEDICINECLASS"", ""PRTINVFLAG"", ""WAREHNAME"", ""GOODSOWNERNAME"", ""GCOMPANYNO"", ""CONFIRMNAME"", ""EMPLOYEENAME"", ""PTRANSMODE"", ""PTRANSNAME"", ""RECCOMPANYNAME"", ""TRANSMODE"", ""TRANSNAME"", ""ROUTEID"", ""ROUTENAME"", ""CONNECTOR"", ""CONNPHONE"", ""TELEPHONE"", ""EMPLOYEEID"", ""MANOPCODE"", ""MANNAME"", ""CANCELDATE"", ""CANCELMANNAME"", ""RECCOMPANYID"", ""WHOLEPACKS"", ""SCATTERPACKS"", ""CHAINFLAG"") AS 
  select a.credate,
       a.time2,
       a.time3,
       a.time4,
       ee.dispatchid,
       bb.realdispatchdate,
       ee.signdate backtime,
       a.warehid,
       a.goodsownerid,
       a.comefrom,
       a.outid,
       a.waveid,
       a.wavedtlid,
       a.eorderno,
       a.lineno,
       a.zxcolumn4 ERPID,
       a.usestatus,
       a.exportmemo,
       a.salername,
       a.deptname,
       a.arrivedate,
       a.transmodeid,
       a.composeinfo,
       a.transno,
       a.companytype,
       a.inputmanid,
       a.operationtype,
       a.medicineclass,


       a.prtinvflag,
       c.warehname,
       d.goodsownername,
       f.gcompanyno,
       j.employeename confirmname,
       g.employeename,
       h.transmode ptransmode,
       h.transname ptransname,
       f.companyname reccompanyname,
       b.transmode,
       b.transname,
       l.routeid,
       l.routename,
       f.connector,
       f.connphone,
       f.telephone,
       a.employeeid,
       aa.opcode manopcode,
       aa.employeename manname,
       a.canceldate,
       dd.employeename cancelmanname,
       a.reccompanyid,
       ee.wholepacks,
       ee.scatterpacks,
       ee.chainflag --by tl@210705

  from wms_out_order      a,
       wms_transport_mode b,
       tpl_warehouse      c,
       tpl_goodsowner     d,
       tpl_go_company     f,
       pub_employee       g,
       wms_transport_mode h,
       pub_employee       j,
       tms_route_pos      k,
       wms_tr_route       l,
       pub_employee       aa,
       pub_employee       dd,
       tms_dispatch_doc   bb,
       TMS_TR_DOC         ee
 where a.transmodeid = b.transmodeid(+)
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.reccompanyid = f.companyid(+)
   and a.inputmanid = g.employeeid(+)
   and a.confirmman = j.employeeid(+)
   and a.ptransmodeid = h.transmodeid(+)
   and a.transid = k.transid(+)
   and a.warehid = k.warehid(+)
   and k.routeid = l.routeid(+)
   and a.employeeid = aa.employeeid(+)
   and a.cancelmanid = dd.employeeid(+)
   and a.wavedtlid = ee.sourceid(+)
   and ee.dispatchid = bb.dispatchid(+)
"
"ZX_700006_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_700006_DTL_V"" (""OUTID"", ""BMSINOUTID"", ""OUTDTLID"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTNAME"", ""OWNERGOODSID"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""KILLLOTNO"", ""VALIDDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""PRICE"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""REALQTY"", ""TRADEGOODSQTY"", ""TRADEGOODSPACK"", ""STOCKQTY"", ""CUSTCANCELSTATUS"", ""WMSCANCELSTATUS"", ""ADDMEDCHECKFLAG"", ""SRCEXPDTLNO"", ""USESTATUS"", ""PRINTFLAG"", ""PRINTERROR"", ""DISTRIBUTEID"", ""DISTRIBUTEDTLID"", ""RETAILPRICE"", ""AMT"", ""ALLOCATETIME"", ""FAILREASON"", ""EXPDTLMEMO"", ""PLACESUPPLYID"", ""PLACESUPPLYDTLID"", ""PLACEPRICE"", ""RESALEPRICE"", ""PLACEMONEY"", ""GOODSCLASSID"", ""OTCFLAG"", ""TRADEMARK"", ""APPROVEDOCNO"", ""REGISTNO"", ""JKHZFLAG"", ""PRODDATE"", ""QUALIFYDOCNO"", ""GOODSCLASSNAME"", ""OLDDTLID"", ""OTHERID"", ""EXPFLAG"", ""EXPDATE"", ""EXPFILENAME"", ""INVOICENO"", ""INVCODE"", ""INVOICELINE"", ""CANKEEP"", ""ZXCOLOR"", ""TPRICETICK"", ""TPRICEFLAG"", ""SORTTYPE"", ""LOTLIMIT"", ""PERIODLIMIT"", ""PERIODLIMITUNIT"", ""GOODSOWNID"", ""PRTORDERSET"", ""DTLMEMO"", ""GOODSCLASS"", ""GOODSNO"", ""PRINTNO"", ""WAVEGOODSDTLID"", ""CANCELDATE"", ""WAITFORCANCEL"", ""CANCELMANID"", ""LYDTLZXCOLUMN3"", ""LYDTLZXCOLUMN1"", ""LYDTLZXCOLUMN2"", ""LYDTLZXCOLUMN4"", ""LYDTLZXCOLUMN5"", ""LYDTLZXCOLUMN6"", ""LYDTLZXCOLUMN7"", ""PRINTMONTHFLAG"", ""CANCELMANNAME"", ""DTLZXCOLUMN4"", ""LYDTLZXCOLUMN8"", ""LYDTLZXCOLUMN9"", ""LYDTLZXCOLUMN10"", ""LYDTLZXCOLUMN11"", ""LYDTLZXCOLUMN12"") AS 
  select a.outid,
       a.bmsinoutid,
       a.outdtlid,
       a.warehid,
       a.goodsownerid,
       a.goodsid,
       e.goodsname,
       e.goodsengname,--增加通用名字段,xyue 2013年10月28日 8:03:54
       e.goodstype,
       e.prodarea,
       b.factid,
       nvl(g.factname,e.factname) factname,--取批号上的生产厂家 zhaocl 2013年7月26日 17:21:46
       -- 取货主货品信息上的厂家信息 xyue 2017-04-10
       a.ownergoodsid,
       a.batchno,
       a.lotid,
       g.lotno,
       g.killlotno,--xyue 2014-06-02 批号信息上的灭菌批号，器械要求
       decode(to_char(g.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              g.validdate) validdate,
       a.goodsstatusid,
       d.goodsstatus,
       a.quantitystatus,
       a.price,
       a.goodsqty,
       a.goodspackid,
       c.packname,
       c.packsize,
       a.realqty,
       a.tradegoodsqty,
       a.tradegoodspack,
       a.stockqty,
       a.custcancelstatus,
       a.wmscancelstatus,
       a.addmedcheckflag,
       a.srcexpdtlno,
       a.usestatus,
       decode(a.printflag,null,null,1) printflag,
       a.printerror,
       a.distributeid,
       a.distributedtlid,
       a.retailprice,
       a.amt,
       a.allocatetime,
       a.failreason,
       a.expdtlmemo,
       a.placesupplyid,
       a.placesupplydtlid,
       a.placeprice,
       a.resaleprice,
       a.placemoney,
       a.goodsclassid,
       a.otcflag,
       a.trademark,
       g.approvedocno,
       g.registno,
       b.jkhzflag,
       g.proddate,
       a.qualifydocno,
       a.goodsclassname,
       a.olddtlid,
       a.otherid,
       a.expflag,
       a.expdate,
       a.expfilename,
       a.invoiceno,
       a.invcode,--发票代码 add by xyue 2017-11-28
       a.invoiceline,
       a.cankeep,
       a.zxcolor,
       a.tpricetick,
       a.tpriceflag,
       a.sorttype,
       a.lotlimit,
       a.periodlimit,
       a.periodlimitunit,
       e.goodsownid,
       a.prtorderset,
       a.dtlmemo,
       f.goodsclass,
       e.goodsno,
       a.printno,
       a.wavegoodsdtlid,
       a.canceldate,
       a.waitforcancel,
       a.cancelmanid,
       a.Lydtlzxcolumn3,--原价 zhaocl 2013年7月22日 17:25:23
       a.Lydtlzxcolumn1,--折扣率 zhaocl 2013年7月22日 17:33:51
       a.Lydtlzxcolumn2,--价格类型 zhaocl 2013年7月22日 17:33:51
       a.Lydtlzxcolumn4,--标期 zhaocl 2013年7月22日 17:33:51
       a.Lydtlzxcolumn5,--打印单位 zhaocl 2013年7月22日 17:33:51
       a.Lydtlzxcolumn6,--换算比例 zhaocl 2013年7月22日 17:33:51
       a.lydtlzxcolumn7,--打印分类 add by wanghuaiyu 2013年7月30日 21:52:20
       g.printmonthflag,--打印精确到月 zhaocl 2013年7月22日 18:41:22
       dd.employeename cancelmanname,
       a.dtlzxcolumn4,--ERP细单ID add by wanghuaiyu 2013年8月7日 18:03:09
       a.lydtlzxcolumn8, --ERP细单税率 add by xyue 2013年9月16日 20:27:54
       a.lydtlzxcolumn9,--器械别名系统，ERP细单打印通用名 add by xyue 2013年10月05日 23:27:54
       a.lydtlzxcolumn10,--器械别名系统，ERP细单打印商品名 add by xyue 2013年10月05日 23:27:54
       a.lydtlzxcolumn11,--器械别名系统，ERP细单打印规格 add by xyue 2013年10月05日 23:27:54
       a.lydtlzxcolumn12--器械别名系统，ERP细单打印产地 add by xyue 2013年10月05日 23:27:54
  from wms_out_order_dtl   a,
        tpl_pub_goods       b,
        tpl_pub_goods_packs c,
        wms_goodsstatus     d,
        tpl_goods           e,
        wms_goods_feature   f,
        wms_goods_lot       g,
        tpl_pub_company     h,
        pub_employee      dd
  where a.goodsid = b.goodsid(+)
    and a.goodspackid = c.goodspackid(+)
    and a.goodsstatusid = d.goodsstatusid(+)
    and a.ownergoodsid = e.ownergoodsid
    and a.goodsid = f.goodsid(+)
    and a.warehid = f.warehid(+)
    and a.lotid = g.lotid(+)
    and b.factid = h.companyid(+)
 and a.cancelmanid = dd.employeeid(+)
"
"ZX_700006_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_700006_V"" (""CREDATE"", ""TIME2"", ""TIME3"", ""TIME4"", ""REALDISPATCHDATE"", ""BACKTIME"", ""TRID"", ""WAREHID"", ""GOODSOWNERID"", ""COMEFROM"", ""OUTID"", ""WAVEID"", ""WAVEDTLID"", ""EORDERNO"", ""LINENO"", ""PREEXPDATE"", ""EXPDATE"", ""PREARRIVEDATE"", ""ARRIVEDATE"", ""PTRANSMODEID"", ""TRANSMODEID"", ""EARLYDATE"", ""COMPOSEINFO"", ""TRANSNO"", ""RECCOMPANYID"", ""COMPANYTYPE"", ""TAXFLAG"", ""INPUTMANID"", ""JOBTYPE"", ""OPERATIONTYPE"", ""MEDICINECLASS"", ""RECEIVEADDR"", ""RECEIVEHEAD"", ""REALRECADDR"", ""REALRECMAN"", ""RECEIVEMAN"", ""SIGNMAN"", ""PARTEXPFLAG"", ""SAMELOTFLAG"", ""URGENFLAG"", ""ADDINVOICEFLAG"", ""ARRIVEMEMO"", ""EXPORTMEMO"", ""DETAILLINES"", ""SRCEXPNO"", ""TRANSID"", ""PORDERID"", ""BILLFROM"", ""CONFIRMMAN"", ""CONFIRMDATE"", ""USESTATUS"", ""OUTMODE"", ""INVOICETYPE"", ""TRANSCLASS"", ""SCATTERPACKS"", ""SCATTERFINPACKS"", ""WHOLEPACKS"", ""WHOLEFINPACKS"", ""ALLOCATETIME"", ""FINISHFLAG"", ""FIXFLAG"", ""SALERID"", ""SALERNAME"", ""OLDID"", ""OTHERID"", ""TPRICETICK"", ""TPRICEFLAG"", ""DEPTNO"", ""DEPTNAME"", ""RECEIVEPHONE"", ""TRDTLID"", ""SASETTLEDTLID"", ""PRTCLASS"", ""PRTGROUPSET"", ""TIME1"", ""PRTINVFLAG"", ""WAREHNAME"", ""GOODSOWNERNAME"", ""GCOMPANYID"", ""GCOMPANYNO"", ""CUSTTYPE"", ""CONFIRMNAME"", ""EMPLOYEENAME"", ""PTRANSMODE"", ""PTRANSNAME"", ""RECCOMPANYNAME"", ""TRANSMODE"", ""TRANSNAME"", ""NOWLFLAG"", ""ROUTEID"", ""ROUTENAME"", ""INTOWNFLAG"", ""CONNECTOR"", ""CONNPHONE"", ""TELEPHONE"", ""EMPLOYEEID"", ""MANOPCODE"", ""MANNAME"", ""CANCELDATE"", ""WAITFORCANCEL"", ""CANCELMANID"", ""CANCELMANNAME"") AS 
  select a.credate,
       a.time2,
       a.time3,
       a.time4,
       bb.realdispatchdate,
       cc.backtime,
       ee.trid,
       a.warehid,
       a.goodsownerid,
       a.comefrom,
       a.outid,
       a.waveid,
       a.wavedtlid,
       a.eorderno,
       a.lineno,
       a.preexpdate,
       a.expdate,
       a.prearrivedate,
       a.arrivedate,
       a.ptransmodeid,
       a.transmodeid,
       a.earlydate,
       a.composeinfo,
       a.transno,
       a.reccompanyid,
       a.companytype,
       a.taxflag,
       a.inputmanid,
       a.jobtype,
       a.operationtype,
       a.medicineclass,
       a.receiveaddr,
       a.receivehead,
       a.realrecaddr,
       a.realrecman,
       a.receiveman,
       a.signman,
       a.partexpflag,
       a.samelotflag,
       nvl(a.urgenflag, 0) urgenflag,
       a.addinvoiceflag,
       a.arrivememo,
       a.exportmemo,
       a.detaillines,
       a.srcexpno,
       a.transid,
       a.porderid,
       a.billfrom,
       a.confirmman,
       a.confirmdate,
       a.usestatus,
       a.outmode,
       a.invoicetype,
       a.transclass,
       a.scatterpacks,
       a.scatterfinpacks,
       a.wholepacks,
       a.wholefinpacks,
       a.allocatetime,
       a.finishflag,
       a.fixflag,
       a.salerid,
       a.salername,
       a.oldid,
       a.otherid,
       a.tpricetick,
       a.tpriceflag,
       a.deptno,
       a.deptname,
       a.receivephone,
       a.trdtlid,
       a.sasettledtlid,
       a.prtclass,
       a.prtgroupset,
       a.time1,
       a.prtinvflag,
       c.warehname,
       d.goodsownername,
       f.gcompanyid,
       f.gcompanyno,
       substr(f.gcompanyno, 6, 1) custtype,
       j.employeename confirmname,
       g.employeename,
       h.transmode ptransmode,
       h.transname ptransname,
       f.companyname reccompanyname,
       b.transmode,
       b.transname,
       a.nowlflag,
       l.routeid,
       l.routename,
       l.intownflag,
       f.connector,
       f.connphone,
       f.telephone,
       a.employeeid,
       aa.opcode manopcode,
       aa.employeename manname,
       a.canceldate,
       a.waitforcancel,
       a.cancelmanid,
       dd.employeename cancelmanname

  from wms_out_order      a,
       wms_transport_mode b,
       tpl_warehouse      c,
       tpl_goodsowner     d,
       tpl_go_company     f,
       pub_employee       g,
       wms_transport_mode h,
       pub_employee       j,
       tms_route_pos      k,
       wms_tr_route       l,
       pub_employee       aa,
       pub_employee       dd,
       tms_dispatch_doc   bb,
       tms_dispatch_dtl   cc,
       TMS_TR_DOC         ee
 where a.transmodeid = b.transmodeid(+)
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.reccompanyid = f.companyid(+)
   and a.inputmanid = g.employeeid(+)
   and a.confirmman = j.employeeid(+)
   and a.ptransmodeid = h.transmodeid(+)
   and a.transid = k.transid(+)
   and a.warehid = k.warehid(+)
   and k.routeid = l.routeid(+)
   and a.employeeid = aa.employeeid(+)
   and a.cancelmanid = dd.employeeid(+)
   and a.wavedtlid = ee.sourceid
   and ee.dispatchid = bb.dispatchid
   and bb.dispatchid = cc.dispatchid





--订单接收时间，波次释放时间，拣货完成时间，复核时间，派车时间，签收时间；
"
"ZX_700007_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_700007_V"" (""BEGINDATE"", ""FROMADDRESS"", ""TOADDRESS"", ""LLYS"", ""TLYS"", ""HGYS"", ""CYR"", ""SOURCEID"", ""CREDATE"", ""COMPANYNAME"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""TRADEGOODSPACK"", ""GOODSQTY"", ""PRICE"", ""LYDTLZXCOLUMN3"", ""AMT"", ""INVOICENO"", ""DISPATCHID"", ""VEHICLEID"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""TRID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSOWNID"", ""GOODSID"", ""DEPTNAME"") AS 
  select c.realdispatchdate begindate,
       '厦门' fromaddress,
       o.city toaddress,
       '1' llys,
       null tlys,
       null hgys,
       null cyr,
       a.sourceid,
       g.credate,
       h.companyname,
       j.goodsname,
       j.goodstype,
       j.factname,
       i.tradegoodspack,
       i.goodsqty,
       i.price,
       i.lydtlzxcolumn3,
       i.amt,
       i.invoiceno,
       c.dispatchid,
       c.vehicleid,
       k.vehicleno,
       c.driverid,
       e.drivername,
       c.driver2id,
       p.drivername driver2name,
       a.trid,
       a.goodsownerid,
       m.goodsownername,
       a.warehid,
       n.warehname,
       i.ownergoodsid,
       j.goodsownid,
       i.goodsid,
       f.deptname

  from TMS_TR_DOC        a,
       tms_dispatch_dtl  b,
       tms_dispatch_doc  c,
       tms_driver        e,
       wms_out_order     f,
       tpl_export_order  g,
       tpl_go_company    h,
       wms_out_order_dtl i,
       tpl_goods         j,
       tms_vehicle       k,
       tms_driver        p,
       tpl_goodsowner    m,
       tpl_warehouse     n,
       wms_transport_address o
 where a.trid = b.trid
   and b.dispatchid = c.dispatchid
   and c.driverid = e.driverid(+)
   and a.sourceid = f.wavedtlid
   and f.oldid = g.exporderid
   and g.reccompanyid = h.companyid(+)
   and f.outid = i.outid
   and i.ownergoodsid = j.ownergoodsid(+)
   and c.vehicleid = k.vehicleid(+)
   and c.driver2id = p.driverid(+)
   and a.goodsownerid = m.goodsownerid(+)
   and a.warehid = n.warehid(+)
   and a.transid=o.transid(+)
   and a.warehid = 1

union all

select c.printdate,
       '厦门',
       o.city,
       '1',
       null,
       null,
       null,
       a.sourceid,
       g.credate,
       h.companyname,
       j.goodsname,
       j.goodstype,
       j.factname,
       i.tradegoodspack,
       i.goodsqty,
       i.price,
       i.lydtlzxcolumn3,
       i.amt,
       i.invoiceno,
       c.dispatchid,
       c.vehicleid,
       k.vehicleno,
       c.driverid,
       e.drivername,
       c.driver2id,
       p.drivername driver2name,
       a.trid,
       a.goodsownerid,
       m.goodsownername,
       a.warehid,
       n.warehname,
       i.ownergoodsid,
       j.goodsownid,
       i.goodsid,
       f.deptname

  from TMS_TR_DOC             a,
       TMS_luyan_DISPATCH_DOC c,
       tms_driver             e,
       wms_out_order          f,
       tpl_export_order       g,
       tpl_go_company         h,
       wms_out_order_dtl      i,
       tpl_goods              j,
       tms_vehicle            k,
       tms_driver             p,
       tpl_goodsowner         m,
       tpl_warehouse          n,
       wms_transport_address  o
 where a.dispatchid = c.dispatchid
   and c.driverid = e.driverid(+)
   and a.sourceid = f.wavedtlid
   and f.oldid = g.exporderid
   and g.reccompanyid = h.companyid(+)
   and f.outid = i.outid
   and i.ownergoodsid = j.ownergoodsid(+)
   and c.vehicleid = k.vehicleid(+)
   and c.driver2id = p.driverid(+)
   and a.goodsownerid = m.goodsownerid(+)
   and a.warehid = n.warehid(+)
   and a.transid=o.transid(+)
   and a.warehid = 1
"
"ZX_700009_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_700009_V"" (""数据来源"", ""类型"", ""日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""库区"", ""散件条数"", ""整件件数"", ""总数"") AS 
  select decode(t.数据来源, 'WMS', 1, 2) 数据来源,
       decode(t.类型,
              '收货',
              1,
              '验收',
              2,
              '上架',
              3,
              '拣货',
              4,
              '复核',
              5,
              '存储',
              6,
              '运输',
              7,
              0) 类型,
       t.日期,
       t.物流中心ID,
       t.物流中心,
       t.货主ID,
       t.货主名称,
       t.库区,
       t.散件条数,
       t.整件件数,
       t.总数
  from bs_work@lybs t
 where t.物流中心ID = 1
   and t.类型 <> '库内移动'
   and t.日期 between to_date('2021-01-01','yyyy-mm-dd') and  to_date('2022-12-01','yyyy-mm-dd')
"
"ZX_700010_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_700010_V"" (""KCRQ"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""APPROVEDOCNO"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""GOODSQTY"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""POSID"", ""POSNAME"", ""AREAID"", ""AREAFLAG"", ""AREANAME"", ""SECTIONID"", ""SECTIONNAME"", ""IWCS_FLAG"", ""SECTIONCLASS"") AS 
  select a.kcrq,
       a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.ownergoodsid,
       a.goodsid,
       d.goodsownid,
       d.goodsname,
       d.goodsengname,
       d.goodstype,
       d.tradepackname,
       d.factname,
       d.prodarea,
       a.lotid,
       e.lotno,
       e.approvedocno,
       a.goodspackid,
       f.packname,
       f.packsize,
       a.goodsqty,
       a.goodsstatusid,
       g.goodsstatus,
       a.posid,
       h.posname,
       a.areaid,
       i.areaflag,
       i.areaname,
       a.sectionid,
       j.sectionname,
       nvl(j.iwcs_flag,0) iwcs_flag,
       j.sectionclass
  from wms_st_qty_lst_bak  a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       wms_goods_lot       e,
       tpl_pub_goods_packs f,
       wms_goodsstatus     g,
       wms_pos_def         h,
       wms_st_area_def     i,
       wms_st_section_def  j
 where a.warehid = 1
   and a.kcrq between to_date('2021-01-01', 'yyyy-mm-dd') and
       to_date('2025-01-01', 'yyyy-mm-dd')
   and a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.lotid = e.lotid
   and a.goodspackid = f.goodspackid
   and a.goodsstatusid=g.goodsstatusid
   and a.posid=h.posid(+)
   and a.areaid=i.areaid(+)
   and a.sectionid=j.sectionid(+)
"
"ZX_700011_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_700011_V"" (""INID"", ""INDTLID"", ""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""SOURCECOMPANYID"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""PORDERSTATUS"", ""MEMO"", ""ZXCOLUMN4"", ""DTLZXCOLUMN4"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""FACTNAME"", ""PRODAREA"", ""TRADEPACKNAME"", ""DRUGFORM"", ""APPROVEDOCNO"", ""MAH"", ""GOODSQTY1"", ""DDLOTNO"", ""GOODSQTY"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BUYINGPRICE"", ""BUYINGAMT"", ""SHDATE"", ""INOUTID"", ""KEEPDATE"") AS 
  select a.inid,
       b.indtlid,
       a.credate,
       a.warehid,
       d.warehname,
       a.goodsownerid,
       e.goodsownername,
       a.sourcecompanyid,
       f.companyname,
       a.operationtype,
       b.porderstatus,
       a.memo,
       a.zxcolumn4,
       b.dtlzxcolumn4,
       b.ownergoodsid,
       b.goodsid,
       g.goodsownid,
       g.goodsname,
       g.goodsengname,
       g.goodstype,
       g.factname,
       g.prodarea,
       g.tradepackname,
       g.drugform,
       g.approvedocno,
       g.mah,
       b.goodsqty goodsqty1, --订单数量
       b.lotno ddlotno,
       c.goodsqty, --验收数量
       c.lotid,
       j.lotno,
       nvl(j.validdate, b.validdate) validdate,
       nvl(j.proddate, b.proddate) proddate,
       c.goodsstatusid,
       i.goodsstatus,
       c.goodspackid,
       h.packname,
       h.packsize,
       b.buyingprice,
       nvl(c.goodsqty, 0) * b.buyingprice buyingamt,
       b.shdate,
       k.inoutid,
       k.keepdate
  from wms_in_order a,
       wms_in_order_dtl b,
       wms_receive_dtl c,
       tpl_warehouse d,
       tpl_goodsowner e,
       tpl_go_company f,
       tpl_goods g,
       tpl_pub_goods_packs h,
       wms_goodsstatus i,
       wms_goods_lot j,
       (select t.inoutid, t.keepdate, t.sourceid
          from wms_st_io_doc t
         where t.comefrom = 1) k
 where a.inid = b.inid
   and b.indtlid = c.indtlid(+)
   and a.warehid = d.warehid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.sourcecompanyid = f.companyid(+)
   and b.ownergoodsid = g.ownergoodsid(+)
   and c.goodspackid = h.goodspackid(+)
   and c.goodsstatusid = i.goodsstatusid(+)
   and c.lotid = j.lotid(+)
   and a.warehid in (1)
   and a.goodsownerid in (9102, 9105, 9113, 9142,9156)
   and a.operationtype in (1, 7, 8)
   and c.receiveid = k.sourceid(+)
"
"ZX_700012_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_700012_V"" (""OUTID"", ""OUTDTLID"", ""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""RECCOMPANYID"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""USESTATUS"", ""EXPORTMEMO"", ""ZXCOLUMN4"", ""DTLZXCOLUMN4"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""FACTNAME"", ""PRODAREA"", ""TRADEPACKNAME"", ""DRUGFORM"", ""APPROVEDOCNO"", ""MAH"", ""GOODSQTY"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""PRICE"", ""AMT"", ""BUYINGPRICE"", ""BUYINGAMT"") AS 
  select a.outid,
       b.outdtlid,
       a.credate,
       a.warehid,
       d.warehname,
       a.goodsownerid,
       e.goodsownername,
       a.reccompanyid,
       f.companyname,
       a.operationtype,
       a.usestatus,
       a.exportmemo,
       a.zxcolumn4,
       b.dtlzxcolumn4,
       b.ownergoodsid,
       b.goodsid,
       g.goodsownid,
       g.goodsname,
       g.goodsengname,
       g.goodstype,
       g.factname,
       g.prodarea,
       g.tradepackname,
       g.drugform,
       g.approvedocno,
       g.mah,
       b.goodsqty,
       b.lotid,
       j.lotno,
       j.validdate,
       j.proddate,
       b.goodsstatusid,
       i.goodsstatus,
       b.goodspackid,
       h.packname,
       h.packsize,
       b.price,
       b.amt,
       b.buyingprice,
       b.buyingprice * b.goodsqty buyingamt
  from wms_out_order       a,
       wms_out_order_dtl   b,
       tpl_warehouse       d,
       tpl_goodsowner      e,
       tpl_go_company      f,
       tpl_goods           g,
       tpl_pub_goods_packs h,
       wms_goodsstatus     i,
       wms_goods_lot       j
 where a.outid = b.outid
   and a.warehid = d.warehid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.reccompanyid = f.companyid(+)
   and b.ownergoodsid = g.ownergoodsid(+)
   and b.goodspackid = h.goodspackid(+)
   and b.goodsstatusid = i.goodsstatusid(+)
   and b.lotid = j.lotid(+)
   and a.warehid in (1)
   and a.usestatus <> 0
   and a.goodsownerid in (9102, 9105, 9142,9156)
"
"ZX_700017_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_700017_V"" (""INID"", ""INOUTID"", ""INDTLID"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""DRUGFORM"", ""PRODAREA"", ""APPROVEDOCNO"", ""MAH"", ""SHDATE"", ""CLFLAG"", ""SHRID"", ""SHRMAN"", ""CHECKDATE"", ""CHECKMANID1"", ""CHECKMANID2"", ""CHECKMAN1"", ""CHECKMAN2"", ""RFFINDATE"", ""RFMANID"", ""RFMAN"") AS 
  select a.inid,j.inoutid,
       b.indtlid,
       a.warehid,
       c.warehname,
       a.goodsownerid,
       d.goodsownername,
       b.ownergoodsid,
       e.goodsname,
       e.goodsengname,
       e.goodstype,
       e.tradepackname,
       e.factname,
       e.drugform,
       e.prodarea,
       e.approvedocno,
       e.mah,
       b.shdate,
       nvl(b.clflag,0) clflag,
       b.shrid,
       f.employeename shrman,
       g.checkdate,
       g.checkmanid1,
       g.checkmanid2,
       h.employeename checkman1,
       i.employeename checkman2,
       j.rffindate,
       j.rfmanid,
       k.employeename rfman
  from wms_in_order     a,
       wms_in_order_dtl b,
       Tpl_warehouse    c,
       Tpl_goodsowner   d,
       tpl_goods        e,
       pub_employee     f,
       wms_receive_dtl  g,
       pub_employee     h,
       pub_employee     i,
       wms_st_io_doc    j,
       pub_employee     k
 where a.warehid = 1
   and a.goodsownerid in (1, 2)
   --and a.inid in (6533687, 6533736)
   and a.inid = b.inid
   and a.credate > to_date('2023-01-01', 'yyyy-mm-dd')
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and b.ownergoodsid=e.ownergoodsid(+)
   and b.shrid=f.employeeid(+)
   and b.indtlid=g.indtlid(+)
   and g.checkmanid1=h.employeeid(+)
   and g.checkmanid2=i.employeeid(+)
   and g.receiveid=j.sourceid(+)
   and j.inoutflag=0
   and j.comefrom=1
   and j.rfmanid=k.employeeid(+)
"
"ZX_700018_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_700018_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OUTID"", ""RECCOMPANYID"", ""COMPANYNAME"", ""USESTATUS"", ""YSCREDATE"", ""CREDATE"", ""ZXCOLUMN4"", ""WAVEID"", ""WAVEDTLID"", ""TIME1"", ""TIME2"", ""RFFINDATE"", ""KEEPDATE"", ""DISPATCHDATE"", ""SIGNDATE"", ""WORKDATE"", ""FINSHDATE"") AS 
  select a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.outid,
       a.reccompanyid,
       d.companyname,
       a.usestatus,
       a.yscredate,
       a.credate,
       a.zxcolumn4,
       a.waveid,
       a.wavedtlid,
       a.time1, --进入波次时间
       a.time2, --波次释放时间
       xyue_get_rffindate(a.wavedtlid) as rffindate, --拣货完成时间
       xyue_get_keepdate(a.wavedtlid) as keepdate, --复核完成时间
       xyue_get_dispatchdate(a.wavedtlid) as dispatchdate, --派车时间
       xyue_get_signdate(a.outid) as signdate, --签收时间
       (case
         when a.usestatus = 4 then
          round((xyue_get_keepdate(a.wavedtlid) - a.yscredate) * 24, 2)
         else
          null
       end) as workdate,
       (case
         when xyue_get_signdate(a.outid) is not null then
          round((xyue_get_signdate(a.outid) - a.yscredate) * 24, 2)
         else
          null
       end) as finshdate
  from wms_out_order a, tpl_warehouse b, tpl_goodsowner c, tpl_go_company d
 where a.ysorderflag = 1
   and a.credate > to_date('2025-01-01', 'yyyy-mm-dd')
   and a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.operationtype = 11 --销售
   and a.usestatus in (1, 2, 3, 4)
   and a.reccompanyid = d.companyid(+)
"
"ZX_700019_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_700019_V"" (""INVDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""FACTNAME"", ""MAH"", ""TRADEPACKNAME"", ""STORAGECONDITION"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKSIZE"", ""PACKNAME"", ""LOTID"", ""LOTNO"", ""COMEFROM"", ""AREAFLAG"", ""POSTYPE"", ""PCS"", ""POSNUM"", ""DRUGFORM"", ""PRODDATE"", ""VALIDDATE"", ""BARCODE"") AS 
  select t.invdate,
       t.warehid,
       t.warehname,
       t.goodsownerid,
       t.goodsownername,
       t.ownergoodsid,
       t.goodsid,
       t.goodsownid,
       t.goodsname,
       t.goodsengname,
       t.goodstype,
       t.factname,
       t.mah,
       t.tradepackname,
       t.storagecondition,
       t.goodsqty,
       t.goodspackid,
       t.packsize,
       t.packname,
       t.lotid,
       t.lotno,
       t.comefrom,
       t.areaflag,
       t.postype,
       t.pcs,
       t.posnum,
       a.drugform,
       b.proddate,
       b.validdate,
       a.barcode
  from zx_700019 t,tpl_goods a,wms_goods_lot b
  where t.ownergoodsid = a.ownergoodsid(+)
  and t.lotid = b.lotid(+)
"
"ZX_700022_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_700022_V"" (""TRID"", ""WAREHID"", ""WAREHNAME"", ""CREDATE"", ""OPERATIONTYPE"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""ROUTEID"", ""ROUTENAME"", ""TRANSID"", ""SCATTERPACKS"", ""WHOLEPACKS"", ""TOTALPACKS"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"") AS 
  select t.trid,
       t.warehid,
       a.warehname,
       t.credate,
       f.ddlname operationtype,
       --t.tasktype,
       /*t.urgentflag,
       t.goodsownerid,*/
       b.goodsownername,
       t.gcompanyid companyid,
       c.companyname,
       t.routeid,
       d.routename,
       t.transid,
       decode(t.comefrom,
              1,
              zx_get_boxno(t.sourceid),
              nvl(t.scatterpacks, 0)) scatterpacks,
       decode(t.comefrom,
              1,
              zx_get_wholeqty(t.sourceid),
              nvl(t.wholepacks, 0)) wholepacks,
       decode(t.comefrom,
              1,
              zx_get_boxno(t.sourceid) + zx_get_wholeqty(t.sourceid),
              nvl(t.totalpacks, 0)) totalpacks,
       t2.driverid,
       nvl(g.drivername, t2.drivername) as drivername,
       t2.driver2id,
       nvl(h.drivername, t2.driver2name) as driver2name
  from tms_tr_doc_v             t,
       tms_luyan_dispatch_doc t2,
       tpl_warehouse          a,
       tpl_goodsowner         b,
       tpl_go_company         c,
       wms_tr_route           d,
       wms_transport_address  e,
       sys_ddl_dtl            f,
       tms_driver             g,
       tms_driver             h
 where t.warehid = a.warehid(+)
   and t.goodsownerid = b.goodsownerid(+)
   and t.gcompanyid = c.companyid(+)
   and t.routeid = d.routeid(+)
   and t.transid = e.transid(+)
   and f.sysid(+) = 389
   and t.operationtype = f.ddlid(+)
   and t.dispatchid = t2.dispatchid
   and t2.driverid = g.driverid(+)
   and t2.driver2id = h.driverid(+)
   and t.usestatus in (2, 5) --确定和派出状态的运输任务单
   and t.comefrom in (1, 2) --wms转入的运输任务单/手工录入
"
"ZX_710012_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710012_V"" (""CREDATE"", ""INID"", ""INDTLID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""APPROVEDOCNO"", ""GOODSQTY"", ""TRADEGOODSPACK"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""WAREHID"") AS 
  select
      t1.credate,--制单日期,
      t1.inid,--入库订单ID
      t2.indtlid,--入库订单细单ID
      t1.goodsownerid,--货主ID
      t4.goodsownername,--货主名称
			t2.goodsid,--货品主档ID
			t5.goodsownid,--货主原货品ID
      t5.goodsname,--品名
      t5.goodstype,--规格
      t5.factname,--生产厂家
      t5.approvedocno,--批准文号
       t2.goodsqty,--数量
       t2.tradegoodspack,--单位
			 t2.lotid,--批号ID
       t2.lotno,--批号
       to_char(t2.proddate,'yyyy-mm-dd') proddate,--生产日期
       to_char(t2.validdate,'yyyy-mm-dd') validdate  ,--有效期
       t1.warehid
      -- sysdate,--打印时间
      -- t1.bmsdocid,--来源总单ID
       --t1.srccompanyname,--退货单位
       --t1.inceptaddr,--地址
      -- t3.sendpos,--具体地址
      -- t2.goodsstatus,--货品状态
      -- t1.backreason,--退货原因
      -- decode(t1.transclass,1,'常温',2,'冷藏',3,'冷冻') transclass, --运输条件
      -- t1.transmode, --运输方式
      -- t1.memo, --总单备注（取回方式）
     --  decode(t2.goodsclass,10,'冷藏',11,'冷藏',19,'冷藏',12,'冷冻') goodsclass
  from wms_in_order   t1,
 wms_in_order_dtl   t2,
 tpl_goodsowner  t4,
 tpl_goods t5

--wms_transport_address t3
 where t1.inid = t2.inid

 AND t1.goodsownerid=t4.goodsownerid

 AND t2.ownergoodsid=t5.ownergoodsid
--and t1.transid = t3.transid
"
"ZX_710013_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710013_V"" (""RECEIVEID"", ""CHECKDATE"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""LOTNOFACTNAME"", ""APPROVEDOCNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""STORAGECONDITION"", ""PACKQUALITY"", ""FACEQUALITY"", ""GOODSSTATUS"", ""INPUTMAN"", ""INDTLID"", ""GOODSQTY"", ""PACKSIZE"", ""INID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""SOURCECOMPANYID"", ""SRCCOMPANYNAME"", ""DHWD"", ""GCWDFLAG"", ""TRANSNAME"", ""QTY"", ""SHQK"", ""SHR"", ""TRADEGOODSPACK"", ""MEDICINETYPE"", ""SRCDTLNO"", ""SHDATE"", ""WAREHID"") AS 
  SELECT
    a.receiveid,
		a.checkdate,
    a.goodsid,
		a.goodsownid,
    a.goodsname,
		b.goodsengname,
    a.goodstype,
    a.lotnofactname,
    a.approvedocno,
		c.lotid,
    c.lotno,
    c.proddate,
    c.validdate,
    a.storagecondition,
    a.packquality,
    a.facequality,
    a.goodsstatus,
    a.inputman,
    a.indtlid,
		a.goodsqty,--验收数量
		a.packsize,--大包装
    b.inid,
		b.goodsownerid,
	  b.goodsownername,
	  b.sourcecompanyid,
	  b.srccompanyname,
	  b.dhwd,
		b.gcwdflag,
	  b.transname,
	  b.qty,--收货数量
	  b.shqk,
	  b.shr,
		b.tradegoodspack ,--单位
    b.medicinetype , --剂型
		b.srcdtlno, --货主原始单据ID
		b.shdate,
    a.warehid

FROM
     wms_receive_dtl_v   a,
		 zx_shgl_v  b,
     wms_goods_lot c

WHERE
       a.indtlid = b.indtlid
       and a.lotid=c.lotid
"
"ZX_710023_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710023_V"" (""KCRQ"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSTYPE"", ""DRUGFORM"", ""AREAFLAG1"", ""STORAGECONDITION"", ""GOODSPACKID"", ""PACKSIZE"", ""SUPPLYER"", ""TOTALQTY"", ""JS"", ""TOTALPOS"", ""SHAREDPOS"", ""POSRATE"", ""SPEPOS"", ""DHZGYPOS"") AS 
  select
   a.kcrq,
   a.warehid,
   a.goodsownerid,
   a.goodsownername,
   a.goodsid,
   a.goodsownid,
   a.goodsname,
   a.goodstype,
   a.drugform,
   a.areaflag1,
   a.storagecondition,
   a.goodspackid,
   a.packsize,
   bb.supplyer,--加货品对应采购员
   sum(a.goodsqty)  totalqty,

    decode(nvl(a.packsize,0),0,0,ceil(sum(a.goodsqty)/a.packsize))  js,
   count(distinct a.posid)  totalpos,
   nvl(zx_get_sharedpos(a.kcrq,a.warehid,a.goodsownerid,a.goodsid,a.areaflag1,a.storagecondition,a.goodspackid),0)  sharedpos,--放多货主货品的货位数
    decode( nvl(zx_get_sharedpos(a.kcrq,a.warehid,a.goodsownerid,a.goodsid,a.areaflag1,a.storagecondition,a.goodspackid),0) ,0,0,
         zx_get_sharedpos_goodsnumber(a.kcrq,a.warehid,a.goodsownerid,a.goodsid,a.areaflag1,a.storagecondition))   posrate,
--   count(a.posid)-  nvl(zx_get_sharedpos(a.kcrq,a.warehid,a.goodsownerid,a.goodsid,a.areaflag1,a.storagecondition),0) spepos,
     nvl(zx_get_spepos(a.kcrq,a.warehid,a.goodsownerid,a.goodsid,a.areaflag1,a.storagecondition,a.goodspackid),0)  spepos,--单货主放一个货品货位数
     nvl(zx_get_dhzgypos(a.kcrq,a.warehid,a.goodsownerid,a.goodsid,a.areaflag1,a.storagecondition,a.goodspackid),0)    dhzgypos  --单货主放多个货品货位数




from    zx_tl_wms_qty_pos_v  a,
       (select  b.goodsownerid,b.waregoodsid,b.supplyer  from     zx_wms_goods_to_supplyer_v  b  where b.goodsownerid<>1  and b.belong=1
       union all
       select b.goodsownerid,b.waregoodsid,b.supplyer  from     zx_wms_goods_to_supplyer_v b  where b.goodsownerid=1  and b.belong=3 ) bb --判断采购员归属，避免生成两条库存记录

where a.goodsid <>14689   --除掉""立库托盘""这个货品

   and a.goodsownerid =bb.goodsownerid(+)
   and a.goodsid =bb.waregoodsid(+)




group by a.kcrq,
   a.warehid,
   a.goodsownerid,
   a.goodsownername,
   a.goodsid,
   a.goodsownid,
   a.goodsname,
   a.goodstype,
   a.drugform,
   a.areaflag1,
   a.storagecondition,
   a.goodspackid,
   a.packsize,
   bb.supplyer
"
"ZX_710024_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710024_V"" (""KCRQ"", ""AREAID"", ""AREANAME"", ""SECTIONID"", ""SECTIONNAME"", ""POSID"", ""POSNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""TOTALVOLUME"") AS 
  select
   a.kcrq,
   a.areaid,
   a.areaname,
   a.sectionid,
   a.sectionname,
   a.posid,
   a.posname,
   a.goodsownerid,
   a.goodsownername,
   a.goodsid,
   a.goodsname,
   a.goodstype,
   sum(a.volume)  totalvolume
from
    zx_tl_wms_qty_pos_v   a




  where  a.posflag=0

  group by
    a.kcrq,
   a.areaid,
   a.areaname,
   a.sectionid,
   a.sectionname,
   a.posid,
   a.posname,
   a.goodsownerid,
   a.goodsownername,
   a.goodsid,
   a.goodsname,
   a.goodstype
"
"ZX_710025_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710025_V"" (""KCRQ"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""DRUGFORM"", ""FACTNAME"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""PACKSIZE"", ""AREAFLAG1"", ""POSFLAG"", ""GOODSSTATUS"", ""GOODSSTATUSID"", ""STORAGECONDITION"", ""GOODSOWNID"", ""GOODSQTY"", ""JS"", ""POSQTY"") AS 
  select
   a.kcrq,
   a.warehid,
   a.goodsownerid,
   a.goodsownername,
   a.goodsid,
   a.goodsname,
   a.goodstype,
   a.drugform,
   a.factname,
   a.lotid,
   a.lotno,
   a.proddate,
   a.validdate,
   a.packsize,
   --a.areaflag,
   a.areaflag1,
   a.posflag,
   a.goodsstatus,
   a.goodsstatusid,
   a.storagecondition,
   a.goodsownid,
   sum(a.goodsqty)  goodsqty,
   sum(a.js)   js,
   count( distinct a.posid)  posqty


from zx_tl_wms_qty_pos_v  a




where a.goodsid <>14689    --除掉""立库托盘""这个货品

group by
      a.kcrq,
   a.warehid,
   a.goodsownerid,
   a.goodsownername,
   a.goodsid,
   a.goodsname,
   a.goodstype,
   a.drugform,
   a.factname,
   a.lotid,
   a.lotno,
   a.proddate,
   a.validdate,
   a.packsize,
   a.areaflag1,
   a.posflag,
   a.goodsstatus,
   a.goodsstatusid,
   a.storagecondition,
   a.goodsownid
"
"ZX_710026_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710026_V"" (""DISPATCHID"", ""CREDATE"", ""USESTATUS"", ""DISPATCHDATE"", ""DISPATCHMAN"", ""COMPANYNAME"", ""DRIVERNAME"", ""TRANTYPE"", ""VEHICLENO"", ""TOTALPACKS"", ""TOTALCUBAGE"", ""ROUTEID"", ""ROUTENAME"", ""VEHICLEID"", ""DRIVERID"", ""TRCOMPANYID"", ""DISPATCHMANID"", ""WAREHNAME"", ""UPDOWNMAN"", ""WAREHID"", ""GOODSOWNERNAME"", ""DTLCOMPANYNAME"", ""INCEPTADDR"", ""TRANSID"", ""DTLUSESTATUS"", ""DISPATCHDTLID"", ""GOODSOWNERID"", ""GCOMPANYID"", ""TRID"", ""SOURCEID"", ""CHAINFLAG"", ""SPECIALCARFLAG"", ""TRANSRANGE"", ""DISTANCE"", ""LOAD"", ""VOLUMN"", ""MEMO"", ""ERPINPUTMAN"", ""ZYFLAG"", ""QXFLAG"", ""XGFLAG"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""TRCREDATE"", ""CDYY"", ""OUTMEMO"", ""DRIVER2ID"", ""DRIVERNAME2"", ""AMT"", ""DEPTNAME"") AS 
  select a.dispatchid,
       a.credate,
       a.usestatus,
       a.dispatchdate,
       a.dispatchman,
       a.companyname,
       a.drivername,
       get_710026_trantype(car.memo,b.chainflag,a.specialcarflag,d.goodsownerid) as trantype, --fix by linjie 20171218
       a.vehicleno,
       nvl(d.totalpacks,0) totalpacks,
       nvl(b.cubage,0) totalcubage,
       routepos.routeid, --fix 改变取值视图，直接用地址取线路ID
       routepos.routename,
       a.vehicleid,
       a.driverid,
       a.trcompanyid,
       a.dispatchmanid,
       a.warehname,
       a.updownman,
       a.warehid,
       d.goodsownername,
       d.companyname dtlcompanyname,
       d.inceptaddr,
       d.transid,
       b.usestatus dtlusestatus,
       b.dispatchdtlid,
       d.goodsownerid,
       d.gcompanyid,
       d.trid,
       d.sourceid,
       nvl(b.chainflag,0) chainflag,
       case when d.goodsownerid in (178,8102,8103,8104,8105,8106,8107,8109,8110,8111,8112,8113,8114) then 1 else a.specialcarflag end as specialcarflag ,
       -- fix by linjie 2017-12-19
       nvl(get_710026_rangedq(a.vehicleid,routepos.routeid),3)   transrange,
       --fix 2017-12-26 routeid取值，由b.routeid 改成routepos.routeid
       -- 20201224 改成从定义表里取
        routepos.distance,
        car.load,
        car.volumn,
        car.memo,
        /*decode(d.goodsownerid,3,
           (select
            zh_concat( distinct t3.employeename)
         from   wms_out_order  t1,
                lyerp.bms_sa_doc  t2,
                lyerp.pub_employee t3
          where d.sourceid = t1.wavedtlid(+)
            and t1.zxcolumn4 = to_char(t2.salesid)
            and t2.inputmanid = t3.employeeid),null)  erpinputman, --by tl 20180130  取ERP销售发货单总单制单人*/
        decode(d.goodsownerid,3,
                (select
                  zh_concat( distinct t1.salername)
                  from   wms_out_order  t1
                  where d.sourceid = t1.wavedtlid(+) )) erpinputman,   --by tl@210908取出库单上业务员

        (select  t1.zyflag  from tms_tr_doc_v  t1  where b.trid = t1.trid)  zyflag,
        (select  t1.qxflag  from tms_tr_doc_v  t1  where b.trid = t1.trid)  qxflag, --tl@200319中药,器械标志
        (select  t1.xgflag  from tms_tr_doc_v  t1  where b.trid = t1.trid)  xgflag, --tl@210224 710026

        td.province,   --210301
        td.city,
        td.district,
        d.CREDATE  trcredate,--8401填写日期
        b.memo  cdyy ,--撤单原因
        d.memo outmemo ,--出库备注
        a.driver2id,
        a.drivername2,
        zx_tl_710026_amt(a.warehid,d.sourceid)  amt, --取出库订单细单金额
        (select
            distinct t2.deptname
           from wms_out_order t2
           where d.sourceid = t2.wavedtlid(+)) deptname --取出库单上业务部门tl@221026


       from Tms_dispatch_doc_v a,
            Tms_dispatch_dtl b,
           tms_driver  c ,
           tms_tr_doc_v d,
           wms_transport_address  td,  --210301
            (select cara.vehicleid,
       carb.vehicletypeid,
       carb.load,
       carb.volumn,
       carb.memo
        from Tms_vehicle_v cara,Tms_vehicle_type_v carb
       where
       cara.vehicletypeid=carb.VEHICLETYPEID
       and
       cara.warehid = 2) car,
       (select doc.routeid,
       doc.routename,
       dtl.transid,
       dtl.inceptaddr,
       dtl.distance
      from TMS_ROUTE_POS_V dtl, WMS_TR_ROUTE_v doc
      where doc.routeid = dtl.ROUTEID and doc.warehid=2
      ) routepos
       where a.DISPATCHID=b.DISPATCHID(+)
          and a.driverid = c.driverid(+)
          and d.transid = routepos.transid(+)  --210301
          and d.transid = td.transid(+)
          and a.vehicleid=car.vehicleid(+)
         /* and a.dispatchdate between to_date('20201201','yyyymmdd')  and to_date('20210101','yyyymmdd')
          and a.warehid=14*/
          and b.trid = d.trid(+)
          and b.usestatus<>1   /*派车细单作废状态*/
"
"ZX_710027_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710027_V"" (""KCRQ"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""TOTALPOSQTY"", ""ZYYP"", ""COOL0"", ""COOL1"", ""COOL3"", ""COOL2"", ""COLD0"", ""COLD1"", ""COLD3"", ""COLD2"", ""UNQUALIFIED"") AS 
  select
    t1.kcrq,
    t1.warehid,
    t1.goodsownerid,
    t1.goodsownername,
    sum(t1.totalposqty) totalposqty,
    sum(t1.zyyp)   zyyp,
    sum(t1.cool0)  cool0,
    sum(t1.cool1)  cool1,
    sum(t1.cool3)  cool3,
    sum(t1.cool2)  cool2,
    sum(t1.cold0)  cold0,
    sum(t1.cold1)  cold1,
    sum(t1.cold3)  cold3,
    sum(t1.cold2)  cold2,
    sum(t1.unqualified)  unqualified

from
(select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     count (distinct a.posid)  totalposqty,  --总货位数
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_tl_wms_qty_pos_v  a


where a.goodsid <>14689 --除掉""立库托盘""这个货品

group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all
select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     count( distinct  a.posid)  zyyp,--中药饮片货位
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_tl_wms_qty_pos_v  a
where a.drugform  in ('中药饮片','胶剂') and a.goodsstatusid<>3  and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername
union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     count( distinct  a.posid)  cool0,  --阴凉库立库托盘
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_tl_wms_qty_pos_v  a
where nvl(a.storagecondition,100) not in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=0  and a.goodsstatusid<>3
 and  a.goodsid <>14689 --除掉""立库托盘""这个货品

group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername
union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,  --阴凉库立库托盘
     count( distinct a.posid)   cool1,--阴凉库整件托盘
     0  cool3,
     0  cool2,
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_tl_wms_qty_pos_v  a
where  nvl(a.storagecondition,100) not in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=1 and a.goodsstatusid<>3

and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,  --阴凉库立库托盘
     0  cool1,　　--阴凉库整件托盘
     count(distinct a.posid)  cool3,--阴凉库整件货架
     0  cool2,
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_tl_wms_qty_pos_v  a
where nvl(a.storagecondition,100) not in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=3  and a.goodsstatusid<>3
and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername
union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,  --阴凉库立库托盘
     0  cool1,
     0  cool3,--阴凉库整件货架
     count(distinct a.posid)    cool2,--阴凉库散件
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_tl_wms_qty_pos_v  a
where nvl(a.storagecondition,100) not in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=2  and a.goodsstatusid<>3
and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     count(distinct a.posid)  cold0, --冷库立库托盘
     0  cold1,--冷库整件托盘
     0  cold3,--冷库整件货架
     0  cold2,　--冷库散件
     0  unqualified  --不合格货位数
from zx_tl_wms_qty_pos_v  a
where a.storagecondition  in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=0  and a.goodsstatusid<>3
and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0, --冷库立库托盘
    count(distinct a.posid)  cold1,--冷库整件托盘
     0  cold3,--冷库整件货架
     0  cold2,　--冷库散件
     0  unqualified  --不合格货位数
from zx_tl_wms_qty_pos_v  a
where a.storagecondition  in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=1  and a.goodsstatusid<>3
and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0, --冷库立库托盘
     0 cold1,--冷库整件托盘
     count(distinct a.posid)  cold3,--冷库整件货架
     0  cold2　,--冷库散件
      0  unqualified  --不合格货位数
from zx_tl_wms_qty_pos_v  a
where a.storagecondition  in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=3  and a.goodsstatusid<>3
and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0, --冷库立库托盘
     0  cold1,--冷库整件托盘
     0  cold3,--冷库整件货架
     count(distinct a.posid)  cold2,　--冷库散件
     0  unqualified  --不合格货位数
from zx_tl_wms_qty_pos_v  a
where a.storagecondition  in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=2  and a.goodsstatusid<>3
and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0, --冷库立库托盘
     0  cold1,--冷库整件托盘
     0  cold3,--冷库整件货架
     0  cold2,　--冷库散件
      count(distinct a.posid)  unqualified --不合格货位
from zx_tl_wms_qty_pos_v  a
where  a.goodsstatusid=3 and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername          )  t1


 group by  t1.kcrq,
    t1.warehid,
    t1.goodsownerid,
    t1.goodsownername
"
"ZX_710028_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710028_V"" (""WAREHID"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""RECCOMPANYID"", ""COMPANYNAME"", ""SRCEXPNO"", ""REALDISPATCHDATE"", ""DRIVERID"", ""DRIVERNAME"", ""VEHICLEID"", ""VEHICLENO"", ""OPERATIONTYPE"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSQTY"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""PRICE"", ""AMT"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""OUTID"", ""OUTDTLID"", ""SERVICERATE"", ""SERVICEUNITPRICE"", ""SERVICEPACKPRICE"", ""SERVICEUNITPRICE1"", ""SERVICEAMT"", ""DTLMEMO"", ""INCEPTADDR"", ""USESTATUS"") AS 
  select
      a.warehid,
      a.credate,
      a.goodsownerid,
      e.goodsownername,
      a.reccompanyid,
      f.companyname,
      a.srcexpno,
      d.realdispatchdate,
      d.driverid,
      g.drivername,
      d.vehicleid,
      k.vehicleno,
      a.operationtype,
      b.goodsid,
      h.goodsname,
      h.goodstype,
      b.goodsqty,
      b.goodspackid,
      i.packname,
      i.packsize,
      b.price,
      b.amt,
      b.lotid,
      j.lotno,
      j.validdate,
      a.outid,
      b.outdtlid,
      zx_get_servicerate(a.credate,h.ownergoodsid)   servicerate,
      zx_get_serviceunitprice(a.credate,h.ownergoodsid)  serviceunitprice,
      zx_get_servicepackprice(a.credate,h.ownergoodsid)  servicepackprice,
      zx_get_serviceunitprice1(a.credate,h.ownergoodsid)  serviceunitprice1,--数量*单价300-1000@230525
      case when ( zx_get_serviceunitprice(a.credate,h.ownergoodsid) is null and zx_get_servicerate(a.credate,h.ownergoodsid) is null
            and  zx_get_servicepackprice(a.credate,h.ownergoodsid) is null and zx_get_serviceunitprice1(a.credate,h.ownergoodsid) is null )
         or ( zx_get_serviceunitprice(a.credate,h.ownergoodsid) is not  null and  zx_get_servicerate(a.credate,h.ownergoodsid) is not null
            and  zx_get_servicepackprice(a.credate,h.ownergoodsid) is not null and zx_get_serviceunitprice1(a.credate,h.ownergoodsid) is not null)
         or (a.operationtype=18)
          then 0
        when zx_get_servicerate(a.credate,h.ownergoodsid) is not  null
          then round(b.amt*zx_get_servicerate(a.credate,h.ownergoodsid),2)
        when  zx_get_serviceunitprice(a.credate,h.ownergoodsid) is not null
          then round(b.goodsqty*zx_get_serviceunitprice(a.credate,h.ownergoodsid),2)
        when   zx_get_serviceunitprice1(a.credate,h.ownergoodsid) is not null
          then
                case when round(b.goodsqty*zx_get_serviceunitprice1(a.credate,h.ownergoodsid),2)<=300
                       then 300
                     when round(b.goodsqty*zx_get_serviceunitprice1(a.credate,h.ownergoodsid),2)>=1000
                       then 1000
                     else   round(b.goodsqty*zx_get_serviceunitprice1(a.credate,h.ownergoodsid),2)
                 end

          else round(ceil(b.goodsqty/i.packsize)*zx_get_servicepackprice(a.credate,h.ownergoodsid),2)
            end    serviceamt,
      b.dtlmemo,
      l.inceptaddr,
      2 usestatus




from   wms_out_order  a,
       wms_out_order_dtl  b,
       tms_tr_doc_v  c,
       tms_dispatch_doc d,
       tpl_goodsowner  e,
       tpl_go_company f,
       tms_driver g,
       tpl_goods h,
       tpl_pub_goods_packs  i,
       wms_goods_lot  j,
       tms_vehicle k,
       wms_transport_address l
where a.outid = b.outid
and a.wavedtlid = c.sourceid(+)
and c.dispatchid = d.dispatchid(+)

and a.goodsownerid = e.goodsownerid(+)
and a.reccompanyid = f.companyid(+)
and d.driverid = g.driverid(+)
and b.ownergoodsid = h.ownergoodsid(+)
and b.goodspackid = i.goodspackid(+)
and b.lotid = j.lotid(+)
and d.vehicleid = k.vehicleid(+)
and a.usestatus<>0 --过滤掉取消的订单
and a.warehid = c.warehid(+)
and a.goodsownerid= c.goodsownerid(+)
and ( c.comefrom =1 or c.comefrom is null)     --来原由WMS转入,区别手工任务单再加上自提部分的出库单
and a.transid = l.transid(+)

-- and a.credate between to_date('20241001','yyyymmdd')  and to_date('20241013','yyyymmdd') and a.goodsownerid=8115


union all

select
      a.warehid,
      a.credate,
      a.goodsownerid,
      e.goodsownername,
      a.sourcecompanyid,
      f.companyname,
      null  srcexpno,
      null  realdispatchdate,
      null driverid,
      null drivername,
      null  vehicleid,
      null vehicleno,
      a.operationtype,
      b.goodsid,
      h.goodsname,
      h.goodstype,
      -b.goodsqty  goodsqty,
      b.goodspackid,
      i.packname,
      i.packsize,
      b.price,
      b.amt,
      b.lotid,
      j.lotno,
      j.validdate,
      null  outid,
      null outdtlid,
      zx_get_servicerate(a.credate,h.ownergoodsid)   servicerate,
      zx_get_serviceunitprice(a.credate,h.ownergoodsid)  serviceunitprice,
      zx_get_servicepackprice(a.credate,h.ownergoodsid)  servicepackprice,
       zx_get_serviceunitprice1(a.credate,h.ownergoodsid)  serviceunitprice1,--数量*单价300-1000@230525
     case when ( zx_get_serviceunitprice(a.credate,h.ownergoodsid) is null and zx_get_servicerate(a.credate,h.ownergoodsid) is null
            and  zx_get_servicepackprice(a.credate,h.ownergoodsid) is null and zx_get_serviceunitprice1(a.credate,h.ownergoodsid) is null)
         or ( zx_get_serviceunitprice(a.credate,h.ownergoodsid) is not  null and  zx_get_servicerate(a.credate,h.ownergoodsid) is not null
            and  zx_get_servicepackprice(a.credate,h.ownergoodsid) is not null and zx_get_serviceunitprice1(a.credate,h.ownergoodsid) is not null )
          then 0
        when zx_get_servicerate(a.credate,h.ownergoodsid) is not  null
          then round(-b.amt*zx_get_servicerate(a.credate,h.ownergoodsid),2)
        when  zx_get_serviceunitprice(a.credate,h.ownergoodsid) is not null
          then round(-b.goodsqty*zx_get_serviceunitprice(a.credate,h.ownergoodsid),2)
        when   zx_get_serviceunitprice1(a.credate,h.ownergoodsid) is not null
          then
                case when round(b.goodsqty*zx_get_serviceunitprice1(a.credate,h.ownergoodsid),2)<=300
                       then -300
                     when round(b.goodsqty*zx_get_serviceunitprice1(a.credate,h.ownergoodsid),2)>=1000
                       then -1000
                     else   round(-b.goodsqty*zx_get_serviceunitprice1(a.credate,h.ownergoodsid),2)
                 end

          else round(ceil(-b.goodsqty/i.packsize)*zx_get_servicepackprice(a.credate,h.ownergoodsid),2)
            end    serviceamt,
        null dtlmemo,
        null inceptaddr,
        2 usestatus



from   wms_in_order  a,
       wms_in_order_dtl  b,
     --  tms_tr_doc_v  c,
     --  tms_dispatch_doc d,
       tpl_goodsowner  e,
       tpl_go_company f,
      -- tms_driver g,
       tpl_goods h,
       tpl_pub_goods_packs  i,
       wms_goods_lot  j
      -- tms_vehicle k
where a.inid = b.inid
--and a.wavedtlid = c.sourceid(+)
--and c.dispatchid = d.dispatchid(+)

and a.goodsownerid = e.goodsownerid(+)
and a.sourcecompanyid = f.companyid(+)
--and d.driverid = g.driverid(+)
and b.ownergoodsid = h.ownergoodsid(+)
and b.goodspackid = i.goodspackid(+)
and b.lotid = j.lotid(+)
--and d.vehicleid = k.vehicleid(+)
and a.usestatus  not in (0,4)

-- and a.credate between to_date('20241001','yyyymmdd')  and to_date('20241013','yyyymmdd') and a.goodsownerid=8115

and a.operationtype=42

--临时状态货主出库订单
union all

select
      a.warehid,
      a.credate,
      a.goodsownerid,
      e.goodsownername,
      a.reccompanyid,
      f.companyname,
      a.srcexpno,
      null  realdispatchdate,
      null driverid,
      null drivername,
      null  vehicleid,
      null vehicleno,
      a.operationtype,
      b.goodsid,
      h.goodsname,
      h.goodstype,
      b.goodsqty  goodsqty,
      b.goodspackid,
      i.packname,
      i.packsize,
      b.price,
      b.amt,
      b.lotid,
      j.lotno,
      j.validdate,
      a.exporderid  outid,
      b.exporderdtlid outdtlid,
      zx_get_servicerate(a.credate,h.ownergoodsid)   servicerate,
      zx_get_serviceunitprice(a.credate,h.ownergoodsid)  serviceunitprice,
      zx_get_servicepackprice(a.credate,h.ownergoodsid)  servicepackprice,
       zx_get_serviceunitprice1(a.credate,h.ownergoodsid)  serviceunitprice1,--数量*单价300-1000@230525
     case when ( zx_get_serviceunitprice(a.credate,h.ownergoodsid) is null and zx_get_servicerate(a.credate,h.ownergoodsid) is null
            and  zx_get_servicepackprice(a.credate,h.ownergoodsid) is null and zx_get_serviceunitprice1(a.credate,h.ownergoodsid) is null )
         or ( zx_get_serviceunitprice(a.credate,h.ownergoodsid) is not  null and  zx_get_servicerate(a.credate,h.ownergoodsid) is not null
            and  zx_get_servicepackprice(a.credate,h.ownergoodsid) is not null and zx_get_serviceunitprice1(a.credate,h.ownergoodsid) is not null)
         or (a.operationtype=18)
          then 0
        when zx_get_servicerate(a.credate,h.ownergoodsid) is not  null
          then round(b.amt*zx_get_servicerate(a.credate,h.ownergoodsid),2)
        when  zx_get_serviceunitprice(a.credate,h.ownergoodsid) is not null
          then round(b.goodsqty*zx_get_serviceunitprice(a.credate,h.ownergoodsid),2)
        when   zx_get_serviceunitprice1(a.credate,h.ownergoodsid) is not null
          then
                case when round(b.goodsqty*zx_get_serviceunitprice1(a.credate,h.ownergoodsid),2)<=300
                       then 300
                     when round(b.goodsqty*zx_get_serviceunitprice1(a.credate,h.ownergoodsid),2)>=1000
                       then 1000
                     else   round(b.goodsqty*zx_get_serviceunitprice1(a.credate,h.ownergoodsid),2)
                 end

          else round(ceil(b.goodsqty/i.packsize)*zx_get_servicepackprice(a.credate,h.ownergoodsid),2)
            end    serviceamt,
        b.dtlmemo,
        l.inceptaddr,
        a.usestatus


from   tpl_export_order  a,
       tpl_export_order_dtl  b,
     --  tms_tr_doc_v  c,
     --  tms_dispatch_doc d,
       tpl_goodsowner  e,
       tpl_go_company f,
      -- tms_driver g,
       tpl_goods h,
       tpl_pub_goods_packs  i,
       wms_goods_lot  j,
       wms_transport_address l
      -- tms_vehicle k
where a.exporderid = b.exporderid
--and a.wavedtlid = c.sourceid(+)
--and c.dispatchid = d.dispatchid(+)

and a.goodsownerid = e.goodsownerid(+)
and a.reccompanyid = f.companyid(+)
--and d.driverid = g.driverid(+)
and b.ownergoodsid = h.ownergoodsid(+)
and b.goodspackid = i.goodspackid(+)
and b.lotid = j.lotid(+)
--and d.vehicleid = k.vehicleid(+)
and a.usestatus  =1 --临时
and a.transid = l.transid(+)
 --and a.credate between to_date('20241001','yyyymmdd')  and to_date('20241015','yyyymmdd') and a.goodsownerid=8102
"
"ZX_710029_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710029_V"" (""KCRQ"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""TOTALPOSQTY"", ""ZYYP"", ""COOL0"", ""COOL1"", ""COOL3"", ""COOL2"", ""COLD0"", ""COLD1"", ""COLD3"", ""COLD2"", ""UNQUALIFIED"") AS 
  select
    t1.kcrq,
    t1.warehid,
    t1.goodsownerid,
    t1.goodsownername,
    sum(t1.totalposqty) totalposqty,
    sum(t1.zyyp)   zyyp, --中药饮片
    sum(t1.cool0)  cool0, --阴凉立库托盘
    sum(t1.cool1)  cool1, --阴凉整件托盘
    sum(t1.cool3)  cool3, --阴凉整件货架
    sum(t1.cool2)  cool2, --阴凉散件
    sum(t1.cold0)  cold0, --冷库立库托盘
    sum(t1.cold1)  cold1, --冷库整件托盘
    sum(t1.cold3)  cold3, --冷库整件货架
    sum(t1.cold2)  cold2, --冷库散件
    sum(t1.unqualified)  unqualified

from
(select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
    -- count (distinct a.posid)  totalposqty,  --总货位数
     sum(a.posrate)  totalposqty,
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_710023_v  a

group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all
select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
   --  count( distinct  a.posid)  zyyp,--中药饮片货位
     sum(a.posrate)  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_710023_v  a
where a.drugform  in ('中药饮片','胶剂')
-- and a.goodsstatusid<>3
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername
union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     --count( distinct  a.posid)  cool0,  --阴凉库立库托盘
     sum(a.posrate)  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_710023_v  a
where nvl(a.storagecondition,100) not in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=0
-- and a.goodsstatusid<>3
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername
union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,  --阴凉库立库托盘
   --  count( distinct a.posid)   cool1,--阴凉库整件托盘
     sum(a.posrate)  cool1,
     0  cool3,
     0  cool2,
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_710023_v  a
where  nvl(a.storagecondition,100) not in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=1
-- and a.goodsstatusid<>3
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,  --阴凉库立库托盘
     0  cool1,　　--阴凉库整件托盘
    -- count(distinct a.posid)  cool3,--阴凉库整件货架
     sum(a.posrate)  cool3,
     0  cool2,
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_710023_v  a
where nvl(a.storagecondition,100) not in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=3
--and a.goodsstatusid<>3
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername
union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,  --阴凉库立库托盘
     0  cool1,
     0  cool3,--阴凉库整件货架
   --  count(distinct a.posid)    cool2,--阴凉库散件
     sum(a.posrate)  cool2,
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_710023_v  a
where nvl(a.storagecondition,100) not in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=2
-- and a.goodsstatusid<>3
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
   --  count(distinct a.posid)  cold0, --冷库立库托盘
     sum(a.posrate)  cold0,
     0  cold1,--冷库整件托盘
     0  cold3,--冷库整件货架
     0  cold2,　--冷库散件
     0  unqualified  --不合格货位数
from zx_710023_v  a
where a.storagecondition  in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=0
--and a.goodsstatusid<>3
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0, --冷库立库托盘
    --count(distinct a.posid)  cold1,--冷库整件托盘
     sum(a.posrate)  cold1,
     0  cold3,--冷库整件货架
     0  cold2,　--冷库散件
     0  unqualified  --不合格货位数
from zx_710023_v  a
where a.storagecondition  in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=1
-- and a.goodsstatusid<>3
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0, --冷库立库托盘
     0 cold1,--冷库整件托盘
   --  count(distinct a.posid)  cold3,--冷库整件货架
     sum(a.posrate)  cold3,
     0  cold2　,--冷库散件
      0  unqualified  --不合格货位数
from zx_710023_v  a
where a.storagecondition  in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=3
-- and a.goodsstatusid<>3
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0, --冷库立库托盘
     0  cold1,--冷库整件托盘
     0  cold3,--冷库整件货架
    -- count(distinct a.posid)  cold2,　--冷库散件
     sum(a.posrate)  cold2,
     0  unqualified  --不合格货位数
from zx_710023_v  a
where a.storagecondition  in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=2
-- and a.goodsstatusid<>3
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

/*union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0, --冷库立库托盘
     0  cold1,--冷库整件托盘
     0  cold3,--冷库整件货架
     0  cold2,　--冷库散件
    --  count(distinct a.posid)  unqualified --不合格货位
      sum(a.posrate)  unqualified
from zx_710023_v  a
where  a.goodsstatusid=3
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername   */       )  t1



 group by  t1.kcrq,
    t1.warehid,
    t1.goodsownerid,
    t1.goodsownername
"
"ZX_710030_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710030_V"" (""VEHICLEID"", ""VEHICLENO"", ""VEHICLETYPEID"", ""LOAD"", ""VOLUMN"", ""MEMO"", ""TRANDATE"", ""TRANTYPE"", ""TRANCARS"", ""TRANDOWNTOWNCAR"", ""TRANEIGHTCOUNTIESCAR"", ""TRANPROVINCECAR"", ""TRANDISTANCES"", ""TRANDOWNTOWNDISTANCE"", ""TRANEIGHTCOUNTIESDISTANCE"", ""TRANPROVINCEDISTANCE"", ""TRANVOLUMNS"", ""TRANDOWNTOWNVOLUMN"", ""TRANEIGHTCOUNTIESVOLUMNS"", ""TRANPROVINCEVOLUMNS"", ""TRANPACKS"", ""TRANDOWNTOWNPACK"", ""TRANEIGHTCOUNTIESPACK"", ""TRANPROVINCEPACK"", ""DTLIDLIST"", ""TRANSRANGE"", ""SPECIALCARFLAG"", ""MEMORANGE"", ""CHAINFLAG"", ""ZXID"") AS 
  select car.""VEHICLEID"",car.""VEHICLENO"",car.""VEHICLETYPEID"",car.""LOAD"",car.""VOLUMN"",car.""MEMO"",t.trandate,
t.trantype,
t.trancars,
t.trandowntowncar,
t.traneightcountiescar,
t.tranprovincecar,
t.trandistances,
t.trandowntowndistance,
t.traneightcountiesdistance,
t.tranprovincedistance,
t.tranvolumns,
t.trandowntownvolumn,
t.traneightcountiesvolumns,
t.tranprovincevolumns,
t.tranpacks,
t.trandowntownpack,
t.traneightcountiespack,
t.tranprovincepack,
t.memo as dtlidlist,
t.transrange,
t.specialcarflag,
t.memorange ,
t.chainflag,
t.zxid from zx_710030 t,(select cara.vehicleid,
       cara.vehicleno,
       carb.vehicletypeid,
       carb.load,
       carb.volumn,
       carb.memo
        from Tms_vehicle_v cara,Tms_vehicle_type_v carb
       where
       cara.vehicletypeid=carb.VEHICLETYPEID
       and
       cara.warehid = 2) car
       where t.vehicleid=car.vehicleid
"
"ZX_710031_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710031_V"" (""TRANDATE"", ""TRANTYPE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""TRANCARS"", ""TRANDOWNTOWNCAR"", ""TRANEIGHTCOUNTIESCAR"", ""TRANPROVINCECAR"", ""TRANDISTANCES"", ""TRANDOWNTOWNDISTANCE"", ""TRANEIGHTCOUNTIESDISTANCE"", ""TRANPROVINCEDISTANCE"", ""TRANVOLUMNS"", ""TRANDOWNTOWNVOLUMN"", ""TRANEIGHTCOUNTIESVOLUMNS"", ""TRANPROVINCEVOLUMNS"", ""TRANPACKS"", ""TRANDOWNTOWNPACK"", ""TRANEIGHTCOUNTIESPACK"", ""TRANPROVINCEPACK"", ""DTLIDLIST"", ""TRANSRANGE"", ""SPECIALCARFLAG"", ""MEMORANGE"", ""CHAINFLAG"", ""CARIDS"", ""ZXID"") AS 
  select
t.trandate,
t.trantype,
goodsowner.goodsownerid,
goodsowner.goodsownername,
t.trancars,
t.trandowntowncar,
t.traneightcountiescar,
t.tranprovincecar,
t.trandistances,
t.trandowntowndistance,
t.traneightcountiesdistance,
t.tranprovincedistance,
t.tranvolumns,
t.trandowntownvolumn,
t.traneightcountiesvolumns,
t.tranprovincevolumns,
t.tranpacks,
t.trandowntownpack,
t.traneightcountiespack,
t.tranprovincepack,
t.memo as dtlidlist,
t.transrange,
t.specialcarflag,
t.memorange ,
t.chainflag,
t.carids,
t.zxid from zx_710031 t,(select goodsownerid,goodsownername from Tpl_goodsowner_v) goodsowner
       where t.goodsownerid=goodsowner.goodsownerid
"
"ZX_710033_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710033_V"" (""CREDATE"", ""PICKAREAID"", ""PICKAREANAME"", ""TASKID"", ""TASKTYPE"", ""RFFLAG"", ""USESTATUS"", ""GOODSID"", ""OPERATIONTYPE"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSQTY"", ""TRADEPACKNAME"", ""LOTNO"", ""PACKNAME"", ""PACKSIZE"", ""CUSTOMID"", ""CUSTOMNAME"", ""GCOMPANYID"", ""PRODAREA"", ""FACTNAME"", ""DRUGFORM"", ""DRUGFORMNO"", ""PICKFLOWID"", ""PICKFLOWNAME"", ""GROUPID"", ""GROUPNAME"", ""RFMANID"", ""RFMAN"", ""INOUTID"", ""WAREHID"", ""POSID"", ""WHOLEQTY"", ""SCATTERQTY"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""JS"", ""ERPINPUTMAN"", ""AREAFLAG"") AS 
  select
--一个为拣货工作区下架任务明细，内容为任务状态、任务下达时间、拣货工作区、货品ID、货主原货品ID、
--名称、规格、单位、数量、批号、包装单位、包装大小、客户ID、货主原客户ID、客户名称。
--查询条件为：状态、客户ID（HOV）、拣货工作区ID（Hov）、货品ID（Hov）、任务下达时间（必填，缺省为当天）、
--业务类型（波次补货下架、闲时补货下架、报警补货下架、出库下架）
 b.credate,
 f.pickareaid,
 g.pickareaname,
 a.taskid,
 '出库下架' tasktype,
 b.rfflag,
 b.usestatus,
 b.goodsid,
 b.operationtype,
 j.goodsownid,
 j.goodsname,
 j.goodstype,
 b.goodsqty,
 j.tradepackname,
 i.lotno,
 h.packname,
 h.packsize,
 d.customid,
 --d.customname, 2011-1-24 by ydhu
 k.companyname customname, --2011-1-24 by ydhu
 --d.gcompanyid  2011-1-24 by ydhu
 k.gcompanyid, --2011-1-24 by ydhu
 j.prodarea,
 j.factname,
 j.drugform, --l.drugform 改为 j.drugform zyc by 20160901
 l.drugformno,
 m.pickflowid,
 m.pickflowname,
 n.groupid,
 n.groupname,
 b.rfmanid,
 o.employeename rfman,
 b.inoutid,
 b.warehid,
 b.posid,
 b.wholeqty,
 b.scatterqty,
 j.goodsownerid, -- xyue 2014-06-06 拣货工作区下架任务明细增加货主字段
 j.goodsownername,
 decode(nvl(h.packsize,0),0,0,ceil(b.goodsqty/h.packsize)) js , --件数 向上取整 add by 20160705 zyc
 decode(j.goodsownerid,3,
           (select
            zh_concat( distinct t3.employeename)
         from   wms_out_order  t1,
                lyerp.bms_sa_doc  t2,
                lyerp.pub_employee t3
          where d.wavedtlid = t1.wavedtlid(+)
            and t1.zxcolumn4 = to_char(t2.salesid)
            and t2.inputmanid = t3.employeeid),null)  erpinputman,
 q.areaflag --带出存放类型 by tl@20180413
   from wms_task_doc         a,
       wms_st_io_doc        b,
       wms_wave_goods_dtl   c,
       wms_wave_dtl         d,
       wms_wave_doc         e,
       wms_pickarea_pos_def f,
       wms_pickarea         g,
       tpl_pub_goods_packs  h,
       wms_goods_lot        i,
       tpl_goods_v            j,
       tpl_go_company       k, --2011-1-24 by ydhu
       tpl_drugform         l,
       wms_pickflow         m,
       wms_group_def        n,
       pub_employee         o,
       wms_st_section_def   p,
       wms_st_area_def      q
 where a.taskid = b.taskid
   and a.tasktype = 1 --拣货任务（波次生成）
   and b.comefrom = 3 --波次出库
   and b.sourceid = c.wavegoodsdtlid
   and c.wavedtlid = d.wavedtlid
   and d.waveid = e.wavedocid
   and b.posid = f.posid
   and f.pickareaid = g.pickareaid
   and b.goodspackid = h.goodspackid
   and b.lotid = i.lotid
   and b.ownergoodsid = j.ownergoodsid
   and d.customid = k.companyid(+) --2011-1-24 by ydhu
   and j.drugform = l.drugformno(+)
   and g.pickflowid = m.pickflowid
   and g.groupid = n.groupid
   and b.rfmanid = o.employeeid(+) --应该用外关联，不然查不出未执行的任务
   and b.sectionid = p.sectionid(+)
   and p.areaid = q.areaid(+)
union all
select b.credate,
       f.pickareaid,
       g.pickareaname,
       a.taskid,
       decode(e.subtype,
              1,
              '波次补货下架',
              5,
              '波次预补货下架',
              4,
              '手工补货下架',
              3,
              '闲时补货下架',
              '报警补货下架') tasktype,
       b.rfflag,
       b.usestatus,
       b.goodsid,
       b.operationtype,
       j.goodsownid,
       j.goodsname,
       j.goodstype,
       b.goodsqty,
       j.tradepackname,
       i.lotno,
       h.packname,
       h.packsize,
       null customid,
       null customname,
       null gcompanyid,
       j.prodarea,
       j.factname,
       l.drugform,
       l.drugformno,
       m.pickflowid,
       m.pickflowname,
       n.groupid,
       n.groupname,
       b.rfmanid,
       o.employeename rfman,
       b.inoutid,
       b.warehid,
       b.posid,
       b.wholeqty,
       b.scatterqty,
       j.goodsownerid, -- xyue 2014-06-06 拣货工作区下架任务明细增加货主字段
       j.goodsownername,
       decode(nvl(h.packsize,0),0,0,ceil(b.goodsqty/h.packsize)) js ,--件数 向上取整 add by 20160705 zyc
       null erpinputman ,
       q.areaflag --带出存放类型 by tl@20180413
  from wms_task_doc         a,
       wms_st_io_doc        b,
       --tpl_trade_dtl        d,
       --tpl_trade_order      e,
       wms_trade_dtl          d,
       wms_trade_order        e,
       wms_pickarea_pos_def f,
       wms_pickarea         g,
       tpl_pub_goods_packs  h,
       wms_goods_lot        i,
       tpl_goods_v            j,
       tpl_drugform         l,
       wms_pickflow         m,
       wms_group_def        n,
       pub_employee         o,
       wms_st_section_def   p,
       wms_st_area_def      q

 where a.taskid = b.taskid
   and a.tasktype = 2 --拣货任务（波次生成）
   and b.comefrom = 4 --库内变动
   and b.sourceid = d.tradedtlid
   and d.tradeid = e.tradeid
   and e.subtype in (1, 2, 3, 4, 5) -- 1 波次补货 2 报警补货 3 闲时补货  4手工补货 5波次预补货;
   and b.posid = f.posid
   and f.pickareaid = g.pickareaid
   and b.goodspackid = h.goodspackid
   and b.lotid = i.lotid
   and b.ownergoodsid = j.ownergoodsid
   and j.drugform = l.drugformno(+)
   and g.pickflowid = m.pickflowid
   and g.groupid = n.groupid
   and b.rfmanid = o.employeeid(+)
   and b.sectionid = p.sectionid(+)
   and p.areaid = q.areaid(+)
"
"ZX_710034_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710034_V"" (""CREDATE"", ""SECTIONID"", ""SECTIONNAME"", ""TASKID"", ""TASKTYPE"", ""RFFLAG"", ""USESTATUS"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""GOODSQTY"", ""TRADEPACKNAME"", ""LOTNO"", ""PACKNAME"", ""PACKSIZE"", ""SOURCECOMPANYID"", ""SRCCOMPANYNAME"", ""GCOMPANYID"", ""INOUTID"", ""PRODAREA"", ""COMEFROM"", ""DRUGFORM"", ""DRUGFORMNO"", ""LPNCODE"", ""CHECKMAN1"", ""CHECKMAN2"", ""CONTAINERID"", ""OPERATIONTYPE"", ""CONTAINERNO"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""AREAFLAG"", ""JS"", ""ERPSUPPLYERNAME"") AS 
  select
--一个为分区上架任务明细，内容为任务状态、任务下达时间、分区名称、货品ID、货主原货品ID、
--名称、规格、单位、数量、批号、包装单位、包装大小、客户ID、货主原客户ID、客户名称。
--查询条件为：状态、客户ID（HOV）、分区ID（Hov）、货品ID（Hov）、任务下达时间（必填，缺省为当天）、
--业务类型（波次补货上架、闲时补货上架、报警补货上架、入库上架）、业务来源（各种业务类型：进货、销退、还入等）
       b.credate,
       b.sectionid,
       j.sectionname,
       a.taskid,
       '入库上架' tasktype,
       b.rfflag,
       b.usestatus,
       b.goodsid,
       g.goodsownid ,
       g.goodsname ,
       g.goodstype,
       g.factname,
       b.goodsqty,
       g.tradepackname,
       i.lotno,
       h.packname,
       h.packsize,
       e.sourcecompanyid,
      f.companyname srccompanyname,
      f.gcompanyid,
      b.inoutid,
      g.prodarea,
      b.comefrom,
      g.drugform,  --k.drugform 改为 g.drugform zyc by 20160901
      k.drugformno,
      c.lpncode,
      c.checkman1,
      c.checkman2,b.containerid,b.operationtype,t.containerno
      ,a.warehid,g.goodsownerid,g.goodsownername,
      o.areaflag,
      decode(nvl(h.packsize,0),0,0,ceil(b.goodsqty/h.packsize)) js ,--件数 向上取整 add by 20160705 zyc
      decode(g.goodsownerid,
             3,
             (select  t2.employeename
                  from    lyerp.bms_su_con_dtl  t1,
                          lyerp.pub_employee  t2
             where d.dtlzxcolumn4 = to_char(t1.sucondtlid)
               and t1.supplyerid = t2.employeeid),
             null)  erpsupplyername  --erp采购合同细单上的采购员

  from wms_task_doc           a,
       wms_st_io_doc          b,
       wms_receive_dtl        c,
       wms_in_order_dtl       d,
       wms_in_order           e,
       tpl_go_company         f,
       tpl_goods_v              g,
       tpl_pub_goods_packs    h,
       wms_goods_lot          i,
       wms_st_section_def     j,
       tpl_drugform           k,
       wms_container_def      t,
       wms_st_area_def        o
 where a.taskid = b.taskid
   and a.tasktype = 3 --上架任务
   and b.comefrom = 1 --入库
   and b.sourceid = c.receiveid
   and c.indtlid = d.indtlid
   and d.inid = e.inid
   and b.containerid = t.containerid
   and j.areaid=o.areaid(+)
   and e.sourcecompanyid = f.companyid(+)
   and b.ownergoodsid = g.ownergoodsid
   and b.goodspackid = h.goodspackid(+)
   and b.lotid = i.lotid(+)
   and b.sectionid = j.sectionid(+)
   and g.drugform = k.drugformno(+)
   and not exists(select 1 from wms_receive_detail t2 where c.receivedetailid = t2.receivedetailid)
union all
select b.credate,
       b.sectionid,
       j.sectionname,
       a.taskid,
       decode(e.subtype,
              1,
              '波次补货上架',
              5,
              '波次预补货上架',
              4,
              '手工补货上架',
              3,
              '闲时补货上架',
              '报警补货上架') tasktype,
       b.rfflag,
       b.usestatus,
       b.goodsid,
       g.goodsownid,
       g.goodsname ,
       g.goodstype,
       g.factname,
       b.goodsqty,
       g.tradepackname ,
       i.lotno,
       h.packname,
       h.packsize,
       null sourcecompanyid,
       null srccompanyname,
       null gcompanyid,
       b.inoutid,
       g.prodarea,
       b.comefrom,
       k.drugform,
       k.drugformno,
       null lpncode,
       NULL checkman1,
       NULL checkman2,b.containerid,b.operationtype,t.containerno
       ,a.warehid,g.goodsownerid,g.goodsownername,o.areaflag,
       decode(nvl(h.packsize,0),0,0,ceil(b.goodsqty/h.packsize)) js ,--件数 向上取整 add by 20160705 zyc
       null erpsupplyername
  from wms_task_doc         a,
       wms_st_io_doc        b,
       wms_trade_dtl        d,
       wms_trade_order      e,
       tpl_goods_v            g,
       tpl_pub_goods_packs  h,
       wms_goods_lot        i,
       wms_st_section_def   j,
       tpl_drugform         k,
       wms_container_def      t,
       wms_st_area_def        o
 where a.taskid = b.taskid
   and a.tasktype = 3 --上架
   and b.comefrom = 4 --库内下架任务（指库内变动单生成的下架任务）
   and b.sourceid = d.tradedtlid
   and d.tradeid = e.tradeid
   and b.containerid = t.containerid(+) --xyue 2015-07-08 增加外关联，否则查不出数据
   and e.subtype in (1, 2, 3,4,5) -- 1 波次补货 2 报警补货 3 闲时补货 4手工补货 5波次预补货;
   and b.ownergoodsid = g.ownergoodsid(+)
   and b.goodspackid = h.goodspackid(+)
   and b.lotid = i.lotid(+)
   and j.areaid=o.areaid(+)
   and b.sectionid = j.sectionid(+)
   and g.drugform = k.drugformno(+)
union
select
       b.credate,
       b.sectionid,
       j.sectionname,
       a.taskid,
       '无订单入库' tasktype,
       b.rfflag,
       b.usestatus,
       b.goodsid,
       g.goodsownid ,
       g.goodsname ,
       g.goodstype,
       g.factname,
       b.goodsqty,
       g.tradepackname,
       i.lotno,
       h.packname,
       h.packsize,
       e.GOCOMPANYID,
      f.companyname srccompanyname,
      f.gcompanyid,
      b.inoutid,
      g.prodarea,
      b.comefrom,
      k.drugform,
      k.drugformno,
      c.lpncode,
      c.checkman1,
      c.checkman2,b.containerid,b.operationtype,t.containerno
      ,a.warehid,g.goodsownerid,g.goodsownername,o.areaflag,
      decode(nvl(h.packsize,0),0,0,ceil(b.goodsqty/h.packsize)) js ,--件数 向上取整 add by 20160705 zyc
      null erpsupplyername
  from wms_task_doc           a,
       wms_st_io_doc          b,
       wms_receive_dtl        c,
       wms_receive_doc        e,
       tpl_go_company         f,
       tpl_goods_v              g,
       tpl_pub_goods_packs    h,
       wms_goods_lot          i,
       wms_st_section_def     j,
       tpl_drugform           k,
       wms_container_def      t,
       wms_receive_detail t2,
       wms_st_area_def o
 where a.taskid = b.taskid
   and a.tasktype = 3 --上架任务
   and b.comefrom = 1 --入库
   and b.containerid = t.containerid(+) --xyue 2015-07-08 增加外关联，否则查不出数据
   and b.sourceid = c.receiveid
   and e.receivedocid = t2.receivedocid
   and t2.receivedetailid = c.receivedetailid
   and e.GOCOMPANYID = f.companyid(+)
   and b.ownergoodsid = g.ownergoodsid
   and j.areaid=o.areaid(+)
   and b.goodspackid = h.goodspackid(+)
   and b.lotid = i.lotid(+)
   and b.sectionid = j.sectionid(+)
   and g.drugform = k.drugformno(+)
"
"ZX_710037_STORAGETYPE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710037_STORAGETYPE_V"" (""GOODSCLASS"", ""GOODSID"", ""DDLNAME"") AS 
  select aa.goodsclass,aa.goodsid,bb.ddlname from
(select goodsclass,goodsid from
WMS_GOODS_FEATURE_V where  warehid=2) aa
left join
(select ddlid,ddlname from pub_ddl_dtl_v  where sysid=9) bb
on aa.goodsclass=bb.ddlid
"
"ZX_710037_TMP_V2_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710037_TMP_V2_V"" (""KCRQ"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""TOTALPOSQTY"", ""ZYYP"", ""COOL0"", ""COOL1"", ""COOL3"", ""COOL2"", ""COLD0"", ""COLD1"", ""COLD3"", ""COLD2"", ""UNQUALIFIED"") AS 
  select
    t1.kcrq,
    t1.warehid,
    t1.goodsownerid,
    t1.goodsownername,
    sum(t1.totalposqty) totalposqty,
    sum(t1.zyyp)   zyyp,
    sum(t1.cool0)  cool0,
    sum(t1.cool1)  cool1,
    sum(t1.cool3)  cool3,
    sum(t1.cool2)  cool2,
    sum(t1.cold0)  cold0,
    sum(t1.cold1)  cold1,
    sum(t1.cold3)  cold3,
    sum(t1.cold2)  cold2,
    sum(t1.unqualified)  unqualified

from
(select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     count (distinct a.posid)  totalposqty,  --总货位数
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_710037_tmp_v2  a


where a.goodsid <>14689 --除掉""立库托盘""这个货品

group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all
select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     count( distinct  a.posid)  zyyp,--中药饮片货位
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_710037_tmp_v2  a
where a.drugform  in ('中药饮片','胶剂') and a.goodsstatusid<>3  and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername
union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     count( distinct  a.posid)  cool0,  --阴凉库立库托盘
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_710037_tmp_v2  a
where nvl(a.storagecondition,100) not in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=0  and a.goodsstatusid<>3
 and  a.goodsid <>14689 --除掉""立库托盘""这个货品

group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername
union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,  --阴凉库立库托盘
     count( distinct a.posid)   cool1,--阴凉库整件托盘
     0  cool3,
     0  cool2,
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_710037_tmp_v2  a
where  nvl(a.storagecondition,100) not in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=1 and a.goodsstatusid<>3

and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,  --阴凉库立库托盘
     0  cool1,　　--阴凉库整件托盘
     count(distinct a.posid)  cool3,--阴凉库整件货架
     0  cool2,
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_710037_tmp_v2  a
where nvl(a.storagecondition,100) not in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=3  and a.goodsstatusid<>3
and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername
union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,  --阴凉库立库托盘
     0  cool1,
     0  cool3,--阴凉库整件货架
     count(distinct a.posid)    cool2,--阴凉库散件
     0  cold0,
     0  cold1,
     0  cold3,
     0  cold2,
     0  unqualified  --不合格货位数
from zx_710037_tmp_v2  a
where nvl(a.storagecondition,100) not in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=2  and a.goodsstatusid<>3
and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     count(distinct a.posid)  cold0, --冷库立库托盘
     0  cold1,--冷库整件托盘
     0  cold3,--冷库整件货架
     0  cold2,　--冷库散件
     0  unqualified  --不合格货位数
from zx_710037_tmp_v2  a
where a.storagecondition  in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=0  and a.goodsstatusid<>3
and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0, --冷库立库托盘
    count(distinct a.posid)  cold1,--冷库整件托盘
     0  cold3,--冷库整件货架
     0  cold2,　--冷库散件
     0  unqualified  --不合格货位数
from zx_710037_tmp_v2  a
where a.storagecondition  in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=1  and a.goodsstatusid<>3
and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0, --冷库立库托盘
     0 cold1,--冷库整件托盘
     count(distinct a.posid)  cold3,--冷库整件货架
     0  cold2　,--冷库散件
      0  unqualified  --不合格货位数
from zx_710037_tmp_v2  a
where a.storagecondition  in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=3  and a.goodsstatusid<>3
and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0, --冷库立库托盘
     0  cold1,--冷库整件托盘
     0  cold3,--冷库整件货架
     count(distinct a.posid)  cold2,　--冷库散件
     0  unqualified  --不合格货位数
from zx_710037_tmp_v2  a
where a.storagecondition  in (3,4)  and nvl(a.drugform,'片剂')  not in ('中药饮片','胶剂')  and a.areaflag1=2  and a.goodsstatusid<>3
and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername

union all

select

     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.goodsownername,
     0  totalposqty,
     0  zyyp,
     0  cool0,
     0  cool1,
     0  cool3,
     0  cool2,
     0  cold0, --冷库立库托盘
     0  cold1,--冷库整件托盘
     0  cold3,--冷库整件货架
     0  cold2,　--冷库散件
      count(distinct a.posid)  unqualified --不合格货位
from zx_710037_tmp_v2  a
where  a.goodsstatusid=3 and  a.goodsid <>14689 --除掉""立库托盘""这个货品
group by a.kcrq,
         a.warehid,
         a.goodsownerid,
         a.goodsownername          )  t1


 group by  t1.kcrq,
    t1.warehid,
    t1.goodsownerid,
    t1.goodsownername
"
"ZX_710037_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710037_V"" (""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COL_A"", ""COL_B"", ""COL_C"", ""COL_D"", ""COL_E"", ""COL_F"", ""COL_G"", ""COL_H"", ""COL_I"", ""COL_J"", ""COL_K"", ""COL_L"", ""COL_L_1"", ""COL_L_2"", ""COL_M"", ""COL_N"", ""COL_O"", ""COL_P"", ""COL_Q"", ""COL_R"", ""COL_S"", ""COL_T"", ""COL_U"", ""COL_V"", ""COL_W"", ""COL_X"", ""COL_Y"", ""COL_Z"", ""ZX_SN_CWJS"", ""ZX_SN_BWJS"", ""ZX_SN_LCJS"", ""UPDATE_TIME"", ""ZX_SPTYPE"") AS 
  SELECT credate,  /*2018-05-09 中宏，赖锦峰 货主工作量统计*/
goodsownerid,
goodsownername,
col_a,
col_b,
col_c,
col_d,
col_e,
col_f,
col_g,
col_h,
col_i,
col_j,
col_k,
col_l,
col_l_1, --新阴凉轻型货架货位数
col_l_2, --新阴凉散货货架货位数
col_m,
col_n,
col_o,
col_p,
col_q,
col_r,
col_s,
col_t,
col_u,
col_v,
col_w,
col_x,
col_y,
col_z,
nvl(b.zx_sn_cwjs,0) zx_sn_cwjs,
nvl(b.zx_sn_bwjs,0) zx_sn_bwjs,
nvl(b.zx_sn_lcjs,0) zx_sn_lcjs,
update_time,
zx_sptype FROM zx_710037 b
"
"ZX_710038_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710038_V"" (""ZPDJID"", ""ZPDJDTLID"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""JSYID"", ""DRIVERNAME"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSQTY"", ""UNITPRICE"", ""TOTAL_LINE"", ""LOTNO"", ""VALIDDATE"", ""VEHICLENO"", ""SALESNO"", ""LDH"", ""ZJS"", ""DISTANCE"", ""JSY2"", ""OUTORDERID"", ""ZXYDH"", ""FCDATE"") AS 
  select
   a.zpdjid,
   b.zpdjdtlid,
   a.credate,
   a.goodsownerid,
   a.goodsownername,
   a.companyid,
   a.companyname,
   a.jsyid,
   a.drivername,
   b.ownergoodsid,
   b.goodsname,
   b.goodstype,
   b.goodsqty,
   b.unitprice,
   b.total_line,
   b.lotno,
   b.validdate ,
   a.vehicleno,
   a.salesno, -- 190910 李鸿 要求增加
   a.ldh,
   a.zjs,   --20200410 江尧
   c.distance,
   a.jsy2,
   a.outorderid,
   a.zxydh ,--支线运单号
   a.fcdate --启运日期


from zx_zpdj_doc_v  a,
     zx_zpdj_dtl_v  b,
     (select doc.routeid,
       doc.routename,
       dtl.transid,
       dtl.inceptaddr,
       dtl.distance
      from TMS_ROUTE_POS_V dtl, WMS_TR_ROUTE_v doc
      where doc.routeid = dtl.ROUTEID and doc.warehid=2
      ) c

     where a.zpdjid = b.zpdjid(+)
     and
     a.transid=c.transid(+)
"
"ZX_710039_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710039_V"" (""REALDISPATCHDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""YDNO"", ""GOODSOWNERNAME"", ""GCOMPANYID"", ""COMPANYNAME"", ""DRIVERID"", ""DRIVERNAME"", ""INCEPTADDR"", ""CONNECTOR"", ""CONNPHONE"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""TRANSID"", ""USESTATUS"", ""SOURCEID"", ""DISPATCHID"", ""TOTALPACKS1"", ""TOTALPACKS2"", ""TOTALCUBAGE"", ""TOTALWEIGHT"", ""MEMO1"", ""MEMO2"", ""MEMO3"", ""MEMO4"", ""MEMO5"", ""MEMO6"", ""MEMO7"", ""MEMO8"") AS 
  select
   trunc(a.realdispatchdate)  realdispatchdate,
   a.warehid,
   e.warehname,
   c.goodsownerid,
   max(c.ydno) ydno, --联冠对接新增
   f.goodsownername,
   c.gcompanyid,
   g.companyname,
   a.driverid,
   h.drivername,
   d.inceptaddr,
   d.connector,
   d.connphone,
   d.province,
   d.city,
   d.district,
   d.transid,
   a.usestatus,
   to_char(wm_concat(distinct c.sourceid))  sourceid,
   to_char(wm_concat(distinct a.dispatchid))  dispatchid,
   sum(c.totalpacks)  totalpacks1,
   sum(nvl(c.wholepacks,0))+sum(nvl(i.newsjpacks,0))  totalpacks2,
   sum(b.cubage)  totalcubage,
   sum(b.weight)  totalweight,
   '送货'  memo1,
   '医药保健品'  memo2,
   '纸箱'  memo3,
   null  memo4,
   '1'  memo5,
   '约结'  memo6,
   null  memo7,
   c.memo  memo8



from Tms_dispatch_doc  a,
     tms_dispatch_dtl  b,
     tms_tr_doc c,
     wms_transport_address d,
     tpl_warehouse e,
     tpl_goodsowner f,
     tpl_go_company g,
     tms_driver  h,
     zx_tl_box_v i --多袋算一件散件



where a.dispatchid = b.dispatchid(+)
and a.usestatus<>0
and b.trid = c.trid(+)
and a.warehid = e.warehid
and c.goodsownerid = f.goodsownerid
and c.gcompanyid = g.companyid
and c.transid = d.transid(+)
and a.driverid = h.driverid(+)
and c.sourceid = i.wavedtlid(+)
and c.warehid = i.warehid(+)

/*and a.realdispatchdate between to_date('20181022','yyyymmdd')  and to_date('20181024','yyyymmdd')
and c.goodsownerid=3
and a.driverid=1661*/
group by
   trunc(a.realdispatchdate),
   a.warehid,
   e.warehname,
   c.goodsownerid,
   f.goodsownername,
   c.gcompanyid,
   g.companyname,
   a.driverid,
   h.drivername,
   d.inceptaddr,
   d.connector,
   d.connphone,
   d.province,
   d.city,
   d.district,
   d.transid,
   a.usestatus,
   c.memo
"
"ZX_710042_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710042_V"" (""OWNERGOODSID"", ""SERVICEUNITPRICE"", ""SERVICERATE"", ""SERSTARTDATE"", ""SERENDDATE"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""APPROVEDOCNO"", ""GOODSOWNID"", ""DRUGFORM"", ""WAREGOODSID"", ""TRADEPACKNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""SERVICEID"", ""SERVICEPACKPRICE"", ""SERVICEUNITPRICE1"") AS 
  select
     a.ownergoodsid,
     a.serviceunitprice,
     a.servicerate,
     a.serstartdate,
     a.serenddate,
     b.goodsname,
     b.goodstype,
     b.factname,
     b.approvedocno,
     b.goodsownid,
     b.drugform,
     b.waregoodsid,
     b.tradepackname,
     b.goodsownerid,
     b.goodsownername,
     a.serviceid,
     a.servicepackprice,
     a.serviceunitprice1

from  zx_tl_service  a,
      tpl_goods_v   b

where a.ownergoodsid = b.ownergoodsid
"
"ZX_710043_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710043_V"" (""ZXINOUTID"", ""SOURCEID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""PACKNAME"", ""DRUGFORM"", ""FACTORYNAME"", ""CREDATE"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""PRODDATE"", ""LOTNO"", ""VALIDDATE"", ""GOODSQTY"", ""INQTY"", ""OUTQTY"", ""POSNO"", ""KEEPMANNAME"", ""CHECKMANNAME"", ""CHECKMAN2NAME"", ""RFMANNAME"", ""STOCK"", ""INVNO"", ""INOUTID"", ""MAH"") AS 
  SELECT a.inoutid zxinoutid, --出入库ID
       a.sourceid,
       a.GOODSID, --货品主档ID
       gd.goodsownid, --货主货品ID
       a.GOODSNAME,
       a.GOODSENGNAME,
       a.GOODSTYPE,
       a.PACKNAME,
       a.DRUGFORM,
       a.FACTORYNAME,
       a.CREDATE,
       a.COMPANYNAME,
       a.OPERATIONTYPE,
       a.PRODDATE,
       a.LOTNO,
       a.VALIDDATE,
       a.GOODSQTY,
       decode(a.OPERATIONTYPE,1,a.GOODSQTY,7,a.GOODSQTY,8,a.goodsqty,0) inqty,  --入库
       decode(a.OPERATIONTYPE,11,a.GOODSQTY,12,a.GOODSQTY,18,a.goodsqty,0) outqty, --出库
       a.POSNO,
       a.KEEPMANNAME,
       a.CHECKMANNAME,
       a.CHECKMAN2NAME,
       io.rfmanname, --执行人
       a.STOCK,  --结存数
       a.INVNO,
       a.inoutid ,--计算要用
       io.mah
  FROM ZX_710043 a,tpl_goods gd, wms_st_io_doc_query_v io WHERE a.goodsid=gd.waregoodsid AND gd.goodsownerid=4
  AND a.inoutid=io.inoutid
  order by a.inoutid asc
"
"ZX_710044_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710044_V"" (""ZPTHID"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""TRANSID"", ""INCEPTADDR"", ""CONNECTOR"", ""CONNPHONE"", ""OWNERGOODSID"", ""GOODSNAME"", ""BOX"", ""PCFLAG"", ""PCDATE"", ""VEHICLEID"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""INPUTMANID"", ""INPUTMANNAME"", ""BOXTYPE"", ""BOXNO"", ""WHOLE"", ""TOTAL"", ""ISQS"", ""MEMO"", ""STARTDATE"", ""STARTTEM"") AS 
  select
  a.zpthid,
  a.credate,
  a.goodsownerid,
  b.goodsownername,
  a.companyid,
  c.companyname,
  a.transid,
  d.inceptaddr,
  d.connector,
  d.connphone,
  a.ownergoodsid,
  i.goodsname,
  a.box,
  a.pcflag,
  a.pcdate,
  a.vehicleid,
  e.vehicleno,
  a.driverid,
  f.drivername,
  a.inputmanid,
  g.employeename  inputmanname,
  a.boxtype,
  a.boxno,
  null whole,
  null total,
  null isqs,
  null memo,
  null startdate,
  null starttem


from zx_710044  a,
     tpl_goodsowner  b,
      Tpl_go_company        c,
       wms_transport_address d,
       Tms_vehicle           e,
       TMS_DRIVER            f,
       pub_employee          g,
       tpl_goods i

where a.goodsownerid = b.goodsownerid(+)
and   a.companyid = c.companyid(+)
and   a.transid = d.transid(+)
and   a.ownergoodsid = i.ownergoodsid(+)
and   a.vehicleid = e.vehicleid(+)
and   a.driverid = f.driverid(+)
and   a.inputmanid = g.employeeid(+)
"
"ZX_710045_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710045_V"" (""ZPSHID"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""TRANSID"", ""INCEPTADDR"", ""CONNECTOR"", ""CONNPHONE"", ""OWNERGOODSID"", ""GOODSNAME"", ""BOX"", ""PCFLAG"", ""PCDATE"", ""VEHICLEID"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""INPUTMANID"", ""INPUTMANNAME"", ""BOXTYPE"", ""BOXNO"", ""ISQS"", ""STARTDATE"", ""STARTTEM"", ""YDNO"") AS 
  select
  a.zpshid,
  a.credate,
  a.goodsownerid,
  b.goodsownername,
  a.companyid,
  c.companyname,
  a.transid,
  d.inceptaddr,
  d.connector,
  d.connphone,
  a.ownergoodsid,
  i.goodsname,
  a.box,
  a.pcflag,
  a.pcdate,
  a.vehicleid,
  e.vehicleno,
  a.driverid,
  f.drivername,
  a.inputmanid,
  g.employeename  inputmanname,
  a.boxtype,
  a.boxno,
  null isqs,
  null startdate,
  null starttem,
  a.ydno



from zx_710045  a,
     tpl_goodsowner  b,
      Tpl_go_company        c,
       wms_transport_address d,
       Tms_vehicle           e,
       TMS_DRIVER            f,
       pub_employee          g,
       tpl_goods i

where a.goodsownerid = b.goodsownerid(+)
and   a.companyid = c.companyid(+)
and   a.transid = d.transid(+)
and   a.ownergoodsid = i.ownergoodsid(+)
and   a.vehicleid = e.vehicleid(+)
and   a.driverid = f.driverid(+)
and   a.inputmanid = g.employeeid(+)
"
"ZX_710046_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710046_V"" (""INID"", ""ZXCOLUMN4"", ""USESTATUS"", ""OPERATIONTYPE"", ""CREDATE"", ""ARRIVEDATE"", ""SRCCOMPANYNAME"", ""SRCNO"", ""SOURCECOMPANYID"", ""WAREHNAME"", ""WAREHID"", ""ZXCOLUMN2"", ""GOODSOWNERNAME"", ""GOODSOWNERID"", ""INDTLID"", ""GOODSNAME"", ""GOODSENGNAME"", ""PORDERSTATUS"", ""GOODSOWNID"", ""GOODSID"", ""GOODSCLASS"", ""GOODSQTY"", ""APPROVEDOCNO"", ""GOODSTYPE"", ""FACTNAME"", ""PRODAREA"", ""DTLZXCOLUMN4"", ""QTY"", ""DHWD"", ""SHQK"", ""YCFLAG"", ""CLFLAG"", ""YSFS"", ""YSTJ"", ""TRANSNAME"", ""SHDATE"", ""SHR"", ""SHRID"", ""SRCDTLNO"", ""MEMOTEMP"", ""MEMOFLAGA"", ""MEMOFLAGB"", ""MEMOFLAGC"", ""MEMOA"", ""MEMOB"", ""MEMOC"", ""GCWDFLAG"", ""PHNAME"", ""TRADEGOODSPACK"", ""MEDICINETYPE"", ""PACKNAME"", ""PACKSIZE"", ""DHDATE"", ""LOTNO"", ""PZXFFLAG"", ""QYWD"", ""WDCJDATE"", ""TZWDFLAG"", ""CJQNO"", ""QYDATE"", ""DHDATE1"", ""TRANSNO"", ""TRANSTOOLS"", ""INVOICECODE"", ""INVOICENO"", ""INVOICEDATE"", ""SHTXL"", ""DRUGFORM"", ""CAMERAID"", ""BARCODE"", ""SHIPCERTIFICATE"", ""OWNERGOODSID"", ""STORAGECONDITION"", ""TSCY"", ""MAH"", ""MEMO"", ""ECODEFLAG"", ""SUPPLYERADDRESS"", ""CHECKDATE"", ""INPUTMANID"", ""CHECKMAN"", ""CHECKTIME"") AS 
  select
    a.""INID"",a.""ZXCOLUMN4"",a.""USESTATUS"",a.""OPERATIONTYPE"",a.""CREDATE"",a.""ARRIVEDATE"",a.""SRCCOMPANYNAME"",a.""SRCNO"",a.""SOURCECOMPANYID"",a.""WAREHNAME"",a.""WAREHID"",a.""ZXCOLUMN2"",a.""GOODSOWNERNAME"",a.""GOODSOWNERID"",a.""INDTLID"",a.""GOODSNAME"",a.""GOODSENGNAME"",a.""PORDERSTATUS"",a.""GOODSOWNID"",a.""GOODSID"",a.""GOODSCLASS"",a.""GOODSQTY"",a.""APPROVEDOCNO"",a.""GOODSTYPE"",a.""FACTNAME"",a.""PRODAREA"",a.""DTLZXCOLUMN4"",a.""QTY"",a.""DHWD"",a.""SHQK"",a.""YCFLAG"",a.""CLFLAG"",a.""YSFS"",a.""YSTJ"",a.""TRANSNAME"",a.""SHDATE"",a.""SHR"",a.""SHRID"",a.""SRCDTLNO"",a.""MEMOTEMP"",a.""MEMOFLAGA"",a.""MEMOFLAGB"",a.""MEMOFLAGC"",a.""MEMOA"",a.""MEMOB"",a.""MEMOC"",a.""GCWDFLAG"",a.""PHNAME"",a.""TRADEGOODSPACK"",a.""MEDICINETYPE"",a.""PACKNAME"",a.""PACKSIZE"",a.""DHDATE"",a.""LOTNO"",a.""PZXFFLAG"",a.""QYWD"",a.""WDCJDATE"",a.""TZWDFLAG"",a.""CJQNO"",a.""QYDATE"",a.""DHDATE1"",a.""TRANSNO"",a.""TRANSTOOLS"",a.""INVOICECODE"",a.""INVOICENO"",a.""INVOICEDATE"",a.""SHTXL"",a.""DRUGFORM"",a.""CAMERAID"",a.""BARCODE"",a.""SHIPCERTIFICATE"",a.""OWNERGOODSID"",a.""STORAGECONDITION"",a.""TSCY"",a.""MAH"",a.""MEMO"",
    a.ecodeflag,
    a.supplyeraddress,
    /*( select
        max(aa.checkdate)
      from  wms_receive_dtl aa
     where
        aa.indtlid = a.indtlid )  checkdate,
     */
    ( select
        max(aa.checkdate)
     from  gsp_physic_quality_check  aa
     where
        exists (select 1  from  wms_receive_dtl bb
                where aa.receiveid = bb.receiveid
                   and bb.indtlid = a.indtlid))  checkdate,--取验收记录表上的验收日期为服务器时间

   ( select
       max( aa.inputmanid)
      from  wms_receive_dtl aa
     where
        aa.indtlid = a.indtlid )  inputmanid,
   ( select
       max( bb.employeename)
      from  wms_receive_dtl aa,
            pub_employee bb
           where
        aa.indtlid = a.indtlid
        and aa.inputmanid = bb.employeeid) checkman,

   round(    ( ( select
        max(aa.checkdate)
     from  gsp_physic_quality_check  aa
     where
        exists (select 1  from  wms_receive_dtl bb
                where aa.receiveid = bb.receiveid
                   and bb.indtlid = a.indtlid))-a.shdate )*24,2)    checktime

from zx_shgl_v  a
"
"ZX_710047_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710047_V"" (""CREDATE"", ""REALDISPATCHDATE"", ""DISPATCHID"", ""DRIVERID"", ""DRIVERNAME"", ""UPDOWNMAN"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GCOMPANYID"", ""COMPANYNAME"", ""MEMO"", ""USESTATUS"", ""SOURCEID"", ""DISPATCHDTLID"", ""CHAINFLAG"", ""SCATTERPACKS"", ""WHOLEPACKS"", ""TOTALPACKS"") AS 
  select
   a.credate,
   a.realdispatchdate,
   a.dispatchid,
   a.driverid,
   a.drivername,
   a.updownman,
   b.goodsownerid,
   b.goodsownername,
   b.gcompanyid,
   b.companyname,
   b.memo,
   b.usestatus,
   b.sourceid,
   b.dispatchdtlid,
   b.chainflag,
   b.scatterpacks,
   b.wholepacks,
   b.totalpacks

from tms_dispatch_doc_v a,
     tms_dispatch_dtl_v b

where a.dispatchid = b.dispatchid
 and a.warehid in (2,14)
 and b.usestatus=1
"
"ZX_710051_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710051_V"" (""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYNAME"", ""INCEPTADDR"", ""SOURCEID"", ""DEPTNAME"", ""RECEIVEDATE"") AS 
  select  a.credate,
           a.goodsownerid,
           a.goodsownername,
           a.dtlcompanyname  companyname,
           a.inceptaddr,
           a.sourceid,
           a.deptname,
           (select  max(b.credate)    from wms_out_order b
           where  a.sourceid = b.wavedtlid)  receivedate


    from   zx_pcd_v  a


       where

              a.warehid in (2,14)
"
"ZX_710052_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710052_V"" (""INOUTID"", ""CHECKDATE"", ""SHDATE"", ""CREDATE"", ""RFFINDATE"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSQTY"", ""AREAID"", ""AREANAME"", ""SECTIONID"", ""SECTIONNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select
   a.inoutid,
   b.checkdate,
   c.shdate,
   d.credate ,
   a.rffindate,
   a.goodsid,
   a.goodsname,
   a.goodstype,
   a.goodsqty,
   a.areaid,
   a.areaname,
   a.sectionid,
   a.sectionname,
   a.goodsownerid,
   a.goodsownername



from wms_st_io_doc_query_v  a,
     wms_receive_dtl b,
     wms_in_order_dtl c,
     wms_in_order d

where
 a.sourceid = b.receiveid
and b.indtlid= c.indtlid
and c.inid= d.inid
and a.comefrom = 1
and a.warehid in (2,14)
"
"ZX_710053_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710053_V"" (""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""TRADEPACKNAME"", ""LOTNO"", ""VALIDDATE"", ""GOODSQTY"") AS 
  select
  c.goodsownerid,
  d.goodsownername,
  a.ownergoodsid,
  b.goodsname,
  b.goodstype,
  b.factname,
  b.tradepackname,
  a.lotno,
  a.validdate,
  sum(a.goodsqty)  goodsqty

from zx_zpdj_dtl  a,
     tpl_goods b,
     zx_zpdj_doc c,
     tpl_goodsowner d

where
      a.ownergoodsid = b.ownergoodsid
  and a.zpdjid = c.zpdjid
  and c.goodsownerid = d.goodsownerid
  and c.inputmanid=333
  and nvl(c.signflag,0)=1
  and nvl(c.outflag,0)=0
group by
  c.goodsownerid,
  d.goodsownername,
  a.ownergoodsid,
  b.goodsname,
  b.goodstype,
  b.factname,
  b.tradepackname,
  a.lotno,
  a.validdate
"
"ZX_710071_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710071_V"" (""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""COMPANYCLASS"", ""WD"", ""DRIVERNAME"", ""VEHICLENO"", ""WHOLEPACKS"", ""SCATTERPACKS"", ""TOTALPACKS"") AS 
  select aa.credate,
       aa.warehid,
       aa.warehname,
       aa.goodsownerid,
       aa.goodsownername,
       (case
         when nvl(aa.salername, '9999') in ('黄炎镐', '林菲菲') and
              aa.goodsownerid = 3 then
          '本部'
         when nvl(aa.salername, '9999') not in ('黄炎镐', '林菲菲') and
              aa.goodsownerid = 3 then
          '集采'
         else
          null
       end) deptname, --二级货主-货主部门
       aa.province,
       aa.city,
       aa.district,
       aa.companyclass,
       aa.wd,
       aa.drivername,
       aa.vehicleno,
       sum(aa.wholepacks) wholepacks,
       sum(aa.scatterpacks) scatterpacks,
       sum(aa.totalpacks) totalpacks
  from (select trunc(a.credate) credate,
               a.warehid,
               b.warehname,
               a.goodsownerid,
               c.goodsownername,
               d.province,
               d.city,
               d.district,
               e.companyclass,
               decode(a.chainflag, 1, '冷链', '常温') wd,
               f.drivername,
               g.vehicleno,
               a.wholepacks,
               a.scatterpacks,
               a.totalpacks,
               (select max(tt.salername)
                  from wms_out_order tt
                 where tt.warehid = a.warehid
                   and tt.goodsownerid = a.goodsownerid
                   and tt.wavedtlid = a.sourceid) salername
          from tms_tr_doc a,
               tpl_warehouse b,
               tpl_goodsowner c,
               wms_transport_address d,
               tpl_go_company e,
               (select t1.dispatchid, t2.drivername
                  from tms_dispatch_doc t1, tms_driver t2
                 where t1.driverid = t2.driverid
                   and t1.usestatus <> 0
                   union all
                 select  tt1.dispatchid,tt1.drivername --加上TMS@250210 by tl
                   from tms_luyan_dispatch_doc tt1
                   where tt1.usestatus = 1 ) f,
               (select t3.dispatchid, t4.vehicleno
                  from tms_dispatch_doc t3, tms_vehicle t4
                 where t3.vehicleid = t4.vehicleid
                   and t3.usestatus <> 0
                   union all
                 select  tt2.dispatchid,tt2.vehicleno --加上TMS@250210 by tl
                   from tms_luyan_dispatch_doc tt2
                   where tt2.usestatus = 1  ) g

         where a.warehid = b.warehid

           and a.goodsownerid = c.goodsownerid

           and a.transid = d.transid(+)

           and a.gcompanyid = e.companyid

           and a.warehid in (2, 14)

           and a.dispatchid = f.dispatchid(+)

           and a.dispatchid = g.dispatchid(+)

           and a.credate > to_date('20200101', 'yyyymmdd')) aa
/*and a.credate between to_date('20211101','yyyymmdd')  and to_date('20211102','yyyymmdd')

              and a.goodsownerid=264*/

 group by aa.credate,
          aa.warehid,
          aa.warehname,
          aa.goodsownerid,
          aa.goodsownername,
          (case
            when nvl(aa.salername, '9999') in ('黄炎镐', '林菲菲') and
                 aa.goodsownerid = 3 then
             '本部'
            when nvl(aa.salername, '9999') not in ('黄炎镐', '林菲菲') and
                 aa.goodsownerid = 3 then
             '集采'
            else
             null
          end), aa.province,
          aa.city,
          aa.district,
          aa.companyclass,
          aa.wd,
          aa.drivername,
          aa.vehicleno

/*select

   trunc(a.credate)  credate ,
   a.warehid  ,
   b.warehname  ,
   a.goodsownerid  ,
   c.goodsownername  ,
   d.province ,
   d.city ,
   d.district ,
   e.companyclass ,
   decode(a.chainflag,1,'冷链','常温') wd ,
   f.drivername,
   g.vehicleno,

   sum( a.wholepacks) wholepacks ,
    sum( a.scatterpacks)  scatterpacks ,
    sum(a.totalpacks ) totalpacks

from tms_tr_doc a ,
     tpl_warehouse b,
     tpl_goodsowner c,
     wms_transport_address d,
     tpl_go_company e,
     (select
           t1.dispatchid,
           t2.drivername
      from  tms_dispatch_doc t1,
            tms_driver t2
      where t1.driverid = t2.driverid
          and t1.usestatus<>0) f,
       (select
           t3.dispatchid,
           t4.vehicleno
      from  tms_dispatch_doc t3,
            tms_vehicle t4
      where t3.vehicleid = t4.vehicleid
          and t3.usestatus<>0) g,
      select * from wms_out_order a where a.


where   a.warehid = b.warehid

and     a.goodsownerid = c.goodsownerid

and   a.transid = d.transid(+)

and a.gcompanyid = e.companyid

and a.warehid in (2,14)

and a.dispatchid = f.dispatchid(+)

and a.dispatchid = g.dispatchid(+)

and a.credate> to_date('20201201','yyyymmdd')
\*and a.credate between to_date('20211101','yyyymmdd')  and to_date('20211102','yyyymmdd')

and a.goodsownerid=264*\

group by
   trunc( a.credate) ,
   a.warehid  ,
   b.warehname  ,
   a.goodsownerid  ,
   c.goodsownername  ,
   d.province ,
   d.city ,
   d.district ,
   e.companyclass ,
   decode(a.chainflag,1,'冷链','常温') ,
   f.drivername,
   g.vehicleno;*/
"
"ZX_710072_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710072_V"" (""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSCLASS"", ""ZJSJCOUNT"", ""ZJSJJS"", ""SJSJCOUNT"", ""SJSJQTY"", ""BHXJCOUNT"", ""BHSJCOUNT"", ""ZJJHCOUNT"", ""ZJJHJS"", ""ZJFHCOUNT"", ""ZJFHJS"", ""SJJHCOUNT"", ""SJJHQTY"", ""SJFHCOUNT"", ""SJFHQTY"", ""YSHWYSCOUNT"") AS 
  select
   aa.goodsownerid,
   aa.goodsownername,
   aa.goodsclass,
   sum(aa.zjsjcount) zjsjcount  ,
   sum(aa.zjsjjs)  zjsjjs  ,
   sum( aa.sjsjcount) sjsjcount,
   sum( aa.sjsjqty)  sjsjqty,
   sum( aa.bhxjcount)  bhxjcount,
   sum( aa.bhsjcount)  bhsjcount,
   sum( aa.zjjhcount)  zjjhcount,
   sum( aa.zjjhjs)  zjjhjs,
   sum( aa.zjfhcount) zjfhcount,
   sum( aa.zjfhjs)  zjfhjs,
   sum( aa.sjjhcount)  sjjhcount,
   sum( aa.sjjhqty) sjjhqty,
   sum( aa.sjfhcount) sjfhcount,
   sum( aa.sjfhqty) sjfhqty,
   sum(aa.yshwyscount)  yshwyscount


from

(


--整件上架4709
select
   a.goodsownerid,
   a.goodsownername,
   a1.goodsclass,
   count(*)  zjsjcount,
   sum(a.lsjs) zjsjjs,
   0 sjsjcount,
   0 sjsjqty,
   0 bhxjcount,
   0 bhsjcount,
   0 zjjhcount,
   0 zjjhjs,
   0 zjfhcount,
   0 zjfhjs,
   0 sjjhcount,
   0 sjjhqty,
   0 sjfhcount,
   0 sjfhqty,
   0 yshwyscount

from

    wms_section_task_dtl_v  a,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   a.tasktype like '入库上架'
and
   a.rfflag=2 --任务状态可发送
and
   a1.sysid=9
and
   a2.warehid = a.warehid
and
   a2.goodsid = a.goodsid
and
   a2.goodsclass = a1.ddlid
and
   a.areaflag in (1,0) --存放类型托盘,整件
and
   a.warehid = 2
and a.credate >to_date('20211117','yyyymmdd')
--and a.goodsownerid=4


group by
    a.goodsownerid,
    a.goodsownername,
    a1.goodsclass

--散件上架 4709
 union all

select
   a.goodsownerid,
   a.goodsownername,
   a1.goodsclass,
   0  zjsjcount,
   0 zjsjjs,
   count(*) sjsjcount,
   sum(a.goodsqty) sjsjqty,
   0 bhxjcount,
   0 bhsjcount,
   0 zjjhcount,
   0 zjjhjs,
   0 zjfhcount,
   0 zjfhjs,
   0 sjjhcount,
   0 sjjhqty,
   0 sjfhcount,
   0 sjfhqty,
   0 yshwyscount

from

    wms_section_task_dtl_v  a,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   a.tasktype like '入库上架'
and
   a.rfflag=2 --任务状态可发送
and
   a1.sysid=9
and
   a2.warehid = a.warehid
and
   a2.goodsid = a.goodsid
and
   a2.goodsclass = a1.ddlid
and
   a.areaflag in (2) --存放类型散件
and
   a.warehid = 2

and a.credate >to_date('20211117','yyyymmdd')
--and a.goodsownerid=4


group by
    a.goodsownerid,
    a.goodsownername,
    a1.goodsclass

--补货下架  4407
 union all

select
   b1.goodsownerid,
   b1.goodsownername,
   a1.goodsclass,
   0  zjsjcount,
   0 zjsjjs,
   0 sjsjcount,
   0 sjsjqty,
   count(*) bhxjcount,
   0 bhsjcount,
   0 zjjhcount,
   0 zjjhjs,
   0 zjfhcount,
   0 zjfhjs,
   0 sjjhcount,
   0 sjjhqty,
   0 sjfhcount,
   0 sjfhqty,
   0 yshwyscount

from

    wms_trade_dtl b,
    wms_trade_order_v b1,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   b.tradeid = b1.tradeid
 and
   b1.usestatus=2 --总单确认
 and
   b.usestatus in (2) --细单已配货
 and
   b1.operationtype in (28,29) --除掉库存明细调整
 and
   b1.warehid = 2
 and
   a1.sysid=9
 and
   a2.warehid = b1.warehid
 and
   a2.goodsid = b.goodsid
 and
   a2.goodsclass = a1.ddlid
 and
   b1.goodsownerid=4
 and
   b1.tradedate >to_date('20211117','yyyymmdd')


group by
    b1.goodsownerid,
    b1.goodsownername,
    a1.goodsclass

 union all --补货上架4407

select
   b1.goodsownerid,
   b1.goodsownername,
   a1.goodsclass,
   0  zjsjcount,
   0 zjsjjs,
   0 sjsjcount,
   0 sjsjqty,
   0 bhxjcount,
   count(*) bhsjcount,
   0 zjjhcount,
   0 zjjhjs,
   0 zjfhcount,
   0 zjfhjs,
   0 sjjhcount,
   0 sjjhqty,
   0 sjfhcount,
   0 sjfhqty,
   0 yshwyscount

from

    wms_trade_dtl b,
    wms_trade_order_v b1,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   b.tradeid = b1.tradeid
 and
   b1.usestatus=2 --总单确认
 and
   b.usestatus in (2,3) --细单已配货已下架
 and
   b1.operationtype in (28,29) --除掉库存明细调整
 and
   b1.warehid = 2
 and
   a1.sysid=9
 and
   a2.warehid = b1.warehid
 and
   a2.goodsid = b.goodsid
 and
   a2.goodsclass = a1.ddlid
 and
   b1.goodsownerid=4
 and
   b1.tradedate >to_date('20211117','yyyymmdd')


group by
    b1.goodsownerid,
    b1.goodsownername,
    a1.goodsclass


union all --整件备货4603

select
   c.goodsownerid,
   c.goodsownername,
   a1.goodsclass,
   0  zjsjcount,
   0  zjsjjs,
   0 sjsjcount,
   0 sjsjqty,
   0 bhxjcount,
   0 bhsjcount,
   count(*) zjjhcount,
   sum(c.wholeqty) zjjhjs,
   0 zjfhcount,
   0 zjfhjs,
   0 sjjhcount,
   0 sjjhqty,
   0 sjfhcount,
   0 sjfhqty,
   0 yshwyscount

from

    wms_st_io_doc_v  c,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   (c.areaflag in (1,0)
    or c.wholeoutflag=1)
and
    c.inoutflag = 1
and
    c.comefrom in (2,3)
and
    c.rfflag in (1,2)--4603任务状态不发送可发送
and
   a1.sysid=9
and
   a2.warehid = c.warehid
and
   a2.goodsid = c.goodsid
and
   a2.goodsclass = a1.ddlid

and
   c.warehid = 2
and c.credate >to_date('20211117','yyyymmdd')

group by
    c.goodsownerid,
    c.goodsownername,
    a1.goodsclass

union all --整件复核4603

select
   c.goodsownerid,
   c.goodsownername,
   a1.goodsclass,
   0  zjsjcount,
   0  zjsjjs,
   0 sjsjcount,
   0 sjsjqty,
   0 bhxjcount,
   0 bhsjcount,
   0 zjjhcount,
   0 zjjhjs,
   count(*) zjfhcount,
   sum(c.wholeqty) zjfhjs,
   0 sjjhcount,
   0 sjjhqty,
   0 sjfhcount,
   0 sjfhqty,
   0 yshwyscount

from

    wms_st_io_doc_v  c,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   (c.areaflag in (1,0)
    or c.wholeoutflag=1)
and
    c.inoutflag = 1
and
    c.comefrom in (2,3)
and
    c.checkstatus in (0,2)--4603复核状态为未复核,一复完成
and
   a1.sysid=9
and
   a2.warehid = c.warehid
and
   a2.goodsid = c.goodsid
and
   a2.goodsclass = a1.ddlid

and
   c.warehid = 2
and c.credate >to_date('20211117','yyyymmdd')

group by
    c.goodsownerid,
    c.goodsownername,
    a1.goodsclass


union all --散件备货4602

select
   d1.goodsownerid,
   d1.goodsownername,
   a1.goodsclass,
   0 zjsjcount,
   0 zjsjjs,
   0 sjsjcount,
   0 sjsjqty,
   0 bhxjcount,
   0 bhsjcount,
   0 zjjhcount,
   0 zjjhjs,
   0 zjfhcount,
   0 zjfhjs,
   count(*) sjjhcount,
   sum(d.goodsqty) sjjhqty,
   0 sjfhcount,
   0 sjfhqty,
   0 yshwyscount

from

    wms_st_io_doc_v d,
    wms_turnbox_doc_v d1,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   d.boxdocid = d1.boxdocid
 and
   d1.usestatus = 1 --任务状态正在拣货
 and
   d1.warehid = 2
 and
   a1.sysid=9
 and
   a2.warehid = d1.warehid
 and
   a2.goodsid = d.goodsid
 and
   a2.goodsclass = a1.ddlid
 and
   d1.credate >to_date('20211117','yyyymmdd')


group by
    d1.goodsownerid,
    d1.goodsownername,
    a1.goodsclass

union all --散件复核4602

select
   d1.goodsownerid,
   d1.goodsownername,
   a1.goodsclass,
   0 zjsjcount,
   0 zjsjjs,
   0 sjsjcount,
   0 sjsjqty,
   0 bhxjcount,
   0 bhsjcount,
   0 zjjhcount,
   0 zjjhjs,
   0 zjfhcount,
   0 zjfhjs,
   0 sjjhcount,
   0 sjjhqty,
   count(*) sjfhcount,
   sum(d.goodsqty) sjfhqty,
   0 yshwyscount

from

    wms_st_io_doc_v d,
    wms_turnbox_doc_v d1,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   d.boxdocid = d1.boxdocid
 and
   d1.usestatus in (1,2,3) --任务状态正在拣货,待复核,待装箱
 and
   d1.warehid = 2
 and
   a1.sysid=9
 and
   a2.warehid = d1.warehid
 and
   a2.goodsid = d.goodsid
 and
   a2.goodsclass = a1.ddlid
 and
   d1.credate >to_date('20211117','yyyymmdd')


group by
    d1.goodsownerid,
    d1.goodsownername,
    a1.goodsclass

union all --收货未验收710099

  select
   e.goodsownerid,
   e.goodsownername,
   a1.goodsclass,
   0 zjsjcount,
   0 zjsjjs,
   0 sjsjcount,
   0 sjsjqty,
   0 bhxjcount,
   0 bhsjcount,
   0 zjjhcount,
   0 zjjhjs,
   0 zjfhcount,
   0 zjfhjs,
   0 sjjhcount,
   0 sjjhqty,
   0 sjfhcount,
   0 sjfhqty,
   count(*)  yshwyscount

from

    zx_shgl_v e,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   e.usestatus=1 --下单
 and
   e.clflag=1 --已收货
 and
   e.warehid = 2
 and
   a1.sysid=9
 and
   a2.warehid = e.warehid
 and
   a2.goodsid = e.goodsid
 and
   a2.goodsclass = a1.ddlid
 and
   e.credate >to_date('20211117','yyyymmdd')


group by
    e.goodsownerid,
    e.goodsownername,
    a1.goodsclass


)   aa

group by
      aa.goodsownerid,
      aa.goodsownername,
      aa.goodsclass
order by aa.goodsownerid,aa.goodsclass
"
"ZX_710073_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710073_DTL_V"" (""INDTLID"", ""ZXGDTLID"", ""ZXGID"", ""ZXGNAME"", ""QTY"") AS 
  select
  a.indtlid,
  a.zxgdtlid,
  a.zxgid,
  b.employeename zxgname,
  a.qty




from zx_710073_dtl  a,
     pub_employee  b

where a.zxgid = b.employeeid
"
"ZX_710074_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710074_V"" (""GOODSCLASS"", ""ZJSJCOUNT"", ""ZJSJJS"", ""SJSJCOUNT"", ""SJSJQTY"", ""BHXJCOUNT"", ""BHSJCOUNT"", ""ZJJHCOUNT"", ""ZJJHJS"", ""ZJFHCOUNT"", ""ZJFHJS"", ""SJJHCOUNT"", ""SJJHQTY"", ""SJFHCOUNT"", ""SJFHQTY"", ""YSHWYSCOUNT"") AS 
  select

   aa.goodsclass,
   sum(aa.zjsjcount) zjsjcount  ,
   sum(aa.zjsjjs)  zjsjjs  ,
   sum( aa.sjsjcount) sjsjcount,
   sum( aa.sjsjqty)  sjsjqty,
   sum( aa.bhxjcount)  bhxjcount,
   sum( aa.bhsjcount)  bhsjcount,
   sum( aa.zjjhcount)  zjjhcount,
   sum( aa.zjjhjs)  zjjhjs,
   sum( aa.zjfhcount) zjfhcount,
   sum( aa.zjfhjs)  zjfhjs,
   sum( aa.sjjhcount)  sjjhcount,
   sum( aa.sjjhqty) sjjhqty,
   sum( aa.sjfhcount) sjfhcount,
   sum( aa.sjfhqty) sjfhqty,
   sum(aa.yshwyscount)  yshwyscount


from

(


--整件上架4709
select

   a1.goodsclass,
   count(*)  zjsjcount,
   sum(a.lsjs) zjsjjs,
   0 sjsjcount,
   0 sjsjqty,
   0 bhxjcount,
   0 bhsjcount,
   0 zjjhcount,
   0 zjjhjs,
   0 zjfhcount,
   0 zjfhjs,
   0 sjjhcount,
   0 sjjhqty,
   0 sjfhcount,
   0 sjfhqty,
   0 yshwyscount

from

    wms_section_task_dtl_v  a,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   a.tasktype like '入库上架'
and
   a.rfflag=2 --任务状态可发送
and
   a1.sysid=9
and
   a2.warehid = a.warehid
and
   a2.goodsid = a.goodsid
and
   a2.goodsclass = a1.ddlid
and
   a.areaflag in (1,0) --存放类型托盘,整件
and
   a.warehid = 2
and a.credate >to_date('20211117','yyyymmdd')
--and a.goodsownerid=4


group by

    a1.goodsclass

--散件上架 4709
 union all

select

   a1.goodsclass,
   0  zjsjcount,
   0 zjsjjs,
   count(*) sjsjcount,
   sum(a.goodsqty) sjsjqty,
   0 bhxjcount,
   0 bhsjcount,
   0 zjjhcount,
   0 zjjhjs,
   0 zjfhcount,
   0 zjfhjs,
   0 sjjhcount,
   0 sjjhqty,
   0 sjfhcount,
   0 sjfhqty,
   0 yshwyscount

from

    wms_section_task_dtl_v  a,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   a.tasktype like '入库上架'
and
   a.rfflag=2 --任务状态可发送
and
   a1.sysid=9
and
   a2.warehid = a.warehid
and
   a2.goodsid = a.goodsid
and
   a2.goodsclass = a1.ddlid
and
   a.areaflag in (2) --存放类型散件
and
   a.warehid = 2

and a.credate >to_date('20211117','yyyymmdd')
--and a.goodsownerid=4


group by

    a1.goodsclass

--补货下架  4407
 union all

select

   a1.goodsclass,
   0  zjsjcount,
   0 zjsjjs,
   0 sjsjcount,
   0 sjsjqty,
   count(*) bhxjcount,
   0 bhsjcount,
   0 zjjhcount,
   0 zjjhjs,
   0 zjfhcount,
   0 zjfhjs,
   0 sjjhcount,
   0 sjjhqty,
   0 sjfhcount,
   0 sjfhqty,
   0 yshwyscount

from

    wms_trade_dtl b,
    wms_trade_order_v b1,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   b.tradeid = b1.tradeid
 and
   b1.usestatus=2 --总单确认
 and
   b.usestatus in (2) --细单已配货
 and
   b1.operationtype in (28,29) --除掉库存明细调整
 and
   b1.warehid = 2
 and
   a1.sysid=9
 and
   a2.warehid = b1.warehid
 and
   a2.goodsid = b.goodsid
 and
   a2.goodsclass = a1.ddlid
 and
   b1.goodsownerid=4
 and
   b1.tradedate >to_date('20211117','yyyymmdd')


group by

    a1.goodsclass

 union all --补货上架4407

select

   a1.goodsclass,
   0  zjsjcount,
   0 zjsjjs,
   0 sjsjcount,
   0 sjsjqty,
   0 bhxjcount,
   count(*) bhsjcount,
   0 zjjhcount,
   0 zjjhjs,
   0 zjfhcount,
   0 zjfhjs,
   0 sjjhcount,
   0 sjjhqty,
   0 sjfhcount,
   0 sjfhqty,
   0 yshwyscount

from

    wms_trade_dtl b,
    wms_trade_order_v b1,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   b.tradeid = b1.tradeid
 and
   b1.usestatus=2 --总单确认
 and
   b.usestatus in (2,3) --细单已配货已下架
 and
   b1.operationtype in (28,29) --除掉库存明细调整
 and
   b1.warehid = 2
 and
   a1.sysid=9
 and
   a2.warehid = b1.warehid
 and
   a2.goodsid = b.goodsid
 and
   a2.goodsclass = a1.ddlid
 and
   b1.goodsownerid=4
 and
   b1.tradedate >to_date('20211117','yyyymmdd')


group by

    a1.goodsclass


union all --整件备货4603

select

   a1.goodsclass,
   0  zjsjcount,
   0  zjsjjs,
   0 sjsjcount,
   0 sjsjqty,
   0 bhxjcount,
   0 bhsjcount,
   count(*) zjjhcount,
   sum(c.wholeqty) zjjhjs,
   0 zjfhcount,
   0 zjfhjs,
   0 sjjhcount,
   0 sjjhqty,
   0 sjfhcount,
   0 sjfhqty,
   0 yshwyscount

from

    wms_st_io_doc_v  c,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   (c.areaflag in (1,0)
    or c.wholeoutflag=1)
and
    c.inoutflag = 1
and
    c.comefrom in (2,3)
and
    c.rfflag in (1,2)--4603任务状态不发送可发送
and
   a1.sysid=9
and
   a2.warehid = c.warehid
and
   a2.goodsid = c.goodsid
and
   a2.goodsclass = a1.ddlid

and
   c.warehid = 2
and c.credate >to_date('20211117','yyyymmdd')

group by

    a1.goodsclass

union all --整件复核4603

select

   a1.goodsclass,
   0  zjsjcount,
   0  zjsjjs,
   0 sjsjcount,
   0 sjsjqty,
   0 bhxjcount,
   0 bhsjcount,
   0 zjjhcount,
   0 zjjhjs,
   count(*) zjfhcount,
   sum(c.wholeqty) zjfhjs,
   0 sjjhcount,
   0 sjjhqty,
   0 sjfhcount,
   0 sjfhqty,
   0 yshwyscount

from

    wms_st_io_doc_v  c,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   (c.areaflag in (1,0)
    or c.wholeoutflag=1)
and
    c.inoutflag = 1
and
    c.comefrom in (2,3)
and
    c.checkstatus in (0,2)--4603复核状态为未复核,一复完成
and
   a1.sysid=9
and
   a2.warehid = c.warehid
and
   a2.goodsid = c.goodsid
and
   a2.goodsclass = a1.ddlid

and
   c.warehid = 2
and c.credate >to_date('20211117','yyyymmdd')

group by

    a1.goodsclass


union all --散件备货4602

select

   a1.goodsclass,
   0 zjsjcount,
   0 zjsjjs,
   0 sjsjcount,
   0 sjsjqty,
   0 bhxjcount,
   0 bhsjcount,
   0 zjjhcount,
   0 zjjhjs,
   0 zjfhcount,
   0 zjfhjs,
   count(*) sjjhcount,
   sum(d.goodsqty) sjjhqty,
   0 sjfhcount,
   0 sjfhqty,
   0 yshwyscount

from

    wms_st_io_doc_v d,
    wms_turnbox_doc_v d1,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   d.boxdocid = d1.boxdocid
 and
   d1.usestatus = 1 --任务状态正在拣货
 and
   d1.warehid = 2
 and
   a1.sysid=9
 and
   a2.warehid = d1.warehid
 and
   a2.goodsid = d.goodsid
 and
   a2.goodsclass = a1.ddlid
 and
   d1.credate >to_date('20211117','yyyymmdd')


group by

    a1.goodsclass

union all --散件复核4602

select

   a1.goodsclass,
   0 zjsjcount,
   0 zjsjjs,
   0 sjsjcount,
   0 sjsjqty,
   0 bhxjcount,
   0 bhsjcount,
   0 zjjhcount,
   0 zjjhjs,
   0 zjfhcount,
   0 zjfhjs,
   0 sjjhcount,
   0 sjjhqty,
   count(*) sjfhcount,
   sum(d.goodsqty) sjfhqty,
   0 yshwyscount

from

    wms_st_io_doc_v d,
    wms_turnbox_doc_v d1,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   d.boxdocid = d1.boxdocid
 and
   d1.usestatus in (1,2,3) --任务状态正在拣货,待复核,待装箱
 and
   d1.warehid = 2
 and
   a1.sysid=9
 and
   a2.warehid = d1.warehid
 and
   a2.goodsid = d.goodsid
 and
   a2.goodsclass = a1.ddlid
 and
   d1.credate >to_date('20211117','yyyymmdd')


group by

    a1.goodsclass

union all --收货未验收710099

  select

   a1.goodsclass,
   0 zjsjcount,
   0 zjsjjs,
   0 sjsjcount,
   0 sjsjqty,
   0 bhxjcount,
   0 bhsjcount,
   0 zjjhcount,
   0 zjjhjs,
   0 zjfhcount,
   0 zjfhjs,
   0 sjjhcount,
   0 sjjhqty,
   0 sjfhcount,
   0 sjfhqty,
   count(*)  yshwyscount

from

    zx_shgl_v e,
    pub_ddl_dtl a1,
    wms_goods_feature a2

where
   e.usestatus=1 --下单
 and
   e.clflag=1 --已收货
 and
   e.warehid = 2
 and
   a1.sysid=9
 and
   a2.warehid = e.warehid
 and
   a2.goodsid = e.goodsid
 and
   a2.goodsclass = a1.ddlid
 and
   e.credate >to_date('20211117','yyyymmdd')


group by

    a1.goodsclass


)   aa

group by

      aa.goodsclass
order by aa.goodsclass
"
"ZX_710076_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710076_DTL_V"" (""DOCID"", ""DTLID"", ""FZSHRID"", ""FZSHR"", ""SHQTY"", ""FZXYRID"", ""FZXYR"", ""XHQTY"") AS 
  select
 a.docid, --总单ID
 a.dtlid, --细单ID
 a.fzshrid,--辅助收货人
 b.employeename fzshr,
 a.shqty,--收货数量
 a.fzxyrid,--辅助卸货人
 c.employeename fzxyr,
 a.xhqty --卸货数量



from zx_710076_dtl a,
     pub_employee b,
     pub_employee c

where a.fzshrid = b.employeeid(+)

and   a.fzxyrid = c.employeeid(+)
"
"ZX_710076_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710076_V"" (""ID"", ""SHDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""GOODSCLASS"", ""SHRID"", ""SHR"", ""SCATTERQTY"", ""WHOLEQTY"", ""GOODSNUMBER"", ""LOTNUMBER"") AS 
  select
       to_char(m.shdate,'yyyymmdd')||to_char(a.warehid)||to_char(a.goodsownerid)||to_char(a.companyid)||
       to_char(m.shrid)||to_char(decode(e.goodsclass,'中药',1,'西药',2,'冷链',3,'器械',4,0))       ID,
       trunc(m.shdate) shdate,--收货时间
       a.warehid,--物流中心ID
       b.warehname,--物流中心
       a.goodsownerid,--货主ID
       c.goodsownername,--货主
       a.companyid,
       n.companyname,
       e.goodsclass,--药品大类
       m.shrid,
       o.employeename shr,
      sum( nvl(a.scatterqty,0)) scatterqty,--零散数
      sum( nvl(a.wholeqty,0)) wholeqty, --整件数
      count(distinct a.goodsid) goodsnumber,--品种数
      count(distinct a.lotid) lotnumber --批号数
/*
取数规则：
1.福州物流中心的数据
2.药品大类维护在WMS货品分类的选项字典细单pub_ddl_dtl.goodsclass
3.一个WMS分类只有属于一种药品大类，例如：冷藏-器械，归为冷链，但不归为器械
4.以订单的收货时间为时间基准条件

*/
  from wms_st_io_doc          a,
       tpl_warehouse          b,
       tpl_goodsowner         c,
       wms_goods_feature      d,
       pub_ddl_dtl            e,
       wms_pos_def            f,
       wms_st_area_def        g,
       tpl_pub_goods_packs    h,
       tpl_goods              i,
       wms_goods_lot          j,
       wms_receive_dtl        k,
       wms_in_order           l,
       wms_in_order_dtl       m,
       tpl_go_company         n,
       pub_employee o
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.warehid in (2, 14)
   and a.warehid = d.warehid
   and a.goodsid = d.goodsid
   and e.sysid = 9
   and d.goodsclass = e.ddlid
   and a.posid=f.posid
   and f.areaid=g.areaid
   and a.goodspackid=h.goodspackid
   and a.ownergoodsid=i.ownergoodsid
   and a.lotid=j.lotid
   and a.comefrom=1 --入库上架
   and a.sourceid=k.receiveid
   and m.porderstatus=5 --上架完成
   and l.inid=m.inid
   and m.indtlid=k.indtlid
   and a.companyid=n.companyid(+)
   and m.shrid = o.employeeid(+)
   and m.shdate>to_Date('2022-02-28','yyyy-mm-dd')
  -- and a.goodsownerid=4


group by
        to_char(m.shdate,'yyyymmdd')||to_char(a.warehid)||to_char(a.goodsownerid)||to_char(a.companyid)||
       to_char(m.shrid)||to_char(decode(e.goodsclass,'中药',1,'西药',2,'冷链',3,'器械',4,0))      ,
       trunc(m.shdate) ,--收货时间
       a.warehid,--物流中心ID
       b.warehname,--物流中心
       a.goodsownerid,--货主ID
       c.goodsownername,--货主
       a.companyid,
       n.companyname,
       e.goodsclass,--药品大类
       m.shrid,
       o.employeename


order by
      trunc(m.shdate),
      a.warehid,
      a.goodsownerid,
      n.companyname,
      e.goodsclass
"
"ZX_710082_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710082_V"" (""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""COMPANYCLASS"", ""WD"", ""DRIVERNAME"", ""VEHICLENO"", ""WHOLEPACKS"", ""SCATTERPACKS"", ""TOTALPACKS"") AS 
  select aa.credate,
       aa.warehid,
       aa.warehname,
       aa.goodsownerid,
       aa.goodsownername,
       (case
         when nvl(aa.salername, '9999') in ('黄炎镐', '林菲菲') and
              aa.goodsownerid = 3 then
          '本部'
         when nvl(aa.salername, '9999') not in ('黄炎镐', '林菲菲') and
              aa.goodsownerid = 3 then
          '集采'
         else
          null
       end) deptname, --二级货主-货主部门
       aa.province,
       aa.city,
       aa.district,
       aa.companyclass,
       aa.wd,
       aa.drivername,
       aa.vehicleno,
       sum(aa.wholepacks) wholepacks,
       sum(aa.scatterpacks) scatterpacks,
       sum(aa.totalpacks) totalpacks
  from (select trunc(a.credate) credate,
               a.warehid,
               b.warehname,
               a.goodsownerid,
               c.goodsownername,
               d.province,
               d.city,
               d.district,
               e.companyclass,
               decode(a.chainflag, 1, '冷链', '常温') wd,
               f.drivername,
               g.vehicleno,
               a.wholepacks,
               a.scatterpacks,
               a.totalpacks,
               (select max(tt.salername)
                  from wms_out_order tt
                 where tt.warehid = a.warehid
                   and tt.goodsownerid = a.goodsownerid
                   and tt.wavedtlid = a.sourceid) salername
          from tms_tr_doc a,
               tpl_warehouse b,
               tpl_goodsowner c,
               wms_transport_address d,
               tpl_go_company e,
               (select t1.dispatchid, t2.drivername
                  from tms_dispatch_doc t1, tms_driver t2
                 where t1.driverid = t2.driverid
                   and t1.usestatus <> 0) f,
               (select t3.dispatchid, t4.vehicleno
                  from tms_dispatch_doc t3, tms_vehicle t4
                 where t3.vehicleid = t4.vehicleid
                   and t3.usestatus <> 0) g
         where a.warehid = b.warehid
           and a.goodsownerid = c.goodsownerid
           and a.transid = d.transid(+)
           and a.gcompanyid = e.companyid
           and a.warehid in (2, 14)
           and a.dispatchid = f.dispatchid(+)
           and a.dispatchid = g.dispatchid(+)
           and a.credate > to_date('20200101', 'yyyymmdd')
           and a.comefrom = 1
           and a.sourcetable = 1
           and exists
         (select 1
                  from wms_wave_dtl a1, wms_wave_goods_dtl a2,wms_wave_doc a3
                 where a1.wavedtlid = a2.wavedtlid
                   and a1.waveid=a3.wavedocid
                   and (a1.goodsownerid in
                       (select a3.goodsownerid
                           from tpl_goodsowner a3
                          where a3.goodsownername like '%扬子江药业%') or
                       a2.ownergoodsid in
                       (select a4.ownergoodsid from zx_yzj_goods a4))
                   and a1.wavedtlid = a.sourceid
                   and a3.warehid in (2,14))

        ) aa
 group by aa.credate,
          aa.warehid,
          aa.warehname,
          aa.goodsownerid,
          aa.goodsownername,
          (case
            when nvl(aa.salername, '9999') in ('黄炎镐', '林菲菲') and
                 aa.goodsownerid = 3 then
             '本部'
            when nvl(aa.salername, '9999') not in ('黄炎镐', '林菲菲') and
                 aa.goodsownerid = 3 then
             '集采'
            else
             null
          end),
          aa.province,
          aa.city,
          aa.district,
          aa.companyclass,
          aa.wd,
          aa.drivername,
          aa.vehicleno
"
"ZX_710085_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710085_V"" (""ZPYSDDID"", ""CREDATE"", ""TYPE"", ""DDNUMBER"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANY"", ""ADDRESS"", ""RECEIVEMAN"", ""TELEPHONE"", ""TRANSCONDITION"", ""TOTALPACKS"", ""COMMONPACKS"", ""CHAINPACKS"", ""AREA"", ""VEHICLEID"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DELIVERYMANID"", ""DELIVERYMAN"", ""PCFLAG"", ""PCDATE"") AS 
  select
    a.zpysddid,
    a.credate,
    a.type,
    a.ddnumber,
    a.goodsownerid,
    b.goodsownername,
    a.company,
    a.address,
    a.receiveman,
    a.telephone,
    a.transcondition,
    a.totalpacks,
    a.commonpacks,
    a.chainpacks,
    a.area,
    a.vehicleid,
    c.vehicleno,
    a.driverid,
    d.drivername,
    a.deliverymanid,
    e.employeename deliveryman,
    a.pcflag,
    a.pcdate


  from zx_710085 a,
       tpl_goodsowner b,
       tms_vehicle  c,
       tms_driver d,
       pub_employee e


  where a.goodsownerid = b.goodsownerid
    and a.vehicleid = c.vehicleid(+)
    and a.driverid = d.driverid(+)
    and a.deliverymanid = e.employeeid(+)
"
"ZX_710090_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710090_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""REALDISPATCHDATE"", ""GCOMPANYID"", ""COMPANYNAME"", ""TRANSID"", ""INCEPTADDR"", ""GOODSID"", ""GOODSNAME"", ""MAH"", ""FACTNAME"", ""GOODSTYPE"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""TRADEPACKNAME"", ""SOURCEID"", ""SELFTRANSTYPE"", ""EXCARRIER"", ""DISPATCHID"", ""VEHICLEID"", ""VEHICLENO"", ""TRANSMODEL"", ""DRIVERID"", ""DRIVERNAME"", ""TRID"", ""STARTDATE"", ""ENDDATE"", ""WAREHADDRESS"") AS 
  select a.warehid,
       c.warehname,
       a.goodsownerid, --货主ID
       d.goodsownername, --委托方名称
       i.realdispatchdate, --发货时间
       a.gcompanyid,
       e.companyname, --收货单位名称
       a.transid,
       f.inceptaddr, --地址
       --  f.connphone, --联系方式
       --  b.ownergoodsid,
       b.goodsid, --货品主档ID
       -- g.goodsownid,
       g.goodsname, --
       g.mah, --上市许可持有人
       g.factname, --受托生产企业名称
       g.goodstype, --规格/型号
       --  g.approvedocno, --医疗器械注册证编号/备案编号
       b.lotid,
       h.lotno, --生产批号/序列号
       b.goodsqty, --数量
       g.tradepackname, --单位
       a.sourceid, --随货同行单号
       --  (select t.transclass from wms_goods_feature t where t.warehid=a.warehid and t.goodsid=b.goodsid) transcondition, --运输条件
       -- g.storagecondition, --贮存条件
       -- nvl(a.signdate, a.enddate) signdate, --到货时间
       decode(nvl(a.excarrier, 0), 0, 1, 2) selftranstype, --自外运标志 1-自运 2-外运
       a.excarrier, --承运单位名称
       a.dispatchid, --派车单ID
       i.vehicleid,
       i.vehicleno, --车牌号
       i.transmodel, --运输方式
       i.driverid,
       i.drivername, --运输人员
       a.trid,
       (select t2.startdate
          from tms_dispatch_dtl t2
         where t2.trid = a.trid
           and t2.usestatus <> 1
           and t2.dispatchid = i.dispatchid) startdate, --启运时间
       (select t2.enddate
          from tms_dispatch_dtl t2
         where t2.trid = a.trid
           and t2.usestatus <> 1
           and t2.dispatchid = i.dispatchid) enddate, --到达时间
       c.warehaddress

  from tms_tr_doc a,
       tms_luyan_tr_dtl b,
       tpl_warehouse c,
       tpl_goodsowner d,
       tpl_go_company e,
       wms_transport_address f,
       tpl_goods g,
       wms_goods_lot h,
       (select t1.realdispatchdate,
               t1.dispatchid,
               t1.vehicleid,
               t2.vehicleno,
               t1.driverid,
               t3.drivername,
               t1.transmodel
          from tms_dispatch_doc t1, tms_vehicle t2, tms_driver t3
         where t1.usestatus in (0, 4, 5) --派车单状态在途、运输完成、撤单
           and t1.vehicleid = t2.vehicleid(+)
           and t1.driverid = t3.driverid(+)
        union all
        select tt1.credate    realdispatchdate,
               tt1.dispatchid,
               tt1.vehicleid,
               nvl(tt2.vehicleno,tt1.vehicleno) vehicleno,
               tt1.driverid,
               nvl(tt3.drivername,tt1.drivername) drivername,
               26             transmodel
          from tms_luyan_dispatch_doc tt1, tms_vehicle tt2, tms_driver tt3
         where tt1.vehicleid = tt2.vehicleid(+)
           and tt1.driverid = tt3.driverid(+)) i
 where a.trid = b.trid
   and a.dispatchid = i.dispatchid
   and a.sourcetable = 1 --波次释放
   and a.comefrom = 1 --WMS转入
   and a.warehid = c.warehid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.gcompanyid = e.companyid(+)
   and a.transid = f.transid(+)
   and b.ownergoodsid = g.ownergoodsid(+)
   and b.lotid = h.lotid(+)
"
"ZX_710091_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710091_V"" (""ZXID"", ""EQUIPMENT_CATEGORY"", ""EQUIPMENT_NAME"", ""EQUIPMENT_SERIES"", ""VERIFICATION_CATEGORY"", ""VERIFICATION_TYPE"", ""TEMPERATURE_CONTROL_SETTING"", ""TEMPERATURE"", ""EQUIPMENT_SIZE"", ""EQUIPMENT_AREA"", ""EQUIPMENT_VOLUME"", ""VERIFICATION_START_TIME"", ""VERIFICATION_END_TIME"", ""REPORT_APPROVAL_TIME"", ""VERIFICATION_CONCLUSION"", ""VERIFICATION_VALIDITY"", ""VERIFICATION_UNIT"", ""EQUIPMENT_STATUS"", ""CHANGE_RECORD"", ""DEVICEOWNERUNIT"", ""PRECOOLING_DURATION_MINUTES"", ""TRANSPORT_DURATION_HOURS"", ""OPEN_COUNT"", ""OPEN_DURATION_MINUTES"", ""OPEN_INTERVAL_MINUTES"", ""REMARKS"") AS 
  select zxid,equipment_category,
equipment_name,
equipment_series,
verification_category,
verification_type,
temperature_control_setting,
temperature,
equipment_size,
equipment_area,
equipment_volume,
verification_start_time,
verification_end_time,
report_approval_time,
verification_conclusion,
verification_validity,
verification_unit,
equipment_status,
change_record,
--设备所属单位
DeviceOwnerUnit,
precooling_duration_minutes,
transport_duration_hours,
open_count,
open_duration_minutes,
open_interval_minutes,
remarks from
 zx_710091
"
"ZX_710092_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710092_V"" (""ZXID"", ""EQUIPMENT_NAME"", ""EQUIPMENT_ID"", ""SPECIFICATION_MODEL"", ""MANUFACTURER"", ""LOCATION"", ""VERIFICATION_TYPE"", ""CERTIFICATE_NUMBER"", ""CALIBRATION_DATE"", ""CONCLUSION"", ""CERTIFICATE_VALIDITY"", ""CATEGORY"", ""EQUIPMENT_STATUS"", ""DEVICEOWNERUNIT"", ""REMARKS"") AS 
  select zxid,equipment_name,
equipment_id,
specification_model,
manufacturer,
location,
verification_type,
certificate_number,
calibration_date,
conclusion,
certificate_validity,
category,
equipment_status,
--设备所属单位
DeviceOwnerUnit,
remarks from zx_710092 t
"
"ZX_710093_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710093_V"" (""CREDATE"", ""ZPTHDID"", ""THNO"", ""GOODSOWNERNAME"", ""CUSTOMER"", ""CUSTOMERADDRESS"", ""CONTACTS"", ""TELEPHONE"", ""CUSTOMERTYPE"", ""THADDRESS"", ""TEMPRANGE"", ""DELIVERYAREA"", ""DELIVERYLIMIT"", ""BOXNUMBER"", ""COMMONPACKS"", ""VEHICLEID"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DELIVERYMANID"", ""DELIVERYMAN"", ""PCFLAG"", ""PCMANID"", ""PCMAN"", ""PCDATE"", ""INPUTMANID"", ""INPUTMAN"", ""CHAINPACKS"") AS 
  select
   a.credate ,
   a.zpthdid ,
   a.thno ,
   a.goodsownername ,
   a.customer  ,
   a.customeraddress ,
   a.contacts ,
   a.telephone  ,
   a.customertype  ,
   a.thaddress,
   a.temprange ,
   a.deliveryarea  ,
   a.deliverylimit ,
   a.boxnumber ,
   a.commonpacks  ,
   a.vehicleid  ,
   c.vehicleno  ,
   a.driverid ,
   d.drivername  ,
   a.deliverymanid  ,
   e.employeename  deliveryman ,
   a.pcflag ,
   a.pcmanid ,
   f.employeename pcman,
   a.pcdate ,
   a.inputmanid ,
   g.employeename inputman,
   a.chainpacks

  from zx_710093 a,
       tms_vehicle  c,
       tms_driver d,
       pub_employee e,
       pub_employee f,
       pub_employee g


  where a.vehicleid = c.vehicleid(+)
    and a.driverid = d.driverid(+)
    and a.deliverymanid = e.employeeid(+)
    and a.pcmanid = f.employeeid(+)
    and a.inputmanid = g.employeeid(+)
"
"ZX_710095_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710095_DOC_V"" (""ZPSHDID"", ""CREDATE"", ""INPUTMANID"", ""INPUTMANNAME"", ""GOODSOWNERNAME"", ""GOODSOWNERCONTACTS"", ""GOODSOWNERPHONE"", ""THBOXNO"", ""THDATE"", ""COMMONPACKS"", ""CHAINPACKS"", ""FREEZEPACKS"", ""INTRANSMODE"", ""INVEHICLENO"", ""INDATE"", ""INMANID"", ""INMANNAME"", ""SHTEMP"", ""INFLAG"", ""CUSTOMER"", ""CUSCONTACTS"", ""CUSADDRESS"", ""CUSPHONE"", ""OUTDATE"", ""OUTMANID"", ""OUTMANNAME"", ""OUTFLAG"", ""OUTVEHICLEID"", ""VEHICLENO"", ""ROADNO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2"", ""PCFLAG"", ""PCMANID"", ""PCMANNAME"", ""PCDATE"", ""PCTYPE"", ""FCMANID"", ""FCMANNAME"", ""FCDATE"", ""FCFLAG"", ""STARTDATE"", ""ENDDATE"", ""STARTTEMP"", ""ENDTEMP"", ""MEMO"", ""SHBOXNO"", ""CUSTOMERTYPE"", ""BOXNUMBER"", ""DELIVERTYPE"", ""SHNO"") AS 
  select
   a.zpshdid,
   a.credate,
   a.inputmanid,
   b.employeename inputmanname,
   a.goodsownername,
   a.goodsownercontacts,
   a.goodsownerphone,
   a.thboxno,
   a.thdate,
   a.commonpacks,
   a.chainpacks,
   a.freezepacks,
   a.intransmode,
   a.invehicleno,
   a.indate,
   a.inmanid,
   c.employeename inmanname,
   a.shtemp,
   a.inflag,
   a.customer,
   a.cuscontacts,
   a.cusaddress,
   a.cusphone,
   a.outdate,
   a.outmanid,
   d.employeename outmanname,
   a.outflag,
   a.outvehicleid,
   e.vehicleno,
   a.roadno,
   a.driverid,
   f.drivername,
   a.driver2,
   a.pcflag,
   a.pcmanid,
   g.employeename pcmanname,
   a.pcdate,
   a.pctype,
   a.fcmanid,
   h.employeename fcmanname,
   a.fcdate,
   a.fcflag,
   a.startdate,
   a.enddate,
   a.starttemp,
   a.endtemp,
   a.memo,
   a.shboxno,
   a.customertype,
   a.boxnumber,
   a.delivertype,
   a.shno

from
    zx_710095_doc a,
    pub_employee b,
    pub_employee c,
    pub_employee d,
    tms_vehicle e,
    tms_driver f,
    pub_employee g,
    pub_employee h

where a.inputmanid = b.employeeid(+)
  and a.inmanid = c.employeeid(+)
  and a.outmanid = d.employeeid(+)
  and a.outvehicleid = e.vehicleid(+)
  and a.driverid = f.driverid(+)
  and a.pcmanid = g.employeeid(+)
  and a.pcmanid = h.employeeid(+)
"
"ZX_710095_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710095_DTL_V"" (""ZPSHDID"", ""ZPSHDDTLID"", ""GOODSNAME"", ""GOODSTYPE"", ""JX"", ""UNIT"", ""PACKS"", ""LOTNO"", ""TEMPRANGE"", ""DTLTHBOXNO"", ""DTLSHBOXNO"", ""DTLSTARTTEMP"", ""DTLENDTEMP"", ""DTLTHSIGNTEMP"") AS 
  select
   a.zpshdid,
   a.zpshddtlid,
   a.goodsname,
   a.goodstype,
   a.jx,
   a.unit,
   a.packs,
   a.lotno,
   a.temprange,
   a.dtlthboxno,
   a.dtlshboxno,
   a.dtlstarttemp,
   a.dtlendtemp,
   a.dtlthsigntemp


from zx_710095_dtl a
"
"ZX_710097_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710097_V"" (""OUTID"", ""WAVEDTLID"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""RECCOMPANYID"", ""RECCOMPANYNAME"", ""CREDATE"", ""GOODSID"", ""OWNERGOODSID"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""DISPATCHID"", ""PCCREDATE"", ""REALDISPATCHDATE"", ""PSTIME"") AS 
  select
     a.outid,
     a.wavedtlid,
     a.warehid,
     b.warehname,
     a.goodsownerid,
     c.goodsownername,
     a.reccompanyid,
     d.companyname reccompanyname,
     a.credate,
     e.goodsid,
     e.ownergoodsid,
     e.lotid,
     e.lotno,
     e.goodsqty,
     f.goodsname,
     f.goodstype,
     f.factname,
     h.dispatchid,
     h.credate pccredate,
     h.realdispatchdate,
     round(h.realdispatchdate - a.credate ,2)   pstime

  from
      wms_out_order      a,
      tpl_warehouse b,
      tpl_goodsowner c,
      tpl_go_company d,
      wms_out_order_dtl e,
      tpl_goods f,
      tms_tr_doc g,
      tms_dispatch_doc h


  where
      a.warehid in (2,14)
   and
      a.warehid = b.warehid
   and
      a.goodsownerid = c.goodsownerid
   and
      a.reccompanyid = d.companyid(+)
   and
      a.outid = e.outid
   and
      e.ownergoodsid = f.ownergoodsid
   and
      a.wavedtlid = g.sourceid(+)
   and
      g.dispatchid = h.dispatchid(+)
   and
      a.credate >to_date('20240101','yyyymmdd')
"
"ZX_710098_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710098_V"" (""DISPATCHID"", ""CREDATE"", ""USESTATUS"", ""REALDISPATCHDATE"", ""CHAINFLAG"", ""CHAINUSESTATUS"", ""DIFFQTY"", ""SELFTRANSTYPE"", ""TRCOMPANYNAME"", ""DRIVERNAME"", ""VEHICLENO"", ""VEHICLEID"", ""DRIVERID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYNAME"", ""INCEPTADDR"", ""COMPANYID"", ""SOURCEID"", ""CHAINSIGNDATE"", ""DEVNUM"", ""STARTDATE"", ""ENDDATE"", ""CARFLAG"", ""WAREHID"", ""TRID"") AS 
  select a.dispatchid,
       a.credate,
       a.usestatus,
       null realdispatchdate,
       b.chainflag,--  c.chainflag,
       nvl(b.chainusestatus,0) chainusestatus, --冷链回执标志
       null diffqty,--zx_tl_signdiff(c.trid) diffqty, --add by tl 20200616 回执签收差异
       null selftranstype,--a.selftranstype,
       a.trcompanyname, -- i.companyname,承运商
       a.drivername,  --d.drivername,
       a.vehicleno,--  e.vehicleno,
       a.vehicleid,
       a.driverid,
         -- b.tasktype,
       b.goodsownerid,-- c.goodsownerid,
       f.goodsownername,--  f.goodsownername,
       g.companyname,
       h.inceptaddr,--  h.inceptaddr,
       b.gcompanyid     companyid,--c.gcompanyid,
       b.sourceid,-- c.sourceid,
       b.chainsigndate,
       e.devnum,
       b.startdate,--by tl@20201228冷链启运时间
       b.enddate,
      null carflag,-- b.carflag, --210225冷链车保温箱标志
       a.warehid,
       b.trid
  from
       TMS_luyan_DISPATCH_DOC  a,
       tms_tr_doc b,
     --  TMS_LUYAN_TR_DOC_V1  b,
      -- tms_driver            d,
       tms_vehicle           e,
       tpl_goodsowner        f,
       tpl_go_company        g,
       wms_transport_address h
      -- tpl_pub_company       i

 where

      a.dispatchid = b.dispatchid
  and a.usestatus <> 0 --去掉作废状态
  and nvl(b.chainflag, 0) = 1
  and a.warehid in (2, 14)
  and b.trid=18175458
  and b.transid = h.transid(+)
  and b.goodsownerid = f.goodsownerid(+)
  and b.gcompanyid = g.companyid(+)
  and a.vehicleid = e.vehicleid(+)
"
"ZX_710100_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710100_V"" (""DISPATCHID"", ""CREDATE"", ""USESTATUS"", ""REALDISPATCHDATE"", ""CHAINFLAG"", ""CHAINUSESTATUS"", ""DIFFQTY"", ""SELFTRANSTYPE"", ""TRCOMPANYNAME"", ""DRIVERNAME"", ""VEHICLENO"", ""VEHICLEID"", ""DRIVERID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYNAME"", ""INCEPTADDR"", ""COMPANYID"", ""SOURCEID"", ""CHAINSIGNDATE"", ""DEVNUM"", ""STARTDATE"", ""ENDDATE"", ""CARFLAG"", ""WAREHID"", ""TRID"") AS 
  select a.dispatchid,
       a.credate,
       a.usestatus,
       null realdispatchdate,
       b.chainflag,--  c.chainflag,
       nvl(b.chainusestatus,0) chainusestatus, --冷链回执标志
       null diffqty,--zx_tl_signdiff(c.trid) diffqty, --add by tl 20200616 回执签收差异
       null selftranstype,--a.selftranstype,
       a.trcompanyname, -- i.companyname,承运商
       a.drivername,  --d.drivername,
       a.vehicleno,--  e.vehicleno,
       a.vehicleid,
       a.driverid,
         -- b.tasktype,
       b.goodsownerid,-- c.goodsownerid,
       f.goodsownername,--  f.goodsownername,
       g.companyname,
       h.inceptaddr,--  h.inceptaddr,
       b.gcompanyid     companyid,--c.gcompanyid,
       b.sourceid,-- c.sourceid,
       b.chainsigndate,
       e.devnum,
       b.startdate,--by tl@20201228冷链启运时间
       b.enddate,
      null carflag,-- b.carflag, --210225冷链车保温箱标志
       a.warehid,
       b.trid
  from
       TMS_luyan_DISPATCH_DOC  a,
       tms_tr_doc b,
     --  TMS_LUYAN_TR_DOC_V1  b,
      -- tms_driver            d,
       tms_vehicle           e,
       tpl_goodsowner        f,
       tpl_go_company        g,
       wms_transport_address h
      -- tpl_pub_company       i

 where

      a.dispatchid = b.dispatchid
  and a.usestatus <> 0 --去掉作废状态
  and nvl(b.chainflag, 0) = 1
  and a.warehid in (2, 14)
  and b.trid=18175458
  and b.transid = h.transid(+)
  and b.goodsownerid = f.goodsownerid(+)
  and b.gcompanyid = g.companyid(+)
  and a.vehicleid = e.vehicleid(+)
"
"ZX_710101_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710101_V"" (""DISPATCHID"", ""CREDATE"", ""USESTATUS"", ""CHAINFLAG"", ""CHAINUSESTATUS"", ""TRCOMPANYNAME"", ""DRIVERNAME"", ""VEHICLENO"", ""VEHICLEID"", ""DRIVERID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYNAME"", ""INCEPTADDR"", ""COMPANYID"", ""SOURCEID"", ""CHAINSIGNDATE"", ""DEVNUM"", ""STARTDATE"", ""ENDDATE"", ""WAREHID"", ""TRID"") AS 
  select a.dispatchid,
       a.credate,
       a.usestatus,
       --     null realdispatchdate,
       b.chainflag, --  c.chainflag,
       nvl(b.chainusestatus, 0) chainusestatus, --冷链回执标志
       --    0 diffqty,--zx_tl_signdiff(c.trid) diffqty, --add by tl 20200616 回执签收差异
       --    0 selftranstype,--a.selftranstype,
       a.trcompanyname, -- i.companyname,承运商
       a.drivername, --d.drivername,
       a.vehicleno, --  e.vehicleno,
       a.vehicleid,
       a.driverid,
       -- b.tasktype,
       b.goodsownerid, -- c.goodsownerid,
       f.goodsownername, --  f.goodsownername,
       g.companyname,
       h.inceptaddr, --  h.inceptaddr,
       b.gcompanyid     companyid, --c.gcompanyid,
       b.sourceid, -- c.sourceid,
       b.chainsigndate,
       e.devnum,
       b.startdate, --by tl@20201228冷链启运时间
       b.enddate,
       --    0 carflag,-- b.carflag, --210225冷链车保温箱标志
       a.warehid,
       b.trid
  from TMS_luyan_DISPATCH_DOC a,
       tms_tr_doc             b,
       tms_vehicle            e,
       tpl_goodsowner         f,
       tpl_go_company         g,
       wms_transport_address  h

 where

 a.dispatchid = b.dispatchid
 and a.usestatus <> 0 --去掉作废状态
 and nvl(b.chainflag, 0) = 1
 and a.warehid in (2, 14)
 --and b.trid = 18175458
 and b.transid = h.transid(+)
 and b.goodsownerid = f.goodsownerid(+)
 and b.gcompanyid = g.companyid(+)
 and a.vehicleid = e.vehicleid(+)
"
"ZX_710102_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710102_V"" (""DISPATCHID"", ""CREDATE"", ""USESTATUS"", ""DISPATCHDATE"", ""DISPATCHMAN"", ""COMPANYNAME"", ""DRIVERNAME"", ""TRANTYPE"", ""VEHICLENO"", ""TOTALPACKS"", ""TOTALCUBAGE"", ""ROUTEID"", ""ROUTENAME"", ""VEHICLEID"", ""DRIVERID"", ""TRCOMPANYID"", ""DISPATCHMANID"", ""WAREHNAME"", ""UPDOWNMAN"", ""WAREHID"", ""GOODSOWNERNAME"", ""DTLCOMPANYNAME"", ""INCEPTADDR"", ""TRANSID"", ""DTLUSESTATUS"", ""DISPATCHDTLID"", ""GOODSOWNERID"", ""GCOMPANYID"", ""TRID"", ""SOURCEID"", ""CHAINFLAG"", ""SPECIALCARFLAG"", ""TRANSRANGE"", ""DISTANCE"", ""LOAD"", ""VOLUMN"", ""MEMO"", ""ERPINPUTMAN"", ""ZYFLAG"", ""QXFLAG"", ""XGFLAG"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""TRCREDATE"", ""CDYY"", ""OUTMEMO"", ""DRIVER2ID"", ""DRIVER2NAME"", ""AMT"", ""DEPTNAME"") AS 
  select a.dispatchid,
       a.credate,
       a.usestatus,--e.usestatus,
       null dispatchdate,
       e.inputman  dispatchman,--e.dispatchman,
       e.companyname,
       e.drivername,

       --get_710026_trantype(car.memo,b.chainflag,a.specialcarflag,d.goodsownerid) as trantype, --fix by linjie 20171218
       get_710026_trantype(car.memo,e.chainflag,0,e.goodsownerid) as trantype, --无专车操作240314

       e.vehicleno,
       nvl(e.totalpacks,0) totalpacks,
       nvl(e.volume,0) totalcubage,
       routepos.routeid, --fix 改变取值视图，直接用地址取线路ID
       routepos.routename,
       e.vehicleid,
       e.driverid,
       null  trcompanyid, --a.trcompanyid,承运商ID
       e.inputmanid  dispatchmanid,--派车人ID
       e.warehname,
       null  updownman, --装卸工
       e.warehid,
       e.goodsownername,
       e.companyname dtlcompanyname,
       e.address  inceptaddr,--d.inceptaddr,
       e.transid,
       null  dtlusestatus,--b.usestatus dtlusestatus,
       null  dispatchdtlid,--b.dispatchdtlid,
       e.goodsownerid,
       e.companyid gcompanyid,--    d.gcompanyid,
       e.trid,
       e.sourceid,
       e.chainflag,--    nvl(b.chainflag,0) chainflag,

      -- case when d.goodsownerid in (178,8102,8103,8104,8105,8106,8107,8109,8110,8111,8112,8113,8114) then 1 else a.specialcarflag end as specialcarflag ,
       -- fix by linjie 2017-12-19
       null specialcarflag ,--专车标志不用了
       nvl(get_710026_rangedq(e.vehicleid,routepos.routeid),3)   transrange,
       --fix 2017-12-26 routeid取值，由b.routeid 改成routepos.routeid
       -- 20201224 改成从定义表里取
        routepos.distance,
        car.load,
        car.volumn,
        car.memo,
        /*decode(d.goodsownerid,3,
           (select
            zh_concat( distinct t3.employeename)
         from   wms_out_order  t1,
                lyerp.bms_sa_doc  t2,
                lyerp.pub_employee t3
          where d.sourceid = t1.wavedtlid(+)
            and t1.zxcolumn4 = to_char(t2.salesid)
            and t2.inputmanid = t3.employeeid),null)  erpinputman, --by tl 20180130  取ERP销售发货单总单制单人*/
        decode(e.goodsownerid,3,
                (select
                  zh_concat( distinct t1.salername)
                  from   wms_out_order  t1
                  where e.sourceid = t1.wavedtlid(+) )) erpinputman,   --by tl@210908取出库单上业务员

        (select  t1.zyflag  from tms_tr_doc_v  t1  where e.trid = t1.trid)  zyflag,
        (select  t1.qxflag  from tms_tr_doc_v  t1  where e.trid = t1.trid)  qxflag, --tl@200319中药,器械标志
        (select  t1.xgflag  from tms_tr_doc_v  t1  where e.trid = t1.trid)  xgflag, --tl@210224 710026

        td.province,   --210301
        td.city,
        td.district,
        e.CREDATE  trcredate,--8401填写日期
        null  cdyy ,    -- b.memo撤单原因
        e.memo outmemo ,--出库备注
        e.driver2id,
        e.driver2name,
        zx_tl_710026_amt(e.warehid,e.sourceid)  amt, --取出库订单细单金额
        (select
            distinct t2.deptname
           from wms_out_order t2
           where e.sourceid = t2.wavedtlid(+)) deptname --取出库单上业务部门tl@221026


       from

            /*Tms_dispatch_doc_v a,
            Tms_dispatch_dtl b,
           tms_driver  c ,
           tms_tr_doc_v d,*/
           tms_luyan_dispatch_doc_v1 a,
           tms_luyan_tr_doc_v1 e,
           wms_transport_address  td,  --210301
            (select cara.vehicleid,
       carb.vehicletypeid,
       carb.load,
       carb.volumn,
       carb.memo
        from Tms_vehicle_v cara,Tms_vehicle_type_v carb
       where
       cara.vehicletypeid=carb.VEHICLETYPEID
       and
       cara.warehid = 2) car,
       (select doc.routeid,
       doc.routename,
       dtl.transid,
       dtl.inceptaddr,
       dtl.distance
      from TMS_ROUTE_POS_V dtl, WMS_TR_ROUTE_v doc
      where doc.routeid = dtl.ROUTEID and doc.warehid=2
      ) routepos
       where

          /*  a.DISPATCHID=b.DISPATCHID(+)
          and a.driverid = c.driverid(+)*/
          a.dispatchid = e.dispatchid(+)
          and
           e.transid = routepos.transid(+)  --210301
          and e.transid = td.transid(+)
          and e.vehicleid=car.vehicleid(+)
          and e.warehid =2
          and a.usestatus = 1
          and a.credate >to_date('20241101','yyyymmdd')
"
"ZX_710104_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710104_V"" (""CREDATE"", ""DHDATE"", ""SHDATE"", ""OUTDATE"", ""OUTID"", ""RECCOMPANYID"", ""RECCOMPANYNAME"", ""INOUTID"", ""SOURCEID"", ""INID"", ""INDTLID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""LOTID"", ""LOTNO"", ""PACKNAME"", ""PACKSIZE"", ""GOODSPACKID"", ""GOODSTYPE"", ""GOODSSTATUS"", ""GOODSSTATUSID"", ""POSID"", ""POSNAME"", ""FACTID"", ""FACTORYNAME"", ""YSTJ"", ""GOODSCLASS"", ""MAH"") AS 
  select a.credate,--创建时间
       bb.dhdate,--到货时间
       bb.shdate,--收货时间
       ee.credate as outdate,--出库订单日期
       ee.outid,--出库订单ID
       ee.reccompanyid,--出库单位ID
       ee.reccompanyname,--出库单位
       a.inoutid,--出入库ID
       a.sourceid,--来源单据ID
       aa.inid,--入库订单
       bb.indtlid,--入库订单细单
       a.goodsownerid,--货主ID
       o.goodsownername,--货主
       a.warehid,--物流中心ID
       b.warehname,--物流中心名称
       a.ownergoodsid,--货主货品ID
       a.goodsid,--货品主档ID
       h.goodsownid,--货主原货品ID
       h.goodsname,--货品名称
       a.lotid,--批号ID
       e.lotno,--批号
       d.packname,--包装单位
       d.packsize,--包装大小
       a.goodspackid,--货品包装单位ID
       h.goodstype,--规格
       g.goodsstatus,--货品状态
       a.goodsstatusid,--货品状态ID
       f.posid,--货位编号
       f.posname,--货位名称
       c.factid,--厂家
       l.companyname factoryname,--厂家名称
       cc.transclass as ystj,--运输条件
       dd.goodsclass, --wms货品分类
       e.mah--上市持有人
From   wms_st_io_doc        a,
       tpl_warehouse        b,
       tpl_pub_goods        c,
       tpl_pub_goods_packs  d,
       wms_goods_lot        e,
       tpl_goods            h,
       wms_goodsstatus      g,
       wms_pos_def          f,
       tpl_pub_company      l,
       tpl_goodsowner       o,
       wms_receive_dtl      t4,
       wms_in_order         aa,
       wms_in_order_dtl     bb,
       (select cc.transclass,cc.goodsid,cc.warehid
                 from wms_goods_feature cc where cc.warehid = 2) cc,
       wms_goods_feature dd,
       (select distinct b.lotno,b.lotid,a.outid,a.reccompanyid,c.companyname reccompanyname,trunc(a.credate) credate
          From wms_out_order a, wms_out_order_dtl b,tpl_go_company  c
         where a.outid = b.outid
          AND a.reccompanyid = c.companyid(+)
           and a.warehid = 2
           and extract(year from a.credate) >= extract(year from sysdate) -1
           --AND credate BETWEEN TRUNC(SYSDATE-1) AND TRUNC(SYSDATE-1) + INTERVAL '1'
         --DAY - INTERVAL '1' SECOND
         )ee
where a.warehid = b.warehid(+)
   and a.goodsid = c.goodsid(+)
   and c.factid = l.companyid(+)
   and a.goodspackid = d.goodspackid(+)
   and a.lotid = e.lotid(+)
   and a.posid = f.posid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.ownergoodsid = h.ownergoodsid(+)
   and a.goodsownerid = o.goodsownerid(+)
   and a.sourceid = t4.receiveid(+)
   and t4.indtlid = bb.indtlid(+)
   and a.warehid = aa.warehid
   and bb.inid = aa.inid
   and a.warehid = 2
   and a.comefrom = 1
   and extract(year from a.credate) >= extract(year from sysdate)-5
   and bb.goodsid = cc.goodsid(+)
   and aa.warehid = cc.warehid
   and cc.transclass in(2,3)--冷藏，冷冻
   and aa.warehid = dd.warehid
   and bb.goodsid = dd.goodsid
   and ee.lotid = t4.lotid
   and e.lotid = ee.lotid
   and dd.goodsclass = 10 --冷藏药品
   and f.posno like '2A-10%'
   --and ee.outid = 12032869
   order by a.ownergoodsid,e.lotno,a.credate,f.posid
"
"ZX_710105_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710105_V"" (""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DEPTNAME"", ""PROVINCE"", ""CITY"", ""DISTRICT"", ""COMPANYCLASS"", ""WD"", ""DRIVERNAME"", ""VEHICLENO"", ""WHOLEPACKS"", ""SCATTERPACKS"", ""TOTALPACKS"") AS 
  select aa.credate,
       aa.warehid,
       aa.warehname,
       aa.goodsownerid,
       aa.goodsownername,
       (case
         when nvl(aa.salername, '9999') in ('黄炎镐', '林菲菲') and
              aa.goodsownerid = 3 then
          '本部'
         when nvl(aa.salername, '9999') not in ('黄炎镐', '林菲菲') and
              aa.goodsownerid = 3 then
          '集采'
         else
          null
       end) deptname, --二级货主-货主部门
       aa.province,
       aa.city,
       aa.district,
       aa.companyclass,
       aa.wd,
       aa.drivername,
       aa.vehicleno,
       sum(aa.wholepacks) wholepacks,
       sum(aa.scatterpacks) scatterpacks,
       sum(aa.totalpacks) totalpacks
  from (select trunc(a.credate) credate,
               a.warehid,
               b.warehname,
               a.goodsownerid,
               c.goodsownername,
               d.province,
               d.city,
               d.district,
               e.companyclass,
               decode(a.chainflag, 1, '冷链', '常温') wd,
               f.drivername,
               f.vehicleno,
               a.wholepacks,
               a.scatterpacks,
               a.totalpacks,
               (select max(tt.salername)
                  from wms_out_order tt
                 where tt.warehid = a.warehid
                   and tt.goodsownerid = a.goodsownerid
                   and tt.wavedtlid = a.sourceid) salername
          from tms_tr_doc a,
               tpl_warehouse b,
               tpl_goodsowner c,
               wms_transport_address d,
               tpl_go_company e,
               /*(select t1.dispatchid, t2.drivername
                  from tms_dispatch_doc t1, tms_driver t2
                 where t1.driverid = t2.driverid
                   and t1.usestatus <> 0) f,
               (select t3.dispatchid, t4.vehicleno
                  from tms_dispatch_doc t3, tms_vehicle t4
                 where t3.vehicleid = t4.vehicleid
                   and t3.usestatus <> 0) g*/
               tms_luyan_dispatch_doc f

         where a.warehid = b.warehid

           and a.goodsownerid = c.goodsownerid

           and a.transid = d.transid(+)

           and a.gcompanyid = e.companyid

           and a.warehid in (2, 14)

           and a.dispatchid = f.dispatchid

           and f.usestatus=1

           and a.credate > to_date('20241201', 'yyyymmdd')) aa


 group by aa.credate,
          aa.warehid,
          aa.warehname,
          aa.goodsownerid,
          aa.goodsownername,
          (case
            when nvl(aa.salername, '9999') in ('黄炎镐', '林菲菲') and
                 aa.goodsownerid = 3 then
             '本部'
            when nvl(aa.salername, '9999') not in ('黄炎镐', '林菲菲') and
                 aa.goodsownerid = 3 then
             '集采'
            else
             null
          end), aa.province,
          aa.city,
          aa.district,
          aa.companyclass,
          aa.wd,
          aa.drivername,
          aa.vehicleno

/*select

   trunc(a.credate)  credate ,
   a.warehid  ,
   b.warehname  ,
   a.goodsownerid  ,
   c.goodsownername  ,
   d.province ,
   d.city ,
   d.district ,
   e.companyclass ,
   decode(a.chainflag,1,'冷链','常温') wd ,
   f.drivername,
   g.vehicleno,

   sum( a.wholepacks) wholepacks ,
    sum( a.scatterpacks)  scatterpacks ,
    sum(a.totalpacks ) totalpacks

from tms_tr_doc a ,
     tpl_warehouse b,
     tpl_goodsowner c,
     wms_transport_address d,
     tpl_go_company e,
     (select
           t1.dispatchid,
           t2.drivername
      from  tms_dispatch_doc t1,
            tms_driver t2
      where t1.driverid = t2.driverid
          and t1.usestatus<>0) f,
       (select
           t3.dispatchid,
           t4.vehicleno
      from  tms_dispatch_doc t3,
            tms_vehicle t4
      where t3.vehicleid = t4.vehicleid
          and t3.usestatus<>0) g,
      select * from wms_out_order a where a.


where   a.warehid = b.warehid

and     a.goodsownerid = c.goodsownerid

and   a.transid = d.transid(+)

and a.gcompanyid = e.companyid

and a.warehid in (2,14)

and a.dispatchid = f.dispatchid(+)

and a.dispatchid = g.dispatchid(+)

and a.credate> to_date('20201201','yyyymmdd')
\*and a.credate between to_date('20211101','yyyymmdd')  and to_date('20211102','yyyymmdd')

and a.goodsownerid=264*\

group by
   trunc( a.credate) ,
   a.warehid  ,
   b.warehname  ,
   a.goodsownerid  ,
   c.goodsownername  ,
   d.province ,
   d.city ,
   d.district ,
   e.companyclass ,
   decode(a.chainflag,1,'冷链','常温') ,
   f.drivername,
   g.vehicleno;*/
"
"ZX_710106_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710106_V"" (""DISPATCHID"", ""CREDATE"", ""USESTATUS"", ""TRCOMPANYNAME"", ""DRIVERNAME"", ""VEHICLENO"", ""VEHICLEID"", ""DRIVERID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYNAME"", ""INCEPTADDR"", ""COMPANYID"", ""SOURCEID"", ""WAREHID"", ""TRID"", ""WAREHNAME"", ""TASKTYPE"", ""OPERATIONTYPE"", ""HZFLAG"", ""HZDATE"", ""HZMANID"", ""HZMANNAME"") AS 
  select a.dispatchid,
       a.credate,
       a.usestatus,
       a.trcompanyname, -- i.companyname,承运商
       a.drivername,
       a.vehicleno,
       a.vehicleid,
       a.driverid,
       -- b.tasktype,
       b.goodsownerid,
       f.goodsownername,
       g.companyname,
       h.inceptaddr,
       b.gcompanyid     companyid,
       b.sourceid,
       a.warehid,
       b.trid,
       i.warehname,
       b.tasktype,
       b.operationtype,
       b.hzflag,
       b.hzdate,
       b.hzmanid,
       j.employeename hzmanname

  from TMS_luyan_DISPATCH_DOC a,
       tms_tr_doc             b,
       tms_vehicle            e,
       tpl_goodsowner         f,
       tpl_go_company         g,
       wms_transport_address  h,
       tpl_warehouse i,
       pub_employee j

 where

 a.dispatchid = b.dispatchid
 and a.usestatus <> 0 --去掉作废状态
 and a.warehid in (2, 14)
 --and b.trid = 18175458
 and b.transid = h.transid(+)
 and b.goodsownerid = f.goodsownerid(+)
 and b.gcompanyid = g.companyid(+)
 and a.vehicleid = e.vehicleid(+)
 and a.warehid = i.warehid(+)
 and b.hzmanid = j.employeeid(+)
 and a.credate > to_date('20241201','yyyymmdd')
"
"ZX_710107_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710107_V"" (""TRID"", ""WAREHID"", ""WAREHNAME"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""TRANSID"", ""SCATTERPACKS"", ""WHOLEPACKS"", ""TOTALPACKS"", ""COMEFROM"", ""SOURCEID"", ""SIGNFLAG"", ""SIGNDATE"", ""DISPATCHID"", ""DISPATCHDATE"", ""ADDRESS"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""UPDOWNMAN"", ""VEHICLEID"") AS 
  select t.TRID,
       t.WAREHID,
       a.warehname,
       t.CREDATE,
    --   i.ddlname        OPERATIONTYPE,
       t.GOODSOWNERID,
       b.goodsownername,
       t.gcompanyid     companyid,
       c.companyname,
     --  t.ROUTEID,
     --  d.routename,
       t.TRANSID,
       --nvl(t.SCATTERPACKS,0) SCATTERPACKS,
       decode(t.comefrom,
              1,
              zx_get_boxno(t.sourceid),
              nvl(t.scatterpacks, 0)) scatterpacks,
       --nvl(t.WHOLEPACKS,0) WHOLEPACKS,
       decode(t.comefrom,
              1,
              zx_get_wholeqty(t.sourceid),
              nvl(t.wholepacks, 0)) wholepacks,
       --nvl(t.TOTALPACKS,0) TOTALPACKS,
       decode(t.comefrom,
              1,
              zx_get_boxno(t.sourceid) + zx_get_wholeqty(t.sourceid),
              nvl(t.totalpacks, 0)) totalpacks,
      -- t.VOLUME,
     --  t.WEIGHT,
       --decode(t.COMEFROM,2,1,t.comefrom) comefrom,
       t.comefrom,
       to_char(t.SOURCEID) SOURCEID,
       nvl(t.SIGNFLAG, 0) signflag,
       t.SIGNDATE,
       t.DISPATCHID,
       t.dispatchdate,
        --decode(e.address,null,e.inceptaddr,e.address) address,
       (case
         when substr(e.inceptaddr, 1, 1) = '*' or e.address is null then
          e.inceptaddr
         else
          e.address
       end) address,
       j.vehicleno,
       j.driverid,
       j.drivername,
       j.driver2id,
       j.driver2name,
       j.updownman,
     --  zx_pf_print_transinvo(t.sourceid) billno,
       j.vehicleid  ---tl@250109车辆ID
  from tms_tr_doc               t,
       tpl_warehouse            a,
       tpl_goodsowner           b,
       tpl_go_company           c,
       wms_tr_route             d,
       wms_transport_address    e,
       pub_employee             f,
   --    sys_ddl_dtl              i,
       tms_luyan_dispatch_doc j
 where t.warehid = a.warehid(+)
   and t.goodsownerid = b.goodsownerid(+)
   and t.gcompanyid = c.companyid(+)
   and t.routeid = d.routeid(+)
   and t.transid = e.transid(+)
   and nvl(t.createmanid, 0) = f.employeeid(+)
  -- and i.sysid(+) = 389
  -- and t.operationtype = i.ddlid(+)
   and t.usestatus in (2, 5) --确定和派出状态的运输任务单
   and t.comefrom in (1, 2) --wms转入的运输任务单/手工录入
   and t.dispatchid = j.dispatchid
   and t.warehid in (2,14)
   and j.credate >to_date('20241201','yyyymmdd')
"
"ZX_710108_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_710108_V"" (""WAVEDTLID"", ""OUTID"", ""OUTDTLID"", ""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""RECCOMPANYID"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""USESTATUS"", ""EXPORTMEMO"", ""ZXCOLUMN4"", ""DTLZXCOLUMN4"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""FACTNAME"", ""PRODAREA"", ""TRADEPACKNAME"", ""DRUGFORM"", ""APPROVEDOCNO"", ""MAH"", ""GOODSQTY"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""PRODLICENSENO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""PRICE"", ""AMT"", ""BUYINGPRICE"", ""BUYINGAMT"") AS 
  select a.wavedtlid,
       a.outid,
       b.outdtlid,
       a.credate,
       a.warehid,
       d.warehname,
       a.goodsownerid,
       e.goodsownername,
       a.reccompanyid,
       f.companyname,
       a.operationtype,
       a.usestatus,
       a.exportmemo,
       a.zxcolumn4,
       b.dtlzxcolumn4,
       b.ownergoodsid,
       b.goodsid,
       g.goodsownid,
       g.goodsname,
       g.goodsengname,
       g.goodstype,
       g.factname,
       g.prodarea,
       g.tradepackname,
       g.drugform,
       g.approvedocno,
       g.mah,
       b.goodsqty,
       b.lotid,
       j.lotno,
       j.validdate,
       j.proddate,
       j.prodlicenseno,
       b.goodsstatusid,
       i.goodsstatus,
       b.goodspackid,
       h.packname,
       h.packsize,
       b.price,
       b.amt,
       b.buyingprice,
       b.buyingprice * b.goodsqty buyingamt
  from wms_out_order       a,
       wms_out_order_dtl   b,
       tpl_warehouse       d,
       tpl_goodsowner      e,
       tpl_go_company      f,
       tpl_goods           g,
       tpl_pub_goods_packs h,
       wms_goodsstatus     i,
       wms_goods_lot       j
 where a.outid = b.outid
   and a.warehid = d.warehid(+)
   and a.goodsownerid = e.goodsownerid(+)
   and a.reccompanyid = f.companyid(+)
   and b.ownergoodsid = g.ownergoodsid(+)
   and b.goodspackid = h.goodspackid(+)
   and b.goodsstatusid = i.goodsstatusid(+)
   and b.lotid = j.lotid(+)
   and a.warehid in (2,19,20)
   and a.usestatus <> 0
"
"ZX_730002_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_730002_V"" (""BEGINDATE"", ""FROMADDRESS"", ""TOADDRESS"", ""LLYS"", ""TLYS"", ""HGYS"", ""CYR"", ""SOURCEID"", ""CREDATE"", ""COMPANYNAME"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""TRADEGOODSPACK"", ""GOODSQTY"", ""PRICE"", ""LYDTLZXCOLUMN3"", ""AMT"", ""INVOICENO"", ""DISPATCHID"", ""VEHICLEID"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""TRID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSOWNID"", ""GOODSID"", ""DEPTNAME"") AS 
  select c.realdispatchdate begindate,
       '四川' fromaddress,
       o.city toaddress,
       '1' llys,
       null tlys,
       null hgys,
       null cyr,
       a.sourceid,
       g.credate,
       h.companyname,
       j.goodsname,
       j.goodstype,
       j.factname,
       i.tradegoodspack,
       i.goodsqty,
       i.price,
       i.lydtlzxcolumn3,
       i.amt,
       i.invoiceno,
       c.dispatchid,
       c.vehicleid,
       k.vehicleno,
       c.driverid,
       e.drivername,
       c.driver2id,
       p.drivername driver2name,
       a.trid,
       a.goodsownerid,
       m.goodsownername,
       a.warehid,
       n.warehname,
       i.ownergoodsid,
       j.goodsownid,
       i.goodsid,
       f.deptname

  from TMS_TR_DOC        a,
       tms_dispatch_dtl  b,
       tms_dispatch_doc  c,
       tms_driver        e,
       wms_out_order     f,
       tpl_export_order  g,
       tpl_go_company    h,
       wms_out_order_dtl i,
       tpl_goods         j,
       tms_vehicle       k,
       tms_driver        p,
       tpl_goodsowner    m,
       tpl_warehouse     n,
       wms_transport_address o
 where a.trid = b.trid
   and b.dispatchid = c.dispatchid
   and c.driverid = e.driverid(+)
   and a.sourceid = f.wavedtlid
   and f.oldid = g.exporderid
   and g.reccompanyid = h.companyid(+)
   and f.outid = i.outid
   and i.ownergoodsid = j.ownergoodsid(+)
   and c.vehicleid = k.vehicleid(+)
   and c.driver2id = p.driverid(+)
   and a.goodsownerid = m.goodsownerid(+)
   and a.warehid = n.warehid(+)
   and a.transid=o.transid(+)
   and a.warehid = 17

union all

select c.printdate,
       '四川',
       o.city,
       '1',
       null,
       null,
       null,
       a.sourceid,
       g.credate,
       h.companyname,
       j.goodsname,
       j.goodstype,
       j.factname,
       i.tradegoodspack,
       i.goodsqty,
       i.price,
       i.lydtlzxcolumn3,
       i.amt,
       i.invoiceno,
       c.dispatchid,
       c.vehicleid,
       k.vehicleno,
       c.driverid,
       e.drivername,
       c.driver2id,
       p.drivername driver2name,
       a.trid,
       a.goodsownerid,
       m.goodsownername,
       a.warehid,
       n.warehname,
       i.ownergoodsid,
       j.goodsownid,
       i.goodsid,
       f.deptname

  from TMS_TR_DOC             a,
       TMS_luyan_DISPATCH_DOC c,
       tms_driver             e,
       wms_out_order          f,
       tpl_export_order       g,
       tpl_go_company         h,
       wms_out_order_dtl      i,
       tpl_goods              j,
       tms_vehicle            k,
       tms_driver             p,
       tpl_goodsowner         m,
       tpl_warehouse          n,
       wms_transport_address  o
 where a.dispatchid = c.dispatchid
   and c.driverid = e.driverid(+)
   and a.sourceid = f.wavedtlid
   and f.oldid = g.exporderid
   and g.reccompanyid = h.companyid(+)
   and f.outid = i.outid
   and i.ownergoodsid = j.ownergoodsid(+)
   and c.vehicleid = k.vehicleid(+)
   and c.driver2id = p.driverid(+)
   and a.goodsownerid = m.goodsownerid(+)
   and a.warehid = n.warehid(+)
   and a.transid=o.transid(+)
   and a.warehid = 17
"
"ZX_740001_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_740001_V"" (""CHECKID"", ""CHECKDATE"", ""OPERATIONTYPE"", ""EMPLOYEENAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""DRUGFORM"", ""FACTNAME"", ""PRODAREA"", ""GOODSQTY"", ""SHQTY"", ""TRADEPACKNAME"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""EXPDATE"", ""MAH"", ""APPROVEDOCNO"", ""COMPANYID"", ""COMPANYNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""WAREHID"", ""WAREHNAME"", ""SUPPLYERADDRESS"", ""SUPPLYERCONNPHONE"") AS 
  select a.checkid, --验收单ID
       a.checkdate, --验收时间
       a.operationtype, --业务类型
       d.employeename, --验收员
       a.ownergoodsid, --货主货品ID
       a.goodsid, --货品主档ID
       k.goodsownid, --货主原货品ID
       k.goodsname, --货品名称
       k.goodsengname, --商品名
       k.goodstype, --货品规格
       k.drugform, --剂型
       k.factname, --生产厂家
       k.prodarea, --产地
       a.goodsqty, --货品数量
       a.goodsqty shqty,
       k.tradepackname,--单位
       a.goodsstatusid, --货品状态ID
       a.goodsstatus, --货品状态
       a.lotid, --批号ID
       h.lotno,--批号
       h.proddate, --生产日期
       decode(h.printmonthflag,
              1,
              to_char(h.validdate, 'yyyy-mm'),
              to_char(h.validdate, 'yyyy-mm-dd')) validdate,--有效期
       decode(h.printexpireflag,
              1,
              to_char(h.validdate, 'yyyy-mm'),
              to_char(h.validdate, 'yyyy-mm-dd')) expdate,--失效期
       h.mah,
       h.approvedocno, --批准文号
       a.companyid, --单位ID
       g.companyname, --单位名称
       a.goodsownerid, --货主ID
       e.goodsownername, --货主名称
       a.warehid, --物流中心ID
       o.warehname, --物流中心
       g.supplyeraddress,
       g.supplyerconnphone
  from gsp_physic_quality_check_v a, --货品质量验收记录
       pub_employee             d, --验收员
       tpl_goodsowner           e, --货主
       tpl_go_company           g, --货主单位
       tpl_goods                k, --货主货品
       tpl_warehouse            o, --物流中心
       wms_goods_lot            h, --批号表
       wms_goodsstatus          m --货品状态
 where a.inputmanid = d.employeeid(+) --inputmanid：录入人ID
   and a.goodsownerid = e.goodsownerid
   and a.companyid = g.companyid(+) --companyid：供应商ID
   and a.ownergoodsid = k.ownergoodsid(+)
   and a.warehid = o.warehid
   and a.lotid = h.lotid(+)
   and a.operationtype=1 --只查询进货业务类型
   and a.goodsstatusid = m.goodsstatusid(+)
   and a.warehid = 13
"
"ZX_740002_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_740002_V"" (""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""GCOMPANYID"", ""COMPANYNAME"", ""COMPANYSTYLE"", ""SUPPLYERADDRESS"", ""SUPPLYERCONNPHONE"") AS 
  select a.goodsownerid, --货主ID
       b.goodsownername, --货主名称
       a.companyid,--供应商ID（货主单位ID）
       a.gcompanyid,--ERP供应商ID（货主原单位ID）
       a.companyname,--供应商名称
       a.companystyle,--单位类型
       a.supplyeraddress,--供货者地址
       a.supplyerconnphone--供货者联系电话
  from tpl_go_company a,tpl_goodsowner b
 where a.goodsownerid = b.goodsownerid
   and a.goodsownerid in (224,666,528)
   and a.companystyle in (2)
"
"ZX_800002_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_800002_V"" (""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CREDATE"", ""RECCOMPANYID"", ""RECEIVEHEAD"", ""ZXCOLUMN4"") AS 
  select a.goodsownerid,
       d.goodsownername,
       a.credate,
       a.reccompanyid,
       a.receivehead,
       a.zxcolumn4
  from GTOE_EXPORT_ORDER a, Tpl_goodsowner d
 where a.goodsownerid = d.goodsownerid
   and not exists (select 1
          from Tpl_go_company b, Tpl_pub_company c
         where a.reccompanyid = b.gcompanyid
           and a.goodsownerid = b.goodsownerid
           and b.warecid = c.companyid
           and b.usestatus = 1)
union
select a.goodsownerid,
       d.goodsownername,
       a.credate,
       a.reccompanyid,
       a.receivehead,
       a.zxcolumn4
  from GTOE_EXPORT_ORDER a, Tpl_goodsowner d
 where a.goodsownerid = d.goodsownerid
   and a.operationtype = 11
   and not exists (select 1
          from Tpl_go_company b, Tpl_pub_company c
         where a.reccompanyid = b.gcompanyid
           and a.goodsownerid = b.goodsownerid
           and b.warecid = c.companyid
           and b.usestatus = 1
           and b.companystyle = 1)
"
"ZX_800003_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_800003_V"" (""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSFORMALNAME"", ""GOODSPINYIN"", ""GOODSQTYPE"", ""DICTNO"", ""CREDATE"", ""INPUTMANID"", ""MEMO"", ""BARCODE"", ""POISON_DRUG"", ""GOODSTYPE"", ""CLASSID"", ""CLASSNAME"", ""FACTID"", ""PRODAREA"", ""REGISTNO"", ""APPROVEDOCNO"", ""GMPFLAG"", ""UNIFYNO"", ""DRUGFORM"", ""L_PERIOD"", ""S_PERIODUNIT"", ""MANOPCODE"", ""EMPLOYEENAME"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""REPTYPE"", ""STORAGETYPE"", ""JKHZFLAG"", ""GOODSPY"", ""GOODSTYPEID"", ""TPRICEGTYPE"", ""SPECIALFLAG"", ""SIGNATURE"", ""FILEGROUPID"", ""ALONEPACKFLAG"", ""ZXCOL01"", ""TRADEPACK"", ""GOODSTEMPERATURE"", ""MAH"", ""XGFLAG"") AS 
  select a.goodsid,
       a.opcode,
       a.goodsname,
       a.goodsengname,
       a.goodsformalname,
       a.goodspinyin,
       a.goodsqtype,
       a.dictno,
       a.credate,
       a.inputmanid,
       a.memo,
       a.barcode,
       a.poison_drug,
       a.goodstype,
       a.classid,
       f.classname,
       a.factid,
       a.prodarea,
       a.registno,
       a.approvedocno,
       a.gmpflag,
       a.unifyno,
       a.drugform,
       a.l_period,
       a.s_periodunit,
       b.opcode manopcode,
       b.employeename,
       c.companyopcode,
       c.companyname,
       a.reptype,
       a.storagetype,
       a.jkhzflag,
       a.goodspy,
       a.goodstypeid,
       e.goodstypename tpricegtype,
       a.specialflag,
       a.signature,
       a.filegroupid,
       a.alonepackflag,
       g.zxcol01,
       a.tradepack ,-- add by guzhiqi
       a.goodstemperature,   --tl 货品温度要求,用于打印冷藏药品运输交接单中的""温度控制'  170605
       a.mah , --add by xyue 2019-08-21 上市许可持有人
       a.xgflag --tl@210224 710022
  from tpl_pub_goods     a,
       pub_employee      b,
       tpl_pub_company   c,
       tprice_goods_type e,
       tpl_pub_goods_class f,
       lyzx_Tprice_goods g
 where a.inputmanid = b.employeeid(+)
   and a.factid = c.companyid(+)
   AND a.goodstypeid = e.goodstypeid(+)
   and a.classid = f.classid(+)
   and a.goodsid = g.goodsid(+)
   and a.goodsid > 100000000
"
"ZX_800004_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_800004_V"" (""OWNERGOODSID"", ""GOODSSTATUS"", ""OPCODE"", ""GOODSOWNERID"", ""GOODSNO"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSFORMALNAME"", ""GOODSTYPE"", ""CREDATE"", ""PRODAREA"", ""MEMO"", ""BARCODE"", ""ALLOWINDAYS"", ""ALLOWOUTDAYS"", ""PASTEFLAG"", ""WHOLESALEPRICE"", ""RESALEPRICE"", ""SAFESTOCK"", ""PURCHASETAX"", ""SALETAX"", ""ALARMDAYS"", ""POISON_DRUG"", ""GOPCODE"", ""TRADEPACKID"", ""TRADEPACKNAME"", ""OUTPACKID"", ""OUTPACKNAME"", ""FACTNAME"", ""ADDMEDCHECKFLAG"", ""LOTFLAG"", ""BATCHFLAG"", ""COMEFLAG"", ""WAREGOODSID"", ""GOODSOWNID"", ""DRUGFORM"", ""PACKSIZE"", ""EM_GOODS_FLAG"", ""EM_GOODS_REASON"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""WAREGOODSOPCODE"", ""WAREGOODSNAME"", ""MAINTRADNAME"", ""MAINOUTNAME"", ""ALLNAME"", ""WPACKSIZE"", ""TRADEMARK"", ""STORAGECONDITION"", ""CLASSID"", ""APPROVEDOCNO"", ""BOXNOFLAG"", ""QTYGENE"", ""GOODSPY"", ""REPFLAG"", ""STORAGETYPE"", ""USESTATUS"", ""DBCHECK"", ""PUBPOISON_DRUG"", ""JKHZFLAG"", ""GMPFLAG"", ""L_PERIOD"", ""S_PERIODUNIT"", ""REGISTDOCNO"", ""DICTNO"", ""REPTYPE"", ""FACTID"", ""VARIETYNAME"", ""VARIETYNO"", ""SUPPLYERNAME"", ""VARIETYDESCID"", ""ECODEFLAG"", ""PRODLICENSENO"", ""PACKSEQFLAG"", ""DBPICKFLAG"", ""DBINCHECK"", ""TRADEPACKSIZE"", ""FIRSTSALEFLAG"", ""FIRSTINDATE"", ""ALONEPACKFLAG"", ""PRODUCTAPPROVAL"", ""GMPINVALIDDATE"", ""SERVICERATE"", ""SERVICEUNITPRICE"", ""MINTEMP"", ""MAXTEMP"", ""SERSTARTDATE"", ""SERENDDATE"", ""MJYSFLAG"", ""SEQFLAG"", ""MAH"", ""UDI_CODE"", ""UDI_FLAG"", ""UDI_PARSER_RULE_ID"", ""RULENAME"", ""RULECODE"") AS 
  select a.ownergoodsid,
       a.goodsstatus,
       a.opcode,
       a.goodsownerid,
       a.goodsno,
       a.goodsname,
       a.goodsengname,
       a.goodsformalname,
       a.goodstype,
       a.credate,
       a.prodarea,
       a.memo,
       a.barcode,
       a.allowindays,
       a.allowoutdays,
       a.pasteflag,
       a.wholesaleprice,
       a.resaleprice,
       a.safestock,
       a.purchasetax,
       a.saletax,
       a.alarmdays,
       a.poison_drug,
       a.gopcode,
       a.tradepackid,
       a.tradepackname,
       a.outpackid,
       a.outpackname,
       a.factname,
       a.addmedcheckflag,
       a.lotflag,
       a.batchflag,
       a.comeflag,
       a.waregoodsid,
       a.goodsownid,
       a.drugform,
       a.packsize,
       nvl(a.em_goods_flag, 0) em_goods_flag,
       a.em_goods_reason,
       b.goodsownername,
       b.goopcode,
       c.opcode waregoodsopcode,
       c.goodsname waregoodsname,
       d.packname maintradname,
       e.packname mainoutname,
       nvl(a.goodsname, '') || nvl(a.goodsengname, '') ||
       nvl(a.goodsformalname, '') allname,
       e.packsize as wpacksize,
       a.TRADEMARK,
       a.STORAGECONDITION,
       c.classid,
       a.approvedocno,
       a.BoxNoFlag,
       a.QtyGene,
       a.Goodspy,
       a.repflag,
       a.storagetype,
       a.usestatus,
       a.dbcheck,
       c.poison_drug pubpoison_drug,
       c.jkhzflag,
       c.gmpflag,
       c.l_period,
       c.s_periodunit,
       a.registdocno,
       c.dictno,
       c.reptype,
       c.factid,
       a.varietyname,
       a.varietyno,
       a.supplyername,
       a.varietydescid,
       a.ecodeflag,
       a.prodlicenseno,
       a.packseqflag,
       a.dbpickflag,
       a.dbincheck,
       a.tradepacksize,
       a.firstsaleflag,
       a.firstindate,
       a.alonepackflag,
       a.productapproval,--产品批件有效期至 add by wanghuaiyu 20130617
       a.gmpinvaliddate,--GMP证书有效期至 add by wanghuaiyu 20130617
       a.servicerate ,--中宏疫苗货主计算服务费（按金额百分比） by tl@180403
       a.serviceunitprice,  --中宏疫苗货主计算服务费（按数量的单价） by tl@180403
       a.mintemp,--TMS冷链监控温度范围最低温度 add by xyue 2018-07-30
       a.maxtemp,--TMS冷链监控温度范围最高温度 add by xyue 2018-07-30
       a.serstartdate,--中宏计算服务费开始时间 add by tl@181213
       a.serenddate, --中宏计算服务费结束时间 add by tl@181213
       a.mjysflag,
       a.seqflag,
       a.mah, --add by xyue 2019-08-21 上市许可持有人
       a.udi_code,
       a.udi_flag,
       a.udi_parser_rule_id,
       f.rulename,
       f.rulecode
  from tpl_goods           a,
       tpl_goodsowner      b,
       tpl_pub_goods       c,
       tpl_pub_goods_packs d,
       tpl_pub_goods_packs e,
       wms_udi_parser_rule f
 where a.goodsownerid = b.goodsownerid(+)
   and a.Waregoodsid = c.goodsid(+)
   and a.tradepackid = d.goodspackid(+)
   and a.outpackid = e.goodspackid(+)
   and a.udi_parser_rule_id=f.ruleid(+)
   and b.innerflag = 0
"
"ZX_800007_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_800007_V"" (""SEQID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACK"", ""COMPANYNAME"", ""PRODAREA"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""CREDATE"", ""UPLOADDATE"", ""YJDFLAG"", ""MEMO"") AS 
  select a.seqid,--主键ID
       a.goodsownerid,--货主ID
       b.goodsownername,--货主名称
       d.goodsid,--货品主档ID
       d.goodsname,--货品名称
       d.goodsengname,--商品名
       d.goodstype,--规格
       d.tradepack,--单位
       e.companyname,--生产厂家
       d.prodarea,--产地
       a.lotid,--批号ID
       c.lotno,--批号
       c.validdate,--有效期
       c.proddate,--生产日期
       c.approvedocno,--批准文号
       a.credate,--记录创建时间（wms_goods_lot_yjdflag的credate）
       a.uploaddate,--上传时间（wms_goods_lot_yjdflag的uploaddate）
       a.yjdflag,--上传标志（wms_goods_lot_yjdflag的yjdflag）
       a.memo--备注（wms_goods_lot_yjdflag的memo）

 from wms_goods_lot_yjdflag  a,
      tpl_goodsowner  b,
      wms_goods_lot   c,
      tpl_pub_goods   d,
      tpl_pub_company e

 where a.goodsownerid = b.goodsownerid(+)
   and a.lotid = c.lotid(+)
   and c.goodsid = d.goodsid
   and d.factid = e.companyid(+)
"
"ZX_81012_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_81012_V"" (""RECORDID"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CREDATE"", ""INOUTFLAG"", ""GOODSSEQ"", ""COMPANYID"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""DRUGFORM"", ""PRODLICENSENO"", ""APPROVEDOCNO"", ""MAH"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""INPUTMANID"", ""INPUTMAN"", ""SOURCEID"", ""INOUTID"") AS 
  select a.recordid,--记录ID
       b.warehid,--物流中心ID
       c.warehname,--物流中心
       b.goodsownerid,--货主ID
       d.goodsownername,--货主名称
       a.credate,--采集时间
       a.inoutflag,--出入库类型
       a.ecode as goodsseq,--器械序列号
       b.companyid,--货主单位ID
       e.companyname,--货主单位名称
       b.operationtype,--业务类型
       b.ownergoodsid,--货主货品ID
       f.waregoodsid as goodsid,--货品主档ID
       f.goodsownid,--货主原货品ID
       f.goodsname,--货品名称
       f.goodsengname,--商品名
       f.goodstype,--规格
       f.tradepackname,--基本单位
       f.factname,--生产厂家
       f.prodarea,--产地
       f.drugform,--剂型
       f.prodlicenseno,--生产许可证号
       f.approvedocno,--批准文号
       f.mah,--上市许可持有人
       b.lotid,--批号ID
       g.lotno,--批号
       g.validdate,--有效期至
       g.proddate,--生产日期
       b.goodsstatusid,--货品状态ID
       h.goodsstatus,--货品状态
       a.inputmanid,--采集人ID
       i.employeename as inputman,--采集人
       a.sourceid,--来源ID
       b.inoutid--出入库ID
  from wms_ecode_record_goodsseq a,
       wms_st_io_doc             b,
       tpl_warehouse             c,
       tpl_goodsowner            d,
       tpl_go_company            e,
       tpl_goods                 f,
       wms_goods_lot             g,
       wms_goodsstatus           h,
       pub_employee              i
 where a.sourceid = b.sourceid
   and a.inoutflag = 0
   and b.comefrom = 1
   and b.warehid = c.warehid
   and b.goodsownerid = d.goodsownerid
   and b.companyid = e.companyid
   and b.ownergoodsid = f.ownergoodsid
   and b.lotid = g.lotid
   and b.goodsstatusid = h.goodsstatusid(+)
   and a.inputmanid = i.employeeid(+)

union all

select a.recordid,--记录ID
       b.warehid,--物流中心ID
       c.warehname,--物流中心
       b.goodsownerid,--货主ID
       d.goodsownername,--货主名称
       a.credate,--采集时间
       a.inoutflag,--出入库类型
       a.ecode as goodsseq,--器械序列号
       b.companyid,--货主单位ID
       e.companyname,--货主单位名称
       b.operationtype,--业务类型
       b.ownergoodsid,--货主货品ID
       f.waregoodsid as goodsid,--货品主档ID
       f.goodsownid,--货主原货品ID
       f.goodsname,--货品名称
       f.goodsengname,--商品名
       f.goodstype,--规格
       f.tradepackname,--基本单位
       f.factname,--生产厂家
       f.prodarea,--产地
       f.drugform,--剂型
       f.prodlicenseno,--生产许可证号
       f.approvedocno,--批准文号
       f.mah,--上市许可持有人
       b.lotid,--批号ID
       g.lotno,--批号
       g.validdate,--有效期至
       g.proddate,--生产日期
       b.goodsstatusid,--货品状态ID
       h.goodsstatus,--货品状态
       a.inputmanid,--采集人ID
       i.employeename as inputman,--采集人
       a.sourceid,--来源ID
       b.inoutid--出入库ID
  from wms_ecode_record_goodsseq a,
       wms_st_io_doc             b,
       tpl_warehouse             c,
       tpl_goodsowner            d,
       tpl_go_company            e,
       tpl_goods                 f,
       wms_goods_lot             g,
       wms_goodsstatus           h,
       pub_employee              i
 where a.sourceid = b.inoutid
   and a.inoutflag = 1
   and b.comefrom in (2,3)
   and b.warehid = c.warehid
   and b.goodsownerid = d.goodsownerid
   and b.companyid = e.companyid
   and b.ownergoodsid = f.ownergoodsid
   and b.lotid = g.lotid
   and b.goodsstatusid = h.goodsstatusid(+)
   and a.inputmanid = i.employeeid(+)
"
"ZX_81014_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_81014_DTL_V"" (""TRANSID"", ""GOCOMPANYID"", ""SENDPOS"", ""INCEPTADDR"", ""DTLCORPID"", ""DTLCORPNAME"") AS 
  select t.transid,--运输地址ID
       t.gocompanyid,--货主单位ID
       t.sendpos,--运输地点名称
       t.inceptaddr,--详细地址
       t.dtlcorpid,--企业自定义编码
       t.dtlcorpname--企业自定义名称
  from wms_transport_address t
"
"ZX_81014_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_81014_V"" (""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""GCOMPANYID"", ""COMPANYNAME"", ""COMPANYSTYLE"", ""CORPID"", ""CORPNAME"") AS 
  select t.goodsownerid,--货主ID
       a.goodsownername,--货主名称
       t.companyid,--货主单位ID
       t.gcompanyid,--ERP单位ID
       t.companyname,--货主单位名称
       t.companystyle,--单位类型
       t.corpid,--企业自定义编码
       t.corpname--企业自定义名称
  from tpl_go_company t, tpl_goodsowner a
 where t.goodsownerid = a.goodsownerid(+)
"
"ZX_8700_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_8700_V"" (""DISPATCHID"", ""WAREHID"", ""WAREHNAME"", ""WAREHADDRESS"", ""COMPANYID"", ""COMPANYNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""ADDRESS"", ""TRANSID"", ""SOURCEID"", ""TRCOMPANYID"", ""TRCOMPANYNAME"", ""EXCARRIER"", ""TOTALPACKS"", ""TRANSMODEID"", ""TRANSMODE"", ""CREDATE"", ""DISPATCHDATE"", ""VEHICLEID"", ""VEHICLENO"", ""GPSNO"", ""SIMNO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""PRINTFLAG"", ""MEMO"", ""UPDOWNMANID"", ""UPDOWNMAN"", ""STARTDATE"", ""STARTTEMP"", ""ENDDATE"", ""ENDTEMP"", ""PRINTDATE"", ""PRINTMANID"", ""INPUTMAN"", ""SHR"", ""PRINTMAN"") AS 
  select distinct t.dispatchid,--派车单ID
       t.warehid,--物流中心ID
       a.warehname,--物流中心
       a.warehaddress,--发货地址
       ttd.gcompanyid companyid,--货主单位ID
       g.companyname,--货主单位名称
       ttd.goodsownerid,--货主ID
       l.goodsownername,--货主名称
       (case
         when substr(h.inceptaddr, 1, 1) = '*' or h.address is null then
          h.inceptaddr
         else
          h.address
       end) address,--收货地址
       ttd.transid,--运输地点ID
       to_char(ttd.SOURCEID) SOURCEID,--随货同行号
       ttd.trcompanyid,--承运商ID
       i.companyname trcompanyname,--承运商名称
       ttd.excarrier, --外部承运商
       decode(ttd.comefrom,
              1,
              zx_get_boxno(ttd.sourceid) + zx_get_wholeqty(ttd.sourceid),
              nvl(ttd.totalpacks, 0)) totalpacks,--运输任务总件数
       z.transmodeid,--运输方式ID
       k.transmode,--运输方式
       t.credate,--创建时间
       t.dispatchdate,--装车时间
       t.vehicleid,--车辆ID
       e.vehicleno,--车牌号
       e.gpsno,--GPS编号
       e.simno,--sim卡号
       t.driverid,--主驾驶员id
       nvl(c.drivername,t.drivername) as drivername,--主驾驶员名称
       t.driver2id,--副驾驶员id
       nvl(d.drivername,t.driver2name) as  driver2name,--副驾驶员名称
       t.printflag,--打印标签
       t.memo,--备注
       t.updownmanid,--装卸工ID
       tms_luyan_getupdownman(t.warehid,t.updownmanid) updownman,--装卸工名称
       ttd.startdate,--启运时间,
       ttd.starttemp,--启运温度,
       ttd.enddate,--到达时间,
       ttd.endtemp,--到达温度,
       t.printdate,--打印时间,
       t.printmanid,--打印人ID
       t.inputman,--委托经办人
       ttd.shr,--收货人
       f.employeename printman--打印人
   from TMS_luyan_DISPATCH_DOC t,
       tms_tr_doc             ttd,
       tpl_warehouse          a,
       pub_employee           b,
       tms_driver             c,
       tms_driver             d,
       tms_luyan_vehicle_v    e,
       pub_employee           f,
       tpl_go_company         g,
       wms_transport_address  h,
       tpl_pub_company        i,
       wms_out_order          z,
       wms_transport_mode     k,
       tpl_goodsowner         l
 where t.warehid = a.warehid(+)
   and t.dispatchid = ttd.dispatchid
   and ttd.gcompanyid = g.companyid(+)
   and ttd.transid = h.transid(+)
   AND ttd.trcompanyid = i.companyid(+)
   and ttd.sourceid = z.wavedtlid
   and t.warehid = z.warehid(+)
   and ttd.goodsownerid = l.goodsownerid(+)
   and z.transmodeid = k.transmodeid(+)
   and t.inputmanid = b.employeeid(+)
   and t.vehicleid = e.vehicleid(+)
   and t.driverid = c.driverid(+)
   and t.driver2id = d.driverid(+)
   and t.printmanid = f.employeeid(+)
   and nvl(t.usestatus,1)<>0
   and t.credate > to_date('2020-11-01', 'yyyy-mm-dd')
   and t.warehid = 1
"
"ZX_8701_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_8701_V"" (""DISPATCHID"", ""WAREHID"", ""WAREHNAME"", ""WAREHADDRESS"", ""COMPANYID"", ""COMPANYNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""ADDRESS"", ""TRANSID"", ""SOURCEID"", ""TRCOMPANYID"", ""TRCOMPANYNAME"", ""EXCARRIER"", ""TOTALPACKS"", ""TRANSMODEID"", ""TRANSMODE"", ""CREDATE"", ""DISPATCHDATE"", ""VEHICLEID"", ""VEHICLENO"", ""GPSNO"", ""SIMNO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVER2NAME"", ""LICENSENO"", ""PRINTFLAG"", ""MEMO"", ""UPDOWNMANID"", ""UPDOWNMAN"", ""STARTDATE"", ""STARTTEMP"", ""ENDDATE"", ""ENDTEMP"", ""PRINTDATE"", ""PRINTMANID"", ""INPUTMAN"", ""SHR"", ""PRINTMAN"", ""OTHERSTARTTEMP"", ""OTHERENDTEMP"", ""TRID"") AS 
  select distinct t.dispatchid,--派车单ID
       t.warehid,--物流中心ID
       a.warehname,--物流中心
       a.warehaddress,--发货地址
       ttd.gcompanyid companyid,--货主单位ID
       g.companyname,--货主单位名称
       ttd.goodsownerid,--货主ID
       l.goodsownername,--货主名称
       (case
         when substr(h.inceptaddr, 1, 1) = '*' or h.address is null then
          h.inceptaddr
         else
          h.address
       end) address,--收货地址
       ttd.transid,--运输地点ID
       to_char(ttd.SOURCEID) SOURCEID,--随货同行号
       ttd.trcompanyid,--承运商ID
       i.companyname trcompanyname,--承运商名称
       ttd.excarrier, --外部承运商
       decode(ttd.comefrom,
              1,
              zx_get_boxno(ttd.sourceid) + zx_get_wholeqty(ttd.sourceid),
              nvl(ttd.totalpacks, 0)) totalpacks,--运输任务总件数
       z.transmodeid,--运输方式ID
       k.transmode,--运输方式
       t.credate,--创建时间
       t.dispatchdate,--装车时间
       t.vehicleid,--车辆ID
       e.vehicleno,--车牌号
       e.gpsno,--GPS编号
       e.simno,--sim卡号
       t.driverid,--主驾驶员id
       nvl(c.drivername,t.drivername) as drivername,--主驾驶员名称
       t.driver2id,--副驾驶员id
       nvl(d.drivername,t.driver2name) as  driver2name,--副驾驶员名称
       c.licenseno,--驾驶证号
       t.printflag,--打印标签
       t.memo,--备注
       t.updownmanid,--装卸工ID
       tms_luyan_getupdownman(t.warehid,t.updownmanid) updownman,--装卸工名称
       ttd.startdate,--启运时间,
       ttd.starttemp,--启运温度,
       ttd.enddate,--到达时间,
       ttd.endtemp,--到达温度,
       t.printdate,--打印时间,
       t.printmanid,--打印人ID
       t.inputman,--委托经办人
       ttd.shr,--收货人
       f.employeename printman,--打印人
       ttd.otherstarttemp,
       ttd.otherendtemp,
       ttd.trid
   from TMS_luyan_DISPATCH_DOC t,
       tms_tr_doc             ttd,
       tpl_warehouse          a,
       pub_employee           b,
       tms_driver             c,
       tms_driver             d,
       tms_luyan_vehicle_v    e,
       pub_employee           f,
       tpl_go_company         g,
       wms_transport_address  h,
       tpl_pub_company        i,
       wms_out_order          z,
       wms_transport_mode     k,
       tpl_goodsowner         l
 where t.warehid = a.warehid(+)
   and t.dispatchid = ttd.dispatchid
   and ttd.gcompanyid = g.companyid(+)
   and ttd.transid = h.transid(+)
   AND ttd.trcompanyid = i.companyid(+)
   and ttd.sourceid = z.wavedtlid
   and t.warehid = z.warehid(+)
   and ttd.goodsownerid = l.goodsownerid(+)
   and z.transmodeid = k.transmodeid(+)
   and t.inputmanid = b.employeeid(+)
   and t.vehicleid = e.vehicleid(+)
   and t.driverid = c.driverid(+)
   and t.driver2id = d.driverid(+)
   and t.printmanid = f.employeeid(+)
   and nvl(t.usestatus,1)<>0
   and t.credate > to_date('2020-11-01', 'yyyy-mm-dd')
   and t.warehid = 17
"
"ZX_CHAINRECEIPT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_CHAINRECEIPT_V"" (""DISPATCHID"", ""CREDATE"", ""USESTATUS"", ""REALDISPATCHDATE"", ""CHAINFLAG"", ""CHAINUSESTATUS"", ""DIFFQTY"", ""SELFTRANSTYPE"", ""COMPANYNAME"", ""DRIVERNAME"", ""VEHICLENO"", ""VEHICLEID"", ""DRIVERID"", ""TRCOMPANYID"", ""TASKTYPE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DTLCOMPANYNAME"", ""INCEPTADDR"", ""GCOMPANYID"", ""SOURCEID"", ""DISPATCHDTLID"", ""SIGNDATE"", ""DEVNUM"", ""STARTDATE"", ""ENDDATE"", ""CARFLAG"", ""WAREHID"", ""TRID"") AS 
  select a.dispatchid,
       a.credate,
       b.usestatus, --取细单状态
       a.realdispatchdate,
       c.chainflag,
       nvl(b.chainusestatus,0) chainusestatus, --add by tl 20171229  冷链回执标志
       zx_tl_signdiff(c.trid) diffqty, --add by tl 20200616 回执签收差异
       a.selftranstype,
       i.companyname,
       d.drivername,
       e.vehicleno,
       a.vehicleid,
       a.driverid,
       a.trcompanyid,
       b.tasktype,
       c.goodsownerid,
       f.goodsownername,
       g.companyname dtlcompanyname,
       h.inceptaddr,
       c.gcompanyid,
       c.sourceid,
       b.dispatchdtlid,
       b.signdate,
       e.devnum,
       b.startdate,--by tl@20201228冷链启运时间
       b.enddate,
       b.carflag, --210225冷链车保温箱标志
       a.warehid,
       c.trid
  from Tms_dispatch_doc      a,
       Tms_dispatch_dtl      b,
       tms_tr_doc            c,
       tms_driver            d,
       tms_vehicle           e,
       tpl_goodsowner        f,
       tpl_go_company        g,
       wms_transport_address h,
       tpl_pub_company       i
 where a.dispatchid = b.dispatchid
   and b.trid = c.trid
   and b.usestatus <> 1 --去掉作废状态
   and nvl(b.chainflag, 0) = 1
   and a.warehid in (2, 14)
   and a.driverid = d.driverid(+)
   and a.vehicleid = e.vehicleid(+)
   and c.goodsownerid = f.goodsownerid(+)
   and c.gcompanyid = g.companyid(+)
   and c.transid = h.transid(+)
   and a.trcompanyid=i.companyid(+)
   --and a.dispatchid = 687394
--  and   a.usestatus<>0 --总单撤单状态不显示
--and   c.SOURCEID=d.wavedtlid(+);
--  and b.usestatus<>1  --细单状态作废的不显示
"
"ZX_DIS_COLLECT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_DIS_COLLECT_V"" (""SOURCECOMPANYID"", ""COMPANYNAME"", ""CREDATE"", ""RECEIVEDATE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""GOODSQTY"", ""INPUTMANID"", ""EMPLOYEENAME"", ""RECEIVEID"", ""GOODSID"") AS 
  select t3.sourcecompanyid,--来货单位id
       t4.companyname,--来货单位
       t3.credate,--下单日期
       t1.receivedate,--收货日期
       t1.goodsname,--品名
       t1.goodstype,--规格
       t1.prodarea,--产地
       t1.factname,--生产厂家
       t1.lotid,--批号id
       t1.lotno,--批号
       t1.proddate,--生产日期
       decode(to_char(t1.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              t1.validdate) validdate,--有效期至
       t1.approvedocno,--批准文号
       t1.goodsqty,--数量
       t1.inputmanid,--录入人id
       t5.employeename,--录入人
       t1.receiveid,--收货明细id
       t1.goodsid--主档id
  from wms_receive_dtl_v t1,
       wms_in_order_dtl  t2,
       wms_in_order      t3,
       tpl_go_company    t4,
       pub_employee      t5
 where t1.indtlid = t2.indtlid
   and t2.inid = t3.inid
   and t3.sourcecompanyid = t4.companyid
   and t1.inputmanid = t5.employeeid
   and t1.goodsstatusid in (2,-2)
"
"ZX_DTXF_ECODE_RECORD_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_DTXF_ECODE_RECORD_V"" (""RECORDID"", ""SOURCEIDBAK"", ""SOURCEID"", ""ECODE"", ""CREDATE"", ""EXPFLAG"", ""QTY"", ""INOUTFLAG"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""WARECID"", ""COMPANYNAME"", ""OPERATIONTYPE"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""PRODAREA"", ""DRUGFORM"", ""APPROVEDOCNO"", ""MAH"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""BATCHNO"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""TRADETIME"", ""TRADENO"", ""INPUTMANID"", ""INPUTMANNAME"", ""EXPDATE"", ""EXPMANID"", ""EXPMANNAME"", ""SPECIALFLAG"", ""SIGNATURE"", ""CORPID"", ""BILLTYPE"", ""COMEFROM"", ""ERPDTLID"") AS 
  select a.recordid,
       a.sourceid as sourceidbak,
       replace(replace(replace(nvl(a.srcexpno, a.sourceid), chr(10), ''),
                       chr(13),
                       ''),
               chr(9),
               '') as sourceid,
       a.ecode,
       trunc(a.credate) as credate,
       nvl(a.expflag, 0) as expflag,
       a.qty,
       a.inoutflag,
       a.warehid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.companyid,
       g.warecid as warecid,
       replace(replace(replace(g.companyname, chr(10), ''), chr(13), ''),
               chr(9),
               '') as companyname,
       --decode(a.operationtype, 43, 11, 25, 21, 18, 11, a.operationtype) as operationtype,
       (case
         when a.operationtype in (43, 18) then
          11
         when a.operationtype in (25) then
          21
         when a.operationtype in (8) and a.goodsownerid in (10003,9175) then
          1
         else
          a.operationtype
       end) as operationtype,
       a.ownergoodsid,
       d.waregoodsid as goodsid,
       d.goodsname,
       d.goodsengname,
       d.goodstype,
       d.tradepackname,
       d.factname,
       d.prodarea,
       d.drugform,
       d.approvedocno,
       d.mah,
       a.goodspackid,
       e.packname,
       e.packsize,
       null as batchno,
       a.lotid,
       f.lotno,
       f.proddate,
       f.validdate,
       null as goodsstatusid,
       null as goodsstatus,
       null as quantitystatus,
       a.credate as tradetime,
       a.inoutid as tradeno,
       a.inputmanid,
       h.employeename as inputmanname,
       a.expdate,
       a.expmanid,
       i.employeename as expmanname,
       (select nvl(x.specialflag, 2)
          from tpl_pub_goods x
         where x.goodsid = a.goodsid) as specialflag,
       null as signature,
       --nvl(g.corpid, g.gcompanyid) corpid,
       /*       decode(o.goodsownerid,
       8100,
       (select nvl(max(t1.gcompanyid), 0)
          from tpl_go_company t1
         where t1.goodsownerid = 8100
           and t1.companyname = o.receivehead),
       nvl(f.corpid, f.gcompanyid)) corpid, --辰欣 by tl@230825*/
       (case
         when a.goodsownerid = 8100 and a.comefrom = 3 then
          (select nvl(max(z.gcompanyid), 0)
             from wms_out_order y, tpl_go_company z
            where y.outid = a.outid
              and y.goodsownerid = z.goodsownerid
              and y.receivehead = z.companyname)
         else
          nvl(g.corpid, g.gcompanyid)
       end) as corpid,
       null billtype,
       nvl(a.comefrom, 0) as comefrom,
       a.srcexpno  as erpdtlid
  from wms_ecode_record    a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       tpl_pub_goods_packs e,
       wms_goods_lot       f,
       tpl_go_company      g,
       pub_employee        h,
       pub_employee        i
 where a.warehid = b.warehid
   and a.goodsownerid = c.goodsownerid
   and a.ownergoodsid = d.ownergoodsid
   and a.goodspackid = e.goodspackid(+)
   and a.lotid = f.lotid(+)
   and a.companyid = g.companyid
   and a.inputmanid = h.employeeid(+)
   and a.expmanid = i.employeeid(+)
   and a.credate > to_Date('2023-01-01', 'yyyy-mm-dd')
 order by nvl(a.srcexpno, a.sourceid), a.ownergoodsid
"
"ZX_ERPWMS_ST_DIFFQTY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_ERPWMS_ST_DIFFQTY_V"" (""PK"", ""ENTRYID"", ""GOODSOWNERID"", ""GOODSID"", ""LOTNO"", ""PACKNAME"", ""PACKSIZE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""GOODSQTY"", ""WHID"", ""WMSENTRYID"", ""WMSGOODSOWNERID"", ""WMSGOODSID"", ""WMSLOTNO"", ""WMSPACKNAME"", ""WMSPACKSIZE"", ""WMSGOODSSTATUSID"", ""WMSGOODSSTATUS"", ""WMSGOODSQTY"", ""WMSWHID"", ""DIFFQTY"") AS 
  select erpwmstotal.""PK"",
       erpwmstotal.""ENTRYID"",
       erpwmstotal.""GOODSOWNERID"",
       erpwmstotal.""GOODSID"",
       erpwmstotal.""LOTNO"",
       erpwmstotal.""PACKNAME"",
       erpwmstotal.""PACKSIZE"",
       erpwmstotal.""GOODSSTATUSID"",
       erpwmstotal.""GOODSSTATUS"",
       erpwmstotal.""GOODSQTY"",
       erpwmstotal.""WHID"",
       erpwmstotal.""WMSENTRYID"",
       erpwmstotal.""WMSGOODSOWNERID"",
       erpwmstotal.""WMSGOODSID"",
       erpwmstotal.""WMSLOTNO"",
       erpwmstotal.""WMSPACKNAME"",
       erpwmstotal.""WMSPACKSIZE"",
       erpwmstotal.""WMSGOODSSTATUSID"",
       erpwmstotal.""WMSGOODSSTATUS"",
       erpwmstotal.""WMSGOODSQTY"",
       erpwmstotal.""WMSWHID"",
       nvl(erpwmstotal.goodsqty, 0) - nvl(erpwmstotal.wmsgoodsqty, 0) diffqty
  from (select pk,
               max(entryid) entryid,
               max(goodsownerid) goodsownerid,
               max(goodsid) goodsid,
               max(lotno) lotno,
               max(packname) packname,
               max(packsize) packsize,
               max(goodsstatusid) goodsstatusid,
               max(goodsstatus) goodsstatus,
               max(goodsqty) goodsqty,
               max(whid) whid,
               max(wmsentryid) wmsentryid,
               max(wmsgoodsownerid) wmsgoodsownerid,
               max(wmsgoodsid) wmsgoodsid,
               max(wmslotno) wmslotno,
               max(wmspackname) wmspackname,
               max(wmspacksize) wmspacksize,
               max(wmsgoodsstatusid) wmsgoodsstatusid,
               max(wmsgoodsstatus) wmsgoodsstatus,
               max(wmsgoodsqty) wmsgoodsqty,
               max(wmswhid) wmswhid
          from (select *
                  from (select erp.entryid || erp.goodsownerid || erp.goodsid ||
                               erp.lotno || erp.packname || erp.packsize ||
                               erp.goodsstatusid||erp.whid pk,
                               to_char(erp.entryid) entryid,
                               to_char(erp.goodsownerid) goodsownerid,
                               to_char(erp.goodsid) goodsid,
                               erp.lotno,
                               erp.packname,
                               to_char(erp.packsize) packsize,
                               to_char(erp.goodsstatusid) goodsstatusid,
                               erp.goodsstatus,
                               to_char(sum(erp.goodsqty)) goodsqty,
                               to_char(erp.whid) whid,
                               '' wmsentryid,
                               '' wmsgoodsownerid,
                               '' wmsgoodsid,
                               '' wmslotno,
                               '' wmspackname,
                               '' wmspacksize,
                               '' wmsgoodsstatusid,
                               '' wmsgoodsstatus,
                               '' wmsgoodsqty,
                               '' wmswhid
                          from --ERP当前保管帐库存
                               (select a.entryid,
                                       a.goodsownerid,
                                       t.goodsid,
                                       t.lotno,
                                       t.packname,
                                       t.packsize,
                                       t.goodsstatusid,
                                       decode(t.goodsstatusid,9,'合格.',t.goodsstatus) goodsstatus,
                                       t.goodsqty,
                                       st.whid
                                  from lyerp.bms_st_qty_lst_v t,
                                       lyerp.bms_st_def       st,
                                       lyerp.pub_entry        a
                                 where t.storageid = st.storageid(+)
                                   and st.entryid = a.entryid
                                   and a.goodsownerid is not null
                                   and st.wmsflag = 1 --启用WMS标志
                                union all
                                --ERP采购、销退业务处理
                                select a.entryid,
                                       c.goodsownerid,
                                       b.GOODSID,
                                       b.lotno,
                                       t.packName,
                                       t.packsize,
                                       b.goodsstatusid,
                                       b.goodsstatus,
                                       b.GOODSQTY,
                                       st.whid
                                  from lyerp.bms_st_rg_doc_v  a,
                                       lyerp.bms_st_rg_dtl_v  b,
                                       lyerp.pub_goods_detail t,
                                       lyerp.bms_st_def       st,
                                       lyerp.pub_entry        c
                                 where a.rgtype in (1, 2) --1.采购 2.销退
                                   and a.usestatus = 2
                                   and a.RGID = b.RGID
                                   and b.STORAGEID = st.storageid(+)
                                   and st.entryid = c.entryid
                                   and c.goodsownerid is not null
                                   and st.wmsflag = 1 --启用WMS标志
                                   and b.GOODSDTLID = t.goodsdtlid(+)) erp
                         group by erp.entryid,
                                  erp.goodsownerid,
                                  erp.goodsid,
                                  erp.lotno,
                                  erp.packname,
                                  erp.packsize,
                                  erp.goodsstatusid,
                                  erp.goodsstatus,
                                  erp.whid
                         order by erp.goodsid) erpkc

                union all

                select *
                  from (select a.entryid || t.goodsownerid || t.goodsownid ||
                               t.lotno || t.packname || t.packsize ||
                               t.goodsstatusid||t.warehid pk,
                               '' entryid,
                               '' goodsownerid,
                               '' goodsid,
                               '' lotno,
                               '' packname,
                               '' packsize,
                               '' goodsstatusid,
                               '' goodsstatus,
                               '' goodsqty,
                               '' whid,
                               to_char(a.entryid) wmsentryid,
                               to_char(t.goodsownerid) wmsgoodsownerid,
                               t.goodsownid wmsgoodsid,
                               t.lotno wmslotno,
                               t.packname wmspackname,
                               to_char(t.packsize) wmspacksize,
                               to_char(t.goodsstatusid) wmsgoodsstatusid,
                               t.goodsstatus wmsgoodsstatus,
                               to_char(sum(t.goodsqty)) wmsgoodsqty,
                               to_char(t.warehid) wmswhid
                          from lywms.wms_st_qty_lst_v t, lyerp.pub_entry a
                         where t.goodsqty <> 0 --排除没货但有待上架任务的记录
                           and t.goodsownerid = a.goodsownerid(+)
                         group by a.entryid,
                                  t.goodsownerid,
                                  t.goodsownid,
                                  t.lotno,
                                  t.packname,
                                  t.packsize,
                                  t.goodsstatusid,
                                  t.goodsstatus,
                                  t.warehid
                         order by t.goodsownid) wmskc)
         group by pk) erpwmstotal
"
"ZX_ERPWMS_ST_DIFFQTY_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_ERPWMS_ST_DIFFQTY_V1"" (""ENTRYID"", ""ENTRYNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""WHID"", ""WAREHNAME"", ""GOODSID"", ""WAREGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""GOODSUNIT"", ""FACTNAME"", ""ERPLOTNO"", ""ERPPACKNAME"", ""ERPPACKSIZE"", ""ERPGOODSSTATUSID"", ""ERPGOODSSTATUS"", ""ERPGOODSQTY"", ""WMSLOTNO"", ""WMSPACKNAME"", ""WMSPACKSIZE"", ""WMSGOODSSTATUSID"", ""WMSGOODSSTATUS"", ""WMSGOODSQTY"", ""DIFFQTY"") AS 
  select nvl(t.ENTRYID,t.WMSENTRYID) entryid,
       a.entryname,
       nvl(t.GOODSOWNERID,t.WMSGOODSOWNERID) goodsownerid,
       b.goodsownername,
       nvl(t.WHID,t.WMSWHID) whid,
       c.warehname,
       nvl(t.GOODSID,t.WMSGOODSID) goodsid,
       b.waregoodsid,
       b.goodsname,
       b.goodsengname,
       b.goodstype,
       baseunit.packname goodsunit,
       b.factname,
       t.LOTNO erplotno,
       t.PACKNAME erppackname,
       t.PACKSIZE erppacksize,
       t.GOODSSTATUSID erpgoodsstatusid,
       t.goodsstatus erpgoodsstatus,
       t.GOODSQTY erpgoodsqty,
       t.WMSLOTNO,
       t.WMSPACKNAME,
       t.WMSPACKSIZE,
       t.WMSGOODSSTATUSID,
       t.WMSGOODSSTATUS,
       t.WMSGOODSQTY,
       t.diffqty


  from zx_erpwms_st_diffqty_v t,
       lyerp.pub_entry a,
       tpl_goods_v b,
       tpl_warehouse c,
       (select tt.ownergoodsid,tt.packname from tpl_goods_packs tt where tt.baseunitflag=1) baseunit
 where nvl(t.ENTRYID,t.WMSENTRYID) = a.entryid(+)
   and nvl(t.GOODSOWNERID,t.WMSGOODSOWNERID) = b.goodsownerid
   and nvl(t.GOODSID,t.WMSGOODSID) = b.goodsownid
   and b.ownergoodsid = baseunit.ownergoodsid(+)
   and nvl(t.WHID,t.WMSWHID) = c.warehid(+)
"
"ZX_ERP_NOTIN_WMSOUTORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_ERP_NOTIN_WMSOUTORDER_V"" (""SALESID"", ""SALESDTLID"", ""CREDATE"", ""CONFIRMDATE"", ""CUSTOMID"", ""CUSTOMNAME"", ""GOODSID"", ""GOODSNAME"", ""CURRENCYNAME"", ""GOODSTYPE"", ""GOODSUNIT"", ""FACTORYNAME"", ""GOODSQTY"", ""LOTNO"", ""ENTRYID"", ""ENTRYNAME"", ""STORAGENAME"") AS 
  select a.salesid,
       b.salesdtlid,
       a.credate,
       a.confirmdate,
       a.customid,
       c.customname,
       b.goodsid,
       d.goodsname,
       d.currencyname,
       d.goodstype,
       d.goodsunit,
       h.factoryname,
       b.goodsqty,
       e.lotno,
       a.entryid,
       f.entryname,
       g.storagename
  from lyerp.bms_sa_doc   a,
       lyerp.bms_sa_dtl   b,
       lyerp.pub_customer c,
       lyerp.pub_goods    d,
       lyerp.bms_lot_def  e,
       lyerp.pub_entry    f,
       lyerp.bms_st_def   g,
       lyerp.pub_factory  h
 where a.salesid = b.salesid
   and b.sendflag = 1
   and b.wmsstatus = 1
   and a.customid = c.customid
   and b.goodsid = d.goodsid
   and b.lotid = e.lotid
   and a.entryid=f.entryid
   and b.storageid=g.storageid
   and d.factoryid=h.factoryid
   and exists (select 1 from tpl_goodsowner x where x.innerflag=1 and x.goodsownerid=f.goodsownerid)
   and not exists (select 1
                           from wms_out_order t
                          where t.zxcolumn4 = to_char(a.salesid)
                            and t.operationtype=11
                            and t.goodsownerid in
                                (select tt.goodsownerid
                                   from tpl_goodsowner tt
                                  where tt.innerflag = 1))
      --add by xyue 2015-12-09 增加内部货主的限制
   and a.credate > sysdate - 7
"
"ZX_EXPORTINV20200213_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_EXPORTINV20200213_V"" (""库存日期"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主"", ""货主货品ID"", ""货品主档ID"", ""ERP货品ID"", ""货品名称"", ""商品名"", ""规格"", ""库存数量"", ""单位"", ""生产厂家"", ""产地"", ""剂型"", ""存储条件"", ""包装大小"", ""外包装单位"", ""批号"", ""批准文号"", ""有效期"", ""生产日期"", ""货品状态"", ""库区名称"", ""分区名称"", ""货位名称"") AS 
  select a.inventorydate 库存日期,
       a.warehid 物流中心ID,
       b.warehname 物流中心,
       a.goodsownerid 货主ID,
       c.goodsownername 货主,
       a.ownergoodsid 货主货品ID,
       d.waregoodsid 货品主档ID,
       to_number(d.goodsownid) erp货品ID,
       d.goodsname 货品名称， d.goodsengname 商品名,
       d.goodstype 规格,
       a.goodsqty 库存数量,
       d.tradepackname 单位,
       d.factname 生产厂家,
       d.prodarea 产地,
       d.drugform 剂型,
       d.storagecondition 存储条件,
       e.packsize 包装大小,
       e.packname 外包装单位,
       f.lotno 批号,
       f.approvedocno 批准文号,
       to_char(f.validdate, 'yyyy-mm-dd') 有效期,
       to_char(f.proddate, 'yyyy-mm-dd') 生产日期,
       g.goodsstatus 货品状态,
       j.areaname 库区名称,
       i.sectionname 分区名称,
       h.posname 货位名称
  from zx_wms_St_qty_lst20200213 a,
       tpl_warehouse             b,
       tpl_goodsowner            c,
       tpl_goods                 d,
       tpl_pub_goods_packs       e,
       wms_goods_lot             f,
       wms_goodsstatus           g,
       wms_pos_def               h,
       wms_st_section_def        i,
       wms_st_area_def           j
 where a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
   and a.ownergoodsid = d.ownergoodsid(+)
   and a.goodspackid = e.goodspackid(+)
   and a.lotid = f.lotid(+)
   and a.goodsstatusid = g.goodsstatusid(+)
   and a.posid = h.posid(+)
   and h.sectionid = i.sectionid(+)
   and h.areaid = j.areaid(+)
 order by to_number(d.goodsownid)
"
"ZX_FYJK_TEST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_FYJK_TEST_V"" (""OUTDTLID"", ""YPMC"", ""YPID"", ""APPROVEDOCNO"", ""YPGG"", ""VALIDDATE"", ""FACTNAME"", ""TRADEPACKNAME"", ""PRICE"", ""SELLPRICE"", ""GOODSQTY"", ""AMT"", ""INVOICENO"", ""LOTNO"", ""WAVEDTLID"", ""FLAG"", ""COMEFROM"") AS 
  select e.wavedtlid outdtlid, --订单号\随货同行号
       d.ypmc, --药品名称
       d.ypid, --药品编码
       b.approvedocno approvedocno, --批准文号
       d.ypgg, --规格
       to_char(c.validdate, 'yyyy-mm-dd') validdate, --有效期
       nvl(c.factname, b.factname) factname, --生产厂家
       nvl(d.dw, b.tradepackname) tradepackname, --单位
       decode(d.tinyrate,
              null,
              f.lydtlzxcolumn3,
              f.lydtlzxcolumn3 / d.tinyrate) price, --进货价
       decode(d.tinyrate,
              null,
              nvl((select nvl(t.price,0)
                    from lyerp.bms_entry_goods_price t
                   where t.grade = 2
                     and t.entryid = 1
                     and t.priceid = 2464
                     and t.goodsid = b.goodsownid),
                  (select nvl(t.price,0)
                     from lyerp.bms_entry_goods_price t
                    where t.grade = 2
                      and t.entryid = 1
                      and t.priceid = 367
                      and t.goodsid = b.goodsownid)),
              nvl((select nvl(t.price,0)
                    from lyerp.bms_entry_goods_price t
                   where t.grade = 2
                     and t.entryid = 1
                     and t.priceid = 2464
                     and t.goodsid = b.goodsownid),
                  (select nvl(t.price,0)
                     from lyerp.bms_entry_goods_price t
                    where t.grade = 2
                      and t.entryid = 1
                      and t.priceid = 367
                      and t.goodsid = b.goodsownid)) / d.tinyrate) sellprice, --零售价

       --nvl((select t.price from lyerp.bms_entry_goods_price t where t.grade=2 and t.entryid=1 and t.priceid=4224 and t.goodsid=b.goodsownid),(select t.price from lyerp.bms_entry_goods_price t where t.grade=2 and t.entryid=1 and t.priceid=2384 and t.goodsid=b.goodsownid)) sellprice,--零售价
       case
         when d.tinyrate >= 1 then
          a.goodsqty * d.tinyrate
         else
          a.goodsqty / (round(1 / d.tinyrate, 0))
       end goodsqty, --数量,
       a.goodsqty * f.lydtlzxcolumn3 amt, --金额
       f.invoiceno, --发票号
       c.lotno, --批号
       to_char(a.inoutid) wavedtlid, --条形码/整件为出入库ID
       0 flag, --标志
       1 comefrom --业务类型-WMS整件出库
  from wms_st_io_doc         a,
       tpl_goods             b,
       wms_goods_lot         c,
       lyerp.zx_101102       d,
       wms_wave_goods_dtl    e,
       wms_out_order_dtl     f,
       wms_out_order_lot_dtl g,
       wms_wave_dtl          h
 where a.ownergoodsid = b.ownergoodsid(+)
   and a.lotid = c.lotid(+)
   and e.wavedtlid = h.wavedtlid
   and nvl(h.canprintflag, 0) = 1
   and a.warehid = 1
   and a.goodsownerid = 1
   and a.companyid = 312 --厦门妇幼
   and a.credate > to_date('2020-10-20', 'yyyy-mm-dd')
   and a.wholeqty is not null --WMS整件出库
   and a.operationtype = 11 --销售
   and a.comefrom in (3) --来源出库
   and a.usestatus = 1 --正式
   and a.rfflag = 3 --任务状态执行完毕
   and a.sourceid = e.wavegoodsdtlid
   and e.wavegoodsdtlid = g.wavegoodsdtlid(+)
   and g.outdtlid = f.outdtlid
   and b.goodsownid = d.goodsid
   and not exists (select 1
          from zx_fyjk t
         where t.outdtlid = a.inoutid
           and t.comefrom = 1)

union all

select e.wavedtlid outdtlid, --订单号\随货同行号
       d.ypmc, --药品名称
       d.ypid, --药品编码
       b.approvedocno approvedocno, --批准文号
       d.ypgg, --规格
       to_char(c.validdate, 'yyyy-mm-dd') validdate, --有效期
       nvl(c.factname, b.factname) factname, --生产厂家
       nvl(d.dw, b.tradepackname) tradepackname, --单位
       decode(d.tinyrate,
              null,
              f.lydtlzxcolumn3,
              f.lydtlzxcolumn3 / d.tinyrate) price, --单价
       decode(d.tinyrate,
              null,
              nvl((select nvl(t.price,0)
                    from lyerp.bms_entry_goods_price t
                   where t.grade = 2
                     and t.entryid = 1
                     and t.priceid = 2464
                     and t.goodsid = b.goodsownid),
                  (select nvl(t.price,0)
                     from lyerp.bms_entry_goods_price t
                    where t.grade = 2
                      and t.entryid = 1
                      and t.priceid = 367
                      and t.goodsid = b.goodsownid)),
              nvl((select nvl(t.price,0)
                    from lyerp.bms_entry_goods_price t
                   where t.grade = 2
                     and t.entryid = 1
                     and t.priceid = 2464
                     and t.goodsid = b.goodsownid),
                  (select nvl(t.price,0)
                     from lyerp.bms_entry_goods_price t
                    where t.grade = 2
                      and t.entryid = 1
                      and t.priceid = 367
                      and t.goodsid = b.goodsownid)) / d.tinyrate) sellprice, --零售价

       --nvl((select t.price from lyerp.bms_entry_goods_price t where t.grade=2 and t.entryid=1 and t.priceid=4224 and t.goodsid=b.goodsownid),(select t.price from lyerp.bms_entry_goods_price t where t.grade=2 and t.entryid=1 and t.priceid=2384 and t.goodsid=b.goodsownid)) sellprice,--零售价
       case
         when d.tinyrate >= 1 then
          h.goodsqty * d.tinyrate
         else
          h.goodsqty / (round(1 / d.tinyrate, 0))
       end goodsqty, --数量,
       h.goodsqty * f.lydtlzxcolumn3 amt, --金额
       f.invoiceno, --发票号
       c.lotno, --批号
       k.boxcode wavedtlid, --条形码/散件装箱总单ID
       0 flag, --标志
       2 comefrom --WMS散件出库
  from wms_st_io_doc          a,
       tpl_goods              b,
       wms_goods_lot          c,
       lyerp.zx_101102        d,
       wms_wave_goods_dtl     e,
       wms_out_order_dtl      f,
       wms_out_order_lot_dtl  g,
       wms_turnbox_to_box_rel h,
       wms_box_dtl            i,
       wms_wave_dtl           j,
       wms_box_doc            k,
       wms_st_section_def     l
 where a.ownergoodsid = b.ownergoodsid(+)
   and a.lotid = c.lotid(+)
   and e.wavedtlid = j.wavedtlid
   and nvl(j.canprintflag, 0) = 1
   and a.warehid = 1
   and a.goodsownerid = 1
   and a.companyid = 312 --厦门妇幼
   and a.credate > to_date('2020-10-20', 'yyyy-mm-dd')
   and a.scatterqty is not null --WMS散件出库
   and a.operationtype = 11 --销售
   and a.comefrom in (3) --来源出库
   and a.usestatus = 1 --正式
   and a.rfflag = 3 --任务状态执行完毕
   and a.sourceid = e.wavegoodsdtlid
   and e.wavegoodsdtlid = g.wavegoodsdtlid(+)
   and g.outdtlid = f.outdtlid
   and b.goodsownid = d.goodsid
   and a.inoutid = h.inoutid(+)
   and h.boxdtlid = i.dtlid(+)
   and i.docid=k.docid(+)
   and a.sectionid=l.sectionid(+)
   and nvl(l.iwcs_flag,0)=0
   and not exists (select 1
          from zx_fyjk t
         where t.outdtlid = to_number(k.boxcode)
           and t.comefrom = 2)

union all

select e.wavedtlid outdtlid, --订单号\随货同行号
       d.ypmc, --药品名称
       d.ypid, --药品编码
       b.approvedocno approvedocno, --批准文号
       d.ypgg, --规格
       to_char(c.validdate, 'yyyy-mm-dd') validdate, --有效期
       nvl(c.factname, b.factname) factname, --生产厂家
       nvl(d.dw, b.tradepackname) tradepackname, --单位
       decode(d.tinyrate,
              null,
              f.lydtlzxcolumn3,
              f.lydtlzxcolumn3 / d.tinyrate) price, --单价
       decode(d.tinyrate,
              null,
              nvl((select nvl(t.price,0)
                    from lyerp.bms_entry_goods_price t
                   where t.grade = 2
                     and t.entryid = 1
                     and t.priceid = 2464
                     and t.goodsid = b.goodsownid),
                  (select nvl(t.price,0)
                     from lyerp.bms_entry_goods_price t
                    where t.grade = 2
                      and t.entryid = 1
                      and t.priceid = 367
                      and t.goodsid = b.goodsownid)),
              nvl((select nvl(t.price,0)
                    from lyerp.bms_entry_goods_price t
                   where t.grade = 2
                     and t.entryid = 1
                     and t.priceid = 2464
                     and t.goodsid = b.goodsownid),
                  (select nvl(t.price,0)
                     from lyerp.bms_entry_goods_price t
                    where t.grade = 2
                      and t.entryid = 1
                      and t.priceid = 367
                      and t.goodsid = b.goodsownid)) / d.tinyrate) sellprice, --零售价

       --nvl((select t.price from lyerp.bms_entry_goods_price t where t.grade=2 and t.entryid=1 and t.priceid=4224 and t.goodsid=b.goodsownid),(select t.price from lyerp.bms_entry_goods_price t where t.grade=2 and t.entryid=1 and t.priceid=2384 and t.goodsid=b.goodsownid)) sellprice,--零售价
       case
         when d.tinyrate >= 1 then
         m.carton_qty * d.tinyrate
         else
          m.carton_qty / (round(1 / d.tinyrate, 0))
       end goodsqty, --数量,
       m.carton_qty * f.lydtlzxcolumn3 amt, --金额
       f.invoiceno, --发票号
       c.lotno, --批号
       m.label_barcode wavedtlid, --条形码/散件装箱总单ID
       0 flag, --标志
       3 comefrom --IWCS自动库出库
  from wms_st_io_doc          a,
       tpl_goods              b,
       wms_goods_lot          c,
       lyerp.zx_101102        d,
       wms_wave_goods_dtl     e,
       wms_out_order_dtl      f,
       wms_out_order_lot_dtl  g,
       --wms_turnbox_to_box_rel h,
       --wms_box_dtl            i,
       wms_wave_dtl           j,
       --wms_box_doc            k,
       wms_st_section_def     l,
       ssc_picking_carton@iwcs m

 where a.ownergoodsid = b.ownergoodsid(+)
   and a.lotid = c.lotid(+)
   and e.wavedtlid = j.wavedtlid
   and nvl(j.canprintflag, 0) = 1
   and a.warehid = 1
   and a.goodsownerid = 1
   and a.companyid = 312 --厦门妇幼
   and a.credate > to_date('2020-10-20', 'yyyy-mm-dd')
   and a.scatterqty is not null --IWCS自动库出库
   and a.operationtype = 11 --销售
   and a.comefrom in (3) --来源出库
   and a.usestatus = 1 --正式
   and a.rfflag = 3 --任务状态执行完毕
   and a.sourceid = e.wavegoodsdtlid
   and e.wavegoodsdtlid = g.wavegoodsdtlid(+)
   and g.outdtlid = f.outdtlid
   and b.goodsownid = d.goodsid
   --and a.inoutid = h.inoutid(+)
   --and h.boxdtlid = i.dtlid(+)
   --and i.docid=k.docid(+)
   and a.sectionid=l.sectionid
   and nvl(l.iwcs_flag,0)=1
   and a.inoutid=m.wms_inout_id
/*    and not exists (select 1
          from zx_fyjk t
         where t.outdtlid = m.label_barcode
           and t.comefrom = 3)*/
"
"ZX_FYJK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_FYJK_V"" (""OUTDTLID"", ""YPMC"", ""YPID"", ""APPROVEDOCNO"", ""YPGG"", ""VALIDDATE"", ""FACTNAME"", ""TRADEPACKNAME"", ""PRICE"", ""SELLPRICE"", ""GOODSQTY"", ""AMT"", ""INVOICENO"", ""LOTNO"", ""WAVEDTLID"", ""FLAG"", ""COMEFROM"") AS 
  select e.wavedtlid outdtlid, --订单号\随货同行号
       d.ypmc, --药品名称
       d.ypid, --药品编码
       b.approvedocno approvedocno, --批准文号
       d.ypgg, --规格
       to_char(c.validdate, 'yyyy-mm-dd') validdate, --有效期
       nvl(c.factname, b.factname) factname, --生产厂家
       nvl(d.dw, b.tradepackname) tradepackname, --单位
       decode(d.tinyrate,
              null,
              f.lydtlzxcolumn3,
              f.lydtlzxcolumn3 / d.tinyrate) price, --进货价
       decode(d.tinyrate,
              null,
              nvl((select nvl(t.price,0)
                    from lyerp.bms_entry_goods_price t
                   where t.grade = 2
                     and t.entryid = 1
                     and t.priceid = 2464
                     and t.goodsid = b.goodsownid),
                  (select nvl(t.price,0)
                     from lyerp.bms_entry_goods_price t
                    where t.grade = 2
                      and t.entryid = 1
                      and t.priceid = 367
                      and t.goodsid = b.goodsownid)),
              nvl((select nvl(t.price,0)
                    from lyerp.bms_entry_goods_price t
                   where t.grade = 2
                     and t.entryid = 1
                     and t.priceid = 2464
                     and t.goodsid = b.goodsownid),
                  (select nvl(t.price,0)
                     from lyerp.bms_entry_goods_price t
                    where t.grade = 2
                      and t.entryid = 1
                      and t.priceid = 367
                      and t.goodsid = b.goodsownid)) / d.tinyrate) sellprice, --零售价

       --nvl((select t.price from lyerp.bms_entry_goods_price t where t.grade=2 and t.entryid=1 and t.priceid=4224 and t.goodsid=b.goodsownid),(select t.price from lyerp.bms_entry_goods_price t where t.grade=2 and t.entryid=1 and t.priceid=2384 and t.goodsid=b.goodsownid)) sellprice,--零售价
       case
         when d.tinyrate >= 1 then
          a.goodsqty * d.tinyrate
         else
          a.goodsqty / (round(1 / d.tinyrate, 0))
       end goodsqty, --数量,
       a.goodsqty * f.lydtlzxcolumn3 amt, --金额
       f.invoiceno, --发票号
       c.lotno, --批号
       a.inoutid wavedtlid, --条形码/整件为出入库ID
       0 flag, --标志
       1 comefrom --业务类型
  from wms_st_io_doc         a,
       tpl_goods             b,
       wms_goods_lot         c,
       lyerp.zx_101102       d,
       wms_wave_goods_dtl    e,
       wms_out_order_dtl     f,
       wms_out_order_lot_dtl g,
       wms_wave_dtl          h
 where a.ownergoodsid = b.ownergoodsid(+)
   and a.lotid = c.lotid(+)
   and e.wavedtlid = h.wavedtlid
   and nvl(h.canprintflag, 0) = 1
   and a.warehid = 1
   and a.goodsownerid = 1
   and a.companyid = 312 --厦门妇幼
   and a.credate > to_date('2025-01-01', 'yyyy-mm-dd')
   and a.wholeqty is not null --整件出库
   and a.operationtype = 11 --销售
   and a.comefrom in (2, 3) --来源出库
   and a.usestatus = 1 --正式
   and a.rfflag = 3 --任务状态执行完毕
   and a.sourceid = e.wavegoodsdtlid
   and e.wavegoodsdtlid = g.wavegoodsdtlid(+)
   and g.outdtlid = f.outdtlid
   and b.goodsownid = d.goodsid
   and not exists (select 1
          from zx_fyjk t
         where t.outdtlid = a.inoutid
           and t.comefrom = 1)

union all

select e.wavedtlid outdtlid, --订单号\随货同行号
       d.ypmc, --药品名称
       d.ypid, --药品编码
       b.approvedocno approvedocno, --批准文号
       d.ypgg, --规格
       to_char(c.validdate, 'yyyy-mm-dd') validdate, --有效期
       nvl(c.factname, b.factname) factname, --生产厂家
       nvl(d.dw, b.tradepackname) tradepackname, --单位
       decode(d.tinyrate,
              null,
              f.lydtlzxcolumn3,
              f.lydtlzxcolumn3 / d.tinyrate) price, --单价
       decode(d.tinyrate,
              null,
              nvl((select nvl(t.price,0)
                    from lyerp.bms_entry_goods_price t
                   where t.grade = 2
                     and t.entryid = 1
                     and t.priceid = 2464
                     and t.goodsid = b.goodsownid),
                  (select nvl(t.price,0)
                     from lyerp.bms_entry_goods_price t
                    where t.grade = 2
                      and t.entryid = 1
                      and t.priceid = 367
                      and t.goodsid = b.goodsownid)),
              nvl((select nvl(t.price,0)
                    from lyerp.bms_entry_goods_price t
                   where t.grade = 2
                     and t.entryid = 1
                     and t.priceid = 2464
                     and t.goodsid = b.goodsownid),
                  (select nvl(t.price,0)
                     from lyerp.bms_entry_goods_price t
                    where t.grade = 2
                      and t.entryid = 1
                      and t.priceid = 367
                      and t.goodsid = b.goodsownid)) / d.tinyrate) sellprice, --零售价

       --nvl((select t.price from lyerp.bms_entry_goods_price t where t.grade=2 and t.entryid=1 and t.priceid=4224 and t.goodsid=b.goodsownid),(select t.price from lyerp.bms_entry_goods_price t where t.grade=2 and t.entryid=1 and t.priceid=2384 and t.goodsid=b.goodsownid)) sellprice,--零售价
       case
         when d.tinyrate >= 1 then
          h.goodsqty * d.tinyrate
         else
          h.goodsqty / (round(1 / d.tinyrate, 0))
       end goodsqty, --数量,
       h.goodsqty * f.lydtlzxcolumn3 amt, --金额
       f.invoiceno, --发票号
       c.lotno, --批号
       to_number(a.inoutid) wavedtlid, --条形码/散件装箱总单ID
       0 flag, --标志
       2 comefrom --散件出库
  from wms_st_io_doc          a,
       tpl_goods              b,
       wms_goods_lot          c,
       lyerp.zx_101102        d,
       wms_wave_goods_dtl     e,
       wms_out_order_dtl      f,
       wms_out_order_lot_dtl  g,
       wms_turnbox_to_box_rel h,
       wms_box_dtl            i,
       wms_wave_dtl           j,
       wms_box_doc            k
 where a.ownergoodsid = b.ownergoodsid(+)
   and a.lotid = c.lotid(+)
   and e.wavedtlid = j.wavedtlid
   and nvl(j.canprintflag, 0) = 1
   and a.warehid = 1
   and a.goodsownerid = 1
   and a.companyid = 312 --厦门妇幼
   and a.credate > to_date('2025-01-01', 'yyyy-mm-dd')
   and a.scatterqty is not null --散件出库
   and a.operationtype = 11 --销售
   and a.comefrom in (2, 3) --来源出库
   and a.usestatus = 1 --正式
   and a.rfflag = 3 --任务状态执行完毕
   and a.sourceid = e.wavegoodsdtlid
   and e.wavegoodsdtlid = g.wavegoodsdtlid(+)
   and g.outdtlid = f.outdtlid
   and b.goodsownid = d.goodsid
   and a.inoutid = h.inoutid(+)
   and h.boxdtlid = i.dtlid(+)
   and i.docid=k.docid(+)
   and not exists (select 1
          from zx_fyjk t
         where t.outdtlid = to_number(a.inoutid)
           and t.comefrom = 2)
"
"ZX_FYJK_V2","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_FYJK_V2"" (""OUTDTLID"", ""YPMC"", ""YPID"", ""APPROVEDOCNO"", ""YPGG"", ""VALIDDATE"", ""FACTNAME"", ""TRADEPACKNAME"", ""PRICE"", ""SELLPRICE"", ""GOODSQTY"", ""AMT"", ""INVOICENO"", ""LOTNO"", ""WAVEDTLID"", ""FLAG"", ""GOODSOWNID"", ""GOODSOWNERID"") AS 
  select b.outdtlid, --订单号
       d.ypmc, --药品名称
       d.ypid, --药品编码
       e.approvedocno, --批准文号
       d.ypgg, --规格
       to_char(e.validdate, 'yyyy-mm-dd') validdate, --有效期
       nvl(e.factname, c.factname) factname, --生产厂家
       c.tradepackname, --单位
       decode(d.tinyrate,
              null,
              b.lydtlzxcolumn3,
              b.lydtlzxcolumn3 / d.tinyrate) price, --单价
       0 sellprice,
       case
         when d.tinyrate >= 1 then
          b.goodsqty * d.tinyrate
         else
          b.goodsqty / (round(1 / d.tinyrate, 0))
       end goodsqty, --数量,
       b.amt, --金额
       b.invoiceno, --发票号
       e.lotno, --批号
       a.wavedtlid, --条形码
       0 flag, --标志
       c.goodsownid,
       a.goodsownerid
  from wms_out_order     a,
       wms_out_order_dtl b,
       tpl_goods         c,
       lyerp.zx_101102   d,
       wms_goods_lot     e
 where a.outid = b.outid
   and b.ownergoodsid = c.ownergoodsid
   and c.goodsownid = d.goodsid(+)
   and b.lotid = e.lotid
   and a.goodsownerid = 1
   and a.reccompanyid = 312
   and a.credate > to_date('2018-08-02', 'yyyy-mm-dd')
   and a.operationtype = 11
   and b.usestatus = 5
"
"ZX_FYJK_V20180823","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_FYJK_V20180823"" (""OUTDTLID"", ""YPMC"", ""YPID"", ""APPROVEDOCNO"", ""YPGG"", ""VALIDDATE"", ""FACTNAME"", ""TRADEPACKNAME"", ""PRICE"", ""SELLPRICE"", ""GOODSQTY"", ""AMT"", ""INVOICENO"", ""LOTNO"", ""WAVEDTLID"", ""FLAG"", ""GOODSOWNID"") AS 
  select a.seqid outdtlid, --订单号
       d.ypmc, --药品名称
       d.ypid, --药品编码
       b.approvedocno approvedocno, --批准文号
       d.ypgg, --规格
       to_char(c.validdate, 'yyyy-mm-dd') validdate, --有效期
       nvl(c.factname, b.factname) factname, --生产厂家
       a.goodsunit tradepackname, --单位
       decode(d.tinyrate,
              null,
              e.lydtlzxcolumn3,
              e.lydtlzxcolumn3 / d.tinyrate) price, --单价
       0 sellprice,
       case
         when d.tinyrate >= 1 then
          a.outgoodsqty * d.tinyrate
         else
          a.outgoodsqty / (round(1 / d.tinyrate, 0))
       end goodsqty, --数量,
       a.outgoodsqty*e.lydtlzxcolumn3  amt, --金额
       e.invoiceno, --发票号
       c.lotno, --批号
       a.seqid wavedtlid, --条形码
       0 flag, --标志
       a.goodsownid
  from zx_out_label_print_xmfy   a,
       tpl_goods                 b,
       wms_goods_lot             c,
       lyerp.zx_101102           d,
       wms_out_order_dtl         e,
       wms_out_order_lot_dtl     f
 where a.ownergoodsid = b.ownergoodsid(+)
   and a.lotid = c.lotid(+)
   and a.warehid=1
   and a.goodsownerid=1
   and a.credate > to_date('2018-08-01', 'yyyy-mm-dd')
   and a.wavegoodsdtlid=f.wavegoodsdtlid(+)
   and e.outdtlid=f.outdtlid
   and a.goodsownid = d.goodsid
/*   and a.seqid in (1001899,
1001900,
1001913,
1001914,
1001915,
1002126)*/

  -- and not exists (select 1 from zx_fyjk t where t.outdtlid=b.outdtlid)
"
"ZX_FYJK_V3","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_FYJK_V3"" (""OUTDTLID"", ""YPMC"", ""YPID"", ""APPROVEDOCNO"", ""YPGG"", ""VALIDDATE"", ""FACTNAME"", ""TRADEPACKNAME"", ""PRICE"", ""SELLPRICE"", ""GOODSQTY"", ""AMT"", ""INVOICENO"", ""LOTNO"", ""WAVEDTLID"", ""FLAG"", ""COMEFROM"") AS 
  select e.wavedtlid outdtlid, --订单号\随货同行号
       d.ypmc, --药品名称
       d.ypid, --药品编码
       b.approvedocno approvedocno, --批准文号
       d.ypgg, --规格
       to_char(c.validdate, 'yyyy-mm-dd') validdate, --有效期
       nvl(c.factname, b.factname) factname, --生产厂家
       nvl(d.dw, b.tradepackname) tradepackname, --单位
       decode(d.tinyrate,
              null,
              f.lydtlzxcolumn3,
              f.lydtlzxcolumn3 / d.tinyrate) price, --进货价
       decode(d.tinyrate,
              null,
              nvl((select nvl(t.price,0)
                    from lyerp.bms_entry_goods_price t
                   where t.grade = 2
                     and t.entryid = 1
                     and t.priceid = 2464
                     and t.goodsid = b.goodsownid),
                  (select nvl(t.price,0)
                     from lyerp.bms_entry_goods_price t
                    where t.grade = 2
                      and t.entryid = 1
                      and t.priceid = 367
                      and t.goodsid = b.goodsownid)),
              nvl((select nvl(t.price,0)
                    from lyerp.bms_entry_goods_price t
                   where t.grade = 2
                     and t.entryid = 1
                     and t.priceid = 2464
                     and t.goodsid = b.goodsownid),
                  (select nvl(t.price,0)
                     from lyerp.bms_entry_goods_price t
                    where t.grade = 2
                      and t.entryid = 1
                      and t.priceid = 367
                      and t.goodsid = b.goodsownid)) / d.tinyrate) sellprice, --零售价

       --nvl((select t.price from lyerp.bms_entry_goods_price t where t.grade=2 and t.entryid=1 and t.priceid=4224 and t.goodsid=b.goodsownid),(select t.price from lyerp.bms_entry_goods_price t where t.grade=2 and t.entryid=1 and t.priceid=2384 and t.goodsid=b.goodsownid)) sellprice,--零售价
       case
         when d.tinyrate >= 1 then
          a.goodsqty * d.tinyrate
         else
          a.goodsqty / (round(1 / d.tinyrate, 0))
       end goodsqty, --数量,
       a.goodsqty * f.lydtlzxcolumn3 amt, --金额
       f.invoiceno, --发票号
       c.lotno, --批号
       a.inoutid wavedtlid, --条形码/整件为出入库ID
       0 flag, --标志
       1 comefrom --业务类型
  from wms_st_io_doc         a,
       tpl_goods             b,
       wms_goods_lot         c,
       lyerp.zx_101102       d,
       wms_wave_goods_dtl    e,
       wms_out_order_dtl     f,
       wms_out_order_lot_dtl g,
       wms_wave_dtl          h
 where a.ownergoodsid = b.ownergoodsid(+)
   and a.lotid = c.lotid(+)
   and e.wavedtlid = h.wavedtlid
   and nvl(h.canprintflag, 0) = 1
   and a.warehid = 1
   and a.goodsownerid = 1
   and a.companyid = 312 --厦门妇幼
   and a.credate > to_date('2018-08-01', 'yyyy-mm-dd')
   and a.wholeqty is not null --整件出库
   and a.operationtype = 11 --销售
   and a.comefrom in (2, 3) --来源出库
   and a.usestatus = 1 --正式
   and a.rfflag = 3 --任务状态执行完毕
   and a.sourceid = e.wavegoodsdtlid
   and e.wavegoodsdtlid = g.wavegoodsdtlid(+)
   and g.outdtlid = f.outdtlid
   and b.goodsownid = d.goodsid
   /*and not exists (select 1
          from zx_fyjk t
         where t.outdtlid = a.inoutid
           and t.comefrom = 1)*/

union all

select e.wavedtlid outdtlid, --订单号\随货同行号
       d.ypmc, --药品名称
       d.ypid, --药品编码
       b.approvedocno approvedocno, --批准文号
       d.ypgg, --规格
       to_char(c.validdate, 'yyyy-mm-dd') validdate, --有效期
       nvl(c.factname, b.factname) factname, --生产厂家
       nvl(d.dw, b.tradepackname) tradepackname, --单位
       decode(d.tinyrate,
              null,
              f.lydtlzxcolumn3,
              f.lydtlzxcolumn3 / d.tinyrate) price, --单价
       decode(d.tinyrate,
              null,
              nvl((select nvl(t.price,0)
                    from lyerp.bms_entry_goods_price t
                   where t.grade = 2
                     and t.entryid = 1
                     and t.priceid = 2464
                     and t.goodsid = b.goodsownid),
                  (select nvl(t.price,0)
                     from lyerp.bms_entry_goods_price t
                    where t.grade = 2
                      and t.entryid = 1
                      and t.priceid = 367
                      and t.goodsid = b.goodsownid)),
              nvl((select nvl(t.price,0)
                    from lyerp.bms_entry_goods_price t
                   where t.grade = 2
                     and t.entryid = 1
                     and t.priceid = 2464
                     and t.goodsid = b.goodsownid),
                  (select nvl(t.price,0)
                     from lyerp.bms_entry_goods_price t
                    where t.grade = 2
                      and t.entryid = 1
                      and t.priceid = 367
                      and t.goodsid = b.goodsownid)) / d.tinyrate) sellprice, --零售价

       --nvl((select t.price from lyerp.bms_entry_goods_price t where t.grade=2 and t.entryid=1 and t.priceid=4224 and t.goodsid=b.goodsownid),(select t.price from lyerp.bms_entry_goods_price t where t.grade=2 and t.entryid=1 and t.priceid=2384 and t.goodsid=b.goodsownid)) sellprice,--零售价
       case
         when d.tinyrate >= 1 then
          h.goodsqty * d.tinyrate
         else
          h.goodsqty / (round(1 / d.tinyrate, 0))
       end goodsqty, --数量,
       h.goodsqty * f.lydtlzxcolumn3 amt, --金额
       f.invoiceno, --发票号
       c.lotno, --批号
       to_number(k.boxcode) wavedtlid, --条形码/散件装箱总单ID
       0 flag, --标志
       2 comefrom --散件出库
  from wms_st_io_doc          a,
       tpl_goods              b,
       wms_goods_lot          c,
       lyerp.zx_101102        d,
       wms_wave_goods_dtl     e,
       wms_out_order_dtl      f,
       wms_out_order_lot_dtl  g,
       wms_turnbox_to_box_rel h,
       wms_box_dtl            i,
       wms_wave_dtl           j,
       wms_box_doc            k
 where a.ownergoodsid = b.ownergoodsid(+)
   and a.lotid = c.lotid(+)
   and e.wavedtlid = j.wavedtlid
   and nvl(j.canprintflag, 0) = 1
   and a.warehid = 1
   and a.goodsownerid = 1
   and a.companyid = 312 --厦门妇幼
   and a.credate > to_date('2018-08-01', 'yyyy-mm-dd')
   and a.scatterqty is not null --散件出库
   and a.operationtype = 11 --销售
   and a.comefrom in (2, 3) --来源出库
   and a.usestatus = 1 --正式
   and a.rfflag = 3 --任务状态执行完毕
   and a.sourceid = e.wavegoodsdtlid
   and e.wavegoodsdtlid = g.wavegoodsdtlid(+)
   and g.outdtlid = f.outdtlid
   and b.goodsownid = d.goodsid
   and a.inoutid = h.inoutid(+)
   and h.boxdtlid = i.dtlid(+)
   and i.docid=k.docid(+)
   /*and not exists (select 1
          from zx_fyjk t
         where t.outdtlid = to_number(k.boxcode)
           and t.comefrom = 2);*/
"
"ZX_FYJK_V_BAK","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_FYJK_V_BAK"" (""OUTDTLID"", ""YPMC"", ""YPID"", ""APPROVEDOCNO"", ""YPGG"", ""VALIDDATE"", ""FACTNAME"", ""TRADEPACKNAME"", ""PRICE"", ""SELLPRICE"", ""GOODSQTY"", ""AMT"", ""INVOICENO"", ""LOTNO"", ""WAVEDTLID"", ""FLAG"") AS 
  select b.outdtlid, --订单号
       d.ypmc, --药品名称
       d.ypid, --药品编码
       e.approvedocno, --批准文号
       d.ypgg, --规格
       to_char(e.validdate, 'yyyy-mm-dd') validdate, --有效期
       nvl(e.factname, c.factname) factname, --生产厂家
       c.tradepackname, --单位
       decode(d.tinyrate,
              null,
              b.lydtlzxcolumn3,
              b.lydtlzxcolumn3 / d.tinyrate) price, --单价
       0 sellprice,
       case
         when d.tinyrate >= 1 then
          b.goodsqty * d.tinyrate
         else
          b.goodsqty / (round(1 / d.tinyrate, 0))
       end goodsqty, --数量,
       b.amt, --金额
       b.invoiceno, --发票号
       e.lotno, --批号
       a.wavedtlid, --条形码
       0 flag --标志
  from wms_out_order     a,
       wms_out_order_dtl b,
       tpl_goods         c,
       lyerp.zx_101102   d,
       wms_goods_lot     e
 where a.outid = b.outid
   and b.ownergoodsid = c.ownergoodsid
   and c.goodsownid = d.goodsid
   and b.lotid = e.lotid
   and a.goodsownerid = 1
   and a.reccompanyid = 312
   and a.credate > to_date('2018-08-02', 'yyyy-mm-dd')
   and a.operationtype = 11
   and b.usestatus = 5
"
"ZX_GOODSIN2TURNBOX_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_GOODSIN2TURNBOX_V"" (""WAREHID"", ""WAVEDTLID"", ""WAVEGOODSDTLID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""PACKNAME"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""GOODSQTY"", ""WHOLEQTY"", ""SCATTERQTY"", ""INOUTID"", ""INOUTFLAG"", ""BOXDOCID"", ""DTLSCATTERQTY"", ""POSID"", ""POSNO"", ""BOXGOODSQTY"", ""PACKSIZE"", ""CONTAINERNO"", ""CREDATE"", ""WAVEID"") AS 
  select distinct b.warehid,
                a.wavedtlid,
                a.wavegoodsdtlid,
                a.ownergoodsid,
                a.goodsid,
                e.goodsname,
                e.goodstype,
                e.prodarea,
                d.packname,
                f.lotid,
                f.lotno,
               decode(to_char(f.validdate, 'yyyy-mm-dd'),
                      '2099-01-01',
                      to_date(null, 'yyyy-mm-dd'),
                      f.validdate) validdate,
                a.goodsqty,
                a.wholeqty,
                a.scatterqty,
                b.inoutid,
                b.inoutflag,
                b.boxdocid,
                b.scatterqty dtlscatterqty,
                b.posid,
                g.POSNO,
                c.boxgoodsqty,
                d.packsize,
                i.containerno,
                j.credate,
                k.waveid
  from wms_wave_goods_dtl  a,
       wms_st_io_doc       b,
       wms_goods_feature   c,
       tpl_pub_goods_packs d,
       tpl_pub_goods       e,
       wms_goods_lot       f,
       wms_pos_def         g,
       wms_turnbox_doc     h,
       wms_container_def   i,
       wms_task_doc        j,
       wms_wave_dtl        k
 where a.wavegoodsdtlid = b.sourceid
   and b.goodspackid = d.goodspackid
   and a.wavedtlid = k.wavedtlid
   and a.lotid = f.lotid
   and a.goodsid = e.goodsid
   and b.posid = g.POSID
   and b.boxdocid = h.boxdocid
   and h.containerid = i.containerid(+)
   and b.taskid = j.taskid
   and b.comefrom = 3
   and c.boxgoodsqty > d.packsize
   and a.goodsqty > d.packsize
   and a.goodsid = c.goodsid(+)
   and exists (select aa.wavegoodsdtlid
          from wms_wave_goods_dtl aa, wms_st_io_doc bb
         where aa.wavegoodsdtlid = bb.sourceid
           and aa.wavegoodsdtlid = a.wavegoodsdtlid
           and bb.comefrom = 3
           and bb.scatterqty > 0
         group by aa.wavegoodsdtlid
        having count(*) > 1)
"
"ZX_GOODSOWNER_EMPLOYEE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_GOODSOWNER_EMPLOYEE_V"" (""EMPLOYEEID"", ""EMPLOYEENAME"", ""DEPTID"", ""DEPTNAME"", ""WEBPWD"", ""GOODSOWNERID"", ""GOODSOWNERNAME"") AS 
  select a.employeeid,
       a.employeename,
       a.deptid,
       decode(a.deptid, 1, '质管部', 2, '业务部', '其它部门') deptname,
       a.webpwd,
       b.goodsownerid,
       b.goodsownername
  from zx_goodsowner_employee a, tpl_goodsowner b
 where a.goodsownerid = b.goodsownerid(+)
"
"ZX_GSP_QUALITY_FEEDBACK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_GSP_QUALITY_FEEDBACK_V"" (""FEEDBACKID"", ""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""OWNERGOODSID"", ""WAREGOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""DRUGFORM"", ""TRADEPACKNAME"", ""FACTNAME"", ""GOODSQTY"", ""CHECKQTY"", ""REALQTY"", ""LOTNO"", ""APPROVEDOCNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSSITUTION"", ""INPUTMANID"", ""EMPLOYEENAME"", ""ZGYIDEA"", ""ZGJLIDEA"", ""WTFQUALITYDEPTIDEA"", ""WTFQUALITYDEPTMANID"", ""WTFQUALITYDEPTMAN"", ""WTFQUALITYDEPTDATE"", ""WTFRELATEDEPTIDEA"", ""WTFRELATEDEPTMAIDID"", ""WTFRELATEDEPTMAN"", ""WTFRELATEDEPTDATE"", ""DEALRESULT"", ""USESTATUS"", ""MAH"", ""CONFIRMDATE"", ""QUALITYPERSON"", ""QUALITYPERSONDATE"", ""QUALITYPERSONIDEA"") AS 
  select a.feedbackid,
       a.credate,
       a.warehid,
       h.warehname,
       a.goodsownerid,
       d.goodsownername,
       a.companyid,
       c.companyname,
       a.ownergoodsid,
       b.waregoodsid,
       b.goodsownid,
       b.goodsname,
       b.goodsengname,
       b.goodstype,
       b.drugform,
       b.tradepackname,
       decode(a.factname,null,b.factname,a.factname) as factname,
       a.goodsqty,--应来货数量
       a.checkqty,--待复查数量
       a.goodsqty - a.checkqty as realqty, --实际来货数量
       a.lotno,
       a.approvedocno,
       a.proddate,
       a.validdate,
       a.goodssitution,
       a.inputmanid,
       e.employeename,
       a.zgyidea,
       a.zgjlidea,
       a.wtfqualitydeptidea,
       a.wtfqualitydeptmanid,
       nvl(f.employeename,a.wtfqualitydeptman) as  wtfqualitydeptman,
       a.wtfqualitydeptdate,
       a.wtfrelatedeptidea,
       a.wtfrelatedeptmaidid,
       nvl(g.employeename,a.wtfrelatedeptman) as  wtfrelatedeptman,
       a.wtfrelatedeptdate,
       a.dealresult,
       nvl(a.usestatus,0) usestatus,
       a.mah,
       a.confirmdate,
       a.qualityperson,
       a.qualitypersondate,
       a.qualitypersonidea
  from zx_gsp_quality_feedback a,
       tpl_goods            b,
       tpl_go_company       c,
       tpl_goodsowner       d,
       pub_employee         e,
       zx_goodsowner_employee f,
       zx_goodsowner_employee g,
       tpl_warehouse          h
 where a.ownergoodsid = b.ownergoodsid(+)
   and a.goodsownerid = d.goodsownerid(+)
   and a.companyid=c.companyid(+)
   and a.inputmanid = e.employeeid(+)
   and a.wtfqualitydeptmanid=f.employeeid(+)
   and a.wtfrelatedeptmaidid=g.employeeid(+)
   and a.warehid = h.warehid(+)
"
"ZX_GTOE_PURCHASE_ERROR_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_GTOE_PURCHASE_ERROR_V"" (""GOODSOWNERID"", ""GOODSOWNERNAME"", ""PORDERID"", ""CREDATE"", ""ARRIVEDATE"", ""SOURCECOMPANYID"", ""JOBTYPE"", ""OPERATIONTYPE"", ""MEDICINECLASS"", ""IMPORTFLAG"", ""TAXFLAG"", ""DTLLINES"", ""MEMO"", ""COMPANYSTYLE"", ""INMODE"", ""INPFLAG"", ""MULRECFLAG"", ""VALIDDAYS"", ""INVALIDATE"", ""ORDERFLAG"", ""DEPTNO"", ""DEPTNAME"", ""SALERNAME"", ""SABACKDATE"", ""SBREASONID"", ""WAREHID"", ""BMSDOCID"", ""ZXCOLUMN1"", ""ZXCOLUMN2"", ""ZXCOLUMN3"", ""ZXCOLUMN4"", ""ZXCOLUMN5"", ""TRANSID"", ""NOWLFLAG"", ""ZXCOLUMN6"", ""ZXCOLUMN7"", ""ZXCOLUMN8"", ""ZXCOLUMN9"", ""ZXCOLUMN10"", ""PORDERDTLID"", ""GOODSOWNID"", ""GOODSQTY"", ""BATCHNO"", ""LOTNO"", ""STORAGEID"", ""LOTFLAG"", ""BATCHFLAG"", ""COMEFLAG"", ""DTLMEMO"", ""GTRADEPACK"", ""PACKSIZE"", ""VALIDDATE"", ""PRODDATE"", ""SADTLID"", ""GOODSSTATUSID"", ""QUANTITYSTATUS"", ""APPROVEDOCNO"", ""FIRSTFLAG"", ""SPECIALTYPE"", ""AMT"", ""PACKNAME"", ""PRTCLASS"", ""DTLZXCOLUMN1"", ""DTLZXCOLUMN2"", ""DTLZXCOLUMN3"", ""DTLZXCOLUMN4"", ""DTLZXCOLUMN5"", ""ERRORMEMO"") AS 
  select t.""GOODSOWNERID"",
       ttt.goodsownername,
       t.""PORDERID"",
       t.""CREDATE"",
       t.""ARRIVEDATE"",
       t.""SOURCECOMPANYID"",
       t.""JOBTYPE"",
       t.""OPERATIONTYPE"",
       t.""MEDICINECLASS"",
       t.""IMPORTFLAG"",
       t.""TAXFLAG"",
       t.""DTLLINES"",
       t.""MEMO"",
       t.""COMPANYSTYLE"",
       t.""INMODE"",
       t.""INPFLAG"",
       t.""MULRECFLAG"",
       t.""VALIDDAYS"",
       t.""INVALIDATE"",
       t.""ORDERFLAG"",
       t.""DEPTNO"",
       t.""DEPTNAME"",
       t.""SALERNAME"",
       t.""SABACKDATE"",
       t.""SBREASONID"",
       t.""WAREHID"",
       t.""BMSDOCID"",
       t.""ZXCOLUMN1"",
       t.""ZXCOLUMN2"",
       t.""ZXCOLUMN3"",
       t.""ZXCOLUMN4"",
       t.""ZXCOLUMN5"",
       t.""TRANSID"",
       t.""NOWLFLAG"",
       t.""ZXCOLUMN6"",
       t.""ZXCOLUMN7"",
       t.""ZXCOLUMN8"",
       t.""ZXCOLUMN9"",
       t.""ZXCOLUMN10"",
       tt.""PORDERDTLID"",
       tt.""GOODSOWNID"",
       tt.""GOODSQTY"",
       tt.""BATCHNO"",
       tt.""LOTNO"",
       tt.""STORAGEID"",
       tt.""LOTFLAG"",
       tt.""BATCHFLAG"",
       tt.""COMEFLAG"",
       tt.""MEMO"" dtlmemo,
       tt.""GTRADEPACK"",
       tt.""PACKSIZE"",
       tt.""VALIDDATE"",
       tt.""PRODDATE"",
       tt.""SADTLID"",
       tt.""GOODSSTATUSID"",
       tt.""QUANTITYSTATUS"",
       tt.""APPROVEDOCNO"",
       tt.""FIRSTFLAG"",
       tt.""SPECIALTYPE"",
       tt.""AMT"",
       tt.""PACKNAME"",
       tt.""PRTCLASS"",
       tt.""DTLZXCOLUMN1"",
       tt.""DTLZXCOLUMN2"",
       tt.""DTLZXCOLUMN3"",
       tt.""DTLZXCOLUMN4"",
       tt.""DTLZXCOLUMN5"",
       '无货主单位信息，需下传供应商基础数据' errormemo
  from gtoe_purchase_order     t,
       gtoe_purchase_order_dtl tt,
       tpl_goodsowner          ttt
 where t.porderid = tt.porderid
   and t.goodsownerid = ttt.goodsownerid
   and not exists (select 1 from tpl_go_company a where a.goodsownerid=tt.goodsownerid and a.companystyle=2 and a.gcompanyid=t.sourcecompanyid) --add by zyc 20160601优化查询语句
   and t.goodsownerid<>178
  /* and t.sourcecompanyid not in
       (select a.gcompanyid
          from tpl_go_company a
         where a.goodsownerid = tt.goodsownerid
           and a.companystyle = 2)
*/


union all

select t.""GOODSOWNERID"",
       ttt.goodsownername,
       t.""PORDERID"",
       t.""CREDATE"",
       t.""ARRIVEDATE"",
       t.""SOURCECOMPANYID"",
       t.""JOBTYPE"",
       t.""OPERATIONTYPE"",
       t.""MEDICINECLASS"",
       t.""IMPORTFLAG"",
       t.""TAXFLAG"",
       t.""DTLLINES"",
       t.""MEMO"",
       t.""COMPANYSTYLE"",
       t.""INMODE"",
       t.""INPFLAG"",
       t.""MULRECFLAG"",
       t.""VALIDDAYS"",
       t.""INVALIDATE"",
       t.""ORDERFLAG"",
       t.""DEPTNO"",
       t.""DEPTNAME"",
       t.""SALERNAME"",
       t.""SABACKDATE"",
       t.""SBREASONID"",
       t.""WAREHID"",
       t.""BMSDOCID"",
       t.""ZXCOLUMN1"",
       t.""ZXCOLUMN2"",
       t.""ZXCOLUMN3"",
       t.""ZXCOLUMN4"",
       t.""ZXCOLUMN5"",
       t.""TRANSID"",
       t.""NOWLFLAG"",
       t.""ZXCOLUMN6"",
       t.""ZXCOLUMN7"",
       t.""ZXCOLUMN8"",
       t.""ZXCOLUMN9"",
       t.""ZXCOLUMN10"",
       tt.""PORDERDTLID"",
       tt.""GOODSOWNID"",
       tt.""GOODSQTY"",
       tt.""BATCHNO"",
       tt.""LOTNO"",
       tt.""STORAGEID"",
       tt.""LOTFLAG"",
       tt.""BATCHFLAG"",
       tt.""COMEFLAG"",
       tt.""MEMO"" dtlmeno,
       tt.""GTRADEPACK"",
       tt.""PACKSIZE"",
       tt.""VALIDDATE"",
       tt.""PRODDATE"",
       tt.""SADTLID"",
       tt.""GOODSSTATUSID"",
       tt.""QUANTITYSTATUS"",
       tt.""APPROVEDOCNO"",
       tt.""FIRSTFLAG"",
       tt.""SPECIALTYPE"",
       tt.""AMT"",
       tt.""PACKNAME"",
       tt.""PRTCLASS"",
       tt.""DTLZXCOLUMN1"",
       tt.""DTLZXCOLUMN2"",
       tt.""DTLZXCOLUMN3"",
       tt.""DTLZXCOLUMN4"",
       tt.""DTLZXCOLUMN5"",
       '无货主货品信息，需下传货品基础数据' errormemo
  from gtoe_purchase_order     t,
       gtoe_purchase_order_dtl tt,
       tpl_goodsowner          ttt
 where t.porderid = tt.porderid
   and t.goodsownerid = ttt.goodsownerid
   and not exists (select 1 from tpl_goods b where b.goodsownerid=tt.goodsownerid and b.goodsownid=tt.goodsownid and b.waregoodsid is not null and b.usestatus=1) --add by zyc 20160601优化查询语句

union all

select t.""GOODSOWNERID"",
       ttt.goodsownername,
       t.""PORDERID"",
       t.""CREDATE"",
       t.""ARRIVEDATE"",
       t.""SOURCECOMPANYID"",
       t.""JOBTYPE"",
       t.""OPERATIONTYPE"",
       t.""MEDICINECLASS"",
       t.""IMPORTFLAG"",
       t.""TAXFLAG"",
       t.""DTLLINES"",
       t.""MEMO"",
       t.""COMPANYSTYLE"",
       t.""INMODE"",
       t.""INPFLAG"",
       t.""MULRECFLAG"",
       t.""VALIDDAYS"",
       t.""INVALIDATE"",
       t.""ORDERFLAG"",
       t.""DEPTNO"",
       t.""DEPTNAME"",
       t.""SALERNAME"",
       t.""SABACKDATE"",
       t.""SBREASONID"",
       t.""WAREHID"",
       t.""BMSDOCID"",
       t.""ZXCOLUMN1"",
       t.""ZXCOLUMN2"",
       t.""ZXCOLUMN3"",
       t.""ZXCOLUMN4"",
       t.""ZXCOLUMN5"",
       t.""TRANSID"",
       t.""NOWLFLAG"",
       t.""ZXCOLUMN6"",
       t.""ZXCOLUMN7"",
       t.""ZXCOLUMN8"",
       t.""ZXCOLUMN9"",
       t.""ZXCOLUMN10"",
       tt.""PORDERDTLID"",
       tt.""GOODSOWNID"",
       tt.""GOODSQTY"",
       tt.""BATCHNO"",
       tt.""LOTNO"",
       tt.""STORAGEID"",
       tt.""LOTFLAG"",
       tt.""BATCHFLAG"",
       tt.""COMEFLAG"",
       tt.""MEMO"" dtlmemo,
       tt.""GTRADEPACK"",
       tt.""PACKSIZE"",
       tt.""VALIDDATE"",
       tt.""PRODDATE"",
       tt.""SADTLID"",
       tt.""GOODSSTATUSID"",
       tt.""QUANTITYSTATUS"",
       tt.""APPROVEDOCNO"",
       tt.""FIRSTFLAG"",
       tt.""SPECIALTYPE"",
       tt.""AMT"",
       tt.""PACKNAME"",
       tt.""PRTCLASS"",
       tt.""DTLZXCOLUMN1"",
       tt.""DTLZXCOLUMN2"",
       tt.""DTLZXCOLUMN3"",
       tt.""DTLZXCOLUMN4"",
       tt.""DTLZXCOLUMN5"",
       '无货主单位信息，需下传供应商基础数据' errormemo
  from gtoe_purchase_order     t,
       gtoe_purchase_order_dtl tt,
       tpl_goodsowner          ttt
 where t.porderid = tt.porderid
   and t.goodsownerid = ttt.goodsownerid
   and not exists (select 1 from tpl_go_company a where a.goodsownerid=tt.goodsownerid and a.companystyle=0 and a.gcompanyid=t.sourcecompanyid) --add by zyc 20160601优化查询语句
   and t.goodsownerid=178
"
"ZX_HZMANAGER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_HZMANAGER_V"" (""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""DISPATCHID"", ""DISPATCHDTLID"", ""GCOMPANYID"", ""COMPANYID"", ""COMPANYNAME"", ""INCEPTADDR"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CHAINHZFLAG"", ""FFZJHZFLAG"") AS 
  select distinct c.credate,
       c.warehid,
       d.warehname,
       a.dispatchid,
       a.dispatchdtlid,
       b.gcompanyid,
       b.companyid, --xyue 2014-06-02 增加货主单位ID
       b.companyname,
       b.inceptaddr,
       b.goodsownerid,
       b.goodsownername,
       nvl(a.chainhzflag,0) chainhzflag, --add xyue 2016-01-18 冷链回执标志
       nvl(a.FFZJhZFLAG,0)  FFZJhZFLAG-- add xyue 2016-01-18 复方制剂回执标志
  from tms_dispatch_dtl_v a,
       tms_tr_doc_v b,
       tms_dispatch_doc c,
       tpl_warehouse d,
       wms_out_order e,
       wms_out_order_dtl_v f,
       pub_ddl_dtl g
 where a.sourceid = b.sourceid
 and   a.dispatchid=c.dispatchid
 and   c.warehid=d.warehid(+)
 and   a.usestatus=1 --派车细单状态为正常
 and   e.wavedtlid=a.sourceid
 and   e.outid=f.outid
 and   f.goodsclass in (select t.ddlid from pub_ddl_dtl t where t.sysid=9 and (t.chainflag=1 or t.ffzjflag=1))
"
"ZX_IMP_WMS_IO_RECORD","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_IMP_WMS_IO_RECORD"" (""出入库ID"", ""创建时间"", ""完成时间"", ""物流中心ID"", ""物流中心"", ""货主ID"", ""货主名称"", ""出入库类型ID"", ""出入库类型"", ""来源类型ID"", ""来源类型"", ""货主单位ID"", ""单位名称"", ""货主货品ID"", ""货品ID"", ""货品名称"", ""商品名"", ""规格"", ""生产厂家"", ""产地"", ""剂型"", ""数量"", ""基本单位"", ""基长"", ""基宽"", ""基高"", ""散件数量"", ""整件数量"", ""外包装单位"", ""包装大小"", ""外长"", ""外宽"", ""外高"", ""批号ID"", ""批号"", ""货位ID"", ""货位名称"", ""货位类型"") AS 
  select t.inoutid 出入库ID,
       t.credate 创建时间,
       t.keepdate 完成时间,
       t.warehid 物流中心ID,
       a.warehname 物流中心,
       t.goodsownerid 货主ID,
       b.goodsownername 货主名称,
       t.inoutflag 出入库类型ID,
       decode(t.inoutflag,0,'入库方向',1,'出库方向',t.inoutflag) 出入库类型,
       t.comefrom 来源类型ID,
       decode(t.comefrom,0,'初始化',1,'入库',3,'出库',4,'库内移动',t.comefrom) 来源类型,
       t.companyid 货主单位ID,
       d.companyname 单位名称,
       t.ownergoodsid 货主货品ID,
       c.goodsownid 货品ID,
       c.goodsname 货品名称,
       c.goodsengname 商品名,
       c.goodstype 规格,
       c.factname 生产厂家,
       c.prodarea 产地,
       c.drugform 剂型,
       t.goodsqty 数量,
       c.tradepackname 基本单位,
       i.goodslength 基长,
       i.goodswidth 基宽,
       i.goodsheight 基高,
       nvl(t.scatterqty,0) 散件数量,
       nvl(t.wholeqty,0) 整件数量,
       e.packname 外包装单位,
       e.packsize 包装大小,
       nvl(h.goodslength,0) 外长,
       nvl(h.goodswidth,0) 外宽,
       nvl(h.goodsheight,0) 外高,
       t.lotid 批号ID,
       f.lotno 批号,
       t.posid 货位ID,
       j.posname 货位名称,
       decode(j.storelevel,1,'整件',2,'散件') 货位类型

  from wms_st_io_doc t,
       tpl_warehouse a,
       tpl_goodsowner b,
       tpl_goods      c,
       tpl_go_company d,
       tpl_pub_goods_packs e,
       wms_goods_lot f,
       (select tt.ddlid,tt.ddlname from sys_ddl_dtl tt where tt.sysid=389) g,
       tpl_pub_goods_packs h,
       (select ttt.goodsid,ttt.goodslength,ttt.goodswidth,ttt.goodsheight from tpl_pub_goods_packs ttt where ttt.baseunitflag=1) i,
       wms_pos_def_v j
 where t.warehid = 1
   and t.credate < to_date('2018-10-01', 'yyyy-mm-dd')
   and t.comefrom in (0,1,3,4) --入库、出库、初始化、库内移动
   and t.warehid = a.warehid(+)
   and t.goodsownerid = b.goodsownerid(+)
   and t.ownergoodsid=c.ownergoodsid(+)
   and t.companyid=d.companyid(+)
   and t.goodspackid=e.goodspackid(+)
   and t.lotid=f.lotid(+)
   and nvl(t.operationtype,0)=g.ddlid(+)
   and t.goodspackid=h.goodspackid(+)
   and t.goodsid=i.goodsid(+)
   and t.posid=j.posid(+)
"
"ZX_INVOMSG_BGFLAG_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_INVOMSG_BGFLAG_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSCLASS"", ""SEQID"") AS 
  select t.warehid,
       a.warehname,
       t.goodsownerid,
       b.goodsownername,
       t.goodsclass,
       t.seqid
  from zx_invomsg_bgflag t, tpl_warehouse a, tpl_goodsowner b
 where t.warehid = a.warehid(+)
   and t.goodsownerid = b.goodsownerid(+)
"
"ZX_KCJFMXCX_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_KCJFMXCX_V"" (""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSOPCODE"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTNAME"", ""GOODSQTY"", ""BUSIQTY"", ""OWNERGOODSID"", ""BATCHNO"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSOWNID"", ""GOODSNO"", ""STORAGECONDITION"", ""BUSISCOPE"", ""BUSISCOPENAME"", ""DRUGFORM"", ""GOODSTYPENAME"", ""JFGOODSQTY"", ""JFJE"") AS 
  select a.credate-1 credate,
       a.warehid,
       a.warehname,
       a.goodsownerid,
       a.goodsownername,
       a.goodsid,
       a.goodsopcode,
       a.goodsname,
       a.goodstype,
       a.prodarea,
       a.factid,
       a.factname,
       a.goodsqty,
       a.busiqty,
       a.ownergoodsid,
       a.batchno,
       a.goodspackid,
       a.packname,
       a.packsize,
       a.lotid,
       a.lotno,
       decode(to_char(a.validdate, 'yyyy-mm-dd'),
              '2099-01-01',
              to_date(null, 'yyyy-mm-dd'),
              a.validdate) validdate,
       a.proddate,
       a.approvedocno,
       a.goodsstatusid,
       a.goodsstatus,
       a.quantitystatus,
       a.useflag,
       a.goodsownid,
       a.goodsno,
       a.storagecondition,
       a.busiscope, --xlq 于20141023 增加 用于物流计费
       a.busiscopename,
       a.drugform,
       a.goodstypename,
       ceil(a.goodsqty/a.packsize) jfgoodsqty,
       ceil(a.goodsqty/a.packsize)*b.costrate jfje
  from tpl_st_qty_day_lst_v a, zx_tprice_go_price_dtlqry_v b
 where a.goodsownerid = b.goodsownerid(+)
   and b.usestatus(+)=1
   and b.priceid(+)=7
   and a.goodstypeid=b.goodstypeid(+)
"
"ZX_KCJFMXHZ_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_KCJFMXHZ_V"" (""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CREDATE"", ""GOODSTYPENAME"", ""JFGOODSQTY"", ""JEJE"") AS 
  select a.warehid,
       a.goodsownerid,
       a.goodsownername,
       a.credate,
       a.goodstypename,
       sum(a.jfgoodsqty) jfgoodsqty,
       sum(a.jfje) jeje
  from zx_kcjfmxcx_v a
 group by a.warehid,
          a.goodsownerid,
          a.goodsownername,
          a.credate,
          a.goodstypename
order by a.credate
"
"ZX_KL_ST_QTY_LST_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_KL_ST_QTY_LST_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSTYPE"", ""TRADEPACKNAME"", ""FACTNAME"", ""MAH"", ""APPROVEDOCNO"", ""PRODAREA"", ""GOODSQTY"", ""BUSIQTY"", ""POSQTY"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""PACKNAME"", ""PACKSIZE"") AS 
  select a.warehid, --物流中心ID
       b.warehname, --物流中心名称
       a.goodsownerid, --货主ID
       c.goodsownername, --货主名称
       a.ownergoodsid, --货主货品ID
       a.goodsid, --货品主档ID
       d.goodsownid, --物料号
       d.goodsname, --货品名称
       d.goodstype, --规格
       d.tradepackname, --基本单位
       d.factname, --生产厂家,
       d.mah, --上市许可持有人
       d.approvedocno, --批准文号
       d.prodarea, --产地
       sum(nvl(a.goodsqty, 0)) as GOODSQTY, --货品库存
       sum(nvl(a.busiqty, 0)) as BUSIQTY, --货品业务库存
       sum(nvl(a.posqty, 0)) as posqty, --货品货位库存
       f.lotno, --批号
       to_char(f.proddate, 'yyyy-mm-dd') as proddate, --生产日期
       to_char(f.validdate, 'yyyy-mm-dd') as validdate, --有效期至
       e.packname, --包装单位
       e.packsize --包装大小
  From wms_st_qty_lst      a,
       tpl_warehouse       b,
       tpl_goodsowner      c,
       tpl_goods           d,
       tpl_pub_goods_packs e,
       wms_goods_lot       f
 where a.warehid = b.warehid(+)
   and a.goodsownerid in (9168, 9169, 9170, 9171)
   and a.goodsownerid = c.goodsownerid(+)
   and a.ownergoodsid = d.ownergoodsid(+)
   and a.goodspackid = e.goodspackid(+)
   and a.lotid = f.lotid(+)
 group by a.warehid,
          b.warehname,
          a.goodsownerid,
          c.goodsownername,
          a.ownergoodsid,
          a.goodsid,
          d.goodsownid,
          d.goodsname,
          d.goodstype,
          d.tradepackname,
          d.factname,
          d.mah,
          d.approvedocno,
          d.prodarea,
          f.lotno,
          f.proddate,
          f.validdate,
          e.packname,
          e.packsize
"
"ZX_LQSFLAG","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_LQSFLAG"" (""DTLZXCOLUMN4"") AS 
  select b.dtlzxcolumn4
from wms_out_order a , wms_out_order_dtl b, TMS_TR_DOC c,tpl_goodsowner d
where a.outid=b.outid
and   c.sourceid= a.wavedtlid
and   a.operationtype=11 --业务类型为销售
and   c.sourcetable=1 --单据来源 波次释放
and   c.comefrom=1 --来源 wms转入
and   c.usestatus in (1,2) -- 初始和确认状态
and   a.goodsownerid = d.goodsownerid(+)
and   nvl(d.innerflag,0)=1
and   b.dtlzxcolumn4 is not null
and   a.credate>to_date('2022-12-01','yyyy-mm-dd') --and a.credate<to_date('2018-06-16','yyyy-mm-dd')

union all

select b.dtlzxcolumn4
from wms_out_order a , wms_out_order_dtl b,tpl_goodsowner d
where a.outid=b.outid
and   a.wavedtlid is not null
and   a.operationtype=11 --业务类型为销售
and   a.wavedtlid not in (select c.sourceid from TMS_TR_DOC c where c.sourcetable=1 and c.comefrom=1)
and   a.goodsownerid = d.goodsownerid(+)
and   nvl(d.innerflag,0)=1
and   b.dtlzxcolumn4 is not null
and   a.credate>to_date('2022-12-01','yyyy-mm-dd') --and a.credate<to_date('2018-06-16','yyyy-mm-dd')
"
"ZX_LQSFLAG_PK","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_LQSFLAG_PK"" (""WAVEDTLID"", ""OUTID"", ""OUTDTLID"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""LOTNO"", ""GOODSQTY"", ""TRADEGOODSPACK"", ""LQSFLAG"", ""WHOLEQTY"", ""BOXNO"", ""IWCS_WHOLEQTY"", ""IWCS_BOXNO"") AS 
  select a.wavedtlid,
       b.outid,
       b.outdtlid,
       b.goodsid,--货品主档ID
       b.goodsownid,--ERP货品ID
       b.goodsname,--货品名称
       b.goodstype,--货品规格
       b.factname,--生产厂商名称
       b.lotno,--批号
       b.goodsqty,--数量,
       b.tradegoodspack,
       c.lqsflag,
       d.wholeqty,
       d.boxno,
       d.iwcs_wholeqty,
       d.iwcs_boxno
  from wms_out_order         a,
       wms_out_order_dtl_v   b,
       lyerp.bms_sa_dtl      c,
       wms_out_order_lot_dtl d
 where a.outid = b.outid
   and a.operationtype = 11 --销售
   and a.goodsownerid in (select t.goodsownerid from tpl_goodsowner t where nvl(t.innerflag,0)=1)
   and b.dtlzxcolumn4 = c.salesdtlid(+)
   and b.outdtlid = d.outdtlid(+)
"
"ZX_PCD_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_PCD_V"" (""DISPATCHID"", ""CREDATE"", ""USESTATUS"", ""DISPATCHDATE"", ""REALDISPATCHDATE"", ""INPUTMAN"", ""DISPATCHMAN"", ""SELFTRANSTYPE"", ""COMPANYOPCODE"", ""COMPANYNAME"", ""DRIVERNAME"", ""DRIVERNAME2"", ""TRANSMODEL"", ""ROUTENAME"", ""INTOWNFLAG"", ""TERRACENO"", ""VEHICLENO"", ""VEHICLEMODEL"", ""TOTALPACKS"", ""TOTALCUBAGE"", ""TOTALWEIGHT"", ""TOTALPACKS2"", ""TOTALCUBAGE2"", ""TOTALWEIGHT2"", ""PREDISTANCE"", ""PREGAS"", ""TRANSCLASS"", ""UPDOWNMAN"", ""UPDOWNDATE"", ""ROUTEID"", ""TERRACEID"", ""VEHICLEID"", ""DRIVERID"", ""DRIVER2ID"", ""TRCOMPANYID"", ""MEMO"", ""INPUTMANID"", ""DISPATCHMANID"", ""WAREHNAME"", ""WAREHID"", ""FEEFLAG"", ""REALDISTANCE"", ""REALGAS"", ""RETURNDATE"", ""BACKDESCR"", ""TASKTYPE"", ""TRNO"", ""GOODSOWNERNAME"", ""DTLCOMPANYNAME"", ""CONNECTOR"", ""CONNPHONE"", ""INCEPTADDR"", ""WHOLEPACKS"", ""SCATTERPACKS"", ""OPERATIONTYPE"", ""WEIGHT"", ""CUBAGE"", ""FIXQTY"", ""TOTALPACKS3"", ""DTKMEMO"", ""STEVEDORE"", ""DTLUSESTATUS"", ""DISPATCHDTLID"", ""GOODSOWNERID"", ""GCOMPANYID"", ""TRID"", ""DTLDISPATCHID"", ""BACKTIME"", ""BACKMAN"", ""DTLBACKDESCR"", ""CHAINFLAG"", ""ZONENAME"", ""ZZXRWS"", ""ADDMEDCHECKFLAG"", ""CHAINUSESTATUS"", ""SOURCEID"", ""BILLNO"", ""SIGNFLAG"", ""DEPTNAME"") AS 
  select a.dispatchid,
       a.credate,
       a.usestatus,
       a.dispatchdate,
       a.realdispatchdate,
       a.inputman,
       a.dispatchman,
       a.selftranstype,
       a.companyopcode,
       a.companyname,
       a.drivername,
       a.drivername2,
       a.transmodel,
       a.routename,
       a.intownflag,
       a.terraceno,
       a.vehicleno,
       a.vehiclemodel,
       nvl(a.totalpacks,0) totalpacks,
       nvl(a.totalcubage,0) totalcubage,
       nvl(a.totalweight,0) totalweight,
       nvl(a.totalpacks2,0) totalpacks2,
       nvl(a.totalcubage2,0) totalcubage2,
       nvl(a.totalweight2,0) totalweight2,
       nvl(a.predistance,0) predistance,
       nvl(a.pregas,0) pregas,
       a.transclass,
       a.updownman,
       a.updowndate,
       a.routeid,
       a.terraceid,
       a.vehicleid,
       a.driverid,
       a.driver2id,
       a.trcompanyid,
       a.memo,
       a.inputmanid,
       a.dispatchmanid,
       a.warehname,
       a.warehid,
       a.feeflag,
       a.realdistance,
       nvl(a.realgas,0) realgas,
       a.returndate,
       a.backdescr,
       b.tasktype,
       b.trno,
       b.goodsownername,
       b.companyname dtlcompanyname,
       b.connector,
       b.connphone,
       b.inceptaddr,
       nvl(b.wholepacks,0) wholepacks,
       nvl(b.scatterpacks,0) scatterpacks,
       b.operationtype,
       nvl(b.weight,0) weight,
       nvl(b.cubage,0) cubage,
       nvl(b.fixqty,0) fixqty,
       nvl(b.totalpacks,0)  totalpacks3,--取细单上的件数
       b.memo dtkmemo,
       b.stevedore,
       b.usestatus dtlusestatus,
       b.dispatchdtlid,
       b.goodsownerid,
       b.gcompanyid,
       b.trid,
       b.dispatchid dtldispatchid,
       b.backtime,
       b.backman,
       b.backdescr dtlbackdescr,
       c.chainflag,
       (case when d.prtclass like '%冷%' then '冷藏区' when d.prtclass like '%毒%' then '毒麻区' when d.prtclass like '%麻%' then '毒麻区' else c.zonename end ) zonename,
       --null zzxrws
       --decode(b.goodsownerid,340,decode(nvl(b.scatterpacks,0),0,0,1,1,(select count(1) from zx_zyc_zzxrws_v t where t.waveid=d.waveid and t.goodsownerid=b.goodsownerid and t.companyid=d.customid)),null) zzxrws,
       (case when b.goodsownerid in (340,8124,8129)
       then decode(nvl(b.scatterpacks,0),0,0,1,1,(select count(1) from zx_zyc_zzxrws_v t where t.waveid=d.waveid and t.goodsownerid=b.goodsownerid and t.companyid=d.customid))
       else null end) zzxrws,--add by xyue 2019-10-11
       e.addmedcheckflag , --add by zyc 20160901
       b.chainusestatus,     --add by tl 20171229  冷链回执标志
       c.sourceid,-- add by xyue 2018-06-26 随货同行联号
       zx_pf_print_transinvo(c.sourceid) billno, -- add by xyue 2018-06-26 发票号码
       nvl(b.signflag,0) signflag, -- add by xyue 2018-06-28 签收标志
       (select distinct tt.deptname from wms_out_order tt where tt.wavedtlid=b.sourceid) deptname --add by xyue 2018-08-10 业务部门
       from Tms_dispatch_doc_v a,Tms_dispatch_dtl_v b,tms_tr_doc_v c,wms_wave_dtl_v d,Tpl_go_company e
       where a.DISPATCHID=b.DISPATCHID(+)
       and   b.TRID=c.TRID(+)
       and   b.usestatus<>1 --去掉作废状态
       and   c.SOURCEID=d.wavedtlid(+)
       and b.gcompanyid=e.companyid(+)
"
"ZX_RECEIPT_CHECKDETAIL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_RECEIPT_CHECKDETAIL_V"" (""TRID"", ""GOODSOWNERID"", ""GCOMPANYID"", ""COMPANYNAME"", ""USESTATUS"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTID"", ""FACTNAME"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""LOTID"", ""LOTNO"", ""GOODSQTY"", ""SIGNFLAG"", ""SIGNQTY"", ""DIFFQTY"", ""SIGNMANSEQID"", ""ZX_OUTERMAN"", ""SIGNMAN2"", ""SIGNDATE"", ""MEMO"", ""OUTLOTID"", ""OUTDTLID"", ""OUTID"", ""FLAG"", ""RECEIPTFLAG"") AS 
  SELECT
       A.TRID,
       A.GOODSOWNERID,
       A.gcompanyid,
       F.companyname,

       T.USESTATUS,
       T.GOODSID,
       T.GOODSNAME,
       T.GOODSTYPE,
       T.FACTID,
       T.FACTNAME,

       T.GOODSPACKID,
       T.PACKNAME,
       T.PACKSIZE,

       Tt.LOTID,
       Tt.LOTNO,
       Tt.GOODSQTY,

       DECODE (D.OUTlotID,NULL,0,1) SIGNFLAG,
       NVL(D.SIGNQTY, Tt.GOODSQTY) SIGNQTY,
       nvl(D.diffqty,0) DIFFQTY,
       nvl(D.SIGNMANseqid,C.seqid) signmanSEQID,
       e.zx_outerman,
       D.SIGNMAN2,
       nvl(d.SIGNDATE,SYSDATE) signdate,
       D.MEMO,

       Tt.outlotid,
       T.OUTDTLID,
       T.outid,
       D.OUTLOTID FLAG，
       G.usestatus receiptflag-- add by wanghuaiyu 2013年7月24日 22:50:07

  FROM
       TMS_TR_DOC             A,
        wms_wave_goods_dtl     B,
       wms_out_order_lot_dtl_V  tt,
       WMS_OUT_ORDER_DTL_V    T,
       ZX_RECEIPT_CHECKDETAIL D,
       ---
        TPL_GO_COMPANY_MAN    E,
       (SELECT max(seqid) seqid,COMPANYID FROM TPL_GO_COMPANY_MAN GROUP BY companyid) C,
       tpl_go_company F,
       tms_dispatch_dtl G

 WHERE A.SOURCETABLE = 1
   AND A.SOURCEID = B.WAVEDTLID
   AND B.wavegoodsdtlid=TT.wavegoodsdtlid
   AND TT.OUTDTLID = T.outdtlid
   AND TT.outlotid = D.outlotid(+)
   and t.usestatus <> 0
   and a.trid = g.trid(+)--add by wanghuaiyu 2013年7月24日 22:48:24
   ---
   AND D.SIGNMANseqID = E.Seqid(+)
   AND A.gcompanyid=F.companyid(+)
   AND A.gcompanyid=C.companyid(+)
"
"ZX_SETBOXCODE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_SETBOXCODE_V"" (""WAVEDTLID"", ""WAREHID"", ""WAREHNAME"", ""ROUTEID"", ""ROUTENAME"", ""ZONEID"", ""ZONENAME"", ""DDLNAME"", ""PICKFLAG"") AS 
  select wavedtl.wavedtlid,
       t.warehid,
       t.warehname,
       tt.routeid,
       tt.routename,
       tt.zoneid,
       tt.zonename,
       sysdtl.ddlname,
       decode(sysdtl.ddlname,null,null,'-'||sysdtl.ddlname) pickflag
  from wms_wave_dtl wavedtl,
       Wms_ship_zone_v t,
       wms_tr_route_v tt,
       (select a.ddlid, a.ddlname from pub_ddl_dtl a where a.sysid = 728) sysdtl
 where tt.zoneid = t.zoneid(+)
   and t.SORTPORT = sysdtl.ddlid(+)
   and wavedtl.routeid = tt.routeid(+)
"
"ZX_SHGL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_SHGL_V"" (""INID"", ""ZXCOLUMN4"", ""USESTATUS"", ""OPERATIONTYPE"", ""CREDATE"", ""ARRIVEDATE"", ""SRCCOMPANYNAME"", ""SRCNO"", ""SOURCECOMPANYID"", ""WAREHNAME"", ""WAREHID"", ""ZXCOLUMN2"", ""GOODSOWNERNAME"", ""GOODSOWNERID"", ""INDTLID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSENGNAME"", ""PORDERSTATUS"", ""GOODSOWNID"", ""GOODSID"", ""GOODSCLASS"", ""GOODSQTY"", ""APPROVEDOCNO"", ""GOODSTYPE"", ""FACTNAME"", ""PRODAREA"", ""DTLZXCOLUMN4"", ""QTY"", ""DHWD"", ""SHQK"", ""YCFLAG"", ""CLFLAG"", ""YSFS"", ""YSTJ"", ""TRANSNAME"", ""SHDATE"", ""SHR"", ""SHRID"", ""SRCDTLNO"", ""MEMOTEMP"", ""MEMOFLAGA"", ""MEMOFLAGB"", ""MEMOFLAGC"", ""MEMOA"", ""MEMOB"", ""MEMOC"", ""GCWDFLAG"", ""PHNAME"", ""TRADEGOODSPACK"", ""MEDICINETYPE"", ""PACKNAME"", ""PACKSIZE"", ""DHDATE"", ""LOTNO"", ""PZXFFLAG"", ""QYWD"", ""WDCJDATE"", ""TZWDFLAG"", ""CJQNO"", ""QYDATE"", ""DHDATE1"", ""TRANSNO"", ""TRANSTOOLS"", ""INVOICECODE"", ""INVOICENO"", ""INVOICEDATE"", ""SHTXL"", ""DRUGFORM"", ""CAMERAID"", ""BARCODE"", ""SHIPCERTIFICATE"", ""STORAGECONDITION"", ""TSCY"", ""MAH"", ""MEMO"", ""ECODEFLAG"", ""WAVEDTLID"", ""FROM_SALESID"", ""UDIQTY"", ""FROM_SALESDTLID"", ""PACKMSG"", ""GCOMPANYID"", ""SUPPLYERADDRESS"", ""WARECHECKLICENSE"", ""CHECKLICENSE"", ""ISGSPCONTROL"", ""BUSISCOPENAME"", ""AUTOPASSFLAG"", ""TO_SOURCECOMPANYID"", ""TO_SOURCECOMPANYNAME"", ""WEIGHTFLAG"", ""SHREMIND"", ""QWDATEFLAG"", ""DHDATEFLAG"", ""COMEGOODSQTY"", ""REMAINFLAG"", ""ZX_WDFW"", ""PRODLICENSENO"", ""ORDERNO"", ""PRICE"", ""AMT"") AS 
  select a.inid, --入库订单ID
       a.zxcolumn4, --ERP总单ID
       a.usestatus, --总单状态
       a.operationtype, --业务类型
       a.credate, --制单日期
       a.arrivedate, --预定到货日
       d.companyname srccompanyname, --来货单位名称
       a.srcno, --来源细单ID
       a.sourcecompanyid, --来源单位ID
       c.warehname, --物流中心名称
       a.warehid, --物流中心ID
       a.zxcolumn2, --采购员
       f.goodsownername, --货主名称
       a.goodsownerid, --货主ID
       b.indtlid, --入库细单ID
       b.ownergoodsid, --货主货品ID
       j.goodsname, --货品名称
       j.goodsengname, --商品名
       b.porderstatus, --细单状态
       decode(a.goodsownerid, 9142, j.goodsno, j.goodsownid) as goodsownid, --货主源货品ID
       b.goodsid, --货品主档ID
       (select t.goodsclass
          from wms_goods_feature t
         where t.warehid = a.warehid
           and t.goodsid = b.goodsid) goodsclass, --存储分类
       b.goodsqty, --原单数量
       --nvl(b.approvedocno,j.approvedocno) as approvedocno, --取入库细单上的批准文号
       (case
         when a.goodsownerid in (6, 244, 284, 304, 424, 444, 636, 658, 682) then
          nvl(b.approvedocno, j.approvedocno)
         else
          j.approvedocno
       end) as approvedocno,
       j.goodstype, --规格
       --nvl(b.factname,j.factname) as factname, --取入库细单上的生产厂商
       (case
         when a.goodsownerid in (6, 244, 284, 304, 424, 444, 636, 658, 682) then
          nvl(b.factname, j.factname)
         else
          j.factname
       end) as factname,
       e.prodarea, --产地
       b.dtlzxcolumn4, --ERP细单ID
       b.qty, --收货数量
       b.dhwd, --到货温度
       b.shqk, --收货情况
       b.ycflag, --异常标志
       nvl(b.clflag, 0) clflag, --处理标志
       B.YSFS, --运输方式
       decode(a.warehid,
              2,
              (select aa.transclass
                 from wms_goods_feature aa
                where b.goodsid = aa.goodsid(+)
                  and a.warehid = aa.warehid(+)),
              14,
              (select aa.transclass
                 from wms_goods_feature aa
                where b.goodsid = aa.goodsid(+)
                  and a.warehid = aa.warehid(+)),
              1,
              (select aa.transclass
                 from wms_goods_feature aa
                where b.goodsid = aa.goodsid(+)
                  and a.warehid = aa.warehid(+)),
              12,
              (select aa.transclass
                 from wms_goods_feature aa
                where b.goodsid = aa.goodsid(+)
                  and a.warehid = aa.warehid(+)),
              (case
                when j.storagecondition = 3 then
                 2
                when j.storagecondition = 4 then
                 3
                else
                 1
              end)) ystj, --福州两物流中心的运输条件取货品存储属性上的运输条件值 by tl@190814,厦门物流中心 xyue 20191231
       h.transname, --运输方式
       b.shdate, --收货日期
       k.employeename shr, --收货人
       b.shrid, --收货人ID
       b.srcdtlno, --货主原始单据ID
       b.memotemp,
       b.memoflagA,
       b.memoflagB,
       b.memoflagC,
       b.memoA,
       b.memoB,
       b.memoC,
       b.gcwdflag,
       b.phname,
       j.tradepackname tradegoodspack, --change by xyue 取货主货品信息上的交易单位
       j.drugform medicinetype, --剂型
       l.packname, --包装名称
       l.packsize, --包装大小
       b.dhdate, --add by xyue 2016-09-20 到货时间
       b.lotno, --add by xyue 2017-01-17 销退自带的批号
       b.pzxfflag, --票账相符标志
       b.qywd, --启运温度 add by xyue 2024-07-09
       b.wdcjdate, --温度采集时间
       b.tzwdflag, --途中温度是否合格标志
       b.cjqno, --温度采集器编号
       b.qydate, --启运时间
       b.dhdate1, --到货时间（宝诺用的）
       b.transno, --运输单号
       b.transtools, --运输工具
       b.invoicecode, --add by ybh 20161222 发票编码
       b.invoiceno, --add by ybh 20161222 发票号
       b.invoicedate, --add by ybh 20161222 发票日期
       b.shtxl, --add by ybh 20161222   随货同行联
       j.drugform, --add by xyue 2017-05-05 剂型
       b.cameraid,
       e.barcode, --add by xyue 2018-10-10 EAN条形码
       b.shipcertificate, --add by tl@181218  麻精运输证明
       j.storagecondition, --货主货品存储条件
       trunc(sysdate) - trunc(nvl(b.dhdate1, sysdate - 365)) tscy,
       --nvl(b.mah,j.mah) as mah, --取入库细单上的上市许可持有人
       (case
         when a.goodsownerid in (6, 244, 284, 304, 424, 444, 636, 658, 682) then
          nvl(b.mah, j.mah)
         else
          j.mah
       end) as mah,
       a.memo, --by tl@200727物流入库订单总单备注
       nvl(j.ecodeflag, 0) ecodeflag, --add by llq 2020-12-31
       (select t1.wavedtlid
          from wms_out_order t1
         where t1.zxcolumn4 = to_char(a.from_salesid)
           and t1.usestatus <> 0
           and a.operationtype = 1) wavedtlid,
       a.from_salesid,
       b.udiqty,
       b.from_salesdtlid,
       (select listagg(t.packname || '=' || t.packsize, ',') within group(order by t.packname || '=' || t.packsize)
          from tpl_pub_goods_packs t
         where t.baseunitflag in (2)
           and t.goodsid = b.goodsid) packmsg,
       d.gcompanyid, --add by hts 2022-12-02 货主原单位ID
       d.supplyeraddress, --tl@240716
       (select x.checklicense
          from tpl_goodsowner_to_warehouse x
         where x.warehid = a.warehid
           and x.goodsownerid = a.goodsownerid) warechecklicense, --物流中心GSP标志
       f.checklicense, --货主GSP标志
       j.isgspcontrol, --货主货品GSP标志
       nvl(j.busiscopename, ' ') busiscopename,
       nvl(a.autopassflag, 0) autopassflag, --转单标志
       a.to_sourcecompanyid, --转单来货单位ID
       g.companyname to_sourcecompanyname, --转单来货单位
       (select sign(count(1))
          from tpl_goods_packs xx
         where xx.ownergoodsid = b.ownergoodsid
           and xx.baseunitflag = 2
           and xx.weightunit = 1) weightflag,
       (case
         when trunc(sysdate) - trunc(a.credate) > 60 and a.warehid = 2 and
              nvl(b.clflag, 0) = 0 then
          1
         else
          0
       end) shremind, --tl@240619 福州物流中心未收货且订单日期比当前日期早60的红色显示
       (case
         when a.warehid in (2, 14) and j.storagecondition in (3, 4) and
              b.dhwd is null then
          0
         else
          1
       end) as qwdateflag,
       (case
         when a.warehid in (2, 14) and b.dhdate is null then
          0
         else
          1
       end) as dhdateflag,
       b.comegoodsqty,
       b.remainflag,
       j.zx_wdfw, --温度范围
       b.prodlicenseno, --入库细单上的生产许可证号
       a.orderno, --雨诺单据编号
       b.price,
       b.goodsqty*b.price as amt
  from wms_in_order        a,
       wms_in_order_dtl    b,
       tpl_go_company      d,
       tpl_warehouse       c,
       tpl_pub_goods       e,
       tpl_goodsowner      f,
       tpl_go_company      g,
       wms_transport_mode  h,
       tpl_goods           j,
       PUB_EMPLOYEE        K,
       tpl_pub_goods_packs l
 where a.inid = b.inid
   and a.warehid = c.warehid
   and b.goodsid = e.goodsid
   and a.goodsownerid = f.goodsownerid
   and b.ownergoodsid = j.ownergoodsid
   and b.ysfs = h.transmodeid(+)
   and a.to_sourcecompanyid = g.companyid(+)
   and a.sourcecompanyid = d.companyid(+)
   AND B.SHRID = K.EMPLOYEEID(+)
   and b.goodspackid = l.goodspackid(+)
   and nvl(b.recheckflag, 0) = 0 -- add by xyue 2017-03-13 不显示由验收差异产生的入库订单
"
"ZX_TL_BOX_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_TL_BOX_V"" (""WAVEDTLID"", ""WAREHID"", ""NEWSJPACKS"") AS 
  select
    cc.wavedtlid,
    cc.warehid,
    sum(cc.newsjpacks)  newsjpacks


 from

 (select
          aa.wavedtlid,
          aa.warehid,
         count(aa.usetype) newsjpacks
       from wms_box_doc aa ,tms_tr_doc bb
         where aa.wavedtlid = bb.sourceid
           and aa.usetype = 0
           and aa.warehid in (2,14)
         group by aa.wavedtlid,aa.warehid
       union all
       select
         aa.wavedtlid,
         aa.warehid,
         1 newsjpacks
       from wms_box_doc aa,tms_tr_doc bb
       where aa.wavedtlid =bb.sourceid
         and aa.usetype = 1
          and aa.warehid in (2,14)
       group by aa.wavedtlid,aa.warehid)  cc


  group by cc.wavedtlid,cc.warehid
"
"ZX_TL_GOODSPACKS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_TL_GOODSPACKS_V"" (""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSOPCODE"", ""BARCODE"", ""GOODSPINYIN"", ""DRUGFORM"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTID"", ""FACTNAME"", ""TRADEPACKNAME"", ""LOTFACTNAME"", ""GOODSQTY"", ""BUSIQTY"", ""POSQTY"", ""POSWAITQTY"", ""TRADEINWAITQTY"", ""OUTWAITQTY"", ""OWNERGOODSID"", ""BATCHNO"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""POSID"", ""POSNO"", ""POSNAME"", ""AREAID"", ""AREANO"", ""AREANAME"", ""SECTIONID"", ""SECTIONNO"", ""SECTIONNAME"", ""SORTTYPE"", ""AREATYPE"", ""AREAFLAG"", ""LOTID"", ""LOTNO"", ""VALIDDATE"", ""PRODDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""USEFLAG"", ""GOODSOWNID"", ""GOODSNO"", ""SUPPLYERNAME"", ""VARIETYDESCID"", ""VARIETYNAME"", ""VARIETYNO"", ""CONTAINERID"", ""CONTAINERNO"", ""TYPEID"", ""PCS"", ""FILEGROUPIDC"", ""GOODSCLASS"") AS 
  select ""WAREHID"",
       ""WAREHNAME"",
       ""GOODSOWNERID"",
       ""GOODSOWNERNAME"",
       ""GOODSID"",
       ""GOODSOPCODE"",
       ""BARCODE"",
       ""GOODSPINYIN"",
       ""DRUGFORM"",
       ""GOODSNAME"",
       ""GOODSENGNAME"",
       ""GOODSTYPE"",
       ""PRODAREA"",
       ""FACTID"",
       ""FACTNAME"",
       ""TRADEPACKNAME"",
       ""LOTFACTNAME"",
       ""GOODSQTY"",
       ""BUSIQTY"",
       ""POSQTY"",
       ""POSWAITQTY"",
       ""TRADEINWAITQTY"",
       ""OUTWAITQTY"",
       ""OWNERGOODSID"",
       ""BATCHNO"",
       ""GOODSPACKID"",
       ""PACKNAME"",
       ""PACKSIZE"",
       ""POSID"",
       ""POSNO"",
       ""POSNAME"",
       ""AREAID"",
       ""AREANO"",
       ""AREANAME"",
       ""SECTIONID"",
       ""SECTIONNO"",
       ""SECTIONNAME"",
       ""SORTTYPE"",
       ""AREATYPE"",
       ""AREAFLAG"",
       ""LOTID"",
       ""LOTNO"",
       ""VALIDDATE"",
       ""PRODDATE"",
       ""APPROVEDOCNO"",
       ""GOODSSTATUSID"",
       ""GOODSSTATUS"",
       ""QUANTITYSTATUS"",
       ""USEFLAG"",
       ""GOODSOWNID"",
       ""GOODSNO"",
       null SUPPLYERNAME,
       ""VARIETYDESCID"",
       ""VARIETYNAME"",
       ""VARIETYNO"",
       ""CONTAINERID"",
       ""CONTAINERNO"",
       ""TYPEID"",
       ""PCS"",
       ""FILEGROUPIDC"",
       ""GOODSCLASS""

  from wms_st_qty_lst_v a

 where a.warehid = 2

   and exists

 (select 1
          from tpl_pub_goods_packs b
         where a.goodsid = b.goodsid
           and ((b.baseunitflag = 0 and b.packsize = 9999) or
               (b.baseunitflag = 1 and b.goodslength = 5.55 and
               b.goodswidth = 5.55 and b.goodsheight = 5.55) or
               (b.baseunitflag = 0 and b.goodslength = 25.5 and
               b.goodswidth = 25.5 and b.goodsheight = 25.5)))
"
"ZX_TL_SHAREDPOS_GOODSNUMBER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_TL_SHAREDPOS_GOODSNUMBER_V"" (""KCRQ"", ""WAREHID"", ""POSID"", ""GOODSNUMBER"") AS 
  select
      aa.kcrq,
      aa.warehid,
      aa.posid,
        sum(aa.goodsnumber1)  goodsnumber

   from


  (select
     a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.posid,
     count( distinct a.goodsid)  goodsnumber1




   from WMS_ST_QTY_LST_BAK a

    group by a.kcrq,
     a.warehid,
     a.goodsownerid,
     a.posid)     aa


    group by aa.kcrq,
      aa.warehid,
      aa.posid
"
"ZX_TL_SPEPOS_NEW_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_TL_SPEPOS_NEW_V"" (""KCRQ"", ""WAREHID"", ""POSID"", ""SPEFLAG"") AS 
  select
        a.kcrq,
        a.warehid,
        a.posid,

       --decode (   (count(distinct(a.goodsownerid))),1,1,0) speflag
       (case
         when count(distinct(a.goodsownerid))>1
           then 0
             when count(distinct(a.goodsid))=1
               then 1
                 else 2
                   end )  speflag





  from WMS_ST_QTY_LST_BAK a

 group by a.kcrq,a.warehid,a.posid
"
"ZX_TL_SPEPOS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_TL_SPEPOS_V"" (""KCRQ"", ""WAREHID"", ""POSID"", ""SPEFLAG"") AS 
  select
        a.kcrq,
        a.warehid,
        a.posid,

       decode (   (count(distinct(a.goodsownerid))),1,1,0) speflag

  from WMS_ST_QTY_LST_BAK a

 group by a.kcrq,a.warehid,a.posid
"
"ZX_TL_TGFLAG_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_TL_TGFLAG_V"" (""WAVEDTLID"", ""TGFLAG"") AS 
  select

      distinct a.wavedtlid,
      1  tgflag



from wms_out_order  a,
     wms_out_order_dtl  b


where   a.outid = b.outid

  and exists (select  1  from wms_goods_feature  c

                where b.goodsid = c.goodsid
                   and c.goodsclass=13
                   and c.warehid = a.warehid)
"
"ZX_TL_TGFLAG_V20190610","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_TL_TGFLAG_V20190610"" (""WAVEDTLID"", ""TGFLAG"") AS 
  select

      distinct a.wavedtlid,
      case when
       exists  (select  1  from wms_goods_feature  c

                where b.goodsid = c.goodsid
                   and c.goodsclass=13
                   and c.wholepickrate =5
                   and c.warehid = a.warehid)
       then 1
         when
          exists  (select  1  from wms_goods_feature  c

                where b.goodsid = c.goodsid
                   and c.goodsclass=13
                   and c.wholepickrate <>5
                   and c.warehid = a.warehid)
       then 2
       else 0
       end     tgflag




from wms_out_order  a,
     wms_out_order_dtl  b


where   a.outid = b.outid
"
"ZX_TL_WMSQTY_POSGOODSNUMBER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_TL_WMSQTY_POSGOODSNUMBER_V"" (""KCRQ"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSID"", ""AREAFLAG1"", ""STORAGECONDITION"", ""POSID"", ""GOODSNUMBER"") AS 
  select
   distinct a.kcrq,
   a.warehid,
   a.goodsownerid,
   a.goodsid,
   a.areaflag1,
   a.storagecondition,
   a.posid,
   b.goodsnumber
 from
    zx_tl_wms_qty_pos_v  a,
    zx_tl_sharedpos_goodsnumber_v  b
where
     a.posflag=0
 and a.kcrq=b.kcrq
 and a.warehid=b.warehid
 and a.posid=b.posid(+)
"
"ZX_TL_WMSQTY_POSGOODSNUMBER_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_TL_WMSQTY_POSGOODSNUMBER_V1"" (""KCRQ"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSID"", ""AREAFLAG1"", ""STORAGECONDITION"", ""DRUGFORM"", ""GOODSSTATUSID"", ""POSID"", ""GOODSNUMBER"") AS 
  select
   distinct a.kcrq,
   a.warehid,
   a.goodsownerid,
   a.goodsid,
   a.areaflag1,
   a.storagecondition,
   a.drugform,
   a.goodsstatusid,
   a.posid,
   b.goodsnumber
 from
    zx_tl_wms_qty_pos_v  a,
    zx_tl_sharedpos_goodsnumber_v  b
where
     a.posflag=0
 and a.kcrq=b.kcrq
 and a.warehid=b.warehid
 and a.posid=b.posid(+)
"
"ZX_TL_WMS_QTY_POS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_TL_WMS_QTY_POS_V"" (""KCRQ"", ""WAREHID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""DRUGFORM"", ""GOODSQTY"", ""POSID"", ""POSNAME"", ""AREAID"", ""AREANAME"", ""SECTIONID"", ""SECTIONNAME"", ""AREAFLAG"", ""AREAFLAG1"", ""STORAGECONDITION"", ""GOODSOWNID"", ""FACTNAME"", ""GOODSPACKID"", ""PACKSIZE"", ""JS"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""VOLUME"", ""POSFLAG"") AS 
  select
    a.kcrq,
    a.warehid,
    a.goodsownerid,
    h.goodsownername,
    a.goodsid,
    e.goodsname,
    e.goodstype,
    e.drugform,
    a.goodsqty,
    a.posid,
    b.posname,
    b.areaid,
    b.areaname,
    b.sectionid,
    b.sectionname,
    b.areaflag,
     case
      when substr(b.posname,1,1) in ('4','5')  and substr(b.posname,-2) <> '00' and b.areaflag = 1
        then 3
          when substr(b.posname,1,2) in ('6C','6D') and b.areaflag=2
            then 1 --6c6d开头的散件,定义为整件托盘
          else b.areaflag
   end   areaflag1, --整件类型根据货位号再区分出3，为整件货架
    c.storagecondition,
    c.goodsownid,
    c.factname,
    a.goodspackid,
    d.packsize,
    decode(nvl(d.packsize,0),0,0,ceil(a.goodsqty/d.packsize)) js,
    a.lotid,
    f.lotno,
    f.proddate,
    f.validdate,
    a.goodsstatusid,
    g.goodsstatus,
    a.goodsqty*( select  nvl(t1.goodscubage,0) from tpl_pub_goods_packs t1  where a.goodsid = t1.goodsid(+)  and t1.baseunitflag=1)    volume,
    zx_get_posflag(a.kcrq,a.warehid,a.posid)  posflag
  --  zx_get_pos_goodsnumber(a.kcrq,a.warehid,a.posid)  goodsnumber  --货位上的货品ＩＤ数
 from



    wms_st_qty_lst_bak  a,
     wms_pos_def_v      b,
    tpl_goods c,
    tpl_pub_goods_packs d,
    tpl_pub_goods e,
    wms_goods_lot f,
    wms_goodsstatus g,
    tpl_goodsowner  h


  where a.posid = b.posid
  and a.ownergoodsid = c.ownergoodsid(+)
  and a.goodspackid = d.goodspackid(+)
  and a.goodsid = e.goodsid
  and a.lotid = f.lotid(+)
  and a.goodsstatusid = g.goodsstatusid(+)
  and a.goodsownerid = h.goodsownerid
"
"ZX_TPRICE_GO_PRICE_DTLQRY_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_TPRICE_GO_PRICE_DTLQRY_V"" (""DOCID"", ""DTLID"", ""GOODSOWNERID"", ""GOODSTYPEID"", ""PRICEID"", ""COSTRATE"", ""USESTATUS"") AS 
  select a.docid,
       b.dtlid,
       a.goodsownerid,
       b.goodstypeid,
       b.priceid,
       b.costrate,
       a.usestatus
  from Tprice_go_price_doc a, Tprice_go_store_dtl b
 where a.docid = b.docid
"
"ZX_TWOBOXING_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_TWOBOXING_DOC_V"" (""CREDATE"", ""INOUTID"", ""WAVEDTLID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PACKNAME"", ""PACKSIZE"", ""PRODAREA"", ""FACTORYNAME"", ""LOTNO"", ""VALIDDATE"", ""GOODSQTY"", ""WHOLEQTY"", ""AREANAME"", ""SECTIONNAME"", ""POSNO"", ""GOODSOWNID"", ""GOODSID"", ""DEPTNAME"", ""CUSTOMNAME"", ""FLOWLINENO"", ""ROUTEID"", ""ROUTENAME"", ""TRANSID"", ""INCEPTADDR"", ""SENDPOS"", ""CONNECTOR"", ""CONNPHONE"", ""TRADEPACKNAME"", ""DDLNAME"", ""URGENFLAG"", ""WAVEMANFLAG"", ""ZONENAME"", ""ZONENO"", ""REGOODSQTY"", ""WAVEGOODSDTLID"") AS 
  select a.credate, --制单时间
       a.inoutid,--出入库明细（条码）
       c.wavedtlid,--随货同行联号
       a.ownergoodsid,--货主货品id
       a.goodsname,--品名
       a.goodstype,--规格
       a.packname,--包装名称
       a.packsize,--包装大小
       a.prodarea,--产地
       a.factoryname,--生产厂家
       a.lotno,--批号
       to_char(a.validdate,'yyyy-mm-dd') validdate,--效期
       a.goodsqty,--交易数量
       a.wholeqty,--整件数
       a.areaname,--库区名称
       a.sectionname,--分区名称
       a.posno,--货位
       a.goodsownid,--货主原货品id
       a.goodsid,--货品主档id
       c.deptname,--销售部门
       a.companyname customname,--客户名称
       c.flowlineno,--集货线流水号
       c.ROUTEID,--线路id
       m.routename,--线路名称
       c.transid,--地点id
       e.inceptaddr,--地址
       e.sendpos,--地点名称
       e.connector,--联系人
       e.connphone,--联系电话
       a.tradepackname,--交易单位
       n.ddlname,--业务类型
       j.urgenflag,--急单标志
       j.inputmanid wavemanflag,--发波人
       m.zonename,--集货区名称
       m.zoneno,--集货区编码
       a.goodsqty - nvl(t.boxqty,0) regoodsqty,
       b.wavegoodsdtlid
  from WMS_ST_IO_DOC_V         a,
       WMS_WAVE_GOODS_DTL      b,
       WMS_WAVE_DTL            c,
       TPL_WAREHOUSE           d,
       WMS_TRANSPORT_ADDRESS   e,
       WMS_ST_AREA_DEF         g,
       Sys_Ddl                 i,
       sys_ddl_dtl             n,
       WMS_TR_ROUTE_v          m,
       WMS_WAVE_DOC            j,
       (select inoutid,sum(boxqty) boxqty from zx_twoboxing group by inoutid) t

 where
        a.sourceid = b.wavegoodsdtlid
   and b.wavedtlid = c.wavedtlid
   and a.inoutid = t.inoutid(+)
   and a.warehid = d.WAREHID(+)
   and c.transid = e.transid(+)
   and g.areaid(+) = a.areaid
   and g.areaflag in (0,1)
   and a.comefrom = 3
   and i.keyword = 'TPL_OPERATIONTYPE'
   and a.operationtype = n.ddlid
   and i.sysid = n.sysid
   and j.wavedocid = c.waveid
   and c.routeid=m.routeid(+)
   and a.companyid = 300
"
"ZX_TWOBOXING_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_TWOBOXING_DTL_V"" (""INOUTID"", ""TWODTLID"", ""BOXQTY"", ""WBOXID"", ""CONTAINERNO"", ""BOXMANID"", ""BOXMANNAME"", ""BOXDATE"") AS 
  select a.inoutid,--出入库ID
       a.twodtlid,--二次包装细单ID
       a.boxqty,--装箱数量
       a.wboxid,--外用周转箱ID
       b.containerno,--外用周转箱名称
       a.boxmanid,--装箱人ID
       h.employeename boxmanname,--装箱人
       a.boxdate--装箱时间
from zx_twoboxing a,
     wms_container_def b,
     pub_employee h
where a.wboxid = b.containerid
and   b.typeid = 2 --只有外用周转箱
and   a.boxmanid = h.employeeid(+)
"
"ZX_TWOBOXING_PRINT_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_TWOBOXING_PRINT_V"" (""CREDATE"", ""WAVEID"", ""WAVEDTLID"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CUSTOMID"", ""CUSTOMNAME"", ""TRANSID"", ""INCEPTADDR"") AS 
  select t.CREDATE,
tt.waveid,
tt.wavedtlid,
tt.goodsownerid,
tt.goodsownername,
tt.customid,
tt.customname,
tt.transid,
tt.inceptaddr
from wms_wave_doc_v t ,wms_wave_dtl_v tt
where t.WAVEDOCID = tt.waveid
and tt.customid = 300
"
"ZX_UDID_IN_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_UDID_IN_ORDER_V"" (""RECORDID"", ""CREDATE"", ""SOURCEID"", ""ECODE"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""TRADEPACKNAME"", ""OPERATIONTYPE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"") AS 
  select a.recordid,--主键ID
       c.checkdate credate,--入库时间
       b.sourceid,
       a.ecode,--UDI码
       b.warehid,--物流中心ID
       e.warehname,--物流中心名称
       b.ownergoodsid,--货主货品ID
       d.waregoodsid goodsid,--货品主档ID
       d.goodsname,--货品名称
       d.goodstype,--规格
       d.prodarea,--产地
       d.factname factname,--生产厂家
       b.goodspackid,--包装ID
       h.packname,--包装名称
       h.packsize,--包装大小
       b.lotid,--批号ID
       i.lotno,--批号
       i.proddate,--生产日期
       i.validdate,--有效期
       i.approvedocno,--批准文号
       b.goodsstatusid,--货品状态ID
       j.goodsstatus,--货品状态
       j.quantitystatus,--质量状态
       d.tradepackname,--基本单位
       l.ddlname operationtype,--业务类型
       b.goodsownerid,--货主ID
       g.goodsownername,--货主名称
       b.companyid,--来货单位ID
       f.companyname--来货单位
  from wms_ecode_record_goodsseq a,
       wms_st_io_doc             b,
       wms_receive_dtl           c,
       tpl_goods                 d,
       tpl_go_company            f,
       tpl_warehouse             e,
       tpl_goodsowner            g,
       tpl_pub_goods_packs       h,
       wms_goods_lot             i,
       wms_goodsstatus           j,
       wms_in_order_dtl          k，
       sys_ddl_dtl               l
 where a.sourceid = b.sourceid
   and a.inoutflag = 0 --入库采集
   and b.companyid = f.companyid(+)
   and b.ownergoodsid = d.ownergoodsid(+)
   and b.warehid = e.warehid(+)
   and b.goodsownerid = g.goodsownerid(+)
   and b.goodspackid = h.goodspackid(+)
   and b.lotid = i.lotid(+)
   and b.goodsstatusid = j.goodsstatusid(+)
   and b.comefrom = 1
   and nvl(a.comefrom, 0) = 0
   and b.sourceid=c.receiveid
   and k.indtlid=c.indtlid
   and l.sysid(+)=389
   and b.operationtype=l.ddlid(+)
   and b.goodsownerid=164
"
"ZX_UDID_IO_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_UDID_IO_V"" (""RECORDID"", ""CREDATE"", ""SOURCEID"", ""ECODE"", ""WAREHID"", ""WAREHNAME"", ""WAREHADDRESS"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""TRADEPACKNAME"", ""OPERATIONTYPE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"", ""INOUTFLAG"") AS 
  select a.recordid,--主键ID
       c.checkdate credate,--入库时间
       b.sourceid,
       a.ecode,--UDI码
       b.warehid,--物流中心ID
       e.warehname,--物流中心名称
       e.warehaddress,--物流中心地址
       b.ownergoodsid,--货主货品ID
       d.waregoodsid goodsid,--货品主档ID
       d.goodsname,--货品名称
       d.goodstype,--规格
       d.prodarea,--产地
       d.factname factname,--生产厂家
       b.goodspackid,--包装ID
       h.packname,--包装名称
       h.packsize,--包装大小
       b.lotid,--批号ID
       i.lotno,--批号
       i.proddate,--生产日期
       i.validdate,--有效期
       i.approvedocno,--批准文号
       b.goodsstatusid,--货品状态ID
       j.goodsstatus,--货品状态
       j.quantitystatus,--质量状态
       d.tradepackname,--基本单位
       l.ddlname operationtype,--业务类型
       b.goodsownerid,--货主ID
       g.goodsownername,--货主名称
       b.companyid,--来货单位ID
       f.companyname,--来货单位
       a.inoutflag
  from wms_ecode_record_goodsseq a,
       wms_st_io_doc             b,
       wms_receive_dtl           c,
       tpl_goods                 d,
       tpl_go_company            f,
       tpl_warehouse             e,
       tpl_goodsowner            g,
       tpl_pub_goods_packs       h,
       wms_goods_lot             i,
       wms_goodsstatus           j,
       wms_in_order_dtl          k，
       sys_ddl_dtl               l
 where a.sourceid = b.sourceid
   and a.inoutflag = 0 --入库采集
   and b.companyid = f.companyid(+)
   and b.ownergoodsid = d.ownergoodsid(+)
   and b.warehid = e.warehid(+)
   and b.goodsownerid = g.goodsownerid(+)
   and b.goodspackid = h.goodspackid(+)
   and b.lotid = i.lotid(+)
   and b.goodsstatusid = j.goodsstatusid(+)
   and b.comefrom = 1
   and nvl(a.comefrom, 0) = 0
   and b.sourceid=c.receiveid
   and k.indtlid=c.indtlid
   and l.sysid(+)=389
   and b.operationtype=l.ddlid(+)
   and b.goodsownerid=164

union all

select a.recordid,--主键ID
       b.rffindate credate,--出库时间
       b.sourceid,
       a.ecode,--UDI码
       b.warehid,--物流中心ID
       e.warehname,--物流中心名称
       e.warehaddress,--物流中心地址
       b.ownergoodsid,--货主货品ID
       d.waregoodsid goodsid,--货品主档ID
       d.goodsname,--货品名称
       d.goodstype,--规格
       d.prodarea,--产地
       d.factname factname,--生产厂家
       b.goodspackid,--包装ID
       h.packname,--包装名称
       h.packsize,--包装大小
       b.lotid,--批号ID
       i.lotno,--批号
       i.proddate,--生产日期
       i.validdate,--有效期
       i.approvedocno,--批准文号
       b.goodsstatusid,--货品状态ID
       j.goodsstatus,--货品状态
       j.quantitystatus,--质量状态
       d.tradepackname,--基本单位
       l.ddlname operationtype,--业务类型
       b.goodsownerid,--货主ID
       g.goodsownername,--货主名称
       b.companyid,--出库单位ID
       f.companyname,--出库单位
       a.inoutflag
  from wms_ecode_record_goodsseq a,
       wms_st_io_doc             b,
       tpl_goods                 d,
       tpl_go_company            f,
       tpl_warehouse             e,
       tpl_goodsowner            g,
       tpl_pub_goods_packs       h,
       wms_goods_lot             i,
       wms_goodsstatus           j，
       sys_ddl_dtl               l
 where a.sourceid = b.inoutid
   and a.inoutflag = 1 --出库采集
   and b.companyid = f.companyid(+)
   and b.ownergoodsid = d.ownergoodsid(+)
   and b.warehid = e.warehid(+)
   and b.goodsownerid = g.goodsownerid(+)
   and b.goodspackid = h.goodspackid(+)
   and b.lotid = i.lotid(+)
   and b.goodsstatusid = j.goodsstatusid(+)
   and b.comefrom = 3
   and nvl(a.comefrom, 0) = 0
   and l.sysid(+)=389
   and b.operationtype=l.ddlid(+)
   and b.goodsownerid=164
"
"ZX_UDID_OUT_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_UDID_OUT_ORDER_V"" (""RECORDID"", ""CREDATE"", ""SOURCEID"", ""ECODE"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""GOODSPACKID"", ""PACKNAME"", ""PACKSIZE"", ""LOTID"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""APPROVEDOCNO"", ""GOODSSTATUSID"", ""GOODSSTATUS"", ""QUANTITYSTATUS"", ""TRADEPACKNAME"", ""OPERATIONTYPE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""COMPANYID"", ""COMPANYNAME"") AS 
  select a.recordid,--主键ID
       b.rffindate credate,--出库时间
       b.sourceid,
       a.ecode,--UDI码
       b.warehid,--物流中心ID
       e.warehname,--物流中心名称
       b.ownergoodsid,--货主货品ID
       d.waregoodsid goodsid,--货品主档ID
       d.goodsname,--货品名称
       d.goodstype,--规格
       d.prodarea,--产地
       d.factname factname,--生产厂家
       b.goodspackid,--包装ID
       h.packname,--包装名称
       h.packsize,--包装大小
       b.lotid,--批号ID
       i.lotno,--批号
       i.proddate,--生产日期
       i.validdate,--有效期
       i.approvedocno,--批准文号
       b.goodsstatusid,--货品状态ID
       j.goodsstatus,--货品状态
       j.quantitystatus,--质量状态
       d.tradepackname,--基本单位
       l.ddlname operationtype,--业务类型
       b.goodsownerid,--货主ID
       g.goodsownername,--货主名称
       b.companyid,--出库单位ID
       f.companyname--出库单位
  from wms_ecode_record_goodsseq a,
       wms_st_io_doc             b,
       tpl_goods                 d,
       tpl_go_company            f,
       tpl_warehouse             e,
       tpl_goodsowner            g,
       tpl_pub_goods_packs       h,
       wms_goods_lot             i,
       wms_goodsstatus           j，
       sys_ddl_dtl               l
 where a.sourceid = b.inoutid
   and a.inoutflag = 1 --出库采集
   and b.companyid = f.companyid(+)
   and b.ownergoodsid = d.ownergoodsid(+)
   and b.warehid = e.warehid(+)
   and b.goodsownerid = g.goodsownerid(+)
   and b.goodspackid = h.goodspackid(+)
   and b.lotid = i.lotid(+)
   and b.goodsstatusid = j.goodsstatusid(+)
   and b.comefrom = 3
   and nvl(a.comefrom, 0) = 0
   and l.sysid(+)=389
   and b.operationtype=l.ddlid(+)
   and b.goodsownerid=164
"
"ZX_UDID_PRIMARYDEVICEID_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_UDID_PRIMARYDEVICEID_V"" (""RECORDID"", ""ECODE"") AS 
  select a.recordid,a.ecode
  from wms_ecode_record_goodsseq a, wms_St_io_doc b
 where a.inoutflag = 0
   and a.sourceid = b.sourceid
   and nvl(a.udi_flag,0)=0
   and b.comefrom=1
   and b.goodsownerid=164
"
"ZX_UDI_INBACK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_UDI_INBACK_V"" (""INDTLID"", ""INOUTID"", ""UDICODE"") AS 
  select b.indtlid,f.inoutid,g.udicode
  from wms_in_order          a,
       wms_in_order_dtl      b,
       wms_out_order         c,
       wms_out_order_dtl     d,
       wms_out_order_lot_dtl e,
       wms_st_io_doc         f,
       wms_udi_code_record   g
 where a.inid = b.inid
   and a.operationtype = 7 --销退
   and a.usestatus = 1 --入库订单下单状态
   and nvl(b.clflag, 0) = 0 --未收货
   and to_char(a.from_salesid)=c.zxcolumn4
   and to_char(b.from_salesdtlid)=d.dtlzxcolumn4
   and c.outid = d.outid
   and d.outdtlid=e.outdtlid
   and e.wavegoodsdtlid=f.sourceid
   and f.comefrom=3
   and c.operationtype=11 --出库单业务类型为销售
   and c.usestatus=4 --出库单已出货
   and g.sourceid=f.inoutid
   and g.inoutflag=1 --出库方向
   and a.goodsownerid=c.goodsownerid --入库和出库订单属于同个货主
"
"ZX_WATCH_STORAGECONDITION_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WATCH_STORAGECONDITION_V"" (""ZXID"", ""GOODSOWNERID"", ""WAREGOODSID"", ""MSG"", ""CTIME"", ""GOODSOWNERNAME"", ""WAREGOODSNAME"", ""GOODSTYPE"", ""PRODAREA"", ""FACTNAME"", ""DRUGFORM"", ""STORAGECONDITION"", ""PRODLICENSENO"", ""APPROVEDOCNO"", ""OWNERGOODSID"") AS 
  select aa.""ZXID"",
aa.""GOODSOWNERID"",
aa.""WAREGOODSID"",
aa.""MSG"",
aa.""CTIME"",
bb.goodsownername,
bb.waregoodsname,
bb.goodstype,
bb.prodarea,
bb.factname,
bb.drugform,
bb.STORAGECONDITION,
bb.prodlicenseno,
bb.approvedocno,
bb.ownergoodsid

from
zx_watch_storagecondition aa ,
Tpl_goods_v bb
where
aa.goodsownerid=bb.goodsownerid
and aa.ownergoodsid=bb.ownergoodsid
and aa.msg like '%改成%'
"
"ZX_WBOX_FLOW_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WBOX_FLOW_V"" (""CONTAINERID"", ""CONTAINERNO"", ""CREDATE"", ""DOCID"", ""BOXMANOPCODE"", ""BOXMAN"", ""BOXMANID"", ""CUSTOMID"", ""CUSTOMNAME"", ""OUTBINDTIME"", ""OUTTERID"", ""OUTRETTIME"", ""OUTRETFLAG"", ""OPERATIONTYPE"", ""MEMO"", ""GCOMPANYID"", ""WAVEDTLID"", ""WAREHID"", ""WAREHNAME"") AS 
  select t.containerid, --外用周转箱ID
       t.containerno, --外用周转箱号
       t.credate,--制单时间
       t.docid,--总单ID
       t.boxmanopcode,--装箱人操作码
       t.boxman,--装箱人
       t.boxmanid,--装箱人ID
       t.customid,--客户ID
       t.customname,--客户名称
       t.outbindtime outbindtime,--外用周转箱绑定时间
       t.outterid,--外用周转箱ID
       t.outrettime,--外用周转箱回收时间
       t.outretflag,--外用周转箱回收标志
       t.operationtype,--业务类型
       t.memo,--单据备注
       t.gcompanyid,--ERP客户ID
       t.wavedtlid,--随货同行联号
       t.warehid,--物流中心ID
       t.warehname--物流中心

  from Wms_box_doc_v t,wms_container_def_v tt
 where  tt.containerid = t.containerid
"
"ZX_WBOX_MANAGER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WBOX_MANAGER_V"" (""CONTAINERID"", ""CONTAINERNO"", ""USESTATUS"", ""CREDATE"", ""DOCID"", ""BOXMAN"", ""BOXMANID"", ""CUSTOMID"", ""CUSTOMNAME"", ""WARECID"", ""OUTBINDTIME"", ""OUTRETTIME"", ""OUTRETFLAG"", ""OPERATIONTYPE"", ""MEMO"", ""GCOMPANYID"", ""WAVEDTLID"", ""WAREHID"", ""WAREHNAME"") AS 
  select c.containerid, --外用周转箱ID
       c.containerno, --外用周转箱号
       c.usestatus，--使用状态
       bag.credate,--制单时间
       bag.docid,--总单ID
       bag.boxman,--装箱人
       bag.boxmanid,--装箱人ID
       bag.customid,--客户ID
       bag.customname,--客户名称
       bag.warecid,--单位主档ID
       bag.outbindtime,--外用周转箱绑定时间
       bag.outrettime,--外用周转箱回收时间
       bag.outretflag,--外用周转箱回收标志
       bag.operationtype,--业务类型
       bag.memo,--单据备注
       bag.gcompanyid,--ERP客户ID
       bag.wavedtlid,--随货同行联号
       bag.warehid,--物流中心ID
       bag.warehname--物流中心

from
(select a.*
  from Wms_box_doc_v a,
       (select t.containerid, max(t.outbindtime) outbindtime
          from wms_box_doc_v t
         group by t.containerid) b
 where a.containerid = b.containerid
   and a.outbindtime = b.outbindtime
   ) bag,
   wms_container_def_v c
   where c.containerid = bag.containerid(+)
   and c.typeid = 2
   --and c.warehid=1
"
"ZX_WBOX_TOTAL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WBOX_TOTAL_V"" (""CUSTOMID"", ""CUSTOMNAME"", ""WARECID"", ""LESSWEEK"", ""LESSMONTH"", ""MOREMONTH"", ""TOTAL"") AS 
  select t.customid,
       t.customname,
       t.warecid, --单位主档ID
       sum(case when (sysdate-t.credate)<=7 then 1 else 0 end) lessweek,
       sum(case when (sysdate-t.credate)>7 and (sysdate-t.credate)<=30 then 1 else 0 end) lessmonth,
       sum(case when (sysdate-t.credate)>30  then 1 else 0 end) moremonth,
       count(t.containerid) total

  from zx_wbox_manager_v t
 where t.usestatus = 2
   and t.customid is not null
 group by t.customid, t.customname,t.warecid
"
"ZX_WB_OUT_ORDER_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WB_OUT_ORDER_DTL_V"" (""WBOUTDTLID"", ""WBOUTID"", ""DTLNO"", ""GOODSOWNID"", ""QTY"", ""PRICE"", ""AMT"", ""LOTNO"", ""PRODDATE"", ""VALIDDATE"", ""TRADEPACK"", ""INVNO"", ""GOODSENGNAME"", ""OWNERGOODSID"", ""GOODSNAME"", ""WAREGOODSID"", ""GOODSTYPE"", ""APPROVEDOCNO"", ""DRUGFORM"", ""FACTNAME"", ""MAH"") AS 
  select a.wboutdtlid,--主键ID
       a.wboutid,--总单主键ID
       a.dtlno,--单据细单编号
       a.goodsownid,--货主原货品ID
       a.qty,--数量
       a.price,--单价
       a.amt,--金额
       a.lotno,--批号
       a.proddate,--生产日期
       a.validdate,--有效期
       a.tradepack,--单位
       a.invno,--发票号码
       b.goodsengname,--商品名
       b.ownergoodsid,--货主货品ID
       b.goodsname,--货主货品名称
       b.waregoodsid,--货品主档ID
       b.goodstype,--货品规格
       b.approvedocno,--批准文号
       b.drugform,--剂型
       b.factname,--生产厂家
       b.mah--上市许可持有人
 from zx_wb_out_order_dtl a,
      tpl_goods           b
 where a.goodsownid = b.goodsownid(+)
"
"ZX_WB_OUT_ORDER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WB_OUT_ORDER_V"" (""WBOUTID"", ""DOCNO"", ""GCOMPANYID"", ""COMPANYNAME"", ""LYZXCOLUMN2"", ""ADDRESS"", ""CONNECTOR"", ""CONNPHONE"", ""DEPTNAME"", ""SALESMAN"", ""CREDATE"", ""WAREHID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""PRINTMANID"", ""PRINTFLAG"", ""PRINTDATE"") AS 
  select a.wboutid,--主键ID
       a.docno,--单据编号
       a.gcompanyid,--出库单位ID
       a.companyname,--购货单位
       a.lyzxcolumn2,--收款方式
       a.address,--收货地址
       a.connector,--联系人
       a.connphone,--电话
       a.deptname,--部门
       a.salesman,--业务员
       a.credate,--开票日期
       a.warehid,--物流中心ID
       b.warehname,--物流中心
       a.goodsownerid,--货主ID
       c.goodsownername,--货主
       a.printmanid,--打印人ID
       a.printflag,--打印标识
       a.printdate--打印时间

 from zx_wb_out_order a,
      tpl_warehouse   b,
      tpl_goodsowner  c

 where a.warehid = b.warehid(+)
   and a.goodsownerid = c.goodsownerid(+)
"
"ZX_WMSINTERFACEINFO_TO_QUEUE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMSINTERFACEINFO_TO_QUEUE_V"" (""SEQID"", ""QUEUETYPE"", ""CREDATE"", ""GOODSOWNERID"", ""SRCID"", ""EXPDATE"", ""EXPFLAG"", ""STATUS"") AS 
  SELECT a.seqid,
       a.queuetype,
       a.credate,
       a.goodsownerid,
       a.srcid,
       a.expdate,
       a.expflag,
       '' status
FROM tpl_edi_queue a
"
"ZX_WMSINTERFACEINFO_TO_T101_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMSINTERFACEINFO_TO_T101_V"" (""GOODSOWNERID"", ""GOODSOWNID"", ""GOODSNAME"", ""TRADEPACK"", ""OUTPACK"", ""STATUS"", ""CRE_DATE"") AS 
  SELECT a.goodsownerid,
       a.goodsownid,
       a.goodsname,
       a.tradepack,
       a.outpack,
       '' status,
       a.cre_date
FROM t101 a
"
"ZX_WMSINTERFACEINFO_TO_T102_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMSINTERFACEINFO_TO_T102_V"" (""GOODSOWNERID"", ""GCOMPANYID"", ""COMPANYNAME"", ""STATUS"", ""CRE_DATE"") AS 
  SELECT a.goodsownerid,
       a.gcompanyid,
       a.companyname,
       '' status,
       a.cre_date
FROM t102 a
"
"ZX_WMSINTERFACEINFO_TO_T103_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMSINTERFACEINFO_TO_T103_V"" (""GOODSOWNERID"", ""GOCOMPANYID"", ""TRANSID"", ""INCEPTADDR"", ""STATUS"", ""CRE_DATE"") AS 
  SELECT a.goodsownerid,
       a.gocompanyid,
       a.transid,
       a.inceptaddr,
       '' status,
       a.cre_date
FROM t103 a
"
"ZX_WMSINTERFACEINFO_TO_T301_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMSINTERFACEINFO_TO_T301_V"" (""GOODSOWNERID"", ""GOODSID"", ""OWNERGOODSID"", ""WAREGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSUNIT"", ""FACTORYID"", ""FACTORYNAME"", ""PRODAREA"", ""GSTORAGEID"", ""PORDERID"", ""CREDATE"", ""ARRIVEDATE"", ""SOURCECOMPANYID"", ""BATCHNO"", ""LOTNO"", ""OPERATIONTYPE"", ""STATUS"") AS 
  SELECT a.goodsownerid,
       a.goodsid, --ERP货品ID
       b.ownergoodsid, --货主货品ID
       b.waregoodsid, --主档ID
       b.goodsname,
       b.goodstype,
       b.tradepackname goodsunit,
       '' factoryid,
       b.factname factoryname,
       b.prodarea,
       a.gstorageid,
       a.porderid,
       a.credate,
       a.arrivedate,
       a.sourcecompanyid,
       a.batchno,
       a.lotno,
       a.operationtype,
       '' status
FROM t301 a,
     tpl_goods b
where a.goodsid = b.goodsownid
"
"ZX_WMSINTERFACEINFO_TO_T302_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMSINTERFACEINFO_TO_T302_V"" (""GOODSOWNERID"", ""GOODSID"", ""OWNERGOODSID"", ""WAREGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSUNIT"", ""FACTORYID"", ""FACTORYNAME"", ""PRODAREA"", ""GSTORAGEID"", ""CREDATE"", ""BATCHNO"", ""LOTNO"", ""OPERATIONTYPE"", ""STATUS"") AS 
  SELECT a.goodsownerid,--货主ID
       a.goodsid, --ERP货品ID
       b.ownergoodsid, --货主货品ID
       b.waregoodsid, --主档ID
       b.goodsname,
       b.goodstype,
       b.tradepackname goodsunit,
       '' factoryid,
       b.factname factoryname,
       b.prodarea,
       a.gstorageid,
       a.credate,
       a.batchno,
       a.lotno,
       a.operationtype,
       '' status
FROM t302 a,
     tpl_goods b
where a.goodsid=b.goodsownerid
"
"ZX_WMSINTERFACEINFO_TO_T310_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMSINTERFACEINFO_TO_T310_V"" (""GOODSOWNERID"", ""OWNERGOODSID"", ""WAREGOODSID"", ""CREDATE"", ""JOBID"", ""JOBDTLID"", ""JOBFLAG"", ""OPERATIONTYPE"", ""STATUS"") AS 
  SELECT a.goodsownerid,--货主ID
       b.ownergoodsid, --货主货品ID
       b.waregoodsid, --主档ID
       a.credate,
       a.jobid,
       a.jobdtlid,
       a.jobflag,
       a.operationtype,
       '' status
FROM t310 a,
     tpl_goods b
WHERE a.goodsownerid=b.goodsownerid
"
"ZX_WMSINTERFACEINFO_TO_T320_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMSINTERFACEINFO_TO_T320_V"" (""GOODSOWNERID"", ""GOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTORYID"", ""FACTORYNAME"", ""PACKUNIT"", ""PRODAREA"", ""BATCHNO"", ""LOTNO"", ""OPERATIONTYPE"", ""STATUS"") AS 
  SELECT a.goodsownerid,--货主ID
       a.goodsid, --货主货品ID
       --a.waregoodsid, --主档ID
       a.goodsname,
       a.goodstype,
       '' factoryid,
       a.factname factoryname,
       a.PackUnit,
       a.prodarea,
       a.batchno,
       a.lotno,
       a.operationtype,
       '' status
FROM tpla_edi_t320_v a
"
"ZX_WMSINTERFACEINFO_TO_T340_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMSINTERFACEINFO_TO_T340_V"" (""GOODSOWNERID"", ""GOODSID"", ""WAREGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSUNIT"", ""FACTORYID"", ""FACTORYNAME"", ""PRODAREA"", ""BATCHNO"", ""LOTNO"", ""OPERATIONTYPE"", ""STATUS"") AS 
  SELECT a.goodsownerid,--货主ID
       a.goodsid, --货主货品ID
       b.waregoodsid, --主档ID
       b.goodsname,
       b.goodstype,
       b.tradepackname goodsunit,
       '' factoryid,
       b.factname factoryname,
       b.prodarea,
       a.batchno,
       a.lotno,
       a.operationtype,
       '' status
FROM tpla_edi_t340_v a,
     tpl_goods b
where a.goodsid=b.goodsownerid
"
"ZX_WMSINTERFACEINFO_TO_T350_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMSINTERFACEINFO_TO_T350_V"" (""GOODSOWNERID"", ""JOBFLAG"", ""JOBID"", ""JOBDTLID"", ""OPERATIONTYPE"", ""CREDATE"", ""STATUS"") AS 
  SELECT a.goodsownerid,
       a.jobflag,
       a.jobid,
       a.jobdtlid,
       a.operationtype,
       a.credate,
       '' status
FROM tpla_edi_t350_v a
"
"ZX_WMSINTERFACEINFO_TO_T400_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMSINTERFACEINFO_TO_T400_V"" (""GOODSOWNERID"", ""TRADEID"", ""TRADEDTLID"", ""TRADEDATE"", ""OWNERGOODSID"", ""FROMCOMPANYID"", ""FROMSTORAGEID"", ""FROMBATCHNO"", ""FROMLOTNO"", ""OPERATIONTYPE"", ""STATUS"") AS 
  SELECT a.goodsownerid,--货主ID
       a.tradeid,
       a.tradedtlid,
       a.tradedate,
       a.ownergoodsid,--货主货品ID
       a.fromcompanyid,
       a.fromstorageid,
       a.frombatchno,
       a.fromlotno,
       a.operationtype,
       '' status
FROM tpla_edi_t400_v a
"
"ZX_WMS_CONSERVE_CONFIG_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMS_CONSERVE_CONFIG_V"" (""CONFIGID"", ""WAREID"", ""WAREHNAME"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""USESTATUS"", ""CREMANID"", ""CREMAN"", ""CREDATE"", ""MEMO"", ""CONSERVERCYCLE"", ""KEYCONSERVERCYCLE"", ""EXEDATE"", ""KEYEXEDATE"", ""TIMEINTERVAL"", ""KEYTIMEINTERVAL"") AS 
  select a.configid,
       a.wareid,
       b.warehname,
       a.goodsownerid,
       c.goodsownername,
       a.usestatus,
       a.cremanid,
       d.employeename creman,
       a.credate,
       a.memo,
       a.conservercycle,
       a.keyconservercycle,
       a.exedate,
       a.keyexedate,
       trunc(sysdate)-trunc(nvl(exedate,sysdate-1)) timeinterval,
       trunc(sysdate)-trunc(nvl(keyexedate,sysdate-1)) keytimeinterval
from zx_wms_conserve_config  a,
     tpl_warehouse           b,
     tpl_goodsowner          c,
     pub_employee            d
where a.wareid = b.warehid
and   a.goodsownerid = c.goodsownerid
and   a.cremanid = d.employeeid(+)
"
"ZX_WMS_CONSERVE_GOODS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMS_CONSERVE_GOODS_V"" (""CONFIGID"", ""GOODSID"", ""OPCODE"", ""GOODSNAME"", ""GOODSENGNAME"", ""GOODSQTYPE"", ""TRADEPACK"", ""COMPANYNAME"", ""PRODAREA"", ""SEQID"", ""INPUTMANID"", ""INPUTMAN"", ""CREDATE"") AS 
  select a.configid,
       a.goodsid,
       b.opcode,
       b.goodsname,
       b.goodsengname,
       b.goodsqtype,
       b.tradepack,
       b.companyname,
       b.prodarea,
       a.seqid,
       a.inputmanid,
       c.employeename inputman,
       a.credate
from zx_wms_conserve_goods  a,
     tpl_pub_goods_v        b,
     pub_employee           c
where a.goodsid = b.goodsid
and   a.inputmanid = c.employeeid(+)
"
"ZX_WMS_GOODS_TO_SUPPLYER_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMS_GOODS_TO_SUPPLYER_V"" (""GOODSOWNERID"", ""ENTRYNAME"", ""WAREGOODSID"", ""GOODSID"", ""GOODSNAME"", ""CURRENCYNAME"", ""GOODSTYPE"", ""GOODSUNIT"", ""FACTORYNAME"", ""PRODAREA"", ""SUPPLYER"", ""BELONG"", ""WAREHID"", ""WAREHNAME"", ""OWNERGOODSID"") AS 
  select tt.goodsownerid,
       t.entryname,
       a.waregoodsid,
       t.goodsid,
       t.goodsname,
       t.currencyname,
       t.goodstype,
       t.goodsunit,
       t.factoryname,
       t.prodarea,
       t.supplyer,
       t.belong,--带出采购员归属  by tl@171129
       b.warehid,
       b.warehname,
       a.ownergoodsid
From lyerp.bms_goods_to_supplyer_v t,
     lyerp.pub_entry tt,
     tpl_goods_v a,
     tpl_goodsowner_to_warehouse_v b
where t.entryid = tt.entryid
and   tt.goodsownerid is not null
and   a.goodsownerid = tt.goodsownerid
and   a.goodsownerid = b.goodsownerid
and   to_char(t.goodsid) = a.goodsownid
and   b.innerflag=1    --内部货主   by tl@180123
"
"ZX_WMS_INTERFACEINFO_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMS_INTERFACEINFO_V"" (""GOODSOWNERID"", ""GOODSOWNERNAME"", ""GOOPCODE"", ""GOODSOWNERSHORT"") AS 
  SELECT a.goodsownerid,
       a.goodsownername,
       a.goopcode,--货主操作码
       a.goodsownershort--货主简称
FROM tpl_goodsowner a
"
"ZX_WMS_PICKAREA_TASK_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMS_PICKAREA_TASK_DTL_V"" (""CREDATE"", ""PICKAREAID"", ""PICKAREANAME"", ""TASKID"", ""TASKTYPE"", ""RFFLAG"", ""USESTATUS"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSTYPE"", ""GOODSQTY"", ""TRADEPACKNAME"", ""LOTNO"", ""PACKNAME"", ""PACKSIZE"", ""CUSTOMID"", ""CUSTOMNAME"", ""GCOMPANYID"", ""PRODAREA"", ""DRUGFORM"", ""DRUGFORMNO"", ""PICKFLOWID"", ""PICKFLOWNAME"", ""GROUPID"", ""GROUPNAME"", ""RFMANID"", ""RFMAN"", ""INOUTID"", ""WAREHID"", ""POSID"", ""WHOLEQTY"", ""SCATTERQTY"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""WAREHNAME"") AS 
  select
--一个为拣货工作区下架任务明细，内容为任务状态、任务下达时间、拣货工作区、货品ID、货主原货品ID、
--名称、规格、单位、数量、批号、包装单位、包装大小、客户ID、货主原客户ID、客户名称。
--查询条件为：状态、客户ID（HOV）、拣货工作区ID（Hov）、货品ID（Hov）、任务下达时间（必填，缺省为当天）、
--业务类型（波次补货下架、闲时补货下架、报警补货下架、出库下架）
 b.credate,
 f.pickareaid,
 g.pickareaname,
 a.taskid,
 '出库下架' tasktype,
 b.rfflag,
 b.usestatus,
 b.goodsid,
 j.goodsownid,
 j.goodsname,
 j.goodstype,
 b.goodsqty,
 j.tradepackname,
 i.lotno,
 h.packname,
 h.packsize,
 d.customid,
 --d.customname, 2011-1-24 by ydhu
 k.companyname customname, --2011-1-24 by ydhu
 --d.gcompanyid  2011-1-24 by ydhu
 k.gcompanyid, --2011-1-24 by ydhu
 j.prodarea,
 l.drugform,
 l.drugformno,
 m.pickflowid,
 m.pickflowname,
 n.groupid,
 n.groupname,
 b.rfmanid,
 o.employeename rfman,
 b.inoutid,
 b.warehid,
 b.posid,
 b.wholeqty,
 b.scatterqty,
 j.goodsownerid, -- xyue 2014-06-06 拣货工作区下架任务明细增加货主字段
 j.goodsownername,
 p.warehname    --tl 2015-5-21  增加物流中心名称
  from wms_task_doc         a,
       wms_st_io_doc        b,
       wms_wave_goods_dtl   c,
       wms_wave_dtl         d,
       wms_wave_doc         e,
       wms_pickarea_pos_def f,
       wms_pickarea         g,
       tpl_pub_goods_packs  h,
       wms_goods_lot        i,
       tpl_goods_v            j,
       tpl_go_company       k, --2011-1-24 by ydhu
       tpl_drugform         l,
       wms_pickflow         m,
       wms_group_def        n,
       pub_employee         o,
			 tpl_warehouse        p
 where a.taskid = b.taskid
   and a.tasktype = 1 --拣货任务（波次生成）
   and b.comefrom = 3 --波次出库
   and b.sourceid = c.wavegoodsdtlid
   and c.wavedtlid = d.wavedtlid
   and d.waveid = e.wavedocid
   and b.posid = f.posid
   and f.pickareaid = g.pickareaid
   and b.goodspackid = h.goodspackid
   and b.lotid = i.lotid
   and b.ownergoodsid = j.ownergoodsid
   and d.customid = k.companyid(+) --2011-1-24 by ydhu
   and j.drugform = l.drugformno(+)
   and g.pickflowid = m.pickflowid
   and g.groupid = n.groupid
   and b.rfmanid = o.employeeid(+) --应该用外关联，不然查不出未执行的任务
	 AND b.warehid = p.warehid(+)
union all
select b.credate,
       f.pickareaid,
       g.pickareaname,
       a.taskid,
       decode(e.subtype,
              1,
              '波次补货下架',
              5,
              '波次预补货下架',
              4,
              '手工补货下架',
              3,
              '闲时补货下架',
              '报警补货下架') tasktype,
       b.rfflag,
       b.usestatus,
       b.goodsid,
       j.goodsownid,
       j.goodsname,
       j.goodstype,
       b.goodsqty,
       j.tradepackname,
       i.lotno,
       h.packname,
       h.packsize,
       null customid,
       null customname,
       null gcompanyid,
       j.prodarea,
       l.drugform,
       l.drugformno,
       m.pickflowid,
       m.pickflowname,
       n.groupid,
       n.groupname,
       b.rfmanid,
       o.employeename rfman,
       b.inoutid,
       b.warehid,
       b.posid,
       b.wholeqty,
       b.scatterqty,
       j.goodsownerid, -- xyue 2014-06-06 拣货工作区下架任务明细增加货主字段
       j.goodsownername,
			 p.warehname    --tl 2015-5-21  增加物流中心名称
  from wms_task_doc         a,
       wms_st_io_doc        b,
       tpl_trade_dtl        d,
       tpl_trade_order      e,
       wms_pickarea_pos_def f,
       wms_pickarea         g,
       tpl_pub_goods_packs  h,
       wms_goods_lot        i,
       tpl_goods_v            j,
       tpl_drugform         l,
       wms_pickflow         m,
       wms_group_def        n,
       pub_employee         o,
       tpl_warehouse        p
 where a.taskid = b.taskid
   and a.tasktype = 2 --拣货任务（波次生成）
   and b.comefrom = 4 --库内变动
   and b.sourceid = d.tradedtlid
   and d.tradeid = e.tradeid
   and e.subtype in (1, 2, 3, 4, 5) -- 1 波次补货 2 报警补货 3 闲时补货  4手工补货 5波次预补货;
   and b.posid = f.posid
   and f.pickareaid = g.pickareaid
   and b.goodspackid = h.goodspackid
   and b.lotid = i.lotid
   and b.ownergoodsid = j.ownergoodsid
   and j.drugform = l.drugformno(+)
   and g.pickflowid = m.pickflowid
   and g.groupid = n.groupid
   and b.rfmanid = o.employeeid(+)
	 AND b.warehid = p.warehid(+)
"
"ZX_WMS_SECTION_TASK_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMS_SECTION_TASK_DTL_V"" (""CREDATE"", ""SECTIONID"", ""SECTIONNAME"", ""TASKID"", ""TASKTYPE"", ""RFFLAG"", ""USESTATUS"", ""GOODSID"", ""GOODSOWNID"", ""GOODSNAME"", ""GOODSTYPE"", ""FACTNAME"", ""GOODSQTY"", ""TRADEPACKNAME"", ""LOTNO"", ""PACKNAME"", ""PACKSIZE"", ""SOURCECOMPANYID"", ""SRCCOMPANYNAME"", ""GCOMPANYID"", ""INOUTID"", ""PRODAREA"", ""COMEFROM"", ""DRUGFORM"", ""DRUGFORMNO"", ""LPNCODE"", ""CHECKMAN1"", ""CHECKMAN2"", ""CONTAINERID"", ""OPERATIONTYPE"", ""CONTAINERNO"", ""WAREHID"", ""GOODSOWNERID"", ""WAREHNAME"", ""GOODSOWNERNAME"") AS 
  select
--一个为分区上架任务明细，内容为任务状态、任务下达时间、分区名称、货品ID、货主原货品ID、
--名称、规格、单位、数量、批号、包装单位、包装大小、客户ID、货主原客户ID、客户名称。
--查询条件为：状态、客户ID（HOV）、分区ID（Hov）、货品ID（Hov）、任务下达时间（必填，缺省为当天）、
--业务类型（波次补货上架、闲时补货上架、报警补货上架、入库上架）、业务来源（各种业务类型：进货、销退、还入等）
--zx加上warehname,goodsownername
       b.credate,
       b.sectionid,
       j.sectionname,
       a.taskid,
       '入库上架' tasktype,
       b.rfflag,
       b.usestatus,
       b.goodsid,
       g.goodsownid ,
       g.goodsname ,
       g.goodstype,
       g.factname,
       b.goodsqty,
       g.tradepackname,
       i.lotno,
       h.packname,
       h.packsize,
       e.sourcecompanyid,
      f.companyname srccompanyname,
      f.gcompanyid,
      b.inoutid,
      g.prodarea,
      b.comefrom,
      k.drugform,
      k.drugformno,
      c.lpncode,
      c.checkman1,
      c.checkman2,b.containerid,b.operationtype,t.containerno
      ,a.warehid,g.goodsownerid,  --增加货主名称和物流中心字段@tl150520
			l.warehname,m.goodsownername
  from wms_task_doc           a,
       wms_st_io_doc          b,
       wms_receive_dtl        c,
       wms_in_order_dtl       d,
       wms_in_order           e,
       tpl_go_company         f,
       tpl_goods              g,
       tpl_pub_goods_packs    h,
       wms_goods_lot          i,
       wms_st_section_def     j,
       tpl_drugform           k,
       wms_container_def      t,
			 tpl_warehouse  l,
			 tpl_goodsowner  m

 where a.taskid = b.taskid
   and a.tasktype = 3 --上架任务
   and b.comefrom = 1 --入库
   and b.sourceid = c.receiveid
   and c.indtlid = d.indtlid
   and d.inid = e.inid
   and b.containerid = t.containerid
   and e.sourcecompanyid = f.companyid(+)
   and b.ownergoodsid = g.ownergoodsid
   and b.goodspackid = h.goodspackid(+)
   and b.lotid = i.lotid(+)
   and b.sectionid = j.sectionid(+)
   and g.drugform = k.drugformno(+)
	 AND a.warehid = l.warehid(+)
	 AND g.goodsownerid = m.goodsownerid(+)

   and not exists(select 1 from wms_receive_detail t2 where c.receivedetailid = t2.receivedetailid)
union all
select b.credate,
       b.sectionid,
       j.sectionname,
       a.taskid,
       decode(e.subtype,
              1,
              '波次补货上架',
              5,
              '波次预补货上架',
              4,
              '手工补货上架',
              3,
              '闲时补货上架',
              '报警补货上架') tasktype,
       b.rfflag,
       b.usestatus,
       b.goodsid,
       g.goodsownid,
       g.goodsname ,
       g.goodstype,
       g.factname,
       b.goodsqty,
       g.tradepackname ,
       i.lotno,
       h.packname,
       h.packsize,
       null sourcecompanyid,
       null srccompanyname,
       null gcompanyid,
       b.inoutid,
       g.prodarea,
       b.comefrom,
       k.drugform,
       k.drugformno,
       null lpncode,
       NULL checkman1,
       NULL checkman2,b.containerid,b.operationtype,t.containerno
       ,a.warehid,g.goodsownerid,
			 l.warehname,m.goodsownername
  from wms_task_doc         a,
       wms_st_io_doc        b,
       wms_trade_dtl        d,
       wms_trade_order      e,
       tpl_goods            g,
       tpl_pub_goods_packs  h,
       wms_goods_lot        i,
       wms_st_section_def   j,
       tpl_drugform         k,
       wms_container_def      t,
			 tpl_warehouse  l,
			 tpl_goodsowner  m

 where a.taskid = b.taskid
   and a.tasktype = 3 --上架
   and b.comefrom = 4 --库内下架任务（指库内变动单生成的下架任务）
   and b.sourceid = d.tradedtlid
   and d.tradeid = e.tradeid
   and b.containerid = t.containerid
   and e.subtype in (1, 2, 3,4,5) -- 1 波次补货 2 报警补货 3 闲时补货 4手工补货 5波次预补货;
   and b.ownergoodsid = g.ownergoodsid(+)
   and b.goodspackid = h.goodspackid(+)
   and b.lotid = i.lotid(+)
   and b.sectionid = j.sectionid(+)
   and g.drugform = k.drugformno(+)
	 AND a.warehid = l.warehid(+)
	 AND g.goodsownerid = m.goodsownerid(+)


union
select
       b.credate,
       b.sectionid,
       j.sectionname,
       a.taskid,
       '无订单入库' tasktype,
       b.rfflag,
       b.usestatus,
       b.goodsid,
       g.goodsownid ,
       g.goodsname ,
       g.goodstype,
       g.factname,
       b.goodsqty,
       g.tradepackname,
       i.lotno,
       h.packname,
       h.packsize,
       e.GOCOMPANYID,
      f.companyname srccompanyname,
      f.gcompanyid,
      b.inoutid,
      g.prodarea,
      b.comefrom,
      k.drugform,
      k.drugformno,
      c.lpncode,
      c.checkman1,
      c.checkman2,b.containerid,b.operationtype,t.containerno
      ,a.warehid,g.goodsownerid,
			l.warehname,m.goodsownername
  from wms_task_doc           a,
       wms_st_io_doc          b,
       wms_receive_dtl        c,
       wms_receive_doc        e,
       tpl_go_company         f,
       tpl_goods              g,
       tpl_pub_goods_packs    h,
       wms_goods_lot          i,
       wms_st_section_def     j,
       tpl_drugform           k,
       wms_container_def      t,
       wms_receive_detail t2,
			 tpl_warehouse  l,
			 tpl_goodsowner  m

 where a.taskid = b.taskid
   and a.tasktype = 3 --上架任务
   and b.comefrom = 1 --入库
   and b.containerid = t.containerid
   and b.sourceid = c.receiveid
   and e.receivedocid = t2.receivedocid
   and t2.receivedetailid = c.receivedetailid
   and e.GOCOMPANYID = f.companyid(+)
   and b.ownergoodsid = g.ownergoodsid
   and b.goodspackid = h.goodspackid(+)
   and b.lotid = i.lotid(+)
   and b.sectionid = j.sectionid(+)
   and g.drugform = k.drugformno(+)
   AND a.warehid = l.warehid(+)
	 AND g.goodsownerid = m.goodsownerid(+)
"
"ZX_WMS_ST_QTY_LST20200213_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_WMS_ST_QTY_LST20200213_V"" (""WAREHID"", ""GOODSOWNERID"", ""OWNERGOODSID"", ""GOODSID"", ""GOODSPACKID"", ""POSID"", ""LOTID"", ""GOODSSTATUSID"", ""GOODSQTY"") AS 
  select a.warehid,
       a.goodsownerid,
       a.ownergoodsid,
       a.goodsid,
       a.goodspackid,
       a.posid,
       a.lotid,
       a.goodsstatusid,
       a.stockqty goodsqty
  from wms_qty_cut_dtl a
  where a.cutid=38663

union all
--2.找到时间范围内的所有出入库,用记账时间 inoutflag:0入库 1出库
select t.warehid,
       t.goodsownerid,
       t.ownergoodsid,
       t.goodsid,
       t.goodspackid,
       t.posid,
       t.lotid,
       t.goodsstatusid,
       t.goodsqty*decode(t.inoutflag,0,1,1,-1) goodsqty
  from wms_st_io_doc t
 where t.warehid = 11
   and t.goodsownerid = 124
   and t.keepdate between
       to_date('2019-12-14 11:00:00', 'yyyy-mm-dd hh24:mi:ss') and
       to_date('2019-12-31 23:59:59', 'yyyy-mm-dd hh24:mi:ss')
"
"ZX_XYJK_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_XYJK_V"" (""ORDERID"", ""MEDICINENAME"", ""MEDICINECODE"", ""LISENCENO"", ""SPEC"", ""EXPIRYDATE"", ""PRODUCT"", ""UNIT"", ""BUYPRICE"", ""SELLPRICE"", ""GOODSNUMBER"", ""MONEY"", ""INVOICENO"", ""SENDNO"", ""BARCODE"", ""TOTALCOUNT"", ""BILLDATE"", ""BUYMONEY"", ""DRUGFLAG"", ""SHPSTAS"", ""PURCCNT"", ""DELVENTPNAME"", ""SENDTIME"", ""PRODUCEDATE"", ""FLAG"", ""COMEFROM"", ""INOUTID"") AS 
  select e.wavedtlid orderID, --订单号\随货同行号
       d.ypmc medicineName, --药品名称
       d.ypid medicineCode, --药品编码
       b.approvedocno lisenceNo, --批准文号
       d.ypgg spec, --规格
       to_char(c.validdate, 'yyyy-mm-dd') expirydate, --有效期
       nvl(c.factname, b.factname) product, --生产厂家
       nvl(d.dw, b.tradepackname) unit, --单位
       decode(d.tinyrate,
              null,
              f.lydtlzxcolumn3,
              f.lydtlzxcolumn3 / d.tinyrate) buyprice, --进货价
       decode(d.tinyrate,
              null,
              f.lydtlzxcolumn3,
              f.lydtlzxcolumn3 / d.tinyrate) * 1.13 sellprice, --零售价

       --nvl((select t.price from lyerp.bms_entry_goods_price t where t.grade=2 and t.entryid=1 and t.priceid=4224 and t.goodsid=b.goodsownid),(select t.price from lyerp.bms_entry_goods_price t where t.grade=2 and t.entryid=1 and t.priceid=2384 and t.goodsid=b.goodsownid)) sellprice,--零售价
       case
         when d.tinyrate >= 1 then
          a.goodsqty * d.tinyrate
         else
          a.goodsqty / (round(1 / d.tinyrate, 0))
       end goodsnumber, --数量,
       a.goodsqty * f.lydtlzxcolumn3 money, --金额
       f.invoiceno invoiceNo, --发票号
       c.lotno sendNo, --批号
       b.barcode barcode, --条形码/整件为出入库ID
       case
         when d.tinyrate >= 1 then
          a.goodsqty * d.tinyrate
         else
          a.goodsqty / (round(1 / d.tinyrate, 0))
       end totalCount, --计量数量,
       to_char(a.credate, 'yyyy-mm-dd') billDate, --发票日期
       decode(d.tinyrate,
              null,
              f.lydtlzxcolumn3,
              f.lydtlzxcolumn3 / d.tinyrate) buyMoney, --采购价
       null drugFlag, --药品标识
       2 shpStas, --发货状态
       case
         when d.tinyrate >= 1 then
          a.goodsqty * d.tinyrate
         else
          a.goodsqty / (round(1 / d.tinyrate, 0))
       end purcCnt, --订单数量
       '厦门鹭燕海峡两岸药材贸易有限公司' delventpName, --配送企业
       to_char(a.credate, 'yyyy-mm-dd') sendTime, --发货时间
       to_char(c.proddate, 'yyyy-mm-dd') produceDate, --生产日期
       0 flag, --0新增  1修改
       1 comefrom,
       a.inoutid
  from wms_st_io_doc         a,
       tpl_goods             b,
       wms_goods_lot         c,
       lyerp.zx_101287       d,
       wms_wave_goods_dtl    e,
       wms_out_order_dtl     f,
       wms_out_order_lot_dtl g,
       wms_wave_dtl          h
 where a.ownergoodsid = b.ownergoodsid(+)
   and a.lotid = c.lotid(+)
   and e.wavedtlid = h.wavedtlid
   and nvl(h.canprintflag, 0) = 1
   and a.warehid = 1
   and a.goodsownerid = 550
   and a.companyid = 568589 --厦门仙岳
   and a.credate > to_date('2024-02-01', 'yyyy-mm-dd')
      --and a.wholeqty is not null --整件出库
   and a.operationtype = 11 --销售
   and a.comefrom in (2, 3) --来源出库
   and a.usestatus = 1 --正式
   and a.rfflag = 3 --任务状态执行完毕
   and a.sourceid = e.wavegoodsdtlid
   and e.wavegoodsdtlid = g.wavegoodsdtlid(+)
   and g.outdtlid = f.outdtlid
   and b.goodsownid = d.goodsid
   and not exists (select 1
          from zx_fyjk t
         where t.outdtlid = a.inoutid
           and t.comefrom = 1)
"
"ZX_YSJJD_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_YSJJD_DTL_V"" (""WAVEDTLID"", ""GATHERPOSNO"", ""WHOLEQTY"", ""BOXQTY"", ""BAGQTY"", ""CHAINQTY"", ""TGQTY"") AS 
  select t.wavedtlid,
       t.gatherposno,
       get_dispatch_packsnum_pk.f_get_wholeqty(t.wavedtlid, t.gatherposid) wholeqty, --整件数
       get_dispatch_packsnum_pk.f_get_scatterqty_box(t.wavedtlid, t.gatherposid) boxqty,
       get_dispatch_packsnum_pk.f_get_scatterqty_bag(t.wavedtlid, t.gatherposid) bagqty,
       (get_dispatch_packsnum_pk.f_get_wholeqty_chain(t.wavedtlid, t.gatherposid) +
       get_dispatch_packsnum_pk.f_get_scatterqty_chain(t.wavedtlid, t.gatherposid)) chainqty,
       (get_dispatch_packsnum_pk.f_get_wholeqty_tg(t.wavedtlid, t.gatherposid) +
       get_dispatch_packsnum_pk.f_get_scatterqty_tg(t.wavedtlid, t.gatherposid)) tgqty
  from (select distinct a.wavedtlid,
                        c.gatherposno,
                        nvl(c.gatherposid, -1) gatherposid
          from wms_wave_goods_dtl a,
               wms_st_io_doc b,
               (select t1.inoutid, t2.gatherposid, t3.gatherposno
                  from wms_out_gather_lst     t1,
                       wms_out_gather_lst_dtl t2,
                       base_gather_zone_pos   t3
                 where t1.gathterlstid = t2.gathterlstid
                   and t2.gatherposid = t3.gatherposid) c
         where a.usestatus = 3 --波次分配细单状态【完成】
           and a.wavegoodsdtlid = b.sourceid
           and b.comefrom = 3
           and b.inoutid = c.inoutid(+)
           and b.warehid = 2) t
"
"ZX_YSJJD_DTL_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_YSJJD_DTL_V1"" (""WAVEDTLID"", ""GATHERPOSNO"", ""WHOLEQTY"", ""BOXQTY"", ""BAGQTY"", ""CHAINQTY"", ""TGQTY"") AS 
  select t.wavedtlid,
       t.gatherposno,
       get_dispatch_packsnum_pk.f_get_wholeqty(t.wavedtlid, t.gatherposid) wholeqty, --整件数
       get_dispatch_packsnum_pk.f_get_scatterqty_box(t.wavedtlid, t.gatherposid) boxqty,
       get_dispatch_packsnum_pk.f_get_scatterqty_bag(t.wavedtlid, t.gatherposid) bagqty,
       (get_dispatch_packsnum_pk.f_get_wholeqty_chain(t.wavedtlid, t.gatherposid) +
       get_dispatch_packsnum_pk.f_get_scatterqty_chain(t.wavedtlid, t.gatherposid)) chainqty,
       (get_dispatch_packsnum_pk.f_get_wholeqty_tg(t.wavedtlid, t.gatherposid) +
       get_dispatch_packsnum_pk.f_get_scatterqty_tg(t.wavedtlid, t.gatherposid)) tgqty
  from (select distinct a.wavedtlid,
                        c.gatherposno,
                        nvl(c.gatherposid, -1) gatherposid
          from wms_wave_goods_dtl a,
               wms_st_io_doc b,
               (select t1.inoutid, t2.gatherposid, t3.gatherposno
                  from wms_out_gather_lst     t1,
                       wms_out_gather_lst_dtl t2,
                       base_gather_zone_pos   t3
                 where t1.gathterlstid = t2.gathterlstid
                   and t2.gatherposid = t3.gatherposid) c
         where a.usestatus = 3 --波次分配细单状态【完成】
           and a.wavegoodsdtlid = b.sourceid
           and b.comefrom = 3
           and b.inoutid = c.inoutid(+)
           and b.warehid in ( 2,19)) t
"
"ZX_YSJJD_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_YSJJD_V"" (""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DISPATCHID"", ""TRCOMPANYID"", ""TRCOMPANYNAME"", ""GCOMPANYID"", ""COMPANYNAME"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVERNAME2"", ""EMPLOYEENAMES"", ""TRANSID"", ""INCEPTADDR"", ""CKNO"", ""ROUTEID"", ""ROUTENAME"", ""GATHERPOSNO"", ""WHOLEQTY"", ""BOXQTY"", ""BAGQTY"", ""CHAINQTY"", ""TGQTY"", ""SENDPOS"", ""TARGETCKNO"", ""TARGETGOODSOWNERID"", ""TARGETGOODSOWNERNAME"", ""TARGETADDRESS"") AS 
  select trunc(a.credate) credate,
       c.goodsownerid,
       g.goodsownername,
       a.dispatchid,
       a.trcompanyid,
       h.companyname trcompanyname,
       c.gcompanyid,
       i.companyname,
       j.vehicleno,
       a.driverid,
       driver.drivername,
       a.driver2id,
       driver2.drivername drivername2,
       b.employeenames, --装卸工
       c.transid,
       k.inceptaddr,
       c.sourceid ckno,--随货同行号
       c.routeid,
       l.routename,
       d.gatherposno,
       d.wholeqty,
       d.boxqty,
       d.bagqty,
       d.chainqty,
       d.tgqty,
         (case when c.goodsownerid=682 and c.gcompanyid=1791345
          then
           k.sendpos
           else
             case when c.goodsownerid=4 and c.gcompanyid=29579
               then
                  k.sendpos
               else
                 null end   end ) sendpos, --内部供应链取门店名称tl@230918
       (select
         t1.sourceid
        from tms_tr_doc t1
        where   c.trid = t1.sourcetrid(+)
           and t1.autotaskflag = 1
           and t1.goodsownerid=304
            and c.goodsownerid=4
            and c.gcompanyid=29579) targetckno, --内部供应链目标随货单号tl@230919
        (select
         t1.goodsownerid
        from tms_tr_doc t1
        where c.trid = t1.sourcetrid(+)
           and t1.autotaskflag = 1
            and t1.goodsownerid=304
             and c.goodsownerid=4
             and c.gcompanyid=29579)   targetgoodsownerid ,--内部供应链目标货主IDtl@230919
         (select
         t2.goodsownername
        from tms_tr_doc t1,tpl_goodsowner t2
        where c.trid = t1.sourcetrid(+)
           and t1.autotaskflag = 1
           and t1.goodsownerid = t2.goodsownerid
           and t1.goodsownerid=304
            and c.goodsownerid=4
            and c.gcompanyid=29579)   targetgoodsownername ,--内部供应链目标货主tl@230919
            ( case when
          (select nvl( t1.to_expcompanyid,0)
            from wms_wave_dtl t1
            where t1.wavedtlid = c.sourceid)<>0
          then
            (select max(tt1.inceptaddr)
               from  wms_transport_address tt1 ,
                     wms_wave_dtl tt2
               where tt2.to_expcompanyid = tt1.gocompanyid(+)
                 and tt2.wavedtlid = c.sourceid)
           else null
             end    )      targetaddress  -- 内部供应链目标地址tl@230919

  from tms_dispatch_doc a,
       tms_dispatch_dtl b,
       tms_tr_doc c,
       zx_ysjjd_dtl_v1 d,
       tpl_goodsowner g,
       tpl_pub_company h,
       tpl_go_company i,
       tms_vehicle j,
       tms_driver driver,
       tms_driver driver2,
       wms_transport_address k,
       wms_tr_route          l
 where a.dispatchid = b.dispatchid
   and a.usestatus > 0
   and b.usestatus <> 1 --派车细单状态=1 作废
   and b.trid = c.trid
   and b.dispatchid = c.dispatchid
   and c.comefrom = 1 --来源:WMS转入
   and c.sourcetable = 1 --单据来源:波次生成
   and c.sourceid=d.wavedtlid
   and c.goodsownerid = g.goodsownerid(+)
   and a.trcompanyid = h.companyid(+)
   and c.gcompanyid = i.companyid(+)
   and a.vehicleid = j.vehicleid(+)
   and a.driverid = driver.driverid(+)
   and a.driver2id = driver2.driverid(+)
   and c.transid=k.transid(+)
   and c.routeid=l.routeid(+)
"
"ZX_YSJJD_V1","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_YSJJD_V1"" (""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""DISPATCHID"", ""TRCOMPANYID"", ""TRCOMPANYNAME"", ""GCOMPANYID"", ""COMPANYNAME"", ""VEHICLENO"", ""DRIVERID"", ""DRIVERNAME"", ""DRIVER2ID"", ""DRIVERNAME2"", ""EMPLOYEENAMES"", ""TRANSID"", ""INCEPTADDR"", ""CKNO"", ""ROUTEID"", ""ROUTENAME"", ""GATHERPOSNO"", ""WHOLEQTY"", ""BOXQTY"", ""BAGQTY"", ""CHAINQTY"", ""TGQTY"") AS 
  select trunc(a.credate) credate,
       c.goodsownerid,
       g.goodsownername,
       a.dispatchid,
       a.trcompanyid,
       h.companyname trcompanyname,
       c.gcompanyid,
       i.companyname,
       j.vehicleno,
       a.driverid,
       driver.drivername,
       a.driver2id,
       driver2.drivername drivername2,
       b.employeenames, --装卸工
       c.transid,
       k.inceptaddr,
       c.sourceid ckno,--随货同行号
       c.routeid,
       l.routename,
       d.gatherposno,
       d.wholeqty,
       d.boxqty,
       d.bagqty,
       d.chainqty,
       d.tgqty
  from tms_dispatch_doc a,
       tms_dispatch_dtl b,
       tms_tr_doc c,
       zx_ysjjd_dtl_v1 d,
       tpl_goodsowner g,
       tpl_pub_company h,
       tpl_go_company i,
       tms_vehicle j,
       tms_driver driver,
       tms_driver driver2,
       wms_transport_address k,
       wms_tr_route          l
 where a.dispatchid = b.dispatchid
   and a.usestatus > 0
   and b.usestatus <> 1 --派车细单状态=1 作废
   and b.trid = c.trid
   and b.dispatchid = c.dispatchid
   and c.comefrom = 1 --来源:WMS转入
   and c.sourcetable = 1 --单据来源:波次生成
   and c.sourceid=d.wavedtlid
   and c.goodsownerid = g.goodsownerid(+)
   and a.trcompanyid = h.companyid(+)
   and c.gcompanyid = i.companyid(+)
   and a.vehicleid = j.vehicleid(+)
   and a.driverid = driver.driverid(+)
   and a.driver2id = driver2.driverid(+)
   and c.transid=k.transid(+)
   and c.routeid=l.routeid(+)
"
"ZX_ZONE_GOODSOWNERID_RULE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_ZONE_GOODSOWNERID_RULE_V"" (""WAREHID"", ""ZONEID"", ""GOODSOWNERID"") AS 
  with test as
 (select warehid a ,zoneid b, t.memo c
    from wms_ship_zone_rule t where t.colseq=1 and t.memo is not null
)
select a warehid, b zoneid, c goodsownerid
  from (select a,
               b,
               substr(t.ca,
                      instr(t.ca, ',', 1, c.lv) + 1,
                      instr(t.ca, ',', 1, c.lv + 1) -
                      (instr(t.ca, ',', 1, c.lv) + 1)) AS c
          from (select a,
                       b,
                       ',' || c || ',' AS ca,
                       length(c || ',') - nvl(length(REPLACE(c, ',')), 0) AS cnt
                  FROM test) t,
               (select LEVEL lv from dual CONNECT BY LEVEL <= 100) c
         where c.lv <= t.cnt) order by a,b　
"
"ZX_ZONE_ROUTEID_RULE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_ZONE_ROUTEID_RULE_V"" (""WAREHID"", ""ZONEID"", ""ROUTEID"") AS 
  with test as
 (select warehid a ,zoneid b, t.memo c
    from wms_ship_zone_rule t where t.colseq=2 and t.memo is not null
)
select a warehid, b zoneid, c routeid
  from (select a,
               b,
               substr(t.ca,
                      instr(t.ca, ',', 1, c.lv) + 1,
                      instr(t.ca, ',', 1, c.lv + 1) -
                      (instr(t.ca, ',', 1, c.lv) + 1)) AS c
          from (select a,
                       b,
                       ',' || c || ',' AS ca,
                       length(c || ',') - nvl(length(REPLACE(c, ',')), 0) AS cnt
                  FROM test) t,
               (select LEVEL lv from dual CONNECT BY LEVEL <= 100) c
         where c.lv <= t.cnt) order by a,b　
"
"ZX_ZONE_RULE_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_ZONE_RULE_V"" (""WAREHID"", ""ZONEID"", ""GOODSOWNERID"", ""ROUTEID"") AS 
  select t.warehid,t.zoneid,t.goodsownerid,tt.routeid
  from zx_zone_goodsownerid_rule_v t, zx_zone_routeid_rule_v tt
 where t.warehid = tt.warehid
   and t.zoneid = tt.zoneid
"
"ZX_ZPDJ_DOC_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_ZPDJ_DOC_V"" (""GOODSOWNERID"", ""GOODSOWNERNAME"", ""ADDRESS"", ""COMPANYID"", ""COMPANYNAME"", ""TRANSID"", ""INCEPTADDR"", ""CREDATE"", ""ZJS"", ""PXS"", ""SALESNO"", ""ZPDJID"", ""CPHID"", ""VEHICLENO"", ""JSYID"", ""DRIVERNAME"", ""JSY2"", ""LDH"", ""OUTORDERID"", ""INPUTMANID"", ""INPUTMANNAME"", ""PRINTMANID"", ""PRINTDATE"", ""PRINTFLAG"", ""PCFLAG"", ""PCDATE"", ""PRINTMANNAME"", ""GZXYDH"", ""CONNECTOR"", ""CONNPHONE"", ""SIGNDATE"", ""SIGNMANID"", ""SIGNFLAG"", ""TRANSMODEID"", ""INVEHICLENO"", ""SHTEMPERATURE"", ""OUTDATE"", ""OUTFLAG"", ""OUTMANID"", ""FCDATE"", ""FCMANID"", ""FCFLAG"", ""FCTEMPERATURE"", ""PCMANID"", ""SIGNMANNAME"", ""OUTMANNAME"", ""PCMANNAME"", ""FCMANNAME"", ""TRANSMODE"", ""ZXYDH"", ""INTYPE"", ""OUTTYPE"", ""PCTYPE"", ""ARRIVEDATE"", ""ARRIVETEMP"", ""MEMO"") AS 
  SELECT a.goodsownerid,
       b.goodsownername,
       b.address,--货主地址
       a.companyid,
       c.companyname,
       a.transid,
       d.inceptaddr,
       a.credate,
       a.zjs,
       a.pxs,
       a.salesno,
       a.zpdjid,
       a.cphid,
       e.vehicleno,
       a.jsyid,
       f.drivername,
       a.jsy2,
       a.ldh,
       a.outorderid, --200512李鸿
       a.inputmanid,
       g.employeename   inputmanname,
       a.printmanid,
       a.printdate,
       decode(a.printflag,null,0,0,0,1) printflag,
       nvl(a.pcflag,0) pcflag,
       a.pcdate,
       h.employeename   printmanname,
       a.gzxydh , --干线运单号
       d.connector,--出库单位联系人
       d.connphone ,--出库单位联系电话
       a.signdate,--入库签收日期
       a.signmanid ,--入库签收人
       nvl(a.signflag,0)  signflag ,--入库标志
       a.transmodeid ,--入库运输方式
       a.invehicleno,--入库车牌号
       a.shtemperature,--入库收货温度
       a.outdate ,--出库日期
       nvl(a.outflag,0)   outflag,--出库标志
       a.outmanid,--出库人ID
       a.fcdate ,--发车日期
       a.fcmanid,--发车人ID
       nvl(a.fcflag,0) fcflag ,--发车标志
       a.fctemperature , --发车温度
       a.pcmanid,--派车人ID
       i.employeename signmanname ,
       j.employeename outmanname,
       k.employeename pcmanname,
       l.employeename fcmanname,
       a.transmode ,--入库运输方式
       a.zxydh, --支线运单号
       a.intype,
       a.outtype,
       a.pctype ,  --业务类型
       a.arrivedate,--到达日期
       a.arrivetemp,--到达温度
       a.memo --备注

  from zx_zpdj_doc           a,
       tpl_goodsowner        b,
       Tpl_go_company        c,
       wms_transport_address d,
       Tms_vehicle           e,
       TMS_DRIVER            f,
       pub_employee          g,
       pub_employee          h,
       pub_employee          i,
       pub_employee          j,
       pub_employee          k,
       pub_employee          l
 where a.goodsownerid = b.goodsownerid
   and a.companyid = c.companyid(+)
   and a.transid = d.transid(+)
   and a.cphid = e.vehicleid(+)
   and a.jsyid = f.driverid(+)
   and a.inputmanid = g.employeeid(+)
   and a.printmanid = h.employeeid(+)
   and a.signmanid  = i.employeeid(+)
   and a.outmanid = j.employeeid(+)
   and a.pcmanid = k.employeeid(+)
   and a.fcmanid = l.employeeid(+)
"
"ZX_ZPDJ_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_ZPDJ_DTL_V"" (""ZPDJID"", ""ZPDJDTLID"", ""OWNERGOODSID"", ""GOODSNAME"", ""GOODSTYPE"", ""DRUGFORM"", ""FACTNAME"", ""LOTNO"", ""VALIDDATE"", ""GOODSQTY"", ""TRADEPACKNAME"", ""UNITPRICE"", ""TOTAL_LINE"", ""CHAINFLAG"") AS 
  select a.zpdjid,
       a.zpdjdtlid,
       a.ownergoodsid,
       b.goodsname,
       b.goodstype,
       b.drugform,
       b.factname,
       a.lotno,
       a.validdate,
       a.goodsqty,
       b.tradepackname,
       a.unitprice,
       a.goodsqty*a.unitprice total_line,
       nvl(a.chainflag,0) chainflag
  from zx_zpdj_dtl a, tpl_goods_v b
 where a.ownergoodsid = b.ownergoodsid
"
"ZX_ZYC_ZZXRWS_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZX_ZYC_ZZXRWS_V"" (""BOXDOCID"", ""COMPANYID"", ""GOODSOWNERID"", ""WAVEID"") AS 
  select distinct t1.boxdocid,t2.companyid,t2.goodsownerid,t1.waveid
  from Wms_Turnbox_Doc t1, wms_st_io_doc t2
 where t1.boxdocid = t2.boxdocid
   and t2.goodsownerid in (340,8124,8129)
"
"ZYC_WMS_WAVE_DTL_V","
  CREATE OR REPLACE FORCE VIEW ""LYWMS"".""ZYC_WMS_WAVE_DTL_V"" (""WAVEID"", ""WAVEDTLID"", ""CREDATE"", ""GOODSOWNERID"", ""GOODSOWNERNAME"", ""CUSTOMID"", ""CUSTOMNAME"", ""COMPANYSTYLE"", ""GCOMPANYID"", ""GCOMPANYNO"", ""ORDERID"", ""TRANSID"", ""INCEPTADDR"", ""ROUTEID"", ""ROUTENAME"", ""DEPTNO"", ""DEPTNAME"", ""INVOICETYPE"", ""ORDERS_SET"", ""FLOWLINENO"", ""PRTCLASS"", ""OPERATIONTYPE"", ""OUTMODE"", ""MEMO"", ""SCATTERPACKS"", ""SCATTERFINPACKS"", ""WHOLEPACKS"", ""WHOLEFINPACKS"", ""USESTATUS"", ""PRINTFLAG"", ""PRINTDATE"", ""PRINTMANID"", ""PRINTMAN"", ""TRANSCLASS"", ""WAREHID"", ""SHIPZONEID"", ""ZONENO"", ""ZONENAME"", ""URGENFLAG"", ""SHIPZONEFLAG"", ""SALERID"", ""DTL_LINES"") AS 
  select a.waveid,
       a.wavedtlid,
       g.credate,
       a.goodsownerid,
       e.goodsownername,
       a.customid,
       b.companyname customname,
       b.companystyle,
       b.gcompanyid,
       b.gcompanyno,
       a.orderid,
       a.transid,
       c.inceptaddr,
       a.routeid,
       d.routename,
       a.deptno,
       a.deptname,
       a.invoicetype,
       a.orders_set,
       a.flowlineno,
       a.prtclass,
       a.operationtype,
       a.outmode,
       a.memo,
       a.scatterpacks,
       a.scatterfinpacks,
       a.wholepacks,
       a.wholefinpacks,
       a.usestatus,
       decode(a.printflag,null,0,0,0,1) printflag,
       a.printdate,
       a.printmanid,
       f.employeename printman,
       a.transclass,
       g.warehid,
       a.shipzoneid,
       h.zoneno,
       h.zonename,
       g.urgenflag,
       a.shipzoneflag,
       a.salerid,
       (select count(1) from wms_wave_goods_dtl where wavedtlid=a.wavedtlid) dtl_lines

  from wms_wave_dtl    a,
       tpl_go_company b,
       wms_transport_address c,
       pub_employee f,
       wms_tr_route d,
       tpl_goodsowner e,
       wms_wave_doc g,
       wms_ship_zone h
  where a.customid = b.companyid(+)
    and a.transid = c.transid(+)
    and a.printmanid = f.employeeid(+)
    and a.routeid = d.routeid(+)
    and a.goodsownerid =e.goodsownerid(+)
    AND a.waveid = g.wavedocid
    and a.shipzoneid = h.zoneid(+)
   -- and g.executetime > sysdate - 7
   --and a.usestatus = 3
   and a.customid in (29598,29599,29600)
   and a.operationtype = 11
   --and nvl(c.outmode, 0) = 1
   and g.warehid = 2
   and nvl(a.canprintflag, 0) = 1
   and a.goodsownerid = 4
"
